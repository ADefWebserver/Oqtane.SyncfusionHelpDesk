!function(e){var t={};function i(l){if(t[l])return t[l].exports;var a=t[l]={i:l,l:!1,exports:{}};return e[l].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=t,i.d=function(e,t,l){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:l})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var l=Object.create(null);if(i.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(l,a,function(t){return e[t]}.bind(null,a));return l},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="_content/Syncfusion.Blazor/scripts/",i(i.s="./bundles/heatmap.js")}({"./bundles/heatmap.js":function(e,t,i){"use strict";i.r(t);i("./modules/heatmap.js")},"./modules/heatmap.js":function(e,t){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}window.sf=window.sf||{};sf.heatmap=sf.base.extend({},sf.heatmap,function(e){"use strict";var t;!function(e){e.heatMapTitleFont={size:"15px",fontWeight:"500",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.titleFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI",textOverflow:"None"},e.axisTitleFont={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.axisLabelFont={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.legendLabelFont={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI",textOverflow:"None"},e.rectLabelFont={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI",textOverflow:"None"},e.tooltipFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI",textOverflow:"None"}}(t||(t={}));var l,a,n,s=(l=function(e,t){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}l(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o=function(e,t,l,a){var n,s=arguments.length,o=s<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,l):a;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,l,a);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(o=(s<3?n(o):s>3?n(t,l,o):n(t,l))||o);return s>3&&o&&Object.defineProperty(t,l,o),o},r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),o([sf.base.Property("16px")],t.prototype,"size",void 0),o([sf.base.Property("")],t.prototype,"color",void 0),o([sf.base.Property("Segoe UI")],t.prototype,"fontFamily",void 0),o([sf.base.Property("Normal")],t.prototype,"fontWeight",void 0),o([sf.base.Property("Normal")],t.prototype,"fontStyle",void 0),o([sf.base.Property("Center")],t.prototype,"textAlignment",void 0),o([sf.base.Property("Trim")],t.prototype,"textOverflow",void 0),t}(sf.base.ChildProperty),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),o([sf.base.Property(10)],t.prototype,"left",void 0),o([sf.base.Property(10)],t.prototype,"right",void 0),o([sf.base.Property(10)],t.prototype,"top",void 0),o([sf.base.Property(10)],t.prototype,"bottom",void 0),t}(sf.base.ChildProperty),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),o([sf.base.Property("")],t.prototype,"color",void 0),o([sf.base.Property(1)],t.prototype,"width",void 0),o([sf.base.Property("")],t.prototype,"radius",void 0),t}(sf.base.ChildProperty),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),o([sf.base.Property("")],t.prototype,"color",void 0),o([sf.base.Property(0)],t.prototype,"width",void 0),t}(sf.base.ChildProperty),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),o([sf.base.Property(null)],t.prototype,"size",void 0),o([sf.base.Property(null)],t.prototype,"color",void 0),t}(sf.base.ChildProperty),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),o([sf.base.Property("")],t.prototype,"text",void 0),o([sf.base.Complex({},r)],t.prototype,"textStyle",void 0),t}(sf.base.ChildProperty),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),o([sf.base.Property("#eeeeee")],t.prototype,"minColor",void 0),o([sf.base.Property("#eeeeee")],t.prototype,"maxColor",void 0),t}(sf.base.ChildProperty),b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),o([sf.base.Property(null)],t.prototype,"value",void 0),o([sf.base.Property(null)],t.prototype,"color",void 0),o([sf.base.Property(null)],t.prototype,"label",void 0),o([sf.base.Property(null)],t.prototype,"startValue",void 0),o([sf.base.Property(null)],t.prototype,"endValue",void 0),o([sf.base.Property(null)],t.prototype,"minColor",void 0),o([sf.base.Property(null)],t.prototype,"maxColor",void 0),t}(sf.base.ChildProperty),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),o([sf.base.Property("#b5b5b5")],t.prototype,"color",void 0),o([sf.base.Property(1)],t.prototype,"width",void 0),o([sf.base.Property("Rectangle")],t.prototype,"type",void 0),t}(sf.base.ChildProperty),v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),o([sf.base.Property("0%")],t.prototype,"minimum",void 0),o([sf.base.Property("100%")],t.prototype,"maximum",void 0),t}(sf.base.ChildProperty),y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),o([sf.base.Property(null)],t.prototype,"start",void 0),o([sf.base.Property(null)],t.prototype,"end",void 0),o([sf.base.Property("")],t.prototype,"text",void 0),o([sf.base.Property(null)],t.prototype,"maximumTextWidth",void 0),t}(sf.base.ChildProperty),m=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return s(i,e),o([sf.base.Property("Center")],i.prototype,"alignment",void 0),o([sf.base.Property("Wrap")],i.prototype,"overflow",void 0),o([sf.base.Complex(t.axisLabelFont,r)],i.prototype,"textStyle",void 0),o([sf.base.Complex({color:"#b5b5b5",width:1,type:"Rectangle"},f)],i.prototype,"border",void 0),o([sf.base.Collection([],y)],i.prototype,"categories",void 0),i}(sf.base.ChildProperty),x=function(e,t,i,l,a,n,s){this.value=e,this.color=t,this.label=i,this.startValue=l,this.endValue=a,this.minColor=n,this.maxColor=s},C=function(e,t,i){this.mappingName=e,this.bubbleData=t,this.valueType=i},S=function(e,t,i,l,a,n,s,o){this.value=e,this.color=t,this.label=i,this.startValue=l,this.endValue=a,this.minColor=n,this.maxColor=s,this.isHidden=o},M=function(e,t,i,l,a){this.index=1,this.row=1,this.start=e,this.end=t,this.index=i,this.label=l,this.row=a},w=(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),L=function(e,t,l,a){var n,s=arguments.length,o=s<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,l):a;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,l,a);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(o=(s<3?n(o):s>3?n(t,l,o):n(t,l))||o);return s>3&&o&&Object.defineProperty(t,l,o),o},R=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return w(t,e),L([sf.base.Collection([{}],b)],t.prototype,"palette",void 0),L([sf.base.Property("Gradient")],t.prototype,"type",void 0),L([sf.base.Property("")],t.prototype,"emptyPointColor",void 0),L([sf.base.Property("Table")],t.prototype,"colorGradientMode",void 0),L([sf.base.Complex({},u)],t.prototype,"fillColor",void 0),t}(sf.base.ChildProperty),T=function(e,t,i){this.R=e,this.G=t,this.B=i},P=function(){function e(e){this.heatMap=e}return e.prototype.convertToRGB=function(e,t){var i,l,a=this.heatMap.isColorRange?t[0].startValue:t[0].value,n=0,s=0;if(this.heatMap.isColorRange&&"Gradient"===this.heatMap.paletteSettings.type)for(s=0;s<t.length;s++){if(e<=(o=Number(t[s].endValue))&&e>=Number(t[s].startValue)){n=o,i=this.heatMap.colorCollection[s].minColor,l=this.heatMap.colorCollection[s].maxColor;break}if(t[0].startValue!==this.heatMap.dataSourceMinValue&&e<t[0].startValue){n=t[0].startValue,a=this.heatMap.dataSourceMinValue,i=this.heatMap.paletteSettings.fillColor.minColor,l=this.heatMap.paletteSettings.fillColor.maxColor;break}if(e>o&&e<=(s===t.length-1?this.heatMap.dataSourceMaxValue:t[s+1].startValue)){n=s===t.length-1?this.heatMap.dataSourceMaxValue:t[s+1].startValue,a=o,i=this.heatMap.paletteSettings.fillColor.minColor,l=this.heatMap.paletteSettings.fillColor.maxColor;break}n=o,a=o}else for(s=1;s<t.length;s++){var o;if(e<=(o=Number(t[s].value))){n=o,i=this.getEqualColor(t,a),l=this.getEqualColor(t,n);break}n=o,a=o}var r=0;return r=(e-a)/(n-a),r=isNaN(r)?0:r,this.getPercentageColor(r,i,l)},e.prototype.rgbToHex=function(e,t,i){return"#"+this.componentToHex(e)+this.componentToHex(t)+this.componentToHex(i)},e.prototype.componentToHex=function(e){var t=e.toString(16);return 1===t.length?"0"+t:t},e.prototype.getEqualColor=function(e,t){for(var i=0;i<e.length;i++)if(Number(e[i].value)===t){var l=e[i].color;return-1!==l.indexOf("rgb")?l=this.convertToHex(l):-1===l.indexOf("#")&&(l="#FFFFFF"),l}return"#00000"},e.prototype.convertToHex=function(e){var t=e.substr(3),i=(t=t.split("(")[1].split(")")[0]).split(",");return t=this.rgbToHex(parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10))},e.prototype.getPercentageColor=function(e,t,i){var l=i.split("#")[1],a=t.split("#")[1],n=this.getPercentage(e,parseInt(a.substr(0,2),16),parseInt(l.substr(0,2),16)),s=this.getPercentage(e,parseInt(a.substr(2,2),16),parseInt(l.substr(2,2),16)),o=this.getPercentage(e,parseInt(a.substr(4,2),16),parseInt(l.substr(4,2),16));return new T(n,s,o)},e.prototype.getPercentage=function(e,t,i){var l=i-t;return Math.round(t+l*e)},e.prototype.getColorCollection=function(){var e,t=this.heatMap;t.colorCollection=[],t.legendColorCollection=[];for(var i=0;i<this.heatMap.paletteSettings.palette.length;i++){if(null===this.heatMap.paletteSettings.palette[i].startValue||null===this.heatMap.paletteSettings.palette[i].endValue){this.heatMap.isColorRange=!1;break}this.heatMap.isColorRange=!0}var l=t.bubbleSizeWithColor?t.minColorValue:t.dataSourceMinValue,a=t.bubbleSizeWithColor?t.maxColorValue:t.dataSourceMaxValue;t.emptyPointColor=t.paletteSettings.emptyPointColor?t.paletteSettings.emptyPointColor:t.themeStyle.emptyCellColor;var n=this.orderbyOffset(this.heatMap.isColorRange||t.paletteSettings.palette&&t.paletteSettings.palette.length>1?t.paletteSettings.palette:t.themeStyle.palette);if(n.isCompact)t.colorCollection=n.offsets,t.legendColorCollection=sf.base.extend([],n.offsets,null,!0);else if(e="Gradient"===t.paletteSettings.type?(a-l)/(n.offsets.length-1):(a-l)/n.offsets.length,n.offsets.length>=2)for(var s=0;s<n.offsets.length;s++)t.colorCollection.push(new x(Math.round(100*(l+s*e))/100,n.offsets[s].color,n.offsets[s].label,n.offsets[s].startValue,n.offsets[s].endValue,n.offsets[s].minColor,n.offsets[s].maxColor)),t.legendColorCollection.push(new S(Math.round(100*(l+s*e))/100,n.offsets[s].color,n.offsets[s].label,n.offsets[s].startValue,n.offsets[s].endValue,n.offsets[s].minColor,n.offsets[s].maxColor,!1));this.heatMap.isColorRange||this.updateLegendColorCollection(l,a,n)},e.prototype.updateLegendColorCollection=function(e,t,i){"Fixed"===this.heatMap.paletteSettings.type&&(i.isCompact||i.isLabel)||(Math.round(100*e)/100<this.heatMap.legendColorCollection[0].value&&this.heatMap.legendColorCollection.unshift(new S(Math.round(100*e)/100,this.heatMap.legendColorCollection[0].color,this.heatMap.legendColorCollection[0].label,this.heatMap.legendColorCollection[0].startValue,this.heatMap.legendColorCollection[0].endValue,this.heatMap.legendColorCollection[0].minColor,this.heatMap.legendColorCollection[0].maxColor,!0)),Math.round(100*t)/100>this.heatMap.legendColorCollection[this.heatMap.legendColorCollection.length-1].value&&this.heatMap.legendColorCollection.push(new S(Math.round(100*t)/100,this.heatMap.legendColorCollection[this.heatMap.legendColorCollection.length-1].color,this.heatMap.legendColorCollection[this.heatMap.legendColorCollection.length-1].label,this.heatMap.legendColorCollection[this.heatMap.legendColorCollection.length-1].startValue,this.heatMap.legendColorCollection[this.heatMap.legendColorCollection.length-1].endValue,this.heatMap.legendColorCollection[this.heatMap.legendColorCollection.length-1].minColor,this.heatMap.legendColorCollection[this.heatMap.legendColorCollection.length-1].maxColor,!0)))},e.prototype.orderbyOffset=function(e){var t=new de,i=this.heatMap.isColorRange?"to":"value";return t.isCompact=!0,t.isLabel=!0,t.offsets=e.sort((function(e,l){return sf.base.isNullOrUndefined(e.label)&&sf.base.isNullOrUndefined(l.label)&&(t.isLabel=!1),sf.base.isNullOrUndefined(e[i])||sf.base.isNullOrUndefined(l[i])?(t.isCompact=!1,e):e[i]-l[i]})),t.isCompact||(t.offsets=this.heatMap.paletteSettings.palette&&this.heatMap.paletteSettings.palette.length>1?this.heatMap.paletteSettings.palette:this.heatMap.themeStyle.palette),t},e.prototype.getColorByValue=function(e){var t,i="",l=0;if(""!==e.toString())if("Bubble"!==this.heatMap.cellSettings.tileType||"Size"!==this.heatMap.cellSettings.bubbleType&&"Sector"!==this.heatMap.cellSettings.bubbleType)if("Fixed"===this.heatMap.paletteSettings.type)for(var a=0;a<this.heatMap.colorCollection.length;a++){l=this.heatMap.isColorRange?this.heatMap.paletteSettings.palette[a].startValue:this.heatMap.colorCollection[a+1]?this.heatMap.colorCollection[a+1].value:this.heatMap.colorCollection[a].value;var n=this.heatMap.dataSourceMinValue===this.heatMap.dataSourceMaxValue;if(this.heatMap.isColorRange){var s=void 0;if(e<=this.heatMap.colorCollection[a].endValue&&e>=this.heatMap.colorCollection[a].startValue){this.heatMap.legendVisibilityByCellType&&(s=this.heatMap.legendModule.legendRange),i=this.heatMap.legendVisibilityByCellType&&s[a]&&!s[a].visible?this.heatMap.themeStyle.toggledColor:this.heatMap.colorCollection[a].minColor;break}i=this.heatMap.paletteSettings.fillColor.minColor}else if(e<=l&&n&&0===a||e<l||e>=l&&a===this.heatMap.colorCollection.length-1){s=void 0;this.heatMap.legendVisibilityByCellType&&(s=this.heatMap.legendModule.legendRange),i=this.heatMap.legendVisibilityByCellType&&s[a]&&!s[a].visible?this.heatMap.themeStyle.toggledColor:this.heatMap.colorCollection[a].color;break}}else"Table"!==this.heatMap.paletteSettings.colorGradientMode&&this.getColorCollection(),e<this.heatMap.colorCollection[0].value&&!this.heatMap.isColorRange?i=this.heatMap.colorCollection[0].color:e>this.heatMap.colorCollection[this.heatMap.colorCollection.length-1].value&&!this.heatMap.isColorRange?i=this.heatMap.colorCollection[this.heatMap.colorCollection.length-1].color:(t=this.convertToRGB(e,this.heatMap.colorCollection),i=this.rgbToHex(t.R,t.G,t.B));else i=this.heatMap.isColorRange?this.heatMap.colorCollection[0].minColor:this.heatMap.colorCollection[0].color;else i=this.heatMap.emptyPointColor;return i},e}(),z=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});function V(e,t){return null!=e?-1!==e.indexOf("%")?t/100*parseInt(e,10):parseInt(e,10):null}function O(e,t){var i=document.getElementById("heatmapmeasuretext");return null===i&&(i=sf.base.createElement("text",{id:"heatmapmeasuretext"}),document.body.appendChild(i)),i.innerText=e,i.style.position="absolute",i.style.visibility="hidden",i.style.fontSize=-1!==t.size.indexOf("px")?t.size:t.size+"px",i.style.fontWeight=t.fontWeight,i.style.fontStyle=t.fontStyle,i.style.fontFamily=t.fontFamily,i.style.top="-100",i.style.left="0",i.style.whiteSpace="nowrap",i.style.lineHeight="normal",new _(i.clientWidth,i.clientHeight)}var A=function(e,t){this["font-size"]=e.size,this["font-style"]=e.fontStyle.toLowerCase(),this["font-family"]=e.fontFamily,this["font-weight"]=e.fontWeight.toLowerCase(),this.fill=t||""};function D(e,t,i,l){return"Near"===l.textAlignment?t:"Center"===l.textAlignment?t+e/2:e+t}var _=function(e,t){this.width=e,this.height=t},I=function(e){this.id=e},B=function(e){function t(t,i,l,a,n,s,o){var r=e.call(this,t)||this;return r.opacity=n,r.fill=i,r.stroke=a||"",r["stroke-width"]=parseFloat(l.toString()),r["stroke-dasharray"]=s,r.d=o,r}return z(t,e),t}(I),N=function(e,t,i,l,a,n,s,o,r,h,d,p,g,c){this.x=e,this.y=t,this.width=i,this.height=l,this.value=a,this.id=n,this.xIndex=s,this.yIndex=o,this.xValue=r,this.yValue=h,this.visible=d,this.displayText=p,this.textId=g,this.allowCollection=c},E=function(e,t,i,l,a,n,s,o,r,h,d,p){this.value=e,this.xLabel=t,this.yLabel=i,this.xValue=l,this.yValue=a,this.cellElement=n,this.xPosition=s,this.yPosition=o,this.width=r,this.height=h,this.x=d,this.y=p},G=function(e){function t(t,i,l,a,n,s,o,r,h,d){var p=e.call(this,t,i,l.width,s,a,d)||this;return p.y=n.y,p.x=n.x,p.height=n.height>0?n.height:0,p.width=n.width>0?n.width:0,p.rx=o||0,p.ry=r||0,p.transform=h||"",p}return z(t,e),t}(B),H=function(e){function t(t,i,l,a,n,s,o,r){var h=e.call(this,t,i,l.width,n,a)||this;return h.cx=s||0,h.cy=o||0,h.r=r||0,h}return z(t,e),t}(B),F=function(e,t,i,l){this.x=e,this.y=t,this.width=i,this.height=l},j=function(e){function t(t,i,l,a){var n=e.call(this,l,a)||this;return n.transform="",n["dominant-baseline"]="auto",n.labelRotation=0,n.baseline="auto",n.id=t,n.x=i.x,n.y=i.y,n["text-anchor"]=i["text-anchor"],n.text=i.text,n.transform=i.transform,n.labelRotation=i.labelRotation,n["dominant-baseline"]=i["dominant-baseline"],n.baseline=i.baseline,n.dy=i.dy,n}return z(t,e),t}(A),k=function(e,t,i,l,a,n,s,o){this.transform="",this["dominant-baseline"]="auto",this.labelRotation=0,this.baseline="auto",this.x=e||0,this.y=t||0,this["text-anchor"]=i||"start",this.text=l||"",this.transform=n||"",this.labelRotation=a,this["dominant-baseline"]=s||"auto",this.baseline=s||"",this.dy=o||""},W=function(e,t,i,l){this.x1=e,this.y1=t,this.x2=i,this.y2=l},Y=function(e){function t(t,i,l,a,n,s){var o=e.call(this,t,null,a,l,n,s,null)||this;return o.x1=i.x1,o.y1=i.y1,o.x2=i.x2,o.y2=i.y2,o}return z(t,e),t}(B),U=function(e){function t(t,i,l,a,n,s,o){var r=e.call(this,t,l,n,o,s,null)||this;return r.d=i.d,r.x=i.x,r.y=i.y,r}return z(t,e),t}(B),X=function(e,t,i,l,a,n,s,o,r,h,d,p){this.d=e,this.innerR=t,this.cx=s,this.cy=o,this.x=i,this.y=l,this.x1=a,this.y1=n,this.start=r,this.end=h,this.radius=d,this.counterClockWise=p};function J(e){for(var t=0,i=0,l=e;i<l.length;i++){t+=l[i]}return t}function Z(e,t,i,l){return"Near"===l.textAlignment?e.height-i:"Center"===l.textAlignment?e.height/2:t}function q(e,t,i){var l,a,n,s=new sf.svgbase.SvgRenderer("heatmapMeasureRotateText"),o=s.createSvg({id:"heatmapMeasureRotateText_svg",width:100,height:100});return a={"font-size":e.size,"font-style":e.fontStyle.toLowerCase(),"font-family":e.fontFamily,"font-weight":e.fontWeight.toLowerCase(),transform:"rotate("+i+", 0, 0)","text-anchor":"middle"},n=s.createText(a,t),o.appendChild(n),document.body.appendChild(o),l=n.getBoundingClientRect(),sf.base.remove(o),new _(l.right-l.left,l.bottom-l.top)}var $=function(){function e(e){this.heatMap=e}return e.prototype.drawRectangle=function(e,t,i){this.heatMap.enableCanvasRendering?this.drawCanvasRectangle(this.heatMap.canvasRenderer,e,i):(delete e.d,t.appendChild(this.heatMap.renderer.drawRectangle(e)))},e.prototype.drawCircle=function(e,t){this.heatMap.enableCanvasRendering?this.drawCanvasCircle(this.heatMap.canvasRenderer,e):(delete e.d,t.appendChild(this.heatMap.renderer.drawCircle(e)))},e.prototype.drawPath=function(e,t,i){this.heatMap.enableCanvasRendering?this.drawCanvasPath(this.heatMap.canvasRenderer,e,t):(delete e.x,delete e.y,i.appendChild(this.heatMap.renderer.drawPath(e)))},e.prototype.createText=function(e,t,i){if(this.heatMap.enableCanvasRendering)this.canvasDrawText(e,i);else{delete e.labelRotation,delete e.baseline,delete e.text;var l=this.heatMap.renderer.createText(e,i);l.style.fontFamily=e["font-family"],l.style.fontSize=e["font-size"],l.style.fontStyle=e["font-style"],l.style.fontWeight=e["font-weight"],t.appendChild(l),e.text=i}},e.prototype.createWrapText=function(e,t,i){var l,a,n,s,o;if(l={id:e.id,x:e.x,y:e.y,fill:e.fill,"font-size":t.size,"font-style":t.fontStyle,"font-family":t.fontFamily,"font-weight":t.fontWeight.toLowerCase(),"text-anchor":e["text-anchor"],transform:e.transform,"dominant-baseline":e["dominant-baseline"]},s=e.text[0],this.heatMap.enableCanvasRendering?this.heatMap.canvasRenderer.createText(e,s):a=this.heatMap.renderer.createText(l,s),"string"!=typeof e.text&&e.text.length>1)for(var r=1,h=e.text.length;r<h;r++)o=O(e.text[r],t).height,this.heatMap.enableCanvasRendering?(e.id=e.id+r,e.y+=o,this.heatMap.canvasRenderer.createText(e,e.text[r])):(n=this.heatMap.renderer.createTSpan({x:e.x,id:e.id+r,y:e.y+r*o},e.text[r]),a.appendChild(n));this.heatMap.enableCanvasRendering||i.appendChild(a)},e.prototype.drawLine=function(e,t){this.heatMap.enableCanvasRendering?this.heatMap.canvasRenderer.drawLine(e):(delete e.d,t.appendChild(this.heatMap.renderer.drawLine(e)))},e.prototype.canvasDrawText=function(e,t,i,l){var a=this.heatMap.canvasRenderer.ctx;i||(i=e.x),l||(l=e.y);var n=this.getOptionValue(e,"font-weight");sf.base.isNullOrUndefined(n)||"regular"!==n.toLowerCase()||(n="normal");var s=this.getOptionValue(e,"font-family"),o=-1===e["font-size"].toString().indexOf("px")?e["font-size"]+"px":e["font-size"],r=this.getOptionValue(e,"text-anchor"),h=this.getOptionValue(e,"font-style").toLowerCase()+" "+n+" "+o+" "+s;"middle"===r&&(r="center"),a.save(),a.fillStyle=e.fill,a.font=h,a.textAlign=r,e.baseline&&(a.textBaseline=e.baseline),a.translate(i,l),a.rotate(e.labelRotation*Math.PI/180),a.fillText(t,e.x-i,e.y-l),a.restore()},e.prototype.getOptionValue=function(e,t){return e[t]},e.prototype.setAttributes=function(e,t){e.ctx.lineWidth=t["stroke-width"];var i=t["stroke-dasharray"];if(!sf.base.isNullOrUndefined(i)){var l=i.split(",");e.ctx.setLineDash([parseInt(l[0],10),parseInt(l[1],10)])}e.ctx.strokeStyle=t.stroke},e.prototype.drawCanvasRectangle=function(e,t,i){var l=e.ctx;t.rx;e.ctx.save(),e.ctx.beginPath(),e.ctx.globalAlpha=t.opacity,this.setAttributes(e,t),this.drawCornerRadius(e,t),(t["stroke-width"]&&0!=t["stroke-width"]||i)&&e.ctx.stroke(),e.ctx.restore(),e.ctx=l},e.prototype.drawCornerRadius=function(e,t){var i=t.rx,l=t.x,a=t.y,n=t.width,s=t.height;"none"===t.fill&&(t.fill="transparent"),e.ctx.fillStyle=t.fill,n<2*i&&(i=n/2),s<2*i&&(i=s/2),e.ctx.beginPath(),e.ctx.moveTo(l+n-i,a),e.ctx.arcTo(l+n,a,l+n,a+s,i),e.ctx.arcTo(l+n,a+s,l,a+s,i),e.ctx.arcTo(l,a+s,l,a,i),e.ctx.arcTo(l,a,l+n,a,i),e.ctx.closePath(),e.ctx.fill()},e.prototype.drawCanvasCircle=function(e,t){e.ctx.save(),e.ctx.beginPath(),e.ctx.arc(t.cx,t.cy,t.r,0,2*Math.PI),e.ctx.fillStyle=t.fill,e.ctx.globalAlpha=t.opacity,e.ctx.fill(),this.setAttributes(e,t),t["stroke-width"]&&0!==t["stroke-width"]&&e.ctx.stroke(),e.ctx.restore()},e.prototype.drawCanvasPath=function(e,t,i){var l=t.d.split(" ");this.getOptionValue(i,"stroke-width");e.ctx.save(),e.ctx.beginPath(),e.ctx.globalAlpha=t.opacity,e.ctx.fillStyle=t.fill,this.setAttributes(e,t);for(var a=0;a<l.length;a+=3){var n=parseFloat(l[a+1]),s=parseFloat(l[a+2]);switch(l[a]){case"M":e.ctx.moveTo(n,s);break;case"L":e.ctx.lineTo(n,s);break;case"A":case"a":e.ctx.arc(i.x,i.y,i.radius,.0174533*i.start,.0174533*i.end,!1),a="a"===l[a]?a+13:a+5;break;case"Z":e.ctx.closePath()}}e.ctx.fill(),t["stroke-width"]&&0!==t["stroke-width"]&&e.ctx.stroke(),e.ctx.restore()},e}();function K(e,t,i){var l=[];switch(t.textOverflow){case"Wrap":l=Q(e,i,t);break;case"Trim":l.push(ee(i,e,t));break;default:l.push(te(i,e,t))}return l}function Q(e,t,i){for(var l,a=e.split(" "),n="",s=[],o=0,r=a.length;o<r;o++)l=a[o],O(n.concat(l),i).width<t?n=n.concat((""===n?"":" ")+l):""!==n?(s.push(ee(t,n,i)),n=l):(s.push(ee(t,l,i)),l=""),n&&o===r-1&&s.push(ee(t,n,i));return s}function ee(e,t,i){var l=t,a=O(t,i).width;if(a>e)for(var n=t.length-1;n>=0;--n)if((a=O(l=t.substring(0,n)+"...",i).width)<=e)return l;return l}function te(e,t,i){var l=t,a=O(t,i).width;if(a>e)for(var n=t.length-1;n>=0;--n)if((a=O(l=t.substring(0,n),i).width)<=e)return l;return l}var ie=function(e,t,i,l,a){this.id=e,this.x1=t,this.x2=i,this.y1=l,this.y2=a},le=function(e,t){this.color=e,this.colorStop=t};function ae(e,t,i,l,a,n,s,o){var r=document.getElementById(a),h=(o.initialClipRect,O(e,{fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"Regular"})),d=h.width+5;t=(t=t+d>l?t-d:t)<0?5:t,r?(r.innerText=e,r.style.top=(i+15).toString()+"px",r.style.left=(t+15).toString()+"px"):((r=sf.base.createElement("div",{id:a,styles:"top:"+(i+15).toString()+"px;left:"+(t+15).toString()+"px;background-color: rgb(255, 255, 255) !important; color:black !important; position:absolute;border:1px solid rgb(112, 112, 112); padding-left : 3px; padding-right : 2px;padding-bottom : 2px; padding-top : 2px; font-size:12px; font-family: Segoe UI"})).innerText=e,n.appendChild(r)),e===o.titleSettings.text?r.style.width=t+15+h.width+7>o.availableSize.width?(o.availableSize.width-(t+15)).toString()+"px":"":(r.style.left=t+15+h.width+7>o.availableSize.width?(o.availableSize.width-(h.width+7)).toString()+"px":t.toString()+"px",r.style.top=i+15+h.height+6>o.availableSize.height?(i-(h.height+6)-10).toString()+"px":r.style.top),s&&setTimeout((function(){ne(a)}),1500)}function ne(e){var t=se(e);t&&sf.base.remove(t)}function se(e){return document.getElementById(e)}function oe(e,t,i,l){var a=new Date(e);switch(t=Math.ceil(t*l),i){case"Years":a.setFullYear(a.getFullYear()+t);break;case"Months":a.setMonth(a.getMonth()+t);break;case"Days":a.setDate(a.getDate()+t);break;case"Hours":a.setHours(a.getHours()+t);break;case"Minutes":a.setMinutes(a.getMinutes()+t)}return a}var re=function(e,t){this.region=new F(0,0,0,0),this.text=e,this.region=t};function he(e,t,i){for(var l,a,n,s=e.length,o=0;o<s;o++)if(t>=(a=(l=e[o]).region).x&&t<=a.x+a.width&&i>=a.y&&i<=a.y+a.height){n=l.text;break}return n}var de=function(){},pe=function(e,t,i,l,a,n){this.pathX1=e,this.pathY1=t,this.pathX2=i,this.pathY2=l,this.pathX3=a,this.pathY3=n},ge=function(e,t,i,l,a,n){this.x=e,this.y=t,this.width=i,this.height=l,this.label=a,this.id=n},ce=function(e,t,i,l,a,n,s){this.x=e,this.y=t,this.width=i,this.height=l,this.value=a,this.visible=n,this.currentPage=s},ue=function(e,t,i,l){this.visible=e,this.value=t,this.startValue=i,this.endValue=l};function be(e){var t;e="transparent"===e?"white":e,(t=document.getElementById("heatmapmeasuretext")).style.color=e,e=window.getComputedStyle(t).color;var i=/^(rgb|hsl)(a?)[(]\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*(?:,\s*([\d.]+)\s*)?[)]$/.exec(e);return fe(new T(parseInt(i[3],10),parseInt(i[4],10),parseInt(i[5],10)))}function fe(e){return"#"+ve(e.R)+ve(e.G)+ve(e.B)}function ve(e){var t=e.toString(16);return 1===t.length?"0"+t:t}function ye(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?new T(parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)):new T(255,255,255)}function me(e,t,i,l){return e?t.replace("{value}",l(i)):l(i)}var xe,Ce,Se,Me,we,Le,Re=function(e,t){this.x=e,this.y=t},Te=(xe=function(e,t){return(xe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}xe(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Pe=function(e,t,l,a){var n,s=arguments.length,o=s<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,l):a;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,l,a);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(o=(s<3?n(o):s>3?n(t,l,o):n(t,l))||o);return s>3&&o&&Object.defineProperty(t,l,o),o},ze=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.multipleRow=[],t.rect=new F(void 0,void 0,0,0),t.nearSizes=[],t.farSizes=[],t.maxLabelSize=new _(0,0),t.titleSize=new _(0,0),t.multilevel=[],t.axisLabels=[],t.tooltipLabels=[],t.labelValue=[],t.axisLabelSize=0,t.axisLabelInterval=0,t.dateTimeAxisLabelInterval=[],t.maxLength=0,t.min=0,t.max=0,t.isIntersect=!1,t.jsonCellLabel=[],t.multiLevelSize=[],t.xAxisMultiLabelHeight=[],t.yAxisMultiLabelHeight=[],t.multiLevelPosition=[],t}return Te(i,e),i.prototype.computeSize=function(e,t,i){var l=new _(0,0);this.titleSize=e.getTitleSize(e,10),this.maxLabelSize=e.getMaxLabelSize(e,t),this.getMultilevelLabelsHeight(e,i,t);for(var a=0;a<this.multiLevelLabels.length;a++)l=e.multiLevelLabelSize(10,a),this.multiLevelSize.push(l)},i.prototype.multiPosition=function(e,t){var i="Horizontal"===e.orientation?10:20,l=new Re(0,0);if("Horizontal"===e.orientation){var a=e.maxLabelSize.height+i,n=this.xAxisMultiLabelHeight[t-1];l.x=e.isInversed?e.rect.x+e.rect.width:e.rect.x,l.y=0===t?e.rect.y+(e.opposedPosition?-a:a):e.multiLevelPosition[t-1].y+(e.opposedPosition?-n:n)}else{a=e.maxLabelSize.width+i,n=0!==t&&this.multiLevelSize[t-1].width;l.x=0===t?e.rect.x-(e.opposedPosition?-a:a):e.multiLevelPosition[t-1].x-(e.opposedPosition?-(n+i):n+i),l.y=e.isInversed?e.rect.y:e.rect.y+e.rect.height}return l},i.prototype.multiLevelLabelSize=function(e,t){for(var i=new _(0,0),l=this.multiLevelLabels,a=l[t].categories,n=0;n<a.length;n++){var s=O(a[n].text,l[t].textStyle);i.width=i.width>s.width?i.width:s.width,i.height=i.height>s.height?i.height:s.height}var o="Horizontal"===this.orientation?this.xAxisMultiLabelHeight[t]:this.yAxisMultiLabelHeight[t];return this.opposedPosition?this.farSizes.push(o):this.nearSizes.push(o),i},i.prototype.getMultilevelLabelsHeight=function(e,t,i){var l,a,n,s,o,r,h,d=[],p="Vertical"===e.orientation,g=(p?t.height:t.width,e.axisLabelSize,"Vertical"===e.orientation?20:10);this.multiLevelLabels.map((function(c,u){c.categories.map((function(b){s="number"==typeof b.start?b.start:Number(new Date(b.start)),o="number"==typeof b.end?b.end:Number(new Date(b.end)),""!==b.text&&null!==b.start&&null!==b.end&&(l=O(b.text,c.textStyle),n=p?l.width:l.height,r=i.heatMapAxis.calculateLeftPosition(e,s,b.start,t),h=i.heatMapAxis.calculateWidth(e,b.end,o,t),l=O(b.text,c.textStyle),a=null===b.maximumTextWidth?Math.abs(h-r):b.maximumTextWidth,l.width>a-g&&"Wrap"===c.overflow&&!p&&(n*=Q(b.text,a-g,c.textStyle).length),d[u]=d[u]?d[u]<n?n+g:d[u]:n+g)}))})),p?this.yAxisMultiLabelHeight=d:this.xAxisMultiLabelHeight=d},i.prototype.getTitleSize=function(e,t){var i=new _(0,0);return this.title.text&&((i=O(this.title.text,this.title.textStyle)).height+=t),e.opposedPosition?this.farSizes.push(i.height):this.nearSizes.push(i.height),i},i.prototype.getMaxLabelSize=function(e,t){var i=new _(0,0),l=this.axisLabels,a=e.border.width>0||e.multiLevelLabels.length>0?10:0,n=1,s="DateTime"===e.valueType&&"None"!==e.showLabelOn?t.initialClipRect.width/e.axisLabelSize:t.initialClipRect.width/e.axisLabels.length;if(e.angle=e.labelRotation,e.isIntersect=!1,"Horizontal"===e.orientation&&("Rotate45"===e.labelIntersectAction||e.labelRotation%180==0&&"Trim"===e.labelIntersectAction||e.enableTrim)||"MultipleRows"===e.labelIntersectAction){var o=t.initialClipRect.x+(e.isInversed?t.initialClipRect.width:0),r=void 0,h=void 0;this.clearMultipleRow();for(var d=0,p=l.length;d<p;d++){var g=O(v=l[d],e.textStyle),c="DateTime"===e.valueType&&"None"!==e.showLabelOn?e.dateTimeAxisLabelInterval[d]*s:s,u=o+(e.isInversed?-(s+g.width)/2:(s-g.width)/2),b=(u=u<t.initialClipRect.x?t.initialClipRect.x:u)+g.width;if(e.isInversed){if(sf.base.isNullOrUndefined(h))h=u;else if(h<b&&"MultipleRows"!==e.labelIntersectAction){"Rotate45"!==e.labelIntersectAction||e.enableTrim?e.isIntersect=!0:e.angle=45;break}h=u}else{if(sf.base.isNullOrUndefined(r))r=b;else if(u<r&&"MultipleRows"!==e.labelIntersectAction){"Rotate45"!==e.labelIntersectAction||e.enableTrim?e.isIntersect=!0:e.angle=45;break}r=b}o+=e.isInversed?-c:c,"Horizontal"===e.orientation&&"MultipleRows"===e.labelIntersectAction&&0===e.labelRotation&&this.multipleRow.push(new M(u,b,n,v,1))}"Horizontal"===e.orientation&&"MultipleRows"===e.labelIntersectAction&&e.isInversed&&(this.multipleRow=this.multipleRow.reverse())}for(d=0;d<l.length;d++){var f=this.multipleRow,v=void 0;v=e.enableTrim?ee(e.maxLabelLength,l[d],e.textStyle):l[d];var y=e.angle%180==0?O(v,e.textStyle):q(e.textStyle,l[d],e.angle);if(i.width=i.width>y.width?i.width:y.width,"MultipleRows"===e.labelIntersectAction&&"Horizontal"===e.orientation&&d>0&&0===e.labelRotation){f[d].end>=t.initialClipRect.width&&d<l.length-1&&(f[d].row=f[d].row+1);for(var m=1;m<=e.multilevel.length;m++)if(f[d].start<f[d-1].end){if(e.multilevel[m]<f[d].start){n=m;break}if(m===e.multilevel.length-1){n=e.multilevel.length;break}}else if(y.width<s)for(var x=1;x<=e.multilevel.length;x++)if(e.multilevel[x]<f[d].start){n=x,f[x].row=n;break}i.height=i.height>y.height*n+.5*y.height/2*(n-1)?i.height:y.height*n+.5*y.height/2*n,this.multipleRow[d].index=n,e.multilevel[n]=f[d].end}else"Horizontal"===e.orientation&&"MultipleRows"===e.labelIntersectAction&&0===d&&0===e.labelRotation&&(e.multilevel[1]=f[d].end),i.height=i.height>y.height?i.height:y.height}return t.cellSettings.border.width>=20&&"Horizontal"!==e.orientation&&(i.width=i.width+t.cellSettings.border.width/4),e.opposedPosition?this.farSizes.push("Horizontal"===e.orientation?i.height:i.width+a):this.nearSizes.push("Horizontal"===e.orientation?i.height:i.width+a),i},i.prototype.calculateNumericAxisLabels=function(e){var t,i,l,a=0,n=0,s=this.interval?this.interval:1;e.adaptorModule&&e.isCellData&&(t="Horizontal"===this.orientation?e.adaptorModule.adaptiveXMinMax.min:e.adaptorModule.adaptiveYMinMax.min,i="Horizontal"===this.orientation?e.adaptorModule.adaptiveXMinMax.max:e.adaptorModule.adaptiveYMinMax.max),a=sf.base.isNullOrUndefined(this.minimum)?t||0:this.minimum,n=sf.base.isNullOrUndefined(this.maximum)?i||this.maxLength*this.increment:this.maximum,this.minimum&&this.maximum&&a>n&&(l=a,a=n,n=l),n=sf.base.isNullOrUndefined(this.maximum)?i||n+a:n;var o=this.labelFormat,r=null!==o.match("{value}");this.format=e.intl.getNumberFormat({format:r?"":o});for(var h=a;h<=n;h+=s*this.increment){var d=me(r,o,h,this.format);this.axisLabels.push(d)}this.min=0,this.axisLabelSize=Math.floor((n-a)/this.increment+1),this.max=this.axisLabelSize-1,this.axisLabelInterval=s;for(h=a;h<=n;h+=this.increment){d=me(r,o,h,this.format);this.tooltipLabels.push(d),this.labelValue.push(h)}this.labelValue=this.isInversed?this.labelValue.reverse():this.labelValue},i.prototype.calculateCategoryAxisLabels=function(){var e=this.labels?this.labels:[];e=e.length>0?e:this.jsonCellLabel;var t,i=sf.base.isNullOrUndefined(this.minimum)?0:this.minimum,l=sf.base.isNullOrUndefined(this.maximum)?this.maxLength:this.maximum,a=this.interval?this.interval:1;if(!sf.base.isNullOrUndefined(this.minimum)&&!sf.base.isNullOrUndefined(this.maximum)&&i>l&&(t=i,i=l,l=t),e&&e.length>0)for(var n=i;n<=l;n+=a){var s=e[n]?e[n].toString():n.toString();this.axisLabels.push(s)}else for(n=i;n<=l;n+=a)this.axisLabels.push(n.toString());for(n=i;n<=l;n++)this.tooltipLabels.push(e[n]?e[n].toString():n.toString()),this.labelValue.push(e[n]?e[n].toString():n.toString());this.min=i,this.max=l,this.axisLabelSize=l-i+1,this.axisLabelInterval=a,this.labelValue=this.isInversed?this.labelValue.reverse():this.labelValue},i.prototype.calculateDateTimeAxisLabel=function(e){var t,i,l=this.interval?this.interval:1,a={skeleton:"full",type:"dateTime"},n=e.intl.getDateParser(a),s=e.intl.getDateFormat(a),o=null,r=null;e.adaptorModule&&e.isCellData&&(o="Horizontal"===this.orientation?e.adaptorModule.adaptiveXMinMax.min:e.adaptorModule.adaptiveYMinMax.min,r="Horizontal"===this.orientation?e.adaptorModule.adaptiveXMinMax.max:e.adaptorModule.adaptiveYMinMax.max);var h=this.minimum?this.minimum:o||null,d=this.maximum?this.maximum:r||null;if(null===h&&null===d){t=0,i=this.maxLength*this.increment;for(var p=t;p<=i;p+=l*this.increment)this.axisLabels.push(p.toString()),this.tooltipLabels.push(p.toString()),this.labelValue.push(p.toString());this.min=0,this.max=this.maxLength,this.axisLabelSize=(i-t)/this.increment+1,this.axisLabelInterval=l}else{null!==h&&null===d?i=oe(t=Date.parse(n(s(new Date(sf.data.DataUtil.parse.parseJson({val:h}).val)))),this.maxLength,this.intervalType,this.increment).getTime():null===h&&null!==d?t=oe(i=Date.parse(n(s(new Date(sf.data.DataUtil.parse.parseJson({val:d}).val)))),-this.maxLength,this.intervalType,this.increment).getTime():(t=Date.parse(n(s(new Date(sf.data.DataUtil.parse.parseJson({val:h}).val)))),i=Date.parse(n(s(new Date(sf.data.DataUtil.parse.parseJson({val:d}).val))))),this.format=e.intl.getDateFormat({format:this.labelFormat,skeleton:this.getSkeleton()});for(var g=t;g<=i;){var c=this.format(new Date(g));this.axisLabels.push(c),"None"!==this.showLabelOn&&(l=this.calculateLabelInterval(g),this.dateTimeAxisLabelInterval.push(l)),g=oe(g,l,this.intervalType,this.increment).getTime()}for(this.min=0,this.axisLabelInterval=l,this.axisLabelSize=this.getTotalLabelLength(t,i),this.max=this.axisLabelSize-1,g=t;g<=i;){c=this.format(new Date(g));this.tooltipLabels.push(c),this.labelValue.push(new Date(g)),g=oe(g,1,this.intervalType,this.increment).getTime()}}this.labelValue=this.isInversed?this.labelValue.reverse():this.labelValue},i.prototype.calculateLabelInterval=function(e){var t,i,l=new Date(e).getFullYear(),a=new Date(e).getMonth()+1,n=new Date(e).getDate();if("Years"===this.showLabelOn||"Months"===this.showLabelOn)"Years"===this.showLabelOn&&"Months"===this.intervalType?i=Math.ceil(12/this.increment):(t="Years"===this.showLabelOn?l%4==0?366:365:new Date(l,a,0).getDate(),t+=1-n,i="Days"===this.intervalType?Math.ceil(t/this.increment):"Hours"===this.intervalType?Math.ceil(24*t/this.increment):"Minutes"===this.intervalType?Math.ceil(24*t*60/this.increment):1);else if("Days"===this.showLabelOn)i="Hours"===this.intervalType?Math.ceil(24/this.increment):"Minutes"===this.intervalType?Math.ceil(1440/this.increment):1;else if("Hours"===this.showLabelOn){var s=new Date(e).getMinutes();i="Minutes"===this.intervalType?Math.ceil((60-s)/this.increment):1}else i=1;return i},i.prototype.getSkeleton=function(){return"Years"===this.intervalType?"yMMM":"Months"===this.intervalType?"MMMd":"Days"===this.intervalType?"yMd":"Hours"===this.intervalType?"EHm":(this.intervalType,"Hms")},i.prototype.getTotalLabelLength=function(e,t){var i,l,a=0,n=new Date(e),s=new Date(t);switch(this.intervalType){case"Years":var o=(s.getFullYear()-n.getFullYear())/this.increment+1;a=Math.floor(o);break;case"Months":var r=12*(s.getFullYear()-n.getFullYear());r-=n.getMonth(),a=(r+=s.getMonth())<=0?1:Math.floor(r/this.increment+1);break;case"Days":i=Math.abs(n.getTime()-s.getTime()),l=Math.floor(i/864e5),a=Math.floor(l/this.increment+1);break;case"Hours":i=Math.abs(n.getTime()-s.getTime());var h=Math.floor(i/36e5);a=Math.floor(h/this.increment)+1;break;case"Minutes":i=Math.abs(n.getTime()-s.getTime());var d=Math.floor(i/6e4);a=Math.floor(d/this.increment)+1}return a},i.prototype.clearAxisLabel=function(){this.axisLabels=[],this.tooltipLabels=[],this.dateTimeAxisLabelInterval=[],this.labelValue=[]},i.prototype.clearMultipleRow=function(){this.multipleRow=[],this.multilevel=[]},Pe([sf.base.Complex({text:"",textStyle:t.axisTitleFont},c)],i.prototype,"title",void 0),Pe([sf.base.Property(!1)],i.prototype,"opposedPosition",void 0),Pe([sf.base.Property(null)],i.prototype,"labels",void 0),Pe([sf.base.Complex(t.axisLabelFont,r)],i.prototype,"textStyle",void 0),Pe([sf.base.Property(0)],i.prototype,"labelRotation",void 0),Pe([sf.base.Property(!1)],i.prototype,"isInversed",void 0),Pe([sf.base.Property("Category")],i.prototype,"valueType",void 0),Pe([sf.base.Property(1)],i.prototype,"increment",void 0),Pe([sf.base.Property("None")],i.prototype,"showLabelOn",void 0),Pe([sf.base.Property(null)],i.prototype,"minimum",void 0),Pe([sf.base.Property(null)],i.prototype,"maximum",void 0),Pe([sf.base.Property(null)],i.prototype,"interval",void 0),Pe([sf.base.Property("")],i.prototype,"labelFormat",void 0),Pe([sf.base.Property("Days")],i.prototype,"intervalType",void 0),Pe([sf.base.Property("Trim")],i.prototype,"labelIntersectAction",void 0),Pe([sf.base.Property(!1)],i.prototype,"enableTrim",void 0),Pe([sf.base.Property(35)],i.prototype,"maxLabelLength",void 0),Pe([sf.base.Complex({color:"#b5b5b5",width:0,type:"Rectangle"},f)],i.prototype,"border",void 0),Pe([sf.base.Collection([],m)],i.prototype,"multiLevelLabels",void 0),i}(sf.base.ChildProperty),Ve=function(){function e(e){this.heatMap=e,this.padding=10,this.drawSvgCanvas=new $(e)}return e.prototype.renderAxes=function(){this.initialClipRect=this.heatMap.initialClipRect;var e,t,i=this.heatMap;i.enableCanvasRendering||(e=this.heatMap.renderer.createGroup({id:i.element.id+"AxisCollection"}));for(var l=this.heatMap.axisCollections,a=0,n=l.length;a<n;a++){var s=l[a];"Horizontal"===s.orientation?(i.enableCanvasRendering||(t=this.heatMap.renderer.createGroup({id:i.element.id+"XAxisGroup"})),this.drawXAxisLine(t,s),this.drawXAxisTitle(s,t,s.rect),this.drawXAxisLabels(s,t,s.rect)):(t=i.renderer.createGroup({id:i.element.id+"YAxisGroup"}),this.drawYAxisLine(t,s),this.drawYAxisTitle(s,t,s.rect),this.drawYAxisLabels(s,t,s.rect)),s.multiLevelLabels.length>0&&this.drawMultiLevels(t,s),i.enableCanvasRendering||e.appendChild(t)}i.enableCanvasRendering||this.heatMap.svgObject.appendChild(e)},e.prototype.drawXAxisLine=function(e,t){var i=this.initialClipRect.y+(t.opposedPosition?0:this.initialClipRect.height),l=new Y(this.heatMap.element.id+"_XAxisLine",new W(this.initialClipRect.x,i,this.initialClipRect.x+this.initialClipRect.width,i),"transparent",0);this.drawSvgCanvas.drawLine(l,e)},e.prototype.drawYAxisLine=function(e,t){var i=this.initialClipRect.x+(t.opposedPosition?this.initialClipRect.width:0),l=new Y(this.heatMap.element.id+"_YAxisLine",new W(i,this.initialClipRect.y,i,this.initialClipRect.height+this.initialClipRect.y),"transparent",0);this.drawSvgCanvas.drawLine(l,e)},e.prototype.drawXAxisTitle=function(e,t,i){var l="0px"===e.textStyle.size?0:10,a=i.y+(e.opposedPosition?-(e.maxLabelSize.height+l+J(e.xAxisMultiLabelHeight)):e.maxLabelSize.height+l+J(e.xAxisMultiLabelHeight));if(e.title.text){var n=this.heatMap,s=e.title,o=O(s.text,s.textStyle),r=this.padding,h="Near"===s.textStyle.textAlignment?"start":"Far"===s.textStyle.textAlignment?"end":"middle";r=e.opposedPosition?-(r+o.height/4):r+3*o.height/4;var d=new j(n.element.id+"_XAxisTitle",new k(i.x+D(i.width,0,0,s.textStyle),a+r,h,s.text),s.textStyle,s.textStyle.color||n.themeStyle.axisTitle);this.drawSvgCanvas.createText(d,t,s.text)}},e.prototype.drawYAxisTitle=function(e,t,i){if(e.title.text){var l=e.title,a=this.heatMap,n=e.opposedPosition?90:-90,s=(O(l.text,l.textStyle),"Near"===l.textStyle.textAlignment?"start":"Far"===l.textStyle.textAlignment?"end":"middle"),o=10;o=e.opposedPosition?o:-o;var r="0px"===e.textStyle.size?0:o,h=i.x+r+(e.opposedPosition?e.maxLabelSize.width+J(e.yAxisMultiLabelHeight):-(e.maxLabelSize.width+J(e.yAxisMultiLabelHeight))),d=i.y+Z(i,0,0,l.textStyle)+(e.opposedPosition?this.padding:-this.padding),p=new j(a.element.id+"_YAxisTitle",new k(h,d-this.padding,s,l.text,n,"rotate("+n+","+h+","+d+")","auto"),l.textStyle,l.textStyle.color||a.themeStyle.axisTitle);this.heatMap.enableCanvasRendering?this.drawSvgCanvas.canvasDrawText(p,l.text,h,d):this.drawSvgCanvas.createText(p,t,l.text)}},e.prototype.calculateVisibleLabels=function(){for(var e,t=this.heatMap.axisCollections,i=this.heatMap.dataSourceSettings,l=!(i&&i.isJsonData&&"Cell"===i.adaptorType),a=0,n=t.length;a<n;a++)"Numeric"===(e=t[a]).valueType&&l?(e.clearAxisLabel(),e.calculateNumericAxisLabels(this.heatMap)):"DateTime"===e.valueType&&l?(e.clearAxisLabel(),e.calculateDateTimeAxisLabel(this.heatMap)):"Category"===e.valueType&&(e.clearAxisLabel(),e.calculateCategoryAxisLabels()),e.tooltipLabels=e.isInversed?e.tooltipLabels.reverse():e.tooltipLabels},e.prototype.measureAxis=function(e){for(var t,i=this.heatMap,l=i.axisCollections,a=l.length-1;a>=0;a--){var n="0px"===(t=l[a]).textStyle.size?0:this.padding;t.nearSizes=[],t.farSizes=[],t.computeSize(t,i,e),t.opposedPosition?"Horizontal"===t.orientation?(e.y+=J(t.farSizes)+n,e.height-=J(t.farSizes)+n):e.width-=J(t.farSizes)+n:"Horizontal"===t.orientation?e.height-=J(t.nearSizes)+n:(e.x+=J(t.nearSizes)+n,e.width-=J(t.nearSizes)+n)}},e.prototype.calculateAxisSize=function(e){for(var t=this.heatMap.axisCollections,i=0,l=t.length;i<l;i++){var a=t[i];a.rect=sf.base.extend({},e,null,!0),"Horizontal"!==a.orientation||a.opposedPosition||(a.rect.y=e.y+e.height,a.rect.height=0),"Vertical"===a.orientation&&a.opposedPosition&&(a.rect.x=e.x+e.width,a.rect.width=0),a.multiLevelPosition=[];for(var n=0;n<a.multiLevelLabels.length;n++){var s=a.multiPosition(a,n);a.multiLevelPosition.push(s)}}},e.prototype.drawXAxisLabels=function(e,t,i){var l,a=this.heatMap,n=e.axisLabels,s=this.heatMap.cellSettings.border.width>5?this.heatMap.cellSettings.border.width/2:0,o=(i.width-s)/e.axisLabelSize,r=0,h=e.interval?e.interval:1,d=i.width/(e.axisLabelSize/e.axisLabelInterval),p=e.axisLabelInterval;if(d>0)for(;d<parseInt(e.textStyle.size,10);)p+=1,d=i.width/(e.axisLabelSize/p);else p=e.tooltipLabels.length;e.axisLabelInterval<p&&(r=p,n=e.tooltipLabels,h=p);var g,c,u,b,f=i.x+(e.isInversed?i.width:0),v=e.angle;g=this.padding,a.enableCanvasRendering||(u=this.heatMap.renderer.createGroup({id:a.element.id+"XAxisLabels"}),b=this.heatMap.renderer.createGroup({id:a.element.id+"XAxisLabelBorder"})),e.isInversed&&"MultipleRows"===e.labelIntersectAction&&e.multipleRow.reverse();for(var y=0,m=n.length;y<m;y++){var x=new F(f,i.y,o,i.height),C="Trim"===e.labelIntersectAction&&e.isIntersect?"DateTime"!==e.valueType||"None"===e.showLabelOn?ee(o*h,n[y],e.textStyle):ee(e.dateTimeAxisLabelInterval[y]*o,n[y],e.textStyle):n[y],S=O(C=e.enableTrim?ee(e.maxLabelLength,n[y],e.textStyle):C,e.textStyle),M=void 0;c=e.opposedPosition?-g:g+(v%360==0?S.height/2:0);var w=x.x+(e.isInversed?-(x.width/2+S.width/2):x.width/2-S.width/2);if("Trim"===e.labelIntersectAction?w=e.isInversed?w>f-o?w:f-o:w>=x.x?w:x.x:v%180==0&&(w=(w=w<i.x?i.x:w)+S.width>i.x+i.width?i.x+i.width-S.width:w),"MultipleRows"===e.labelIntersectAction&&0===e.labelRotation){var L=e.opposedPosition?-(e.multipleRow[y].index-1):e.multipleRow[y].index-1;l=e.multipleRow[y].index>1?i.y+c+S.height*L+(e.opposedPosition?-.5*S.height/2*e.multipleRow[y].index:.5*S.height/2*e.multipleRow[y].index):i.y+c+(e.opposedPosition?-.5*S.height/2:.5*S.height/2)}else l=i.y+c;if(this.drawXAxisBorder(e,b,e.rect,w,S.width,y),v%360!=0){v=v>360?v%360:v;var R=q(e.textStyle,C,v),T=e.maxLabelSize.height-Math.ceil(R.height-S.height);e.opposedPosition;M="rotate("+v+","+(w=x.x+(e.isInversed?-x.width/2:x.width/2))+","+(l+=e.opposedPosition?-R.height/2:v%360==180||v%360==-180?0:R.height/2)+")"}this.heatMap.cellSettings.border.width>5&&e.opposedPosition&&(l-=this.heatMap.cellSettings.border.width/2),this.heatMap.yAxis.opposedPosition&&this.heatMap.cellSettings.border.width>5&&(w+=this.heatMap.cellSettings.border.width/2),this.heatMap.xAxis.isInversed&&this.heatMap.cellSettings.border.width>5&&(w-=this.heatMap.cellSettings.border.width/2);var P=new j(a.element.id+"_XAxis_Label"+y,new k(w,l,v%360==0?"start":"middle",C,v,M),e.textStyle,e.textStyle.color||a.themeStyle.axisLabel);if(0!==v&&this.heatMap.enableCanvasRendering?this.drawSvgCanvas.canvasDrawText(P,C):this.drawSvgCanvas.createText(P,u,C),0===r){var z="DateTime"===e.valueType&&"None"!==e.showLabelOn?e.dateTimeAxisLabelInterval[y]:e.axisLabelInterval;f+=e.isInversed?-z*o:z*o}else f+=e.isInversed?-r*o:r*o;-1!==C.indexOf("...")&&this.heatMap.tooltipCollection.push(new re(n[y],new F(w,l-S.height,S.width,S.height))),0!==r&&(y+=r-1)}a.enableCanvasRendering||(t.appendChild(u),t.appendChild(b))},e.prototype.drawYAxisLabels=function(e,t,i){var l,a=this.heatMap,n=e.axisLabels,s=i.height/e.axisLabelSize,o=0,r=i.height/(e.axisLabelSize/e.axisLabelInterval),h=e.axisLabelInterval;if(r>0)for(;r<parseInt(e.textStyle.size,10);)h+=1,r=i.height/(e.axisLabelSize/h);else h=e.tooltipLabels.length;e.axisLabelInterval<h&&(o=h,n=e.tooltipLabels);var d,p,g=10,c=i.y+(e.isInversed?0:i.height),u=e.opposedPosition?"start":"end";g=e.opposedPosition?g:-g,a.enableCanvasRendering||(d=this.heatMap.renderer.createGroup({id:a.element.id+"YAxisLabels"}),p=this.heatMap.renderer.createGroup({id:a.element.id+"YAxisLabelBorder"}));for(var b=0,f=n.length;b<f;b++){var v=new F(i.x,c,i.width,s),y=v.height/2,m=this.heatMap.cellSettings.border.width>=20?this.heatMap.cellSettings.border.width/2:0,x=v.x+g+(e.opposedPosition?m:-m),C=this.heatMap.cellSettings.border.width>5?this.heatMap.cellSettings.border.width/2/f*(e.isInversed?b:f-b):0,S=v.y-C+(e.isInversed?y:-y);l=e.enableTrim?ee(e.maxLabelLength,n[b],e.textStyle):n[b];var M=new j(a.element.id+"_YAxis_Label"+b,new k(x,S,u,l,0,"rotate(0,"+x+","+S+")","middle"),e.textStyle,e.textStyle.color||a.themeStyle.axisLabel);if(sf.base.Browser.isIE&&!a.enableCanvasRendering&&(M.dy="1ex"),this.drawSvgCanvas.createText(M,d,l),0===o){var w="DateTime"===e.valueType&&"None"!==e.showLabelOn?e.dateTimeAxisLabelInterval[b]:e.axisLabelInterval;c+=e.isInversed?w*s:-w*s}else c+=e.isInversed?o*s:-o*s,b+=o-1;var L=O(l,e.textStyle);if(this.drawYAxisBorder(e,p,e.rect,S,L.height,b),-1!==l.indexOf("...")){var R=e.opposedPosition?x:x-L.width;this.heatMap.tooltipCollection.push(new re(n[b],new F(R,S-L.height,L.width,L.height)))}}a.enableCanvasRendering||(t.appendChild(d),t.appendChild(p))},e.prototype.drawXAxisBorder=function(e,t,i,l,a,n){var s,o,r=i.width/e.axisLabelSize,h="",d=e.interval?e.interval:1,p=e.isInversed?i.x+i.width-r*n*d:i.x+r*n*d,g=i.y;switch(o=g+(e.opposedPosition?-(e.maxLabelSize.height+10):e.maxLabelSize.height+10),s=e.isInversed?p-r:p+r,e.border.type){case"Rectangle":h="M "+p+" "+g+" L "+p+" "+o+" L "+s+" "+o+" L "+s+" "+g+" L "+p+" "+g;break;case"WithoutTopBorder":h="M "+p+" "+g+" L "+p+" "+o+" L "+s+" "+o+" L "+s+" "+g+" ";break;case"WithoutBottomBorder":h="M "+p+" "+o+" L "+p+" "+g+" L "+s+" "+g+" L "+s+" "+o+" ";break;case"WithoutTopandBottomBorder":h="M "+p+" "+g+" L "+p+" "+o+" M "+s+" "+g+" L "+s+" "+o+" ";break;case"Brace":h="M "+p+" "+g+" L "+p+" "+(o=g+(o-g)/2+(e.opposedPosition?0:5))+" L "+(e.isInversed?l+a+3:l-3)+" "+o+" M "+(e.isInversed?l-3:l+a+3)+" "+o+" L "+s+" "+o+" L "+s+" "+g+" "}e.border.width>0&&"WithoutBorder"!==e.border.type&&this.createAxisBorderElement(e,h,t,n)},e.prototype.drawYAxisBorder=function(e,t,i,l,a,n){var s,o,r=i.height/e.axisLabelSize,h="",d=e.interval?e.interval:1,p=i.x,g=e.isInversed?i.y+r*n*d:i.y+i.height-r*n*d;switch(s=p+(e.opposedPosition?e.maxLabelSize.width+20:-(e.maxLabelSize.width+20)),o=e.isInversed?g+r:g-r,e.border.type){case"Rectangle":h="M "+p+" "+g+" L "+p+" "+o+" L "+s+" "+o+" L "+s+" "+g+" L "+p+" "+g;break;case"WithoutTopBorder":h="M "+p+" "+g+" L "+s+" "+g+" L "+s+" "+o+" L "+p+" "+o+" ";break;case"WithoutBottomBorder":h="M "+s+" "+g+" L "+p+" "+g+" L "+p+" "+o+" L "+s+" "+o+" ";break;case"WithoutTopandBottomBorder":h="M "+p+" "+g+" L "+s+" "+g+" M "+s+" "+o+" L "+p+" "+o+" ";break;case"Brace":h="M "+p+" "+g+" L "+(s=p-(p-s)/2)+" "+g+" L "+s+" "+(e.isInversed?l-a/2:l+a/2)+" M "+s+" "+(e.isInversed?l+a/2:l-a/2)+" L "+s+" "+o+" L "+p+" "+o}e.border.width>0&&"WithoutBorder"!==e.border.type&&this.createAxisBorderElement(e,h,t,n)},e.prototype.createAxisBorderElement=function(e,t,i,l){var a="Horizontal"===e.orientation?"_XAxis_Label_Border":"_YAxis_Label_Border",n=new B(this.heatMap.element.id+a+l,"transparent",e.border.width,e.border.color,1,"none",t);if(this.heatMap.enableCanvasRendering)this.heatMap.canvasRenderer.drawPath(n,void 0);else{var s=this.heatMap.renderer.drawPath(n);i.appendChild(s)}},e.prototype.drawMultiLevels=function(e,t){var i;this.heatMap.enableCanvasRendering||(i=this.heatMap.renderer.createGroup({id:this.heatMap.element.id+"_"+t.orientation+"_MultiLevelLabel"})),"Horizontal"===t.orientation?this.renderXAxisMultiLevelLabels(t,i,t.rect):this.renderYAxisMultiLevelLabels(t,i,t.rect),this.heatMap.enableCanvasRendering||e.appendChild(i)},e.prototype.renderXAxisMultiLevelLabels=function(e,t,i){var l,a,n,s,o,r,h,d,p,g,c,u=this,b=0,f=0,v=e.isInversed,y=e.opposedPosition,m="",x=(v?e.rect.width:0)+e.rect.x;e.multiLevelLabels.map((function(i,C){p=u.heatMap.renderer.createGroup({id:u.heatMap.element.id+"_XAxisMultiLevelLabel"+C}),i.categories.map((function(S,M){s=!1,o="number"==typeof S.start?S.start:Number(new Date(S.start)),r="number"==typeof S.end?S.end:Number(new Date(S.end)),a=x+u.calculateLeftPosition(e,o,S.start,e.rect),n=e.multiLevelPosition[C].y,f=x+u.calculateWidth(e,S.end,r,e.rect),h=O(S.text,i.textStyle),g=(null===S.maximumTextWidth?Math.abs(f-a):S.maximumTextWidth)-10,l=n+(y?-(e.xAxisMultiLabelHeight[C]-h.height):h.height),S.maximumTextWidth?S.maximumTextWidth:h.width,b=v?a-g:a+10,"Center"===i.alignment?(b=(f-a)/2+a,b-=(h.width>g?g:h.width)/2):"Far"===i.alignment?(b=v?a-10:f-10,b-=h.width>g?g:h.width):b=v?f+10:a+10,"None"===i.overflow&&h.width>Math.abs(f-a)&&(b=v?a-h.width-10:a+10,d="start");var w=new k(b,l,d,S.text,0,"translate(0,0)"),L=new j(u.heatMap.element.id+"_XAxis_MultiLevel"+C+"_Text"+M,w,i.textStyle,i.textStyle.color||u.heatMap.themeStyle.axisLabel);if("Wrap"===i.overflow?(L.text=Q(S.text,g,i.textStyle),c=L.text.length):"Trim"===i.overflow&&(L.text=ee(g,S.text,i.textStyle),c=1),"Wrap"===i.overflow&&L.text.length>1){u.drawSvgCanvas.createWrapText(L,i.textStyle,p);for(var R=0;R<L.text.length;R++)if(-1!==L.text[R].indexOf("...")){s=!0;break}}else u.drawSvgCanvas.createText(L,p,L.text);u.heatMap.enableCanvasRendering||t.appendChild(p),(-1!==L.text.indexOf("...")||-1!==L.text[0].indexOf("...")||s)&&u.heatMap.tooltipCollection.push(new re(S.text,new F(b,l-h.height,g,h.height*c))),i.border.width>0&&"WithoutBorder"!==i.border.type&&(m=u.renderXAxisLabelBorder(C,e,a,n,f,m,C,h,g,b))})),""!==m&&(u.createBorderElement(C,e,m,t),m="")})),this.heatMap.enableCanvasRendering||t.appendChild(p)},e.prototype.renderXAxisLabelBorder=function(e,t,i,l,a,n,s,o,r,h){var d=l+(t.opposedPosition?-t.xAxisMultiLabelHeight[e]:t.xAxisMultiLabelHeight[e]);switch(t.multiLevelLabels[s].border.type){case"Rectangle":n+="M "+i+" "+l+" L "+i+" "+d+" L "+a+" "+d+" L "+a+" "+l+" L "+i+" "+l+" ";break;case"WithoutTopBorder":n+="M "+i+" "+l+" L "+i+" "+d+" L "+a+" "+d+" L "+a+" "+l+" ";break;case"WithoutBottomBorder":n+="M "+i+" "+d+" L "+i+" "+l+" L "+a+" "+l+" L "+a+" "+d+" ";break;case"WithoutTopandBottomBorder":n+="M "+i+" "+l+" L "+i+" "+d+" M "+a+" "+l+" L "+a+" "+d+" ";break;case"Brace":n+="M "+i+" "+l+" L "+i+" "+(l+(d-l)/2)+" L "+(t.isInversed?(o.width>r?r:o.width)+h+3:h-3)+" "+(l+(d-l)/2)+" M "+(t.isInversed?h-3:(o.width>r?r:o.width)+h+3)+" "+(l+(d-l)/2)+" L "+a+" "+(l+(d-l)/2)+" L "+a+" "+l+" "}return n},e.prototype.renderYAxisMultiLevelLabels=function(e,t,i){var l,a,n,s,o,r,h,d,p,g,c=this,u=0,b=e.isInversed,f=(e.opposedPosition,""),v=(e.rect.height,e.axisLabelSize,e.increment,(b?0:e.rect.height)+e.rect.y);e.multiLevelLabels.map((function(i,y){e.multiLevelPosition[y].y,d=c.heatMap.renderer.createGroup({id:c.heatMap.element.id+"_YAxisMultiLevelLabel"+y}),i.categories.map((function(m,x){o="number"==typeof m.start?m.start:Number(new Date(m.start)),r="number"==typeof m.end?m.end:Number(new Date(m.end)),n=v+c.calculateLeftPosition(e,o,m.start,e.rect),a=e.multiLevelPosition[y].x,s=v+c.calculateWidth(e,m.start,r,e.rect),h=O(m.text,i.textStyle),p=(null===m.maximumTextWidth?Math.abs(a):m.maximumTextWidth)-10;var C=Math.abs(a-(a-e.multiLevelSize[y].width-20))/2-h.width/2;u=(e.opposedPosition?a:a-e.multiLevelSize[y].width-20)+C,l=n+10,"None"!==i.overflow&&(g="Wrap"===i.overflow?Q(m.text,p,i.textStyle):ee(p,m.text,i.textStyle)),"Center"===i.alignment?l+=(s-n)/2-g.length*h.height/2:l="Far"===i.alignment?b?s-h.height/2:l-h.height:b?l+h.height/2:s+h.height,i.border.width>0&&"WithoutBorder"!==i.border.type&&(f=c.renderYAxisLabelBorder(y,e,a,n,s,f,y,h,p,l));var S=new k(u,l,"start",m.text,0,"translate(0,0)"),M=new j(c.heatMap.element.id+"_YAxis_MultiLevel"+y+"_Text"+x,S,i.textStyle,i.textStyle.color||c.heatMap.themeStyle.axisLabel);M.text=g,c.drawSvgCanvas.createText(M,d,M.text),-1!==M.text.indexOf("...")&&c.heatMap.tooltipCollection.push(new re(m.text,new F(u,l-h.height,p,h.height))),c.heatMap.enableCanvasRendering||t.appendChild(d)})),""!==f&&(c.createBorderElement(y,e,f,t),f="")})),this.heatMap.enableCanvasRendering||t.appendChild(d)},e.prototype.renderYAxisLabelBorder=function(e,t,i,l,a,n,s,o,r,h){var d=i-(t.opposedPosition?-(t.multiLevelSize[e].width+20):t.multiLevelSize[e].width+20);switch(t.multiLevelLabels[s].border.type){case"Rectangle":n+="M "+i+" "+l+" L "+d+" "+l+" L "+d+" "+a+" L "+i+" "+a+" L "+i+" "+l+" ";break;case"WithoutTopBorder":n+="M "+i+" "+l+" L "+d+" "+l+" L "+d+" "+a+" L "+i+" "+a+" ";break;case"WithoutBottomBorder":n+="M "+d+" "+l+" L "+i+" "+l+" L "+i+" "+a+" L "+d+" "+a+" ";break;case"WithoutTopandBottomBorder":n+="M "+i+" "+l+" L "+d+" "+l+" M "+i+" "+a+" L "+d+" "+a+" ";break;case"Brace":n+="M "+i+" "+l+" L "+(i+(d-i)/2)+" "+l+" L "+(i+(d-i)/2)+" "+(t.isInversed?h-10-5:h+o.height-10)+" M "+(i+(d-i)/2)+" "+(t.isInversed?h+o.height-10:h-10-5)+" L "+(i+(d-i)/2)+" "+a+" L "+i+" "+a+" "}return n},e.prototype.createBorderElement=function(e,t,i,l){var a="Horizontal"===t.orientation?"XAxis":"YAxis",n=new B(this.heatMap.element.id+"_"+a+"_MultiLevel_Rect_"+e,"Transparent",t.multiLevelLabels[e].border.width,t.multiLevelLabels[e].border.color,1,"",i),s=this.heatMap.renderer.drawPath(n);this.heatMap.enableCanvasRendering?this.heatMap.canvasRenderer.drawPath(n,void 0):l.appendChild(s)},e.prototype.calculateLeftPosition=function(e,t,i,l){var a,n;if("number"==typeof i){if("Numeric"===e.valueType&&(e.minimum||e.maximum))t-=e.minimum?e.minimum:0;n=("Horizontal"===e.orientation?l.width:l.height)/(e.axisLabelSize*e.increment),a=(e.isInversed?-1:1)*t*n,a="Horizontal"===e.orientation?a:-a}else n=this.calculateNumberOfDays(t,e,!0,l),a=e.isInversed?-n:n,a="Horizontal"===e.orientation?a:-a;return a},e.prototype.calculateWidth=function(e,t,i,l){var a,n;if("number"==typeof t){if("Numeric"===e.valueType&&(e.minimum||e.maximum))i-=e.minimum?e.minimum:0;a=("Horizontal"===e.orientation?l.width:l.height)/(e.axisLabelSize*e.increment),n=(e.isInversed?-1:1)*(i+1)*a,n="Horizontal"===e.orientation?n:-n}else n=a=this.calculateNumberOfDays(i,e,!1,l),n=e.isInversed?-n:n,n="Horizontal"===e.orientation?n:-n;return n},e.prototype.calculateNumberOfDays=function(e,t,i,l){for(var a,n,s,o=t.labelValue,r=("Horizontal"===t.orientation?l.width:l.height)/t.axisLabelSize,h=new Date(Number(e)),d=0,p=0;p<t.axisLabelSize;p++){if(a=new Date(Number(o[p])),n=t.isInversed?new Date(Number(o[p-1])):new Date(Number(o[p+1])),p===(t.isInversed?0:t.axisLabelSize-1))if(n=new Date(Number(o[p])),"Hours"===t.intervalType)n=new Date(Number(n.setHours(n.getHours()+1)));else if("Minutes"===t.intervalType)n=new Date(Number(n.setMinutes(n.getMinutes()+1)));else if("Days"===t.intervalType)n=new Date(Number(n.setDate(n.getDate()+1)));else{var g="Months"===t.intervalType?new Date(n.getFullYear(),n.getMonth()+1,0).getDate():n.getFullYear()%4==0?366:365;n=new Date(Number(n.setDate(n.getDate()+g)))}if(Number(a)<=e&&Number(n)>=e){if("Minutes"===t.intervalType||"Hours"===t.intervalType){d=r/Math.round(Math.abs((a.getTime()-n.getTime())/6e4))*Math.abs((a.getTime()-h.getTime())/6e4),s=(p=t.isInversed?t.axisLabelSize-1-p:p)*r+d;break}g=Math.round(Math.abs((a.getTime()-n.getTime())/864e5));i?h.getDate():h.setDate(h.getDate()+1),0!==g&&(d=r/g*Math.abs((a.getTime()-h.getTime())/864e5)),s=(p=t.isInversed?t.axisLabelSize-1-p:p)*r+d;break}}return s},e}(),Oe=(Ce=function(e,t){return(Ce=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Ce(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Ae=function(e,t,l,a){var n,s=arguments.length,o=s<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,l):a;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,l,a);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(o=(s<3?n(o):s>3?n(t,l,o):n(t,l))||o);return s>3&&o&&Object.defineProperty(t,l,o),o},De=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Oe(i,e),Ae([sf.base.Property(!0)],i.prototype,"showLabel",void 0),Ae([sf.base.Property("")],i.prototype,"format",void 0),Ae([sf.base.Property(!0)],i.prototype,"enableCellHighlighting",void 0),Ae([sf.base.Complex({},v)],i.prototype,"bubbleSize",void 0),Ae([sf.base.Complex({},d)],i.prototype,"border",void 0),Ae([sf.base.Complex(t.rectLabelFont,r)],i.prototype,"textStyle",void 0),Ae([sf.base.Property("Rect")],i.prototype,"tileType",void 0),Ae([sf.base.Property("Color")],i.prototype,"bubbleType",void 0),Ae([sf.base.Property(!1)],i.prototype,"isInversedBubbleSize",void 0),i}(sf.base.ChildProperty),_e=function(){function e(e){this.heatMap=e,this.drawSvgCanvas=new $(this.heatMap),this.cellColor=new P(this.heatMap)}return e.prototype.renderRectSeries=function(){this.createSeriesGroup();var e=this.heatMap,t=!1;e.xLength=e.axisCollections[0].axisLabelSize,e.yLength=e.axisCollections[1].axisLabelSize;var i,l,a,n,s=Math.round(100*e.initialClipRect.x)/100,o=Math.round(100*e.initialClipRect.y)/100,r=0,h=0,d=e.cellSettings,p=Math.round((e.initialClipRect.width-d.border.width/2)/e.xLength*100)/100,g=Math.round((e.initialClipRect.height-d.border.width/2)/e.yLength*100)/100,c=0,u=(e.themeStyle,[]);i=d.border,this.rectPositionCollection=[],this.color="",this.bubbleColorValue=[],e.yAxis.opposedPosition&&(s=Math.round(100*(e.initialClipRect.x+parseFloat(i.width.toString())/2))/100),l=this.getBubbleRadius(p,g);for(var b=0;b<e.xLength*e.yLength;b++){"Column"===e.paletteSettings.colorGradientMode&&"Gradient"===this.heatMap.paletteSettings.type?(this.heatMap.dataSourceMinValue=this.heatMap.dataMin[h],this.heatMap.dataSourceMaxValue=this.heatMap.dataMax[h]):"Row"===e.paletteSettings.colorGradientMode&&"Gradient"===this.heatMap.paletteSettings.type&&(this.heatMap.dataSourceMinValue=this.heatMap.dataMin[r],this.heatMap.dataSourceMaxValue=this.heatMap.dataMax[r]),this.setTextAndColor(r,h);var f=new N(0,0,0,0,0,"",0,0,0,0,!0,"","",!0);if(a=i.color,this.heatMap.bubbleSizeWithColor?this.updateRectDetails(f,s,o,p,g,sf.base.extend("",this.bubbleColorValue,null,!0),b,h,r):this.updateRectDetails(f,s,o,p,g,this.text,b,h,r),n=d.showLabel?this.getFormatedText(this.text,d.format):"",f.displayText=n,sf.base.isNullOrUndefined(this.heatMap.cellRender)||(n=this.cellRendering(f,n)),("Canvas"===e.renderingMode&&0===parseFloat(i.width.toString())||!a&&"Bubble"===d.tileType&&"Sector"===d.bubbleType)&&(a=this.color),"Rect"===d.tileType)this.renderTileCell(f,i,b,this.color,a),this.updateLabelVisibleStatus(p,g,n);else if("Color"===d.bubbleType)this.renderBubbleCell(f,i,b,this.color,a,l),this.updateLabelVisibleStatus(2*l-12,2*l-6,n);else if(sf.base.isNullOrUndefined(this.text)||"Size"!==d.bubbleType&&"SizeAndColor"!==d.bubbleType||""===this.text.toString())"Sector"!==d.bubbleType||sf.base.isNullOrUndefined(this.text)||""===this.text.toString()||(this.renderSectorCell(f,i,b.toString(),this.color,a,l,this.text),this.checkLabelXDisplay=!1,this.checkLabelYDisplay=!1);else{"Table"!==this.heatMap.paletteSettings.colorGradientMode&&"Gradient"===this.heatMap.paletteSettings.type&&(this.heatMap.minColorValue=isFinite(this.heatMap.minColorValue)?this.heatMap.minColorValue:this.heatMap.dataSourceMinValue,this.heatMap.maxColorValue=isFinite(this.heatMap.maxColorValue)?this.heatMap.maxColorValue:this.heatMap.dataSourceMaxValue);var v=this.getRadiusBypercentage(parseFloat(this.text.toString()),e.dataSourceMinValue,e.dataSourceMaxValue,l);this.renderBubbleCell(f,i,b,this.color,a,v),this.updateLabelVisibleStatus(2*v-12,2*v-6,n)}if(u.push(f),e.rangeSelection&&"Fixed"===e.paletteSettings.type&&(t=this.isCellValueInRange(r,h),f.visible=t),d.showLabel&&this.checkLabelYDisplay&&this.checkLabelXDisplay){var y=d.textStyle,m=new j(e.element.id+"_HeatMapRectLabels_"+b,new k(Math.round(100*(s+p/2))/100,Math.round(100*(o+g/2))/100,"middle",n,null,null,"middle"),y,y.color||this.getSaturatedColor(this.color));f.textId=m.id,e.rangeSelection&&"Fixed"===e.paletteSettings.type&&(m.fill=t?m.fill:this.heatMap.themeStyle.toggledColor),sf.base.Browser.isIE&&!e.enableCanvasRendering&&(m.dy="Bubble"===this.heatMap.cellSettings.tileType?"0.5ex":"1ex"),this.drawSvgCanvas.createText(m,this.containerTextObject,n)}c===e.xLength-1?(o=Math.round(100*(o+g))/100,c=0,h=0,s=e.yAxis.opposedPosition?Math.round(100*(e.initialClipRect.x+parseFloat(i.width.toString())/2))/100:Math.round(100*e.initialClipRect.x)/100,this.rectPositionCollection.push(u),u=[],r++):(s=Math.round(100*(s+p))/100,c++,h++)}e.enableCanvasRendering||(e.svgObject.appendChild(this.containerRectObject),!d.showLabel||"Bubble"===d.tileType&&"Sector"===d.bubbleType||e.svgObject.appendChild(this.containerTextObject))},e.prototype.isCellValueInRange=function(e,t){for(var i=!1,l=0;l<this.heatMap.toggleValue.length;l++){var a,n=void 0;a=0!==l||this.heatMap.isColorRange?this.heatMap.isColorRange?this.heatMap.toggleValue[l].startValue:this.heatMap.toggleValue[l].value:this.heatMap.dataSourceMinValue,n="Bubble"===this.heatMap.cellSettings.tileType&&"SizeAndColor"===this.heatMap.cellSettings.bubbleType?l===this.heatMap.toggleValue.length-1?this.heatMap.maxColorValue:this.heatMap.toggleValue[l+1].value-.01:l!==this.heatMap.toggleValue.length-1||this.heatMap.isColorRange?this.heatMap.isColorRange?this.heatMap.toggleValue[l].endValue:this.heatMap.toggleValue[l+1].value-.01:this.heatMap.dataSourceMaxValue;var s=this.heatMap.clonedDataSource,o=sf.base.isNullOrUndefined(s[e][t][1])||""===s[e][t][1].toString()?"":s[e][t][1],r=parseFloat("Bubble"===this.heatMap.cellSettings.tileType&&"SizeAndColor"===this.heatMap.cellSettings.bubbleType?o.toString():this.text.toString());if(isNaN(r))i=!0;else{if(!isNaN(r)&&r>=a&&r<=n){if(this.heatMap.toggleValue[l].visible){i=!0;break}i=!1;break}if(this.heatMap.isColorRange&&n>=this.heatMap.toggleValue[l].endValue&&l===this.heatMap.toggleValue.length-1){i=!0;break}}}return i},e.prototype.cellRendering=function(e,t){var i=this.heatMap.axisCollections[0],l=this.heatMap.axisCollections[1],a=i.tooltipLabels,n=l.tooltipLabels.slice().reverse(),s=l.labelValue.slice().reverse(),o={heatmap:this.heatMap.isBlazor?null:this.heatMap,cancel:!1,name:"cellRender",value:e.value,xLabel:a[e.xIndex].toString(),yLabel:n[e.yIndex].toString(),displayText:t,xValue:i.labelValue[e.xIndex],yValue:s[e.yIndex],cellColor:this.color};return this.heatMap.trigger("cellRender",o),this.color=o.cellColor,o.displayText},e.prototype.setTextAndColor=function(e,t){this.heatMap.cellSettings;this.bubbleColorValue=[];var i=this.heatMap.dataSourceSettings,l=this.heatMap.clonedDataSource;if(this.heatMap.bubbleSizeWithColor){this.text=sf.base.isNullOrUndefined(l[e][t][0])||""===l[e][t][0].toString()?"":l[e][t][0],this.color=sf.base.isNullOrUndefined(l[e][t][1])||""===l[e][t][1].toString()?this.heatMap.isColorValueExist?this.heatMap.emptyPointColor:this.cellColor.getColorByValue(this.text):this.cellColor.getColorByValue(l[e][t][1]);var a=new C(i.isJsonData&&"Cell"===i.adaptorType?i.bubbleDataMapping.size:null,this.text,"Size");this.bubbleColorValue.push(a),this.bubbleColorValue.push({mappingName:i.isJsonData&&"Cell"===i.adaptorType?i.bubbleDataMapping.color:null,bubbleData:sf.base.isNullOrUndefined(l[e][t][1])||""===l[e][t][1].toString()?"":l[e][t][1],valueType:"Color"})}else this.text=l[e][t],this.color=this.cellColor.getColorByValue(this.text)},e.prototype.createSeriesGroup=function(){this.heatMap.enableCanvasRendering||(this.containerRectObject=this.heatMap.renderer.createGroup({id:this.heatMap.element.id+"_Container_RectGroup"}),!this.heatMap.cellSettings.showLabel||"Bubble"===this.heatMap.cellSettings.tileType&&"Sector"===this.heatMap.cellSettings.bubbleType||(this.containerTextObject=this.heatMap.renderer.createGroup({id:this.heatMap.element.id+"_Container_TextGroup",transform:"translate( 0, 0)"})))},e.prototype.updateRectDetails=function(e,t,i,l,a,n,s,o,r){e.x=t,e.y=i,e.width=l,e.height=a,e.value=n,e.id=this.heatMap.element.id+"_HeatMapRect_"+s,e.xIndex=o,e.yIndex=r},e.prototype.renderTileCell=function(e,t,i,l,a){var n=new G(this.heatMap.element.id+"_HeatMapRect_"+i,l,t,1,new F(e.x,e.y,e.width,e.height),a||this.heatMap.themeStyle.cellBorder,t.radius,t.radius);this.drawSvgCanvas.drawRectangle(n,this.containerRectObject,!0)},e.prototype.getBubbleRadius=function(e,t){var i=e/2-2;return t/2<e/2&&(i=t/2-2),i<0?0:i},e.prototype.renderSectorCell=function(e,t,i,l,a,n,s){for(var o,r,h,d,p,g,c,u,b,f,v=Math.round(100*(e.x+e.width/2))/100,y=Math.round(100*(e.y+e.height/2))/100,m=l,x=this.getRadiusBypercentage(s,this.heatMap.dataSourceMinValue,this.heatMap.dataSourceMaxValue,360),C=0;C<2;C++){f=parseFloat(t.width.toString()),0===C?(o=x>=180?1:0,r=-90,h=0===x?270:x-90,d=Math.round(100*(v+n*Math.cos((x-90)*(Math.PI/180))))/100,p=Math.round(100*(y+n*Math.sin((x-90)*(Math.PI/180))))/100,g=Math.round(100*v)/100,c=Math.round(100*(y-n))/100,0===x&&(m=this.heatMap.emptyPointColor)):(o=x>=180?0:1,r=h,h=270,m=this.heatMap.emptyPointColor,i+="_Unfilled",u=d,b=p,d=g,p=c,g=u,c=b,0===x&&(f=1,a=l));var S=new X("",!1,v,y,g,c,d,p,r,h,n,!0),M=new U(this.heatMap.element.id+"_HeatMapRect_"+i,S,m,t,f,1,a);if(this.calculateShapes(M,S,x,o),this.drawSvgCanvas.drawPath(M,S,this.containerRectObject),360===x)break}},e.prototype.calculateShapes=function(e,t,i,l){var a;switch(i){case 360:case 0:a=0===i&&t.start===t.end?"M "+e.x+" "+e.y+" L "+t.x+" "+(t.y-t.radius):(a=this.heatMap.enableCanvasRendering?"":"M "+e.x+" "+e.y+" ")+"m "+-t.radius+" 0 a "+t.radius+" "+t.radius+" 0 1 0 "+2*t.radius+" 0 a "+t.radius+" "+t.radius+" 0 1 0 "+-2*t.radius+" 0 ",sf.base.merge(e,{d:a});break;default:a="M "+e.x+" "+e.y+" L "+t.x1+" "+t.y1+" A "+t.radius+" "+t.radius+" 0 "+l+" 1 "+t.cx+" "+t.cy+" Z",sf.base.merge(e,{d:a})}},e.prototype.renderBubbleCell=function(e,t,i,l,a,n){var s=new H(this.heatMap.element.id+"_HeatMapRect_"+i,l,t,1,a||this.heatMap.themeStyle.cellBorder,Math.round(100*(e.x+e.width/2))/100,Math.round(100*(e.y+e.height/2))/100,n);this.drawSvgCanvas.drawCircle(s,this.containerRectObject)},e.prototype.updateLabelVisibleStatus=function(e,t,i){this.heatMap.cellSettings.showLabel&&(this.checkLabelYDisplay=t>parseInt(this.heatMap.cellSettings.textStyle.size,10),this.checkLabelXDisplay=e>i.length*(parseInt(this.heatMap.cellSettings.textStyle.size,10)/2))},e.prototype.getRadiusBypercentage=function(e,t,i,l){var a=parseInt(this.heatMap.cellSettings.bubbleSize.minimum,10),n=parseInt(this.heatMap.cellSettings.bubbleSize.maximum,10);(a<0||a>100||isNaN(a))&&(a=0),(n<0||n>100||isNaN(n))&&(n=100);var s=(e-t)/(i-t)*100;return s=isNaN(s)?100:s,(this.heatMap.bubbleSizeWithColor||"Bubble"===this.heatMap.cellSettings.tileType&&"Size"===this.heatMap.cellSettings.bubbleType)&&(this.heatMap.cellSettings.isInversedBubbleSize&&(s=100-s),s=s*(n-a)/100+a),l*=s/100,Math.round(100*l)/100<0?0:Math.round(100*l)/100},e.prototype.getSaturatedColor=function(e){var t=e,i=ye(be(t="transparent"===t?window.getComputedStyle(document.body,null).backgroundColor:t));return Math.round((299*i.R+587*i.G+114*i.B)/1e3)>=128?"black":"white"},e.prototype.highlightSvgRect=function(e){if(-1===e.indexOf("Celltooltip"))if(-1!==e.indexOf("_HeatMapRect")){if(-1!==e.indexOf("_HeatMapRectLabels_")){var t=e.indexOf("_HeatMapRectLabels_")+19;e=this.heatMap.element.id+"_HeatMapRect_"+e.slice(t)}var i=document.getElementById(e);if(this.heatMap.tempRectHoverClass!==e){if(this.heatMap.cellSettings.enableCellHighlighting){var l=void 0;this.heatMap.tempRectHoverClass&&(l=document.getElementById(this.heatMap.tempRectHoverClass)),l&&!this.heatMap.rectSelected&&l.setAttribute("opacity","1"),i&&!this.heatMap.rectSelected&&i.setAttribute("opacity","0.65")}this.heatMap.tempRectHoverClass=e}}else if(this.heatMap.cellSettings.enableCellHighlighting){l=void 0;this.heatMap.tempRectHoverClass&&(l=document.getElementById(this.heatMap.tempRectHoverClass)),l&&!this.heatMap.rectSelected&&(l.setAttribute("opacity","1"),this.heatMap.tempRectHoverClass="")}},e.prototype.getFormatedText=function(e,t){var i=t,l=null!==i.match("{value}");this.format=this.heatMap.intl.getNumberFormat({format:l?"":i});var a="";return""!==e.toString()&&(a=me(l,i,e,this.format)),a},e.prototype.getCurrentRect=function(e,t){var i,l=[];l.push(this.heatMap.heatMapSeries.rectPositionCollection[0][0]);var a=Math.ceil((e-l[0].x)/l[0].width)<this.heatMap.axisCollections[0].axisLabelSize?Math.ceil((e-l[0].x)/l[0].width):this.heatMap.axisCollections[0].axisLabelSize,n=Math.floor((t-l[0].y)/l[0].height)<this.heatMap.axisCollections[1].axisLabelSize?Math.floor((t-l[0].y)/l[0].height):this.heatMap.axisCollections[1].axisLabelSize-1;return a=0===a?1:a,i=this.heatMap.heatMapSeries.rectPositionCollection[n][a-1],this.hoverXAxisLabel=this.heatMap.axisCollections[0].tooltipLabels[a-1],this.hoverXAxisValue=this.heatMap.axisCollections[0].labelValue[a-1],this.hoverYAxisLabel=this.heatMap.axisCollections[1].tooltipLabels[this.heatMap.axisCollections[1].tooltipLabels.length-1-n],this.hoverYAxisValue=this.heatMap.axisCollections[1].labelValue[this.heatMap.axisCollections[1].labelValue.length-1-n],i},e}(),Ie=(Se=function(e,t){return(Se=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Se(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Be=function(e,t,l,a){var n,s=arguments.length,o=s<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,l):a;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,l,a);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(o=(s<3?n(o):s>3?n(t,l,o):n(t,l))||o);return s>3&&o&&Object.defineProperty(t,l,o),o},Ne=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Ie(i,e),Be([sf.base.Property("")],i.prototype,"template",void 0),Be([sf.base.Property("")],i.prototype,"fill",void 0),Be([sf.base.Complex({},p)],i.prototype,"border",void 0),Be([sf.base.Complex(t.tooltipFont,r)],i.prototype,"textStyle",void 0),i}(sf.base.ChildProperty),Ee=function(){function e(e){this.isFirst=!0,this.isFadeout=!1,this.heatMap=e}return e.prototype.getModuleName=function(){return"Tooltip"},e.prototype.showHideTooltip=function(e,t){var i=document.getElementById(this.heatMap.element.id+"Celltooltipcontainer");if(e)i.style.visibility="visible";else{if(i&&"hidden"!==i.style.visibility){if(this.tooltipObject&&t&&this.heatMap.isRectBoundary)this.tooltipObject.fadeOut();else if(this.tooltipObject&&this.tooltipObject.element)this.tooltipObject.element.firstChild.setAttribute("opacity","0");i.style.visibility="hidden"}this.isFadeout=!0}},e.prototype.destroy=function(e){},e.prototype.createTooltip=function(e,t,i,l){var a=null,n=sf.base.select("#"+this.heatMap.element.id+"Celltooltipcontainer");this.heatMap.cellSettings.showLabel&&this.heatMap.heatMapSeries.checkLabelXDisplay&&this.heatMap.heatMapSeries.checkLabelYDisplay&&(a=parseInt(this.heatMap.cellSettings.textStyle.size,10)/2),this.tooltipObject=new sf.svgbase.Tooltip({enableAnimation:!1,offset:a,location:{x:t,y:i},availableSize:this.heatMap.availableSize,data:{xValue:this.heatMap.heatMapSeries.hoverXAxisValue,yValue:this.heatMap.heatMapSeries.hoverYAxisValue,value:e.value,xLabel:this.heatMap.heatMapSeries.hoverXAxisLabel?this.heatMap.heatMapSeries.hoverXAxisLabel.toString():null,yLabel:this.heatMap.heatMapSeries.hoverYAxisLabel?this.heatMap.heatMapSeries.hoverYAxisLabel.toString():null},theme:this.heatMap.theme,content:l,fill:this.heatMap.tooltipSettings.fill,template:""===this.heatMap.tooltipSettings.template?null:this.heatMap.tooltipSettings.template,border:{width:this.heatMap.tooltipSettings.border.width,color:this.heatMap.tooltipSettings.border.color},textStyle:{size:this.heatMap.tooltipSettings.textStyle.size,fontWeight:this.heatMap.tooltipSettings.textStyle.fontWeight.toLowerCase(),color:this.heatMap.tooltipSettings.textStyle.color,fontStyle:this.heatMap.tooltipSettings.textStyle.fontStyle.toLowerCase(),fontFamily:this.heatMap.tooltipSettings.textStyle.fontFamily},areaBounds:{height:this.heatMap.initialClipRect.height+this.heatMap.initialClipRect.y,width:this.heatMap.initialClipRect.width,x:this.heatMap.initialClipRect.x}},n)},e.prototype.createTooltipDiv=function(e){var t=e.enableCanvasRendering&&e.allowSelection?e.availableSize.height:0,i=sf.base.createElement("div",{id:this.heatMap.element.id+"Celltooltipcontainer",styles:"position:absolute; z-index: 3;top:-"+t+"px"});this.heatMap.element.appendChild(sf.base.createElement("div",{id:this.heatMap.element.id+"Celltooltipparent",styles:"position:relative"}).appendChild(i))},e.prototype.getTooltipContent=function(e,t){var i,l,a=this.heatMap,n=this.heatMap.dataSourceSettings;if(a.bubbleSizeWithColor){var s=a.xAxis.title&&""!==a.xAxis.title.text?a.xAxis.title.text:"X-Axis",o=a.yAxis.title&&""!==a.yAxis.title.text?a.yAxis.title.text:"Y-Axis",r=n.isJsonData&&"Cell"===n.adaptorType?n.bubbleDataMapping.size:"Value 1",h=n.isJsonData&&"Cell"===n.adaptorType?n.bubbleDataMapping.color:"Value 2";i=t.getFormatedText(e.value[0].bubbleData,this.heatMap.cellSettings.format),l=[s+" : "+t.hoverXAxisLabel+"<br/>"+o+" : "+t.hoverYAxisLabel+"<br/>"+r+" : "+i+"<br/>"+h+" : "+t.getFormatedText(e.value[1].bubbleData,this.heatMap.cellSettings.format)]}else i=e.value,l=[t.hoverXAxisLabel+" | "+t.hoverYAxisLabel+" : "+t.getFormatedText(i,this.heatMap.cellSettings.format)];return l},e.prototype.renderTooltip=function(e){var t=this,i=this.heatMap.heatMapSeries,l=[""];if(this.heatMap.bubbleSizeWithColor?!sf.base.isNullOrUndefined(e.value)&&!sf.base.isNullOrUndefined(e.value[0].bubbleData)&&""!==e.value[0].bubbleData.toString():!(sf.base.isNullOrUndefined(e.value)||!sf.base.isNullOrUndefined(e.value)&&""===e.value.toString()))if(sf.base.isNullOrUndefined(this.heatMap.tooltipRender))l=this.getTooltipContent(e,i),this.tooltipCallback(e,l);else{var a=this.getTooltipContent(e,i),n={heatmap:this.heatMap.isBlazor?null:this.heatMap,cancel:!1,name:"tooltipRender",value:e.value,xValue:this.heatMap.heatMapSeries.hoverXAxisValue,yValue:this.heatMap.heatMapSeries.hoverYAxisValue,xLabel:this.heatMap.heatMapSeries.hoverXAxisLabel?this.heatMap.heatMapSeries.hoverXAxisLabel.toString():null,yLabel:this.heatMap.heatMapSeries.hoverYAxisLabel?this.heatMap.heatMapSeries.hoverYAxisLabel.toString():null,content:a};this.heatMap.trigger("tooltipRender",n,(function(i){i.cancel?t.tooltipObject&&t.showHideTooltip(!1):(l=i.content,t.tooltipCallback(e,l))}))}else this.showHideTooltip(!1,!1),e.visible||this.showHideTooltip(!1,!1)},e.prototype.tooltipCallback=function(e,t){this.tooltipObject?(this.tooltipObject.content=t,this.tooltipObject.data={xValue:this.heatMap.heatMapSeries.hoverXAxisValue,yValue:this.heatMap.heatMapSeries.hoverYAxisValue,xLabel:this.heatMap.heatMapSeries.hoverXAxisLabel?this.heatMap.heatMapSeries.hoverXAxisLabel.toString():null,yLabel:this.heatMap.heatMapSeries.hoverYAxisLabel?this.heatMap.heatMapSeries.hoverYAxisLabel.toString():null,value:e.value}):this.createTooltip(e,e.x+e.width/2,e.y+e.height/2,t),this.showHideTooltip(!0),this.tooltipObject.enableAnimation=!this.isFirst&&!this.isFadeout,this.isFirst=!this.isFirst&&this.isFirst,this.isFadeout=!this.isFadeout&&this.isFadeout,this.tooltipObject.location.x=e.x+e.width/2,this.tooltipObject.location.y=e.y+e.height/2,e.visible||this.showHideTooltip(!1,!1)},e}(),Ge=function(){function e(e){this.heatMap=e}return e.prototype.processDataSource=function(e){var t=sf.base.extend([],e,null,!0);this.heatMap.clonedDataSource=[],this.completeDataSource=[];var l,a,n,s=this.heatMap.axisCollections,o=s[0].maxLength+1,r=s[0].axisLabelSize+(s[0].min>0?s[0].min:0),h=o>r?o:r,d=(o=s[1].maxLength+1)>(r=s[1].axisLabelSize+(s[1].min>0?s[1].min:0))?o:r,p=0,g=[];this.tempSizeArray=[],this.tempColorArray=[],this.heatMap.minColorValue=null,this.heatMap.maxColorValue=null,this.heatMap.dataMax=[],this.heatMap.dataMin=[],"Column"===this.heatMap.paletteSettings.colorGradientMode&&h<d&&(h=d);for(var c="Category"===s[1].valueType?s[1].min:0;c<("Column"===this.heatMap.paletteSettings.colorGradientMode?h:d);c++){var u="Category"===s[0].valueType?s[0].min:0;for(this.completeDataSource.push([]);u<h;)u>=s[0].min&&u<=s[0].max&&this.processDataArray(t,u,c,p),u++;if("Column"===this.heatMap.paletteSettings.colorGradientMode&&"Gradient"===this.heatMap.paletteSettings.type){n=sf.base.extend([],t[p],null,!0);for(var b=0;b<n.length;b++)"object"===i(n[b])&&null!==n[b]&&(n[b]=n[b][0])}else n=sf.base.extend([],this.completeDataSource[p],null,!0);var f=this.getMinMaxValue(l,a,n);"Column"!==this.heatMap.paletteSettings.colorGradientMode&&"Row"!==this.heatMap.paletteSettings.colorGradientMode||"Gradient"!==this.heatMap.paletteSettings.type||(this.heatMap.dataMax[c]=f[1],this.heatMap.dataMin[c]=f[0]),l=f[0],a=f[1],this.heatMap.xAxis.isInversed&&(this.completeDataSource[p]=this.completeDataSource[p].reverse()),c>=this.heatMap.axisCollections[1].min&&c<=this.heatMap.axisCollections[1].max&&g.push(this.completeDataSource[p]),p++}"Row"!==this.heatMap.paletteSettings.colorGradientMode||this.heatMap.yAxis.isInversed||"Gradient"!==this.heatMap.paletteSettings.type||(this.heatMap.dataMax=this.heatMap.dataMax.reverse(),this.heatMap.dataMin=this.heatMap.dataMin.reverse()),"Column"===this.heatMap.paletteSettings.colorGradientMode&&this.heatMap.xAxis.isInversed&&"Gradient"===this.heatMap.paletteSettings.type&&(this.heatMap.dataMax=this.heatMap.dataMax.reverse(),this.heatMap.dataMin=this.heatMap.dataMin.reverse()),this.heatMap.yAxis.isInversed||(this.completeDataSource.reverse(),g.reverse()),this.heatMap.clonedDataSource=g,this.heatMap.dataSourceMinValue=sf.base.isNullOrUndefined(l)?0:parseFloat(l.toString()),this.heatMap.dataSourceMaxValue=sf.base.isNullOrUndefined(a)?0:parseFloat(a.toString()),this.heatMap.isColorValueExist=!sf.base.isNullOrUndefined(this.heatMap.minColorValue),this.heatMap.minColorValue=sf.base.isNullOrUndefined(this.heatMap.minColorValue)?this.heatMap.dataSourceMinValue:parseFloat(this.heatMap.minColorValue.toString()),this.heatMap.maxColorValue=sf.base.isNullOrUndefined(this.heatMap.maxColorValue)?this.heatMap.dataSourceMaxValue:parseFloat(this.heatMap.maxColorValue.toString())},e.prototype.processDataArray=function(e,t,l,a){if(this.heatMap.bubbleSizeWithColor)if(e[t]&&!sf.base.isNullOrUndefined(e[t][l])&&"object"===i(e[t][l])){for(var n=e[t][l],s=0;s<n.length;s++)if((sf.base.isNullOrUndefined(n[s])||isNaN(n[s]))&&(n[s]=""),0===s)this.tempSizeArray.push(n[s]);else if(1===s){this.tempColorArray.push(n[s]);break}this.completeDataSource[a].push(n)}else!sf.base.isNullOrUndefined(e[t])&&(e[t][l]||0===e[t][l]&&""!==e[t][l].toString())?(this.completeDataSource[a].push([e[t][l]]),this.tempSizeArray.push(e[t][l])):this.completeDataSource[a].push("");else e[t]&&(e[t][l]||0===e[t][l]&&""!==e[t][l].toString())?"object"===i(e[t][l])?e[t][l].length>0&&!sf.base.isNullOrUndefined(e[t][l][0])?this.completeDataSource[a].push(e[t][l][0]):this.completeDataSource[a].push(""):this.completeDataSource[a].push(e[t][l]):this.completeDataSource[a].push("")},e.prototype.getMinMaxValue=function(e,t,i){var l=[];return this.heatMap.bubbleSizeWithColor?("Column"===this.heatMap.paletteSettings.colorGradientMode&&"Gradient"===this.heatMap.paletteSettings.type&&(this.tempSizeArray=i),l.push(this.getMinValue(e,this.tempSizeArray)),l.push(this.getMaxValue(t,this.tempSizeArray)),this.heatMap.minColorValue=this.getMinValue(this.heatMap.minColorValue,this.tempColorArray),this.heatMap.maxColorValue=this.getMaxValue(this.heatMap.maxColorValue,this.tempColorArray)):(l.push(this.getMinValue(e,i)),l.push(this.getMaxValue(t,i))),l},e.prototype.getMinValue=function(e,t){return sf.base.isNullOrUndefined(e)||this.performSort(t)<e?e=this.performSort(t):"Row"!==this.heatMap.paletteSettings.colorGradientMode&&"Column"!==this.heatMap.paletteSettings.colorGradientMode||"Gradient"!==this.heatMap.paletteSettings.type||(e=this.performSort(t)),sf.base.isNullOrUndefined(e)?e:parseFloat(e.toString())},e.prototype.getMaxValue=function(e,t){return sf.base.isNullOrUndefined(e)&&t.length>0||Math.max.apply(Math,t)>e?e=Math.max.apply(Math,t):"Row"!==this.heatMap.paletteSettings.colorGradientMode&&"Column"!==this.heatMap.paletteSettings.colorGradientMode||"Gradient"!==this.heatMap.paletteSettings.type||(e=Math.max.apply(Math,t)),sf.base.isNullOrUndefined(e)?e:parseFloat(e.toString())},e.prototype.performSort=function(e){return e.sort((function(e,t){return e-t})).filter(this.checkmin)[0]},e.prototype.checkmin=function(e){return!sf.base.isNullOrUndefined(e)&&""!==e.toString()},e}(),He=(Me=function(e,t){return(Me=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Me(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Fe=function(e,t,l,a){var n,s=arguments.length,o=s<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,l):a;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,l,a);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(o=(s<3?n(o):s>3?n(t,l,o):n(t,l))||o);return s>3&&o&&Object.defineProperty(t,l,o),o},je=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return He(i,e),Fe([sf.base.Property("")],i.prototype,"height",void 0),Fe([sf.base.Property("")],i.prototype,"width",void 0),Fe([sf.base.Complex({text:"",textStyle:t.titleFont},c)],i.prototype,"title",void 0),Fe([sf.base.Property("Right")],i.prototype,"position",void 0),Fe([sf.base.Property(!0)],i.prototype,"visible",void 0),Fe([sf.base.Property("Center")],i.prototype,"alignment",void 0),Fe([sf.base.Property(!0)],i.prototype,"showLabel",void 0),Fe([sf.base.Property(!0)],i.prototype,"showGradientPointer",void 0),Fe([sf.base.Property(!1)],i.prototype,"enableSmartLegend",void 0),Fe([sf.base.Property("All")],i.prototype,"labelDisplayType",void 0),Fe([sf.base.Complex(t.legendLabelFont,r)],i.prototype,"textStyle",void 0),Fe([sf.base.Property("")],i.prototype,"labelFormat",void 0),Fe([sf.base.Property(!0)],i.prototype,"toggleVisibility",void 0),i}(sf.base.ChildProperty),ke=function(){function e(e){this.maxLegendLabelSize=new _(0,0),this.gradientScaleSize=10,this.segmentCollections=[],this.segmentCollectionsLabels=[],this.textWrapCollections=[],this.labelCollections=[],this.labelCollection=[],this.legendSize=10,this.previousOptions=new pe(0,0,0,0,0,0),this.listPerPage=0,this.numberOfPages=1,this.listWidth=0,this.fillRect=new F(0,0,0,0),this.legendRect=new F(0,0,0,0),this.currentPage=1,this.lastList=[],this.navigationCollections=[],this.pagingRect=new F(0,0,0,0),this.listInterval=10,this.legendLabelTooltip=[],this.legendTitleTooltip=[],this.labelXCollections=[],this.labelYCollections=[],this.legendXCollections=[],this.legendYCollections=[],this.legendRectPositionCollection=[],this.legendRange=[],this.legendTextRange=[],this.visibilityCollections=[],this.heatMap=e,this.drawSvgCanvas=new $(e)}return e.prototype.getModuleName=function(){return"Legend"},e.prototype.destroy=function(e){},e.prototype.renderLegendItems=function(){var e=this.heatMap;e.toggleValue=[];var t={color:"transparent",width:0};this.legend=e.renderer.createGroup({id:e.element.id+"_Heatmap_Legend"});var i=new G(e.element.id+"_LegendBound","none",t,1,this.legendGroup);this.drawSvgCanvas.drawRectangle(i,this.legend);var l,a=this.legendRectScale,n=e.canvasRenderer.ctx,s=new F(a.x,a.y,a.width,a.height);if("Fixed"===e.paletteSettings.type){var o=e.legendSettings.enableSmartLegend?e.legendColorCollection:e.colorCollection;this.legendRange=e.resizing||!e.legendOnLoad&&e.rendering?[]:this.legendRange,this.legendTextRange=e.resizing||!e.legendOnLoad&&e.rendering?[]:this.legendTextRange,e.enableCanvasRendering&&(n.save(),n.clip());for(var r=0;r<o.length;r++){var h=!!sf.base.isNullOrUndefined(this.visibilityCollections[r])||this.visibilityCollections[r];e.toggleValue.push(new ue(h,o[r].value,o[r].startValue,o[r].endValue))}}if("Gradient"===e.paletteSettings.type||"Fixed"===e.paletteSettings.type&&!0===e.legendSettings.enableSmartLegend){if("Gradient"===e.paletteSettings.type){if(e.enableCanvasRendering){var d=void 0,p=e.canvasRenderer.ctx;d=e.horizontalGradient?p.createLinearGradient(a.x,0,a.x+a.width,0):p.createLinearGradient(0,a.y,0,a.y+a.height),e.legendSettings.title.text&&p.clip();for(r=0;r<e.legendColorCollection.length;r++){var g=((this.heatMap.isColorRange?e.legendColorCollection[r].startValue:e.legendColorCollection[r].value)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue);g=isNaN(g)?0:g,this.heatMap.isColorRange&&"Gradient"===this.heatMap.paletteSettings.type?this.calculateCanvasColorRange(r,d):d.addColorStop(g,e.legendColorCollection[r].color)}p.fillStyle=d,l=d.toString()}else{var c=void 0,u=void 0,b=[];for(r=0;r<e.legendColorCollection.length;r++){if(this.heatMap.isColorRange&&"Gradient"===this.heatMap.paletteSettings.type)this.calculateColorRange(r,b);else{var f=(e.legendColorCollection[r].value-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100;f=isNaN(f)?0:f,u=new le(e.legendColorCollection[r].color,f+"%"),b.push(u)}if(this.legendMaxValue===this.legendMinValue)break}c=e.horizontalGradient?new ie(e.element.id+"_lineargradient","0%","100%","0%","0%"):new ie(e.element.id+"_lineargradient","0%","0%","0%","100%");var v=e.renderer.drawGradient("linearGradient",c,b);this.legend.appendChild(v),l="url(#"+e.element.id+"_lineargradient)"}var y=new G(e.element.id+"_Gradient_Legend",l,t,1,s);this.drawSvgCanvas.drawRectangle(y,this.legend),this.renderElements(s)}else this.renderSmartLegend(),this.renderTitle(s);e.enableCanvasRendering||e.svgObject.appendChild(this.legend),e.enableCanvasRendering&&n.restore(),this.renderLegendLabel(s)}else{this.legendScale=e.renderer.createGroup({id:e.element.id+"Heatmap_GradientScale"});var m=new G(e.element.id+"_Gradient_Scale","none",t,1,this.legendRectScale);this.drawSvgCanvas.drawRectangle(m,this.legendScale),this.renderTitle(s),e.enableCanvasRendering||this.legend.appendChild(this.legendScale),this.translategroup=e.renderer.createGroup({id:e.element.id+"_translate"}),this.calculateListPerPage(s),this.numberOfPages>1&&(this.paginggroup=e.renderer.createGroup({id:e.element.id+"_navigation"})),this.renderListLegendMode(s,!0),e.enableCanvasRendering&&n.restore()}},e.prototype.renderElements=function(e){this.renderTitle(e),this.renderColorAxisGrid(e)},e.prototype.calculateCanvasColorRange=function(e,t){var i=this.heatMap,l=((i.legendColorCollection[e].startValue<i.dataSourceMinValue&&i.legendColorCollection[e].endValue>i.dataSourceMinValue?i.dataSourceMinValue:i.legendColorCollection[e].startValue)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue);l=isNaN(l)?0:l;var a=((i.legendColorCollection[e].endValue>=this.heatMap.dataSourceMaxValue?this.heatMap.dataSourceMaxValue:i.legendColorCollection[e].endValue)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue);this.heatMap.legendColorCollection[0].startValue!==this.heatMap.dataSourceMinValue&&0===e&&this.heatMap.legendColorCollection[0].startValue>this.heatMap.dataSourceMinValue&&(l=(this.heatMap.legendColorCollection[0].startValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue),t.addColorStop(l/2,this.heatMap.paletteSettings.fillColor.minColor),t.addColorStop(l,this.heatMap.paletteSettings.fillColor.maxColor)),t.addColorStop(l,i.legendColorCollection[e].minColor),t.addColorStop(a,i.legendColorCollection[e].maxColor),this.heatMap.legendColorCollection[e].endValue!==(e===this.heatMap.legendColorCollection.length-1?this.heatMap.dataSourceMaxValue:this.heatMap.legendColorCollection[e+1].startValue)&&this.heatMap.legendColorCollection[e].endValue<this.heatMap.dataSourceMaxValue&&(l=(i.legendColorCollection[e].endValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue),t.addColorStop(l,this.heatMap.paletteSettings.fillColor.minColor),l=((e===this.heatMap.legendColorCollection.length-1?this.heatMap.dataSourceMaxValue:i.legendColorCollection[e+1].startValue)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue),t.addColorStop(l,this.heatMap.paletteSettings.fillColor.maxColor))},e.prototype.calculateColorRange=function(e,t){void 0===t&&(t=[]);var i,l,a,n,s,o=this.heatMap;o.toggleValue=[],this.heatMap.legendColorCollection[0].startValue>this.heatMap.dataSourceMinValue&&0===e&&(i=(this.heatMap.dataSourceMinValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,i=isNaN(i)?0:i,l=new le(o.paletteSettings.fillColor.minColor,i+"%"),t.push(l),i=(o.legendColorCollection[0].startValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,l=new le(o.paletteSettings.fillColor.maxColor,i+"%"),t.push(l)),i=(o.legendColorCollection[e].startValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,i=isNaN(i)?0:i,l=new le(o.legendColorCollection[e].minColor,i+"%"),t.push(l),i=(o.legendColorCollection[e].endValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,a=new le(o.legendColorCollection[e].maxColor,i+"%"),t.push(a),this.heatMap.legendColorCollection[e].endValue!==(e===this.heatMap.legendColorCollection.length-1?this.heatMap.dataSourceMaxValue:this.heatMap.legendColorCollection[e+1].startValue)&&(i=(o.legendColorCollection[e].endValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,n=new le(this.heatMap.paletteSettings.fillColor.minColor,i+"%"),t.push(n),i=((e===this.heatMap.legendColorCollection.length-1?this.heatMap.dataSourceMaxValue:o.legendColorCollection[e+1].startValue)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,s=new le(this.heatMap.paletteSettings.fillColor.maxColor,i+"%"),t.push(s))},e.prototype.renderTitle=function(e){var t=this.heatMap;if(t.legendSettings.title.text){var i=t.legendSettings.title,l=O(i.text,i.textStyle),a=t.legendSettings.showLabel?this.labelPadding:t.horizontalGradient?10:6,n=void 0,s=void 0,o=i.text,r=void 0,h=void 0;"Trim"===t.legendSettings.title.textStyle.textOverflow&&(o=ee(s=this.width-10,o,i.textStyle)),t.horizontalGradient?(n=e.y+("Top"===t.legendSettings.position?0:-(10+l.height+a)),a="Top"===t.legendSettings.position?-(a+l.height/4):a+3*l.height/4,h="Bottom"===t.legendSettings.position?n:n-l.height,0!==o.length&&t.enableCanvasRendering&&this.legendTitleTooltip.push(new re(i.text,new F(e.x,h,s,l.height))),l.width=e.width<l.width?e.width:l.width,r=new j(t.element.id+"_legendTitle",new k(e.x+e.width/2-l.width/2,n+a,"start",o,0,"translate(0,0)",void 0),i.textStyle,i.textStyle.color||t.themeStyle.heatMapTitle)):(a=-(a+l.height/4),0!==o.length&&t.enableCanvasRendering&&this.legendTitleTooltip.push(new re(i.text,new F(e.x,e.y-l.height,s,l.height))),r=new j(t.element.id+"_legendTitle",new k(e.x,e.y+a,"start",o,0,"translate(0,0)",void 0),i.textStyle,i.textStyle.color||t.themeStyle.heatMapTitle)),this.drawSvgCanvas.createText(r,this.legend,o)}},e.prototype.renderSmartLegend=function(){var e,t,i,l,a,n=this.heatMap,s=n.colorCollection,o={color:"transparent",width:0},r=this.legendRectScale,h=r.width/s.length,d=r.height/s.length;this.legendRectPositionCollection=[],this.legendRange=[];for(var p=0;p<n.legendColorCollection.length;p++){var g=new ge(0,0,0,0,"","");n.horizontalGradient?(t=r.x+p*h,i=r.y,l=h,a=r.height,this.segmentCollections.push("Edge"!==n.legendSettings.labelDisplayType||p!==n.legendColorCollection.length-1||n.legendColorCollection[p].isHidden?t:t+h)):(t=r.x,i=r.y+p*d,l=r.width,a=d,this.segmentCollections.push("Edge"!==n.legendSettings.labelDisplayType||p!==n.legendColorCollection.length-1||n.legendColorCollection[p].isHidden?i:i+d)),e=new F(t,i,l,a);var c=new ce(0,0,0,0,0,!0,0);if(c.x=t,c.y=i,c.width=l,c.height=a,c.value=this.heatMap.isColorRange?n.legendColorCollection[p].endValue:n.legendColorCollection[p].value,c.currentPage=this.currentPage,s.length!==n.legendColorCollection.length&&p===n.legendColorCollection.length-1&&(n.horizontalGradient?c.width=0:c.height=0,this.visibilityCollections[p]=this.visibilityCollections[p-1]),c.visible=!!sf.base.isNullOrUndefined(this.visibilityCollections[p])||this.visibilityCollections[p],this.legendRange.push(c),!n.legendColorCollection[p].isHidden){var u=n.legendOnLoad||this.legendRange[p].visible?this.heatMap.isColorRange?s[p].minColor:s[p].color:"#D3D3D3",b=new G(n.element.id+"_Smart_Legend"+p,u,o,1,e);if(this.drawSvgCanvas.drawRectangle(b,this.legend),g.x=t,g.y=i,g.width=l,g.height=a,g.label=this.labelCollections[p],g.id=n.element.id+"_Smart_Legend"+p,this.legendRectPositionCollection.push(g),0!==K(this.labelCollections[p],n.legendSettings.textStyle,this.textWrapCollections[p]).length&&n.enableCanvasRendering){var f=O(this.labelCollections[p],n.legendSettings.textStyle);this.legendLabelTooltip.push(new re(this.labelCollections[p],new F(g.x,g.y,f.width,f.height)))}}}},e.prototype.colorRangeLegendPosition=function(e,t){if(this.segmentCollections.length!==this.segmentCollectionsLabels.length){for(var i=0;i<this.segmentCollections.length;i++)if(this.segmentCollectionsLabels[e]===this.segmentCollections[i]){t=this.segmentCollectionsLabels[e]+((i===this.segmentCollections.length-1?this.heatMap.horizontalGradient?this.width:this.height:this.segmentCollections[i+1])-this.segmentCollections[i])/2;break}}else t=this.segmentCollectionsLabels[e]+((e===this.segmentCollectionsLabels.length-1?this.heatMap.horizontalGradient?this.width:this.height:this.segmentCollectionsLabels[e+1])-this.segmentCollectionsLabels[e])/2;this.labelPosition=t},e.prototype.renderLegendLabel=function(e){var t=this.heatMap;if(this.legendTextRange=[],t.legendSettings.showLabel&&("Gradient"===t.paletteSettings.type||"Fixed"===t.paletteSettings.type&&"None"!==t.legendSettings.labelDisplayType)){var i="start",l=void 0,a=void 0,n=0,s=void 0;this.legendLabelTooltip=[];var o=void 0,r=t.isColorRange,h=t.legendColorCollection;if(t.enableCanvasRendering){var d=t.canvasRenderer.ctx;d.rect(this.legendGroup.x,this.legendGroup.y,this.legendGroup.width,this.legendGroup.height),d.save(),d.clip(),d.restore()}else a=t.renderer.createGroup({id:t.element.id+"_Heatmap_LegendLabel"});for(var p=void 0,g=void 0,c=0;c<h.length;c++){var u=(h[c].value-Math.round(100*this.legendMinValue)/100)/(Math.round(100*this.legendMaxValue)/100-Math.round(100*this.legendMinValue)/100)*100;if(t.horizontalGradient?(this.heatMap.isColorRange&&"Gradient"===t.paletteSettings.type?(this.colorRangeLegendPosition(c,p),p=this.labelPosition):p=this.heatMap.legendSettings.enableSmartLegend&&this.heatMap.isColorRange&&"Fixed"===t.paletteSettings.type?this.segmentCollections[c]+e.width/h.length/2:this.segmentCollections[c],g=e.y+e.height+this.labelPadding,i=Math.round(100*u)/100==0&&!r||"Fixed"===t.paletteSettings.type&&0===c?"start":Math.round(100*u)/100==100&&"Gradient"===t.paletteSettings.type&&!r||Math.round(100*t.dataSourceMaxValue)/100===h[c].value&&t.legendSettings.enableSmartLegend||t.legendSettings.enableSmartLegend&&"Fixed"===t.paletteSettings.type&&"Edge"===t.legendSettings.labelDisplayType?"end":"middle",l="hanging"):(p=e.x+e.width+this.labelPadding,this.heatMap.isColorRange&&"Gradient"===t.paletteSettings.type?(this.colorRangeLegendPosition(c,g),g=this.labelPosition):g=this.heatMap.legendSettings.enableSmartLegend&&this.heatMap.isColorRange&&"Fixed"===t.paletteSettings.type?this.segmentCollections[c]+e.height/h.length/2:this.segmentCollections[c],l=Math.round(100*u)/100==0&&!r||0===c&&"Fixed"===t.paletteSettings.type?"hanging":Math.round(100*u)/100==100&&!r&&"Gradient"===t.paletteSettings.type||Math.round(100*t.dataSourceMaxValue)/100===h[c].value&&t.legendSettings.enableSmartLegend||t.legendSettings.enableSmartLegend&&"Edge"===t.legendSettings.labelDisplayType&&"Fixed"===t.paletteSettings.type?"auto":"middle"),n=t.horizontalGradient?this.textWrapCollections[c]:this.width-(this.legendRectScale.width+this.labelPadding+this.legendRectPadding),o=O((s=K(this.labelCollections[c],t.legendSettings.textStyle,n))[0],t.legendSettings.textStyle),"Fixed"===t.paletteSettings.type){var b="hanging"===l?g:"middle"===l?g-o.height/2:g-o.height,f="end"===i?p-o.width:"middle"===i?p-o.width/2:p,v=new ce(f,b,o.width,o.height,h[c].value,!0,this.currentPage);v.visible=!!sf.base.isNullOrUndefined(this.visibilityCollections[c])||this.visibilityCollections[c],this.legendTextRange.push(v)}if(""!==this.labelCollections[c]){0!==s.length&&-1!==s[0].indexOf("...")&&t.enableCanvasRendering&&this.legendLabelTooltip.push(new re(this.labelCollections[c],new F(p,g,o.width,o.height)));var y=new k(p,g,i,s,0,"translate(0,0)",l),m=new j(t.element.id+"_Legend_Label"+c,y,t.legendSettings.textStyle,t.legendSettings.textStyle.color||t.themeStyle.legendLabel);m.fill=t.legendOnLoad||"Fixed"!==t.paletteSettings.type||this.legendRange[c].visible?m.fill:"#D3D3D3",s.length>1?this.drawSvgCanvas.createWrapText(m,t.legendSettings.textStyle,a):this.drawSvgCanvas.createText(m,a,s[0]),sf.base.Browser.isIE&&!t.enableCanvasRendering&&("middle"===l?a.lastChild.setAttribute("dy","0.6ex"):"hanging"===l&&a.lastChild.setAttribute("dy","1.5ex"))}if(this.legendMaxValue===this.legendMinValue&&"Gradient"===t.paletteSettings.type)break}if(!t.enableCanvasRendering){this.legendGroup.height=this.legendGroup.height>0?this.legendGroup.height:0,this.legendGroup.width=this.legendGroup.width>0?this.legendGroup.width:0,this.legend.appendChild(a);var x=t.renderer.createClipPath({id:t.element.id+"_clipPath"}),C=t.renderer.drawRectangle(this.legendGroup);x.appendChild(C),t.svgObject.appendChild(x),this.legend.setAttribute("style","clip-path:url(#"+x.id+")")}}},e.prototype.renderGradientPointer=function(e,t,i){var l,a,n,s,o,r,h,d,p,g=this.heatMap,c=g.heatMapSeries.getCurrentRect(t,i),u=g.bubbleSizeWithColor?""!==c.value[0].bubbleData.toString()?this.heatMap.isColorValueExist?c.value[1].bubbleData.toString():c.value[0].bubbleData.toString():"":c.value.toString(),b=this.legendRectScale;if(""!==u.toString())if(g.horizontalGradient?(n=b.width/100*((Number(u)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue))*100,n=isNaN(n)?0:n,s=b.x+n,o=b.y+b.height,r=b.x-5+n,h=p=b.y+b.height+8,d=b.x+5+n):(n=b.height/100*((Number(u)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue))*100,n=isNaN(n)?0:n,s=b.x-1,o=b.y+n,r=d=b.x-8,h=b.y-5+n,p=b.y+5+n),l="M "+s+" "+o+" L "+r+" "+h+" L "+d+" "+p+" Z",a=new B(g.element.id+"_Gradient_Pointer","gray",.01,"#A0A0A0",1,"0,0",l),g.enableCanvasRendering){this.removeGradientPointer();g.canvasRenderer.drawPath(a,void 0),this.previousOptions.pathX1=s,this.previousOptions.pathY1=o,this.previousOptions.pathX2=r,this.previousOptions.pathY2=h,this.previousOptions.pathX3=d,this.previousOptions.pathY3=p}else this.gradientPointer=g.renderer.drawPath(a),this.gradientPointer.style.visibility="visible",this.legend.appendChild(this.gradientPointer);else this.removeGradientPointer()},e.prototype.removeGradientPointer=function(){var e=this.heatMap;this.gradientPointer&&!e.enableCanvasRendering?this.gradientPointer.style.visibility="hidden":e.enableCanvasRendering&&(0!==Object.keys(this.previousOptions).length&&(e.horizontalGradient?(this.fillRect.x=this.previousOptions.pathX2-1,this.fillRect.y=this.previousOptions.pathY1,this.fillRect.width=this.previousOptions.pathX3-this.previousOptions.pathX2+2,this.fillRect.height=this.previousOptions.pathY2+1-this.previousOptions.pathY1):(this.fillRect.x=this.previousOptions.pathX2-1,this.fillRect.y=this.previousOptions.pathY2-1,this.fillRect.width=this.previousOptions.pathX1-this.previousOptions.pathX2+1,this.fillRect.height=this.previousOptions.pathY3-this.previousOptions.pathY2+2)),e.canvasRenderer.ctx.fillStyle=e.themeStyle.background,e.canvasRenderer.ctx.fillRect(this.fillRect.x,this.fillRect.y,this.fillRect.width,this.fillRect.height))},e.prototype.calculateLegendBounds=function(e){var t=this.heatMap,i=t.legendSettings;this.labelCollection=[],this.labelCollections=[];var l=t.legendColorCollection;"Bottom"!==i.position&&"Top"!==i.position&&"Right"!==i.position&&"Left"!==i.position&&(i.position="Right");var a=t.legendSettings.title,n=O(a.text,a.textStyle);t.horizontalGradient="Bottom"===i.position||"Top"===i.position,this.legendRectPadding=t.horizontalGradient?t.legendSettings.title.text?n.height+16:16:10,this.labelPadding=i.showLabel?this.heatMap.horizontalGradient?10:6:0,this.legendHeight=i.height,this.legendWidth=i.width;var s=t.legendSettings.labelFormat,o=null!==s.match("{value}");if(this.format=t.intl.getNumberFormat({format:o?"":s}),"Fixed"===t.paletteSettings.type)for(var r=0;r<l.length;r++){var h={cancel:!1,text:d=l[r].label?l[r].label:this.heatMap.isColorRange?l[r].startValue.toString()+"-"+l[r].endValue.toString():me(o,s,l[r].value,this.format).toString(),name:"legendRender"};this.labelCollection.push(d),this.heatMap.trigger("legendRender",h),t.legendRender?t.legendSettings.enableSmartLegend&&"Edge"===t.legendSettings.labelDisplayType&&r>0&&r<l.length-1||h.cancel?this.labelCollections.push(""):this.labelCollections.push(h.text):t.legendSettings.enableSmartLegend&&"Edge"===t.legendSettings.labelDisplayType&&r>0&&r<l.length-1?this.labelCollections.push(""):this.labelCollections.push(d)}else for(r=0;r<l.length;r++){var d;h={cancel:!1,text:d=l[r].isHidden?"":l[r].label?l[r].label:this.heatMap.isColorRange?l[r].startValue.toString()+"-"+l[r].endValue.toString():me(o,s,l[r].value,this.format).toString(),name:"legendRender"};l[r].isHidden||this.heatMap.trigger("legendRender",h),t.legendRender?h.cancel||r>0&&r<l.length-1&&"Edge"===t.legendSettings.labelDisplayType||h.cancel?this.labelCollections.push(""):this.labelCollections.push(h.text):r>0&&r<l.length-1&&"Edge"===t.legendSettings.labelDisplayType?this.labelCollections.push(""):this.labelCollections.push(d)}"Gradient"===t.paletteSettings.type||"Fixed"===t.paletteSettings.type&&t.legendSettings.enableSmartLegend?(this.maxLegendLabelSize=this.getMaxLabelSize(),t.horizontalGradient&&""===i.height?this.legendHeight=(2*this.legendRectPadding+this.legendSize+this.maxLegendLabelSize.height).toString():!t.horizontalGradient&&""===i.width&&("None"===i.textStyle.textOverflow||"Fixed"===t.paletteSettings.type&&t.legendSettings.enableSmartLegend&&"None"===t.legendSettings.labelDisplayType)&&(this.legendWidth=(2*this.legendRectPadding+this.legendSize+this.maxLegendLabelSize.width).toString()),this.calculateTitleBounds()):this.calculateListLegendBounds(e),this.legendHeight=this.legendHeight?this.legendHeight:t.horizontalGradient?"50":"100%",this.legendWidth=this.legendWidth?this.legendWidth:t.horizontalGradient?"100%":"Fixed"!==t.paletteSettings.type||t.legendSettings.enableSmartLegend?"50":"70",this.height=V(this.legendHeight,e.height),this.width=V(this.legendWidth,e.width),t.horizontalGradient?(this.height=("Gradient"===t.paletteSettings.type||t.legendSettings.enableSmartLegend)&&this.height<50?50:this.height,"Top"===i.position&&(e.y+=this.height),e.height-=this.height):(this.width=("Gradient"===t.paletteSettings.type||t.legendSettings.enableSmartLegend)&&this.width<50?50:this.width,"Left"===i.position&&(e.x+=this.width),e.width-=this.width)},e.prototype.calculateTitleBounds=function(){var e=this.heatMap,t=e.legendSettings.title,i=O(t.text,t.textStyle);e.legendSettings.title.text&&("Top"!==e.legendSettings.position&&"Bottom"!==e.legendSettings.position||""!==e.legendSettings.height||(this.legendHeight=(2*this.legendRectPadding-i.height+this.legendSize+this.maxLegendLabelSize.height).toString()),""===e.legendSettings.width&&("None"===e.legendSettings.textStyle.textOverflow||"Fixed"===e.paletteSettings.type&&e.legendSettings.enableSmartLegend&&"None"===e.legendSettings.labelDisplayType)&&("Right"===e.legendSettings.position?this.legendWidth=(2*this.legendRectPadding+i.width+this.legendSize+this.maxLegendLabelSize.width).toString():"Left"===e.legendSettings.position&&(i.width=i.width>this.maxLegendLabelSize.width?i.width:this.maxLegendLabelSize.width,this.legendWidth=(2*this.legendRectPadding+i.width+this.legendSize).toString())))},e.prototype.calculateListLegendBounds=function(e){var t=this.heatMap;this.listWidth=0,this.listHeight=0,this.currentPage=1;var i=t.legendSettings.title,l=O(i.text,i.textStyle),a=(l.height+50).toString();if(t.horizontalGradient){for(var n=0;n<t.colorCollection.length;n++){var s=0;if(t.legendSettings.showLabel)s=O(this.labelCollections[n],t.legendSettings.textStyle).width;var o=this.legendSize+this.labelPadding+s+this.listInterval;this.listWidth+=o}this.listWidth+=this.listInterval+10,""===this.legendWidth&&(this.legendWidth=this.listWidth>e.width?e.width.toString():this.listWidth.toString()),""===this.legendHeight&&(this.numberOfRows=Math.ceil(this.listWidth/V(this.legendWidth,e.width)),this.numberOfRows=this.numberOfRows>3?3:this.numberOfRows,this.legendHeight=(this.listWidth>e.width||this.listWidth>V(this.legendWidth,e.width))&&this.numberOfRows>3?((this.legendSize+this.listInterval)*this.numberOfRows+this.legendRectPadding+parseInt(t.legendSettings.textStyle.size,10)+10).toString():((this.legendSize+this.listInterval)*this.numberOfRows+this.legendRectPadding).toString())}else this.listHeight=(this.legendSize+this.listInterval)*t.colorCollection.length+this.listInterval+(t.legendSettings.title.text?l.height:0),""===this.legendHeight&&(this.legendHeight=this.listHeight>e.height?e.height.toString():this.listHeight.toString()),""===this.legendWidth&&"Trim"!==t.legendSettings.textStyle.textOverflow&&(this.maxLegendLabelSize=this.getMaxLabelSize(),this.maxLegendLabelSize.width=l.width>this.maxLegendLabelSize.width?l.width:this.maxLegendLabelSize.width,this.legendWidth=(2*this.legendRectPadding+this.legendSize+this.labelPadding+this.maxLegendLabelSize.width).toString());V(this.legendHeight,e.height)<50&&(this.legendHeight=a),V(this.legendWidth,e.width)<70&&(this.legendWidth="70")},e.prototype.getMaxLabelSize=function(){var e=this.heatMap;if(this.maxLegendLabelSize=new _(0,0),!e.legendSettings.showLabel||e.horizontalGradient&&"Fixed"===e.paletteSettings.type&&!e.legendSettings.enableSmartLegend||"Fixed"===e.paletteSettings.type&&"None"===e.legendSettings.labelDisplayType)return this.maxLegendLabelSize;for(var t=this.maxLegendLabelSize,i=0;i<e.legendColorCollection.length;i++){var l=O(this.labelCollections[i],e.legendSettings.textStyle);t.width=t.width>l.width?t.width:l.width,t.height=t.height>l.height?t.height:l.height}return t},e.prototype.calculateLegendSize=function(e,t){var i,l,a,n=this.heatMap,s=n.legendSettings,o=s.alignment,r=V(this.legendHeight,e.height);a=n.legendSettings.title.text?this.width:V(this.legendWidth,e.width);var h=n.axisCollections,d=0;if(n.horizontalGradient){a=a>e.width?e.width:a,r="Gradient"===n.paletteSettings.type||n.legendSettings.enableSmartLegend?r>50?r:50:this.height,i="Near"===o?e.x:"Far"===o?e.x+e.width-a:e.x+e.width/2-a/2,""!==n.xAxis.title.text&&(d=O(n.xAxis.title.text,n.xAxis.textStyle).height+10);var p=h[0].opposedPosition?0:J(h[0].xAxisMultiLabelHeight)+h[0].maxLabelSize.height+d+10;l="Top"===s.position?n.titleSettings.text?t:n.margin.top:e.y+e.height+p}else{r=r>e.height?e.height:r,a="Gradient"===n.paletteSettings.type||n.legendSettings.enableSmartLegend?a>50?a:50:a,l="Near"===o?e.y:"Far"===o?e.y+e.height-r:e.y+e.height/2-r/2,""!==n.yAxis.title.text&&(d=O(n.yAxis.title.text,n.yAxis.textStyle).height+10);var g=h[1].opposedPosition?J(h[1].yAxisMultiLabelHeight)+h[1].maxLabelSize.width+d+20:0;i="Right"===s.position?e.x+e.width+g:n.margin.left}this.legendGroup=new F(i,l,a,r),this.calculateGradientScale(this.legendGroup)},e.prototype.measureListLegendBound=function(e){var t=this.heatMap,i=t.legendSettings.title;this.numberOfPages=1;var l=O(i.text,i.textStyle);if(t.horizontalGradient)this.listWidth>this.width?(this.numberOfRows=Math.ceil(this.listWidth/this.width),this.listHeight=(this.legendSize+this.listInterval)*this.numberOfRows,this.listPerPage=this.numberOfRows<=3?this.numberOfRows:Math.ceil((this.height-15-parseInt(t.legendSettings.textStyle.size,10)-this.legendRectPadding)/(this.legendSize+this.listInterval)),this.numberOfPages=Math.ceil(this.numberOfRows/this.listPerPage)):this.listPerPage=1;else if(this.listHeight>e.height||this.listHeight>this.height){var a=V(this.legendHeight,e.height);a=a>e.height?e.height:a,a=t.legendSettings.title.text?a-l.height:a,this.listPerPage=Math.floor(a/(this.legendSize+this.listInterval)-1),this.numberOfPages=Math.max(1,Math.ceil(t.colorCollection.length/this.listPerPage))}else this.listPerPage=t.colorCollection.length,this.legendHeight=this.listHeight.toString()},e.prototype.renderPagingElements=function(){var e=this.heatMap;if(this.numberOfPages>1){this.navigationCollections=[],this.legend.appendChild(this.paginggroup);var t=this.legendGroup.x+this.legendGroup.width-10,i=this.legendGroup.y+this.legendGroup.height-10,l=this.currentPage+"/"+this.numberOfPages,a=O(l,e.legendSettings.textStyle),n=t-a.width-15,s=new k(n,i,"start",l,0,"translate(0,0)","middle"),o=new j(e.element.id+"_paging",s,e.legendSettings.textStyle,e.legendSettings.textStyle.color||e.themeStyle.legendLabel);this.drawSvgCanvas.createText(o,this.paginggroup,l),sf.base.Browser.isIE&&!e.enableCanvasRendering&&this.paginggroup.lastChild.setAttribute("dy","0.6ex"),this.pagingRect=new F(n,i-a.height/2,a.width,a.height);var r=new G(e.element.id+"_pagingText","none",{color:"transparent",width:0},1,this.pagingRect);this.drawSvgCanvas.drawRectangle(r,this.paginggroup);var h=new G(e.element.id+"_rightArrow","none",{color:"transparent",width:0},1,new F(t-10,i-5,10,10));this.drawSvgCanvas.drawRectangle(h,this.paginggroup);var d="M "+t+" "+i+" L "+(t-10)+" "+(i-5)+" L "+(t-10)+" "+(i+5)+"Z",p=n-15,g="M "+p+" "+i+" L "+(p+10)+" "+(i-5)+" L "+(p+10)+" "+(i+5)+"Z",c=new G(e.element.id+"_leftArrow","none",{color:"transparent",width:0},1,new F(p,i-5,10,10));this.drawSvgCanvas.drawRectangle(c,this.paginggroup);var u=new B(e.element.id+"_Legend_leftarrow","gray",.01,"#A0A0A0",1,"0,0",g),b=new B(e.element.id+"_Legend_rightarrow","gray",.01,"#A0A0A0",1,"0,0",d);if(this.navigationCollections.push(h),this.navigationCollections.push(c),e.enableCanvasRendering){e.canvasRenderer.drawPath(u,void 0),e.canvasRenderer.drawPath(b,void 0)}else{var f=e.renderer.drawPath(u),v=e.renderer.drawPath(b);this.paginggroup.appendChild(f),this.paginggroup.appendChild(v)}}},e.prototype.calculateGradientScale=function(e){var t,i,l,a,n=this.heatMap,s=n.legendSettings.title,o=O(s.text,s.textStyle),r=n.legendSettings.title.text?o.height:0;"Fixed"!==n.paletteSettings.type||n.legendSettings.enableSmartLegend||this.measureListLegendBound(n.initialClipRect),n.horizontalGradient?(t=e.x+10,i=e.y+this.legendRectPadding,a="Fixed"!==n.paletteSettings.type||n.legendSettings.enableSmartLegend?e.width-20:e.width-2*this.listInterval,l="Fixed"!==n.paletteSettings.type||n.legendSettings.enableSmartLegend?this.gradientScaleSize:(this.legendSize+this.listInterval)*this.listPerPage-this.listInterval):(t=e.x+this.legendRectPadding,i=e.y+10+r,a="Fixed"!==n.paletteSettings.type||n.legendSettings.enableSmartLegend?this.gradientScaleSize:e.width-10,l="Fixed"!==n.paletteSettings.type||n.legendSettings.enableSmartLegend?e.height-20-r:(this.legendSize+this.listInterval)*this.listPerPage-this.listInterval),this.legendRectScale=new F(t,i,a,l),("Gradient"===n.paletteSettings.type||"Fixed"===n.paletteSettings.type&&n.legendSettings.enableSmartLegend)&&this.calculateColorAxisGrid(this.legendRectScale)},e.prototype.calculateColorAxisGrid=function(e){var t,i,l,a,n=this.heatMap,s=this.legendRectScale,o=0;this.segmentCollectionsLabels=[],this.segmentCollections=[],this.textWrapCollections=[];var r,h="Gradient"===n.paletteSettings.type?n.legendColorCollection:n.colorCollection,d=n.bubbleSizeWithColor?n.minColorValue:n.dataSourceMinValue,p=n.bubbleSizeWithColor?n.maxColorValue:n.dataSourceMaxValue;if(this.legendMinValue=this.heatMap.isColorRange?h[0].startValue>n.dataSourceMinValue?n.dataSourceMinValue:h[0].startValue:h[0].value>d?d:h[0].value,this.legendMaxValue=this.heatMap.isColorRange?h[h.length-1].endValue<n.dataSourceMaxValue?n.dataSourceMaxValue:h[h.length-1].endValue:h[h.length-1].value<p?p:h[h.length-1].value,"Gradient"===n.paletteSettings.type)for(var g=0;g<h.length;g++){var c=void 0;t=(this.heatMap.isColorRange&&n.horizontalGradient?s.width:s.height)/100,this.heatMap.isColorRange?(h[0].startValue!==this.heatMap.dataSourceMinValue&&0===g&&h[0].startValue>this.heatMap.dataSourceMinValue&&(c=(this.heatMap.dataSourceMinValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,a=(n.horizontalGradient?e.x:e.y)+t*c,this.segmentCollections.push(a)),c=((h[g].startValue<n.dataSourceMinValue&&h[g].endValue>n.dataSourceMaxValue?n.dataSourceMinValue:h[g].startValue)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,c=isNaN(c)?0:c,a=(n.horizontalGradient?e.x:e.y)+t*c,this.segmentCollections.push(a),this.segmentCollectionsLabels.push(a),h[g].endValue!==(g===h.length-1?this.heatMap.dataSourceMaxValue:h[g+1].startValue)&&this.heatMap.legendColorCollection[g].endValue<this.heatMap.dataSourceMaxValue&&(g===h.length-1&&(c=(h[g].endValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,a=(n.horizontalGradient?e.x:e.y)+t*c,this.segmentCollections.push(a)),c=((g===h.length-1?this.heatMap.dataSourceMaxValue:h[g].endValue)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,a=(n.horizontalGradient?e.x:e.y)+t*c,this.segmentCollections.push(a))):(c=(h[g].value-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,c=isNaN(c)?0:c,n.horizontalGradient?(t=s.width/100,l=e.x+t*c,this.segmentCollections.push(l)):(t=s.height/100,a=e.y+t*c,this.segmentCollections.push(a)))}if(n.horizontalGradient){for(var u=this.heatMap.isColorRange?this.segmentCollectionsLabels:this.segmentCollections,b=0;b<h.length;b++){if("Gradient"===n.paletteSettings.type){var f=(u[b]-u[b-1])/2,v=(u[b+1]-u[b])/2;r=b===h.length-1?this.heatMap.isColorRange?(e.width-u[b-1])/2:f:0===b?v:f<v&&!this.heatMap.isColorRange?f:v}else{var y=this.legendRectScale.width/n.colorCollection.length;r="Edge"===n.legendSettings.labelDisplayType?y:y/2}this.textWrapCollections.push(r),o=(i=K(this.labelCollections[b],n.legendSettings.textStyle,r)).length>o?i.length:o}"Bottom"===n.legendSettings.position?(n.initialClipRect.height-=this.maxLegendLabelSize.height*(o-1),this.legendGroup.y-=this.maxLegendLabelSize.height*(o-1),this.legendRectScale.y=this.legendGroup.y+this.legendRectPadding,this.legendGroup.height=parseInt(this.legendHeight,10)+this.maxLegendLabelSize.height*(o-1)):(n.initialClipRect.y+=this.maxLegendLabelSize.height*(o-1),n.initialClipRect.height-=this.maxLegendLabelSize.height*(o-1),this.legendRectScale.y=this.legendGroup.y+this.legendRectPadding,this.legendGroup.height=parseInt(this.legendHeight,10)+this.maxLegendLabelSize.height*(o-1))}},e.prototype.renderColorAxisGrid=function(e){var t,i,l,a,n,s=this.heatMap;s.enableCanvasRendering||(t=this.heatMap.renderer.createGroup({id:s.element.id+"_ColorAxis_Grid"}));for(var o=0;o<(s.isColorRange?this.segmentCollections.length:s.legendColorCollection.length);o++){s.horizontalGradient?(i=a=this.segmentCollections[o],l=e.y,n=e.y+e.height):(i=e.x,l=n=this.segmentCollections[o],a=e.x+e.width);var r=new W(i,l,a,n),h=new Y(this.heatMap.element.id+"_ColorAxis_Grid"+o,r,"#EEEEEE",1);this.drawSvgCanvas.drawLine(h,t),s.enableCanvasRendering||this.legend.appendChild(t)}},e.prototype.renderLegendTitleTooltip=function(e,t,i){if(-1!==e.target.id.indexOf("_legendTitle")&&e.target.textContent.indexOf("...")>-1)ae(this.heatMap.legendSettings.title.text,t,i,this.heatMap.element.offsetWidth,this.heatMap.element.id+"_legendTitle_Tooltip",se(this.heatMap.element.id+"_Secondary_Element"),null,this.heatMap),document.getElementById(this.heatMap.element.id+"_legendTitle_Tooltip").style.visibility="visible";else{var l=document.getElementById(this.heatMap.element.id+"_legendTitle_Tooltip");l&&(l.style.visibility="hidden")}},e.prototype.renderLegendLabelTooltip=function(e,t,i){if(-1!==e.target.id.indexOf("_Legend_Label")&&e.target.textContent.indexOf("...")>-1){var l=e.target.id.split(this.heatMap.element.id+"_Legend_Label");if(2===l.length){var a=void 0;a=1===l[1].length||"Trim"===this.heatMap.legendSettings.textStyle.textOverflow?parseInt(l[1],10):parseInt(l[1].substring(0,l[1].length-1),10),ae(this.labelCollections[a],t,i,this.heatMap.element.offsetWidth,this.heatMap.element.id+"_LegendLabel_Tooltip",se(this.heatMap.element.id+"_Secondary_Element"),null,this.heatMap),document.getElementById(this.heatMap.element.id+"_LegendLabel_Tooltip").style.visibility="visible"}}else{var n=document.getElementById(this.heatMap.element.id+"_LegendLabel_Tooltip");n&&(n.style.visibility="hidden")}},e.prototype.calculateListPerPage=function(e){var t=this.heatMap;if(t.horizontalGradient){this.lastList=[];var i=e.x,l=e.y,a=0,n=0,s=0,o=0,r=void 0;for(this.labelXCollections=[],this.labelYCollections=[],this.legendXCollections=[],this.legendYCollections=[],r=0;r<t.colorCollection.length;r++){if(t.legendSettings.showLabel)a=O(this.labelCollections[r],t.legendSettings.textStyle).width;s=i+10+5,o=l+5;var h=t.legendSettings.showLabel?s+a:i+this.legendSize+this.listInterval;0!==r&&h>this.legendGroup.width+this.legendGroup.x-this.listInterval&&(n+=1,s=(i=e.x)+10+5,o=(l=e.y+20*n)+5,n%this.listPerPage==0&&(this.lastList.push(r),o=(l=e.y)+5,n=0)),this.labelXCollections.push(s),this.labelYCollections.push(o),this.legendXCollections.push(i),this.legendYCollections.push(l),i=i+this.legendSize+this.labelPadding+a+this.listInterval}this.lastList.push(r),this.numberOfPages=this.lastList.length}},e.prototype.renderListLegendMode=function(e,t){var i,l=this.heatMap,a={color:"transparent",width:0};this.legendLabelTooltip=[];var n,s,o=new _(0,0),r=0,h=0,d=e.x,p=e.y;t&&this.renderPagingElements();var g=l.legendSettings.title.text?this.width-2*(this.legendSize+this.labelPadding):this.legendGroup.width-(this.legendSize+this.legendRectPadding+this.labelPadding);l.horizontalGradient?(n=1===this.currentPage?0:this.lastList[this.currentPage-2],s=this.lastList[this.currentPage-1]):s=(s=(n=this.currentPage*this.listPerPage-this.listPerPage)+this.listPerPage)<l.colorCollection.length?s:l.colorCollection.length;for(var c=n;c<s;c++){if(l.legendSettings.showLabel)o=O(y=this.labelCollections[c],l.legendSettings.textStyle);var u={cancel:!1,text:this.labelCollection[c],name:"legendRender"};if(l.horizontalGradient&&(d=this.legendXCollections[c],p=this.legendYCollections[c],r=this.labelXCollections[c],h=this.labelYCollections[c]),r=d+this.legendSize+this.labelPadding,h=p+5,this.heatMap.trigger("legendRender",u),t&&l.rendering&&this.legendRange.length<=l.colorCollection.length){var b=new ce(d,p,10,10,l.colorCollection[c].value,!0,this.currentPage);if(b.visible=!!sf.base.isNullOrUndefined(this.visibilityCollections[c])||this.visibilityCollections[c],u.cancel){var f=new ce(d,p,0,0,l.colorCollection[c].value,!0,this.currentPage);this.legendRange.push(f)}else this.legendRange.push(b);if(l.legendSettings.showLabel){var v=new ce(r,h-o.height/2,o.width,o.height,l.colorCollection[c].value,!0,this.currentPage);v.visible=!!sf.base.isNullOrUndefined(this.visibilityCollections[c])||this.visibilityCollections[c],this.legendTextRange.push(v)}}if(!u.cancel){if(l.legendSettings.showLabel){var y;-1!==(y=K(this.labelCollections[c],l.legendSettings.textStyle,g))[0].indexOf("...")&&l.enableCanvasRendering&&this.legendLabelTooltip.push(new re(this.labelCollections[c],new F(r,h,o.width,o.height)));var m=new k(r,h,"start",y,0,"translate(0,0)","middle"),x=new j(l.element.id+"_Legend_Label"+c,m,l.legendSettings.textStyle,l.legendSettings.textStyle.color||l.themeStyle.legendLabel);x.fill=l.legendOnLoad||this.legendRange[c].visible?x.fill:"#D3D3D3",this.drawSvgCanvas.createText(x,this.translategroup,y[0]),sf.base.Browser.isIE&&!l.enableCanvasRendering&&this.translategroup.lastChild.setAttribute("dy","0.6ex")}i=new F(d,p,10,10);var C=l.legendOnLoad||this.legendRange[c].visible?this.heatMap.isColorRange?l.colorCollection[c].minColor:l.colorCollection[c].color:"#D3D3D3",S=new G(l.element.id+"_legend_list"+c,C,a,1,i);this.drawSvgCanvas.drawRectangle(S,this.translategroup),l.horizontalGradient?d=d+this.legendSize+this.labelPadding+o.width+this.listInterval:p+=this.legendSize+this.listInterval}}if(!l.enableCanvasRendering){this.legendGroup.height=this.legendGroup.height>0?this.legendGroup.height:0,this.legendGroup.width=this.legendGroup.width>0?this.legendGroup.width:0;var M=l.renderer.createClipPath({id:l.element.id+"_LegendScale_ClipPath"}),w=l.renderer.drawRectangle(this.legendGroup);M.appendChild(w),this.translategroup.appendChild(M),this.legend.setAttribute("style","clip-path:url(#"+M.id+")"),this.legendScale.appendChild(this.translategroup),l.svgObject.appendChild(this.legend)}},e.prototype.translatePage=function(e,t,i){if(i&&t>=1&&t<this.numberOfPages||!i&&t>1&&t<=this.numberOfPages){if(i?(this.currentPage+=1,this.legendRect.y+=this.legendRect.height):(this.currentPage-=1,this.legendRect.y-=this.legendRect.height),e.enableCanvasRendering)(l=e.canvasRenderer.ctx).fillRect(this.legendRectScale.x-5,this.legendRectScale.y-5,this.legendRectScale.width+5,this.legendRectScale.height+10),l.fillRect(this.pagingRect.x,this.pagingRect.y,this.pagingRect.width,this.pagingRect.height);else for(this.paginggroup.removeChild(this.paginggroup.firstChild);this.translategroup.childNodes.length;)this.translategroup.removeChild(this.translategroup.firstChild);this.renderListLegendMode(this.legendRectScale,!0)}if(e.enableCanvasRendering&&e.allowSelection&&e.rectSelected){var l=e.secondaryCanvasRenderer.ctx,a=e.legendSettings.position,n=e.initialClipRect,s="Right"===a?n.x+n.width:0,o="Bottom"===a?n.y+n.height:0,r="Right"===a?e.availableSize.width-(n.x+n.width):"Left"===a?n.x:e.availableSize.width,h="Top"===a?n.y:"Bottom"===a?e.availableSize.height-(n.y+n.height):e.availableSize.height;l.save(),l.clearRect(s,o,r,h),l.restore();var d=document.getElementById(e.element.id+"_canvas"),p=document.getElementById(e.element.id+"_secondary_canvas"),g=d.getContext("2d").getImageData(s,o,r,h);p.getContext("2d").putImageData(g,s,o),d.style.opacity="0.3"}},e.prototype.createTooltipDiv=function(e){var t=sf.base.createElement("div",{id:this.heatMap.element.id+"legendLabelTooltipContainer",styles:"position:absolute"});this.heatMap.element.appendChild(t)},e.prototype.renderTooltip=function(e){var t,i=this.heatMap,l=[e.label];t=parseInt(i.legendSettings.textStyle.size,10)/2,this.tooltipObject=new sf.svgbase.Tooltip({offset:t,theme:i.theme,content:l,location:{x:e.x+e.width/2,y:e.y+e.height/2},inverted:!i.horizontalGradient,areaBounds:{height:this.legendGroup.height+this.legendGroup.y,width:this.legendGroup.width+this.legendGroup.x,x:"Right"===i.legendSettings.position?0:this.legendGroup.x,y:"Top"===i.legendSettings.position?""===i.titleSettings.text?this.legendGroup.height-this.legendGroup.y:this.legendGroup.y:0}},"#"+this.heatMap.element.id+"legendLabelTooltipContainer"),this.tooltipObject.element.style.visibility="visible"},e.prototype.createTooltip=function(e,t){for(var i,l=0;l<this.heatMap.colorCollection.length;l++){var a=this.legendRectPositionCollection[l];if(a&&e>a.x&&e<a.width+a.x&&t>a.y&&t<a.height+a.y){i=this.legendRectPositionCollection[l];break}}var n=document.getElementById(this.heatMap.element.id+"legendLabelTooltipContainer");n&&"visible"===n.style.visibility&&this.tooltipObject&&!this.heatMap.isTouch&&(this.tooltipObject.fadeOut(),n.style.visibility="hidden"),i&&this.renderTooltip(i)},e.prototype.legendRangeSelection=function(e){var t=this.heatMap,i=this.legendRange,l=t.horizontalGradient?10:0,a=this.legendRectScale,n=t.canvasRenderer.ctx;if(t.rangeSelection=!0,t.enableCanvasRendering){var s=t.canvasRenderer.ctx;t.legendSettings.enableSmartLegend?s.fillRect(a.x-5,a.y-5,a.width+this.labelPadding+this.maxLegendLabelSize.width+5,a.height+2*(5+l)):s.fillRect(a.x-5,a.y-5,a.width+5,a.height+10)}else{if(t.legendSettings.enableSmartLegend)for(;this.legend&&this.legend.childNodes.length;)this.legend.removeChild(this.legend.firstChild);else for(;this.translategroup&&this.translategroup.childNodes.length;)this.translategroup.removeChild(this.translategroup.firstChild);ne(t.heatMapSeries.containerRectObject.id),t.cellSettings.showLabel&&ne(t.heatMapSeries.containerTextObject.id)}if(t.legendSettings.enableSmartLegend&&t.colorCollection.length!==t.legendColorCollection.length&&(e===t.legendColorCollection.length-1?t.toggleValue[e-1].visible=this.visibilityCollections[e-1]=i[e-1].visible=!i[e].visible:e===t.colorCollection.length-1&&(t.toggleValue[e+1].visible=this.visibilityCollections[e+1]=i[e+1].visible=!i[e].visible)),t.toggleValue[e].visible=this.visibilityCollections[e]=i[e].visible=!i[e].visible,t.legendOnLoad=!1,t.legendSettings.enableSmartLegend){this.renderSmartLegend();var o=new F(a.x,a.y,a.width,a.height);this.renderLegendLabel(o),t.enableCanvasRendering&&(n.save(),n.clip()),"SVG"===t.renderingMode&&this.renderTitle(o)}else this.renderListLegendMode(this.legendRectScale,!1);t.enableCanvasRendering&&n.restore(),t.heatMapSeries.renderRectSeries(),t.clearSelection(),t.enableCanvasRendering&&t.allowSelection},e.prototype.updateLegendRangeCollections=function(){var e=this.heatMap;e.rangeSelection=!e.legendOnLoad,this.visibilityCollections=e.legendOnLoad?[]:this.visibilityCollections,e.toggleValue=e.legendOnLoad?[]:e.toggleValue,this.legendRange=e.legendOnLoad?[]:this.legendRange,this.legendTextRange=e.legendOnLoad?[]:this.legendTextRange},e}(),We=(we=function(e,t){return(we=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}we(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Ye=function(e,t,l,a){var n,s=arguments.length,o=s<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,l):a;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,l,a);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(o=(s<3?n(o):s>3?n(t,l,o):n(t,l))||o);return s>3&&o&&Object.defineProperty(t,l,o),o},Ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return We(t,e),Ye([sf.base.Property(!1)],t.prototype,"isJsonData",void 0),Ye([sf.base.Property("None")],t.prototype,"adaptorType",void 0),Ye([sf.base.Property("")],t.prototype,"xDataMapping",void 0),Ye([sf.base.Property("")],t.prototype,"yDataMapping",void 0),Ye([sf.base.Property("")],t.prototype,"valueMapping",void 0),Ye([sf.base.Complex({},g)],t.prototype,"bubbleDataMapping",void 0),t}(sf.base.ChildProperty),Xe=function(){},Je=function(){function e(e){this.reconstructedXAxis=[],this.reconstructedYAxis=[],this.adaptiveXMinMax=new Xe,this.adaptiveYMinMax=new Xe,this.heatMap=e}return e.prototype.constructDatasource=function(e,t){if("Cell"===t.adaptorType){var i=this.heatMap.xAxis,l=this.heatMap.yAxis;this.adaptiveXMinMax.min=i.minimum,this.adaptiveXMinMax.max=i.maximum,this.adaptiveYMinMax.min=l.minimum,this.adaptiveYMinMax.max=l.maximum,("Numeric"!==i.valueType&&"DateTime"!==i.valueType||!sf.base.isNullOrUndefined(i.minimum)&&!sf.base.isNullOrUndefined(i.maximum))&&("Numeric"!==l.valueType&&"DateTime"!==l.valueType||!sf.base.isNullOrUndefined(l.minimum)&&!sf.base.isNullOrUndefined(l.maximum))||this.getMinMaxValue(e,t,i,l),this.heatMap.isCellData=!0}"None"===t.adaptorType?this.heatMap.completeAdaptDataSource=e:t.isJsonData||"Table"!==t.adaptorType?t.isJsonData&&"Table"===t.adaptorType?this.heatMap.completeAdaptDataSource=this.processJsonTableData(e,t):t.isJsonData&&"Cell"===t.adaptorType?this.heatMap.completeAdaptDataSource=this.processJsonCellData(e,t):t.isJsonData||"Cell"!==t.adaptorType||(this.constructAdaptiveAxis(),this.heatMap.completeAdaptDataSource=this.processCellData(e),this.heatMap.isCellData=!0):this.heatMap.completeAdaptDataSource=e},e.prototype.constructAdaptiveAxis=function(){var e=this.heatMap.xAxis,t=this.heatMap.yAxis;"Numeric"===e.valueType&&(this.reconstructedXAxis=this.getNumericAxisCollection(this.adaptiveXMinMax.min,this.adaptiveXMinMax.max,e.increment)),"Numeric"===t.valueType&&(this.reconstructedYAxis=this.getNumericAxisCollection(this.adaptiveYMinMax.min,this.adaptiveYMinMax.max,t.increment)),"DateTime"===e.valueType&&(this.reconstructedXAxis=this.getDateAxisCollection(this.adaptiveXMinMax.min,this.adaptiveXMinMax.max,e.intervalType,e.increment)),"DateTime"===t.valueType&&(this.reconstructedYAxis=this.getDateAxisCollection(this.adaptiveYMinMax.min,this.adaptiveYMinMax.max,t.intervalType,t.increment))},e.prototype.getNumericAxisCollection=function(e,t,i){for(var l=e,a=[];l<=t;)a.push(l.toString()),l+=i;return a},e.prototype.getDateAxisCollection=function(e,t,i,l){for(var a={skeleton:"full",type:"dateTime"},n=this.heatMap.intl.getDateParser(a),s=this.heatMap.intl.getDateFormat(a),o=e=Date.parse(n(s(new Date(sf.data.DataUtil.parse.parseJson({val:e}).val)))),r=[];o<=t;)r.push(new Date(o).toString()),o=oe(o,1,i,l).getTime();return r},e.prototype.getMinMaxValue=function(e,t,i,l){var a=e,n=Object.keys(a[0]);a.length>0&&(this.adaptiveXMinMax.min=sf.base.isNullOrUndefined(i.minimum)?t.isJsonData?a[0][n[0]]:a[0][0]:i.minimum,this.adaptiveYMinMax.min=sf.base.isNullOrUndefined(l.minimum)?t.isJsonData?a[0][n[1]]:a[0][1]:l.minimum,this.adaptiveXMinMax.max=sf.base.isNullOrUndefined(i.maximum)?t.isJsonData?a[0][n[0]]:a[0][0]:i.maximum,this.adaptiveYMinMax.max=sf.base.isNullOrUndefined(l.maximum)?t.isJsonData?a[0][n[1]]:a[0][1]:l.maximum);for(var s=0;s<a.length;s++){var o=t.isJsonData?a[s][n[0]]:a[s][0],r=t.isJsonData?a[s][n[1]]:a[s][1];o<this.adaptiveXMinMax.min&&sf.base.isNullOrUndefined(i.minimum)&&(this.adaptiveXMinMax.min=o),o>this.adaptiveXMinMax.max&&sf.base.isNullOrUndefined(i.maximum)&&(this.adaptiveXMinMax.max=o),r<this.adaptiveYMinMax.min&&sf.base.isNullOrUndefined(l.minimum)&&(this.adaptiveYMinMax.min=r),r>this.adaptiveYMinMax.max&&sf.base.isNullOrUndefined(l.maximum)&&(this.adaptiveYMinMax.max=r)}},e.prototype.processCellData=function(e){var t=e,i=this.reconstructedXAxis,l=this.reconstructedYAxis,a=0,n=0;if(this.reconstructData=[],t&&t.length)for(var s=0;s<t.length;s++)if((a="Category"===this.heatMap.xAxis.valueType?t[s][0]:i.indexOf(t[s][0].toString()))>-1){for(;!this.reconstructData[a];)this.reconstructData.push([]);if(-1!==(n="Category"===this.heatMap.yAxis.valueType?t[s][1]:l.indexOf(t[s][1].toString()))){for(;""!==this.reconstructData[a][n];)this.reconstructData[a].push("");this.reconstructData[a][n]=sf.base.isNullOrUndefined(t[s][2])?"":t[s][2]}}return this.reconstructData},e.prototype.processJsonCellData=function(e,t){var i=e,l=this.heatMap.xAxis.labels?this.heatMap.xAxis.labels:[],a=this.heatMap.yAxis.labels?this.heatMap.yAxis.labels:[],n=this.heatMap.axisCollections;0!==l.length&&0!==a.length||this.generateAxisLabels(e,t);var s="Category"===this.heatMap.xAxis.valueType?l.length>0?this.heatMap.xAxis.labels:n[0].jsonCellLabel:n[0].labelValue,o="Category"===this.heatMap.yAxis.valueType?a.length>0?this.heatMap.yAxis.labels:n[1].jsonCellLabel:n[1].labelValue,r=0,h=0;if(i.length){this.reconstructData=[];for(var d=0;d<i.length;d++)if(-1!==(r=this.getSplitDataValue(i[d],t,s,t.xDataMapping.split("."),this.heatMap.xAxis.valueType))){for(;!this.reconstructData[r];)this.reconstructData.push([]);if(-1!==(h=this.getSplitDataValue(i[d],t,o,t.yDataMapping.split("."),this.heatMap.yAxis.valueType))){for(;sf.base.isNullOrUndefined(this.reconstructData[r][h]);)this.reconstructData[r].push("");this.heatMap.bubbleSizeWithColor?this.reconstructData[r][h]=[this.getSplitDataValue(i[d],t,null,t.bubbleDataMapping.size.split("."),""),this.getSplitDataValue(i[d],t,null,t.bubbleDataMapping.color.split("."),"")]:this.reconstructData[r][h]=this.getSplitDataValue(i[d],t,null,t.valueMapping.split("."),"")}}}return this.reconstructData},e.prototype.generateAxisLabels=function(e,t){for(var i=e,l=this.heatMap.xAxis.labels?this.heatMap.xAxis.labels:[],a=this.heatMap.yAxis.labels?this.heatMap.yAxis.labels:[],n=l.length>0,s=a.length>0,o=this.heatMap.axisCollections,r=0;r<o.length;r++){var h=o[r].valueType,d=o[r];if("Category"===h){var p=void 0,g=void 0,c=void 0;if("Horizontal"===d.orientation?(p=n,g=t.xDataMapping,d.jsonCellLabel=c=[]):(p=s,g=t.yDataMapping,d.jsonCellLabel=c=[]),!p)for(var u=0;u<i.length;u++)if(g in i[u]){var b=i[u][g].toString();-1===c.indexOf(b.toString())&&c.push(b)}}else"DateTime"===h?(d.clearAxisLabel(),d.calculateDateTimeAxisLabel(this.heatMap)):(d.clearAxisLabel(),d.calculateNumericAxisLabels(this.heatMap))}},e.prototype.getSplitDataValue=function(e,t,i,l,a){var n=-1;this.tempSplitDataCollection=e;for(var s=0;s<l.length&&(n=sf.base.isNullOrUndefined(i)?null:"DateTime"!==a?i.indexOf(this.tempSplitDataCollection[l[s]]):i.map(Number).indexOf(+this.tempSplitDataCollection[l[s]]),sf.base.isNullOrUndefined(this.tempSplitDataCollection)||(this.tempSplitDataCollection=-1===n||sf.base.isNullOrUndefined(i)?this.tempSplitDataCollection[l[s]]:this.tempSplitDataCollection),!sf.base.isNullOrUndefined(this.tempSplitDataCollection));s++);return n=sf.base.isNullOrUndefined(i)?sf.base.isNullOrUndefined(this.tempSplitDataCollection)||""===this.tempSplitDataCollection.toString()?"":parseFloat(this.tempSplitDataCollection.toString()):n},e.prototype.processJsonTableData=function(e,t){var i,l=e,a=0,n=0,s=this.heatMap.xAxis.labels?this.heatMap.xAxis.labels:[],o=this.heatMap.yAxis.labels?this.heatMap.yAxis.labels:[];if(l.length){this.reconstructData=[];for(var r=0;r<l.length;r++)if(-1!==(a=this.getSplitDataValue(l[r],t,s,t.xDataMapping.split("."),this.heatMap.xAxis.valueType))){for(;!this.reconstructData[a];)this.reconstructData.push([]);for(var h=0;h<Object.keys(this.tempSplitDataCollection).length;h++)if(-1!==(n=(i=Object.keys(this.tempSplitDataCollection)[h])!==t.xDataMapping?o.indexOf(i):-1)){for(;sf.base.isNullOrUndefined(this.reconstructData[a][n]);)this.reconstructData[a].push("");this.reconstructData[a][n]=sf.base.isNullOrUndefined(this.tempSplitDataCollection[i])?"":this.tempSplitDataCollection[i]}}}return this.reconstructData},e.prototype.destroy=function(e){},e.prototype.getModuleName=function(){return"Adaptor"},e}(),Ze=function(){function e(e){this.control=e}return e.prototype.export=function(e,t,i){var l,a=this,n=this.getControlsValue(),s=n.width,o=n.height,r=this.control.svgObject,h=this.control.enableCanvasRendering;h||(r=sf.base.createElement("canvas",{id:"ej2-canvas",attrs:{width:s.toString(),height:o.toString()}}));var d=!(sf.base.Browser.userAgent.toString().indexOf("HeadlessChrome")>-1);i=sf.base.isNullOrUndefined(i)?sf.pdfexport.PdfPageOrientation.Landscape:i;var p='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">'+n.svg.outerHTML+"</svg>",g=window.URL.createObjectURL(new Blob("SVG"===e?[p]:[(new XMLSerializer).serializeToString(n.svg)],{type:"image/svg+xml"}));if("SVG"===e)if("msie"===sf.base.Browser.info.name){var c=new Blob([(new XMLSerializer).serializeToString(n.svg)],{type:"application/octet-stream"});window.navigator.msSaveOrOpenBlob(c,t+"."+e.toLocaleLowerCase())}else this.triggerDownload(t,e,g,d);else if("msie"===sf.base.Browser.info.name){var u=r;h||(u=this.createCanvas()),l=u.toDataURL(e),"PDF"===e?this.exportPdf(u,i,s,o,d,t):this.doExport(e,l,t)}else{var b=new Image,f=r.getContext("2d");b.onload=function(){f.drawImage(b,0,0),window.URL.revokeObjectURL(g),"PDF"===e?a.exportPdf(r,i,s,o,d,t):window.navigator.msSaveOrOpenBlob?window.navigator.msSaveOrOpenBlob(r.msToBlob(),t+"."+e.toLocaleLowerCase()):a.triggerDownload(t,e,r.toDataURL("image/png").replace("image/png","image/octet-stream"),d)},b.src=g}h||ne(document.getElementById(this.control.element.id)+"_canvas")},e.prototype.triggerDownload=function(e,t,i,l){sf.base.createElement("a",{attrs:{download:e+"."+t.toLocaleLowerCase(),href:i}}).dispatchEvent(new MouseEvent(l?"click":"move",{view:window,bubbles:!1,cancelable:!0}))},e.prototype.getControlsValue=function(){var e=0,t=0,i=this.control.enableCanvasRendering,l=new sf.svgbase.SvgRenderer("").createSvg({id:"Svg_Export_Element",width:200,height:200}),a=this.control.svgObject.cloneNode(!0),n=this.control.renderer.createGroup({style:"transform: translateY("+t+"px)"});return i||n.appendChild(a),e=Math.max(this.control.availableSize.width,e),t+=this.control.availableSize.height,i||l.appendChild(n),i||(l.setAttribute("width",e+""),l.setAttribute("height",t+"")),{width:e,height:t,svg:l}},e.prototype.createCanvas=function(){var e=this.control,t=e.renderingMode;e.renderingMode="Canvas",e.refresh();var i=e.svgObject;return e.renderingMode=t,e.refresh(),i},e.prototype.exportPdf=function(e,t,i,l,a,n){var s,o,r=new sf.pdfexport.PdfDocument,h=r.pageSettings.margins,d=r.pageSettings.width,p=r.pageSettings.height,g=e.toDataURL("image/jpeg").replace("image/jpeg","image/octet-stream");r.pageSettings.orientation=t,s=d<i?i+h.left+h.right:d,o=p<l?l+h.top+h.bottom:p,r.pageSettings.size=new sf.pdfexport.SizeF(s,o),g=g.slice(g.indexOf(",")+1),r.pages.add().graphics.drawImage(new sf.pdfexport.PdfBitmap(g),0,0,i,l),a&&(r.save(n+".pdf"),r.destroy())},e.prototype.doExport=function(e,t,i){var l,a=e||"JPG";l=[t],this.exportImage(l,i,a,t)},e.prototype.exportImage=function(e,t,i,l){for(var a=[],n=e instanceof HTMLElement?0:e.length,s=0;s<n;s++){for(var o=e[s].replace(/^data:[a-z]*;,/,"").split(","),r=atob(o[1]),h=new ArrayBuffer(r.length),d=new Uint8Array(h),p=0;p<r.length;p++)d[p]=r.charCodeAt(p);a.push(h)}for(var g=0;g<a.length;g++){var c=new Blob([a[g]],{type:"application/octet-stream"});"msie"===sf.base.Browser.info.name&&window.navigator.msSaveOrOpenBlob(c,t+"."+i.toLocaleLowerCase())}},e.prototype.print=function(){if(this.printWindow=window.open("","print","height="+window.outerHeight+",width="+window.outerWidth+",tabbar=no"),this.printWindow.moveTo(0,0),this.printWindow.resizeTo(screen.availWidth,screen.availHeight),"SVG"===this.control.renderingMode)sf.base.print(this.getHTMLContent(),this.printWindow);else{var e=this.control.svgObject,t=e.toDataURL(),i=new Image,l=e.getContext("2d");i.onload=function(){l.drawImage(i,0,0)},i.src=t,sf.base.print(i,this.printWindow)}},e.prototype.getHTMLContent=function(){var e=sf.base.createElement("div");return e.appendChild(this.control.element.cloneNode(!0)),e},e}(),qe=(Le=function(e,t){return(Le=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Le(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),$e=function(e,t,l,a){var n,s=arguments.length,o=s<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,l):a;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,l,a);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(o=(s<3?n(o):s>3?n(t,l,o):n(t,l))||o);return s>3&&o&&Object.defineProperty(t,l,o),o},Ke=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.enableCanvasRendering=!1,t.isColorRange=!1,t.isCellTapHold=!1,t.selectedCellCount=0,t.toggleValue=[],t.legendOnLoad=!0,t.resizing=!1,t.rendering=!0,t.horizontalGradient="Bottom"===t.legendSettings.position||"Top"===t.legendSettings.position,t.multiSelection=!1,t.rectSelected=!1,t.previousSelectedCellsRect=[],t.multiCellCollection=[],t.selectedMultiCellCollection=[],t.tempMultiCellCollection=[],t.tooltipCollection=[],t.isCellData=!1,t.isBlazor=!1,t}return qe(i,e),i.prototype.preRender=function(){this.initPrivateVariable(),this.unWireEvents(),this.wireEvents()},i.prototype.export=function(e,t,i){new Ze(this).export(e,t,i)},i.prototype.initPrivateVariable=function(){this.renderer=new sf.svgbase.SvgRenderer(this.element.id),this.canvasRenderer=new sf.svgbase.CanvasRenderer(this.element.id),this.secondaryCanvasRenderer=new sf.svgbase.CanvasRenderer(this.element.id+"_secondary"),this.heatMapAxis=new Ve(this),this.heatMapSeries=new _e(this),this.drawSvgCanvas=new $(this),this.twoDimensional=new Ge(this),this.cellColor=new P(this),this.tempRectHoverClass="",this.tempTooltipRectId="",this.setCulture(),this.isBlazor=sf.base.isBlazor()},i.prototype.setCulture=function(){this.intl=new sf.base.Internationalization},i.prototype.render=function(){this.updateBubbleHelperProperty(),this.trigger("load",{heatmap:this.isBlazor?null:this}),this.initAxis(),this.processInitData(),this.setTheme(),this.calculateMaxLength(),this.heatMapAxis.calculateVisibleLabels(),this.twoDimensional.processDataSource(this.completeAdaptDataSource),this.createSvg(),this.cellColor.getColorCollection(),this.calculateBounds(),this.renderElements(),this.appendSvgObject(),this.tooltipModule&&this.tooltipModule.showHideTooltip(!1),this.renderComplete()},i.prototype.reRenderDatasource=function(){this.dataSourceMinValue=null,this.dataSourceMaxValue=null,this.processInitData(),this.calculateMaxLength(),this.heatMapAxis.calculateVisibleLabels(),this.twoDimensional.processDataSource(this.completeAdaptDataSource),this.cellColor.getColorCollection(),this.calculateBounds()},i.prototype.processInitData=function(){this.adaptorModule?this.adaptorModule.constructDatasource(this.dataSource,this.dataSourceSettings):this.completeAdaptDataSource=this.dataSource},i.prototype.setRenderMode=function(){"Canvas"===this.renderingMode||"Auto"===this.renderingMode&&this.axisCollections[0].axisLabelSize*this.axisCollections[1].axisLabelSize>=1e4?this.enableCanvasRendering=!0:this.enableCanvasRendering=!1},i.prototype.updateBubbleHelperProperty=function(){"Bubble"!==this.cellSettings.tileType||"Size"!==this.cellSettings.bubbleType&&"Sector"!==this.cellSettings.bubbleType?this.legendModule&&this.legendSettings.visible&&(this.legendVisibilityByCellType=!0):this.legendVisibilityByCellType=!1,"Bubble"===this.cellSettings.tileType&&"SizeAndColor"===this.cellSettings.bubbleType?this.bubbleSizeWithColor=!0:this.bubbleSizeWithColor=!1},i.prototype.renderElements=function(){this.tooltipCollection=[],this.renderSecondaryElement(),this.renderBorder(),this.renderTitle(),this.heatMapAxis.renderAxes(),this.tooltipModule&&this.showTooltip&&(this.tooltipModule.tooltipObject=null,this.tooltipModule.createTooltipDiv(this)),this.heatMapSeries.renderRectSeries(),this.legendModule&&this.legendSettings.visible&&this.legendVisibilityByCellType&&(this.legendModule.renderLegendItems(),"Fixed"===this.paletteSettings.type&&this.legendSettings.enableSmartLegend&&"None"===this.legendSettings.labelDisplayType&&this.legendModule.createTooltipDiv(this))},i.prototype.getModuleName=function(){return"heatmap"},i.prototype.getPersistData=function(){return""},i.prototype.onPropertyChanged=function(e,t){for(var i=!1,l=!1,a=!0,n=0,s=Object.keys(e);n<s.length;n++){switch(s[n]){case"renderingMode":this.rendering=!1,a=!1,i=!0;break;case"cellSettings":this.updateBubbleHelperProperty(),!this.legendModule||e.cellSettings.tileType===(void 0!==t.cellSettings&&t.cellSettings.tileType)&&e.cellSettings.bubbleType===t.cellSettings.bubbleType||(this.legendOnLoad=!0,this.legendModule.updateLegendRangeCollections()),"Bubble"===this.cellSettings.tileType&&(a=!1),this.reRenderDatasource(),l=!0;break;case"showTooltip":l=!0;break;case"dataSource":case"dataSourceSettings":this.isCellData=!1,this.paletteCellSelectionUpdation(),this.reRenderDatasource(),a=!1,i=!0;break;case"titleSettings":case"width":case"height":case"margin":l=!0;break;case"legendSettings":this.updateBubbleHelperProperty(),!this.legendVisibilityByCellType||e.legendSettings.visible===(void 0!==t.legendSettings&&t.legendSettings.visible)&&e.legendSettings.enableSmartLegend===t.legendSettings.enableSmartLegend?this.legendOnLoad=!1:(this.legendOnLoad=!0,this.legendModule.updateLegendRangeCollections()),l=!0;break;case"yAxis":case"xAxis":this.paletteCellSelectionUpdation(),this.reRenderDatasource(),a=!1,l=!0;break;case"paletteSettings":this.paletteCellSelectionUpdation(),this.twoDimensional.processDataSource(this.completeAdaptDataSource),this.cellColor.getColorCollection(),this.calculateBounds(),i=!0;break;case"theme":this.setTheme(),i=!0;break;case"tooltipSettings":this.tooltipModule&&(this.tooltipModule.tooltipObject.fill=this.tooltipSettings.fill,this.tooltipModule.tooltipObject.border=this.tooltipSettings.border,this.tooltipModule.tooltipObject.textStyle=this.tooltipSettings.textStyle,this.tooltipModule.tooltipObject.template=this.tooltipSettings.template,this.tooltipModule.tooltipObject.refresh())}}!l&&i?(this.createSvg(),this.renderElements(),this.appendSvgObject(),this.trigger("created"),a||this.clearSelection()):l&&(this.createSvg(),this.refreshBound(),this.appendSvgObject(),this.trigger("created")),this.allowSelection&&this.rectSelected&&(a?this.updateCellSelection():this.clearSelection()),this.rendering=!0},i.prototype.paletteCellSelectionUpdation=function(){this.updateBubbleHelperProperty(),this.legendVisibilityByCellType&&(this.legendOnLoad=!0,this.legendModule.updateLegendRangeCollections())},i.prototype.createSvg=function(){this.removeSvg(),this.setRenderMode(),this.calculateSize(),this.enableCanvasRendering?(this.svgObject=this.canvasRenderer.createCanvas({id:this.element.id+"_canvas",width:this.availableSize.width,height:this.availableSize.height}),this.allowSelection&&this.createMultiCellDiv(!0)):(this.svgObject=this.renderer.createSvg({id:this.element.id+"_svg",width:this.availableSize.width,height:this.availableSize.height}),"0"===this.cellSettings.border.width.toString()&&"Rect"===this.cellSettings.tileType&&this.svgObject.setAttribute("shape-rendering","crispEdges"))},i.prototype.removeSvg=function(){if((document.getElementById(this.element.id+"_Secondary_Element")&&sf.base.remove(document.getElementById(this.element.id+"_Secondary_Element")),document.getElementById(this.element.id+"Celltooltipcontainer")&&sf.base.remove(document.getElementById(this.element.id+"Celltooltipcontainer")),document.getElementById(this.element.id+"legendLabelTooltipContainer")&&sf.base.remove(document.getElementById(this.element.id+"legendLabelTooltipContainer")),document.getElementById(this.element.id+"_Multi_CellSelection_Canvas")&&sf.base.remove(document.getElementById(this.element.id+"_Multi_CellSelection_Canvas")),document.getElementById(this.element.id+"_CellSelection_Container")&&sf.base.remove(document.getElementById(this.element.id+"_CellSelection_Container")),this.svgObject)&&document.getElementById(this.svgObject.id)){for(;this.svgObject.childNodes.length;)this.svgObject.removeChild(this.svgObject.firstChild);sf.base.remove(this.svgObject)}},i.prototype.renderSecondaryElement=function(){var e=this.createElement("div");e.id=this.element.id+"_Secondary_Element",this.element.appendChild(e);var t=this.createElement("div",{id:this.element.id+"_CellSelection_Container",styles:"position:absolute; z-index: 2 ; top:"+this.initialClipRect.y+"px; left:"+this.initialClipRect.x+"px"});this.element.appendChild(t)},i.prototype.requiredModules=function(){var e=[];return this.showTooltip&&e.push({member:"Tooltip",args:[this]}),this.legendSettings&&e.push({member:"Legend",args:[this]}),this.dataSource&&e.push({member:"Adaptor",args:[this]}),e},i.prototype.destroy=function(){this.unWireEvents(),e.prototype.destroy.call(this),this.element.innerHTML="",this.element.classList.remove("e-heatmap")},i.prototype.refresh=function(){e.prototype.refresh.call(this),this.element.classList.add("e-heatmap")},i.prototype.appendSvgObject=function(){this.enableCanvasRendering&&this.allowSelection?this.createMultiCellDiv(!1):this.element.appendChild(this.svgObject)},i.prototype.renderBorder=function(){this.border={width:0};var e=new G(this.element.id+"_HeatmapBorder",this.themeStyle.background,this.border,1,new F(0,0,this.availableSize.width-0,this.availableSize.height-0));this.drawSvgCanvas.drawRectangle(e,this.svgObject)},i.prototype.calculateSize=function(){var e=V(this.width,this.element.offsetWidth)||this.element.offsetWidth||600,t=V(this.height,this.element.offsetHeight)||this.element.offsetHeight||450;this.availableSize=new _(e,t);for(var i=this.element;i.parentNode&&"BODY"!==i.tagName;){if("center"===i.align){var l=this.availableSize.width.toString();this.element.style.width=l+"px",this.element.style.margin="0 auto";break}i=i.parentElement}},i.prototype.renderTitle=function(){if(this.titleSettings.text){var e=this.titleSettings.textStyle,t="Near"===e.textAlignment?"start":"Far"===e.textAlignment?"end":"middle";this.elementSize=O(this.titleCollection[0],e);var i=new j(this.element.id+"_HeatmapTitle",new k(D(this.availableSize.width-this.margin.left-this.margin.right,this.margin.left,this.margin.right,e),this.margin.top+3*this.elementSize.height/4,t,this.titleCollection),e,e.color||this.themeStyle.heatMapTitle);this.titleCollection.length>1?this.drawSvgCanvas.createWrapText(i,e,this.svgObject):(this.drawSvgCanvas.createText(i,this.svgObject,this.titleCollection[0]),-1!==this.titleCollection[0].indexOf("...")&&this.enableCanvasRendering&&this.tooltipCollection.push(new re(this.titleSettings.text,new F(this.margin.left,this.margin.top,this.elementSize.width,this.elementSize.height))))}},i.prototype.titleTooltip=function(e,t,i,l){e.target.id===this.element.id+"_HeatmapTitle"&&e.target.textContent.indexOf("...")>-1?ae(this.titleSettings.text,t,i,this.element.offsetWidth,this.element.id+"_Title_Tooltip",se(this.element.id+"_Secondary_Element"),l,this):ne(this.element.id+"_Title_Tooltip")},i.prototype.axisTooltip=function(e,t,i,l){var a=e.target.id;if(-1!==a.indexOf(this.element.id+"_XAxis_Label")||-1!==a.indexOf(this.element.id+"_YAxis_Label")||-1!==a.indexOf(this.element.id+"_XAxis_MultiLevel")||-1!==a.indexOf(this.element.id+"_YAxis_MultiLevel")){var n=he(this.tooltipCollection,t,i);n?ae(n,t,i,this.element.offsetWidth,this.element.id+"_axis_Tooltip",se(this.element.id+"_Secondary_Element"),this.isTouch,this):ne(this.element.id+"_axis_Tooltip")}else ne(this.element.id+"_axis_Tooltip")},i.prototype.isHeatmapRect=function(e,t){var i,l=[],a=[];if(l.push(this.heatMapSeries.rectPositionCollection[0][0]),a.push(this.heatMapSeries.rectPositionCollection[this.yLength-1][this.xLength-1]),this.cellSettings.border.width>5&&e>=l[0].x&&t>=l[0].y&&e<=a[0].x+a[0].width&&t<=a[0].y+a[0].height&&"Rect"===this.cellSettings.tileType){var n=this.heatMapSeries.getCurrentRect(e,t),s=a[0].height,o=a[0].width,r=this.cellSettings.border.width/2;e>=n.x+r&&t>=n.y+r&&e<=n.x+(o-r)&&t<=n.y+(s-r)?(i=!0,this.isRectBoundary=!0):(i=!1,this.isRectBoundary=!1)}else i=e>=l[0].x&&t>=l[0].y&&e<=a[0].x+a[0].width&&t<=a[0].y+a[0].height,this.isRectBoundary=i;return i},i.prototype.setTheme=function(){
/*! Set theme */
this.themeStyle=function(e){var t;switch(e.toLowerCase()){case"highcontrastlight":case"highcontrast":t={heatMapTitle:"#ffffff",axisTitle:"#ffffff",axisLabel:"#ffffff",cellBorder:"#EEEEEE",background:"#000000",cellTextColor:"#000000",toggledColor:"#000000",emptyCellColor:"#EEEEEE",legendLabel:"#ffffff",palette:[{color:"#BEE7EE"},{color:"#85c4cf"},{color:"#4CA1AF"}]};break;case"materialdark":case"fabricdark":case"bootstrapdark":t={heatMapTitle:"#ffffff",axisTitle:"#ffffff",axisLabel:"#DADADA",cellBorder:"#EEEEEE",background:"#000000",cellTextColor:"#000000",toggledColor:"#000000",emptyCellColor:"#EEEEEE",legendLabel:"#ffffff",palette:[{color:"#BEE7EE"},{color:"#85c4cf"},{color:"#4CA1AF"}]};break;case"bootstrap4":t={heatMapTitle:"#212529",axisTitle:"#212529",axisLabel:"#212529",cellBorder:"#E9ECEF",background:"#FFFFFF",cellTextColor:"#212529",toggledColor:"#ffffff",emptyCellColor:"#E9ECEF",legendLabel:"#212529",palette:[{color:"#BEE7EE"},{color:"#85c4cf"},{color:"#4CA1AF"}]};break;default:t={heatMapTitle:"#424242",axisTitle:"#424242",axisLabel:"#686868",cellBorder:"#EEEEEE",cellTextColor:"#000000",toggledColor:"#ffffff",background:"#FFFFFF",emptyCellColor:"#EEEEEE",legendLabel:"#353535",palette:[{color:"#BEE7EE"},{color:"#85c4cf"},{color:"#4CA1AF"}]}}return t}(this.theme)},i.prototype.calculateBounds=function(){var e=this.margin,t=0,i=this.legendModule&&"Top"===this.legendSettings.position&&this.legendVisibilityByCellType||"0px"===this.titleSettings.textStyle.size?0:16,l=e.left,a=this.availableSize.width-l-e.right;if(("Column"===this.paletteSettings.colorGradientMode||"Row"===this.paletteSettings.colorGradientMode)&&"Gradient"===this.paletteSettings.type)if(0===this.paletteSettings.palette.length)this.legendVisibilityByCellType=!1;else for(var n=0;n<this.paletteSettings.palette.length;n++)if(null!==this.paletteSettings.palette[n].value)this.legendVisibilityByCellType=!0;else if(null===this.paletteSettings.palette[n].value){this.legendVisibilityByCellType=!1;break}this.titleSettings.text&&(this.titleCollection=K(this.titleSettings.text,this.titleSettings.textStyle,a),t=O(this.titleSettings.text,this.titleSettings.textStyle).height*this.titleCollection.length+i);var s=e.top+t;this.titleRect=new F(e.left,e.top,this.availableSize.width-e.left-e.right,t);var o=this.availableSize.height-s-e.bottom;this.initialClipRect=new F(l,s,a,o);var r=this.initialClipRect.y;this.legendModule&&this.legendSettings.visible&&this.legendVisibilityByCellType&&this.legendModule.calculateLegendBounds(this.initialClipRect),this.heatMapAxis.measureAxis(this.initialClipRect),this.legendModule&&this.legendSettings.visible&&this.legendVisibilityByCellType&&this.legendModule.calculateLegendSize(this.initialClipRect,r),this.heatMapAxis.calculateAxisSize(this.initialClipRect)},i.prototype.refreshBound=function(){this.updateBubbleHelperProperty(),this.calculateBounds(),this.renderElements()},i.prototype.initAxis=function(){var e,t=[this.xAxis,this.yAxis];this.axisCollections=[];for(var i=0,l=t.length;i<l;i++)(e=t[i]).orientation=0===i?"Horizontal":"Vertical",e.jsonCellLabel=[],this.axisCollections.push(e)},i.prototype.wireEvents=function(){var e=this,t=sf.base.Browser.isPointer,i=sf.base.Browser.touchStartEvent,l=sf.base.Browser.touchEndEvent,a=sf.base.Browser.touchMoveEvent,n=t?"pointerleave":"mouseleave";
/*! Find the Events type */sf.base.EventHandler.add(this.element,sf.base.Browser.isDevice?i:"click",this.heatMapMouseClick,this),sf.base.EventHandler.add(this.element,i,this.heatMapMouseMove,this),sf.base.EventHandler.add(this.element,l,this.heatMapMouseLeave,this),sf.base.EventHandler.add(this.element,a,this.heatMapMouseMove,this),sf.base.EventHandler.add(this.element,n,this.heatMapMouseLeave,this),window.addEventListener(sf.base.Browser.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.heatMapResize.bind(this));var s=this;new sf.base.Touch(this.element,{tapHold:function(){s.isCellTapHold=!0,s.getDataCollection(),s.currentRect.allowCollection=!1,s.setCellOpacity();var t={heatmap:e.isBlazor?null:s,cancel:!1,name:"cellSelected",data:s.multiCellCollection};s.trigger("cellSelected",t)},tap:function(){var e=!1;s.isCellTapHold||(e=!0),s.tooltipOnMouseMove(null,s.currentRect,e)}});this.setStyle(this.element)},i.prototype.setStyle=function(e){e.style.touchAction="element",e.style.msTouchAction="element",e.style.msContentZooming="none",e.style.msUserSelect="none",e.style.webkitUserSelect="none",e.style.position="relative",e.style.display="block"},i.prototype.print=function(){new Ze(this).print()},i.prototype.unWireEvents=function(){
/*! Find the Events type */
var e=sf.base.Browser.isPointer,t=sf.base.Browser.touchStartEvent,i=(sf.base.Browser.touchEndEvent,sf.base.Browser.touchMoveEvent),l=e?"pointerleave":"mouseleave";sf.base.EventHandler.remove(this.element,sf.base.Browser.isDevice?t:"click",this.heatMapMouseClick),sf.base.EventHandler.remove(this.element,t,this.heatMapMouseMove),sf.base.EventHandler.remove(this.element,i,this.heatMapMouseLeave),sf.base.EventHandler.remove(this.element,i,this.heatMapMouseMove),sf.base.EventHandler.remove(this.element,l,this.heatMapMouseLeave),window.removeEventListener(sf.base.Browser.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.heatMapResize)},i.prototype.heatMapResize=function(e){var t=this;this.resizing=!0;var i={heatmap:this.isBlazor?null:this,cancel:!1,name:"resized",currentSize:new _(0,0),previousSize:new _(this.availableSize.width,this.availableSize.height)};return this.resizeTimer&&clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout((function(){t.isDestroyed?clearTimeout(t.resizeTimer):(t.createSvg(),i.currentSize=t.availableSize,t.trigger("resized",i),t.refreshBound(),t.appendSvgObject(),t.allowSelection&&t.updateCellSelection(),t.trigger("loaded",t.isBlazor?null:{heatmap:t}),t.resizing=!1)}),500),!1},i.prototype.updateCellSelection=function(){var e=this.initialClipRect.width/this.axisCollections[0].axisLabelSize,t=this.initialClipRect.height/this.axisCollections[1].axisLabelSize,i=this.initialClipRect.x,l=this.initialClipRect.y;if(this.enableCanvasRendering){if(this.enableCanvasRendering){var a=this.multiCellCollection,n=document.getElementById(this.element.id+"_canvas"),s=document.getElementById(this.element.id+"_secondary_canvas"),o=this.initialClipRect,r=o.y+o.height,h=o.x+o.width;for(v=0;v<this.multiCellCollection.length;v++){this.multiCellCollection[v].width=a[v].width=e,this.multiCellCollection[v].height=a[v].height=t,this.multiCellCollection[v].x=a[v].x=i+e*this.multiCellCollection[v].xPosition,this.multiCellCollection[v].y=a[v].y=l+t*this.multiCellCollection[v].yPosition;var d=n.getContext("2d").getImageData(a[v].x,a[v].y,a[v].width,a[v].height);s.getContext("2d").putImageData(d,a[v].x,a[v].y),n.style.opacity="0.3"}var p=n.getContext("2d").getImageData(0,0,this.availableSize.width,o.y);s.getContext("2d").putImageData(p,0,0);var g=n.getContext("2d").getImageData(0,r,this.availableSize.width,this.availableSize.height-r);s.getContext("2d").putImageData(g,0,o.y+o.height);var c=n.getContext("2d").getImageData(h,0,this.availableSize.width-h,this.availableSize.height);s.getContext("2d").putImageData(c,h,0);var u=n.getContext("2d").getImageData(0,0,o.x,this.availableSize.height);s.getContext("2d").putImageData(u,0,0),ne(this.element.id+"_selectedCells")}}else if(0!==this.multiCellCollection.length){for(var b=document.getElementById(this.element.id+"_Container_RectGroup"),f=document.getElementById(this.element.id+"_Container_TextGroup"),v=0;v<b.childNodes.length;v++)b.childNodes[v].setAttribute("opacity","0.3"),this.cellSettings.showLabel&&f.childNodes[v]&&f.childNodes[v].setAttribute("opacity","0.3");for(var v=0;v<this.multiCellCollection.length;v++){var y=this.multiCellCollection[v].cellElement.id.replace(this.element.id+"_HeatMapRect_",""),m=parseInt(y,10);if(b.childNodes[m].setAttribute("opacity","1"),this.cellSettings.showLabel&&f.childNodes[v]){var x=document.getElementById(this.element.id+"_HeatMapRectLabels_"+m);x&&x.setAttribute("opacity","1"),this.addSvgClass(b.childNodes[m])}}}},i.prototype.clearSVGSelection=function(){for(var e=document.getElementById(this.element.id+"_Container_RectGroup"),t=document.getElementById(this.element.id+"_Container_TextGroup"),i=0;i<e.childNodes.length;i++){var l=e.childNodes[i].getAttribute("class");l===this.element.id+"_selected"&&this.removeSvgClass(e.childNodes[i],l),e.childNodes[i].setAttribute("opacity","1"),this.cellSettings.showLabel&&t.childNodes[i]&&t.childNodes[i].setAttribute("opacity","1")}},i.prototype.calculateMaxLength=function(){var e=this.completeAdaptDataSource;if(e&&e.length>0){for(var t=e.length-1,i=0,l=0;l<=t;l++){var a=e[l].length;i=i>a?i:a}this.axisCollections[0].maxLength=t,this.axisCollections[1].maxLength=i-1}else this.axisCollections[0].maxLength=0,this.axisCollections[1].maxLength=0},i.prototype.setMouseXY=function(e,t){var i,l=this.element.getBoundingClientRect();i=this.enableCanvasRendering?document.getElementById(this.element.id+"_canvas").getBoundingClientRect():document.getElementById(this.element.id+"_svg").getBoundingClientRect(),this.mouseX=e-l.left-Math.max(i.left-l.left,0),this.mouseY=t-l.top-Math.max(i.top-l.top,0)},i.prototype.heatMapMouseClick=function(e){var t,i,l,a=this.element.getBoundingClientRect();if("touchstart"===e.type?(this.isTouch=!0,i=(l=e).changedTouches[0].clientY,t=l.changedTouches[0].clientX):(this.isTouch=!1,i=e.clientY,t=e.clientX),t-=a.left,i-=a.top,this.isHeatmapRect(t,i)){var n=this.heatMapSeries.getCurrentRect(t,i);this.trigger("cellClick",{heatmap:this.isBlazor?null:this,value:n.value,x:n.x,y:n.y,xLabel:this.heatMapSeries.hoverXAxisLabel,yLabel:this.heatMapSeries.hoverYAxisLabel,xValue:this.heatMapSeries.hoverXAxisValue,yValue:this.heatMapSeries.hoverYAxisValue,cellElement:this.enableCanvasRendering?null:document.getElementById(n.id),event:e})}if(this.notify("click",e),"Gradient"!==this.paletteSettings.type&&this.legendModule&&this.legendSettings.visible&&this.legendVisibilityByCellType){var s=this.legendModule.navigationCollections;s.length&&t>s[0].x&&t<s[0].x+s[0].width&&i>s[0].y&&i<s[0].y+s[0].height?this.legendModule.translatePage(this,this.legendModule.currentPage,!0):s.length&&t>s[1].x&&t<s[1].x+s[1].width&&i>s[1].y&&i<s[1].y+s[1].height&&this.legendModule.translatePage(this,this.legendModule.currentPage,!1);for(var o=this.legendModule.legendRange,r=this.legendModule.legendTextRange,h=!0,d=0;d<o.length;d++)this.legendModule&&this.legendSettings.toggleVisibility&&this.legendModule.currentPage===o[d].currentPage&&(h&&t>=o[d].x&&t<=o[d].width+o[d].x&&i>=o[d].y&&i<=o[d].y+o[d].height||this.legendSettings.showLabel&&"None"!==this.legendSettings.labelDisplayType&&t>=r[d].x&&t<=r[d].width+r[d].x&&i>=r[d].y&&i<=r[d].y+r[d].height)&&(this.legendModule.legendRangeSelection(d),h=!1)}return!1},i.prototype.heatMapMouseMove=function(e){var t,i,l,a=this.element.getBoundingClientRect();return"touchmove"===e.type||"touchstart"===e.type?(this.isTouch=!0,t=(l=e).changedTouches[0].clientX,i=l.changedTouches[0].clientY):(this.isTouch=!1,t=e.clientX,i=e.clientY),t-=a.left,i-=a.top,this.setMouseXY(t,i),this.mouseAction(e,t,i,l,a),!0},i.prototype.mouseAction=function(e,t,i,l,a){var n;if(e.target&&e.target.id){var s=this.isHeatmapRect(t,i);this.legendModule&&(s?"Gradient"===this.paletteSettings.type&&this.legendSettings.showGradientPointer&&this.legendSettings.visible&&this.legendVisibilityByCellType&&this.legendModule.renderGradientPointer(e,t,i):this.legendModule.removeGradientPointer(),this.renderMousePointer(t,i));var o=void 0,r=void 0;if(o=!(!this.showTooltip||!this.tooltipModule)&&s,s&&(r=this.heatMapSeries.getCurrentRect(t,i),2!==e.which&&3!==e.which&&(o=this.cellSelectionOnMouseMove(e,r,t,i,o))),this.tooltipOnMouseMove(e,r,o,s),this.legendModule&&this.legendSettings.visible&&"Fixed"===this.paletteSettings.type&&this.legendSettings.enableSmartLegend&&"None"===this.legendSettings.labelDisplayType&&this.legendModule.createTooltip(t,i),this.enableCanvasRendering){this.element.getBoundingClientRect();var h="Fixed"!==this.paletteSettings.type||!this.legendSettings.enableSmartLegend||"None"!==this.legendSettings.labelDisplayType;(n=he(this.tooltipCollection,t,i)||this.legendModule&&h&&(he(this.legendModule.legendLabelTooltip,t,i)||he(this.legendModule.legendTitleTooltip,t,i)))?ae(n,t,i,this.element.offsetWidth,this.element.id+"_canvas_Tooltip",se(this.element.id+"_Secondary_Element"),this.isTouch,this):ne(this.element.id+"_canvas_Tooltip")}else this.titleSettings.text&&"Trim"===this.titleSettings.textStyle.textOverflow&&this.titleTooltip(e,t,i,this.isTouch),this.axisTooltip(e,t,i,this.isTouch),this.legendModule&&this.legendSettings.visible&&this.legendSettings.showLabel&&this.legendVisibilityByCellType&&this.legendModule.renderLegendLabelTooltip(e,t,i),this.legendModule&&this.legendSettings.visible&&this.legendVisibilityByCellType&&this.legendModule.renderLegendTitleTooltip(e,t,i)}return!0},i.prototype.cellSelectionOnMouseMove=function(e,t,i,l,a){return("Rect"===this.cellSettings.tileType&&"mousedown"===e.type||"touchstart"===e.type||"pointerdown"===e.type)&&this.allowSelection&&(this.previousRect=t,this.multiSelection=!0,this.rectSelected=!0,this.initialCellX=i,this.initialCellY=l,e.preventDefault()),"Rect"===this.cellSettings.tileType&&this.multiSelection&&t&&(a=!1,this.highlightSelectedCells(this.previousRect,t,i,l,e)),a},i.prototype.tooltipOnMouseMove=function(e,t,i,l){var a=this;if(i&&t)this.tempTooltipRectId!==t.id&&(this.showTooltip&&((this.cellSettings.enableCellHighlighting||this.tooltipModule&&this.showTooltip)&&!this.enableCanvasRendering&&this.heatMapSeries.highlightSvgRect(t.id),this.tooltipModule.renderTooltip(t),this.isTouch&&(this.tooltipTimer&&window.clearTimeout(this.tooltipTimer),this.tooltipTimer=setTimeout((function(){a.tooltipModule.tooltipObject.fadeOut(),a.tooltipModule.isFadeout=!0}),1500),e&&"touchmove"===e.type&&e.preventDefault())),this.tempTooltipRectId=t.id);else{if(null!==e){l?!this.showTooltip&&this.cellSettings.border.width>5&&this.heatMapSeries.highlightSvgRect(e.target.id):((this.cellSettings.enableCellHighlighting||this.showTooltip)&&!this.enableCanvasRendering&&this.cellSettings.border.width<5&&this.heatMapSeries.highlightSvgRect(e.target.id),this.tooltipModule&&this.showTooltip&&this.tooltipModule.showHideTooltip(!1,!0))}this.tempTooltipRectId=""}},i.prototype.highlightSelectedCells=function(e,t,i,l,a){var n=e.xIndex,s=e.yIndex,o=t.xIndex,r=t.yIndex;this.currentRect=t,this.selectedCellsRect=new F(0,0,0,0),this.selectedCellsRect.x=e.x>t.x?t.x:e.x,this.selectedCellsRect.y=e.y>t.y?t.y:e.y,this.selectedCellsRect.width=(1+(e.x>t.x?n-o:o-n))*t.width,this.selectedCellsRect.height=(1+(e.y>t.y?s-r:r-s))*t.height,"touchstart"===a.type?this.isCellTapHold=!0:this.isCellTapHold=!1,a.preventDefault(),!1===a.ctrlKey&&"touchstart"!==a.type&&"touchmove"!==a.type&&this.removeSelectedCellsBorder();var h=this.initialCellX>i?i:this.initialCellX,d=this.initialCellY>l?l:this.initialCellY,p=document.getElementById(this.element.id+"_CellSelection_Container"),g=this.renderer.createSvg({id:this.element.id+"_CellSelection_Container_svg",width:this.initialClipRect.width,height:this.initialClipRect.height});p.appendChild(g);var c=document.getElementById(this.element.id+"_CellSelection_Container_svg"),u=new F(h-this.initialClipRect.x,d-this.initialClipRect.y,Math.abs(i-this.initialCellX),Math.abs(l-this.initialCellY)),b=new G(this.element.id+"_selectedCells","#87ceeb",{color:"transparent",width:1},1,u,"#0000ff");c.appendChild(this.renderer.drawRectangle(b)),document.getElementById(this.element.id+"_selectedCells").style.opacity="0.5"},i.prototype.getDataCollection=function(){var e=this.previousRect.xIndex,t=this.previousRect.yIndex,i=this.currentRect.xIndex,l=this.currentRect.yIndex,a=i>e?e:i,n=i>e?i:e,s=l>t?t:l,o=l>t?l:t,r=a,h=s,d=this.previousRect.x,p=this.previousRect.y;this.getCellCollection(this.currentRect,this.previousRect,!0,r,h,n,o,a,d,p),r=a,h=s,d=this.previousRect.x,p=this.previousRect.y,this.checkSelectedCells(),this.getCellCollection(this.currentRect,this.previousRect,!1,r,h,n,o,a,d,p),this.selectedMultiCellCollection=[],this.canvasSelectedCells=new F(0,0,0,0),this.selectedCellCount=0},i.prototype.getCellCollection=function(e,t,i,l,a,n,s,o,r,h){for(var d=Math.abs(e.xIndex===t.xIndex?0:e.xIndex-t.xIndex)+1,p=Math.abs(e.yIndex===t.yIndex?0:e.yIndex-t.yIndex)+1,g=0;g<d*p;g++)i?this.getSelectedCellData(r,h,!0):this.getSelectedCellData(r,h,!1),l<n?(r+=e.xIndex>t.xIndex?e.width:-e.width,l++):a<s&&(h+=e.yIndex>t.yIndex?e.height:-e.height,r=t.x,l=o)},i.prototype.removeSelectedCellsBorder=function(){if(this.enableCanvasRendering){var e=this.secondaryCanvasRenderer.ctx;for(n=0;n<this.previousSelectedCellsRect.length;n++){var t=this.previousSelectedCellsRect[n];e.save(),e.clearRect(t.x-1,t.y-1,t.width+2,t.height+2),e.restore()}for(n=0;n<this.multiCellCollection.length;n++){var i=this.multiCellCollection[n];this.multiCellCollection.length>0&&(e.save(),e.clearRect(i.x-1,i.y-1,i.width+2,i.height+2))}}else for(var l=document.getElementById(this.element.id+"_Container_RectGroup"),a=document.getElementById(this.element.id+"_Container_TextGroup"),n=0;n<l.childNodes.length;n++){var s=l.childNodes[n].getAttribute("class");l.childNodes[n].setAttribute("opacity","0.3"),this.cellSettings.showLabel&&a.childNodes[n]&&(a.childNodes[n].setAttribute("opacity","0.3"),this.removeSvgClass(l.childNodes[n],s))}this.multiCellCollection=[]},i.prototype.highlightSelectedAreaInCanvas=function(e){if(e.x){var t=document.getElementById(this.element.id+"_canvas"),i=document.getElementById(this.element.id+"_secondary_canvas"),l=this.initialClipRect,a=t.getContext("2d").getImageData(e.x,e.y,e.width,e.height);i.getContext("2d").putImageData(a,e.x,e.y),t.style.opacity="0.3";var n=t.getContext("2d").getImageData(0,0,this.availableSize.width,l.y);i.getContext("2d").putImageData(n,0,0);var s=t.getContext("2d").getImageData(0,l.y+l.height,this.availableSize.width,this.availableSize.height-(l.y+l.height));i.getContext("2d").putImageData(s,0,l.y+l.height);var o=t.getContext("2d").getImageData(l.x+l.width,0,this.availableSize.width-(l.x+l.width),this.availableSize.height);i.getContext("2d").putImageData(o,l.x+l.width,0);var r=t.getContext("2d").getImageData(0,0,l.x,this.availableSize.height);i.getContext("2d").putImageData(r,0,0)}},i.prototype.getSelectedCellData=function(e,t,i){var l=this.axisCollections[0],a=this.axisCollections[1],n=l.tooltipLabels,s=a.tooltipLabels.slice().reverse(),o=this.heatMapSeries.getCurrentRect(e+1,t+1),r=document.getElementById(o.id),h=new E(null,"","",0,0,null,0,0,0,0,0,0);if(h.value=o.value,h.xLabel=n[o.xIndex].toString(),h.yLabel=s[o.yIndex].toString(),h.xValue=l.labelValue[o.xIndex],h.yValue=a.labelValue.slice().reverse()[o.yIndex],h.cellElement=this.enableCanvasRendering?null:r,h.xPosition=o.xIndex,h.yPosition=o.yIndex,h.width=this.currentRect.width,h.height=this.currentRect.height,h.x=this.currentRect.x,h.y=this.currentRect.y,this.currentRect.allowCollection=!0,this.addSvgClass(r),i)this.selectedMultiCellCollection.push(h),this.currentRect.allowCollection=!1;else for(var d=0;d<this.multiCellCollection.length;d++)if(this.multiCellCollection[d].xPosition===h.xPosition&&this.multiCellCollection[d].yPosition===h.yPosition&&(this.currentRect.allowCollection=!1,this.selectedCellCount===this.selectedMultiCellCollection.length)){if(this.currentRect.allowCollection=!1,this.enableCanvasRendering){var p=this.secondaryCanvasRenderer.ctx,g=this.canvasSelectedCells;p.save(),p.clearRect(g.x-1,g.y-1,g.width+2,g.height+2),p.restore(),this.selectedCellsRect=new F(0,0,0,0)}else for(var c=0;c<this.selectedMultiCellCollection.length;c++){var u=this.selectedMultiCellCollection[c].cellElement;if(u){var b=u.id.replace(this.element.id+"_HeatMapRect_",""),f=(document.getElementById(this.element.id+"_Container_TextGroup"),u.getAttribute("class"));u.setAttribute("opacity","0.3");var v=document.getElementById(this.element.id+"_HeatMapRectLabels_"+b);v&&v.setAttribute("opacity","0.3"),this.removeSvgClass(u,f)}}this.multiCellCollection.splice(d,1)}o.visible&&!sf.base.isNullOrUndefined(o.value)&&!0===this.currentRect.allowCollection&&this.multiCellCollection.push(h)},i.prototype.addSvgClass=function(e){if(!this.enableCanvasRendering){var t=this.element.id+"_selected";e.setAttribute("class",t)}},i.prototype.removeSvgClass=function(e,t){t&&e.setAttribute("class",t.replace(t,""))},i.prototype.clearSelection=function(){if(!this.enableCanvasRendering&&this.allowSelection&&this.clearSVGSelection(),this.enableCanvasRendering){for(var e=this.secondaryCanvasRenderer.ctx,t=0;t<this.previousSelectedCellsRect.length;t++)e.save(),e.clearRect(this.previousSelectedCellsRect[t].x-1,this.previousSelectedCellsRect[t].y-1,this.previousSelectedCellsRect[t].width+2,this.previousSelectedCellsRect[t].height+2),e.restore();for(t=0;t<this.multiCellCollection.length;t++){var i=this.multiCellCollection[t];this.multiCellCollection.length>0&&(e.save(),e.clearRect(i.x-1,i.y-1,i.width+2,i.height+2))}document.getElementById(this.element.id+"_canvas").style.opacity="1"}this.tempMultiCellCollection=[],this.multiCellCollection=[],this.rectSelected=!1},i.prototype.renderMousePointer=function(e,t){for(var i=this.legendModule.legendRange,l=this.legendModule.legendTextRange,a=!0,n=0;n<i.length;n++)this.legendSettings.toggleVisibility&&this.legendModule.currentPage===i[n].currentPage&&(a&&e>=i[n].x&&e<=i[n].width+i[n].x&&t>=i[n].y&&t<=i[n].y+i[n].height||this.legendSettings.showLabel&&"None"!==this.legendSettings.labelDisplayType&&e>=l[n].x&&e<=l[n].width+l[n].x&&t>=l[n].y&&t<=l[n].y+l[n].height?(this.enableCanvasRendering?document.getElementById(this.element.id+"_canvas").style.cursor="Pointer":document.getElementById(this.element.id+"_svg").style.cursor="Pointer",a=!1):a&&(this.enableCanvasRendering?document.getElementById(this.element.id+"_canvas").style.cursor="":document.getElementById(this.element.id+"_svg").style.cursor=""))},i.prototype.heatMapMouseLeave=function(e){var t=this;if(e.target&&e.target.id&&(this.cellSettings.enableCellHighlighting||this.tooltipModule&&this.showTooltip)&&!this.enableCanvasRendering&&this.heatMapSeries.highlightSvgRect(this.tempTooltipRectId),this.allowSelection&&this.multiSelection)if(this.multiSelection=!1,"mouseup"===e.type||"touchend"===e.type||"pointerup"===e.type){if(2!==e.which&&3!==e.which)if(!1===this.isCellTapHold){this.getDataCollection(),this.currentRect.allowCollection=!1,this.setCellOpacity();var i={heatmap:this.isBlazor?null:this,cancel:!1,name:"cellSelected",data:this.multiCellCollection};this.trigger("cellSelected",i)}else this.isCellTapHold=!1}else"mouseleave"===e.type&&(this.element.id,1)&&ne(this.element.id+"_selectedCells");if(this.tooltipModule&&this.showTooltip&&"mouseleave"===e.type&&this.tooltipModule.showHideTooltip(!1),this.tempTooltipRectId="",this.legendModule&&this.legendSettings.visible&&this.legendModule.tooltipObject&&this.legendModule.tooltipObject.element){var l=this.legendModule.tooltipObject.element.firstChild;"mouseleave"===e.type?l.setAttribute("opacity","0"):(this.legendTooltipTimer&&window.clearTimeout(this.legendTooltipTimer),this.legendTooltipTimer=setTimeout((function(){l.setAttribute("opacity","0")}),1500))}if("Gradient"===this.paletteSettings.type&&this.legendModule&&this.legendSettings.showGradientPointer&&this.legendSettings.visible&&this.legendVisibilityByCellType&&("mouseleave"===e.type?this.legendModule.removeGradientPointer():(this.gradientTimer&&window.clearTimeout(this.gradientTimer),this.gradientTimer=setTimeout((function(){t.legendModule.removeGradientPointer()}),1500))),this.enableCanvasRendering){var a=document.getElementById(this.element.id+"_hoverRect_canvas");a&&(a.style.visibility="hidden",this.tempRectHoverClass="")}return this.titleSettings.text&&-1!==this.titleCollection[0].indexOf("...")&&(this.enableCanvasRendering?ne(this.element.id+"_canvas_Tooltip"):ne(this.element.id+"_Title_Tooltip")),!0},i.prototype.checkSelectedCells=function(){if(this.enableCanvasRendering){this.canvasSelectedCells=new F(0,0,0,0),this.canvasSelectedCells.x=this.selectedCellsRect.x,this.canvasSelectedCells.y=this.selectedCellsRect.y,this.canvasSelectedCells.width=this.selectedCellsRect.width,this.canvasSelectedCells.height=this.selectedCellsRect.height;for(e=0;e<this.multiCellCollection.length;e++)for(t=0;t<this.selectedMultiCellCollection.length;t++)this.selectedMultiCellCollection[t].xPosition===this.multiCellCollection[e].xPosition&&this.selectedMultiCellCollection[t].yPosition===this.multiCellCollection[e].yPosition&&this.selectedCellCount++;this.rectSelected&&"Gradient"===this.paletteSettings.type&&this.legendModule.removeGradientPointer()}else for(var e=0;e<this.multiCellCollection.length;e++)for(var t=0;t<this.selectedMultiCellCollection.length;t++)this.selectedMultiCellCollection[t].cellElement.getAttribute("id")===this.multiCellCollection[e].cellElement.getAttribute("id")&&this.selectedCellCount++},i.prototype.removeOpacity=function(e,t){for(var i=0;i<e.childNodes.length;i++)e.childNodes[i].setAttribute("opacity","0.3"),this.cellSettings.showLabel&&t.childNodes[i]&&t.childNodes[i].setAttribute("opacity","0.3")},i.prototype.setCellOpacity=function(){if(this.enableCanvasRendering)this.previousSelectedCellsRect.push(this.selectedCellsRect),this.highlightSelectedAreaInCanvas(this.selectedCellsRect);else if(0!==this.multiCellCollection.length){this.tempMultiCellCollection.push(this.multiCellCollection);var e=document.getElementById(this.element.id+"_Container_RectGroup"),t=document.getElementById(this.element.id+"_Container_TextGroup");this.removeOpacity(e,t);for(var i=0;i<this.multiCellCollection.length;i++){var l=this.multiCellCollection[i].cellElement,a=parseInt(l.id.replace(this.element.id+"_HeatMapRect_",""),10);if(e.childNodes[a].setAttribute("opacity","1"),this.cellSettings.showLabel){var n=document.getElementById(this.element.id+"_HeatMapRectLabels_"+a);n&&n.setAttribute("opacity","1")}}}ne(this.element.id+"_selectedCells")},i.prototype.createMultiCellDiv=function(e){if(e){var t=this.createElement("div",{id:this.element.id+"_Multi_CellSelection_Canvas",styles:"position:relative"});this.element.appendChild(t),t.appendChild(this.svgObject),this.svgObject.style.position="absolute",this.svgObject.style.left="0px",this.svgObject.style.top="0px",this.svgObject.style.zIndex="0"}else{var i=document.getElementById(this.element.id+"_Multi_CellSelection_Canvas"),l=this.secondaryCanvasRenderer.createCanvas({width:this.availableSize.width,height:this.availableSize.height,x:0,y:0,style:"position: absolute; z-index: 1"});i.appendChild(l)}},$e([sf.base.Property(null)],i.prototype,"width",void 0),$e([sf.base.Property(null)],i.prototype,"height",void 0),$e([sf.base.Property(!0)],i.prototype,"showTooltip",void 0),$e([sf.base.Event()],i.prototype,"tooltipRender",void 0),$e([sf.base.Event()],i.prototype,"resized",void 0),$e([sf.base.Event()],i.prototype,"loaded",void 0),$e([sf.base.Event()],i.prototype,"cellRender",void 0),$e([sf.base.Event()],i.prototype,"cellSelected",void 0),$e([sf.base.Property("SVG")],i.prototype,"renderingMode",void 0),$e([sf.base.Property(null)],i.prototype,"dataSource",void 0),$e([sf.base.Complex({},Ue)],i.prototype,"dataSourceSettings",void 0),$e([sf.base.Property("Material")],i.prototype,"theme",void 0),$e([sf.base.Property(!1)],i.prototype,"allowSelection",void 0),$e([sf.base.Complex({},h)],i.prototype,"margin",void 0),$e([sf.base.Complex({text:"",textStyle:t.heatMapTitleFont},c)],i.prototype,"titleSettings",void 0),$e([sf.base.Complex({},ze)],i.prototype,"xAxis",void 0),$e([sf.base.Complex({},je)],i.prototype,"legendSettings",void 0),$e([sf.base.Complex({},R)],i.prototype,"paletteSettings",void 0),$e([sf.base.Complex({},Ne)],i.prototype,"tooltipSettings",void 0),$e([sf.base.Complex({},ze)],i.prototype,"yAxis",void 0),$e([sf.base.Complex({},De)],i.prototype,"cellSettings",void 0),$e([sf.base.Event()],i.prototype,"created",void 0),$e([sf.base.Event()],i.prototype,"load",void 0),$e([sf.base.Event()],i.prototype,"cellClick",void 0),$e([sf.base.Event()],i.prototype,"legendRender",void 0),i=$e([sf.base.NotifyPropertyChanges],i)}(sf.base.Component);return Ke.Inject(ke,Ee,Je),e.HeatMap=Ke,e.Axis=ze,e.AxisHelper=Ve,e.Data=Ue,e.AdaptiveMinMax=Xe,e.Adaptor=Je,e.TwoDimensional=Ge,e.LegendSettings=je,e.Legend=ke,e.Font=r,e.Margin=h,e.Border=d,e.TooltipBorder=p,e.BubbleData=g,e.Title=c,e.FillColor=u,e.PaletteCollection=b,e.AxisLabelBorder=f,e.BubbleSize=v,e.MultiLevelCategories=y,e.MultiLevelLabels=m,e.ColorCollection=x,e.BubbleTooltipData=C,e.LegendColorCollection=S,e.MultipleRow=M,e.CellSettings=De,e.Series=_e,e.PaletteSettings=R,e.RgbColor=T,e.CellColor=P,e.TooltipSettings=Ne,e.Tooltip=Ee,e.ExportUtils=Ze,e.stringToNumber=V,e.measureText=O,e.TextElement=A,e.titlePositionX=D,e.Size=_,e.CustomizeOption=I,e.PathOption=B,e.CurrentRect=N,e.SelectedCellDetails=E,e.RectOption=G,e.CircleOption=H,e.Rect=F,e.TextOption=j,e.TextBasic=k,e.Line=W,e.LineOption=Y,e.PathAttributes=U,e.Path=X,e.sum=J,e.titlePositionY=Z,e.rotateTextSize=q,e.DrawSvgCanvas=$,e.getTitle=K,e.textWrap=Q,e.textTrim=ee,e.textNone=te,e.Gradient=ie,e.GradientColor=le,e.showTooltip=ae,e.removeElement=ne,e.getElement=se,e.increaseDateTimeInterval=oe,e.CanvasTooltip=re,e.getTooltipText=he,e.PaletterColor=de,e.GradientPointer=pe,e.CurrentLegendRect=ge,e.LegendRange=ce,e.ToggleVisibility=ue,e.colorNameToHex=be,e.convertToHexCode=fe,e.componentToHex=ve,e.convertHexToColor=ye,e.formatValue=me,e.MultiLevelPosition=Re,e}({}))}});