!function(e){var t={};function i(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(r,a,function(t){return e[t]}.bind(null,a));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="_content/Syncfusion.Blazor/scripts/",i(i.s="./bundles/gantt.js")}({"./bundles/gantt.js":function(e,t,i){"use strict";i.r(t);i("./modules/gantt.js")},"./modules/gantt.js":function(e,t){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}window.sf=window.sf||{};sf.gantt=sf.base.extend({},sf.gantt,function(e){"use strict";function t(e,t,i){for(var r=e;r&&!(i?r.id===t:r.classList.contains(t));)r=r.parentElement;return r}function r(e){return sf.base.isNullOrUndefined(e.startDate)&&sf.base.isNullOrUndefined(e.endDate)&&sf.base.isNullOrUndefined(e.duration)?null:!(sf.base.isNullOrUndefined(e.startDate)||sf.base.isNullOrUndefined(e.endDate)||sf.base.isNullOrUndefined(e.duration))}function a(e){for(var t={},i=0,r=Object.keys(e);i<r.length;i++){var a=r[i];t[e[a]]=a}return t}function s(e){if(e instanceof sf.data.DataManager){var t=e.adaptor;return t instanceof sf.data.ODataAdaptor||t instanceof sf.data.ODataV4Adaptor||t instanceof sf.data.WebApiAdaptor||t instanceof sf.data.WebMethodAdaptor||t instanceof sf.data.CacheAdaptor||t instanceof sf.data.RemoteSaveAdaptor||t instanceof sf.data.JsonAdaptor||t instanceof sf.data.UrlAdaptor}return!1}function n(e,t){for(var i=[],r=0;r<e.length;r++){var a;a=t?e[r].taskData:sf.base.extend({},e[r].taskData,{},!0),i.push(a)}return i}function o(e,t){for(var i,r=0;r<t.length;r++)i=new RegExp("\\{"+r+"\\}","gm"),e=e.replace(i,t[r].toString());return e}function d(e,t,i,r){for(var a=-1,s=0;s<i.length;s++)if(sf.base.getValue(t,i[s])===sf.base.getValue(t,e)&&sf.base.isNullOrUndefined(r)||!sf.base.isNullOrUndefined(r)&&sf.base.getValue(t,i[s])===sf.base.getValue(t,e)&&sf.base.getValue(r,i[s])===sf.base.getValue(r,e)){a=s;break}return a}function l(e){return 76*e/92}function p(e){return 92*e/76}var h=0;function c(){return h++}var u,f,g,m,y,b,v,D,w,k,T,S,P,C,x,R,M,O,I,E,F=function(){function e(e){this.parent=e}return e.prototype.isValidateNonWorkDays=function(e){return!sf.base.isNullOrUndefined(e)&&e.isAutoSchedule&&(!this.parent.includeWeekend||this.parent.totalHolidayDates.length>0)||sf.base.isNullOrUndefined(e)&&(!this.parent.includeWeekend||this.parent.totalHolidayDates.length>0)},e.prototype.checkStartDate=function(e,t,i,r){if(sf.base.isNullOrUndefined(e))return null;var a,s=new Date(e.getTime()),n=this.getSecondsInDecimal(s);if(i=sf.base.isNullOrUndefined(i)?!sf.base.isNullOrUndefined(t)&&t.isMilestone:i,n<this.parent.defaultStartTime&&(!i||r))this.setTime(this.parent.defaultStartTime,s);else if(n<this.parent.defaultStartTime&&i)this.setTime(this.parent.defaultEndTime,s);else if(n===this.parent.defaultEndTime&&(!t||!i)||n>this.parent.defaultEndTime)s.setDate(s.getDate()+1),this.setTime(this.parent.defaultStartTime,s);else if(n>this.parent.defaultStartTime&&n<this.parent.defaultEndTime)for(var o=0;o<this.parent.workingTimeRanges.length;o++){var d=this.parent.workingTimeRanges[o];if(n>=d.to&&this.parent.workingTimeRanges[o+1]&&n<this.parent.workingTimeRanges[o+1].from){(n!==d.to||t&&i)&&n===d.to||this.setTime(this.parent.workingTimeRanges[o+1].from,s);break}}do{a=new Date(s.getTime());var l=this.parent.totalHolidayDates.length;if(this.isValidateNonWorkDays(t)){var p=!i||r?this.parent.defaultStartTime:this.parent.defaultEndTime;if(!this.parent.includeWeekend){var h=new Date(s.getTime());s=this.getNextWorkingDay(s),h.getTime()!==s.getTime()&&this.setTime(p,s)}for(var c=0;c<l;c++){var u=this.getDateFromFormat(new Date(this.parent.totalHolidayDates[c])),f=new Date(u.getTime());u.setHours(0,0,0,0),f.setHours(23,59,59,59),s.getTime()>=u.getTime()&&s.getTime()<f.getTime()&&(s.setDate(s.getDate()+1),this.setTime(p,s))}}}while(a.getTime()!==s.getTime());return new Date(s.getTime())},e.prototype.checkEndDate=function(e,t,i){if(sf.base.isNullOrUndefined(e))return null;var r,a=new Date(e.getTime()),s=this.getSecondsInDecimal(a);if(s>this.parent.defaultEndTime)this.setTime(this.parent.defaultEndTime,a);else if(s<=this.parent.defaultStartTime&&!i)a.setDate(a.getDate()-1),this.setTime(this.parent.defaultEndTime,a);else if(s>this.parent.defaultStartTime&&s<this.parent.defaultEndTime)for(var n=0;n<this.parent.workingTimeRanges.length;n++){if(s>this.parent.workingTimeRanges[n].to&&this.parent.workingTimeRanges[n+1]&&s<=this.parent.workingTimeRanges[n+1].from){this.setTime(this.parent.workingTimeRanges[n].to,a);break}}do{r=new Date(a.getTime());var o=this.parent.totalHolidayDates.length;if(this.isValidateNonWorkDays(t)){if(!this.parent.includeWeekend){var d=new Date(a.getTime());a=this.getPreviousWorkingDay(a),d.getTime()!==a.getTime()&&this.setTime(this.parent.defaultEndTime,a)}for(var l=0;l<o;l++){var p=this.getDateFromFormat(new Date(this.parent.totalHolidayDates[l])),h=new Date(p.getTime()),c=new Date(a.getTime());c.setMinutes(a.getMilliseconds()-2),p.setHours(0,0,0,0),h.setHours(23,59,59,59),(a.getTime()>=p.getTime()&&a.getTime()<h.getTime()||c.getTime()>=p.getTime()&&c.getTime()<h.getTime())&&(a.setDate(a.getDate()-1),a.getTime()===p.getTime()&&86400===this.parent.defaultEndTime&&0===this.getSecondsInDecimal(a)||this.setTime(this.parent.defaultEndTime,a))}}}while(r.getTime()!==a.getTime());return new Date(a.getTime())},e.prototype.checkBaselineStartDate=function(e){if(sf.base.isNullOrUndefined(e))return null;var t=new Date(e.getTime()),i=this.getSecondsInDecimal(t);if(i<this.parent.defaultStartTime)this.setTime(this.parent.defaultStartTime,t);else if(i>=this.parent.defaultEndTime)t.setDate(t.getDate()+1),this.setTime(this.parent.defaultStartTime,t);else if(i>this.parent.defaultStartTime&&i<this.parent.defaultEndTime)for(var r=0;r<this.parent.workingTimeRanges.length;r++){if(i>=this.parent.workingTimeRanges[r].to&&this.parent.workingTimeRanges[r+1]&&i<this.parent.workingTimeRanges[r+1].from){this.setTime(this.parent.workingTimeRanges[r+1].from,t);break}}return t},e.prototype.checkBaselineEndDate=function(e){if(sf.base.isNullOrUndefined(e))return null;var t=new Date(e.getTime()),i=this.getSecondsInDecimal(t);if(i>this.parent.defaultEndTime)this.setTime(this.parent.defaultEndTime,t);else if(i<=this.parent.defaultStartTime)t.setDate(t.getDate()-1),this.setTime(this.parent.defaultEndTime,t);else if(i>this.parent.defaultStartTime&&i<this.parent.defaultEndTime)for(var r=0;r<this.parent.workingTimeRanges.length;r++){if(i>this.parent.workingTimeRanges[r].to&&this.parent.workingTimeRanges[r+1]&&i<=this.parent.workingTimeRanges[r+1].from){this.setTime(this.parent.workingTimeRanges[r].to,t);break}}return t},e.prototype.calculateStartDate=function(e){var t=e.ganttProperties,i=null;sf.base.isNullOrUndefined(t.endDate)||sf.base.isNullOrUndefined(t.duration)||(i=this.getStartDate(t.endDate,t.duration,t.durationUnit,t)),this.parent.setRecordValue("startDate",i,t,!0),this.parent.taskFields.startDate&&this.parent.dataOperation.updateMappingData(e,"startDate")},e.prototype.calculateEndDate=function(e){var t=e.ganttProperties,i=null;if(!sf.base.isNullOrUndefined(t.startDate)){if(!sf.base.isNullOrUndefined(t.endDate)&&sf.base.isNullOrUndefined(t.duration)&&(1===this.compareDates(t.startDate,t.endDate)&&(this.parent.setRecordValue("startDate",new Date(t.endDate.getTime()),t,!0),this.setTime(this.parent.defaultStartTime,t.startDate)),this.calculateDuration(e)),!sf.base.isNullOrUndefined(t.duration)){var r=!sf.base.isNullOrUndefined(t.segments)&&t.segments.length>0?this.totalDuration(t.segments):t.duration;i=this.getEndDate(t.startDate,r,t.durationUnit,t,!1)}this.parent.setRecordValue("endDate",i,t,!0)}this.parent.taskFields.endDate&&this.parent.dataOperation.updateMappingData(e,"endDate")},e.prototype.totalDuration=function(e){for(var t=0,i=0;i<e.length;i++)t+=e[i].duration+e[i].offsetDuration;return t},e.prototype.calculateDuration=function(e){var t,i=e.ganttProperties;t=!sf.base.isNullOrUndefined(i.segments)&&i.segments.length>0?this.parent.editModule.taskbarEditModule.sumOfDuration(i.segments):this.getDuration(i.startDate,i.endDate,i.durationUnit,i.isAutoSchedule,i.isMilestone),this.parent.setRecordValue("duration",t,i,!0);var r=this.parent.columnByField[this.parent.columnMapping.duration];if(!(sf.base.isNullOrUndefined(this.parent.editModule)||sf.base.isNullOrUndefined(this.parent.editModule.cellEditModule)||this.parent.editModule.cellEditModule.isCellEdit||sf.base.isNullOrUndefined(r))){if(!sf.base.isNullOrUndefined(r.edit)&&!sf.base.isNullOrUndefined(r.edit.read)){var a=this.parent.editModule.dialogModule.dialog;if(!sf.base.isNullOrUndefined(a)){var s=a.querySelector("#"+this.parent.element.id+"Duration").ej2_instances[0];sf.base.isNullOrUndefined(s)||s.value===t.toString()||(s.value=t.toString(),s.dataBind())}}this.parent.taskFields.duration&&(this.parent.dataOperation.updateMappingData(e,"duration"),this.parent.taskFields.durationUnit&&this.parent.dataOperation.updateMappingData(e,"durationUnit"))}},e.prototype.getNonworkingTime=function(e,t,i,r){r=!!sf.base.isNullOrUndefined(r)||r;var a=!this.parent.includeWeekend&&i?this.getWeekendCount(e,t):0,s=this.getNumberOfSeconds(e,t,r),n=i?this.getHolidaysCount(e,t):0,o=(s-86400*a-86400*n)/86400,d=this.getNonWorkingSecondsOnDate(e,t,i);return o*(86400-this.parent.secondsPerDay)+86400*a+86400*n+d},e.prototype.getDuration=function(e,t,i,r,a,s){if(sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(t))return null;s=!!sf.base.isNullOrUndefined(s)||s;var n=0,o=this.getTimeDifference(e,t,s)/1e3-this.getNonworkingTime(e,t,r,s);return n=a&&this.parent.getFormatedDate(e)===this.parent.getFormatedDate(t)?0:i&&"day"!==i?"minute"===i?o/60:o/3600:o/this.parent.secondsPerDay,parseFloat(n.toString())},e.prototype.getDurationAsSeconds=function(e,t){return t&&"day"!==t?"hour"===t?3600*e:60*e:this.parent.secondsPerDay*e},e.prototype.getEndDate=function(e,t,i,r,a){for(var s=new Date(e.getTime()),n=new Date(e.getTime()),o=this.getDurationAsSeconds(t,i);o>0;)n.setSeconds(n.getSeconds()+o),(o-=o-this.getNonworkingTime(s,n,r.isAutoSchedule,!0))>0&&(n=this.checkStartDate(n,r,a)),s=new Date(n.getTime());return n},e.prototype.getStartDate=function(e,t,i,r){for(var a=new Date(e.getTime()),s=new Date(e.getTime()),n=this.getDurationAsSeconds(t,i);n>0;)s.setSeconds(s.getSeconds()-n),(n-=n-this.getNonworkingTime(s,a,r.isAutoSchedule,!0))>0&&(a=this.checkEndDate(s,r)),a=new Date(s.getTime());return s},e.prototype.getProjectStartDate=function(e,t){if(!sf.base.isNullOrUndefined(this.parent.cloneProjectStartDate)){var i=this.checkStartDate(this.parent.cloneProjectStartDate);return this.parent.cloneProjectStartDate=i,new Date(i.getTime())}if(sf.base.isNullOrUndefined(this.parent.projectStartDate)){if(sf.base.isNullOrUndefined(t))return null;var r=this.parent.flatData,a=void 0;r.length>0?a=r[0].ganttProperties.startDate:(a=new Date).setHours(0,0,0,0);for(var s=1;s<r.length;s++){var n=r[s].ganttProperties.startDate;sf.base.isNullOrUndefined(n)||-1!==this.compareDates(n,a)||(a=n)}this.parent.cloneProjectStartDate=this.checkStartDate(a,e)}else{i=this.getDateFromFormat(this.parent.projectStartDate);this.parent.cloneProjectStartDate=this.checkStartDate(i)}return new Date(this.parent.cloneProjectStartDate.getTime())},e.prototype.getValidStartDate=function(e,t){var i=null,r=t?e.autoStartDate:e.startDate,a=t?e.autoEndDate:e.endDate,s=!e.isAutoSchedule&&e.autoDuration?e.autoDuration:e.duration;return sf.base.isNullOrUndefined(r)?sf.base.isNullOrUndefined(a)?sf.base.isNullOrUndefined(s)||(i=this.getProjectStartDate(e)):(i=new Date(a.getTime()),this.setTime(this.parent.defaultStartTime,i)):i=new Date(r.getTime()),i},e.prototype.getValidEndDate=function(e,t){var i=null,r=t?e.autoStartDate:e.startDate,a=t?e.autoEndDate:e.endDate,s=t?e.autoDuration:e.duration;if(sf.base.isNullOrUndefined(a))if(sf.base.isNullOrUndefined(r)){if(!sf.base.isNullOrUndefined(s)){var n=this.getValidStartDate(e);n&&(i=this.getEndDate(n,s,e.durationUnit,e,!1))}}else e.isMilestone?i=this.checkStartDate(r):(i=new Date(r.getTime()),this.setTime(this.parent.defaultEndTime,i));else i=new Date(a.getTime());return i},e.prototype.getSecondsPerDay=function(){var e=this.parent.dayWorkingTime,t=e.length,i=0,r=new Date("10/11/2018");this.parent.nonWorkingHours=[];var a=this.parent.nonWorkingHours;this.parent.workingTimeRanges=[];var s=this.parent.workingTimeRanges;this.parent.nonWorkingTimeRanges=[];for(var n=this.parent.nonWorkingTimeRanges,o=0;o<t;o++){var d=e[o];if(!sf.base.isNullOrUndefined(d.from)&&!sf.base.isNullOrUndefined(d.to)){r.setHours(0,0,0,0);var l=new Date(r.getTime());r.setTime(r.getTime()+36e5*d.from);var p=new Date(r.getTime());l.setTime(l.getTime()+36e5*d.to);var h=new Date(l.getTime()),c=h.getTime()-p.getTime(),u=this.getSecondsInDecimal(p),f=this.getSecondsInDecimal(h);0===f&&(f=86400),i+=c/1e3,0===o&&(this.parent.defaultStartTime=u),o===t-1&&(this.parent.defaultEndTime=f),o>0?(a.push(a[a.length-1]+u-s[o-1].to),s[o-1].to<u&&n.push({from:s[o-1].to,to:u,isWorking:!1,interval:u-s[o-1].to})):(a.push(0),n.push({from:0,to:u,isWorking:!1,interval:u})),s.push({from:u,to:f}),n.push({from:u,to:f,isWorking:!0,interval:f-u})}}return this.parent.defaultEndTime/3600!=24&&n.push({from:this.parent.defaultEndTime,to:86400,isWorking:!1,interval:86400-this.parent.defaultEndTime}),i},e.prototype.getDurationValue=function(e,t){var i=null,r=null;if("string"==typeof e){var a=e.match(/(\d*\.*\d+|.+$)/g);if(a&&a.length<=2){r=parseFloat(a[0].toString().trim());var s=a[1]?a[1].toString().trim().toLowerCase():null;-1!==sf.base.getValue("minute",this.parent.durationUnitEditText).indexOf(s)?i="minute":-1!==sf.base.getValue("hour",this.parent.durationUnitEditText).indexOf(s)?i="hour":-1!==sf.base.getValue("day",this.parent.durationUnitEditText).indexOf(s)&&(i="day")}}else r=e,i=null;return{duration:r,durationUnit:i}},e.prototype.getNextWorkingDay=function(e){var t=e.getDay();return-1!==this.parent.nonWorkingDayIndex.indexOf(t)?(e.setDate(e.getDate()+1),e=this.getNextWorkingDay(e)):e},e.prototype.getWeekendCount=function(e,t){var i=0,r=new Date(e.getTime()),a=new Date(t.getTime());for(r.setHours(0,0,0,0),r.setDate(r.getDate()+1),a.setHours(0,0,0,0);r.getTime()<a.getTime();)-1!==this.parent.nonWorkingDayIndex.indexOf(r.getDay())&&(i+=1),r.setDate(r.getDate()+1);return i},e.prototype.getNumberOfSeconds=function(e,t,i){var r=new Date(e.getTime()),a=new Date(t.getTime()),s=0;return r.setDate(r.getDate()+1),r.setHours(0,0,0,0),a.setHours(0,0,0,0),r.getTime()<a.getTime()&&(s=this.getTimeDifference(r,a,i)/1e3),s%86400!=0&&(s=s-s%86400+86400),s},e.prototype.getHolidaysCount=function(e,t){var i=0,r=this.parent.totalHolidayDates,a=new Date(e.getTime()),s=new Date(t.getTime());if(a.setDate(a.getDate()+1),a.setHours(0,0,0,0),s.setHours(0,0,0,0),a.getTime()<s.getTime())for(var n=0;n<r.length;n++){var o=this.getDateFromFormat(new Date(r[n]));a.getTime()<=o.getTime()&&s.getTime()>o.getTime()&&(!this.parent.includeWeekend&&-1===this.parent.nonWorkingDayIndex.indexOf(o.getDay())||this.parent.includeWeekend)&&(i+=1)}return i},e.prototype.getHolidayDates=function(){for(var e=this.parent.holidays,t=[],i=0;i<e.length;i++){var r=this.getDateFromFormat(e[i].from),a=this.getDateFromFormat(e[i].to);if(!sf.base.isNullOrUndefined(r)||!sf.base.isNullOrUndefined(a))if(sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(a)){var s=r||a;s.setHours(0,0,0,0),-1===t.indexOf(s.getTime())&&t.push(s.getTime())}else for(;r<=a;)r.setHours(0,0,0,0),-1===t.indexOf(r.getTime())&&t.push(r.getTime()),r.setDate(r.getDate()+1)}return t},e.prototype.isOnHolidayOrWeekEnd=function(e,t){if(!(t=sf.base.isNullOrUndefined(t)?this.parent.includeWeekend:t)&&-1!==this.parent.nonWorkingDayIndex.indexOf(e.getDay()))return!0;for(var i=this.parent.totalHolidayDates,r=0;r<i.length;r++){var a=this.getDateFromFormat(new Date(i[r])),s=new Date(a.getTime());if(a.setHours(0,0,0,0),s.setHours(23,59,59,59),e.getTime()>=a.getTime()&&e.getTime()<s.getTime())return!0}return!1},e.prototype.getNonWorkingSecondsOnDate=function(e,t,i){for(var r=this.getSecondsInDecimal(e),a=this.getSecondsInDecimal(t),s=-1,n=-1,o=0,d=!!i&&this.isOnHolidayOrWeekEnd(e,null),l=!!i&&this.isOnHolidayOrWeekEnd(t,null),p=0;p<this.parent.nonWorkingTimeRanges.length;p++){var h=this.parent.nonWorkingTimeRanges[p];r>=h.from&&r<=h.to&&(s=p),a>=h.from&&a<=h.to&&(n=p)}if(e.getDate()!==t.getDate()||e.getMonth()!==t.getMonth()||e.getFullYear()!==t.getFullYear()){if(d)o+=86400-r;else for(p=s;p<this.parent.nonWorkingTimeRanges.length;p++)this.parent.nonWorkingTimeRanges[p].isWorking||(o+=p===s?this.parent.nonWorkingTimeRanges[p].to-r:this.parent.nonWorkingTimeRanges[p].interval);if(l)o+=a;else for(p=0;p<=n;p++)this.parent.nonWorkingTimeRanges[p].isWorking||(o+=p===n?a-this.parent.nonWorkingTimeRanges[p].from:this.parent.nonWorkingTimeRanges[p].interval)}else{if(s!==n)if(l)o+=a-r;else for(p=s;p<=n;p++)this.parent.nonWorkingTimeRanges[p].isWorking||(o+=p===s?this.parent.nonWorkingTimeRanges[p].to-r:p===n?a-this.parent.nonWorkingTimeRanges[p].from:this.parent.nonWorkingTimeRanges[p].interval);else if(l)o+=a-r;else this.parent.nonWorkingTimeRanges[s].isWorking||(o=a-r)}return o},e.prototype.getPreviousWorkingDay=function(e){var t=e.getDay(),i=0===t?6:t-1;return-1!==this.parent.nonWorkingDayIndex.indexOf(t)||-1!==this.parent.nonWorkingDayIndex.indexOf(i)&&86400===this.parent.defaultEndTime&&0===this.getSecondsInDecimal(e)?(e.setDate(e.getDate()-1),-1!==this.parent.nonWorkingDayIndex.indexOf(e.getDay())&&(e=this.getPreviousWorkingDay(e)),e):e},e.prototype.getNonWorkingDayIndex=function(){var e=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],t=e.length;0===this.parent.workWeek.length&&(this.parent.workWeek=["Monday","Tuesday","Wednesday","Thursday","Friday"]);for(var i=this.parent.workWeek.slice(),r=i.length,a=0;a<r;a++)i[a]=i[a].toLowerCase();this.parent.nonWorkingDayIndex=[];for(a=0;a<t;a++)-1===i.indexOf(e[a])&&this.parent.nonWorkingDayIndex.push(a)},e.prototype.setTime=function(e,t){var i=e/3600,r=(e-3600*(i=parseInt(i,10)))/60,a=e-3600*i-60*(r=parseInt(r,10));t.setHours(i,r,a)},e.prototype.getTimeDifference=function(e,t,i){var r=new Date(e.getTime()),a=new Date(t.getTime());return i&&this.updateDateWithTimeZone(r,a),a.getTime()-r.getTime()},e.prototype.updateDateWithTimeZone=function(e,t){var i,r,a=e.getTimezoneOffset(),s=t.getTimezoneOffset();if(a!==s){var n=new Date((new Date).getFullYear(),0,1).getTimezoneOffset();if(n!==a?(r=e,i=a):n!==s&&(r=t,i=s),n<0){var o=n-i;r.setTime(r.getTime()+60*o*1e3)}else if(n>0){o=i-n;r.setTime(r.getTime()-60*o*1e3)}}},e.prototype.getSecondsInDecimal=function(e){return 60*e.getHours()*60+60*e.getMinutes()+e.getSeconds()+e.getMilliseconds()/1e3},e.prototype.offset=function(e,t,i){var r=new Date(e.toLocaleString("en-US",{timeZone:i}));return isNaN(r.getTime())?0:(e.getTime()-r.getTime())/6e4+t},e.prototype.convert=function(e,t){var i=e.getTimezoneOffset(),r=this.offset(e,i,t),a=(e=new Date(e.getTime()+6e4*(i-r))).getTimezoneOffset();return new Date(e.getTime()+6e4*(a-i))},e.prototype.getDateFromFormat=function(e,t){var i;if(sf.base.isNullOrUndefined(e))return null;if(e instanceof Date)i=new Date(e.getTime());else{var r=this.parent.globalize.parseDate(e,{format:this.parent.getDateFormat(),type:"dateTime"});i=sf.base.isNullOrUndefined(r)&&!isNaN(new Date(e).getTime())?new Date(e):r}return!sf.base.isNullOrUndefined(this.parent.timezone)&&t?this.convert(i,this.parent.timezone):i},e.prototype.compareDates=function(e,t){return sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(t)?!sf.base.isNullOrUndefined(e)&&sf.base.isNullOrUndefined(t)?1:sf.base.isNullOrUndefined(e)&&!sf.base.isNullOrUndefined(t)?-1:null:e.getTime()>t.getTime()?1:e.getTime()<t.getTime()?-1:0},e.prototype.getDurationString=function(e,t){var i="";if(!sf.base.isNullOrUndefined(e)&&(i+=parseFloat(e.toFixed(2))+" ",!sf.base.isNullOrUndefined(t))){var r=1!==e;"day"===t?i+=r?this.parent.localeObj.getConstant("days"):this.parent.localeObj.getConstant("day"):"hour"===t?i+=r?this.parent.localeObj.getConstant("hours"):this.parent.localeObj.getConstant("hour"):"minute"===t&&(i+=r?this.parent.localeObj.getConstant("minutes"):this.parent.localeObj.getConstant("minute"))}return i},e.prototype.getWorkString=function(e,t){var i="";if(!sf.base.isNullOrUndefined(e)&&(i+=parseFloat(e).toFixed(2)+" ",!sf.base.isNullOrUndefined(t))){var r=1!==e;"day"===t?i+=r?this.parent.localeObj.getConstant("days"):this.parent.localeObj.getConstant("day"):"hour"===t?i+=r?this.parent.localeObj.getConstant("hours"):this.parent.localeObj.getConstant("hour"):"minute"===t&&(i+=r?this.parent.localeObj.getConstant("minutes"):this.parent.localeObj.getConstant("minute"))}return i},e.prototype.calculateProjectDatesForValidatedTasks=function(e){var t=this,i="string"==typeof this.parent.projectStartDate?new Date(this.parent.projectStartDate):this.parent.projectStartDate,r="string"==typeof this.parent.projectEndDate?new Date(this.parent.projectEndDate):this.parent.projectEndDate,a=null,s=null,n=sf.base.getValue("dataOperation.dataArray",this.parent);if(i&&r||!n||0!==n.length){if(n.length>0){var o=n.slice().sort((function(e,i){return new Date(e[t.parent.taskFields.startDate]).getTime()-new Date(i[t.parent.taskFields.startDate]).getTime()})),d=n.slice().sort((function(e,i){return new Date(i[t.parent.taskFields.endDate]).getTime()-new Date(e[t.parent.taskFields.endDate]).getTime()}));a=o[0][this.parent.taskFields.startDate],s=d[d.length-1][this.parent.taskFields.endDate]}}else a=this.getDateFromFormat(new Date),s=this.getDateFromFormat(new Date(a.getTime()));this.parent.cloneProjectStartDate=i?new Date(i.getTime()):"string"==typeof a?new Date(a):a,this.parent.cloneProjectEndDate=r?new Date(r.getTime()):"string"==typeof s?new Date(s):s},e.prototype.calculateProjectDates=function(e){var t=this,i="string"==typeof this.parent.projectStartDate?new Date(this.parent.projectStartDate):this.parent.projectStartDate,r="string"==typeof this.parent.projectEndDate?new Date(this.parent.projectEndDate):this.parent.projectEndDate,a=this.parent.timelineModule.isZooming&&this.parent.cloneProjectStartDate?this.getDateFromFormat(this.parent.cloneProjectStartDate):this.getDateFromFormat(i),s=this.parent.timelineModule.isZooming&&this.parent.cloneProjectEndDate?this.getDateFromFormat(this.parent.cloneProjectEndDate):this.getDateFromFormat(r),n=null,o=null,d=this.parent.flatData,l=this.parent.currentViewData,p=[],h=function(e){sf.base.isNullOrUndefined(e)||p.push(e)},c=function(e){e.length>0&&(e.sort((function(e,t){return e.getTime()-t.getTime()})),n=new Date(e[0].getTime()),o=e.length>1?new Date(e[e.length-1].getTime()):null)};if((!a||!s)&&d.length>0||e||this.parent.timelineModule.isZoomToFit){if((l.length>0&&this.parent.timelineModule.isZoomToFit&&this.parent.treeGrid.filterModule&&this.parent.treeGrid.filterModule.filteredResult.length>0?l:d).forEach((function(e,i){p=[];var r=e.ganttProperties,a=t.getValidStartDate(r),s=t.getValidEndDate(r);h(n),h(o),h(a),h(s),t.parent.renderBaseline&&!t.parent.timelineModule.isZoomToFit&&(h(r.baselineStartDate),h(r.baselineEndDate)),r.indicators&&r.indicators.length>0&&!t.parent.timelineModule.isZoomToFit&&r.indicators.forEach((function(e){h(t.getDateFromFormat(e.date))})),c(p)})),p=[],h(n),h(o),this.parent.eventMarkers.length>0&&!this.parent.timelineModule.isZoomToFit)this.parent.eventMarkers.forEach((function(e,i){h(t.getDateFromFormat(e.day))}));if(this.parent.totalHolidayDates.length>0&&!this.parent.timelineModule.isZoomToFit)this.parent.totalHolidayDates.forEach((function(e,t){h(new Date(e))}));c(p),n&&o||(n=sf.base.isNullOrUndefined(n)?this.getDateFromFormat(new Date):n,(o=this.getDateFromFormat(new Date(n.getTime()))).setDate(o.getDate()+20))}else a&&s||0!==d.length||(n=this.getDateFromFormat(new Date),o=this.getDateFromFormat(new Date(n.getTime())));e?(sf.base.setValue("minStartDate",n,e),sf.base.setValue("maxEndDate",o,e)):(this.parent.cloneProjectStartDate=n||new Date(a.getTime()),this.parent.cloneProjectEndDate=o||new Date(s.getTime()))},e.prototype.splitTasksDuration=function(e){for(var t=0,i=0;i<e.length;i++){var r=e[i],a=r.startDate,s=r.endDate;t+=Math.ceil(this.getTimeDifference(a,s)/864e5)}return t},e}(),V=(u=function(e,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}u(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),U=function(e){function t(t){var i=e.call(this,t)||this;return i.recordIndex=0,i.taskIds=[],i.hierarchyData=[],i.addEventListener(),i}return V(t,e),t.prototype.addEventListener=function(){this.parent.on("beforeDataManipulate",this.checkDataBinding.bind(this))},t.prototype.checkDataBinding=function(e){e&&(this.parent.flatData=[],this.parent.currentViewData=[],this.dataArray=[],this.taskIds=[],this.parent.ids=[],this.recordIndex=0,this.hierarchyData=[],this.parent.predecessorsCollection=[],this.parent.treeGrid.parentData=[],this.parent.taskIds=[]),sf.base.isNullOrUndefined(this.parent.dataSource)?(this.parent.dataSource=[],this.parent.processTimeline(),this.parent.renderGantt(e)):this.parent.dataSource instanceof sf.data.DataManager?this.initDataSource(e):(this.dataArray=this.parent.dataSource,this.processTimeline(),this.cloneDataSource(),this.parent.renderGantt(e))},t.prototype.processTimeline=function(){this.parent.processTimeline(),this.parent.enableValidation||(this.parent.dataOperation.calculateProjectDatesForValidatedTasks(),this.parent.timelineModule.validateTimelineProp())},t.prototype.initDataSource=function(e){var t=this,i=this.parent.query instanceof sf.data.Query?this.parent.query:new sf.data.Query;i.requiresCount(),this.parent.dataSource.executeQuery(i).then((function(i){t.dataArray=i.result,t.processTimeline(),t.cloneDataSource(),t.parent.renderGantt(e)})).catch((function(i){t.parent.processTimeline(),t.parent.renderGantt(e),t.parent.trigger("actionFailure",{error:i})}))},t.prototype.constructDataSource=function(e){for(var t=new sf.data.DataManager(e).executeLocal((new sf.data.Query).group(this.parent.taskFields.parentID)),i=[],r=0;r<t.length;r++){var a=t[r];if(!sf.base.isNullOrUndefined(a.key)){var s=this.taskIds.indexOf(a.key.toString());if(s>-1&&!sf.base.isNullOrUndefined(a.key)){e[s][this.parent.taskFields.child]=a.items;continue}}i.push.apply(i,a.items)}this.hierarchyData=this.dataReorder(e,i)},t.prototype.cloneDataSource=function(){var e=this.parent.taskFields.id,t=this.parent.taskFields.parentID,i=[];if(sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(t))i=this.dataArray;else{for(var r=[],a=0;a<this.dataArray.length;a++){var s=this.dataArray[a];r.push(sf.base.extend({},{},s,!0)),sf.base.isNullOrUndefined(s[e])||this.taskIds.push(s[e].toString())}this.parent.taskFields.child||(this.parent.taskFields.child="Children"),this.constructDataSource(r),i=this.hierarchyData}if(this.parent.taskFields.segmentId&&(this.segmentCollection=new sf.data.DataManager(this.parent.segmentData).executeLocal((new sf.data.Query).group(this.parent.taskFields.segmentId)),this.parent.taskFields.segments||(this.parent.taskFields.segments="Segments")),"ProjectView"!==this.parent.viewType){var n=sf.base.extend([],[],this.parent.resources,!0),o=[];if(this.constructResourceViewDataSource(n,i,o),o.length>0){var d={};d[this.parent.resourceFields.id]=0,d[this.parent.resourceFields.name]=this.parent.localeObj.getConstant("unassignedTask"),d[this.parent.taskFields.child]=o,n.push(d)}i=n}this.prepareDataSource(i)},t.prototype.constructResourceViewDataSource=function(e,t,r){for(var a=function(a){var n=t[a],o=s.parent.taskFields.child,d=n&&n[s.parent.taskFields.resourceInfo],l=s.parent.resourceFields.id;!n[o]&&d&&d.length?d.forEach((function(t){for(var r="object"===i(t)?t[l]:t,a=0;a<e.length;a++)if(e[a][l].toString()===r.toString()){e[a][o]?e[a][o].push(n):e[a][o]=[n];break}})):n[o]||r.push(n),n[s.parent.taskFields.child]&&n[s.parent.taskFields.child].length&&s.constructResourceViewDataSource(e,n[s.parent.taskFields.child],r)},s=this,n=0;n<t.length;n++)a(n)},t.prototype.prepareDataSource=function(e){this.prepareRecordCollection(e,0),"ResourceView"===this.parent.viewType&&this.calculateSharedTaskUniqueIds(),this.parent.taskFields.dependency&&this.parent.predecessorModule&&this.parent.predecessorModule.ensurePredecessorCollection()},t.prototype.calculateSharedTaskUniqueIds=function(){for(var e=function(e){var i=t.parent.getTaskIds()[e].match(/(\d+|[A-z]+)/g);if("R"!==i[0]){var r=[],a=[];t.parent.flatData.filter((function(e){e.ganttProperties.taskId.toString()===i[1]&&0!==e.level&&(a.push(e.ganttProperties.rowUniqueID),r.push(e))}));for(var s=0;s<r.length;s++)r[s].ganttProperties.sharedTaskUniqueIds=a}},t=this,i=0;i<this.parent.getTaskIds().length;i++)e(i)},t.prototype.prepareRecordCollection=function(e,t,i){for(var r=this,a=e.length,s=function(a){var s=e[a];if(!sf.base.isNullOrUndefined(n.parent.taskFields.segmentId)){var o=n.segmentCollection.filter((function(e){return e.key===s[r.parent.taskFields.id]}));o.length>0&&(s[n.parent.taskFields.segments]=o[0].items)}var d=n.createRecord(s,t,i,!0);n.parent.enableValidation||n.updateTaskLeftWidth(d),d.index=n.recordIndex++,n.parent.ids[d.index]=d.ganttProperties.rowUniqueID,n.parent.flatData.push(d),n.parent.setTaskIds(d);var l=s[n.parent.taskFields.child];if("ResourceView"===n.parent.viewType&&sf.base.isNullOrUndefined(l)&&sf.base.isNullOrUndefined(d.parentItem)&&0===d.level){var p=d.ganttProperties,h=d;n.parent.setRecordValue(p.isAutoSchedule?"startDate":"autoStartDate",null,h.ganttProperties,!0),n.parent.setRecordValue(p.isAutoSchedule?"endDate":"autoEndDate",null,h.ganttProperties,!0);var c=h.ganttProperties;n.parent.setRecordValue("isMilestone",!1,c,!0),c.isAutoSchedule&&n.calculateDuration(h),n.updateWorkWithDuration(h);var u=c.work;n.parent.setRecordValue("work",u,c,!0),n.parent.setRecordValue("taskType","FixedDuration",c,!0),sf.base.isNullOrUndefined(n.parent.taskFields.type)||n.updateMappingData(h,"type"),n.parent.setRecordValue("progress",Math.floor(0),c,!0),n.parent.setRecordValue("totalProgress",0,c,!0),n.parent.setRecordValue("totalDuration",0,c,!0),c.isAutoSchedule||(n.parent.setRecordValue("autoDuration",n.calculateAutoDuration(c),c,!0),n.updateAutoWidthLeft(h)),n.resetDependency(h),n.updateWidthLeft(h),n.updateTaskData(h)}!sf.base.isNullOrUndefined(l)&&l.length>0&&n.prepareRecordCollection(l,d.level+1,d)},n=this,o=0;o<a;o++)s(o)},t.prototype.addCustomFieldValue=function(e,t){var i=this.parent.ganttColumns,r=i.length;if(r)for(var a=0;a<r;a++)void 0===t[i[a].field]&&this.parent.setRecordValue(i[a].field,e[i[a].field],t)},t.prototype.createRecord=function(e,t,i,r){var a=this.parent.taskFields,s=this.parent.resourceFields,n=(e[a.child],e[a.progress]),o=null,d=null;n=n&&parseFloat(n.toString())?parseFloat(n.toString()):0;var l=e[a.dependency],p=this.getDateFromFormat(e[a.baselineStartDate],!0),h=this.getDateFromFormat(e[a.baselineEndDate],!0),c={},u={},f="Auto"===this.parent.taskMode||"Manual"!==this.parent.taskMode&&!0!==e[a.manual];this.parent.setRecordValue("ganttProperties",u,c),sf.base.isNullOrUndefined(e[a.id])?sf.base.isNullOrUndefined(e[s.id])||(o=e[s.id],d=e[s.name],this.addTaskData(c,e,!1)):(o=e[a.id],d=e[a.name],this.addTaskData(c,e,r)),this.parent.setRecordValue("taskId",o,u,!0),this.parent.setRecordValue("taskName",d,u,!0),a.parentID&&this.parent.setRecordValue("parentId",e[a.parentID],u,!0),this.addCustomFieldValue(e,c),this.parent.setRecordValue("isAutoSchedule",f,u,!0),this.parent.setRecordValue("resourceInfo",this.setResourceInfo(e),u,!0),this.parent.setRecordValue("isMilestone",!1,u,!0),this.updateResourceName(c),this.calculateScheduledValues(c,e,r),this.parent.setRecordValue("baselineStartDate",this.checkBaselineStartDate(p),u,!0),h&&0===h.getHours()&&86400!==this.parent.defaultEndTime&&this.setTime(this.parent.defaultEndTime,h),this.parent.setRecordValue("baselineEndDate",this.checkBaselineEndDate(h),u,!0),this.parent.setRecordValue("progress",n,u,!0),this.parent.setRecordValue("totalProgress",n,u,!0),this.parent.setRecordValue("predecessorsName",l,u,!0),this.parent.setRecordValue("indicators",e[a.indicators],u,!0),this.parent.setRecordValue("notes",e[a.notes],u,!0),this.parent.setRecordValue("cssClass",e[a.cssClass],u,!0),this.parent.setRecordValue("parentItem",this.getCloneParent(i),c);var g=c.parentItem?c.parentItem.uniqueID:null;if(this.parent.setRecordValue("parentUniqueID",g,c),"ResourceView"!==this.parent.viewType||sf.base.isNullOrUndefined(a.parentID)||sf.base.isNullOrUndefined(c.parentItem)||this.parent.setRecordValue("parentId",c.parentItem.taskId,u,!0),this.parent.setRecordValue("level",t,c),this.parent.setRecordValue("uniqueID",sf.grids.getUid(this.parent.element.id+"_data_"),c),this.parent.setRecordValue("uniqueID",c.uniqueID,u,!0),this.parent.setRecordValue("childRecords",[],c),this.parent.setRecordValue("baselineEndDate",this.checkBaselineEndDate(h),u,!0),!sf.base.isNullOrUndefined(e[a.child])&&e[a.child].length>0?(this.parent.setRecordValue("hasChildRecords",!0,c),this.parent.setRecordValue("isMilestone",!1,u,!0),this.resetDependency(c)):this.parent.setRecordValue("hasChildRecords",!1,c),c.hasChildRecords&&(this.parent.setRecordValue("autoStartDate",c.ganttProperties.startDate,u),this.parent.setRecordValue("autoEndDate",c.ganttProperties.endDate,u),this.parent.setRecordValue("autoDuration",c.ganttProperties.duration,u)),this.parent.setRecordValue("expanded",!c.hasChildRecords||!this.parent.collapseAllParentTasks,c),this.updateExpandStateMappingValue(c,e),r||(this.parent.setRecordValue("width",this.calculateWidth(c),u,!0),this.parent.setRecordValue("left",this.calculateLeft(u),u,!0),this.parent.setRecordValue("progressWidth",this.getProgressWidth(u.width,n),u,!0),u.baselineEndDate&&u.baselineStartDate&&(this.parent.setRecordValue("baselineLeft",this.calculateBaselineLeft(u),u,!0),this.parent.setRecordValue("baselineWidth",this.calculateBaselineWidth(u),u,!0))),sf.base.isNullOrUndefined(a.work)&&this.updateWorkWithDuration(c),sf.base.isNullOrUndefined(a.manual)||this.parent.dataOperation.updateMappingData(c,"manual"),this.updateTaskData(c),l&&this.parent.predecessorsCollection.push(c),sf.base.isNullOrUndefined(i)||i.childRecords.push(c),"ProjectView"===this.parent.viewType)this.parent.setRecordValue("rowUniqueID",u.taskId.toString(),u,!0);else{var m=c.uniqueID.replace(this.parent.element.id+"_data_","");this.parent.setRecordValue("rowUniqueID",m,c),this.parent.setRecordValue("rowUniqueID",m,u,!0),this.parent.setRecordValue("sharedTaskUniqueIds",[],u,!0)}return this.parent.allowUnscheduledTasks&&c.ganttProperties.startDate&&(c.ganttProperties.endDate||c.ganttProperties.duration)&&(this.parent.setRecordValue("segments",this.setSegmentsInfo(c,!0),u,!0),this.parent.dataOperation.updateMappingData(c,"segments"),r||this.updateWidthLeft(c)),c},t.prototype.sortSegmentsData=function(e,t,i){var r=this;return t?e.sort((function(e,t){var i=r.parent.taskFields.startDate;return r.getDateFromFormat(e[i]).getTime()-r.getDateFromFormat(t[i]).getTime()})):e.sort((function(e,t){return e.startDate.getTime()-t.startDate.getTime()})),e},t.prototype.setSegmentsInfo=function(e,t){var i,r=this.parent.taskFields,a=[],s=0,n=0,o=[];if(!sf.base.isNullOrUndefined(this.parent.taskFields.segments)&&(i=t?e.taskData[this.parent.taskFields.segments]:e.ganttProperties.segments,!sf.base.isNullOrUndefined(i)&&i.length>1)){this.sortSegmentsData(i,t,e.ganttProperties);for(var d=0;d<i.length;d++){var l=i[d],p=t?l[r.startDate]:l.startDate,h=t?l[r.endDate]:l.endDate,c=t?l[r.duration]:l.duration;if(p=this.getDateFromFormat(p),p=this.checkStartDate(p,e.ganttProperties,!1),sf.base.isNullOrUndefined(c)?(h=this.checkEndDate(h,e.ganttProperties,!1),c=this.getDuration(p,h,e.ganttProperties.durationUnit,e.ganttProperties.isAutoSchedule,e.ganttProperties.isMilestone)):h=this.getEndDate(p,c,e.ganttProperties.durationUnit,e.ganttProperties,!1),r.duration){if((n=e.ganttProperties.duration-s)<=0)continue;c=d===i.length-1||n>0&&c>n?n:c,h=this.getEndDate(p,c,e.ganttProperties.durationUnit,e.ganttProperties,!1)}else if(!r.duration&&r.endDate&&(h=!sf.base.isNullOrUndefined(e.ganttProperties.endDate)&&h.getTime()>e.ganttProperties.endDate.getTime()&&d!==i.length-1?h:e.ganttProperties.endDate,c=this.getDuration(p,h,e.ganttProperties.durationUnit,e.ganttProperties.isAutoSchedule,e.ganttProperties.isMilestone),a.length>0&&h.getTime()<p.getTime()&&h.getTime()<=e.ganttProperties.endDate.getTime())){a[d-1].duration=this.getDuration(a[d-1].startDate,e.ganttProperties.endDate,e.ganttProperties.durationUnit,e.ganttProperties.isAutoSchedule,e.ganttProperties.isMilestone);continue}if(l={},!(p&&h&&p&&c))break;if(s+=c,l.startDate=p,l.endDate=h,l.duration=c,l.width=0,l.left=0,l.segmentIndex=d,a.push(l),sf.base.isNullOrUndefined(a[d-1]))l.offsetDuration=0;else{var u=this.getDuration(a[d-1].endDate,a[d].startDate,e.ganttProperties.durationUnit,e.ganttProperties.isAutoSchedule,e.ganttProperties.isMilestone);l.offsetDuration=u,u<1&&(l.startDate=this.getEndDate(a[d-1].endDate,1,e.ganttProperties.durationUnit,e.ganttProperties,!1),l.startDate=this.checkStartDate(l.startDate,e.ganttProperties,!1),l.endDate=this.getEndDate(l.startDate,l.duration,e.ganttProperties.durationUnit,e.ganttProperties,!1),l.endDate=l.endDate>e.ganttProperties.endDate?e.ganttProperties.endDate:l.endDate,l.offsetDuration=1)}o.push(this.setSegmentTaskData(l,i[d]))}this.parent.setRecordValue("duration",s,e.ganttProperties,!0),this.parent.setRecordValue("endDate",a[a.length-1].endDate,e.ganttProperties,!0),sf.base.isNullOrUndefined(r.endDate)||this.parent.setRecordValue(this.parent.taskFields.endDate,a[a.length-1].endDate,e,!0),this.parent.setRecordValue("taskData."+this.parent.taskFields.segments,o,e)}return a.length>1?this.parent.setRecordValue("segments",a,e.ganttProperties,!0):a=null,a},t.prototype.setSegmentTaskData=function(e,t){var i=this.parent.taskFields,r=sf.base.extend({},{},t,!0);return sf.base.isNullOrUndefined(i.startDate)||(r[this.parent.taskFields.startDate]=e.startDate),sf.base.isNullOrUndefined(i.endDate)||(r[this.parent.taskFields.endDate]=e.endDate),sf.base.isNullOrUndefined(i.duration)||(r[this.parent.taskFields.duration]=Number(e.duration)),r},t.prototype.updateWorkWithDuration=function(e){var t=e.ganttProperties.resourceInfo,i=0;if(!sf.base.isNullOrUndefined(t)){var r=t.length,a=void 0,s=void 0,n=this.parent.secondsPerDay/3600,o=this.getDurationInDay(e.ganttProperties.duration,e.ganttProperties.durationUnit);for(a=0;a<r;a++)i+=((s=t[a][this.parent.resourceFields.unit])>0?n*s/100:n)*o;"minute"===e.ganttProperties.workUnit&&(i*=60),"day"===e.ganttProperties.workUnit&&(i/=n),i%1!=0&&(i=parseFloat(i.toFixed(2)))}this.parent.setRecordValue("work",i,e.ganttProperties,!0),sf.base.isNullOrUndefined(this.parent.taskFields.work)||this.parent.dataOperation.updateMappingData(e,"work")},t.prototype.getCloneParent=function(e){if(sf.base.isNullOrUndefined(e))return null;var t={};return t.uniqueID=e.uniqueID,t.expanded=e.expanded,t.level=e.level,t.index=e.index,t.taskId=e.ganttProperties.rowUniqueID,t},t.prototype.reUpdateResources=function(){if(this.parent.flatData.length>0)for(var e=void 0,t=void 0,i=void 0,r=0;r<this.parent.flatData.length;r++)e=this.parent.flatData[r].taskData,t=this.parent.flatData[r].ganttProperties,i=this.parent.flatData[r],this.parent.setRecordValue("resourceInfo",this.setResourceInfo(e),t,!0),this.updateResourceName(i)},t.prototype.addTaskData=function(e,t,i){var r=this.parent.taskFields,a=this.parent.dataSource;if(i)if(r.parentID||a instanceof sf.data.DataManager&&a.dataSource.json&&a.dataSource.offline)if(r.parentID){var s=t[r.id],n=this.taskIds.indexOf(s.toString()),o=n>-1?this.dataArray[n]:{};this.parent.setRecordValue("taskData",o,e)}else this.parent.setRecordValue("taskData",t,e);else this.parent.setRecordValue("taskData",t,e);else this.parent.setRecordValue("taskData",t,e)},t.prototype.updateExpandStateMappingValue=function(e,t){var i,r=this.parent.taskFields.expandState,a=t[r];r&&e.hasChildRecords&&(sf.base.isNullOrUndefined(a)?sf.base.isNullOrUndefined(a)&&!this.parent.collapseAllParentTasks?i=!0:sf.base.isNullOrUndefined(a)&&this.parent.collapseAllParentTasks&&(i=!1):i="true"===a.toString(),this.parent.setRecordValue("taskData."+r,i,e),this.parent.setRecordValue(r,i,e),this.parent.setRecordValue("expanded",i,e))},t.prototype.setValidatedDates=function(e,t){var i=e.ganttProperties,r=this.parent.taskFields,a=t[r.duration],s=this.getDateFromFormat(t[r.startDate],!0),n=this.getDateFromFormat(t[r.endDate],!0);a=sf.base.isNullOrUndefined(a)||""===a?null:a,this.parent.setRecordValue("startDate",new Date(s.getTime()),i,!0),sf.base.isNullOrUndefined(a)||""===a?this.calculateDuration(e):this.updateDurationValue(a,i),this.parent.setRecordValue("endDate",new Date(n.getTime()),i,!0)},t.prototype.calculateScheduledValues=function(e,t,i){var r=this.parent.taskFields,a=e.ganttProperties,s=t[r.duration];s=sf.base.isNullOrUndefined(s)||""===s?null:s;var n=this.getDateFromFormat(t[r.startDate],!0),o=this.getDateFromFormat(t[r.endDate],!0),d=r.segments?t[r.segments]||e.taskData[r.segments]:null,l=!!r.milestone&&!!t[r.milestone],p=t[r.durationUnit]?t[r.durationUnit]:"";this.parent.setRecordValue("durationUnit",this.validateDurationUnitMapping(p),a,!0);var h=sf.base.isNullOrUndefined(t[r.work])?0:parseFloat(t[r.work]);this.parent.setRecordValue("workUnit",this.validateWorkUnitMapping(this.parent.workUnit),a,!0);var c=t[r.type]?t[r.type]:"",u=this.validateTaskTypeMapping(c);if(this.parent.setRecordValue("taskType",u,a,!0),i&&!this.parent.enableValidation&&n&&o)this.setValidatedDates(e,t);else if(o||n||!sf.base.isNullOrUndefined(s)&&""!==s)n?this.calculateDateFromStartDate(n,o,s,e,i):o?this.calculateDateFromEndDate(o,s,e):sf.base.isNullOrUndefined(s)||""===s||(this.updateDurationValue(s,a),this.parent.allowUnscheduledTasks?(this.parent.setRecordValue("startDate",null,a,!0),this.parent.setRecordValue("endDate",null,a,!0)):(this.parent.setRecordValue("startDate",this.getProjectStartDate(a,i),a,!0),this.calculateEndDate(e)));else{if(this.parent.allowUnscheduledTasks)return;this.parent.setRecordValue("duration",1,a,!0),this.parent.setRecordValue("startDate",this.getProjectStartDate(a,i),a,!0),this.calculateEndDate(e)}if(sf.base.isNullOrUndefined(d)||this.parent.setRecordValue("segments",this.setSegmentsInfo(e,!0),a,!0),0===a.duration&&(this.parent.setRecordValue("isMilestone",!0,a,!0),this.parent.setRecordValue("endDate",a.startDate,a,!0)),!sf.base.isNullOrUndefined(l)&&l&&(this.parent.setRecordValue("duration",0,a,!0),this.parent.setRecordValue("isMilestone",!0,a,!0),this.parent.setRecordValue("endDate",a.startDate,a,!0)),sf.base.isNullOrUndefined(r.work))r.type&&a.taskType&&this.parent.dataOperation.updateMappingData(e,"type");else{if(this.parent.setRecordValue("durationUnit",this.parent.durationUnit,a,!0),isNaN(h)||sf.base.isNullOrUndefined(h))this.parent.setRecordValue("work",0,a,!0),this.parent.setRecordValue("duration",0,a,!0),this.parent.setRecordValue("isMilestone",!0,a,!0),this.parent.setRecordValue("endDate",a.startDate,a,!0);else{switch(this.parent.setRecordValue("work",h,a,!0),u){case"FixedDuration":case"FixedWork":this.updateUnitWithWork(e);break;case"FixedUnit":this.updateDurationWithWork(e)}sf.base.isNullOrUndefined(r.type)||this.parent.dataOperation.updateMappingData(e,"type"),0===a.duration?(this.parent.setRecordValue("isMilestone",!0,a,!0),this.parent.setRecordValue("endDate",a.startDate,a,!0)):sf.base.isNullOrUndefined(a.startDate)||sf.base.isNullOrUndefined(a.duration)||(this.parent.setRecordValue("isMilestone",!1,a,!0),this.calculateEndDate(e))}this.parent.dataOperation.updateMappingData(e,"work")}},t.prototype.updateDurationWithWork=function(e){var t=e.ganttProperties,i=t.resourceInfo;if(!sf.base.isNullOrUndefined(i)){var r,a=sf.base.isNullOrUndefined(i)?0:i.length,s=0,n=this.parent.secondsPerDay/3600,o=0,d=void 0,l=void 0;for(l=0;l<a;l++)s+=(d=i[l][this.parent.resourceFields.unit])>0?n*d/100:n;r=this.getWorkInHour(t.work,t.workUnit),a>0&&(o+=r/s),"minute"===t.durationUnit&&(o=o*n*60),"hour"===t.durationUnit&&(o*=n),o%1!=0&&(o=parseFloat(o.toFixed(2))),sf.base.isNullOrUndefined(t.duration)||this.parent.setRecordValue("duration",o,t,!0)}},t.prototype.updateUnitWithWork=function(e){var t=e.ganttProperties,i=t.resourceInfo,r=sf.base.isNullOrUndefined(i)?0:i.length,a=this.parent.secondsPerDay/3600;if(0!==r){var s=this.getDurationInDay(e.ganttProperties.duration,e.ganttProperties.durationUnit),n=this.getWorkInHour(t.work,t.workUnit),o=s>0?n/(s*a)*100:0,d=o>0?o/r:100;d%1!=0&&(d=parseFloat(d.toFixed(2)));for(var l=0;l<r;l++)i[l][this.parent.resourceFields.unit]=d;this.updateResourceName(e)}},t.prototype.calculateDateFromEndDate=function(e,t,i){var r=i.ganttProperties;0===e.getHours()&&86400!==this.parent.defaultEndTime&&this.setTime(this.parent.defaultEndTime,e);var a=0===parseInt(t,10)||null;this.parent.setRecordValue("endDate",this.checkEndDate(e,i.ganttProperties,a),r,!0),sf.base.isNullOrUndefined(t)||""===t?this.parent.allowUnscheduledTasks?(this.parent.setRecordValue("startDate",null,r,!0),this.parent.setRecordValue("duration",null,r,!0)):(this.parent.setRecordValue("duration",1,r,!0),this.parent.setRecordValue("startDate",this.getStartDate(r.endDate,r.duration,r.durationUnit,r),r,!0)):sf.base.isNullOrUndefined(t)||""===t||(this.updateDurationValue(t,r),this.parent.setRecordValue("startDate",this.getStartDate(r.endDate,r.duration,r.durationUnit,r),r,!0))},t.prototype.calculateDateFromStartDate=function(e,t,i,r,a){var s=r.ganttProperties,n=!!(0===parseInt(i,10)||e&&t&&new Date(e.getTime())===new Date(t.getTime()))||null;this.parent.setRecordValue("startDate",this.checkStartDate(e,s,n,a),s,!0),t||!sf.base.isNullOrUndefined(i)&&""!==i?(sf.base.isNullOrUndefined(i)||t)&&t&&(sf.base.isNullOrUndefined(i)||""===i)?(0===t.getHours()&&86400!==this.parent.defaultEndTime&&this.setTime(this.parent.defaultEndTime,t),this.parent.setRecordValue("endDate",this.checkEndDate(t,r.ganttProperties),s,!0),1===this.compareDates(s.startDate,s.endDate)?(this.parent.setRecordValue("endDate",s.startDate,s,!0),this.parent.setRecordValue("isMilestone",!0,s,!0),this.parent.setRecordValue("duration",0,s,!0)):this.calculateDuration(r)):(this.updateDurationValue(i,s),this.calculateEndDate(r)):this.parent.allowUnscheduledTasks?(this.parent.setRecordValue("endDate",null,s,!0),this.parent.setRecordValue("duration",null,s,!0)):(this.parent.setRecordValue("duration",1,s,!0),this.calculateEndDate(r))},t.prototype.getProgressWidth=function(e,t){return e*t/100},t.prototype.calculateWidth=function(e,t){var i=e.ganttProperties,r=t?i.autoStartDate:i.startDate,a=t?i.autoEndDate:i.endDate;return sf.base.isNullOrUndefined(r)&&sf.base.isNullOrUndefined(a)&&(r=this.getValidStartDate(i,t),a=this.getValidEndDate(i,t)),sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(a)?3:!i.isMilestone||e.hasChildRecords&&!i.isAutoSchedule?this.getTaskWidth(r,a):0},t.prototype.getTaskbarHeight=function(){var e=this.parent.rowHeight,t=this.parent.taskbarHeight;return t<e?t:e},t.prototype.calculateLeft=function(e,t){var i=null,r=-300,a=t?e.autoStartDate:e.startDate,s=t?e.autoEndDate:e.endDate,n=(t?e.autoDuration:e.duration,e.isMilestone);return a?i=new Date(a.getTime()):s?(i=new Date(s.getTime()),n=!0):i=this.getValidStartDate(e),sf.base.isNullOrUndefined(i)||(r=this.getTaskLeft(i,n)),r},t.prototype.calculateAutoLeft=function(e){return this.getTaskLeft(e.autoStartDate,e.isMilestone)},t.prototype.calculateAutoDuration=function(e){return this.getDuration(e.autoStartDate,e.autoEndDate,e.durationUnit,!1,e.isMilestone)},t.prototype.calculateAutoWidth=function(e){return this.getTaskWidth(e.autoStartDate,e.autoEndDate)},t.prototype.calculateBaselineLeft=function(e){var t=this.getDateFromFormat(e.baselineStartDate),i=this.getDateFromFormat(e.baselineEndDate);return t&&i?this.getTaskLeft(t,e.isMilestone):0},t.prototype.calculateBaselineWidth=function(e){var t=this.getDateFromFormat(e.baselineStartDate),i=this.getDateFromFormat(e.baselineEndDate);return t&&i?this.getTaskWidth(t,i):0},t.prototype.getTaskWidth=function(e,t){var i=new Date(e.getTime()),r=new Date(t.getTime());return"Day"===("None"!==this.parent.timelineModule.bottomTier?this.parent.timelineModule.bottomTier:this.parent.timelineModule.topTier)&&(this.getSecondsInDecimal(i)===this.parent.defaultStartTime&&i.setHours(0,0,0,0),this.getSecondsInDecimal(r)===this.parent.defaultEndTime&&r.setHours(24),this.getSecondsInDecimal(r)===this.parent.defaultStartTime&&r.setHours(0,0,0,0)),this.getTimeDifference(i,r)/864e5*this.parent.perDayWidth},t.prototype.getTaskLeft=function(e,t){var i=new Date(e.getTime());"Day"===("None"!==this.parent.timelineModule.bottomTier?this.parent.timelineModule.bottomTier:this.parent.timelineModule.topTier)&&(this.getSecondsInDecimal(i)===this.parent.defaultStartTime?i.setHours(0,0,0,0):t&&this.getSecondsInDecimal(i)===this.parent.defaultEndTime&&i.setHours(24));var r=this.parent.timelineModule.timelineStartDate;return r?(i.getTime()-r.getTime())/864e5*this.parent.perDayWidth:0},t.prototype.getSplitTaskWidth=function(e,t,i){var r=new Date(e.getTime()),a=new Date(this.getEndDate(r,t,i.ganttProperties.durationUnit,i.ganttProperties,!1).getTime());return"Day"===("None"!==this.parent.timelineModule.bottomTier?this.parent.timelineModule.bottomTier:this.parent.timelineModule.topTier)&&(this.getSecondsInDecimal(r)===this.parent.defaultStartTime&&r.setHours(0,0,0,0),this.getSecondsInDecimal(a)===this.parent.defaultEndTime&&a.setHours(24),this.getSecondsInDecimal(a)===this.parent.defaultStartTime&&a.setHours(0,0,0,0)),this.getTimeDifference(r,a)/864e5*this.parent.perDayWidth},t.prototype.getSplitTaskLeft=function(e,t){var i=new Date(e.getTime());return"Day"===("None"!==this.parent.timelineModule.bottomTier?this.parent.timelineModule.bottomTier:this.parent.timelineModule.topTier)&&(this.getSecondsInDecimal(i)===this.parent.defaultStartTime&&i.setHours(0,0,0,0),this.getSecondsInDecimal(t)===this.parent.defaultStartTime&&t.setHours(0,0,0,0)),t?(i.getTime()-t.getTime())/864e5*this.parent.perDayWidth:0},t.prototype.updateMappingData=function(e,t){var i=this.parent.columnMapping,r=e.ganttProperties;if(!sf.base.isNullOrUndefined(i[t])||"taskType"===t||"segments"===t)if("predecessorName"===t);else if("resourceInfo"===t){for(var a=r.resourceInfo,s=this.parent.resourceFields,n=[],o=[],d=0;d<a.length;d++){n.push(a[d][s.id]);var l=a[d][s.name],p=a[d][s.unit];100!==p&&(l+="["+p+"%]"),o.push(l)}this.parent.setRecordValue("resourceNames",o.join(","),r,!0),this.updateTaskDataResource(e),this.parent.setRecordValue(i[t],o.join(","),e)}else"startDate"===t||"endDate"===t?this.setRecordDate(e,r[t],i[t]):"duration"===t?this.setRecordDuration(e,i[t]):"work"===t?(this.parent.setRecordValue("taskData."+i[t],this.getWorkString(r.work,r.workUnit),e),this.parent.setRecordValue(i[t],r[t],e)):"type"===t?(this.parent.setRecordValue("taskData."+i[t],r[t],e),this.parent.setRecordValue(i[t],r[t],e)):"manual"===t?(this.parent.setRecordValue("taskData."+i[t],!r.isAutoSchedule,e),this.parent.setRecordValue(i[t],!r.isAutoSchedule,e)):"segments"===t?this.parent.setRecordValue("taskData."+this.parent.taskFields.segments,this.segmentTaskData(e),e):(this.parent.setRecordValue("taskData."+i[t],r[t],e),this.parent.setRecordValue(i[t],r[t],e))},t.prototype.segmentTaskData=function(e){var t=e.ganttProperties.segments,i=this.parent.taskFields;if(sf.base.isNullOrUndefined(t))return null;for(var r=sf.base.extend([],[],e.taskData[i.segments],!0),a=0;a<t.length;a++)this.parent.isLoad||(r[a]={}),sf.base.isNullOrUndefined(i.startDate)||(r[a][this.parent.taskFields.startDate]=t[a].startDate),sf.base.isNullOrUndefined(i.endDate)||(r[a][this.parent.taskFields.endDate]=t[a].endDate),sf.base.isNullOrUndefined(i.duration)||(r[a][this.parent.taskFields.duration]=Number(t[a].duration));return r},t.prototype.updateTaskDataResource=function(e){var t=e.ganttProperties.resourceInfo,i=e.taskData[this.parent.taskFields.resourceInfo],r=this.parent.resourceFields;if(sf.base.isNullOrUndefined(i))e.taskData[this.parent.taskFields.resourceInfo]=t;else if(t.length){for(var a=0;a<t.length;a++){for(var s=!1,n=0;n<i.length;n++)if("number"==typeof i[n]||"string"==typeof i[n]){if(parseInt(i[n],10)===parseInt(t[a][r.id],10)){i[n]=t[a],s=!0;break}}else if(i[n][r.id]===t[a][r.id]&&"number"!=typeof i[n]){i[n]=sf.base.extend({},i[n],t[a],!0),s=!0;break}s||i.push(t[a])}for(var o=[],d=function(e){t.filter((function(t){t[r.id]===i[e][r.id]&&o.push(i[e])}))},l=0;l<i.length;l++)d(l);this.parent.setRecordValue("taskData."+this.parent.taskFields.resourceInfo,o,e)}else this.parent.setRecordValue("taskData."+this.parent.taskFields.resourceInfo,[],e)},t.prototype.setRecordDate=function(e,t,i){var r="string"==typeof t?new Date(t):t;sf.base.isNullOrUndefined(t)||(t=new Date(r.getTime())),this.parent.setRecordValue(i,t,e),sf.base.isNullOrUndefined(t)||(t=new Date(r.getTime())),this.parent.setRecordValue("taskData."+i,t,e)},t.prototype.getDurationInDay=function(e,t){return"day"===t?e:"hour"===t?e/(this.parent.secondsPerDay/3600):e/(this.parent.secondsPerDay/60)},t.prototype.setRecordDuration=function(e,t){var i=e.ganttProperties.duration,r=e.ganttProperties.durationUnit;if(sf.base.isNullOrUndefined(i))this.parent.setRecordValue(t,i,e),this.parent.setRecordValue("taskData."+t,i,e);else{this.parent.setRecordValue(t,e.ganttProperties.duration,e);var a=sf.base.getValue(t,e.taskData);isNaN(a)&&sf.base.isNullOrUndefined(this.parent.taskFields.durationUnit)&&!sf.base.isNullOrUndefined(a)?this.parent.setRecordValue("taskData."+t,this.getDurationString(i,r),e):"string"==typeof a?this.parent.setRecordValue("taskData."+t,i.toString(),e):this.parent.setRecordValue("taskData."+t,i,e)}this.parent.taskFields.durationUnit&&(e.taskData[this.parent.taskFields.durationUnit]=e.ganttProperties.durationUnit)},t.prototype.getWorkInHour=function(e,t){return"day"===t?e*(this.parent.secondsPerDay/3600):"minute"===t?e/60:e},t.prototype.updateTaskData=function(e){var t=this.parent.taskFields,i=e.ganttProperties;if(!sf.base.isNullOrUndefined(e.taskData)){var r=e.taskData;t.id&&(this.parent.setRecordValue("taskData."+t.id,i.taskId,e),this.parent.setRecordValue(t.id,i.taskId,e)),t.name&&(this.parent.setRecordValue("taskData."+t.name,i.taskName,e),this.parent.setRecordValue(t.name,i.taskName,e)),t.startDate&&this.setRecordDate(e,i.startDate,t.startDate),t.endDate&&this.setRecordDate(e,i.endDate,t.endDate),t.duration&&this.setRecordDuration(e,t.duration),t.durationUnit&&(r[t.durationUnit]=i.durationUnit),t.progress&&(this.parent.setRecordValue("taskData."+t.progress,i.progress,e),this.parent.setRecordValue(t.progress,i.progress,e)),t.baselineStartDate&&this.setRecordDate(e,i.baselineStartDate,t.baselineStartDate),t.baselineEndDate&&this.setRecordDate(e,i.baselineEndDate,t.baselineEndDate),t.notes&&(this.parent.setRecordValue("taskData."+t.notes,i.notes,e),this.parent.setRecordValue(t.notes,i.notes,e)),t.cssClass&&(this.parent.setRecordValue("taskData."+t.cssClass,i.cssClass,e),this.parent.setRecordValue(t.cssClass,i.cssClass,e)),t.indicators&&(this.parent.setRecordValue("taskData."+t.indicators,i.indicators,e),this.parent.setRecordValue(t.indicators,i.indicators,e)),t.parentID&&(this.parent.setRecordValue("taskData."+t.parentID,i.parentId,e),this.parent.setRecordValue(t.parentID,i.parentId,e)),t.work&&(this.parent.setRecordValue("taskData."+t.work,this.getWorkString(i.work,i.workUnit),e),this.parent.setRecordValue(t.work,i.work,e)),t.type&&(this.parent.setRecordValue("taskData."+t.type,i.taskType,e),this.parent.setRecordValue(t.type,i.taskType,e))}},t.prototype.setResourceInfo=function(e){var t,r;if(sf.base.isNullOrUndefined(e[this.parent.taskFields.resourceInfo]))return t;t=e[this.parent.taskFields.resourceInfo],r=sf.base.isNullOrUndefined(this.parent.editModule)||sf.base.isNullOrUndefined(this.parent.editModule.dialogModule)||!this.parent.editModule.dialogModule.isAddNewResource?this.parent.resources:this.parent.editModule.dialogModule.ganttResources;for(var a=this.parent.resourceFields.id,s=this.parent.resourceFields.unit,n=this.parent.resourceFields.group,o=[],d=function(e){var d=r.filter((function(r){return"object"===i(t[e])&&t[e][a]===r[a]||t[e]===r[a]})),l=sf.base.extend({},d[0]);o.push(l),sf.base.isNullOrUndefined(s)||sf.base.isNullOrUndefined(t[e][s])||(l[s]=t[e][s]),sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(t[e][n])||(l[n]=t[e][n])},l=0;l<t.length;l++)d(l);return this.updateResourceUnit(o),o},t.prototype.updateResourceUnit=function(e){var t=this.parent.resourceFields.unit;if(!sf.base.isNullOrUndefined(t)){var i=e.length,r=void 0;for(r=0;r<i;r++)sf.base.isNullOrUndefined(e[r][t])&&(e[r][t]=100)}},t.prototype.updateResourceName=function(e){var t=e.ganttProperties.resourceInfo,r=[];if(t){var a=sf.base.extend([],[],e.taskData[this.parent.taskFields.resourceInfo],!0);this.parent.setRecordValue("taskData."+this.parent.taskFields.resourceInfo,[],e);for(var s=0;s<t.length;s++){var n=t[s],o=n[this.parent.resourceFields.name],d=n[this.parent.resourceFields.unit];if(100!==d&&(o+="["+d+"%]"),r.push(o),e.taskData){var l=this.parent.taskFields.resourceInfo;i("object"===a[s])?e.taskData[l].push(a[s]):e.taskData[l].push(n[this.parent.resourceFields.id])}}this.parent.setRecordValue("resourceNames",r.join(","),e.ganttProperties,!0),this.parent.setRecordValue(this.parent.taskFields.resourceInfo,r.join(","),e,!0),this.updateTaskDataResource(e)}},t.prototype.dataReorder=function(e,t){for(var i=[];e.length>0&&t.length>0;){var r=t.indexOf(e[0]);-1===r?e.shift():(i.push(e.shift()),t.splice(r,1))}return i},t.prototype.validateDurationUnitMapping=function(e){var t=e;return t="minute"===t||"minutes"===t||"m"===t||"min"===t?"minute":"hour"===t||"hours"===t||"h"===t||"hr"===t?"hour":"day"===t||"days"===t||"d"===t?"day":this.parent.durationUnit.toLocaleLowerCase()},t.prototype.validateTaskTypeMapping=function(e){var t=e;return t="FixedDuration"===t?"FixedDuration":"FixedUnit"===t?"FixedUnit":"FixedWork"===t?"FixedWork":this.parent.taskType},t.prototype.validateWorkUnitMapping=function(e){var t=e;return t="minute"===t?"minute":"hour"===t?"hour":"day"===t?"day":this.parent.workUnit.toLocaleLowerCase()},t.prototype.updateDurationValue=function(e,t){var i=this.getDurationValue(e);isNaN(sf.base.getValue("duration",i))||this.parent.setRecordValue("duration",sf.base.getValue("duration",i),t,!0),sf.base.isNullOrUndefined(sf.base.getValue("durationUnit",i))||this.parent.setRecordValue("durationUnit",sf.base.getValue("durationUnit",i),t,!0)},t.prototype.reUpdateGanttData=function(){if(this.parent.flatData.length>0){var e=void 0,t=void 0;this.parent.secondsPerDay=this.getSecondsPerDay();for(var i=0;i<this.parent.flatData.length;i++)e=this.parent.flatData[i].taskData,t=this.parent.flatData[i],sf.base.isNullOrUndefined(this.parent.taskFields.duration)||this.setRecordDuration(t,this.parent.taskFields.duration),this.calculateScheduledValues(t,e,!1);this.updateGanttData()}},t.prototype._isInStartDateRange=function(e,t,i){var r=!1;return e.getTime()>=t.getTime()&&e.getTime()<i.getTime()&&(r=!0),r},t.prototype._isInEndDateRange=function(e,t,i){var r=!1;return e.getTime()>t.getTime()&&e.getTime()<=i.getTime()&&(r=!0),r},t.prototype.updateOverlappingValues=function(e){var t,i=e.childRecords,r=[];if(i.length<=1)e.ganttProperties.workTimelineRanges=[];else{i=this.setSortedChildTasks(e),this.updateOverlappingIndex(i);for(var a=1;a<i.length;a++){t=i[a];for(var s=new Date(t.ganttProperties.startDate.getTime()),n=new Date(t.ganttProperties.endDate.getTime()),o=[],d=0;d<a;d++){var l=i[d].ganttProperties.startDate,p=i[d].ganttProperties.endDate,h={};(this._isInStartDateRange(s,l,p)||this._isInEndDateRange(n,l,p))&&(l.getTime()>s.getTime()&&l.getTime()<n.getTime()&&p.getTime()>s.getTime()&&p.getTime()>n.getTime()||s.getTime()===l.getTime()&&n.getTime()<=p.getTime()?(h.from=l,h.to=n):s.getTime()===l.getTime()&&n.getTime()>p.getTime()?(h.from=l,h.to=p):s.getTime()>l.getTime()&&n.getTime()>=p.getTime()?(h.from=s,h.to=p):s.getTime()>l.getTime()&&n.getTime()<p.getTime()&&(h.from=s,h.to=n),o.push(h))}r.push.apply(r,this.mergeRangeCollections(o))}this.parent.setRecordValue("workTimelineRanges",this.mergeRangeCollections(r,!0),e.ganttProperties,!0),this.calculateRangeLeftWidth(e.ganttProperties.workTimelineRanges)}},t.prototype.updateOverlappingIndex=function(e){for(var t=0;t<e.length;t++)e[t].ganttProperties.eOverlapIndex=t},t.prototype.calculateRangeLeftWidth=function(e){for(var t=0;t<e.length;t++)e[t].left=this.getTaskLeft(e[t].from,!1),e[t].width=this.getTaskWidth(e[t].from,e[t].to)},t.prototype.mergeRangeCollections=function(e,t){var i,r,a,s,n,o=[],d={},l={};i=new sf.data.DataManager(e).executeLocal((new sf.data.Query).sortBy(this.parent.taskFields.startDate,"Ascending"));for(var p=0;p<i.length;p++)0!==o.length||0!==p?(r=(d=o[o.length-1]).from,a=d.to,s=(l=i[p]).from,n=l.to,r.getTime()===s.getTime()&&a.getTime()>=n.getTime()||r.getTime()<s.getTime()&&a.getTime()>=n.getTime()||(r.getTime()<=s.getTime()&&a.getTime()>=s.getTime()&&a.getTime()<n.getTime()||a.getTime()<s.getTime()&&this.checkStartDate(a).getTime()===s.getTime()?d.to=n:a.getTime()<s.getTime()&&this.checkStartDate(a).getTime()!==s.getTime()&&o.push(i[p]))):o.push(i[p]);return t&&(o=this.splitRangeCollection(o)),o},t.prototype.setSortedChildTasks=function(e){return new sf.data.DataManager(e.childRecords).executeLocal((new sf.data.Query).sortBy(this.parent.taskFields.startDate,"Ascending"))},t.prototype.splitRangeCollection=function(e,t,i){var r;return"Week"===(r=this.parent.timelineModule.isSingleTier?"None"!==this.parent.timelineModule.bottomTier?this.parent.timelineModule.bottomTier:this.parent.timelineModule.topTier:this.parent.timelineModule.bottomTier)||"Month"===r||"Year"===r?e:"Day"===r||0===this.parent.workingTimeRanges[0].from&&86400===this.parent.workingTimeRanges[0].to?this.getRangeWithWeek(e,t,i):this.getRangeWithDay(e,t,i)},t.prototype.getRangeWithDay=function(e,t,i){for(var r=[],a=0;a<e.length;a++)r.push.apply(r,this.splitRangeForDayMode(e[a],t,i));return r},t.prototype.splitRangeForDayMode=function(e,t,i){var r=t||"from",a=i||"to",s=(new Date(e[r]),new Date(e[r])),n=new Date(e[a]),o=[],d={};if(s.getTime()<n.getTime())do{for(var l=new Date(s.getTime()),p=new Date(s.getTime()),h=0,c=this.parent.dataOperation.getSecondsInDecimal(s),u=-1,f=0;f<this.parent.workingTimeRanges.length;f++){var g=this.parent.workingTimeRanges[f];if(c>=g.from&&c<=g.to){u=f;break}}-1!==u&&(h=Math.round(this.parent.workingTimeRanges[u].to-c),p.setSeconds(p.getSeconds()+h));p.getTime()<n.getTime()?(d={},e.task&&(d.task=sf.base.extend([],e.task)),d[r]=l,d[a]=p,d.isSplit=!0,o.push(d)):(d={},e.task&&(d.task=sf.base.extend([],e.task)),d[r]=l,d[a]=n,d.isSplit=!0,o.push(d)),s=this.checkStartDate(p)}while(s.getTime()<n.getTime());else o.push(e);return o},t.prototype.getRangeWithWeek=function(e,t,i){for(var r=[],a=0;a<e.length;a++)r.push.apply(r,this.splitRangeForWeekMode(e[a],t,i));return r},t.prototype.splitRangeForWeekMode=function(e,t,i){var r=t||"from",a=i||"to",s=new Date(e[r]),n=new Date(e[r]),o=new Date(e[a]),d=!1,l=[],p={};if(n.setDate(n.getDate()+1),n.getTime()<o.getTime()){do{if(this.parent.dataOperation.isOnHolidayOrWeekEnd(n,null)){var h=new Date(n.getTime());h.setDate(n.getDate()-1),this.setTime(this.parent.defaultEndTime,h),(p={})[r]=s,p.isSplit=!0,p[a]=h,e.task&&(p.task=sf.base.extend([],e.task,!0)),s.getTime()!==h.getTime()&&l.push(p),s=this.checkStartDate(h),n=new Date(s.getTime()),d=!0}else n.setDate(n.getDate()+1)}while(n.getTime()<o.getTime());d?s.getTime()!==o.getTime()&&(p={},e.task&&(p.task=sf.base.extend([],e.task,!0)),p[r]=s,p[a]=o,p.isSplit=!0,l.push(p)):l.push(e)}else l.push(e);return l},t.prototype.updateGanttData=function(){for(var e=this.parent.flatData,t=e.length,i=0;i<t;i++){var r=e[i];this.updateTaskLeftWidth(r)}},t.prototype.updateTaskLeftWidth=function(e){var t=e.ganttProperties;e.hasChildRecords||this.updateWidthLeft(e),this.parent.setRecordValue("baselineLeft",this.calculateBaselineLeft(t),t,!0),this.parent.setRecordValue("baselineWidth",this.calculateBaselineWidth(t),t,!0);var i,r=[];e.parentItem&&(r=(i=this.parent.getParentTask(e.parentItem)).childRecords),i&&r.indexOf(e)===r.length-1&&!e.hasChildRecords&&this.parent.enableValidation?this.updateParentItems(i):i&&!this.parent.enableValidation&&this.updateWidthLeft(i)},t.prototype.reUpdateGanttDataPosition=function(){for(var e=this.parent.flatData,t=e.length,i=0;i<t;i++){var r=e[i],a=r.ganttProperties;this.updateWidthLeft(r),"Auto"!==this.parent.taskMode&&r.hasChildRecords&&this.updateAutoWidthLeft(r),this.parent.setRecordValue("baselineLeft",this.calculateBaselineLeft(a),a,!0),this.parent.setRecordValue("baselineWidth",this.calculateBaselineWidth(a),a,!0),this.parent.dataOperation.updateTaskData(r)}},t.prototype.updateWidthLeft=function(e){var t=e.ganttProperties;if(!sf.base.isNullOrUndefined(t.segments)&&t.segments.length>0){for(var i=t.segments,r=!0,a=this.splitTasksDuration(i)*this.parent.perDayWidth,s=this.parent.dataOperation.getProgressWidth(a,t.progress),n=0;n<i.length;n++){var o=i[n];if(0===n&&!sf.base.isNullOrUndefined(t.startDate)&&o.startDate.getTime()!==t.startDate.getTime()){o.startDate=t.startDate;var d=this.parent.dataOperation.getEndDate(o.startDate,o.duration,t.durationUnit,t,!1);o.endDate=this.parent.dataOperation.checkEndDate(d,t,!1),this.parent.chartRowsModule.incrementSegments(i,0,e)}if(o.width=this.getSplitTaskWidth(o.startDate,o.duration,e),o.showProgress=!1,o.progressWidth=-1,0!==n){var l=new Date(t.startDate.getTime());o.left=this.getSplitTaskLeft(o.startDate,l)}s>0&&s>o.width?(s-=o.width,o.progressWidth=o.width,o.showProgress=!1):r&&(o.progressWidth=s,o.showProgress=!0,s-=o.width,r=!1)}this.parent.setRecordValue("segments",t.segments,t,!0),this.parent.dataOperation.updateMappingData(e,"segments")}this.parent.setRecordValue("width",this.parent.dataOperation.calculateWidth(e),t,!0),this.parent.setRecordValue("left",this.parent.dataOperation.calculateLeft(t),t,!0),this.parent.setRecordValue("progressWidth",this.parent.dataOperation.getProgressWidth(t.isAutoSchedule||!e.hasChildRecords?t.width:t.autoWidth,t.progress),t,!0)},t.prototype.updateAutoWidthLeft=function(e){var t=e.ganttProperties;this.parent.setRecordValue("autoWidth",this.calculateWidth(e,!0),t,!0),this.parent.setRecordValue("autoLeft",this.calculateLeft(t,!0),t,!0)},t.prototype.getParentProgress=function(e){var t=0,i={};switch(e.ganttProperties.durationUnit){case"hour":t=e.ganttProperties.duration/(this.parent.secondsPerDay/3600);break;case"minute":t=e.ganttProperties.duration/(this.parent.secondsPerDay/60);break;default:t=e.ganttProperties.duration}return e.hasChildRecords?(sf.base.setValue("totalProgress",e.ganttProperties.totalProgress,i),sf.base.setValue("totalDuration",e.ganttProperties.totalDuration,i)):(sf.base.setValue("totalProgress",e.ganttProperties.progress*t,i),sf.base.setValue("totalDuration",t,i)),i},t.prototype.resetDependency=function(e){var t=this.parent.taskFields.dependency;if(!sf.base.isNullOrUndefined(t)){var i=e.ganttProperties;this.parent.setRecordValue("predecessor",[],i,!0),this.parent.setRecordValue("predecessorsName",null,i,!0),this.parent.setRecordValue("taskData."+t,null,e),this.parent.setRecordValue(t,null,e)}},t.prototype.updateParentItems=function(e,t){var i=t?e:this.parent.getParentTask(e),a=!1,s=i.ganttProperties;if(i.childRecords.length>0){for(var n=s.isAutoSchedule?s.startDate:s.autoStartDate,o=s.isAutoSchedule?s.endDate:s.autoEndDate,d=i.childRecords,l=d.length,p=0,h={},c=null,u=null,f=0,g=0,m=0,y=void 0,b=0;b<l;b++)if(y=d[b],this.parent.isOnDelete&&y.isDelete){if(1===l&&"ProjectView"===this.parent.viewType){if(sf.base.isBlazor()){var v=i.ganttProperties.rowUniqueID,D=this.parent.getRecordByID(v);D&&-1===this.parent.editedRecords.indexOf(D)&&this.parent.editedRecords.push(D)}a=!0}}else{var w=this.getValidStartDate(y.ganttProperties),k=this.getValidEndDate(y.ganttProperties);sf.base.isNullOrUndefined(c)&&(c=this.getDateFromFormat(w)),sf.base.isNullOrUndefined(u)&&(u=this.getDateFromFormat(k)),sf.base.isNullOrUndefined(k)||1!==this.compareDates(k,u)||(u=this.getDateFromFormat(k)),sf.base.isNullOrUndefined(w)||-1!==this.compareDates(w,c)||(c=this.getDateFromFormat(w)),!y.ganttProperties.isMilestone&&r(y.ganttProperties)?(h=this.getParentProgress(y),g+=sf.base.getValue("totalProgress",h),p+=sf.base.getValue("totalDuration",h)):f++,m+=y.ganttProperties.work}if(!a){0!==this.compareDates(n,c)&&this.parent.setRecordValue(s.isAutoSchedule?"startDate":"autoStartDate",c,i.ganttProperties,!0),0!==this.compareDates(o,u)&&this.parent.setRecordValue(s.isAutoSchedule?"endDate":"autoEndDate",u,i.ganttProperties,!0);var T=void 0,S=(T=this.parent.isOnDelete&&y.isDelete?l-f-1:l-f)>0&&p>0?g/p:0,P=i.ganttProperties,C=!(0!==T||!c||!u||c.getTime()!==u.getTime());this.parent.setRecordValue("isMilestone",C,P,!0),P.isAutoSchedule&&this.calculateDuration(i),this.updateWorkWithDuration(i);var x=P.work;x+=m,this.parent.setRecordValue("work",x,P,!0),this.parent.setRecordValue("taskType","FixedDuration",P,!0),sf.base.isNullOrUndefined(this.parent.taskFields.type)||this.updateMappingData(i,"type"),this.parent.setRecordValue("progress",Math.floor(S),P,!0),this.parent.setRecordValue("totalProgress",g,P,!0),this.parent.setRecordValue("totalDuration",p,P,!0),P.isAutoSchedule||(this.parent.setRecordValue("autoDuration",this.calculateAutoDuration(P),P,!0),this.updateAutoWidthLeft(i)),this.resetDependency(i),this.updateWidthLeft(i),this.updateTaskData(i)}}a&&1===i.childRecords.length&&0===i.ganttProperties.duration&&(this.parent.setRecordValue("isMilestone",!0,i.ganttProperties,!0),this.updateWidthLeft(i),this.updateTaskData(i));var R=this.parent.getParentTask(i.parentItem);R&&this.updateParentItems(R),a=!1},t}(F),L="e-timeline-single-header-outer-div",N="e-left-label-container",B="e-right-label-container",A="e-taskbar-main-container",W="e-task-label",H="e-gantt-child-progressbar-inner-div",j="e-baseline-bar",G="e-chart-row",q="e-child-progress-resizer",z="e-gantt-child-taskbar",_="e-gantt-manualparenttaskbar",X="e-label",Y="e-connectorpoint-left",Z=".e-content",Q=function(){function e(e){this.previousScroll={top:0,left:0},this.parent=e,this.element=this.parent.ganttChartModule.scrollElement,this.addEventListeners()}return e.prototype.addEventListeners=function(){this.parent.on("grid-scroll",this.gridScrollHandler,this),sf.base.EventHandler.add(this.element,"scroll",this.onScroll,this)},e.prototype.removeEventListeners=function(){sf.base.EventHandler.remove(this.element,"scroll",this.onScroll),this.parent.off("grid-scroll",this.gridScrollHandler)},e.prototype.gridScrollHandler=function(e){this.element.scrollTop=sf.base.getValue("top",e),this.isFromTreeGrid=!0},e.prototype.updateTopPosition=function(){var e,t=this.parent.treeGrid.element.querySelector(".e-content").scrollTop;this.parent.virtualScrollModule&&this.parent.enableVirtualization?e=t-this.parent.virtualScrollModule.getTopPosition():e=t;if(!sf.base.isNullOrUndefined(this.parent.dayMarkersModule)){var i=sf.base.getValue("nonworkingDayRender.holidayContainer",this.parent.dayMarkersModule),r=sf.base.getValue("nonworkingDayRender.weekendContainer",this.parent.dayMarkersModule),a=sf.base.getValue("eventMarkerRender.eventMarkersContainer",this.parent.dayMarkersModule);i&&(i.style.top=sf.base.formatUnit(e)),r&&(r.style.top=sf.base.formatUnit(e)),a&&(a.style.top=sf.base.formatUnit(e))}this.parent.chartVerticalLineContainer&&(this.parent.chartVerticalLineContainer.style.top=sf.base.formatUnit(e))},e.prototype.onScroll=function(){var e={};this.element.scrollTop!==this.previousScroll.top&&(this.isFromTreeGrid?this.isFromTreeGrid=!1:this.parent.notify("chartScroll",{top:this.element.scrollTop}),e.previousScrollTop=this.previousScroll.top,this.previousScroll.top=this.element.scrollTop,e.scrollTop=this.element.scrollTop,e.scrollDirection="Vertical",e.action="VerticalScroll",this.updateTopPosition()),this.element.scrollLeft!==this.previousScroll.left&&(this.parent.ganttChartModule.chartTimelineContainer.scrollLeft=this.element.scrollLeft,e.previousScrollLeft=this.previousScroll.left,this.previousScroll.left=this.element.scrollLeft,e.scrollLeft=this.element.scrollLeft,e.scrollDirection="Horizontal",e.action="HorizontalScroll"),e.requestType="scroll",this.parent.trigger("actionComplete",e)},e.prototype.setHeight=function(e){this.element.style.height=sf.base.formatUnit(e)},e.prototype.setWidth=function(e){this.element.style.width=sf.base.formatUnit(e)},e.prototype.setScrollTop=function(e){this.element.scrollTop=e},e.prototype.setScrollLeft=function(e){this.element.scrollLeft=e,this.parent.ganttChartModule.chartTimelineContainer.scrollLeft=this.element.scrollLeft,this.previousScroll.left=this.element.scrollLeft},e.prototype.destroy=function(){this.removeEventListeners()},e}(),K=function(){function e(e){this.parent=e}return e.prototype.renderWrapper=function(e){this.wrapper=sf.base.createElement("div",{className:"e-virtualtable",styles:"min-height:"+sf.base.formatUnit(e)}),this.parent.ganttChartModule.chartBodyContent.appendChild(this.wrapper),this.appendChildElements(this.parent.chartRowsModule.taskTable)},e.prototype.appendChildElements=function(e){this.wrapper.appendChild(e)},e.prototype.adjustTable=function(){var e=this.parent.treeGrid.getContent().querySelector(".e-content").querySelector(".e-virtualtable");this.parent.ganttChartModule.virtualRender.wrapper.style.transform=e.style.transform},e}(),J=function(){function e(e){this.isExpandCollapseFromChart=!1,this.isExpandAll=!1,this.isGanttElement=!1,this.parent=e,this.chartTimelineContainer=null,this.rangeViewContainer=sf.base.createElement("div",{className:"e-rangecontainer"}),this.virtualRender=new K(this.parent),this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.on("renderPanels",this.renderChartContainer,this),this.parent.on("recordsUpdated",this.renderChartElements,this),this.parent.on("dataReady",this.renderInitialContents,this),this.parent.on("tree-grid-created",this.renderChartContents,this),this.parent.on("destroy",this.destroy,this)},e.prototype.renderChartContents=function(){this.parent.notify("refreshDayMarkers",{}),this.wireEvents()},e.prototype.renderChartContainer=function(){this.chartElement=sf.base.createElement("div",{id:this.parent.element.id+"GanttChart",className:"e-gantt-chart"}),this.parent.chartPane.appendChild(this.chartElement),this.renderTimelineContainer(),this.renderBodyContainers()},e.prototype.renderInitialContents=function(){this.parent.timelineModule.createTimelineSeries()},e.prototype.renderOverAllocationContainer=function(){for(var e=0;e<this.parent.flatData.length;e++){var t=this.parent.flatData[e];t.childRecords.length>0&&this.parent.dataOperation.updateOverlappingValues(t)}var i=this.parent.element.querySelector(".e-rangecontainer");i&&(i.innerHTML=""),0===this.parent.treeGrid.grid.filterSettings.columns.length&&this.renderRangeContainer(this.parent.flatData)},e.prototype.renderChartElements=function(){this.parent.chartRowsModule.renderChartRows(),this.parent.predecessorModule&&this.parent.taskFields.dependency&&(this.parent.connectorLineIds=[],this.parent.updatedConnectorLineCollection=[],this.parent.predecessorModule.createConnectorLinesCollection()),this.parent.connectorLineModule.renderConnectorLines(this.parent.updatedConnectorLineCollection),"ResourceView"===this.parent.viewType&&this.parent.showOverAllocation&&this.renderOverAllocationContainer(),this.updateWidthAndHeight(),this.setOverflowStyle(),this.parent.notify("selectRowByIndex",{})},e.prototype.setOverflowStyle=function(){var e=this.chartBodyContent;e.style.overflow=this.scrollElement.offsetHeight>e.offsetHeight?"hidden":"visible"},e.prototype.renderRangeContainer=function(e){var t,i,r,a=e.length;if(0===this.parent.treeGrid.grid.filterSettings.columns.length)for(t=0;t<a;t++)(r=(i=e[t]).ganttProperties.workTimelineRanges)&&this.renderRange(r,i)},e.prototype.getTopValue=function(e){var t=this.parent.getExpandedRecords(this.parent.currentViewData).indexOf(e);return e.expanded?(t+1)*this.parent.rowHeight:t*this.parent.rowHeight},e.prototype.getRangeHeight=function(e){return!e.expanded&&e.hasChildRecords?this.parent.rowHeight-Math.floor(this.parent.rowHeight-this.parent.chartRowsModule.taskBarHeight):e.childRecords.length*this.parent.rowHeight-Math.floor(this.parent.rowHeight-this.parent.chartRowsModule.taskBarHeight)},e.prototype.renderRange=function(e,t){var i=this.getTopValue(t),r=this.rangeViewContainer.querySelector(".rangeContainer"+t.ganttProperties.rowUniqueID);r&&r.remove();var a=sf.base.createElement("div",{className:"rangeContainer"+t.ganttProperties.rowUniqueID,styles:"top:"+i+"px; position: absolute;"});if(0!==t.level||t.expanded||!sf.base.isNullOrUndefined(t.parentItem)||this.parent.enableMultiTaskbar){for(var s=0;s<e.length;s++){var n=this.getRangeHeight(t),o=sf.base.createElement("div",{className:"e-rg-rangdiv e-leftarc",styles:"left:"+e[s].left+"px;\n                top: "+Math.floor((this.parent.rowHeight-this.parent.chartRowsModule.taskBarHeight)/2)+"px;\n                height: "+(n+1)+"px; border-right: 0px"}),d=sf.base.createElement("div",{className:"e-rg-rangdiv e-rightarc",styles:"left:"+(e[s].left+e[s].width-5)+"px;\n                top: "+Math.floor((this.parent.rowHeight-this.parent.chartRowsModule.taskBarHeight)/2)+"px; height: "+(n+1)+"px;\n                border-left: 0px"});a.appendChild(o),a.appendChild(d),this.rangeViewContainer.appendChild(a)}this.parent.ganttChartModule.chartBodyContent.appendChild(this.rangeViewContainer)}},e.prototype.renderTimelineContainer=function(){this.chartTimelineContainer=sf.base.createElement("div",{className:"e-timeline-header-container"}),this.chartElement.appendChild(this.chartTimelineContainer)},e.prototype.renderBodyContainers=function(){this.chartBodyContainer=sf.base.createElement("div",{className:"e-chart-root-container"}),this.chartElement.appendChild(this.chartBodyContainer),this.scrollElement=sf.base.createElement("div",{className:"e-chart-scroll-container e-content",styles:"position:relative;"}),this.chartBodyContainer.appendChild(this.scrollElement),this.chartBodyContent=sf.base.createElement("div",{className:"e-chart-rows-container",styles:"position:relative; "}),this.scrollElement.appendChild(this.chartBodyContent),this.scrollObject=new Q(this.parent);var e=0;sf.base.isNullOrUndefined(this.parent.toolbarModule)||sf.base.isNullOrUndefined(this.parent.toolbarModule.element)||(e=this.parent.toolbarModule.element.offsetHeight),this.scrollObject.setHeight(this.parent.ganttHeight-this.chartTimelineContainer.offsetHeight-e)},e.prototype.updateWidthAndHeight=function(){var e=sf.base.isBlazor()?39:36,t=0===this.parent.contentHeight?e:this.parent.contentHeight;this.chartBodyContent.style.height=sf.base.formatUnit(t),this.chartBodyContent.style.width=sf.base.formatUnit(this.parent.timelineModule.totalTimelineWidth),this.parent.notify("updateHeight",{}),this.parent.updateGridLineContainerHeight(),this.updateLastRowBottomWidth()},e.prototype.updateLastRowBottomWidth=function(){if(this.parent.currentViewData.length>0&&"auto"!==this.parent.height){var e=this.parent.getExpandedRecords(this.parent.currentViewData),t=e[e.length-1],i=this.parent.currentViewData.indexOf(t),r=this.parent.getRowByIndex(i),a=this.parent.chartRowsModule.ganttChartTableBody;a.querySelectorAll(".e-chart-row-cell.e-chart-row-border.e-lastrow")&&sf.base.removeClass(a.querySelectorAll(".e-chart-row-cell.e-chart-row-border.e-lastrow"),"e-lastrow"),this.chartBodyContent.clientHeight<this.chartBodyContainer.clientHeight&&r&&(sf.base.addClass(r.querySelectorAll("td"),"e-lastrow"),this.chartBodyContent.style.height=sf.base.formatUnit(this.parent.contentHeight+1))}},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("renderPanels",this.renderChartContainer),this.parent.off("recordsUpdated",this.renderChartElements),this.parent.off("dataReady",this.renderInitialContents),this.parent.off("tree-grid-created",this.renderChartContents),this.parent.off("destroy",this.destroy))},e.prototype.ganttChartMouseDown=function(e){3!==e.which&&(this.parent.notify("chartMouseDown",e),this.parent.element.tabIndex=0)},e.prototype.ganttChartMouseClick=function(e){this.parent.autoFocusTasks&&this.scrollToTarget(e),this.parent.notify("chartMouseClick",e)},e.prototype.ganttChartMouseUp=function(e){this.parent.notify("chartMouseUp",e)},e.prototype.scrollToTarget=function(e){var t=sf.base.closest(e.target,"tr");if(t&&this.parent.element.contains(t)&&(this.parent.element.querySelectorAll(".e-chart-rows-container")[0].contains(e.target)||this.parent.element.querySelectorAll(".e-gridcontent")[0].contains(e.target))&&this.parent.currentViewData.length>0){var i=sf.base.getValue("rowIndex",sf.base.closest(e.target,"tr")),r=this.parent.currentViewData[i].ganttProperties.startDate;if(!sf.base.isNullOrUndefined(r)){var a=this.parent.dataOperation.getTaskLeft(r,!1);this.parent.autoFocusTasks&&this.updateScrollLeft(a)}}},e.prototype.updateScrollLeft=function(e){e=e>0?e:0,e=this.scrollElement.scrollWidth<=e?this.scrollElement.scrollWidth:e,(this.scrollElement.offsetWidth+this.parent.ganttChartModule.scrollElement.scrollLeft<e||this.scrollElement.scrollLeft>e)&&this.scrollObject.setScrollLeft(e-50)},e.prototype.mouseUp=function(e){this.isGanttElement||this.parent.notify("chartMouseUp",e),this.isGanttElement=!1},e.prototype.documentMouseUp=function(e){if(this.isGanttElement=!0,this.parent.allowRowDragAndDrop){var t=this.parent.element.querySelector(".e-ganttdrag");t&&t.remove()}if(!this.parent.isDestroyed&&3!==e.which){var i=!1;if(this.parent.editSettings.allowTaskbarEditing&&sf.base.getValue("editModule.taskbarEditModule.isMouseDragged",this.parent)&&sf.base.getValue("editModule.taskbarEditModule.taskBarEditAction",this.parent)&&(i=!0),this.parent.notify("chartMouseUp",e),this.parent.showActiveElement&&this.focusedElement&&!e.target.classList.contains("e-split-bar")&&(this.focusedElement.tabIndex=0===this.focusedElement.tabIndex?-1:this.focusedElement.tabIndex,sf.base.removeClass([this.focusedElement],"e-active-container")),!i){var r=e.target,a=e.target.classList.contains(A)||sf.base.closest(e.target,"."+A);sf.base.closest(r,".e-gantt-parent-taskbar")?this.chartExpandCollapseRequest(e):!a&&this.parent.autoFocusTasks&&this.scrollToTarget(e)}if(this.parent.editModule&&this.parent.editModule.taskbarEditModule&&this.parent.editModule.taskbarEditModule.removeFalseLine(!0),!sf.base.isNullOrUndefined(this.parent.onTaskbarClick)&&!i){r=e.target;var s=sf.base.closest(r,".e-gantt-parent-taskbar,.e-gantt-child-taskbar,.e-gantt-milestone");s&&this.onTaskbarClick(e,r,s)}}},e.prototype.onTaskbarClick=function(e,t,i){var r=sf.base.closest(t,"tr"),a=sf.base.getValue("rowIndex",r),s={data:this.getRecordByTarget(e),taskbarElement:i,rowIndex:a,target:t};this.parent.trigger("onTaskbarClick",s)},e.prototype.ganttChartLeave=function(e){this.parent.notify("chartMouseLeave",e)},e.prototype.ganttChartMove=function(e){this.parent.notify("chartMouseMove",e),!sf.base.isNullOrUndefined(this.parent.taskFields.dependency)&&this.parent.connectorLineEditModule&&this.parent.connectorLineEditModule.updateConnectorLineEditElement(e)},e.prototype.contextClick=function(e){this.parent.allowFiltering&&this.parent.filterModule&&this.parent.filterModule.closeFilterOnContextClick(e.srcElement)},e.prototype.mouseMoveHandler=function(e){if(!sf.base.isNullOrUndefined(this.parent.onMouseMove)&&(this.parent.flatData.length||e.target.classList.contains("e-header-cell-label")||e.target.classList.contains("e-headercell"))){var t=e.target,i={originalEvent:e},r=sf.base.closest(t,".e-chart-row-cell,.e-connector-line-container,.e-event-markers,.e-header-cell-label,.e-rowcell,.e-headercell,.e-indicator-span");if(r){var a,s=void 0,n=sf.base.closest(t,".e-rowcell,.e-chart-row-cell"),o=sf.base.closest(t,".e-rowcell,.e-headercell");if(n&&(s=this.parent.ganttChartModule.getRecordByTarget(e),i.data=s),o){var d=sf.base.getValue("cellIndex",o);i.column=this.parent.treeGrid.columns[d]}if(sf.base.closest(t,".e-indicator-span")){var l=0,p=s.ganttProperties.indicators;if(p.length>1)for(l=0;l<p.length&&p[l].name!==r.innerText.trim();l++);i.indicator=p[l]}if(sf.base.closest(t,".e-connector-line-container"))(a={}).target=r,i.predecessor=this.parent.tooltipModule.getPredecessorTooltipData(a);if(sf.base.closest(t,".e-event-markers"))(a={}).target=r,i.eventMarkers=this.parent.tooltipModule.getMarkerTooltipData(a);t.classList.contains("e-header-cell-label")&&(i.date=new Date(t.dataset.content))}this.parent.trigger("onMouseMove",i)}},e.prototype.doubleClickHandler=function(e){this.parent.notify("chartDblClick",e);var t=e.target,i=sf.base.closest(t,"tr"),r=sf.base.getValue("rowIndex",i),a={row:i,rowData:this.parent.ganttChartModule.getRecordByTarget(e),rowIndex:r,target:t};this.recordDoubleClick(a)},e.prototype.recordDoubleClick=function(e){this.parent.trigger("recordDoubleClick",e)},e.prototype.getRecordByTarget=function(e){var t,i=sf.base.closest(e.target,"div."+A);if(sf.base.isNullOrUndefined(i)){if(i=sf.base.closest(e.target,"tr")){var r=sf.base.getValue("rowIndex",sf.base.closest(e.target,"tr"));t=this.parent.currentViewData[r]}}else{var a=i.getAttribute("rowUniqueId");t=this.parent.getRecordByID(a)}return t},e.prototype.getChartRows=function(){return document.getElementById(this.parent.element.id+"GanttTaskTableBody").querySelectorAll(".e-chart-row")},e.prototype.chartExpandCollapseRequest=function(e){if(!this.parent.enableMultiTaskbar){var t=e.target,i=sf.base.closest(t,".e-gantt-parent-taskbar"),r=this.getRecordByTarget(e),a=sf.base.closest(t,"tr"),s=sf.base.getValue("rowIndex",a),n={data:r,gridRow:this.parent.treeGrid.getRows()[s],chartRow:a,cancel:!1};this.isExpandCollapseFromChart=!0,i.classList.contains("e-row-expand")?this.collapseGanttRow(n):i.classList.contains("e-row-collapse")&&this.expandGanttRow(n)}},e.prototype.reRenderConnectorLines=function(){this.parent.connectorLineModule.dependencyViewContainer.innerHTML="",this.parent.connectorLineIds=[],this.parent.updatedConnectorLineCollection=[],this.parent.predecessorModule.createConnectorLinesCollection(),this.parent.connectorLineModule.renderConnectorLines(this.parent.updatedConnectorLineCollection)},e.prototype.collapseGanttRow=function(e,t){var i=this;t?this.collapsedGanttRow(e):this.parent.trigger("collapsing",e,(function(e){i.isExpandCollapseFromChart&&!sf.base.getValue("cancel",e)&&(sf.base.isBlazor()&&(sf.base.setValue("chartRow",sf.base.getElement(sf.base.getValue("chartRow",e)),e),sf.base.setValue("gridRow",sf.base.getElement(sf.base.getValue("gridRow",e)),e)),i.collapsedGanttRow(e)),i.isExpandCollapseFromChart=!1}))},e.prototype.collapsedGanttRow=function(e){var t=sf.base.getValue("data",e);this.isExpandCollapseFromChart?(this.expandCollapseChartRows("collapse",sf.base.getValue("chartRow",e),t,null),this.parent.treeGrid.collapseRow(sf.base.getValue("gridRow",e),t),this.isExpandCollapseFromChart=!1):this.expandCollapseChartRows("collapse",sf.base.getValue("chartRow",e),t,null),"ResourceView"===this.parent.viewType&&this.renderMultiTaskbar(t),this.parent.enableVirtualization||this.parent.updateContentHeight(),this.updateWidthAndHeight(),this.reRenderConnectorLines(),sf.base.getValue("chartRow",e).setAttribute("aria-expanded","false"),this.parent.trigger("collapsed",e)},e.prototype.expandGanttRow=function(e,t){var i=this;t?this.expandedGanttRow(e):this.parent.trigger("expanding",e,(function(e){sf.base.isBlazor()&&(sf.base.setValue("chartRow",sf.base.getElement(sf.base.getValue("chartRow",e)),e),sf.base.setValue("gridRow",sf.base.getElement(sf.base.getValue("gridRow",e)),e)),i.isExpandCollapseFromChart&&!sf.base.getValue("cancel",e)&&i.expandedGanttRow(e),i.isExpandCollapseFromChart=!1}))},e.prototype.expandedGanttRow=function(e){var t=sf.base.getValue("data",e);this.isExpandCollapseFromChart?(this.expandCollapseChartRows("expand",sf.base.getValue("chartRow",e),t,null),this.parent.treeGrid.expandRow(sf.base.getValue("gridRow",e),t),this.isExpandCollapseFromChart=!1):this.expandCollapseChartRows("expand",sf.base.getValue("chartRow",e),t,null),"ResourceView"===this.parent.viewType&&this.renderMultiTaskbar(t),this.parent.enableVirtualization||this.parent.updateContentHeight(),this.updateWidthAndHeight(),this.reRenderConnectorLines(),sf.base.getValue("chartRow",e).setAttribute("aria-expanded","true"),this.parent.trigger("expanded",e)},e.prototype.renderMultiTaskbar=function(e){this.parent.enableMultiTaskbar?this.parent.chartRowsModule.refreshRecords([e],!0):this.parent.showOverAllocation&&this.parent.ganttChartModule.renderRangeContainer(this.parent.currentViewData)},e.prototype.expandCollapseChartRows=function(e,t,i,r){var a;if("expand"===e){a="table-row",r||(i.expanded=!0);for(var s=t.querySelectorAll(".e-row-collapse"),n=0;n<s.length;n++)sf.base.addClass([s[n]],"e-row-expand"),sf.base.removeClass([s[n]],"e-row-collapse")}else if("collapse"===e){a="none",r||(i.expanded=!1);for(s=t.querySelectorAll(".e-row-expand"),n=0;n<s.length;n++)sf.base.addClass([s[n]],"e-row-collapse"),sf.base.removeClass([s[n]],"e-row-expand")}for(var o=i.childRecords,d=this.getChartRows(),l=[],p=0;p<d.length;p++)d[p].classList.contains("gridrowtaskId"+i.ganttProperties.rowUniqueID+"level"+(i.level+1))&&l.push(d[p]);for(p=0;p<l.length;p++)l[p].style.display=a,o[p].childRecords&&o[p].childRecords.length&&("collapse"===e||o[p].expanded||this.isExpandAll)&&this.expandCollapseChartRows(e,l[p],o[p],!0)},e.prototype.expandCollapseAll=function(e){"expand"===e?(this.isExpandAll=!0,this.parent.treeGrid.expandAll()):this.parent.treeGrid.collapseAll(),this.isExpandAll=!1,this.parent.element.querySelector(".e-treegrid").focus()},e.prototype.expandAtLevel=function(e){this.parent.treeGrid.expandAtLevel(e)},e.prototype.collapseAtLevel=function(e){this.parent.treeGrid.collapseAtLevel(e)},e.prototype.wireEvents=function(){var e=sf.base.Browser.isPointer,t=sf.base.Browser.touchStartEvent,i=sf.base.Browser.touchEndEvent,r=sf.base.Browser.touchMoveEvent,a=e?"pointerleave":"mouseleave";this.parent.editSettings.allowTaskbarEditing&&(sf.base.EventHandler.add(this.parent.chartPane,t,this.ganttChartMouseDown,this),sf.base.EventHandler.add(this.parent.chartPane,a,this.ganttChartLeave,this),sf.base.EventHandler.add(this.parent.chartPane,r,this.ganttChartMove,this),this.parent.isAdaptive&&(sf.base.EventHandler.add(this.parent.chartPane,sf.grids.click,this.ganttChartMouseClick,this),sf.base.EventHandler.add(this.parent.chartPane,i,this.ganttChartMouseUp,this))),this.parent.isAdaptive||(sf.base.EventHandler.add(this.parent.element,i,this.documentMouseUp,this),sf.base.EventHandler.add(document,i,this.mouseUp,this)),sf.base.EventHandler.add(this.parent.element,"mousemove",this.mouseMoveHandler,this),sf.base.EventHandler.add(document.body,"contextmenu",this.contextClick,this),sf.base.EventHandler.add(document,"mouseup",this.contextClick,this),sf.base.EventHandler.add(this.parent.chartRowsModule.ganttChartTableBody,"dblclick",this.doubleClickHandler,this)},e.prototype.unWireEvents=function(){var e=sf.base.Browser.isPointer,t=sf.base.Browser.touchStartEvent,i=sf.base.Browser.touchEndEvent,r=sf.base.Browser.touchMoveEvent,a=e?"pointerleave":"mouseleave";this.parent.editSettings.allowTaskbarEditing&&(sf.base.EventHandler.remove(this.parent.chartRowsModule.ganttChartTableBody,t,this.ganttChartMouseDown),sf.base.EventHandler.remove(this.parent.chartPane,a,this.ganttChartLeave),sf.base.EventHandler.remove(this.parent.chartPane,r,this.ganttChartMove),this.parent.isAdaptive&&(sf.base.EventHandler.remove(this.parent.chartPane,sf.grids.click,this.ganttChartMouseClick),sf.base.EventHandler.remove(this.parent.chartPane,i,this.ganttChartMouseUp))),this.parent.isAdaptive||(sf.base.EventHandler.remove(this.parent.element,i,this.documentMouseUp),sf.base.EventHandler.remove(document,i,this.mouseUp)),sf.base.EventHandler.remove(this.parent.element,"mousemove",this.mouseMoveHandler),sf.base.EventHandler.remove(document.body,"contextmenu",this.contextClick),sf.base.EventHandler.remove(document,"mouseup",this.contextClick),sf.base.EventHandler.remove(this.parent.chartRowsModule.ganttChartTableBody,"dblclick",this.doubleClickHandler)},e.prototype.getRecordByTaskBar=function(e){return this.parent.currentViewData[this.getIndexByTaskBar(e)]},e.prototype.onTabAction=function(e){this.parent.treeGrid.grid.enableHeaderFocus=this.parent.enableHeaderFocus;var t=this.parent.editModule&&this.parent.editModule.cellEditModule&&this.parent.editModule.cellEditModule.isCellEdit;if(this.parent.showActiveElement||t){var i=t?e.target.closest(".e-rowcell"):e.target;(i.closest(".e-rowcell")||i.closest(".e-chart-row"))&&this.parent.focusModule.setActiveElement(i),this.focusedRowIndex=i.closest(".e-rowcell")?i.parentElement.rowIndex:i.closest(".e-chart-row")?i.closest(".e-chart-row").rowIndex:-1;var r="tab"===e.action,a=this.getNextElement(i,r);if("noNextRow"!==a){if("string"!=typeof a&&((i.classList.contains("e-rowcell")||i.closest(".e-chart-row-cell")||i.classList.contains("e-headercell")||i.closest(".e-segmented-taskbar"))&&e.preventDefault(),(i.classList.contains("e-rowcell")&&a&&a.classList.contains("e-rowcell")||i.classList.contains("e-headercell"))&&this.parent.treeGrid.grid.notify("key-pressed",e),!t&&a)){if(i.classList.contains("e-rowcell")?this.manageFocus(i,"remove",!1):this.manageFocus(i,"remove",!0),a.classList.contains("e-rowcell")){if(!i.classList.contains("e-rowcell")){this.parent.treeGrid.grid.notify("key-pressed",e);var s=sf.base.getValue("focusModule",this.parent.treeGrid.grid);s.currentInfo.element=a,s.currentInfo.elementToFocus=a,s.content.matrix.current=[a.parentElement.rowIndex,a.cellIndex]}this.manageFocus(a,"add",!1)}else this.manageFocus(a,"add",!0);this.parent.focusModule.setActiveElement(a)}}else this.manageFocus(i,"remove",!0)}},e.prototype.getNextElement=function(e,t){for(var i=t?e.nextElementSibling:e.previousElementSibling;i&&i.parentElement.classList.contains("e-row");){if(!i.matches(".e-hide")&&!i.matches(".e-rowdragdrop"))return i;i=t?i.nextElementSibling:i.previousElementSibling}if(!sf.base.isNullOrUndefined(i)&&(i.classList.contains("e-taskbar-main-container")||i.classList.contains("e-right-connectorpoint-outer-div"))){var r=this.parent.currentViewData[this.focusedRowIndex];!sf.base.isNullOrUndefined(r.ganttProperties.segments)&&r.ganttProperties.segments.length>0&&(i=i.classList.contains("e-right-connectorpoint-outer-div")?i.parentElement.nextElementSibling:i.getElementsByClassName("e-gantt-child-taskbar-inner-div")[0])}if(this.validateNextElement(i))return i;var a=-1,s=null;if(e.classList.contains("e-rowcell"))if(a=e.parentElement.rowIndex,t){if(s=this.parent.getRowByIndex(a),this.validateNextElement(s,"e-left-label-container"))return s.getElementsByClassName("e-left-label-container")[0];if(this.validateNextElement(s,"e-taskbar-main-container"))return s.getElementsByClassName("e-taskbar-main-container")[0];if(this.validateNextElement(s,"e-right-label-container"))return s.getElementsByClassName("e-right-label-container")[0]}else{if(s=this.getNextRowElement(a,t,!1),this.validateNextElement(s,"e-right-label-container"))return s.getElementsByClassName("e-right-label-container")[0];if(this.validateNextElement(s,"e-taskbar-main-container"))return s.getElementsByClassName("e-taskbar-main-container")[0];if(this.validateNextElement(s,"e-left-label-container"))return s.getElementsByClassName("e-left-label-container")[0]}else if(e.parentElement.classList.contains("e-chart-row-cell")||e.parentElement.parentElement.classList.contains("e-chart-row-cell")){var n=void 0;if(a=sf.base.closest(e,".e-chart-row").rowIndex,!(s=t?this.getNextRowElement(a,t,!0):this.parent.treeGrid.grid.getRowByIndex(a)))return"noNextRow";for(n=t?s.children[0]:s.children[s.children.length-1];n;){if(!n.matches(".e-hide")&&!n.matches(".e-rowdragdrop"))return n;n=t?n.nextElementSibling:n.previousElementSibling}}return null},e.prototype.getNextRowElement=function(e,t,i){var r=this.parent.getExpandedRecords(this.parent.currentViewData),a=this.parent.currentViewData[e],s=r.indexOf(a),n=t?r[s+1]:r[s-1],o=this.parent.currentViewData.indexOf(n);return n?i?this.parent.treeGrid.grid.getRowByIndex(o):this.parent.getRowByIndex(o):null},e.prototype.validateNextElement=function(e,t){if(e&&e.classList.contains("e-rowcell"))return!0;if(e&&t){var i=e.getElementsByClassName(t)[0];return!(!i||!i.hasChildNodes())}return!!e&&!(sf.base.isNullOrUndefined(e)||!e.hasChildNodes())},e.prototype.manageFocus=function(e,t,i){if(i){var r=null;if(e.classList.contains("e-left-label-container")||e.classList.contains("e-right-label-container"))r=e.getElementsByTagName("span")[0];else if(e.classList.contains("e-taskbar-main-container")||e.classList.contains("e-gantt-child-taskbar-inner-div")){var a=sf.base.closest(e,".e-chart-row").rowIndex,s=this.parent.currentViewData[a],n=s.hasChildRecords?s.ganttProperties.isAutoSchedule?"e-gantt-parent-taskbar":"e-manualparent-main-container":s.ganttProperties.isMilestone?"e-gantt-milestone":!sf.base.isNullOrUndefined(s.ganttProperties.segments)&&s.ganttProperties.segments.length>0?"e-segmented-taskbar":"e-gantt-child-taskbar";r=e.getElementsByClassName(n)[0],sf.base.isNullOrUndefined(r)&&(r=e)}"add"!==t||sf.base.isNullOrUndefined(r)?sf.base.isNullOrUndefined(r)||(sf.base.removeClass([r],"e-active-container"),e.setAttribute("tabIndex","-1"),e.blur()):(e.setAttribute("tabIndex","0"),sf.base.addClass([r],"e-active-container"),e.focus(),this.focusedElement=r)}else"add"===t?(e.setAttribute("tabIndex","0"),sf.base.addClass([e],["e-focused","e-focus"]),e.focus()):(e.setAttribute("tabIndex","-1"),sf.base.removeClass([e],["e-focused","e-focus"]),e.blur())},e.prototype.getIndexByTaskBar=function(e){var t,i;if(t=e.classList.contains(A)?e:sf.base.closest(e,"div."+A),sf.base.isNullOrUndefined(t))t=sf.base.closest(e,"tr."+G),i=[].slice.call(this.parent.chartRowsModule.ganttChartTableBody.childNodes).indexOf(t);else{var r=t.getAttribute("rowUniqueId"),a=this.parent.getRecordByID(r);i=this.parent.currentViewData.indexOf(a)}return i},e.prototype.destroy=function(){this.removeEventListener(),this.unWireEvents(),this.scrollObject.destroy(),this.scrollObject=null},e}(),$=function(){return($=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var a in t=arguments[i])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},ee=function(){function e(e){this.isZoomIn=!1,this.isZooming=!1,this.isZoomToFit=!1,this.topTierCollection=[],this.bottomTierCollection=[],this.parent=e,this.initProperties()}return e.prototype.initProperties=function(){this.timelineStartDate=null,this.timelineEndDate=null,this.totalTimelineWidth=0,this.customTimelineSettings=null,this.parent.isTimelineRoundOff=!this.isZoomToFit&&!!sf.base.isNullOrUndefined(this.parent.projectStartDate)},e.prototype.validateTimelineProp=function(){this.roundOffDays(),this.processTimelineProperty(),this.timelineWidthCalculation()},e.prototype.refreshTimeline=function(){this.initProperties(),this.processTimelineUnit(),this.parent.dataOperation.calculateProjectDates(),this.parent.updateProjectDates(this.parent.cloneProjectStartDate,this.parent.cloneProjectEndDate,this.parent.isTimelineRoundOff)},e.prototype.refreshTimelineByTimeSpan=function(){this.validateTimelineProp(),this.parent.ganttChartModule.chartTimelineContainer.innerHTML="",this.createTimelineSeries()},e.prototype.updateChartByNewTimeline=function(){this.parent.chartRowsModule.refreshChartByTimeline(),this.parent.notify("refreshDayMarkers",{})},e.prototype.processZooming=function(e){var t;this.isZoomToFit=!1,sf.base.isNullOrUndefined(this.parent.zoomingProjectStartDate)||(this.parent.cloneProjectStartDate=this.parent.cloneProjectStartDate.getTime()<this.parent.zoomingProjectStartDate.getTime()?this.parent.cloneProjectStartDate:this.parent.zoomingProjectStartDate,this.parent.cloneProjectEndDate=this.parent.cloneProjectEndDate.getTime()>this.parent.zoomingProjectEndDate.getTime()?this.parent.cloneProjectEndDate:this.parent.zoomingProjectEndDate),this.parent.zoomingProjectStartDate=null,this.parent.zoomingProjectEndDate=null;var i=this.checkCurrentZoomingLevel();this.isZoomIn=e,this.isZooming=!0,t=e?i+1:i-1,this.parent.toolbarModule&&(e?t===this.parent.zoomingLevels[this.parent.zoomingLevels.length-1].level?this.parent.toolbarModule.enableItems([this.parent.controlId+"_zoomin"],!1):this.parent.toolbarModule.enableItems([this.parent.controlId+"_zoomout"],!0):t===this.parent.zoomingLevels[0].level?this.parent.toolbarModule.enableItems([this.parent.controlId+"_zoomout"],!1):this.parent.toolbarModule.enableItems([this.parent.controlId+"_zoomin"],!0));var r=this.parent.zoomingLevels[t],a={requestType:e?"beforeZoomIn":"beforeZoomOut",timeline:r,cancel:!1};this.parent.trigger("actionBegin",a),a.cancel||(r=a.timeline,this.changeTimelineSettings(r))},e.prototype.changeTimelineSettings=function(e){var t=this,r=this.isSingleTier?"None"===this.customTimelineSettings.topTier.unit?"topTier":"bottomTier":null;if(Object.keys(this.customTimelineSettings).forEach((function(a){if(a!==r)t.customTimelineSettings[a]="object"!==i(e[a])||sf.base.isNullOrUndefined(e[a])?e[a]:$({},e[a]);else{var s="topTier"===a?"bottomTier":"topTier";t.customTimelineSettings[s]=$({},e.bottomTier)}})),this.parent.isTimelineRoundOff=!this.isZoomToFit&&!!sf.base.isNullOrUndefined(this.parent.projectStartDate),this.processTimelineUnit(),this.parent.updateProjectDates(this.parent.cloneProjectStartDate,this.parent.cloneProjectEndDate,this.parent.isTimelineRoundOff),this.isZooming||this.isZoomToFit){var a={requestType:this.isZoomIn?"AfterZoomIn":this.isZoomToFit?"AfterZoomToProject":"AfterZoomOut",timeline:this.parent.currentZoomingLevel};this.parent.trigger("actionComplete",a)}},e.prototype.processZoomToFit=function(){this.isZoomToFit=!0,this.isZooming=!1,this.parent.zoomingProjectStartDate||(this.parent.zoomingProjectStartDate=this.parent.cloneProjectStartDate,this.parent.zoomingProjectEndDate=this.parent.cloneProjectEndDate),this.parent.dataOperation.calculateProjectDates();var e,t,i,r=(this.parent.cloneProjectEndDate.getTime()-this.parent.cloneProjectStartDate.getTime())/864e5,a=this.parent.ganttChartModule.chartElement.offsetWidth,s=a/r,n=this.parent.zoomingLevels.slice().sort((function(e,t){return e.perDayWidth<t.perDayWidth?1:-1}));if(0!==s){for(var o=0;o<n.length;o++){if(t=n[o],o===n.length-1){e=n[o];break}if(i=n[o+1],s>=t.perDayWidth){e=n[o];break}if(s<t.perDayWidth&&s>i.perDayWidth){e=n[o+1];break}}var d=sf.base.extend({},{},e,!0);this.roundOffDateToZoom(this.parent.cloneProjectStartDate,!0,s,d.bottomTier.unit),this.roundOffDateToZoom(this.parent.cloneProjectEndDate,!1,s,d.bottomTier.unit);var l=this.calculateNumberOfTimelineCells(d),p=this.parent.ganttChartModule.scrollElement.offsetHeight-17,h=this.parent.ganttChartModule.chartBodyContent.offsetHeight<=p?0:17;d.timelineUnitSize=Math.abs(a-h)/l;var c={requestType:"beforeZoomToProject",timeline:d};this.parent.toolbarModule&&this.parent.toolbarModule.enableItems([this.parent.controlId+"_zoomin",this.parent.controlId+"_zoomout"],!0),this.parent.trigger("actionBegin",c),this.changeTimelineSettings(d)}},e.prototype.roundOffDateToZoom=function(e,t,i,r){var a=("Month"===r||"Year"===r?60:20)/i*864e5;t?e.setTime(e.getTime()-a):e.setTime(e.getTime()+a),"Hour"===r?e.setMinutes(t?-120:120):"Minutes"===r?e.setSeconds(t?-120:120):e.setHours(t?-48:48,0,0,0)},e.prototype.calculateNumberOfTimelineCells=function(e){var t=Math.abs((this.parent.cloneProjectEndDate.getTime()-this.parent.cloneProjectStartDate.getTime())/864e5),i=e.bottomTier.count,r=e.bottomTier.unit;return"Day"===r?t/i:"Week"===r?t/i/7:"Month"===r?t/i/28:"Year"===r?t/i/336:"Hour"===r?t*(24/i):t*(1440/i)},e.prototype.processTimelineUnit=function(){var e=["Year","Month","Week","Day","Hour","Minutes"];this.customTimelineSettings=this.customTimelineSettings?this.customTimelineSettings:this.extendFunction(this.parent.timelineSettings,["timelineViewMode","timelineUnitSize","weekStartDay","weekendBackground"],{topTier:["unit","format","count","formatter"],bottomTier:["unit","format","count","formatter"]}),-1===e.indexOf(this.customTimelineSettings.topTier.unit)&&-1===e.indexOf(this.customTimelineSettings.bottomTier.unit)?(this.customTimelineSettings.topTier.unit=-1!==e.indexOf(this.customTimelineSettings.timelineViewMode)?this.customTimelineSettings.timelineViewMode:"Week",this.customTimelineSettings.bottomTier.unit=5!==e.indexOf(this.customTimelineSettings.topTier.unit)?e[e.indexOf(this.customTimelineSettings.topTier.unit)+1]:"None"):-1!==e.indexOf(this.customTimelineSettings.topTier.unit)&&-1!==e.indexOf(this.customTimelineSettings.bottomTier.unit)&&e.indexOf(this.customTimelineSettings.topTier.unit)>e.indexOf(this.customTimelineSettings.bottomTier.unit)?this.customTimelineSettings.bottomTier.unit=this.customTimelineSettings.topTier.unit:(this.customTimelineSettings.topTier.unit=-1===e.indexOf(this.customTimelineSettings.topTier.unit)?"None":this.customTimelineSettings.topTier.unit,this.customTimelineSettings.bottomTier.unit=-1===e.indexOf(this.customTimelineSettings.bottomTier.unit)?"None":this.customTimelineSettings.bottomTier.unit),this.topTier=this.customTimelineSettings.topTier.unit,this.bottomTier=this.customTimelineSettings.bottomTier.unit,this.previousIsSingleTier=this.isSingleTier,this.isSingleTier="None"===this.topTier||"None"===this.bottomTier},e.prototype.processTimelineProperty=function(){this.customTimelineSettings.topTier.count="None"===this.topTier?1:this.validateCount(this.customTimelineSettings.topTier.unit,this.customTimelineSettings.topTier.count,"topTier"),this.customTimelineSettings.bottomTier.count="None"===this.customTimelineSettings.bottomTier.unit?1:this.validateCount(this.customTimelineSettings.bottomTier.unit,this.customTimelineSettings.bottomTier.count,"bottomTier"),this.customTimelineSettings.bottomTier.format=this.validateFormat(this.customTimelineSettings.bottomTier.unit,this.customTimelineSettings.bottomTier.format),this.customTimelineSettings.topTier.format=this.validateFormat(this.topTier,this.customTimelineSettings.topTier.format),this.customTimelineSettings.weekStartDay=this.customTimelineSettings.weekStartDay>=0&&this.customTimelineSettings.weekStartDay<=6?this.customTimelineSettings.weekStartDay:0,this.checkCurrentZoomingLevel()},e.prototype.calculateZoomingLevelsPerDayWidth=function(){for(var e=this.parent.zoomingLevels,t=0;t<e.length;t++){var i=this.getPerDayWidth(e[t].timelineUnitSize,e[t].bottomTier.count,e[t].bottomTier.unit);e[t].perDayWidth=i}},e.prototype.checkCurrentZoomingLevel=function(){var e="None"!==this.customTimelineSettings.bottomTier.unit?this.customTimelineSettings.bottomTier.count:this.customTimelineSettings.topTier.count,t="None"!==this.customTimelineSettings.bottomTier.unit?this.customTimelineSettings.bottomTier.unit:this.customTimelineSettings.topTier.unit,i=this.getCurrentZoomingLevel(t,e);return this.parent.toolbarModule&&(i===this.parent.zoomingLevels[this.parent.zoomingLevels.length-1].level?this.parent.toolbarModule.enableItems([this.parent.controlId+"_zoomin"],!1):i===this.parent.zoomingLevels[0].level&&this.parent.toolbarModule.enableItems([this.parent.controlId+"_zoomout"],!1)),this.parent.currentZoomingLevel=this.parent.zoomingLevels[i],i},e.prototype.getCurrentZoomingLevel=function(e,t){var i,r,a,s,n;this.parent.zoomingLevels.length||(this.parent.zoomingLevels=this.parent.getZoomingLevels());var o=this.parent.zoomingLevels.filter((function(t){return t.bottomTier.unit===e}));if(0===o.length){var d=this.getClosestUnit(e,"",!1);o=this.parent.zoomingLevels.filter((function(e){return e.bottomTier.unit===d}))}for(var l=o.sort((function(e,t){return e.bottomTier.count<t.bottomTier.count?1:-1})),p=0;p<l.length;p++){if(n=l[p],p===l.length-1){i=l[p].level;break}if(s=l[p+1],t>=n.bottomTier.count){r=l[p],i=(a=l.filter((function(e){return e.bottomTier.count===r.bottomTier.count}))).length>1?this.checkCollectionsWidth(a):a[0].level;break}if(t<n.bottomTier.count&&t>s.bottomTier.count){r=l[p+1],i=(a=l.filter((function(e){return e.bottomTier.count===r.bottomTier.count}))).length>1?this.checkCollectionsWidth(a):a[0].level;break}}return i},e.prototype.getClosestUnit=function(e,t,i){var r=["Year","Month","Week","Day","Hour","Minutes"],a=r.indexOf(e);return 0===a&&(i=!0),e=this.isZoomIn||i?r[a+1]:r[a-1],0===this.parent.zoomingLevels.filter((function(t){return t.bottomTier.unit===e})).length?("Year"===e&&(i=!0),t=e,this.getClosestUnit(e,t,i)):e},e.prototype.checkCollectionsWidth=function(e){for(var t,i,r,a=e,s=this.customTimelineSettings.timelineUnitSize,n=a.sort((function(e,t){return e.timelineUnitSize<t.timelineUnitSize?1:-1})),o=0;o<n.length;o++){if(r=n[o],o===n.length-1){t=n[o].level;break}if(i=n[o+1],s>=r.timelineUnitSize){t=n[o].level;break}if(s<r.timelineUnitSize&&s>i.timelineUnitSize){t=n[o+1].level;break}}return t},e.prototype.updateTimelineHeaderHeight=function(){if(this.parent.timelineModule.isSingleTier?(sf.base.addClass([this.parent.ganttChartModule.chartTimelineContainer],L),this.parent.treeGrid.element&&(sf.base.addClass(this.parent.treeGrid.element.querySelectorAll(".e-headercell"),L),sf.base.addClass(this.parent.treeGrid.element.querySelectorAll(".e-columnheader"),L))):(sf.base.removeClass([this.parent.ganttChartModule.chartTimelineContainer],L),this.parent.treeGrid.element&&(sf.base.removeClass(this.parent.treeGrid.element.querySelectorAll(".e-headercell"),L),sf.base.removeClass(this.parent.treeGrid.element.querySelectorAll(".e-columnheader"),L))),this.previousIsSingleTier!==this.isSingleTier){var e=0;sf.base.isNullOrUndefined(this.parent.toolbarModule)||sf.base.isNullOrUndefined(this.parent.toolbarModule.element)||(e=this.parent.toolbarModule.element.offsetHeight),this.parent.ganttChartModule.scrollObject.setHeight(this.parent.ganttHeight-this.parent.ganttChartModule.chartTimelineContainer.offsetHeight-e),this.parent.treeGrid.height=this.parent.ganttHeight-e-this.parent.ganttChartModule.chartTimelineContainer.offsetHeight}},e.prototype.createTimelineSeries=function(){var e,t,i,r,a,s=this.isSingleTier?1:2,n="None"===this.topTier?"bottomTier":"topTier";this.updateTimelineHeaderHeight(),this.topTierCollection=[],this.bottomTierCollection=[];for(var o=0;o<s;o++)r=sf.base.createElement("table",{className:"e-timeline-header-table-container",styles:"display: block;"}),a=sf.base.createElement("thead",{className:"e-timeline-header-table-body",styles:"display:block; border-collapse:collapse"}),e=sf.base.createElement("tr",{innerHTML:this.createTimelineTemplate(n)}),t=sf.base.createElement("th"),i=sf.base.createElement("div",{styles:"width: 20px"}),t.appendChild(i),e.appendChild(t),a.appendChild(e),r.appendChild(a),this.parent.ganttChartModule.chartTimelineContainer.appendChild(r),n="bottomTier",e=null},e.prototype.validateCount=function(e,t,i){var r,a=!sf.base.isNullOrUndefined(t)&&parseInt(t.toString(),10)>0?parseInt(t.toString(),10):1,s=Math.abs(this.timelineRoundOffEndDate.getTime()-this.timelineStartDate.getTime());switch(e){case"Year":a=a<=(r=Math.round(s/864e5/336))?a:r>0?r:1,"None"!==this.topTier&&"bottomTier"===i&&(a=this.validateBottomTierCount(e,a));break;case"Month":a=a<=(r=Math.round(s/864e5/28))?a:r>0?r:1,"None"!==this.topTier&&"bottomTier"===i&&(a=this.validateBottomTierCount(e,a));break;case"Week":a=a<=(r=Math.round(s/864e5/7))?a:r>0?r:1,"None"!==this.topTier&&"bottomTier"===i&&(a=this.validateBottomTierCount(e,a));break;case"Day":a=a<=(r=Math.round(s/864e5))?a:r>0?r:1,"None"!==this.topTier&&"bottomTier"===i&&(a=this.validateBottomTierCount(e,a));break;case"Hour":a=a<=(r=Math.round(s/36e5))?a:r>0?r:1,"None"!==this.topTier&&"bottomTier"===i&&(a=this.validateBottomTierCount(e,a));break;case"Minutes":a=a<=(r=Math.round(s/6e4))?a:r>0?r:1,"None"!==this.topTier&&"bottomTier"===i&&(a=this.validateBottomTierCount(e,a))}return t!==a&&this.isZooming&&this.parent.toolbarModule&&("bottomTier"===i||this.isSingleTier)&&(this.isZoomIn?this.parent.toolbarModule.enableItems([this.parent.controlId+"_zoomin"],!1):this.parent.toolbarModule.enableItems([this.parent.controlId+"_zoomout"],!1)),a},e.prototype.validateBottomTierCount=function(e,t){var i;switch(e){case"Year":i=t<=this.customTimelineSettings.topTier.count?t:this.customTimelineSettings.topTier.count;break;case"Month":i="Year"===this.topTier?t<=12*this.customTimelineSettings.topTier.count?t:12*this.customTimelineSettings.topTier.count:t<=this.customTimelineSettings.topTier.count?t:this.customTimelineSettings.topTier.count;break;case"Week":i="Year"===this.topTier?t<=48*this.customTimelineSettings.topTier.count?t:48*this.customTimelineSettings.topTier.count:"Month"===this.topTier?t<=4*this.customTimelineSettings.topTier.count?t:4*this.customTimelineSettings.topTier.count:t<=this.customTimelineSettings.topTier.count?t:this.customTimelineSettings.topTier.count;break;case"Day":i="Year"===this.topTier?t<=336*this.customTimelineSettings.topTier.count?t:336*this.customTimelineSettings.topTier.count:"Month"===this.topTier?t<=28*this.customTimelineSettings.topTier.count?t:28*this.customTimelineSettings.topTier.count:"Week"===this.topTier?t<=7*this.customTimelineSettings.topTier.count?t:7*this.customTimelineSettings.topTier.count:t<=this.customTimelineSettings.topTier.count?t:this.customTimelineSettings.topTier.count;break;case"Hour":i="Year"===this.topTier?t<=8064*this.customTimelineSettings.topTier.count?t:8064*this.customTimelineSettings.topTier.count:"Month"===this.topTier?t<=672*this.customTimelineSettings.topTier.count?t:672*this.customTimelineSettings.topTier.count:"Week"===this.topTier?t<=7*this.customTimelineSettings.topTier.count*24?t:7*this.customTimelineSettings.topTier.count*24:"Day"===this.topTier?t<=24*this.customTimelineSettings.topTier.count?t:24*this.customTimelineSettings.topTier.count:t<=this.customTimelineSettings.topTier.count?t:this.customTimelineSettings.topTier.count;break;case"Minutes":i="Year"===this.topTier?t<=483840*this.customTimelineSettings.topTier.count?t:483840*this.customTimelineSettings.topTier.count:"Month"===this.topTier?t<=40320*this.customTimelineSettings.topTier.count?t:40320*this.customTimelineSettings.topTier.count:"Week"===this.topTier?t<=7*this.customTimelineSettings.topTier.count*24*60?t:7*this.customTimelineSettings.topTier.count*24*60:"Day"===this.topTier?t<=24*this.customTimelineSettings.topTier.count*60?t:24*this.customTimelineSettings.topTier.count*60:"Hour"===this.topTier?t<=60*this.customTimelineSettings.topTier.count?t:60*this.customTimelineSettings.topTier.count:t<=this.customTimelineSettings.topTier.count?t:this.customTimelineSettings.topTier.count}return i},e.prototype.validateFormat=function(e,t){var i;switch(e){case"Week":i=t||"MMM dd, yyyy";break;case"Day":case"None":i=t||"";break;case"Hour":i=t||"H";break;case"Month":i=t||"MMM yyyy";break;case"Year":i=t||"yyyy";break;case"Minutes":i=t||"m"}return i},e.prototype.extendFunction=function(e,t,i){for(var r=this,a={},s=0;s<t.length;s++)a[t[s]]=e[t[s]];return i&&Object.keys(i).forEach((function(t){a[t]=r.extendFunction(e[t],i[t],null)})),a},e.prototype.formatDateHeader=function(e,t){var i,r=new Date(t.getTime());return""===e?(i=this.parent.globalize.formatDate(r,{format:"E"}),i="zh"===this.parent.locale?i.slice(1):i.slice(0,1)):i=this.parent.globalize.formatDate(r,{format:e}),i},e.prototype.customFormat=function(e,t,i,r,a){return(a="string"==typeof a?sf.base.getValue(a,window):a)(e,t,i,r)},e.prototype.createTimelineTemplate=function(e){var t,i,r=this.parent,a="",s="",n="topTier"===e?r.timelineModule.customTimelineSettings.topTier.unit:r.timelineModule.customTimelineSettings.bottomTier.unit,o="topTier"===e?r.timelineModule.customTimelineSettings.topTier.count:r.timelineModule.customTimelineSettings.bottomTier.count,d=new Date(this.parent.timelineModule.timelineStartDate.toString()),l=new Date(this.timelineRoundOffEndDate.toString()),p=[];do{var h={};h.startDate=new Date(d.getTime()),s=this.getHeaterTemplateString(new Date(d.toString()),n,e,!1,o,h),p.push(new Date(d.toString())),t=this.getIncrement(d,o,n),i=d.getTime()+t,d.setTime(i),d>=l&&(s=this.getHeaterTemplateString(p[p.length-1],n,e,!0,o,h)),a+=s;var c="topTier"===e?this.topTierCollection:this.bottomTierCollection;h.endDate=new Date(d.getTime()),c.push(h)}while(d<l);return a},e.prototype.getTimelineRoundOffEndDate=function(e){var t="None"===this.topTier?this.bottomTier:this.topTier,i=new Date(e.toString());return this.parent.isTimelineRoundOff&&("Hour"===t?i.setMinutes(60):"Minutes"===t?i.setSeconds(60):i.setHours(24,0,0,0)),i},e.prototype.getIncrement=function(e,t,i){var r,a=new Date(e.getTime()),s=new Date(e.getTime());switch(i){case"Year":a=e,r=(s=new Date(e.getFullYear()+(t-1),11,31)).getTime()-a.getTime()+864e5;break;case"Month":a=e,r=(s=new Date(e.getFullYear(),e.getMonth()+t,1)).getTime()-a.getTime();break;case"Week":var n=this.parent.timelineModule.customTimelineSettings.weekStartDay,o=e.getDay()<n?n-e.getDay():6-e.getDay()+n;t=o>0?t-1:0,s.setHours(24,0,0,0),o=e.getDay()<n&&o>0?o-1:o,s.setDate(s.getDate()+(o+7*t)),r=s.getTime()-a.getTime();break;case"Day":s.setHours(24,0,0,0),r=s.getTime()-a.getTime()+864e5*(t-1);break;case"Hour":s.setMinutes(60),s.setSeconds(0),r=s.getTime()-a.getTime()+36e5*(t-1);break;case"Minutes":s.setSeconds(60),r=s.getTime()-a.getTime()+6e4*(t-1)}return r},e.prototype.isWeekendHeaderCell=function(e,t,i){return!("Day"!==e&&"Hour"!==e&&"Minutes"!==e||1!==this.customTimelineSettings[t].count&&"Hour"!==e&&"Minutes"!==e||-1===this.parent.nonWorkingDayIndex.indexOf(i.getDay()))},e.prototype.getHeaterTemplateString=function(e,t,i,r,a,s){var n,o,d,l="",p="",h="topTier"===i?this.parent.timelineModule.customTimelineSettings.topTier.format:this.parent.timelineModule.customTimelineSettings.bottomTier.format,c="topTier"===i?this.parent.timelineModule.customTimelineSettings.topTier.formatter:this.parent.timelineModule.customTimelineSettings.bottomTier.formatter,u=sf.base.isNullOrUndefined(c)?this.parent.globalize.formatDate(e,{format:this.parent.getDateFormat()}):this.customFormat(e,h,i,t,c);o=n=this.getIncrement(e,a,t)/864e5*this.parent.perDayWidth,n=r?this.calculateWidthBetweenTwoDate(t,e,this.timelineRoundOffEndDate):n,d=this.isWeekendHeaderCell(t,i,e);var f="topTier"===i?" e-gantt-top-cell-text":"",g=sf.base.isNullOrUndefined(c)?this.formatDateHeader(h,e):this.customFormat(e,h,i,t,c);return p+=this.parent.timelineModule.isSingleTier?'<th class="e-timeline-single-header-cell ':'<th class="e-timeline-top-header-cell',p+=d?" e-weekend-header-cell":"",p+='" tabindex="-1" aria-label= "'+this.parent.localeObj.getConstant("timelineCell")+" "+u,p+='" style="width:'+n+"px;",p+=d&&this.customTimelineSettings.weekendBackground?"background-color:"+this.customTimelineSettings.weekendBackground+";":"",p+='"><div class="e-header-cell-label'+f+'" style="width:'+(n-1)+"px;"+(this.parent.timelineSettings.showTooltip?'"title="'+u:""),l+=p+='">'+g+"</div>",l+="</th>",!this.isSingleTier&&"topTier"!==i||r?(this.isSingleTier||"topTier"===i)&&r&&(this.totalTimelineWidth=this.totalTimelineWidth-o+n):this.totalTimelineWidth=this.totalTimelineWidth+n,s.value=g,s.isWeekend=d,s.width=o,l},e.prototype.calculateWidthBetweenTwoDate=function(e,t,i){return(i.getTime()-t.getTime())/864e5*this.parent.perDayWidth},e.prototype.timelineWidthCalculation=function(){var e=this.customTimelineSettings.timelineUnitSize,t=this.customTimelineSettings.bottomTier.count,i=this.customTimelineSettings.topTier.count;this.bottomTierCellWidth=e,"None"===this.bottomTier?this.parent.perDayWidth=this.getPerDayWidth(e,i,this.topTier):this.parent.perDayWidth=this.getPerDayWidth(e,t,this.bottomTier),this.topTierCellWidth="None"!==this.bottomTier?"Week"===this.topTier?7*this.parent.perDayWidth:"Hour"===this.topTier?this.parent.perDayWidth/24:"Minutes"===this.topTier?this.parent.perDayWidth/1440:this.parent.perDayWidth:e,this.topTierCellWidth=this.isSingleTier?this.topTierCellWidth:this.topTierCellWidth*i},e.prototype.getPerDayWidth=function(e,t,i){var r;switch(i){case"Year":r=e/t/336;break;case"Month":r=e/t/28;break;case"Week":r=e/t/7;break;case"Day":r=e/t;break;case"Hour":r=24/t*e;break;case"Minutes":r=1440/t*e}return r},e.prototype.roundOffDays=function(){var e=this.parent.cloneProjectStartDate,t=this.parent.cloneProjectEndDate,i="None"===this.topTier?this.bottomTier:this.topTier;if(this.parent.isTimelineRoundOff){if("Year"===i)e=new Date(e.getFullYear(),0,1),t=new Date(t.getFullYear(),11,31);else if("Month"===i)e=new Date(e.getFullYear(),e.getMonth(),1),t=new Date(t.getFullYear(),t.getMonth()+1,0);else if("Week"===i){var r=this.parent.timelineModule.customTimelineSettings.weekStartDay,a=e.getDay()<r?e.getDate()-(7-r+e.getDay()):e.getDate()-e.getDay()+r;e.setDate(a);var s=t.getDate()-t.getDay()+6+r;t.setDate(s)}"Hour"===i?e.setMinutes(0):"Minutes"===i?e.setSeconds(0):e.setHours(0,0,0,0)}this.timelineStartDate=e,this.timelineEndDate=t,this.timelineRoundOffEndDate=this.getTimelineRoundOffEndDate(this.timelineEndDate)},e.prototype.updateScheduleDatesByToolBar=function(e,t,i,r){if("Year"===e&&("prevTimeSpan"===t?i=0===i.getMonth()?new Date(i.getFullYear()-1,0,1):new Date(i.getFullYear(),0,1):r=11===r.getMonth()?new Date(r.getFullYear()+1,0,1):new Date(r.getFullYear(),12,1)),"Month"===e&&("prevTimeSpan"===t?i=1===i.getDate()?new Date(i.getFullYear(),i.getMonth()-1,1):new Date(i.getFullYear(),i.getMonth(),1):r=new Date(r.getFullYear(),r.getMonth()+1,1)),"Week"===e){var a=this.parent.timelineModule.customTimelineSettings.weekStartDay,s=void 0;"prevTimeSpan"===t?(s=i.getDay()<a?7-(a-i.getDay()):i.getDay()-a,i.setHours(0,0,0,0),0===s?i.setDate(i.getDate()-7):i.setDate(i.getDate()-s)):(s=r.getDay()<a?a-r.getDay():7-r.getDay()+a,r.setHours(0,0,0,0),0===s?r.setDate(r.getDate()+6):r.setDate(r.getDate()+s))}"Day"===e&&("prevTimeSpan"===t?0===i.getHours()?i.setTime(i.getTime()-864e5):i.setHours(0):0===r.getHours()?r.setTime(r.getTime()+864e5):r.setHours(24)),"Hour"===e&&("prevTimeSpan"===t?0===i.getMinutes()?i.setTime(i.getTime()-36e5):i.setMinutes(0):0===r.getMinutes()?r.setTime(r.getTime()+36e5):r.setMinutes(60)),"Minutes"===e&&("prevTimeSpan"===t?0===i.getSeconds()?i.setTime(i.getTime()-6e4):i.setSeconds(0):0===r.getSeconds()?r.setTime(r.getTime()+6e4):r.setSeconds(60)),this.parent.cloneProjectStartDate=i,this.parent.cloneProjectEndDate=r},e.prototype.updateTimeLineOnEditing=function(e,t){var i,r=e.filter((function(e){return!sf.base.isNullOrUndefined(e.ganttProperties.startDate)})),a=e.filter((function(e){return!sf.base.isNullOrUndefined(e.ganttProperties.endDate)})),s=r.length>0?new Date(sf.data.DataUtil.aggregates.min(r,"ganttProperties.startDate")):null,n=a.length>0?new Date(sf.data.DataUtil.aggregates.max(a,"ganttProperties.endDate")):null,o=new Date(this.parent.dataOperation.checkStartDate(this.timelineStartDate).getTime()),d=new Date(this.parent.dataOperation.checkEndDate(this.timelineEndDate).getTime()),l=sf.base.isNullOrUndefined(s)?null:this.parent.dataOperation.getTaskLeft(s,!1),p=sf.base.isNullOrUndefined(n)?null:this.parent.dataOperation.getTaskLeft(n,!1),h=this.parent.dataOperation.getTaskLeft(o,!1),c=this.parent.dataOperation.getTaskLeft(d,!1);!sf.base.isNullOrUndefined(l)&&(l<=this.bottomTierCellWidth||l<=h)?(i="prevTimeSpan",s=s>this.timelineStartDate?this.timelineStartDate:s):s=this.timelineStartDate,!sf.base.isNullOrUndefined(p)&&(p>=this.totalTimelineWidth-this.bottomTierCellWidth||p>=c)?(i="prevTimeSpan"===i?"both":"nextTimeSpan",n=n<this.timelineEndDate?this.timelineEndDate:n):n=this.timelineEndDate,i&&this.performTimeSpanAction(i,t,s,n)},e.prototype.performTimeSpanAction=function(e,t,i,r,a){a=sf.base.isNullOrUndefined(a)?"None"===this.parent.timelineModule.topTier?this.parent.timelineModule.bottomTier:this.parent.timelineModule.topTier:a;var s=new Date(this.parent.cloneProjectStartDate.getTime()),n=new Date(this.parent.cloneProjectEndDate.getTime());"publicMethod"!==t&&"both"===e?(this.updateScheduleDatesByToolBar(a,"prevTimeSpan",i,r),this.updateScheduleDatesByToolBar(a,"nextTimeSpan",new Date(this.parent.cloneProjectStartDate.getTime()),r)):this.updateScheduleDatesByToolBar(a,e,i,r);var o=this.timeSpanActionEvent("actionBegin",e,t);o.cancel?(this.parent.cloneProjectStartDate=s,this.parent.cloneProjectEndDate=n):(this.parent.updateProjectDates(o.projectStartDate,o.ProjectEndDate,o.isTimelineRoundOff,t),"prevTimeSpan"===e&&"publicMethod"===t?this.parent.ganttChartModule.updateScrollLeft(0):"nextTimeSpan"===e&&"publicMethod"===t&&this.parent.ganttChartModule.updateScrollLeft(this.parent.timelineModule.totalTimelineWidth),this.parent.timelineModule.timeSpanActionEvent("actionComplete",e,t))},e.prototype.timeSpanActionEvent=function(e,t,i){var r={};return r.projectStartDate=new Date(this.parent.cloneProjectStartDate.getTime()),r.ProjectEndDate=new Date(this.parent.cloneProjectEndDate.getTime()),r.requestType="publicMethod"===i?t:"beforeAdd"===i?"TimelineRefreshOnAdd":"TaskbarEditing"===i?"TimelineRefreshOnEdit":t,"actionBegin"===e&&(r.isTimelineRoundOff=this.parent.isTimelineRoundOff,r.cancel=!1),r.action="TimescaleUpdate",this.parent.trigger(e,r),r},e}(),te=function(e){this.allowEditing=!0,this.allowReordering=!0,this.allowResizing=!0,this.allowSorting=!0,this.allowFiltering=!0,this.edit={},sf.base.merge(this,e)},ie=function(){function e(e){var t=this;this.previousScroll={top:0,left:0},this.queryCellInfo=function(e){t.parent.trigger("queryCellInfo",e)},this.headerCellInfo=function(e){t.parent.trigger("headerCellInfo",e)},this.rowDataBound=function(e){t.parent.trigger("rowDataBound",e)},this.columnMenuOpen=function(e){t.parent.notify("columnMenuOpen",e),t.parent.trigger("columnMenuOpen",e)},this.columnMenuClick=function(e){t.parent.trigger("columnMenuClick",e)},this.parent=e,this.parent.treeGrid=new sf.treegrid.TreeGrid,this.parent.treeGrid.allowSelection=!1,this.parent.treeGrid.allowKeyboard=this.parent.allowKeyboard,this.parent.treeGrid.enableImmutableMode=this.parent.enableImmutableMode,this.treeGridColumns=[],this.validateGanttColumns(),this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.on("renderPanels",this.createContainer,this),this.parent.on("chartScroll",this.updateScrollTop,this),this.parent.on("destroy",this.destroy,this),this.parent.treeGrid.on("renderReactTemplate",this.renderReactTemplate,this)},e.prototype.renderReactTemplate=function(e){this.parent.portals=e,this.parent.renderTemplates()},e.prototype.createContainer=function(){this.treeGridElement=sf.base.createElement("div",{id:"treeGrid"+this.parent.element.id,className:"e-gantt-tree-grid"});var e=sf.base.createElement("div",{className:"e-gantt-temp-header"});this.parent.treeGridPane.appendChild(this.treeGridElement),this.treeGridElement.appendChild(e),this.parent.treeGridPane.classList.add("e-temp-content")},e.prototype.renderTreeGrid=function(){this.composeProperties(),this.bindEvents(),this.parent.treeGrid.appendTo(this.treeGridElement),this.wireEvents()},e.prototype.composeProperties=function(){this.parent.treeGrid.showColumnMenu=this.parent.showColumnMenu,this.parent.treeGrid.columnMenuItems=this.parent.columnMenuItems,this.parent.treeGrid.childMapping=sf.base.isNullOrUndefined(this.parent.taskFields.child)?"":this.parent.taskFields.child,this.parent.treeGrid.treeColumnIndex=this.parent.treeColumnIndex,this.parent.treeGrid.columns=this.treeGridColumns,this.parent.treeGrid.dataSource=this.parent.flatData,this.parent.treeGrid.expandStateMapping=this.parent.taskFields.expandState;this.parent.treeGrid.isGantt=!0,this.parent.treeGrid.rowHeight=this.parent.rowHeight,this.parent.treeGrid.gridLines=this.parent.gridLines,sf.base.isBlazor()&&0===this.parent.searchSettings.fields.length&&""===this.parent.searchSettings.key||(this.parent.treeGrid.searchSettings=this.parent.searchSettings);this.parent.treeGrid.isJsComponent=!0;var e=0;sf.base.isNullOrUndefined(this.parent.toolbarModule)||sf.base.isNullOrUndefined(this.parent.toolbarModule.element)||(e=this.parent.toolbarModule.element.offsetHeight),this.parent.treeGrid.height=this.parent.ganttHeight-e-46},e.prototype.getContentDiv=function(){return this.treeGridElement.querySelector(".e-content")},e.prototype.getHeaderDiv=function(){return this.treeGridElement.querySelector(".e-headercontent")},e.prototype.getScrollbarWidth=function(){var e=document.createElement("div");e.style.visibility="hidden",e.style.overflow="scroll",e.style.msOverflowStyle="scrollbar";var t=document.createElement("div");e.appendChild(t),this.parent.element.appendChild(e);var i=e.offsetWidth-t.offsetWidth;return e.parentNode.removeChild(e),i},e.prototype.ensureScrollBar=function(){var e=this.getContentDiv(),t=this.getHeaderDiv(),i=this.getScrollbarWidth(),r=/Android|Mac|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);0!==i?e.style.cssText+="width: calc(100% + "+i+"px);":e.classList.add("e-gantt-scroll-padding"),0===i&&r&&(t.style.cssText+="width: calc(100% + 17px);")},e.prototype.bindEvents=function(){this.parent.treeGrid.dataBound=this.dataBound.bind(this),this.parent.treeGrid.collapsing=this.collapsing.bind(this),this.parent.treeGrid.collapsed=this.collapsed.bind(this),this.parent.treeGrid.expanding=this.expanding.bind(this),this.parent.treeGrid.expanded=this.expanded.bind(this),this.parent.treeGrid.actionBegin=this.actionBegin.bind(this),this.parent.treeGrid.actionComplete=this.treeActionComplete.bind(this),this.parent.treeGrid.created=this.created.bind(this),this.parent.treeGrid.actionFailure=this.actionFailure.bind(this),this.parent.treeGrid.queryCellInfo=this.queryCellInfo.bind(this),this.parent.treeGrid.headerCellInfo=this.headerCellInfo.bind(this),this.parent.treeGrid.rowDataBound=this.rowDataBound.bind(this),this.parent.treeGrid.columnMenuOpen=this.columnMenuOpen.bind(this),this.parent.treeGrid.columnMenuClick=this.columnMenuClick.bind(this),this.parent.treeGrid.beforeDataBound=this.beforeDataBound.bind(this)},e.prototype.beforeDataBound=function(e){this.parent.updatedRecords=this.parent.virtualScrollModule&&this.parent.enableVirtualization?sf.base.getValue("virtualScrollModule.visualData",this.parent.treeGrid):sf.base.getValue("result",e),"virtualscroll"!==sf.base.getValue("actionArgs.requestType",e)&&this.parent.virtualScrollModule&&this.parent.enableVirtualization&&this.parent.updateContentHeight(e)},e.prototype.dataBound=function(e){this.ensureScrollBar(),this.parent.treeDataBound(e),this.prevCurrentView=sf.base.extend([],[],this.parent.currentViewData,!0)},e.prototype.collapsing=function(e){var t=this,i=new sf.data.Deferred;if(!this.parent.ganttChartModule.isExpandCollapseFromChart){var r=this.createExpandCollapseArgs(e);if(sf.base.isBlazor())return this.parent.trigger("collapsing",r,(function(e){i.resolve(e),sf.base.setValue("chartRow",sf.base.getElement(sf.base.getValue("chartRow",e)),e),sf.base.setValue("gridRow",sf.base.getElement(sf.base.getValue("gridRow",e)),e),sf.base.getValue("cancel",e)||t.parent.ganttChartModule.collapseGanttRow(e,!0)})),i;this.parent.ganttChartModule.collapseGanttRow(r),sf.base.setValue("cancel",sf.base.getValue("cancel",r),e)}},e.prototype.expanding=function(e){var t=this,i=new sf.data.Deferred;if(!this.parent.ganttChartModule.isExpandCollapseFromChart){var r=this.createExpandCollapseArgs(e);if(sf.base.isBlazor())return this.parent.trigger("expanding",r,(function(e){i.resolve(e),sf.base.setValue("chartRow",sf.base.getElement(sf.base.getValue("chartRow",e)),e),sf.base.setValue("gridRow",sf.base.getElement(sf.base.getValue("gridRow",e)),e),sf.base.getValue("cancel",e)||t.parent.ganttChartModule.expandGanttRow(e,!0)})),i;this.parent.ganttChartModule.expandGanttRow(r),sf.base.setValue("cancel",sf.base.getValue("cancel",r),e)}},e.prototype.collapsed=function(e){if(this.updateExpandStatus(e),!this.parent.ganttChartModule.isExpandCollapseFromChart){var t=this.createExpandCollapseArgs(e);this.parent.ganttChartModule.collapsedGanttRow(t)}},e.prototype.expanded=function(e){if(this.updateExpandStatus(e),!this.parent.ganttChartModule.isExpandCollapseFromChart){var t=this.createExpandCollapseArgs(e);this.parent.ganttChartModule.expandedGanttRow(t)}},e.prototype.updateExpandStatus=function(e){sf.base.getValue("data",e)&&sf.base.isBlazor()&&(this.parent.getTaskByUniqueID(sf.base.getValue("data",e).uniqueID).expanded=sf.base.getValue("data",e).expanded)},e.prototype.actionBegin=function(e){this.parent.notify("actionBegin",e),this.parent.trigger("actionBegin",e)},e.prototype.created=function(e){this.updateKeyConfigSettings()},e.prototype.actionFailure=function(e){this.parent.trigger("actionFailure",e)},e.prototype.createExpandCollapseArgs=function(e){var t=sf.base.getValue("data",e);return{data:t,gridRow:sf.base.getValue("row",e),chartRow:sf.base.isBlazor()?this.parent.ganttChartModule.getChartRows()[this.parent.currentViewData.indexOf(this.parent.getTaskByUniqueID(t.uniqueID))]:this.parent.ganttChartModule.getChartRows()[this.parent.currentViewData.indexOf(t)],cancel:!1}},e.prototype.treeActionComplete=function(e){var t=sf.base.extend({},e,!0);if("sorting"===sf.base.getValue("requestType",e))this.parent.notify("updateModel",{}),sf.base.deleteObject(t,"isFrozen");else if("filtering"===sf.base.getValue("requestType",e)){this.parent.notify("updateModel",{}),this.parent.element.querySelector(".e-treegrid").focus()}else if("save"===sf.base.getValue("type",e)&&this.parent.editModule&&this.parent.editModule.cellEditModule){var i=sf.base.getValue("data",e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(this.parent.getTaskByUniqueID(i.uniqueID))||(this.parent.getTaskByUniqueID(i.uniqueID).taskData[this.parent.taskFields.duration]=i.taskData[this.parent.taskFields.duration],this.parent.getTaskByUniqueID(i.uniqueID).taskData[this.parent.taskFields.resourceInfo]=i.taskData[this.parent.taskFields.resourceInfo]),this.parent.editModule.cellEditModule.initiateCellEdit(e,this.currentEditRow),this.currentEditRow={}}"filterafteropen"===sf.base.getValue("requestType",e)&&this.parent.notify("actionComplete",e),"searching"===sf.base.getValue("requestType",e)&&this.parent.notify("actionComplete",e),sf.base.isNullOrUndefined(sf.base.getValue("batchChanges",e))||sf.base.isNullOrUndefined(this.parent.toolbarModule)||this.parent.toolbarModule.refreshToolbarItems(),sf.base.isBlazor()&&this.parent.updateDataArgs(t),this.parent.isCancelled&&(sf.base.setValue("requestType","cancel",t),sf.base.setValue("action","CellEditing",t),this.parent.isCancelled=!1),this.parent.trigger("actionComplete",t)},e.prototype.updateKeyConfigSettings=function(){delete this.parent.treeGrid.grid.keyboardModule.keyConfigs.delete,delete this.parent.treeGrid.grid.keyboardModule.keyConfigs.insert,delete this.parent.treeGrid.grid.keyboardModule.keyConfigs.upArrow,delete this.parent.treeGrid.grid.keyboardModule.keyConfigs.downArrow,delete this.parent.treeGrid.grid.keyboardModule.keyConfigs.ctrlHome,delete this.parent.treeGrid.grid.keyboardModule.keyConfigs.ctrlEnd,delete this.parent.treeGrid.grid.keyboardModule.keyConfigs.enter,delete this.parent.treeGrid.grid.keyboardModule.keyConfigs.tab,delete this.parent.treeGrid.grid.keyboardModule.keyConfigs.shiftTab,delete this.parent.treeGrid.keyboardModule.keyConfigs.enter,delete this.parent.treeGrid.keyboardModule.keyConfigs.upArrow,delete this.parent.treeGrid.keyboardModule.keyConfigs.downArrow,delete this.parent.treeGrid.keyboardModule.keyConfigs.ctrlShiftUpArrow,delete this.parent.treeGrid.keyboardModule.keyConfigs.ctrlShiftDownArrow,delete this.parent.treeGrid.keyboardModule.keyConfigs.ctrlUpArrow,delete this.parent.treeGrid.keyboardModule.keyConfigs.ctrlDownArrow,delete this.parent.treeGrid.keyboardModule.keyConfigs.tab,delete this.parent.treeGrid.keyboardModule.keyConfigs.shiftTab},e.prototype.wireEvents=function(){var e=this.parent.treeGrid.element.querySelector(".e-content");e&&sf.base.EventHandler.add(e,"scroll",this.scrollHandler,this),this.parent.isAdaptive&&sf.base.EventHandler.add(this.parent.treeGridPane,"click",this.treeGridClickHandler,this)},e.prototype.unWireEvents=function(){var e=this.parent.treeGrid.element&&this.parent.treeGrid.element.querySelector(".e-content");e&&sf.base.EventHandler.remove(e,"scroll",this.scrollHandler),this.parent.isAdaptive&&sf.base.EventHandler.remove(this.parent.treeGridPane,"click",this.treeGridClickHandler)},e.prototype.scrollHandler=function(e){var t=this.parent.treeGrid.element.querySelector(".e-content");t.scrollTop!==this.previousScroll.top&&this.parent.notify("grid-scroll",{top:t.scrollTop}),this.previousScroll.top=t.scrollTop,this.parent.contextMenuModule&&this.parent.contextMenuModule.isOpen&&this.parent.contextMenuModule.contextMenu.close()},e.prototype.validateGanttColumns=function(){var e=this.parent,t=e.columns.length,i=this.parent.taskFields;this.parent.columnMapping={},this.parent.columnByField={},this.parent.customColumns=[];for(var r=["id","name","startDate","endDate","duration","dependency","progress","baselineStartDate","baselineEndDate","resourceInfo","notes","work","manual","type"],a=function(t){var a={};"string"==typeof e.columns[t]?a.field=e.columns[t]:a=e.columns[t];var n=[];if(r.length>0&&(n=r.filter((function(e){return a.field===i[e]}))),0===n.length)return a.field===s.parent.resourceFields.group||(s.parent.customColumns.push(a.field),a.headerText=a.headerText?a.headerText:a.field,a.width=a.width?a.width:150,a.editType=a.editType?a.editType:"stringedit",a.type=a.type?a.type:"string",s.bindTreeGridColumnProperties(a,!0)),"continue";var o=r.indexOf(n[0]);r.splice(o,1),s.createTreeGridColumn(a,!0),s.parent.columnMapping[n[0]]=a.field},s=this,n=0;n<t;n++)a(n);for(var o=0;o<r.length;o++){var d={};sf.base.isNullOrUndefined(i[r[o]])||(d.field=i[r[o]],this.createTreeGridColumn(d,0===t),this.parent.columnMapping[r[o]]=d.field)}if("ProjectView"!==this.parent.viewType){d={};this.composeUniqueIDColumn(d),this.createTreeGridColumn(d,!0)}},e.prototype.createTreeGridColumn=function(e,t){var i=this.parent.taskFields;if(e.disableHtmlEncode=sf.base.isNullOrUndefined(e.disableHtmlEncode)?this.parent.disableHtmlEncode:e.disableHtmlEncode,i.id!==e.field&&(e.clipMode=e.clipMode?e.clipMode:"EllipsisWithTooltip"),i.id===e.field)this.composeIDColumn(e);else if(i.name===e.field)e.headerText=e.headerText?e.headerText:this.parent.localeObj.getConstant("name"),e.width=e.width?e.width:150,e.editType=e.editType?e.editType:"stringedit",e.type=e.type?e.type:"string";else if(i.startDate===e.field)e.headerText=e.headerText?e.headerText:this.parent.localeObj.getConstant("startDate"),e.editType=e.editType?e.editType:-1!==this.parent.getDateFormat().toLowerCase().indexOf("hh")?"datetimepickeredit":"datepickeredit",e.format=e.format?e.format:{type:"date",format:this.parent.getDateFormat()},e.width=e.width?e.width:150,e.edit={params:{renderDayCell:this.parent.renderWorkingDayCell.bind(this.parent)}};else if(i.endDate===e.field)e.headerText=e.headerText?e.headerText:this.parent.localeObj.getConstant("endDate"),e.format=e.format?e.format:{type:"date",format:this.parent.getDateFormat()},e.editType=e.editType?e.editType:-1!==this.parent.getDateFormat().toLowerCase().indexOf("hh")?"datetimepickeredit":"datepickeredit",e.width=e.width?e.width:150,e.edit={params:{renderDayCell:this.parent.renderWorkingDayCell.bind(this.parent)}};else if(i.duration===e.field)e.width=e.width?e.width:150,e.headerText=e.headerText?e.headerText:this.parent.localeObj.getConstant("duration"),e.valueAccessor=e.valueAccessor?e.valueAccessor:sf.base.isNullOrUndefined(e.edit)?this.durationValueAccessor.bind(this):null,e.editType=e.editType?e.editType:"stringedit",e.type="string";else if(i.progress===e.field)this.composeProgressColumn(e);else if(i.dependency===e.field)e.headerText=e.headerText?e.headerText:this.parent.localeObj.getConstant("dependency"),e.width=e.width?e.width:150,e.editType=e.editType?e.editType:"stringedit",e.type="string",e.allowFiltering=!1!==e.allowFiltering;else if(i.resourceInfo===e.field)this.composeResourceColumn(e);else if(i.notes===e.field)e.headerText=e.headerText?e.headerText:this.parent.localeObj.getConstant("notes"),e.width=e.width?e.width:150,e.editType=e.editType?e.editType:"stringedit",sf.base.isBlazor()&&!e.template&&this.parent.setProperties({showInlineNotes:!0},!0),this.parent.showInlineNotes||e.template||(e.template='<div class="e-ganttnotes-info"><span class="e-icons e-notes-info"></span></div>');else if(i.baselineStartDate===e.field||i.baselineEndDate===e.field){var r=i.baselineEndDate===e.field?"baselineEndDate":"baselineStartDate";e.width=e.width?e.width:150,e.headerText=e.headerText?e.headerText:this.parent.localeObj.getConstant(r),e.format=e.format?e.format:{type:"date",format:this.parent.getDateFormat()},e.editType=e.editType?e.editType:-1!==this.parent.getDateFormat().toLowerCase().indexOf("hh")?"datetimepickeredit":"datepickeredit"}else i.work===e.field?(e.headerText=e.headerText?e.headerText:this.parent.localeObj.getConstant("work"),e.width=e.width?e.width:150,e.valueAccessor=e.valueAccessor?e.valueAccessor:this.workValueAccessor.bind(this),e.editType=e.editType?e.editType:"numericedit"):i.type===e.field?(e.headerText=e.headerText?e.headerText:this.parent.localeObj.getConstant("taskType"),e.width=e.width?e.width:150,e.editType="dropdownedit",e.valueAccessor=e.valueAccessor?e.valueAccessor:this.taskTypeValueAccessor.bind(this)):i.manual===e.field&&"Custom"===this.parent.taskMode&&(e.headerText=e.headerText?e.headerText:this.parent.localeObj.getConstant("taskMode"),e.width=e.width?e.width:120,e.editType=e.editType?e.editType:"dropdownedit",e.valueAccessor=e.valueAccessor?e.valueAccessor:this.modeValueAccessor.bind(this),e.edit={params:{query:new sf.data.Query,dataSource:[{id:1,text:this.parent.localeObj.getConstant("manual"),value:!0},{id:2,text:this.parent.localeObj.getConstant("auto"),value:!1}],fields:{text:"text",value:"value"}}});this.bindTreeGridColumnProperties(e,t)},e.prototype.composeResourceColumn=function(e){e.headerText=e.headerText?e.headerText:this.parent.localeObj.getConstant("resourceName"),e.width=e.width?e.width:150,e.type="string",e.valueAccessor=e.valueAccessor?e.valueAccessor:this.resourceValueAccessor.bind(this),e.allowFiltering=!1!==e.allowFiltering},e.prototype.getResourceIds=function(e){var t=sf.base.getValue(this.parent.taskFields.resourceInfo,e.taskData),r=[];if(sf.base.isNullOrUndefined(t))return t;for(var a=0;a<t.length;a++)r.push("object"===i(t[a])?t[a][this.parent.resourceFields.id]:t[a]);return r},e.prototype.composeIDColumn=function(e){e.isPrimaryKey=!!sf.base.isNullOrUndefined(e.isPrimaryKey)||e.isPrimaryKey,e.headerText=e.headerText?e.headerText:this.parent.localeObj.getConstant("id"),e.width=e.width?e.width:100,e.allowEditing=!!e.allowEditing&&e.allowEditing,e.editType=e.editType?e.editType:"numericedit","ProjectView"!==this.parent.viewType&&(e.valueAccessor=this.idValueAccessor.bind(this),e.isPrimaryKey=!1)},e.prototype.composeUniqueIDColumn=function(e){e.field="rowUniqueID",e.isPrimaryKey=!0,e.headerText="UniqueID",e.allowEditing=!1,e.visible=!1},e.prototype.composeProgressColumn=function(e){e.headerText=e.headerText?e.headerText:this.parent.localeObj.getConstant("progress"),e.width=e.width?e.width:150,e.editType=e.editType?e.editType:"numericedit"},e.prototype.bindTreeGridColumnProperties=function(e,t){for(var i={},r={},a=0,s=Object.keys(e);a<s.length;a++){var n=s[a];i[n]=r[n]=e[n]}this.parent.columnByField[r.field]=r,this.parent.ganttColumns.push(new te(r)),t&&this.treeGridColumns.push(i)},e.prototype.durationValueAccessor=function(e,t,i){var r=t.ganttProperties;return sf.base.isNullOrUndefined(r)?"":this.parent.dataOperation.getDurationString(r.duration,r.durationUnit)},e.prototype.resourceValueAccessor=function(e,t,i){var r=t.ganttProperties;return sf.base.isNullOrUndefined(r)?"":r.resourceNames},e.prototype.workValueAccessor=function(e,t,i){var r=t.ganttProperties;return sf.base.isNullOrUndefined(r)?"":this.parent.dataOperation.getWorkString(r.work,r.workUnit)},e.prototype.taskTypeValueAccessor=function(e,t,i){var r=t.ganttProperties;return sf.base.isNullOrUndefined(r)?"":r.taskType},e.prototype.modeValueAccessor=function(e,t,i){return t[e]?"Manual":"Auto"},e.prototype.idValueAccessor=function(e,t,i){return 0===t.level?"R-"+t.ganttProperties.taskId:"T-"+t.ganttProperties.taskId},e.prototype.updateScrollTop=function(e){this.treeGridElement.querySelector(".e-content").scrollTop=sf.base.getValue("top",e),this.previousScroll.top=this.treeGridElement.querySelector(".e-content").scrollTop},e.prototype.treeGridClickHandler=function(e){this.parent.notify("treeGridClick",e)},e.prototype.removeEventListener=function(){this.parent.off("renderPanels",this.createContainer),this.parent.off("chartScroll",this.updateScrollTop),this.parent.off("destroy",this.destroy),this.parent.treeGrid.off("reactTemplateRender",this.renderReactTemplate)},e.prototype.destroy=function(){this.removeEventListener(),this.unWireEvents(),this.parent.treeGrid.element&&this.parent.treeGrid.destroy()},e}(),re=(f=function(e,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}f(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ae=function(e,t,r,a){var s,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var d=e.length-1;d>=0;d--)(s=e[d])&&(o=(n<3?s(o):n>3?s(t,r,o):s(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},se=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return re(t,e),ae([sf.base.Property(null)],t.prototype,"from",void 0),ae([sf.base.Property(null)],t.prototype,"to",void 0),t}(sf.base.ChildProperty),ne=(g=function(e,t){return(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}g(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),oe=function(e,t,r,a){var s,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var d=e.length-1;d>=0;d--)(s=e[d])&&(o=(n<3?s(o):n>3?s(t,r,o):s(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},de=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ne(t,e),oe([sf.base.Property(null)],t.prototype,"type",void 0),oe([sf.base.Property(null)],t.prototype,"headerText",void 0),oe([sf.base.Property([])],t.prototype,"fields",void 0),t}(sf.base.ChildProperty),le=(m=function(e,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}m(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),pe=function(e,t,r,a){var s,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var d=e.length-1;d>=0;d--)(s=e[d])&&(o=(n<3?s(o):n>3?s(t,r,o):s(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},he=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return le(t,e),pe([sf.base.Property(null)],t.prototype,"type",void 0),pe([sf.base.Property(null)],t.prototype,"headerText",void 0),pe([sf.base.Property([])],t.prototype,"fields",void 0),t}(sf.base.ChildProperty),ce=(y=function(e,t){return(y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}y(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ue=function(e,t,r,a){var s,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var d=e.length-1;d>=0;d--)(s=e[d])&&(o=(n<3?s(o):n>3?s(t,r,o):s(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},fe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ce(t,e),ue([sf.base.Property(!1)],t.prototype,"allowEditing",void 0),ue([sf.base.Property(!1)],t.prototype,"allowAdding",void 0),ue([sf.base.Property(!1)],t.prototype,"allowDeleting",void 0),ue([sf.base.Property("Auto")],t.prototype,"mode",void 0),ue([sf.base.Property("Top")],t.prototype,"newRowPosition",void 0),ue([sf.base.Property(!1)],t.prototype,"showDeleteConfirmDialog",void 0),ue([sf.base.Property(!1)],t.prototype,"allowTaskbarEditing",void 0),t}(sf.base.ChildProperty),ge=(b=function(e,t){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}b(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),me=function(e,t,r,a){var s,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var d=e.length-1;d>=0;d--)(s=e[d])&&(o=(n<3?s(o):n>3?s(t,r,o):s(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),me([sf.base.Property(null)],t.prototype,"day",void 0),me([sf.base.Property(null)],t.prototype,"label",void 0),me([sf.base.Property(null)],t.prototype,"cssClass",void 0),t}(sf.base.ChildProperty),be=(v=function(e,t){return(v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}v(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ve=function(e,t,r,a){var s,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var d=e.length-1;d>=0;d--)(s=e[d])&&(o=(n<3?s(o):n>3?s(t,r,o):s(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},De=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return be(t,e),ve([sf.base.Collection([],sf.grids.Predicate)],t.prototype,"columns",void 0),ve([sf.base.Property("Menu")],t.prototype,"type",void 0),ve([sf.base.Property()],t.prototype,"operators",void 0),ve([sf.base.Property(!1)],t.prototype,"ignoreAccent",void 0),ve([sf.base.Property("Parent")],t.prototype,"hierarchyMode",void 0),t}(sf.base.ChildProperty),we=(D=function(e,t){return(D=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}D(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ke=function(e,t,r,a){var s,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var d=e.length-1;d>=0;d--)(s=e[d])&&(o=(n<3?s(o):n>3?s(t,r,o):s(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},Te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return we(t,e),ke([sf.base.Property([])],t.prototype,"fields",void 0),ke([sf.base.Property(!1)],t.prototype,"ignoreCase",void 0),ke([sf.base.Property("contains")],t.prototype,"operator",void 0),ke([sf.base.Property("")],t.prototype,"key",void 0),ke([sf.base.Property("Parent")],t.prototype,"hierarchyMode",void 0),t}(sf.base.ChildProperty),Se=(w=function(e,t){return(w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}w(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Pe=function(e,t,r,a){var s,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var d=e.length-1;d>=0;d--)(s=e[d])&&(o=(n<3?s(o):n>3?s(t,r,o):s(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},Ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Se(t,e),Pe([sf.base.Property(null)],t.prototype,"from",void 0),Pe([sf.base.Property(null)],t.prototype,"to",void 0),Pe([sf.base.Property(null)],t.prototype,"label",void 0),Pe([sf.base.Property(null)],t.prototype,"cssClass",void 0),t}(sf.base.ChildProperty),xe=(k=function(e,t){return(k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}k(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Re=function(e,t,r,a){var s,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var d=e.length-1;d>=0;d--)(s=e[d])&&(o=(n<3?s(o):n>3?s(t,r,o):s(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},Me=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return xe(t,e),Re([sf.base.Property(null)],t.prototype,"rightLabel",void 0),Re([sf.base.Property(null)],t.prototype,"leftLabel",void 0),Re([sf.base.Property(null)],t.prototype,"taskLabel",void 0),t}(sf.base.ChildProperty),Oe=(T=function(e,t){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}T(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Ie=function(e,t,r,a){var s,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var d=e.length-1;d>=0;d--)(s=e[d])&&(o=(n<3?s(o):n>3?s(t,r,o):s(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},Ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Oe(t,e),Ie([sf.base.Property("Row")],t.prototype,"mode",void 0),Ie([sf.base.Property("Flow")],t.prototype,"cellSelectionMode",void 0),Ie([sf.base.Property("Single")],t.prototype,"type",void 0),Ie([sf.base.Property(!1)],t.prototype,"persistSelection",void 0),Ie([sf.base.Property(!1)],t.prototype,"enableToggle",void 0),t}(sf.base.ChildProperty),Fe=(S=function(e,t){return(S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}S(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Ve=function(e,t,r,a){var s,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var d=e.length-1;d>=0;d--)(s=e[d])&&(o=(n<3?s(o):n>3?s(t,r,o):s(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},Ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Fe(t,e),Ve([sf.base.Property(null)],t.prototype,"position",void 0),Ve([sf.base.Property(-1)],t.prototype,"columnIndex",void 0),Ve([sf.base.Property(4)],t.prototype,"separatorSize",void 0),Ve([sf.base.Property(null)],t.prototype,"minimum",void 0),Ve([sf.base.Property("Default")],t.prototype,"view",void 0),t}(sf.base.ChildProperty),Le=(P=function(e,t){return(P=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}P(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Ne=function(e,t,r,a){var s,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var d=e.length-1;d>=0;d--)(s=e[d])&&(o=(n<3?s(o):n>3?s(t,r,o):s(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},Be=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Le(t,e),Ne([sf.base.Property(null)],t.prototype,"id",void 0),Ne([sf.base.Property(null)],t.prototype,"name",void 0),Ne([sf.base.Property(null)],t.prototype,"parentID",void 0),Ne([sf.base.Property(null)],t.prototype,"startDate",void 0),Ne([sf.base.Property(null)],t.prototype,"endDate",void 0),Ne([sf.base.Property(null)],t.prototype,"dependency",void 0),Ne([sf.base.Property(null)],t.prototype,"progress",void 0),Ne([sf.base.Property(null)],t.prototype,"child",void 0),Ne([sf.base.Property(null)],t.prototype,"milestone",void 0),Ne([sf.base.Property(null)],t.prototype,"duration",void 0),Ne([sf.base.Property(null)],t.prototype,"durationUnit",void 0),Ne([sf.base.Property(null)],t.prototype,"cssClass",void 0),Ne([sf.base.Property(null)],t.prototype,"baselineStartDate",void 0),Ne([sf.base.Property(null)],t.prototype,"baselineEndDate",void 0),Ne([sf.base.Property(null)],t.prototype,"resourceInfo",void 0),Ne([sf.base.Property(null)],t.prototype,"expandState",void 0),Ne([sf.base.Property(null)],t.prototype,"indicators",void 0),Ne([sf.base.Property(null)],t.prototype,"notes",void 0),Ne([sf.base.Property(null)],t.prototype,"work",void 0),Ne([sf.base.Property(null)],t.prototype,"manual",void 0),Ne([sf.base.Property(null)],t.prototype,"type",void 0),Ne([sf.base.Property(null)],t.prototype,"segments",void 0),Ne([sf.base.Property(null)],t.prototype,"segmentId",void 0),t}(sf.base.ChildProperty),Ae=(C=function(e,t){return(C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}C(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),We=function(e,t,r,a){var s,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var d=e.length-1;d>=0;d--)(s=e[d])&&(o=(n<3?s(o):n>3?s(t,r,o):s(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},He=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ae(t,e),We([sf.base.Property("")],t.prototype,"format",void 0),We([sf.base.Property("None")],t.prototype,"unit",void 0),We([sf.base.Property(1)],t.prototype,"count",void 0),We([sf.base.Property(null)],t.prototype,"formatter",void 0),t}(sf.base.ChildProperty),je=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ae(t,e),We([sf.base.Property("Week")],t.prototype,"timelineViewMode",void 0),We([sf.base.Complex({},He)],t.prototype,"topTier",void 0),We([sf.base.Complex({},He)],t.prototype,"bottomTier",void 0),We([sf.base.Property(33)],t.prototype,"timelineUnitSize",void 0),We([sf.base.Property(0)],t.prototype,"weekStartDay",void 0),We([sf.base.Property(null)],t.prototype,"weekendBackground",void 0),We([sf.base.Property(!0)],t.prototype,"showTooltip",void 0),We([sf.base.Property(!0)],t.prototype,"updateTimescaleView",void 0),t}(sf.base.ChildProperty),Ge=(x=function(e,t){return(x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}x(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),qe=function(e,t,r,a){var s,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var d=e.length-1;d>=0;d--)(s=e[d])&&(o=(n<3?s(o):n>3?s(t,r,o):s(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},ze=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ge(t,e),qe([sf.base.Property(!0)],t.prototype,"showTooltip",void 0),qe([sf.base.Property()],t.prototype,"taskbar",void 0),qe([sf.base.Property()],t.prototype,"baseline",void 0),qe([sf.base.Property()],t.prototype,"connectorLine",void 0),qe([sf.base.Property()],t.prototype,"editing",void 0),t}(sf.base.ChildProperty),_e=(R=function(e,t){return(R=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}R(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Xe=function(e,t,r,a){var s,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var d=e.length-1;d>=0;d--)(s=e[d])&&(o=(n<3?s(o):n>3?s(t,r,o):s(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},Ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return _e(t,e),Xe([sf.base.Property()],t.prototype,"field",void 0),Xe([sf.base.Property()],t.prototype,"direction",void 0),t}(sf.base.ChildProperty),Ze=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return _e(t,e),Xe([sf.base.Collection([],Ye)],t.prototype,"columns",void 0),Xe([sf.base.Property(!0)],t.prototype,"allowUnsort",void 0),t}(sf.base.ChildProperty),Qe=(M=function(e,t){return(M=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}M(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Ke=function(e,t,r,a){var s,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var d=e.length-1;d>=0;d--)(s=e[d])&&(o=(n<3?s(o):n>3?s(t,r,o):s(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},Je=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Qe(t,e),Ke([sf.base.Property(null)],t.prototype,"id",void 0),Ke([sf.base.Property(null)],t.prototype,"name",void 0),Ke([sf.base.Property(null)],t.prototype,"unit",void 0),Ke([sf.base.Property(null)],t.prototype,"group",void 0),t}(sf.base.ChildProperty),$e=(O=function(e,t){return(O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}O(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),et=function(e){function t(t){var i=e.call(this,t)||this;return i.taskBarHeight=0,i.milestoneHeight=0,i.milesStoneRadius=0,i.baselineTop=0,i.baselineHeight=3,i.touchLeftConnectorpoint="",i.touchRightConnectorpoint="",i.dropSplit=!1,i.refreshedTr=[],i.refreshedData=[],i.parent=t,i.initPublicProp(),i.addEventListener(),i}return $e(t,e),t.prototype.initPublicProp=function(){this.ganttChartTableBody=null},t.prototype.addEventListener=function(){this.parent.on("renderPanels",this.createChartTable,this),this.parent.on("dataReady",this.initiateTemplates,this),this.parent.on("destroy",this.destroy,this)},t.prototype.refreshChartByTimeline=function(){this.taskTable.style.width=sf.base.formatUnit(this.parent.timelineModule.totalTimelineWidth),this.refreshGanttRows()},t.prototype.createChartTable=function(){this.taskTable=sf.base.createElement("table",{className:"e-task-table e-zero-spacing",id:"GanttTaskTable"+this.parent.element.id,styles:"z-index: 2;position: absolute;width:"+this.parent.timelineModule.totalTimelineWidth+"px;",attrs:{cellspacing:"0.25px"}});var e=sf.base.createElement("colgroup"),t=sf.base.createElement("col",{styles:"width:"+this.parent.timelineModule.totalTimelineWidth+"px;"});(e.appendChild(t),this.taskTable.appendChild(e),this.ganttChartTableBody=sf.base.createElement("tbody",{id:this.parent.element.id+"GanttTaskTableBody"}),this.taskTable.appendChild(this.ganttChartTableBody),this.parent.virtualScrollModule&&this.parent.enableVirtualization)?(this.parent.ganttChartModule.virtualRender.renderWrapper(),sf.base.getValue("wrapper",this.parent.ganttChartModule.virtualRender).style.transform="translate(0px, 0px)"):this.parent.ganttChartModule.chartBodyContent.appendChild(this.taskTable)},t.prototype.initiateTemplates=function(){this.taskTable.style.width=sf.base.formatUnit(this.parent.timelineModule.totalTimelineWidth),this.initChartHelperPrivateVariable(),this.initializeChartTemplate()},t.prototype.renderChartRows=function(){this.createTaskbarTemplate(),this.parent.isGanttChartRendered=!0},t.prototype.getIndicatorNode=function(e){var t='<label class="'+X+' e-indicator-span"  style="line-height:'+this.parent.rowHeight+"px;left:"+this.getIndicatorleft(e.date)+'px;"><i class="'+e.iconClass+'"></i> </label>';return this.createDivElement(t)},t.prototype.getIndicatorleft=function(e){return e=this.parent.dateValidationModule.getDateFromFormat(e),this.parent.dataOperation.getTaskLeft(e,!1)},t.prototype.getChildTaskbarNode=function(e,t){var i=null,r=this.templateData;if(this.childTaskbarTemplateFunction)i=this.childTaskbarTemplateFunction(sf.base.extend({index:e},r),this.parent,"TaskbarTemplate",this.getTemplateID("TaskbarTemplate"),!1,void 0,t[0]);else{var a="",s="",n=void 0,o=void 0;if(r.ganttProperties.startDate&&r.ganttProperties.endDate&&r.ganttProperties.duration&&(n=this.createDivElement('<div class="e-gantt-child-taskbar-inner-div '+z+" "+(r.ganttProperties.isAutoSchedule?"":"e-gantt-child-manualtaskbar")+'"style="width:'+r.ganttProperties.width+"px;height:"+this.taskBarHeight+'px;"></div>'),o=this.createDivElement('<div class="'+H+" e-gantt-child-progressbar "+(r.ganttProperties.isAutoSchedule?"":"e-gantt-child-manualprogressbar")+'" style="border-style:'+(r.ganttProperties.progressWidth?"solid;":"none;")+"width:"+r.ganttProperties.progressWidth+"px;height:100%;border-top-right-radius:"+this.getBorderRadius(r.ganttProperties)+"px;border-bottom-right-radius:"+this.getBorderRadius(r.ganttProperties)+'px;"></div>')),this.taskLabelTemplateFunction&&!sf.base.isNullOrUndefined(o)&&o.length>0){var d=this.taskLabelTemplateFunction(sf.base.extend({index:e},r),this.parent,"TaskLabelTemplate",this.getTemplateID("TaskLabelTemplate"),!1,void 0,o[0]);if(d&&d.length>0){var l=sf.base.createElement("div");l.appendChild(d[0]),a=l.innerHTML}}else a="isCustomTemplate"===(a=this.getTaskLabel(this.parent.labelSettings.taskLabel))?this.parent.labelSettings.taskLabel:a;a&&(s='<span class="'+W+'" style="line-height:'+(this.taskBarHeight-1)+"px; text-align:"+("ResourceView"===this.parent.viewType?"left;":"")+"display:"+("ResourceView"===this.parent.viewType?"inline-flex;":"")+"width:"+("ResourceView"===this.parent.viewType?r.ganttProperties.width-10:"")+"px; height:"+this.taskBarHeight+'px;">'+a+"</span>");var p=!sf.base.isNullOrUndefined(r.ganttProperties.segments)&&r.ganttProperties.segments.length>0?this.splitTaskbar(r,a):r.ganttProperties.startDate&&r.ganttProperties.endDate&&r.ganttProperties.duration?s:!r.ganttProperties.startDate||r.ganttProperties.endDate||r.ganttProperties.duration?!r.ganttProperties.endDate||r.ganttProperties.startDate||r.ganttProperties.duration?!r.ganttProperties.duration||r.ganttProperties.startDate||r.ganttProperties.endDate?"":'<div class="'+H+" "+z+" e-gantt-unscheduled-taskbar "+(r.ganttProperties.isAutoSchedule?"":"e-gantt-child-manualtaskbar")+'"style="left:'+r.ganttProperties.left+"px; width:"+r.ganttProperties.width+"px; height:"+this.taskBarHeight+'px;"></div>':'<div class="'+H+" "+z+" e-gantt-unscheduled-taskbar-right "+(r.ganttProperties.isAutoSchedule?"":"e-gantt-child-manualtaskbar")+'"style="left:'+r.ganttProperties.left+"px; height:"+this.taskBarHeight+'px;"></div>':'<div class="'+H+" "+z+" e-gantt-unscheduled-taskbar-left "+(r.ganttProperties.isAutoSchedule?"":"e-gantt-child-manualtaskbar")+'"style="left:'+r.ganttProperties.left+"px; height:"+this.taskBarHeight+'px;"></div>';r.ganttProperties.startDate&&r.ganttProperties.endDate&&r.ganttProperties.duration&&sf.base.isNullOrUndefined(r.ganttProperties.segments)?(""!==p&&!sf.base.isNullOrUndefined(o)&&o.length>0&&o[0].appendChild([].slice.call(this.createDivElement(p))[0]),!sf.base.isNullOrUndefined(n)&&n.length>0&&n[0].appendChild([].slice.call(o)[0]),i=n):i=this.createDivElement(p)}return i},t.prototype.splitTaskbar=function(e,t){for(var i="",r=0;r<e.ganttProperties.segments.length;r++){var a=e.ganttProperties.segments[r];i+='<div class="e-gantt-child-taskbar-inner-div '+(0===r?"e-segment-first":r===e.ganttProperties.segments.length-1?"e-segment-last":"e-segment-inprogress")+" "+z+'  e-segmented-taskbar"style="width:'+a.width+"px;position: absolute; left:"+a.left+"px;height:"+this.taskBarHeight+'px; overflow: initial;" data-segment-index = "'+r+'" aria-label = "'+this.generateSpiltTaskAriaLabel(a,e.ganttProperties)+'"> '+this.getSplitTaskbarLeftResizerNode()+'<div class="'+H+' e-gantt-child-progressbar " style="border-style:'+(a.progressWidth?"solid;":"none;")+"display:"+(a.progressWidth>=0?"block;":"none;")+"width:"+a.progressWidth+"px;height:100%;border-top-right-radius:"+this.getSplitTaskBorderRadius(a)+"px;border-bottom-right-radius:"+this.getSplitTaskBorderRadius(a)+'px;"><span class="'+W+'" style="line-height:'+(this.taskBarHeight-1)+"px;display:"+(a.showProgress?"inline;":"none;")+"height:"+this.taskBarHeight+'px;">'+t+"</span></div>"+this.getSplitTaskbarRightResizerNode(a)+(a.showProgress?this.getSplitProgressResizerNode(a):"")+"</div></div>"}return i},t.prototype.getSplitTaskbarLeftResizerNode=function(){return'<div class="e-taskbar-left-resizer e-icon" style="left:'+-(this.parent.isAdaptive?12:2)+"px;height:"+this.taskBarHeight+'px;"></div>'},t.prototype.getSplitTaskbarRightResizerNode=function(e){var t=this.parent.isAdaptive?-2:-10;return'<div class="e-taskbar-right-resizer e-icon" style="left:'+(e.width+t)+"px;height:"+this.taskBarHeight+'px;"></div>'},t.prototype.getSplitProgressResizerNode=function(e){return'<div class="'+q+'" style="left:'+(e.progressWidth-6)+"px;margin-top:"+(this.taskBarHeight-4)+'px;"><div class="e-progressbar-handler"><div class="e-progressbar-handler-element"></div><div class="e-progressbar-handler-after"></div></div>'},t.prototype.getSegmentIndex=function(e,t){var i=-1,r=t.ganttProperties,a=r.segments;if(!sf.base.isNullOrUndefined(a)){a.sort((function(e,t){return e.startDate.getTime()-t.startDate.getTime()}));for(var s=a.length,n=0;n<s;n++){var o=a[n];if(e.getTime()===r.startDate.getTime())this.dropSplit=!0,i=0;else if(e.getTime()===o.startDate.getTime()){this.dropSplit=!0;var d=o.startDate;d.setDate(d.getDate()+1),d=o.startDate=this.parent.dataOperation.checkStartDate(d,r,!1),o.startDate=d;var l=o.endDate;l=this.parent.dataOperation.getEndDate(d,o.duration,r.durationUnit,r,!1),o.endDate=l,n===a.length-1&&this.parent.setRecordValue("endDate",l,r,!0),this.incrementSegments(a,n,t),i=o.segmentIndex}else o.endDate=this.parent.dataOperation.getEndDate(o.startDate,o.duration,r.durationUnit,r,!1),e.getTime()>=o.startDate.getTime()&&e.getTime()<=o.endDate.getTime()&&(i=o.segmentIndex);this.parent.setRecordValue("segments",r.segments,r,!0)}}return i},t.prototype.mergeTask=function(e,t){var i=t.length,r=this.parent.taskFields,a=this.parent.flatData.filter((function(t){return t[r.id]===e?t:null}))[0],s=a.ganttProperties.segments;t=t.sort((function(e,t){return t.firstSegmentIndex-e.firstSegmentIndex}));for(var n=0;n<i;n++){var o,d=s[t[n].firstSegmentIndex],l=s[t[n].secondSegmentIndex],p=d.duration+l.duration,h=this.parent.dataOperation.getEndDate(d.startDate,p,a.ganttProperties.durationUnit,a.ganttProperties,!1);o={startDate:d.startDate,endDate:h,duration:p};var c=t[n].firstSegmentIndex;s.splice(c,2,o),this.parent.setRecordValue("segments",s,a.ganttProperties,!0),this.parent.dataOperation.updateMappingData(a,"segments"),1===s.length?(this.parent.setRecordValue("endDate",h,a.ganttProperties,!0),this.parent.setRecordValue("segments",null,a.ganttProperties,!0),this.parent.dataOperation.updateMappingData(a,"segments")):a.ganttProperties.endDate!==s[s.length-1].endDate&&this.parent.setRecordValue("endDate",s[s.length-1].endDate,a.ganttProperties,!0)}this.refreshChartAfterSegment(a,"mergeSegment")},t.prototype.refreshChartAfterSegment=function(e,t){this.parent.setRecordValue("segments",this.parent.dataOperation.setSegmentsInfo(e,!1),e.ganttProperties,!0),this.parent.dataOperation.updateMappingData(e,"segments"),this.parent.dataOperation.updateWidthLeft(e),this.parent.predecessorModule&&this.parent.taskFields.dependency?(this.parent.predecessorModule.updatedRecordsDateByPredecessor(),this.parent.connectorLineModule.removePreviousConnectorLines(this.parent.flatData),this.parent.connectorLineEditModule.refreshEditedRecordConnectorLine(this.parent.flatData),this.refreshRecords(this.parent.currentViewData)):this.refreshRow(this.parent.currentViewData.indexOf(e));var i=this.ganttChartTableBody.querySelectorAll("tr")[this.parent.currentViewData.indexOf(e)];this.triggerQueryTaskbarInfoByIndex(i,e),this.parent.selectionModule.clearSelection();var r={requestType:t,rowData:e};this.parent.trigger("actionComplete",r)},t.prototype.splitTask=function(e,t){var i=this.parent.taskFields,r=t,a=this.parent.flatData.filter((function(t){return t[i.id]===e?t:null}))[0],s=a.ganttProperties;this.dropSplit=!1;var n=-1,o=s.segments;if(sf.base.isNullOrUndefined(t.length)||t.length<0){var d=this.parent.dataOperation.checkStartDate(r,s,!1);if(d.getTime()!==s.startDate.getTime()&&s.isAutoSchedule){if(sf.base.isNullOrUndefined(o)||(n=this.getSegmentIndex(d,a)),!1===this.dropSplit&&r.getTime()>s.startDate.getTime()&&r.getTime()<s.endDate.getTime()){o=-1!==n?o:[];var l=-1!==n?o[n].startDate:new Date(s.startDate.getTime()),p=-1!==n?o[n].endDate:new Date(s.endDate.getTime()),h=this.parent.dataOperation.getDuration(l,p,s.durationUnit,s.isAutoSchedule,s.isMilestone);this.parent.setRecordValue("segments",this.splitSegmentedTaskbar(l,p,r,n,o,a,h),s,!0),-1!==n&&this.incrementSegments(o,n+1,a),this.parent.setRecordValue("endDate",o[o.length-1].endDate,s,!0),this.parent.taskFields.endDate&&this.parent.dataOperation.updateMappingData(a,"endDate")}this.refreshChartAfterSegment(a,"splitTaskbar")}}else t.sort(),this.parent.setRecordValue("segments",this.constructSegments(t,a.ganttProperties),a.ganttProperties,!0),this.refreshChartAfterSegment(a,"splitTask")},t.prototype.constructSegments=function(e,t){for(var i,r,a,s=[],n=new Date,o=0;o<e.length+1&&(n=0===o?t.startDate:n,n=this.parent.dataOperation.checkStartDate(n,t,!1),r=o!==e.length?new Date(e[o].getTime())>t.endDate?t.endDate:new Date(e[o].getTime()):t.endDate,r=this.parent.dataOperation.checkEndDate(r,t,!1),a=this.parent.dataOperation.getDuration(n,r,t.durationUnit,t.isAutoSchedule,t.isMilestone),r.getTime()>=n.getTime()&&(i={startDate:n,endDate:r,duration:a},s.push(i)),o!==e.length);o++)(n=new Date(e[o].getTime())).setDate(e[o].getDate()+1);return s},t.prototype.splitSegmentedTaskbar=function(e,t,i,r,a,s,n){var o=s.ganttProperties;this.parent.taskFields;e=this.parent.dataOperation.checkStartDate(e,o,!1);var d=new Date(i.getTime());d=this.parent.dataOperation.checkEndDate(d,o,!1);for(var l=this.parent.nonWorkingDayIndex.indexOf(i.getDay()),p=-1===l?0:0===l?1:2,h=0;h<2;h++){var c={startDate:e,endDate:d,duration:this.parent.dataOperation.getDuration(e,d,o.durationUnit,o.isAutoSchedule,o.isMilestone),offsetDuration:1};if(-1!==r&&(a.splice(r,1),r=-1),a.push(c),(e=new Date(i.getTime())).setDate(e.getDate()+1+p),e=this.parent.dataOperation.checkStartDate(e,o,!1),(d=new Date(t.getTime())).setDate(d.getDate()+1),-1!==this.parent.nonWorkingDayIndex.indexOf(d.getDay())){var u=n-c.duration;d=this.parent.dataOperation.getEndDate(e,u,o.durationUnit,o,!1)}else d=this.parent.dataOperation.checkEndDate(d,o,!1)}return a.sort((function(e,t){return e.startDate.getTime()-t.startDate.getTime()})),a},t.prototype.incrementSegments=function(e,t,i){for(var r=i.ganttProperties,a=t+1;a<e.length;a++){var s,n=e[a],o=0!==a?new Date(e[a-1].endDate.getTime()):new Date(n.startDate.getTime());o=this.parent.dataOperation.getEndDate(o,n.offsetDuration,r.durationUnit,r,!1),o=this.parent.dataOperation.checkStartDate(o,r,!1),n.startDate=o,s=n.endDate=this.parent.dataOperation.getEndDate(o,n.duration,r.durationUnit,r,!1),n.endDate=s,a===e.length-1&&(this.parent.setRecordValue("endDate",s,r,!0),this.parent.taskFields.endDate&&this.parent.dataOperation.updateMappingData(i,"endDate"))}e.sort((function(e,t){return e.startDate.getTime()-t.startDate.getTime()})),this.parent.setRecordValue("segments",e,r,!0),this.parent.dataOperation.updateMappingData(i,"segments")},t.prototype.getMilestoneNode=function(e,t){var i=null,r=this.templateData;if(this.milestoneTemplateFunction)i=this.milestoneTemplateFunction(sf.base.extend({index:e},r),this.parent,"MilestoneTemplate",this.getTemplateID("MilestoneTemplate"),!1,void 0,t[0]);else{var a='<div class="e-gantt-milestone" style="position:absolute;"><div class="e-milestone-top '+(r.ganttProperties.startDate||r.ganttProperties.endDate?"":"e-unscheduled-milestone-top")+'" style="border-right-width:'+this.milesStoneRadius+"px;border-left-width:"+this.milesStoneRadius+"px;border-bottom-width:"+this.milesStoneRadius+'px;"></div><div class="e-milestone-bottom '+(r.ganttProperties.startDate||r.ganttProperties.endDate?"":"e-unscheduled-milestone-bottom")+'" style="top:'+this.milesStoneRadius+"px;border-right-width:"+this.milesStoneRadius+"px; border-left-width:"+this.milesStoneRadius+"px; border-top-width:"+this.milesStoneRadius+'px;"></div></div>';i=this.createDivElement(a)}return i},t.prototype.getTaskBaselineNode=function(){var e=this.templateData,t='<div class="'+j+' " style="margin-top:'+this.baselineTop+"px;left:"+e.ganttProperties.baselineLeft+"px;width:"+e.ganttProperties.baselineWidth+"px;height:"+this.baselineHeight+"px;"+(this.baselineColor?"background-color: "+this.baselineColor+";":"")+'"></div>';return this.createDivElement(t)},t.prototype.getMilestoneBaselineNode=function(){var e='<div class="e-baseline-gantt-milestone-container " style="left:'+(this.templateData.ganttProperties.baselineLeft-this.milesStoneRadius)+"px;margin-top:"+(2-Math.floor(this.parent.rowHeight-this.milestoneMarginTop))+'px"><div class="e-baseline-gantt-milestone"><div class="e-baseline-gantt-milestone e-baseline-milestone-top"  style="top:'+-this.milestoneHeight+"px;border-right:"+this.milesStoneRadius+"px solid transparent;border-left:"+this.milesStoneRadius+"px solid transparent;border-top:0pxsolid transparent;border-bottom-width:"+this.milesStoneRadius+"px;border-bottom-style: solid;"+(this.baselineColor?"border-bottom-color: "+this.baselineColor+";":"")+'"></div><div class="e-baseline-gantt-milestone e-baseline-milestone-bottom"  style="top:'+(this.milesStoneRadius-this.milestoneHeight)+"px;border-right:"+this.milesStoneRadius+"px solid transparent;border-left:"+this.milesStoneRadius+"px solid transparent;border-bottom:0pxsolid transparent;border-top-width:"+this.milesStoneRadius+"px;border-top-style: solid;"+(this.baselineColor?"border-top-color: "+this.baselineColor+";":"")+'"></div></div></div>';return this.createDivElement(e)},t.prototype.getLeftLabelNode=function(e){var t=this.leftLabelContainer();t[0].setAttribute("aria-label",this.generateTaskLabelAriaLabel("left"));var i=null;if(this.leftTaskLabelTemplateFunction)i=this.leftTaskLabelTemplateFunction(sf.base.extend({index:e},this.templateData),this.parent,"LeftLabelTemplate",this.getTemplateID("LeftLabelTemplate"),!1,void 0,t[0]);else{var r=this.parent.labelSettings.leftLabel,a=this.getTaskLabel(r);a&&(a="isCustomTemplate"===a?r:a,i=this.getLableText(a,"e-left-label-inner-div"))}return i&&i.length>0&&t[0].appendChild([].slice.call(i)[0]),t},t.prototype.getLableText=function(e,t){var i=sf.base.createElement("div",{className:t,styles:"height:"+this.taskBarHeight+"px;margin-top:"+this.taskBarMarginTop+"px;"}),r=sf.base.createElement("span",{className:X});r[this.parent.disableHtmlEncode?"textContent":"innerHTML"]=e,i.appendChild(r);var a=sf.base.createElement("div");return a.appendChild(i),a.childNodes},t.prototype.getRightLabelNode=function(e){var t=this.rightLabelContainer();t[0].setAttribute("aria-label",this.generateTaskLabelAriaLabel("right"));var i=null;if(this.rightTaskLabelTemplateFunction)i=this.rightTaskLabelTemplateFunction(sf.base.extend({index:e},this.templateData),this.parent,"RightLabelTemplate",this.getTemplateID("RightLabelTemplate"),!1,void 0,t[0]);else{var r=this.parent.labelSettings.rightLabel,a=this.getTaskLabel(r);a&&(a="isCustomTemplate"===a?r:a,i=this.getLableText(a,"e-right-label-inner-div"))}return i&&i.length>0&&t[0].appendChild([].slice.call(i)[0]),t},t.prototype.getManualTaskbar=function(){var e=this.templateData,t=this.taskBarHeight/2-1,i=e.ganttProperties.startDate&&e.ganttProperties.endDate&&e.ganttProperties.duration?'<div class="'+_+'" style="width:'+e.ganttProperties.width+"px;height:"+t/5+"px;border-left-width:"+t/5+"px; border-bottom:"+t/5+'px solid transparent;"></div>':e.ganttProperties.startDate||e.ganttProperties.endDate||!e.ganttProperties.duration?'<div class="'+_+" "+(e.ganttProperties.startDate?"e-gantt-unscheduled-taskbar-left":"e-gantt-unscheduled-taskbar-right")+'" style="width:'+e.ganttProperties.width+"px;height:"+2*t+"px;border-left-width:"+t/5+"px; border-bottom:"+t/5+'px solid transparent;"></div>':'<div class="'+_+' e-gantt-unscheduled-manualtask" style="width:'+e.ganttProperties.width+"px;height:"+(t/5+1)+"px;border-left-width:"+t/5+"px; border-bottom:"+t/5+'px solid transparent;"></div>',r='<div class="e-manualparent-main-container"style=left:'+(e.ganttProperties.left-e.ganttProperties.autoLeft)+"px;width:"+e.ganttProperties.width+"px;height:"+t+"px;>"+i+(e.ganttProperties.startDate&&e.ganttProperties.endDate&&e.ganttProperties.duration||e.ganttProperties.duration?'<div class="e-gantt-manualparenttaskbar-left" style="height:'+t+"px;border-left-width:"+t/5+"px; border-bottom:"+t/5+'px solid transparent;"></div><div class="e-gantt-manualparenttaskbar-right" style=left:'+(e.ganttProperties.width-t/5)+"px;height:"+t+"px;border-right-width:"+t/5+"px;border-bottom:"+t/5+"px solid transparent;></div></div>":""),a='<div class="e-gantt-manualparent-milestone" style="position:absolute;left:'+(e.ganttProperties.left-e.ganttProperties.autoLeft-this.milestoneHeight/2)+"px;width:"+2*this.milesStoneRadius+'px;"><div class="e-manualparent-milestone-top" style="border-right-width:'+this.milesStoneRadius+"px;border-left-width:"+this.milesStoneRadius+"px;border-bottom-width:"+this.milesStoneRadius+'px;"></div><div class="e-manualparent-milestone-bottom" style="top:'+this.milesStoneRadius+"px;border-right-width:"+this.milesStoneRadius+"px; border-left-width:"+this.milesStoneRadius+"px; border-top-width:"+this.milesStoneRadius+'px;"></div></div>';return this.createDivElement(0===e.ganttProperties.width?a:r)},t.prototype.getParentTaskbarNode=function(e,t){var i=null,r=this.templateData;if(this.parentTaskbarTemplateFunction)i=this.parentTaskbarTemplateFunction(sf.base.extend({index:e},r),this.parent,"ParentTaskbarTemplate",this.getTemplateID("ParentTaskbarTemplate"),!1,void 0,t[0]);else{var a="",s=void 0,n=this.taskBarHeight/5,o=this.createDivElement('<div class="e-gantt-parent-taskbar-inner-div '+this.getExpandClass(r)+' e-gantt-parent-taskbar" style="width:'+(r.ganttProperties.isAutoSchedule?r.ganttProperties.width:r.ganttProperties.autoWidth)+"px;height:"+(r.ganttProperties.isAutoSchedule?this.taskBarHeight:3*n)+"px;margin-top:"+(r.ganttProperties.isAutoSchedule?"":2*n)+'px;"></div>'),d=this.createDivElement('<div class="e-gantt-parent-progressbar-inner-div '+this.getExpandClass(r)+' e-gantt-parent-progressbar" style="border-style:'+(r.ganttProperties.progressWidth?"solid;":"none;")+"width:"+r.ganttProperties.progressWidth+"px;border-top-right-radius:"+this.getBorderRadius(r)+"px;border-bottom-right-radius:"+this.getBorderRadius(r)+'px;height:100%;"></div>');if(this.taskLabelTemplateFunction){var l=this.taskLabelTemplateFunction(sf.base.extend({index:e},r),this.parent,"TaskLabelTemplate",this.getTemplateID("TaskLabelTemplate"),!1,void 0,d[0]);if(l&&l.length>0){var p=sf.base.createElement("div");p.appendChild(l[0]),a=p.innerHTML}}else a="isCustomTemplate"===(a=this.getTaskLabel(this.parent.labelSettings.taskLabel))?this.parent.labelSettings.taskLabel:a;""!==a&&(s=this.createDivElement('<span class="'+W+'" style="line-height:'+(this.taskBarHeight-1)+"px; display:"+("ResourceView"===this.parent.viewType?"inline-flex;":"")+"width:"+("ResourceView"===this.parent.viewType?r.ganttProperties.width-10:"")+"px; height:"+this.taskBarHeight+'px;">'+a+"</span>"),d[0].appendChild([].slice.call(s)[0]));var h='<div class="e-gantt-parent-milestone" style="position:absolute;"><div class="e-parent-milestone-top" style="border-right-width:'+this.milesStoneRadius+"px;border-left-width:"+this.milesStoneRadius+"px;border-bottom-width:"+this.milesStoneRadius+'px;"></div><div class="e-parent-milestone-bottom" style="top:'+this.milesStoneRadius+"px;border-right-width:"+this.milesStoneRadius+"px; border-left-width:"+this.milesStoneRadius+"px; border-top-width:"+this.milesStoneRadius+'px;"></div></div>';o[0].appendChild([].slice.call(d)[0]),i=r.ganttProperties.isMilestone?this.createDivElement(r.ganttProperties.isAutoSchedule?h:""):o}return i},t.prototype.getTableTrNode=function(){var e=sf.base.createElement("table"),t="Horizontal"===this.parent.gridLines||"Both"===this.parent.gridLines?"e-chart-row-border":"";return e.innerHTML='<tr class="'+this.getRowClassName(this.templateData)+" "+G+'"style="display:'+this.getExpandDisplayProp(this.templateData)+";height:"+this.parent.rowHeight+'px;"><td class="e-chart-row-cell '+t+'" style="width:'+this.parent.timelineModule.totalTimelineWidth+'px;"></td></tr>',e.childNodes},t.prototype.initializeChartTemplate=function(){sf.base.isNullOrUndefined(this.parent.parentTaskbarTemplate)||(this.parentTaskbarTemplateFunction=this.templateCompiler(this.parent.parentTaskbarTemplate)),!sf.base.isNullOrUndefined(this.parent.labelSettings.leftLabel)&&this.isTemplate(this.parent.labelSettings.leftLabel)&&(this.leftTaskLabelTemplateFunction=this.templateCompiler(this.parent.labelSettings.leftLabel)),!sf.base.isNullOrUndefined(this.parent.labelSettings.rightLabel)&&this.isTemplate(this.parent.labelSettings.rightLabel)&&(this.rightTaskLabelTemplateFunction=this.templateCompiler(this.parent.labelSettings.rightLabel)),!sf.base.isNullOrUndefined(this.parent.labelSettings.taskLabel)&&this.isTemplate(this.parent.labelSettings.taskLabel)&&(this.taskLabelTemplateFunction=this.templateCompiler(this.parent.labelSettings.taskLabel)),sf.base.isNullOrUndefined(this.parent.taskbarTemplate)||(this.childTaskbarTemplateFunction=this.templateCompiler(this.parent.taskbarTemplate)),sf.base.isNullOrUndefined(this.parent.milestoneTemplate)||(this.milestoneTemplateFunction=this.templateCompiler(this.parent.milestoneTemplate))},t.prototype.createDivElement=function(e){var t=sf.base.createElement("div");return t.innerHTML=e,t.childNodes},t.prototype.isTemplate=function(e){var t=!1;return("string"!=typeof e||0===e.indexOf("#")||e.indexOf("<")>-1||e.indexOf("$")>-1)&&(t=!0),t},t.prototype.getTemplateID=function(e){return this.parent.element.id+e},t.prototype.updateTaskbarBlazorTemplate=function(e,t){var i=!0,r=!0,a=!0;t&&(t.ganttProperties.isMilestone?r=a=!1:t.hasChildRecords?i=a=!1:t.hasChildRecords||(r=i=!1)),this.parentTaskbarTemplateFunction&&r&&(e?sf.base.updateBlazorTemplate(this.getTemplateID("ParentTaskbarTemplate"),"ParentTaskbarTemplate",this.parent,!1):sf.base.resetBlazorTemplate(this.getTemplateID("ParentTaskbarTemplate"),"ParentTaskbarTemplate")),this.childTaskbarTemplateFunction&&a&&(e?sf.base.updateBlazorTemplate(this.getTemplateID("TaskbarTemplate"),"TaskbarTemplate",this.parent,!1):sf.base.resetBlazorTemplate(this.getTemplateID("TaskbarTemplate"),"TaskbarTemplate")),this.milestoneTemplateFunction&&i&&(e?sf.base.updateBlazorTemplate(this.getTemplateID("MilestoneTemplate"),"MilestoneTemplate",this.parent,!1):sf.base.resetBlazorTemplate(this.getTemplateID("MilestoneTemplate"),"MilestoneTemplate")),this.leftTaskLabelTemplateFunction&&(e?sf.base.updateBlazorTemplate(this.getTemplateID("LeftLabelTemplate"),"LeftLabelTemplate",this.parent.labelSettings,!1):sf.base.resetBlazorTemplate(this.getTemplateID("LeftLabelTemplate"),"LeftLabelTemplate")),this.rightTaskLabelTemplateFunction&&(e?sf.base.updateBlazorTemplate(this.getTemplateID("RightLabelTemplate"),"RightLabelTemplate",this.parent.labelSettings,!1):sf.base.resetBlazorTemplate(this.getTemplateID("RightLabelTemplate"),"RightLabelTemplate")),this.taskLabelTemplateFunction&&(r||a)&&(e?sf.base.updateBlazorTemplate(this.getTemplateID("TaskLabelTemplate"),"TaskLabelTemplate",this.parent.labelSettings,!1):sf.base.resetBlazorTemplate(this.getTemplateID("TaskLabelTemplate"),"TaskLabelTemplate"))},t.prototype.leftLabelContainer=function(){var e='<div class="'+(this.leftTaskLabelTemplateFunction?"e-left-label-container e-left-label-temp-container":N)+' " tabindex="-1" style="height:'+(this.parent.rowHeight-1)+"px;width:"+this.taskNameWidth(this.templateData)+'"></div>';return this.createDivElement(e)},t.prototype.taskbarContainer=function(){var e=this.templateData,t=!(!this.parent.editModule||!this.parent.editSettings.allowTaskbarEditing||"ParentResizing"!==this.parent.editModule.taskbarEditModule.taskBarEditAction),i='<div class="'+A+" "+this.parent.getUnscheduledTaskClass(e.ganttProperties)+" "+(e.ganttProperties.cssClass?e.ganttProperties.cssClass:"")+'"  tabindex="-1" style="'+(e.ganttProperties.isMilestone&&!t?"width:"+this.milestoneHeight+"px;height:"+this.milestoneHeight+"px;margin-top:"+this.milestoneMarginTop+"px;left:"+(e.ganttProperties.left-this.milestoneHeight/2)+"px;":"width:"+e.ganttProperties.width+"px;margin-top:"+this.taskBarMarginTop+"px;left:"+(!e.hasChildRecords||e.ganttProperties.isAutoSchedule?e.ganttProperties.left:e.ganttProperties.autoLeft)+"px;height:"+this.taskBarHeight+"px;cursor:"+(e.ganttProperties.isAutoSchedule?"move;":"auto;"))+'"></div>';return this.createDivElement(i)},t.prototype.rightLabelContainer=function(){var e='<div class="'+(this.rightTaskLabelTemplateFunction?"e-right-label-container e-right-label-temp-container":B)+'"  tabindex="-1" style="left:'+this.getRightLabelLeft(this.templateData)+"px;height:"+(this.parent.rowHeight-1)+'px;"></div>';return this.createDivElement(e)},t.prototype.childTaskbarLeftResizer=function(){var e='<div class="e-taskbar-left-resizer e-icon" style="left:'+-(this.parent.isAdaptive?12:2)+"px;height:"+this.taskBarHeight+'px;"></div>';return this.createDivElement(e)},t.prototype.childTaskbarRightResizer=function(){var e=this.parent.isAdaptive?-2:-10,t='<div class="e-taskbar-right-resizer e-icon" style="left:'+(this.templateData.ganttProperties.width+e)+"px;height:"+this.taskBarHeight+'px;"></div>';return this.createDivElement(t)},t.prototype.childTaskbarProgressResizer=function(){var e='<div class="'+q+'" style="left:'+(this.templateData.ganttProperties.progressWidth-6)+"px;margin-top:"+(this.taskBarHeight-4)+'px;"><div class="e-progressbar-handler"><div class="e-progressbar-handler-element"></div><div class="e-progressbar-handler-after"></div></div>';return this.createDivElement(e)},t.prototype.getLeftPointNode=function(){var e=this.templateData,t=-((this.parent.isAdaptive?14:2)+this.connectorPointWidth),i=-(this.connectorPointWidth+2),r=Math.floor(this.milesStoneRadius-this.connectorPointWidth/2),a='<div class="e-left-connectorpoint-outer-div" style="'+(e.ganttProperties.isMilestone?"margin-top:"+r+"px;left:"+i+"px;":"margin-top:"+this.connectorPointMargin+"px;left:"+t+"px;")+'"><div class="'+Y+" "+this.parent.getUnscheduledTaskClass(e.ganttProperties)+'" style="width: '+this.connectorPointWidth+"px;height: "+this.connectorPointWidth+'px;">'+this.touchLeftConnectorpoint+"</div></div>";return this.createDivElement(a)},t.prototype.getRightPointNode=function(){var e=this.templateData,t=this.parent.isAdaptive?10:-2,i=Math.floor(this.milesStoneRadius-this.connectorPointWidth/2),r='<div class="e-right-connectorpoint-outer-div" style="'+(e.ganttProperties.isMilestone?"left:"+(this.milestoneHeight-2)+"px;margin-top:"+i+"px;":"left:"+(e.ganttProperties.width+t)+"px;margin-top:"+this.connectorPointMargin+"px;")+'"><div class="e-connectorpoint-right '+this.parent.getUnscheduledTaskClass(e.ganttProperties)+'" style="width:'+this.connectorPointWidth+"px;height:"+this.connectorPointWidth+'px;">'+this.touchRightConnectorpoint+"</div></div>";return this.createDivElement(r)},t.prototype.getTaskLabel=function(e){var t=this.parent.ganttColumns.length,i=null;if(sf.base.isNullOrUndefined(e)||""===e)i="";else if(e===this.parent.taskFields.resourceInfo)i=this.getResourceName(this.templateData);else{for(var r=0;r<t;r++)if(e===this.parent.ganttColumns[r].field){i=this.getFieldValue(this.templateData[e]).toString();break}if(sf.base.isNullOrUndefined(i))return"isCustomTemplate"}return i},t.prototype.getExpandDisplayProp=function(e){return e=this.templateData,this.parent.getExpandStatus(e)?"table-row":"none"},t.prototype.getRowClassName=function(e){var t="gridrowtaskId",i=(e=this.templateData).parentItem;return i&&(t+=i.taskId.toString()),t+="level",t+=e.level.toString()},t.prototype.getBorderRadius=function(e){var t=(e=this.templateData).ganttProperties.width-e.ganttProperties.progressWidth;return t<=4?4-t:0},t.prototype.getSplitTaskBorderRadius=function(e){var t=e.width-e.progressWidth;return t<=4?4-t:0},t.prototype.taskNameWidth=function(e){var t,i=(e=this.templateData).ganttProperties;return(t=e.ganttProperties.isMilestone?e.ganttProperties.left-this.parent.getTaskbarHeight()/2:e.hasChildRecords&&!i.isAutoSchedule?this.parent.allowUnscheduledTasks?i.left<i.autoLeft?i.left:i.autoLeft:i.autoStartDate.getTime()<i.startDate.getTime()?i.autoLeft:i.left:e.ganttProperties.left)<0&&(t=0),t+"px"},t.prototype.getRightLabelLeft=function(e){var t,i,r=(e=this.templateData).ganttProperties;return e.ganttProperties.isMilestone?e.ganttProperties.left+this.parent.getTaskbarHeight()/2:e.hasChildRecords&&!r.isAutoSchedule?(this.parent.allowUnscheduledTasks?(t=r.left<r.autoLeft?r.left:r.autoLeft,i=r.autoWidth):(t=r.autoStartDate.getTime()<r.startDate.getTime()?r.autoLeft:r.left,i=(r.autoEndDate.getTime()<r.endDate.getTime()?this.parent.dataOperation.getTaskLeft(r.endDate,r.isMilestone):this.parent.dataOperation.getTaskLeft(r.autoEndDate,r.isMilestone))-t),t+i):e.ganttProperties.left+e.ganttProperties.width},t.prototype.getExpandClass=function(e){return(e=this.templateData).expanded?"e-row-expand":!e.expanded&&e.hasChildRecords?"e-row-collapse":""},t.prototype.getFieldValue=function(e){return sf.base.isNullOrUndefined(e)?"":e},t.prototype.getResourceName=function(e){e=this.templateData;var t=null;if(!sf.base.isNullOrUndefined(e.ganttProperties.resourceInfo)){var i=e.ganttProperties.resourceInfo.length;if(i>0){for(var r=0;r<i;r++){var a=e.ganttProperties.resourceInfo[r][this.parent.resourceFields.name],s=e.ganttProperties.resourceInfo[r][this.parent.resourceFields.unit];100!==s&&(a+="["+s+"%]"),sf.base.isNullOrUndefined(t)?t=a:t+=" , "+a}return t}return""}return""},t.prototype.initChartHelperPrivateVariable=function(){if(this.baselineColor=sf.base.isNullOrUndefined(this.parent.baselineColor)||""===this.parent.baselineColor?null:this.parent.baselineColor,this.taskBarHeight=sf.base.isNullOrUndefined(this.parent.taskbarHeight)||this.parent.taskbarHeight>=this.parent.rowHeight?Math.floor(.62*this.parent.rowHeight):this.parent.taskbarHeight,this.parent.renderBaseline){var e=void 0;e=this.taskBarHeight+this.baselineHeight<=this.parent.rowHeight?this.taskBarHeight:this.taskBarHeight-(this.baselineHeight+1),this.taskBarHeight=e}this.milestoneHeight=Math.floor(.82*this.taskBarHeight),this.taskBarMarginTop=Math.floor((this.parent.rowHeight-this.taskBarHeight)/2),this.milestoneMarginTop=Math.floor((this.parent.rowHeight-this.milestoneHeight)/2),this.milesStoneRadius=Math.floor(this.milestoneHeight/2),this.baselineTop=-(Math.floor(this.parent.rowHeight-(this.taskBarHeight+this.taskBarMarginTop))-1),this.connectorPointWidth=this.parent.isAdaptive?Math.round(this.taskBarHeight/2):8,this.connectorPointMargin=Math.floor(this.taskBarHeight/2-this.connectorPointWidth/2)},t.prototype.refreshGanttRows=function(){if(this.parent.currentViewData=this.parent.treeGrid.getCurrentViewRecords().slice(),this.createTaskbarTemplate(),"ResourceView"===this.parent.viewType&&this.parent.showOverAllocation){for(var e=0;e<this.parent.currentViewData.length;e++){var t=this.parent.currentViewData[e];t.childRecords.length>0&&(this.parent.setRecordValue("workTimelineRanges",this.parent.dataOperation.mergeRangeCollections(t.ganttProperties.workTimelineRanges,!0),t.ganttProperties,!0),this.parent.dataOperation.calculateRangeLeftWidth(t.ganttProperties.workTimelineRanges))}this.parent.ganttChartModule.renderRangeContainer(this.parent.currentViewData)}},t.prototype.createTaskbarTemplate=function(){this.updateTaskbarBlazorTemplate(!1);var e=[].slice.call(this.ganttChartTableBody.querySelectorAll("tr"));this.ganttChartTableBody.innerHTML="";var t=[],i=this.parent.treeGridModule.prevCurrentView;if(this.parent.enableImmutableMode&&i&&i.length>0){this.refreshedTr=[],this.refreshedData=[];for(var r={},a=[],s=this.parent.treeGrid.getPrimaryKeyFieldNames()[0],n=0;n<i.length;n++)a[n]=e[n],r[i[n][s]]=n;for(var o=0;o<this.parent.currentViewData.length;o++){var d=r[this.parent.currentViewData[o][s]],l=this.parent.modifiedRecords.indexOf(this.parent.currentViewData[o]);if(sf.base.isNullOrUndefined(d)||-1!==l){var p=this.getGanttChartRow(o,this.parent.currentViewData[o]);this.ganttChartTableBody.appendChild(p),this.refreshedTr.push(this.ganttChartTableBody.querySelectorAll("tr")[o]),this.refreshedData.push(this.parent.currentViewData[o])}else sf.base.isNullOrUndefined(d)||-1!==l||this.ganttChartTableBody.appendChild(a[d]);this.ganttChartTableBody.querySelectorAll("tr")[o].setAttribute("aria-rowindex",o.toString())}}else for(n=0;n<this.parent.currentViewData.length;n++){var h=this.parent.currentViewData[n];"ResourceView"===this.parent.viewType&&!h.expanded&&this.parent.enableMultiTaskbar&&t.push(h);p=this.getGanttChartRow(n,h);this.ganttChartTableBody.appendChild(p),this.parent.selectionModule&&this.parent.allowSelection&&this.parent.selectionModule.maintainSelectedRecords(parseInt(p.getAttribute("aria-rowindex"),10))}if(this.triggerQueryTaskbarInfo(),this.parent.modifiedRecords=[],t.length)for(var c=0;c<t.length;c++)t[c].hasChildRecords&&(this.parent.isGanttChartRendered=!0,this.parent.chartRowsModule.refreshRecords([t[c]]));this.parent.renderTemplates(),this.updateTaskbarBlazorTemplate(!0)},t.prototype.getGanttChartRow=function(e,t){this.templateData=t;var i=null,a=this.getTableTrNode(),s=this.getLeftLabelNode(e),n=this.taskbarContainer();if(n[0].setAttribute("aria-label",this.generateAriaLabel(this.templateData)),n[0].setAttribute("rowUniqueId",this.templateData.ganttProperties.rowUniqueID),!this.templateData.hasChildRecords){var o=this.getLeftPointNode();n[0].appendChild([].slice.call(o)[0])}if(this.templateData.hasChildRecords){var d=this.getParentTaskbarNode(e,n);if(!this.templateData.ganttProperties.isAutoSchedule){var l=this.getManualTaskbar();n[0].appendChild([].slice.call(l)[0])}d&&d.length>0&&n[0].appendChild([].slice.call(d)[0]),this.parent.renderBaseline&&this.templateData.ganttProperties.baselineStartDate&&this.templateData.ganttProperties.baselineEndDate&&(i=this.getTaskBaselineNode())}else if(this.templateData.ganttProperties.isMilestone){var p=this.getMilestoneNode(e,n);p&&p.length>0&&n[0].appendChild([].slice.call(p)[0]),this.parent.renderBaseline&&this.templateData.ganttProperties.baselineStartDate&&this.templateData.ganttProperties.baselineEndDate&&(i=this.getMilestoneBaselineNode())}else{var h=r(this.templateData.ganttProperties),c=null,u=null,f=null;if(!sf.base.isNullOrUndefined(h)){(h||this.templateData.ganttProperties.duration)&&h&&(sf.base.isNullOrUndefined(this.templateData.ganttProperties.segments)||this.templateData.ganttProperties.segments.length<=0)&&(c=this.childTaskbarProgressResizer(),f=this.childTaskbarLeftResizer(),u=this.childTaskbarRightResizer());var g=this.getChildTaskbarNode(e,n);if(f&&n[0].appendChild([].slice.call(f)[0]),g&&g.length>0)if(this.templateData.ganttProperties.segments&&this.templateData.ganttProperties.segments.length>0){var m,y=this.templateData.ganttProperties.segments.length;m=this.createDivElement('<div class="e-gantt-split-container-line"></div>'),n[0].appendChild([].slice.call(m)[0]);for(var b=0;b<y;b++)n[0].appendChild([].slice.call(g)[0])}else n[0].appendChild([].slice.call(g)[0]);c&&n[0].appendChild([].slice.call(c)[0]),u&&n[0].appendChild([].slice.call(u)[0])}this.parent.renderBaseline&&this.templateData.ganttProperties.baselineStartDate&&this.templateData.ganttProperties.baselineEndDate&&(i=this.getTaskBaselineNode())}if(!this.templateData.hasChildRecords){var v=this.getRightPointNode();n[0].appendChild([].slice.call(v)[0])}var D=this.getRightLabelNode(e);if(a[0].childNodes[0].childNodes[0].appendChild([].slice.call(s)[0]),a[0].childNodes[0].childNodes[0].appendChild([].slice.call(n)[0]),this.templateData.ganttProperties.indicators&&this.templateData.ganttProperties.indicators.length>0)for(var w=void 0,k=void 0,T=this.templateData.ganttProperties.indicators,S=0;S<T.length;S++){if(w=this.getIndicatorNode(T[S]),T[S].name.indexOf("$")>-1||T[S].name.indexOf("#")>-1)k=this.templateCompiler(T[S].name)(sf.base.extend({index:e},this.templateData),this.parent,"indicatorLabelText");else{var P=sf.base.createElement("Text");P.innerHTML=T[S].name,k=P.childNodes}w[0].appendChild([].slice.call(k)[0]),w[0].title=sf.base.isNullOrUndefined(T[S].tooltip)?"":T[S].tooltip,a[0].childNodes[0].childNodes[0].appendChild([].slice.call(w)[0])}D&&D.length>0&&a[0].childNodes[0].childNodes[0].appendChild([].slice.call(D)[0]),sf.base.isNullOrUndefined(i)||a[0].childNodes[0].childNodes[0].appendChild([].slice.call(i)[0]);var C=a[0].childNodes[0];return this.setAriaRowIndex(t,C),C},t.prototype.setAriaRowIndex=function(e,t){var i=this.parent.treeGrid.getCurrentViewRecords(),r=(this.parent.virtualScrollModule&&this.parent.enableVirtualization?sf.base.getValue("virtualScrollModule.visualData",this.parent.treeGrid):i).indexOf(e);t.setAttribute("aria-rowindex",r.toString())},t.prototype.triggerQueryTaskbarInfo=function(){if(this.parent.queryTaskbarInfo)for(var e,t,i=this.refreshedTr.length>0?this.refreshedTr.length:this.ganttChartTableBody.querySelectorAll("tr").length,r=0;r<i;r++){e=this.refreshedTr.length>0?this.refreshedTr[r]:this.ganttChartTableBody.querySelectorAll("tr")[r],t=this.refreshedData.length>0?this.refreshedData[r]:this.parent.currentViewData[r];var a=!sf.base.isNullOrUndefined(t.ganttProperties.segments)&&t.ganttProperties.segments.length;if(a>0)for(var s=0;s<a;s++){var n=e.getElementsByClassName("e-segmented-taskbar")[s];this.triggerQueryTaskbarInfoByIndex(n,t)}else this.triggerQueryTaskbarInfoByIndex(e,t)}},t.prototype.triggerQueryTaskbarInfoByIndex=function(e,t){var i,r,a,s=this;i=!sf.base.isNullOrUndefined(t.ganttProperties.segments)&&t.ganttProperties.segments.length>0?e:e.querySelector("."+A);var n={data:t,rowElement:e,taskbarElement:i,taskbarType:t.hasChildRecords?"ParentTask":t.ganttProperties.isMilestone?"Milestone":"ChildTask"},o=this.getClassName(n);if("Milestone"===n.taskbarType)n.milestoneColor=i.querySelector(o[0])?getComputedStyle(i.querySelector(o[0])).borderBottomColor:null,n.baselineColor=e.querySelector(o[1])?getComputedStyle(e.querySelector(o[1])).borderBottomColor:null;else{var d=i.querySelector(o[0]),l=i.querySelector(o[1]);n.taskbarBgColor=sf.base.isNullOrUndefined(d)?null:i.classList.contains(z)?getComputedStyle(i).backgroundColor:getComputedStyle(i.querySelector(o[0])).backgroundColor,n.taskbarBorderColor=sf.base.isNullOrUndefined(d)?null:i.classList.contains(z)?getComputedStyle(i).backgroundColor:getComputedStyle(i.querySelector(o[0])).borderColor,n.progressBarBgColor=sf.base.isNullOrUndefined(l)?null:i.classList.contains("e-gantt-child-progressbar")?getComputedStyle(i).backgroundColor:getComputedStyle(i.querySelector(o[1])).backgroundColor,n.baselineColor=e.querySelector("."+j)?getComputedStyle(e.querySelector("."+j)).backgroundColor:null,n.taskLabelColor=i.querySelector("."+W)?getComputedStyle(i.querySelector("."+W)).color:null}n.rightLabelColor=e.querySelector("."+B)&&e.querySelector("."+B).querySelector("."+X)?getComputedStyle(e.querySelector("."+B).querySelector("."+X)).color:null,n.leftLabelColor=e.querySelector("."+N)&&e.querySelector("."+N).querySelector("."+X)?getComputedStyle(e.querySelector("."+N).querySelector("."+X)).color:null,sf.base.isBlazor()&&(r=n.rowElement,a=n.taskbarElement),this.parent.trigger("queryTaskbarInfo",n,(function(e){s.updateQueryTaskbarInfoArgs(e,r,a)}))},t.prototype.updateQueryTaskbarInfoArgs=function(e,t,i){var r=sf.base.isBlazor()&&t?t:e.rowElement,a=sf.base.isBlazor()&&i?i:e.taskbarElement,s=this.getClassName(e);"Milestone"===e.taskbarType?(a.querySelector(s[0])&&getComputedStyle(a.querySelector(s[0])).borderBottomColor!==e.milestoneColor&&(a.querySelector(s[0]).style.borderBottomColor=e.milestoneColor,a.querySelector(".e-milestone-bottom").style.borderTopColor=e.milestoneColor),r.querySelector(s[1])&&getComputedStyle(r.querySelector(s[1])).borderTopColor!==e.baselineColor&&(r.querySelector(s[1]).style.borderBottomColor=e.baselineColor,r.querySelector(".e-baseline-milestone-bottom").style.borderTopColor=e.baselineColor)):(a.querySelector(s[0])&&getComputedStyle(a.querySelector(s[0])).backgroundColor!==e.taskbarBgColor&&(a.querySelector(s[0]).style.backgroundColor=e.taskbarBgColor),a.querySelector(s[0])&&getComputedStyle(a.querySelector(s[0])).borderColor!==e.taskbarBorderColor&&(a.querySelector(s[0]).style.borderColor=e.taskbarBorderColor),a.querySelector(s[1])&&getComputedStyle(a.querySelector(s[1])).backgroundColor!==e.progressBarBgColor&&(a.querySelector(s[1]).style.backgroundColor=e.progressBarBgColor),a.classList.contains(z)&&getComputedStyle(a).backgroundColor!==e.taskbarBgColor&&(a.style.backgroundColor=e.taskbarBgColor),a.classList.contains(z)&&getComputedStyle(a).borderColor!==e.taskbarBorderColor&&(a.style.borderColor=e.taskbarBorderColor),a.classList.contains("e-gantt-child-progressbar")&&getComputedStyle(a).backgroundColor!==e.progressBarBgColor&&(a.style.backgroundColor=e.progressBarBgColor),a.querySelector("."+W)&&getComputedStyle(a.querySelector("."+W)).color!==e.taskLabelColor&&(a.querySelector("."+W).style.color=e.taskLabelColor),r.querySelector("."+j)&&getComputedStyle(r.querySelector("."+j)).backgroundColor!==e.baselineColor&&(r.querySelector("."+j).style.backgroundColor=e.baselineColor)),r.querySelector("."+N)&&r.querySelector("."+N).querySelector("."+X)&&getComputedStyle(r.querySelector("."+N).querySelector("."+X)).color!==e.leftLabelColor&&(r.querySelector("."+N).querySelector("."+X).style.color=e.leftLabelColor),r.querySelector("."+B)&&r.querySelector("."+B).querySelector("."+X)&&getComputedStyle(r.querySelector("."+B).querySelector("."+X)).color!==e.rightLabelColor&&(r.querySelector("."+B).querySelector("."+X).style.color=e.rightLabelColor)},t.prototype.getClassName=function(e){var t=[];return t.push("."+("ParentTask"===e.taskbarType?"e-gantt-parent-taskbar":"ChildTask"===e.taskbarType?z:"e-milestone-top")),t.push("."+("ParentTask"===e.taskbarType?"e-gantt-parent-progressbar":"ChildTask"===e.taskbarType?"e-gantt-child-progressbar":"e-baseline-milestone-top")),t},t.prototype.templateCompiler=function(e){if(!sf.base.isNullOrUndefined(e)&&""!==e)try{return document.querySelectorAll(e).length?sf.base.compile(document.querySelector(e).innerHTML.trim(),this.parent):sf.base.compile(e,this.parent)}catch(t){return sf.base.compile(e,this.parent)}return null},t.prototype.refreshRow=function(e,t){var i=this.ganttChartTableBody.childNodes[e],r=this.parent.currentViewData[e];if(-1!==e&&r){var a=r;"ResourceView"===this.parent.viewType&&a.hasChildRecords&&!a.expanded&&this.parent.enableMultiTaskbar?i.replaceChild(this.getResourceParent(a).childNodes[0],i.childNodes[0]):i.replaceChild(this.getGanttChartRow(e,a).childNodes[0],i.childNodes[0]),"ResourceView"===this.parent.viewType&&a.hasChildRecords&&this.parent.showOverAllocation&&(t?this.parent.ganttChartModule.renderRangeContainer(this.parent.currentViewData):(this.parent.dataOperation.updateOverlappingValues(a),this.parent.ganttChartModule.renderRangeContainer([a])));var s=!sf.base.isNullOrUndefined(a.ganttProperties.segments)&&a.ganttProperties.segments.length;if(s>0)for(var n=0;n<s;n++){var o=i.getElementsByClassName("e-segmented-taskbar")[n];this.triggerQueryTaskbarInfoByIndex(o,a)}else this.triggerQueryTaskbarInfoByIndex(i,a);this.triggerQueryTaskbarInfoByIndex(i,a);var d="ProjectView"===this.parent.viewType?a.ganttProperties.taskId:a.ganttProperties.rowUniqueID;this.parent.treeGrid.grid.setRowData(d,a),this.parent.treeGrid.grid.getRowObjectFromUID(this.parent.treeGrid.grid.getDataRows()[e].getAttribute("data-uid")).data=a}},t.prototype.getResourceParent=function(e){var t=this.parent.ganttChartModule.getChartRows();this.templateData=e;var i=this.getTableTrNode(),r=this.leftLabelContainer(),a=sf.base.createElement("div",{className:"e-collapse-parent"});i[0].childNodes[0].childNodes[0].appendChild(a);var s=this.parent.dataOperation.setSortedChildTasks(e);this.parent.dataOperation.updateOverlappingIndex(s);for(var n=0;n<t.length;n++)if(t[n].classList.contains("gridrowtaskId"+e.ganttProperties.rowUniqueID+"level"+(e.level+1))){var o=t[n].querySelector(".e-taskbar-main-container");sf.base.addClass([o],"collpse-parent-border");var d=t[n].querySelector("."+A).getAttribute("rowUniqueId"),l=this.parent.getRecordByID(d).ganttProperties.eOverlapIndex.toString(),p=o.cloneNode(!0);p.style.zIndex=l,i[0].childNodes[0].childNodes[0].childNodes[0].appendChild(p)}return i[0].childNodes[0].childNodes[0].appendChild([].slice.call(r)[0]),i[0].childNodes[0]},t.prototype.refreshRecords=function(e,t){if(this.parent.isGanttChartRendered){if(this.updateTaskbarBlazorTemplate(!1),"ResourceView"===this.parent.viewType&&this.parent.enableMultiTaskbar){e=new sf.data.DataManager(e).executeLocal((new sf.data.Query).sortBy("expanded","Descending"))}for(var i=0;i<e.length;i++){var r=this.parent.currentViewData.indexOf(e[i]);this.refreshRow(r,t)}this.parent.ganttChartModule.updateLastRowBottomWidth(),this.parent.renderTemplates(),this.updateTaskbarBlazorTemplate(!0)}},t.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("renderPanels",this.createChartTable),this.parent.off("dataReady",this.initiateTemplates),this.parent.off("destroy",this.destroy))},t.prototype.destroy=function(){this.removeEventListener()},t.prototype.generateAriaLabel=function(e){e=this.templateData;var t="",i=this.parent.localeObj.getConstant("name"),r=this.parent.localeObj.getConstant("startDate"),a=this.parent.localeObj.getConstant("endDate"),s=this.parent.localeObj.getConstant("duration"),n=e.ganttProperties.taskName,o=e.ganttProperties.startDate,d=e.ganttProperties.endDate,l=e.ganttProperties.duration;return e.ganttProperties.isMilestone?t=i+" "+n+" "+r+" "+this.parent.getFormatedDate(o):(n&&(t+=i+" "+n+" "),o&&(t+=r+" "+this.parent.getFormatedDate(o)+" "),d&&(t+=a+" "+this.parent.getFormatedDate(d)+" "),l&&(t+=s+" "+this.parent.getDurationString(l,e.ganttProperties.durationUnit))),t},t.prototype.generateSpiltTaskAriaLabel=function(e,t){var i="",r=this.parent.localeObj.getConstant("startDate"),a=this.parent.localeObj.getConstant("endDate"),s=this.parent.localeObj.getConstant("duration"),n=e.startDate,o=e.endDate,d=e.duration;return n&&(i+=r+" "+this.parent.getFormatedDate(n)+" "),o&&(i+=a+" "+this.parent.getFormatedDate(o)+" "),d&&(i+=s+" "+this.parent.getDurationString(d,t.durationUnit)),i},t.prototype.generateTaskLabelAriaLabel=function(e){var t="";return"left"===e&&this.parent.labelSettings.leftLabel&&!this.leftTaskLabelTemplateFunction?t+=this.parent.localeObj.getConstant("leftTaskLabel")+" "+this.getTaskLabel(this.parent.labelSettings.leftLabel):"right"===e&&this.parent.labelSettings.rightLabel&&!this.rightTaskLabelTemplateFunction&&(t+=this.parent.localeObj.getConstant("rightTaskLabel")+" "+this.getTaskLabel(this.parent.labelSettings.rightLabel)),t},t}(F),tt=function(){function e(e){this.parent=e,this.dateValidateModule=this.parent.dateValidationModule}return e.prototype.ensurePredecessorCollection=function(){for(var e=this.parent.predecessorsCollection,t=e.length-1;t>=0;t--){var i=e[t],r=i.ganttProperties;i.hasChildRecords||this.ensurePredecessorCollectionHelper(i,r)}},e.prototype.ensurePredecessorCollectionHelper=function(e,t){var r=t.predecessorsName;if(!r||"string"!=typeof r&&"number"!=typeof r){if(r&&"object"===i(r)&&r.length){for(var a=[],s=0;s<r.length;s++){var n=r[s],o={};o.from=sf.base.getValue("from",n),o.to=sf.base.getValue("to",n)?sf.base.getValue("to",n):t.rowUniqueID,o.type=sf.base.getValue("type",n)?sf.base.getValue("type",n):"FS";var d=sf.base.getValue("offset",n);if(sf.base.isNullOrUndefined(d))o.offset=0,o.offsetUnit=this.parent.durationUnit.toLocaleLowerCase();else if("string"==typeof d){var l=this.getOffsetDurationUnit(sf.base.getValue("offset",n));o.offset=l.duration,o.offsetUnit=l.durationUnit}else o.offset=parseFloat(d.toString()),o.offsetUnit=this.parent.durationUnit.toLocaleLowerCase();this.checkIsParent(o.from.toString())||a.push(o)}this.parent.setRecordValue("predecessor",a,t,!0)}}else this.parent.setRecordValue("predecessor",this.calculatePredecessor(r,e),t,!0);this.parent.setRecordValue("predecessorsName",this.getPredecessorStringValue(e),t,!0),this.parent.setRecordValue("taskData."+this.parent.taskFields.dependency,t.predecessorsName,e),this.parent.setRecordValue(this.parent.taskFields.dependency,t.predecessorsName,e)},e.prototype.updateUnscheduledDependency=function(e){for(var t=this.parent.taskFields,i=sf.base.isNullOrUndefined(e[t.dependency])?[]:e[t.dependency].toString().split(","),r=0;r<i.length;r++){var a=parseInt(i[r],10);if(!isNaN(a)){var s=this.parent.getRecordByID(a.toString()),n=sf.base.isNullOrUndefined(s)?null:sf.base.extend({},{},s.taskData,!0);!sf.base.isNullOrUndefined(n)&&sf.base.isNullOrUndefined(n[t.startDate])&&sf.base.isNullOrUndefined(n[t.duration])&&sf.base.isNullOrUndefined(n[t.endDate])&&(n[t.duration]=1,n[t.startDate]=this.parent.projectStartDate,this.parent.updateRecordByID(n))}}},e.prototype.checkIsParent=function(e){var t=!1;return this.parent.connectorLineModule.getRecordByID(e).hasChildRecords&&(t=!0),t},e.prototype.calculatePredecessor=function(e,t){var i,r,a,s,n=this,o=e.toString(),d=[];return o.split(",").forEach((function(e){r=e.split("+"),a="+",e.indexOf("-")>=0&&(r=e.split("-"),a="-"),i=r[0].match(/(\d+|[A-z]+)/g);var o="ResourceView"===n.parent.viewType?n.parent.getTaskIds():n.parent.ids,l="ResourceView"===n.parent.viewType?o.indexOf("T"+i[0]):o.indexOf(i[0]);if(i[0]&&-1!==l){if(i.length>1){var p=i[1].toUpperCase();s="FS"===p||"FF"===p||"SF"===p||"SS"===p?p:"FS"}else s="FS";var h=r.length>1?a+""+r[1]:"0",c=n.getOffsetDurationUnit(h),u={from:i[0],type:s,isDrawn:!1,to:"ResourceView"===n.parent.viewType?t.ganttProperties.taskId.toString():t.ganttProperties.rowUniqueID.toString(),offsetUnit:c.durationUnit,offset:c.duration};n.checkIsParent(i[0])||d.push(u)}})),d},e.prototype.getPredecessorStringValue=function(e){var t=e.ganttProperties.predecessor,i=this.parent.durationUnitTexts,r="";if(t)for(var a=t.length,s=0;s<a;s++){var n=t[s],o="",d="ResourceView"===this.parent.viewType?e.ganttProperties.taskId:e.ganttProperties.rowUniqueID;if(n.from!==d.toString()){if(o=n.from+n.type,0!==n.offset){o+=n.offset>0?"+"+n.offset+" ":n.offset+" ";var l=1!==n.offset;"day"===n.offsetUnit?o+=l?sf.base.getValue("days",i):sf.base.getValue("day",i):"hour"===n.offsetUnit?o+=l?sf.base.getValue("hours",i):sf.base.getValue("hour",i):o+=l?sf.base.getValue("minutes",i):sf.base.getValue("minute",i)}r=r.length>0?r+","+o:o}}return r},e.prototype.getOffsetDurationUnit=function(e){var t=0,i=this.parent.durationUnit.toLocaleLowerCase(),r=this.parent.durationUnitEditText;if("string"==typeof e){for(var a=e.match(/[^0-9]+|[0-9]+/g),s=0;s<a.length;s++)a[s]=a[s].trim();"-"===a[0]&&a[1]?(a[1]=a[0]+a[1],a.shift()):"+"===a[0]&&a.shift(),"."!==a[1]||isNaN(parseInt(a[2],10))||(a[0]+=a[1]+a[2],a.splice(1,2)),a&&a.length<=2&&(t=parseFloat(a[0]),i=a[1]?a[1].toLowerCase().trim():"",i=-1!==sf.base.getValue("minute",r).indexOf(i)?"minute":-1!==sf.base.getValue("hour",r).indexOf(i)?"hour":-1!==sf.base.getValue("day",r).indexOf(i)?"day":this.parent.durationUnit.toLocaleLowerCase())}else t=e,i=this.parent.durationUnit.toLocaleLowerCase();return isNaN(t)&&(t=0,i=this.parent.durationUnit.toLocaleLowerCase()),{duration:t,durationUnit:i}},e.prototype.updatePredecessors=function(){for(var e,t=this.parent.predecessorsCollection,i=t.length,r=0;r<i;r++)(e=t[r]).hasChildRecords||this.updatePredecessorHelper(e,t)},e.prototype.updatePredecessorHelper=function(e,t){var i,r,a;t=sf.base.isNullOrUndefined(t)?[]:t,a=(i=e.ganttProperties.predecessor).length;for(var s=0;s<a;s++){var n=i[s];r=this.parent.connectorLineModule.getRecordByID(n.from);var o="ResourceView"===this.parent.viewType?e.ganttProperties.taskId:e.ganttProperties.rowUniqueID;if(n.from!==o.toString()&&r){var d=void 0;r.ganttProperties.predecessor?((d=sf.base.extend([],r.ganttProperties.predecessor,[],!0)).push(n),this.parent.setRecordValue("predecessor",d,r.ganttProperties,!0)):((d=[]).push(n),this.parent.setRecordValue("predecessor",d,r.ganttProperties,!0),t.push(r))}}},e.prototype.updatedRecordsDateByPredecessor=function(){for(var e=this.parent.flatData,t=0;t<e.length;t++)e[t].ganttProperties.predecessor&&this.validatePredecessorDates(e[t])},e.prototype.validatePredecessorDates=function(e){if(e.ganttProperties.predecessor){var t=e.ganttProperties.predecessor,i=void 0,r=void 0,a=null,s="ResourceView"===this.parent.viewType?e.ganttProperties.taskId.toString():e.ganttProperties.rowUniqueID.toString(),n=t.filter((function(e){return e.to===s?e:null}));for(i=0;i<n.length;i++){var o;o=n[i],r=this.parent.connectorLineModule.getRecordByID(o.from),((a=this.parent.connectorLineModule.getRecordByID(o.to)).ganttProperties.isAutoSchedule||this.parent.validateManualTasksOnLinking)&&this.validateChildGanttRecord(r,a)}}},e.prototype.validateChildGanttRecord=function(e,t){if(this.parent.editedTaskBarItem!==t&&!sf.base.isNullOrUndefined(r(e.ganttProperties))&&!sf.base.isNullOrUndefined(r(t.ganttProperties))&&this.parent.isInPredecessorValidation&&(t.ganttProperties.isAutoSchedule||this.parent.validateManualTasksOnLinking)){var i=t.ganttProperties,a="ResourceView"===this.parent.viewType?i.taskId.toString():i.rowUniqueID.toString(),s=i.predecessor.filter((function(e){return e.to===a?e:null})),n=this.getPredecessorDate(t,s);this.parent.setRecordValue("startDate",n,i,!0),this.parent.dataOperation.updateMappingData(t,"startDate");var o=t.ganttProperties.segments;sf.base.isNullOrUndefined(o)&&this.dateValidateModule.calculateEndDate(t),this.parent.dataOperation.updateWidthLeft(t),t.parentItem&&this.parent.getParentTask(t.parentItem).ganttProperties.isAutoSchedule&&this.parent.isInPredecessorValidation&&this.parent.dataOperation.updateParentItems(t.parentItem)}},e.prototype.getPredecessorDate=function(e,t){var i,r,a,s,n=this,o=t.filter((function(t){var i="ResourceView"===n.parent.viewType?e.ganttProperties.taskId:e.ganttProperties.rowUniqueID;return t.to===i.toString()?t:null}));if(o)for(var d=o.length,l=0;l<d;l++){var p=o[l];a=this.parent.connectorLineModule.getRecordByID(p.from),s=this.parent.connectorLineModule.getRecordByID(p.to),r=this.getValidatedStartDate(s.ganttProperties,a.ganttProperties,p),null!=i&&1!==this.dateValidateModule.compareDates(r,i)||(i=r)}return i},e.prototype.getValidatedStartDate=function(e,t,i){var r,a,s=i.type,n=i.offset;switch(s){case"FS":r=this.dateValidateModule.getValidEndDate(t),e.isMilestone&&0===n||(r=this.dateValidateModule.checkStartDate(r,e)),0!==n&&(r=this.updateDateByOffset(r,i,e)),a=e.isMilestone?r:this.dateValidateModule.checkStartDate(r,e);break;case"FF":case"SF":r="FF"===s?this.dateValidateModule.getValidEndDate(t):this.dateValidateModule.getValidStartDate(t),0!==n&&(r=this.updateDateByOffset(r,i,e)),e.isMilestone||(r=this.dateValidateModule.checkEndDate(r,e)),a=this.dateValidateModule.getStartDate(r,e.duration,e.durationUnit,e);break;case"SS":r=this.dateValidateModule.getValidStartDate(t),0!==n&&(r=this.updateDateByOffset(r,i,e)),a=e.isMilestone?r:this.dateValidateModule.checkStartDate(r,e)}return a},e.prototype.updateDateByOffset=function(e,t,i){var r,a=t.offset,s=t.offsetUnit;return a<0?r=this.dateValidateModule.getStartDate(this.dateValidateModule.checkEndDate(e,i),-1*a,s,i):(r=this.dateValidateModule.getEndDate(e,a,s,i,!1),i.isMilestone||(r=this.dateValidateModule.checkStartDate(r,i))),r},e.prototype.createConnectorLinesCollection=function(e){var t,i,r=e||this.parent.currentViewData,a=r.length;for(this.parent.connectorLineModule.expandedRecords=this.parent.virtualScrollModule&&this.parent.enableVirtualization?this.parent.updatedRecords:this.parent.getExpandedRecords(this.parent.updatedRecords),t=0;t<a;t++)(i=r[t].ganttProperties.predecessor)&&this.addPredecessorsCollection(i)},e.prototype.addPredecessorsCollection=function(e){var t,i,r,a,s;if(e)for(t=e.length,i=0;i<t;i++){r=e[i];a=this.parent.connectorLineModule.getRecordByID(r.from),s=this.parent.connectorLineModule.getRecordByID(r.to),this.parent.connectorLineModule.expandedRecords&&-1!==this.parent.connectorLineModule.expandedRecords.indexOf(a)&&-1!==this.parent.connectorLineModule.expandedRecords.indexOf(s)&&this.updateConnectorLineObject(a,s,r)}},e.prototype.updateConnectorLineObject=function(e,t,i){var r;if(r=this.parent.connectorLineModule.createConnectorLineObject(e,t,i)){if(this.parent.connectorLineIds.length>0&&-1===this.parent.connectorLineIds.indexOf(r.connectorLineId)||0===this.parent.connectorLineIds.length)this.parent.updatedConnectorLineCollection.push(r),this.parent.connectorLineIds.push(r.connectorLineId);else if(-1!==this.parent.connectorLineIds.indexOf(r.connectorLineId)){var a=this.parent.connectorLineIds.indexOf(r.connectorLineId);this.parent.updatedConnectorLineCollection[a]=r}i.isDrawn=!0}return r},e.prototype.validatePredecessor=function(e,t,i){if(this.parent.isInPredecessorValidation&&e.ganttProperties.predecessor){for(var r=e.ganttProperties.predecessor,a=void 0,s=null,n=void 0,o=void 0,d="ResourceView"===this.parent.viewType?e.ganttProperties.taskId.toString():e.ganttProperties.rowUniqueID.toString(),l=r.filter((function(e){return e.to===d?e:null})),p=r.filter((function(e){return e.from===d?e:null})),h=0;h<l.length;h++){n=l[h],a=this.parent.connectorLineModule.getRecordByID(n.from),s=this.parent.connectorLineModule.getRecordByID(n.to),this.parent.isInPredecessorValidation&&s.ganttProperties.isAutoSchedule?this.parent.isValidationEnabled=!0:this.parent.isValidationEnabled=!1;var c="ResourceView"===this.parent.viewType?e.ganttProperties.taskId:e.ganttProperties.rowUniqueID;c.toString()!==n.to&&c.toString()!==n.from||i&&"predecessor"!==i||this.validateChildGanttRecord(a,s)}for(h=0;h<p.length;h++)o=p[h],a=this.parent.connectorLineModule.getRecordByID(o.from),s=this.parent.connectorLineModule.getRecordByID(o.to),this.parent.isInPredecessorValidation&&s.ganttProperties.isAutoSchedule?this.parent.isValidationEnabled=!0:this.parent.isValidationEnabled=!1,"predecessor"!==i&&this.parent.isValidationEnabled&&this.validateChildGanttRecord(a,s),!1!==a.expanded&&s.expanded,s&&this.validatePredecessor(s,void 0,"successor")}},e.prototype.getValidPredecessor=function(e){var t=this,i=[];if(!sf.base.isNullOrUndefined(e)){var r=e.ganttProperties.predecessor;r&&r.length>0&&(i=r.filter((function(i){var r="ResourceView"===t.parent.viewType?e.ganttProperties.taskId:e.ganttProperties.rowUniqueID;return i.from!==r.toString()})))}return i},e}(),it=function(){function e(e){this.expandedRecords=[],this.parent=e,this.dependencyViewContainer=sf.base.createElement("div",{className:"e-gantt-dependency-view-container"}),this.initPublicProp()}return e.prototype.getconnectorLineGap=function(e){return e.milestoneChild?this.parent.chartRowsModule.milestoneMarginTop/2+this.parent.chartRowsModule.milestoneHeight/2:this.parent.chartRowsModule.taskBarMarginTop/2+this.parent.chartRowsModule.taskBarHeight/2},e.prototype.initPublicProp=function(){this.lineColor=this.parent.connectorLineBackground,this.lineStroke=this.parent.connectorLineWidth>4?4:this.parent.connectorLineWidth,this.createConnectorLineTooltipTable()},e.prototype.getTaskbarMidpoint=function(e){return Math.floor(e?this.parent.chartRowsModule.milestoneMarginTop+this.parent.chartRowsModule.milestoneHeight/2:this.parent.chartRowsModule.taskBarMarginTop+this.parent.chartRowsModule.taskBarHeight/2)+1},e.prototype.createConnectorLineObject=function(e,t,i){var a={},s=this.parent.pdfExportModule&&this.parent.pdfExportModule.isPdfExport?this.parent.flatData:this.expandedRecords,n=s.indexOf(e),o=s.indexOf(t),d=e.ganttProperties,l=t.ganttProperties,p=this.parent.getExpandedRecords(this.parent.currentViewData);if(a.parentIndexInCurrentView=p.indexOf(e),a.childIndexInCurrentView=p.indexOf(t),!(this.parent.virtualScrollModule&&this.parent.enableVirtualization)&&(-1===a.parentIndexInCurrentView||-1===a.childIndexInCurrentView)||-1===a.parentIndexInCurrentView&&-1===a.childIndexInCurrentView)return null;a.parentLeft=d.isMilestone?d.left-this.parent.chartRowsModule.milestoneHeight/2:d.left,a.childLeft=l.isMilestone?l.left-this.parent.chartRowsModule.milestoneHeight/2:l.left,a.parentWidth=0===d.width||d.isMilestone?Math.floor(this.parent.chartRowsModule.milestoneHeight):d.width,a.childWidth=0===l.width||l.isMilestone?Math.floor(this.parent.chartRowsModule.milestoneHeight):l.width,a.parentIndex=n,a.childIndex=o;var h=this.parent.ganttChartModule.getChartRows()[0]&&this.parent.ganttChartModule.getChartRows()[0].getBoundingClientRect().height;a.rowHeight=h&&!isNaN(h)?h:this.parent.rowHeight,a.type=i.type;var c="ResourceView"===this.parent.viewType?d.taskId:d.rowUniqueID,u="ResourceView"===this.parent.viewType?l.taskId:l.rowUniqueID;return a.connectorLineId="parent"+c+"child"+u,a.milestoneParent=!!d.isMilestone,a.milestoneChild=!!l.isMilestone,sf.base.isNullOrUndefined(r(d))||sf.base.isNullOrUndefined(r(l))?null:a},e.prototype.renderConnectorLines=function(e){for(var t="",i=[],r=0;r<e.length;r++)t+=this.getConnectorLineTemplate(e[r]),i.push(e[r]);this.dependencyViewContainer.innerHTML=t;for(var a=this.parent.connectorLineModule.dependencyViewContainer.childNodes,s=0;s<a.length;s++)for(var n=a[s].childNodes,o=0;o<n.length;o++){var d=this.parent.connectorLineModule.generateAriaLabel(i[s]);n[o].setAttribute("aria-label",d)}this.parent.virtualScrollModule&&this.parent.enableVirtualization?this.parent.ganttChartModule.virtualRender.appendChildElements(this.dependencyViewContainer):this.parent.ganttChartModule.chartBodyContent.appendChild(this.dependencyViewContainer)},e.prototype.getParentPosition=function(e){if(e.parentIndex<e.childIndex){if("FF"===e.type)return e.childLeft+e.childWidth>=e.parentLeft+e.parentWidth?"FFType2":"FFType1";if(e.parentLeft<e.childLeft&&e.childLeft>e.parentLeft+e.parentWidth+25){if("FS"===e.type)return"FSType1";if("SF"===e.type)return"SFType1";if("SS"===e.type)return"SSType2";if("FF"===e.type)return"FFType2"}else if(e.parentLeft<e.childLeft&&e.childLeft<e.parentLeft+e.parentWidth||e.parentLeft===e.childLeft||e.parentLeft>e.childLeft){if(e.parentLeft>e.childLeft+e.childWidth+25&&"SF"===e.type)return"SFType2";if(e.parentLeft>e.childLeft){if("SS"===e.type)return"SSType1";if("SF"===e.type)return"SFType1";if("FF"===e.type)return"FFType1"}else if(e.childLeft+e.childWidth>e.parentLeft+e.parentWidth&&"FF"===e.type)return"FFType2";if("FS"===e.type)return"FSType2";if("SS"===e.type)return"SSType2";if("FF"===e.type)return"FFType1";if("SF"===e.type)return"SFType1"}else if(e.parentLeft<e.childLeft){if("FS"===e.type)return"FSType2";if("FF"===e.type)return"FFType2";if("SS"===e.type)return"SSType2";if("SF"===e.type)return"SFType1"}}else if(e.parentIndex>e.childIndex)if(e.parentLeft<e.childLeft&&e.childLeft>e.parentLeft+e.parentWidth){if("FS"===e.type)return 30>=e.childLeft-(e.milestoneParent?e.parentLeft+e.parentWidth+4:e.parentLeft+e.parentWidth)?"FSType3":"FSType4";if(e.parentLeft<e.childLeft||e.childLeft+e.childWidth>e.parentLeft+e.parentWidth){if("SS"===e.type)return"SSType4";if("FF"===e.type)return"FFType4";if("SF"===e.type)return"SFType4"}else if(e.childLeft+e.childWidth>e.parentLeft+e.parentWidth&&"FF"===e.type)return"FFType4"}else if(e.parentLeft<e.childLeft&&e.childLeft<e.parentLeft+e.parentWidth||e.parentLeft===e.childLeft||e.parentLeft>e.childLeft){if(e.childLeft+e.childWidth<=e.parentLeft+e.parentWidth){if("FF"===e.type)return"FFType3";if("SF"===e.type)return e.childLeft+e.childWidth+25<e.parentLeft?"SFType3":"SFType4";if("SS"===e.type)return e.childLeft<=e.parentLeft?"SSType3":"SSType4"}else if(e.childLeft+e.childWidth>e.parentLeft+e.parentWidth){if("FF"===e.type)return"FFType4";if("SF"===e.type)return"SFType4";if("SS"===e.type)return e.childLeft<=e.parentLeft?"SSType3":"SSType4"}if("FS"===e.type)return"FSType3"}else if(e.parentLeft<e.childLeft){if("FS"===e.type)return"FSType3";if("SS"===e.type)return"SSType4";if("FF"===e.type)return"FFType4";if("SF"===e.type)return"SFType4"}return null},e.prototype.getHeightValue=function(e){return e.parentIndex*e.rowHeight>e.childIndex*e.rowHeight?e.parentIndex*e.rowHeight-e.childIndex*e.rowHeight:e.childIndex*e.rowHeight-e.parentIndex*e.rowHeight},e.prototype.getInnerElementWidthSSType2=function(e){return e.parentLeft===e.childLeft?10:e.childLeft-e.parentLeft},e.prototype.getInnerElementLeftSSType2=function(e){return e.parentLeft===e.childLeft?e.parentLeft-20:e.parentLeft-10},e.prototype.getInnerChildWidthSSType2=function(e){return e.parentLeft+e.parentWidth<e.childLeft?10:e.parentLeft===e.childLeft?20:e.parentLeft+e.parentWidth>=e.childLeft?10:e.childLeft-e.parentLeft},e.prototype.getBorderStyles=function(e,t){return"border-"+e+"-width:"+t+"px;"+("border-"+e+"-style:solid;")+(sf.base.isNullOrUndefined(this.lineColor)?"":"border-"+e+"-color:"+this.lineColor+";")},e.prototype.getConnectorLineTemplate=function(e){var t=this.getInnerChildWidthSSType2(e),i=this.getInnerElementWidthSSType2(e),r=this.getInnerElementLeftSSType2(e),a=this.getHeightValue(e),s=!!e.milestoneParent,n=!!e.milestoneChild,o="",d=this.parent.virtualScrollModule&&this.parent.enableVirtualization,l=this.getPosition(e,this.getParentPosition(e),a),p=d?l.height:a;if(this.getParentPosition(e)){o='<div id="ConnectorLine'+e.connectorLineId+'" style="background-color:black">';var h='<div class="e-connector-line-container" tabindex="-1" style="',c='<div class="e-line" style="'+(sf.base.isNullOrUndefined(this.lineColor)?"":"outline-color:"+this.lineColor+";"),u='<div class="e-connector-line-right-arrow" style="'+(sf.base.isNullOrUndefined(this.lineColor)?"":"outline-color:"+this.lineColor+";"),f='<div class="e-connector-line-left-arrow" style="'+(sf.base.isNullOrUndefined(this.lineColor)?"":"outline-color:"+this.lineColor+";"),g=f+(n?"left:0px;":"")+this.getBorderStyles("right",10)+"top:"+(-5-this.lineStroke+(this.lineStroke-1))+"px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;width:0;height:0;position:relative;"></div>',m=this.getBorderStyles("left",10)+"top:"+"-6px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;width:0;height:0;position:relative;"></div>',y=this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>'+c+"top:"+-(13+2*(this.lineStroke-1))+"px;width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",p-(this.lineStroke-1))+'position:relative;"></div>',b=f+"left:"+(e.childLeft+e.childWidth-e.parentLeft+10)+"px;"+this.getBorderStyles("right",10),v="top:"+-(6+(5+this.lineStroke)+this.lineStroke/2)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>';"FSType1"===this.getParentPosition(e)&&(h=h+"left:"+(e.parentLeft+e.parentWidth)+"px;top:"+(d?l.top:e.parentIndex*e.rowHeight+this.getTaskbarMidpoint(n)-(this.lineStroke-1))+"px;width:1px;height:"+p+'px;position:absolute" data-connectortype="FSType1">',h=(h+=c)+"left:"+(s?-1:0)+"px;width:"+(s?e.childLeft-(e.parentLeft+e.parentWidth+10)+this.lineStroke-10+1:e.childLeft-(e.parentLeft+e.parentWidth+10)+this.lineStroke-10)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',h=(h+=c)+"left:"+(e.childLeft-(e.parentLeft+e.parentWidth+10)-10)+"px;width:0px;"+this.getBorderStyles("right",this.lineStroke)+this.getBorderStyles("top",p-this.lineStroke)+'position:relative;"></div>',h=(h+=c)+"left:"+(e.childLeft-(e.parentLeft+e.parentWidth+10)-10)+"px;width:10px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',h=(h+=u)+"left:"+(e.childLeft-(e.parentLeft+e.parentWidth+10))+"px;"+this.getBorderStyles("left",10)+"top:"+(-6-this.lineStroke)+"px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;width:0;height:0;position:relative;"></div></div>'),"FSType2"===this.getParentPosition(e)&&(h=h+"left:"+e.parentLeft+"px;top:"+(d?l.top:e.parentIndex*e.rowHeight+this.getTaskbarMidpoint(n)-(this.lineStroke-1))+"px;width:1px;height:"+p+'px;position:absolute" data-connectortype="FSType2">',h=(h+=c)+"left:"+(s?e.parentWidth-1:e.parentWidth)+"px;width:"+(s?11:10)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',h=(h+=c)+"left:"+(e.parentWidth+10-this.lineStroke)+"px;"+this.getBorderStyles("left",this.lineStroke)+"width:0px;"+this.getBorderStyles("top",p-this.getconnectorLineGap(e)-this.lineStroke)+'position:relative;"></div>',h=(h+=c)+"left:"+(e.parentWidth-(e.parentLeft+e.parentWidth-e.childLeft+20))+"px;width:"+(e.parentLeft+e.parentWidth-e.childLeft+30)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',h=(h+=c)+"left:"+(e.parentWidth-(e.parentLeft+e.parentWidth-e.childLeft+20))+"px;width:0px;"+this.getBorderStyles("top",this.getconnectorLineGap(e)-this.lineStroke)+this.getBorderStyles("left",this.lineStroke)+'position:relative;"></div>',h=(h+=c)+"left:"+(e.parentWidth-(e.parentLeft+e.parentWidth-e.childLeft+20))+"px;width:10px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',h=(h+=u)+"left:"+(e.parentWidth-(e.parentLeft+e.parentWidth-e.childLeft+10))+"px;"+this.getBorderStyles("left",10)+"border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+"px;top:"+(-6-this.lineStroke)+'px;width:0;height:0;position:relative;"></div></div>'),"FSType3"===this.getParentPosition(e)&&(h=h+"left:"+(e.childLeft-20)+"px;top:"+(d?l.top:e.childIndex*e.rowHeight+this.getTaskbarMidpoint(s)-(this.lineStroke-1))+"px;width:1px;height:"+p+'px;position:absolute" data-connectortype="FSType3">',h=(h+=u)+"left:10px;"+this.getBorderStyles("left",10)+"border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+"px;top:"+'-6px;width:0;height:0;position:relative;"></div>',h=(h+=c)+"width:10px;"+this.getBorderStyles("top",this.lineStroke)+"position:relative;top:"+-(6+(5+this.lineStroke)+Math.round(this.lineStroke/2))+'px;"></div>',h=(h+=c)+"width:"+this.lineStroke+"px;"+this.getBorderStyles("top",p-this.getconnectorLineGap(e)-this.lineStroke+1)+"position:relative;top:"+-(13+2*(this.lineStroke-1))+'px;"></div>',h=(h+=c)+"width:"+(e.parentLeft+e.parentWidth-e.childLeft+30)+"px;"+this.getBorderStyles("top",this.lineStroke)+"position:relative;top:"+-(13+2*(this.lineStroke-1))+'px;"></div>',h=(h+=c)+"left:"+(e.parentLeft+e.parentWidth-e.childLeft+(30-this.lineStroke))+"px;width:0px;height:"+(this.getconnectorLineGap(e)-this.lineStroke)+"px;"+this.getBorderStyles("left",this.lineStroke)+"position:relative;top:"+-(13+2*(this.lineStroke-1))+'px;"></div>',h=(h+=c)+(s?"left:"+(e.parentLeft+e.parentWidth-e.childLeft+(18-this.lineStroke))+"px;width:"+(12+this.lineStroke)+"px;":"left:"+(e.parentLeft+e.parentWidth-e.childLeft+20)+"px;width:10px;")+this.getBorderStyles("top",this.lineStroke)+"position:relative;top:"+-(13+2*(this.lineStroke-1))+'px;"></div></div>'),"FSType4"===this.getParentPosition(e)&&(h=h+"left:"+(e.parentLeft+e.parentWidth)+"px;top:"+(d?l.top:e.childIndex*e.rowHeight+this.getTaskbarMidpoint(n)-(this.lineStroke-1))+"px;width:1px;height:"+p+'px;position:absolute" data-connectortype="FSType4">',h=(h+=u)+"left:"+(e.childLeft-(e.parentLeft+e.parentWidth+10))+"px;"+this.getBorderStyles("left",10)+"top:"+"-6px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;width:0;height:0;position:relative;"></div>',h=(h+=c)+"left:"+(e.childLeft-(e.parentLeft+e.parentWidth)-20)+"px;top:"+-(6+(5+this.lineStroke)+Math.round(this.lineStroke/2))+"px;width:10px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',h=(h+=c)+"top:"+-(13+2*(this.lineStroke-1))+"px;left:"+(e.childLeft-(e.parentLeft+e.parentWidth)-20)+"px;width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",p-this.lineStroke+1)+'position:relative;"></div>',h=(h+=c)+(s?"left:-1px;":"")+"top:"+-(13+2*(this.lineStroke-1))+"px;width:"+(s?e.childLeft-(e.parentLeft+e.parentWidth+20)+1+this.lineStroke:e.childLeft-(e.parentLeft+e.parentWidth+20)+this.lineStroke)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div></div>'),"SSType4"===this.getParentPosition(e)&&(h=h+"left:"+(e.parentLeft-10)+"px;top:"+(d?l.top:e.childIndex*e.rowHeight+this.getTaskbarMidpoint(n)-(this.lineStroke-1))+"px;width:1px;height:"+p+'px;position:absolute" data-connectortype="SSType4">',h=(h+=u)+"left:"+(e.childLeft-e.parentLeft)+"px;"+m,h=(h+=c)+"top:"+-(6+(5+this.lineStroke)+this.lineStroke/2)+"px;width:"+(e.childLeft-e.parentLeft)+"px;"+y,h=(h+=c)+"top:"+-(13+2*(this.lineStroke-1))+"px;width:10px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div></div>'),"SSType3"===this.getParentPosition(e)&&(h=h+"left:"+(e.childLeft-20)+"px;top:"+(d?l.top:e.childIndex*e.rowHeight+this.getTaskbarMidpoint(n)-(this.lineStroke-1))+"px;width:1px;height:"+p+'px;position:absolute" data-connectortype="SSType3">',h=(h+=u)+"left:10px;"+m,h=(h+=c)+"top:"+-(6+(5+this.lineStroke)+this.lineStroke/2)+"px;width:10px;"+y,h=(h+=c)+"top:"+-(13+2*(this.lineStroke-1))+"px;width:"+(e.parentLeft-e.childLeft+21)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div></div>'),"SSType2"===this.getParentPosition(e)&&(h=h+"left:"+r+"px;top:"+(d?l.top:e.parentIndex*e.rowHeight+this.getTaskbarMidpoint(s)-(this.lineStroke-1))+"px;width:1px;height:"+p+'px;position:absolute" data-connectortype="SSType2">',h=(h+=c)+"width:"+(t+1)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',h=(h+=c)+"width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",p-this.lineStroke)+'position:relative;"></div>',h=(h+=c)+"width:"+i+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',h=(h+=u)+"left:"+i+"px;"+this.getBorderStyles("left",10)+"top:"+(-6-this.lineStroke)+"px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;width:0;height:0;position:relative;"></div></div>'),"SSType1"===this.getParentPosition(e)&&(h=h+"left:"+(e.childLeft-20)+"px;top:"+(d?l.top:e.parentIndex*e.rowHeight+this.getTaskbarMidpoint(s)-(this.lineStroke-1))+"px;width:1px;height:"+p+'px;position:absolute" data-connectortype="SSType1">',h=(h+=c)+"width:"+(e.parentLeft-e.childLeft+21)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',h=(h+=c)+"width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",p-this.lineStroke)+'position:relative;"></div>',h=(h+=c)+"width:10px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',h=(h+=u)+"left:10px;"+this.getBorderStyles("left",10)+"top:"+(-6-this.lineStroke)+"px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;width:0;height:0;position:relative;"></div></div>'),"FFType1"===this.getParentPosition(e)&&(h=h+"left:"+(e.childLeft+e.childWidth)+"px;top:"+(d?l.top:e.parentIndex*e.rowHeight+this.getTaskbarMidpoint(s)-(this.lineStroke-1))+"px;width:1px;height:"+p+'px;position:absolute" data-connectortype="FFType1">',h=(h+=c)+"left:"+(s?e.parentLeft+e.parentWidth-(e.childLeft+e.childWidth)-1:e.parentLeft+e.parentWidth-(e.childLeft+e.childWidth))+"px;width:"+(s?21+this.lineStroke:20+this.lineStroke)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',h=(h+=c)+"left:"+(e.parentLeft+e.parentWidth-(e.childLeft+e.childWidth)+20)+"px;width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",p-this.lineStroke)+'position:relative;"></div>',h=(h+=c)+"left:"+(n?4:10)+"px;width:"+(n?e.parentLeft+e.parentWidth-(e.childLeft+e.childWidth)+(16+this.lineStroke):e.parentLeft+e.parentWidth-(e.childLeft+e.childWidth)+(10+this.lineStroke))+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',h=(h+=f)+(n?"left:0px;":"")+this.getBorderStyles("right",10)+"top:"+(-6-this.lineStroke)+"px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;width:0;height:0;position:relative;"></div></div>'),"FFType2"===this.getParentPosition(e)&&(h=h+"left:"+(e.parentLeft+e.parentWidth)+"px;top:"+(d?l.top:e.parentIndex*e.rowHeight+this.getTaskbarMidpoint(s)-(this.lineStroke-1))+"px;width:1px;height:"+p+'px;position:absolute" data-connectortype="FFType2">',h=(h+=c)+(s?"left:-1px;":"")+"width:"+(s?e.childLeft+e.childWidth-(e.parentLeft+e.parentWidth)+(21+this.lineStroke):e.childLeft+e.childWidth-(e.parentLeft+e.parentWidth)+(20+this.lineStroke))+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',h=(h+=c)+"left:"+(e.childLeft+e.childWidth-(e.parentLeft+e.parentWidth)+20)+"px;width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",p-this.lineStroke)+'position:relative;"></div>',h=(h+=c)+"left:"+(n?e.childLeft+e.childWidth-(e.parentLeft+e.parentWidth)+4:e.childLeft+e.childWidth-(e.parentLeft+e.parentWidth)+10)+"px;width:"+(n?16+this.lineStroke:10+this.lineStroke)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',h=(h+=f)+"left:"+(e.childLeft+e.childWidth-(e.parentLeft+e.parentWidth))+"px;"+this.getBorderStyles("right",10)+"top:"+(-6-this.lineStroke)+"px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;width:0;height:0;position:relative;"></div></div>'),"FFType3"===this.getParentPosition(e)&&(h=h+"left:"+(e.childLeft+e.childWidth)+"px;top:"+(d?l.top:e.childIndex*e.rowHeight+this.getTaskbarMidpoint(n)-(this.lineStroke-1))+"px;width:1px;height:"+p+'px;position:absolute" data-connectortype="FFType3">',h+=g,h=(h+=c)+(n?"left:4px;width:"+(e.parentLeft+e.parentWidth-(e.childLeft+e.childWidth)+16):"left:10px;width:"+(e.parentLeft+e.parentWidth-(e.childLeft+e.childWidth)+10))+"px;top:"+-(6+(5+this.lineStroke)+this.lineStroke/2)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',h=(h+=c)+"left:"+(e.parentLeft+e.parentWidth-(e.childLeft+e.childWidth)+20)+"px;top:"+-(13+2*(this.lineStroke-1))+"px;width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",p-this.lineStroke+1)+'position:relative;"></div>',h=(h+=c)+(s?"left:"+(e.parentLeft+e.parentWidth-(e.childLeft+e.childWidth)-1)+"px;width:21":"left:"+(e.parentLeft+e.parentWidth-(e.childLeft+e.childWidth))+"px;width:20")+"px;top:"+-(13+2*(this.lineStroke-1))+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div></div>'),"FFType4"===this.getParentPosition(e)&&(h=h+"left:"+(e.parentLeft+e.parentWidth)+"px;top:"+(d?l.top:e.childIndex*e.rowHeight+this.getTaskbarMidpoint(n)-(this.lineStroke-1))+"px;width:1px;height:"+p+'px;position:absolute" data-connectortype="FFType4">',h=(h+=f)+"left:"+(e.childLeft+e.childWidth-(e.parentLeft+e.parentWidth))+"px;"+this.getBorderStyles("right",10)+"top:"+(-5-this.lineStroke+(this.lineStroke-1))+"px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;width:0;height:0;position:relative;"></div>',h=(h+=c)+(n?"left:"+(e.childLeft+e.childWidth-(e.parentLeft+e.parentWidth)+4)+"px;width:"+(16+this.lineStroke):"left:"+(e.childLeft+e.childWidth-(e.parentLeft+e.parentWidth)+10)+"px;width:"+(10+this.lineStroke))+"px;"+v,h=(h+=c)+"left:"+(e.childLeft+e.childWidth-(e.parentLeft+e.parentWidth)+20)+"px;top:"+-(13+2*(this.lineStroke-1))+"px;width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",p-this.lineStroke+1)+'position:relative;"></div>',h=(h+=c)+(s?"left:-1px;width:"+(e.childLeft+e.childWidth-(e.parentLeft+e.parentWidth)+(21+this.lineStroke)):"width:"+(e.childLeft+e.childWidth-(e.parentLeft+e.parentWidth)+(20+this.lineStroke)))+"px;top:"+-(13+2*(this.lineStroke-1))+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div></div>'),"SFType4"===this.getParentPosition(e)&&(h=(h=h+"left:"+(e.parentLeft-10)+"px;top:"+(d?l.top:e.childIndex*e.rowHeight+this.getTaskbarMidpoint(n)-(this.lineStroke-1))+"px;width:1px;height:"+p+'px;position:absolute" data-connectortype="SFType4">')+b+"top:"+(-5-this.lineStroke+(this.lineStroke-1))+"px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;width:0;height:0;position:relative;"></div>',h=(h+=c)+"left:"+(n?e.childLeft+e.childWidth-e.parentLeft+(14+this.lineStroke)+"px;width:16":e.childLeft+e.childWidth-e.parentLeft+20+"px;width:"+(10+this.lineStroke))+"px;"+v,h=(h+=c)+"left:"+(e.childLeft+e.childWidth-e.parentLeft+30)+"px;top:"+-(13+2*(this.lineStroke-1))+"px;width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",p-this.getconnectorLineGap(e)-(this.lineStroke-1))+'position:relative;"></div>',h=(h+=c)+"top:"+-(13+2*(this.lineStroke-1))+"px;width:"+(e.childLeft+e.childWidth-e.parentLeft+(30+this.lineStroke))+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',h=(h+=c)+"top:"+-(13+2*(this.lineStroke-1))+"px;width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",this.getconnectorLineGap(e)-this.lineStroke)+'position:relative;"></div>',h=(h+=c)+"top:"+-(13+2*(this.lineStroke-1))+"px;width:11px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div></div>'),"SFType3"===this.getParentPosition(e)&&(h=h+"left:"+(e.childLeft+e.childWidth)+"px;top:"+(d?l.top:e.childIndex*e.rowHeight+this.getTaskbarMidpoint(n)-(this.lineStroke-1))+"px;width:1px;height:"+p+'px;position:absolute" data-connectortype="SFType3">',h+=g,h=(h+=c)+(n?"left:4px;width:"+(16+this.lineStroke):"left:10px;width:"+(10+this.lineStroke))+"px;top:"+-(13+2*(this.lineStroke-1)-1)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',h=(h+=c)+"left:20px;top:"+-(13+2*(this.lineStroke-1))+"px;width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",p-(this.lineStroke-1))+'position:relative;"></div>',h=(h+=c)+"left:20px;top:"+-(13+2*(this.lineStroke-1))+"px;width:"+(e.parentLeft-(e.childLeft+e.childWidth+20)+this.lineStroke)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div></div>'),"SFType1"===this.getParentPosition(e)&&(h=h+"left:"+(e.parentLeft-10)+"px;top:"+(d?l.top:e.parentIndex*e.rowHeight+this.getTaskbarMidpoint(n)-(this.lineStroke-1))+"px;width:1px;height:"+p+'px;position:absolute" data-connectortype="SFType1">',h=(h+=c)+"width:11px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',h=(h+=c)+"width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",p-this.getconnectorLineGap(e)-this.lineStroke)+'position:relative;"></div>',h=(h+=c)+"width:"+(e.childLeft+e.childWidth-e.parentLeft+(30+this.lineStroke))+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',h=(h+=c)+"left:"+(e.childLeft+e.childWidth-e.parentLeft+30)+"px;width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",this.getconnectorLineGap(e)-this.lineStroke)+'position:relative;"></div>',h=(h=(h+=c)+(n?"left:"+(e.childLeft+e.childWidth-e.parentLeft+15)+"px;width:"+(15+this.lineStroke):"left:"+(e.childLeft+e.childWidth-e.parentLeft+20)+"px;width:"+(10+this.lineStroke))+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>')+b+"top:"+(-6-this.lineStroke)+"px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;position:relative;"></div></div>'),"SFType2"===this.getParentPosition(e)&&(h=h+"left:"+(e.childLeft+e.childWidth)+"px;top:"+(d?l.top:e.parentIndex*e.rowHeight+this.getTaskbarMidpoint(s)-(this.lineStroke-1))+"px;width:1px;height:"+p+'px;position:absolute" data-connectortype="SFType2">',h=(h+=c)+"left:"+(e.parentLeft-(e.childLeft+e.childWidth)-10)+"px;width:11px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',h=(h+=c)+"left:"+(e.parentLeft-(e.childLeft+e.childWidth)-10)+"px;width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",p-this.lineStroke)+'position:relative;"></div>',h=(h+=c)+(n?"left:4px;width:"+(e.parentLeft-(e.childLeft+e.childWidth)-(14-this.lineStroke)):"left:10px;width:"+(e.parentLeft-(e.childLeft+e.childWidth)-(20-this.lineStroke)))+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',h=(h+=f)+"left:0px;"+this.getBorderStyles("right",10)+"top:"+(-6-this.lineStroke)+"px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;width:0;height:0;position:relative;"></div></div>'),o+=h,o+="</div>"}return o},e.prototype.getPosition=function(e,t,i){var r=0,a=0;if(this.parent.virtualScrollModule&&this.parent.enableVirtualization){var s=!!e.milestoneParent,n=!!e.milestoneChild,o=this.getTaskbarMidpoint(s)-(this.lineStroke-1),d=this.getTaskbarMidpoint(n)-(this.lineStroke-1),l=-1!==e.parentIndexInCurrentView,p=-1!==e.childIndexInCurrentView,h=this.parent.currentViewData.length-1;"SSType1"===t||"SSType2"===t||"FFType1"===t||"FFType2"===t||"SFType2"===t?(r=l?e.parentIndexInCurrentView*e.rowHeight+o:0,a=l&&p?i:p?e.childIndexInCurrentView*e.rowHeight+o:h*e.rowHeight+o):"SSType3"===t||"SSType4"===t||"FSType4"===t||"FFType3"===t||"FFType4"===t||"SFType4"===t||"SFType3"===t?(r=p?e.childIndexInCurrentView*e.rowHeight+d:0,a=l&&p?i:l?e.parentIndexInCurrentView*e.rowHeight+d:h*e.rowHeight+d):"FSType3"===t?(r=p?e.childIndexInCurrentView*e.rowHeight+o:0,a=l&&p?i:l?e.parentIndexInCurrentView*e.rowHeight+d:h*e.rowHeight+o):"SFType1"!==t&&"FSType1"!==t&&"FSType2"!==t||(r=l?e.parentIndexInCurrentView*e.rowHeight+d:0,a=l&&p?i:p?e.childIndexInCurrentView*e.rowHeight+d:h*e.rowHeight+d)}return{top:r,height:a}},e.prototype.createConnectorLineTooltipTable=function(){this.tooltipTable=sf.base.createElement("table",{className:".e-tooltiptable",styles:"margin-top:0px",attrs:{cellspacing:"2px",cellpadding:"2px"}});var e=sf.base.createElement("tbody");e.innerHTML="",this.tooltipTable.appendChild(e)},e.prototype.getConnectorLineTooltipInnerTd=function(e,t,i,r){var a='<tr  id="fromPredecessor"><td >'+this.parent.localeObj.getConstant("from")+"</td><td> ";return a=(a=(a=a+e+" </td><td> "+this.parent.localeObj.getConstant(t)+" </td> </tr>")+'<tr id="toPredecessor"><td>'+this.parent.localeObj.getConstant("to")+"</td><td> "+i)+" </td><td> "+this.parent.localeObj.getConstant(r)+" </td></tr></tbody><table>"},e.prototype.generateAriaLabel=function(e){var t=e.type,i=this.expandedRecords,r=i[e.parentIndex].ganttProperties.taskName,a=i[e.childIndex].ganttProperties.taskName,s=this.parent.localeObj.getConstant("start"),n=this.parent.localeObj.getConstant("finish");return"FS"===t?r+" "+n+" to "+a+" "+s:"FF"===t?r+" "+n+" to "+a+" "+n:"SS"===t?r+" "+s+" to "+a+" "+s:r+" "+s+" to "+a+" "+n},e.prototype.getRecordByID=function(e){return sf.base.isNullOrUndefined(e)?null:"ResourceView"===this.parent.viewType?this.parent.flatData[this.parent.getTaskIds().indexOf("T"+e.toString())]:this.parent.flatData[this.parent.ids.indexOf(e.toString())]},e.prototype.removePreviousConnectorLines=function(e){for(var t,i=(t=!0===sf.base.isObject(e))?Object.keys(e).length:e.length,r=Object.keys(e),a=0;a<i;a++){var s,n=void 0;if(t)n=e[r[a]];else n=e[a];if((s=n.ganttProperties&&n.ganttProperties.predecessor)&&s.length>0)for(var o=0;o<s.length;o++){var d="parent"+s[o].from+"child"+s[o].to;this.removeConnectorLineById(d)}}},e.prototype.removeConnectorLineById=function(e){var t=this.parent.connectorLineModule.dependencyViewContainer.querySelector("#ConnectorLine"+e);sf.base.isNullOrUndefined(t)||sf.base.remove(t)},e}(),rt=function(){function e(e){this.parent=e,this.parent.on("destroy",this.destroy,this)}return e.prototype.renderSplitter=function(){var e=this,t=this.calculateSplitterPosition(this.parent.splitterSettings);this.parent.splitterElement=sf.base.createElement("div",{className:"e-gantt-splitter"}),this.parent.treeGridPane=sf.base.createElement("div",{className:"e-gantt-tree-grid-pane"}),this.parent.chartPane=sf.base.createElement("div",{className:"e-gantt-chart-pane"}),this.parent.splitterElement.appendChild(this.parent.treeGridPane),this.parent.splitterElement.appendChild(this.parent.chartPane),this.splitterObject=new sf.layouts.Splitter({height:null,width:this.parent.ganttWidth.toString(),separatorSize:this.parent.splitterSettings.separatorSize,paneSettings:[{resizable:!0,size:t,min:this.getSpliterPositionInPercentage(this.parent.splitterSettings.minimum)},{resizable:!0}],orientation:"Horizontal",resizeStart:function(t){var i=sf.base.isBlazor()?t.element.querySelectorAll(".e-pane")[0]:t.pane[0],r=sf.base.isBlazor()?t.element.querySelectorAll(".e-pane")[1]:t.pane[1];e.splitterPreviousPositionGrid=i.scrollWidth+1+"px",e.splitterPreviousPositionChart=r.scrollWidth+1+"px";var a=new sf.data.Deferred;return e.parent.trigger("splitterResizeStart",t,(function(e){a.resolve(e)})),a},resizing:function(t){e.parent.trigger("splitterResizing",t)},resizeStop:function(t){var i=new sf.data.Deferred;return e.parent.trigger("splitterResized",t,(function(t){!0===t.cancel&&(e.splitterObject.paneSettings[0].size=null,e.splitterObject.paneSettings[0].size=e.getSpliterPositionInPercentage(e.splitterPreviousPositionGrid),e.splitterObject.paneSettings[1].size=null,e.splitterObject.paneSettings[1].size=e.getSpliterPositionInPercentage(e.splitterPreviousPositionChart)),i.resolve(t)})),i}}),this.parent.element.appendChild(this.parent.splitterElement),this.splitterObject.appendTo(this.parent.splitterElement)},e.prototype.calculateSplitterPosition=function(e,t){return"Grid"===e.view?"100%":"Chart"===e.view?"0%":sf.base.isNullOrUndefined(e.position)||""===e.position?!sf.base.isNullOrUndefined(e.columnIndex)&&e.columnIndex>=0?t?this.getSpliterPositionInPercentage(this.getTotalColumnWidthByIndex(e.columnIndex).toString()+"px"):this.getSpliterPositionInPercentage(150*e.columnIndex+"px"):this.getSpliterPositionInPercentage("250px"):this.getSpliterPositionInPercentage(e.position)},e.prototype.getSpliterPositionInPercentage=function(e){var t=sf.base.isNullOrUndefined(e)||""===e?null:e;if(!sf.base.isNullOrUndefined(t))if(-1!==e.indexOf("px")){var i=parseInt(e,10);t=i/this.parent.ganttWidth*100<=100?i/this.parent.ganttWidth*100+"%":"25%"}else t=-1===e.indexOf("%")?e+"%":e;return t},e.prototype.getTotalColumnWidthByIndex=function(e){var t=0,i=this.parent.treeGrid.element.querySelectorAll(".e-headercell");e=i.length>e?e:i.length;for(var r=0;r<e;r++)t+=i[r].offsetWidth;return t},e.prototype.updateSplitterPosition=function(){this.splitterObject.separatorSize=this.parent.splitterSettings.separatorSize>=4?this.parent.splitterSettings.separatorSize:4;var e=this.calculateSplitterPosition(this.parent.splitterSettings,!0);this.splitterObject.paneSettings[0].min=this.getSpliterPositionInPercentage(this.parent.splitterSettings.minimum),this.splitterObject.dataBind(),this.splitterObject.paneSettings[0].size=e},e.prototype.triggerCustomResizedEvent=function(){var e=this.splitterObject.element.querySelectorAll(".e-pane")[0],t=this.splitterObject.element.querySelectorAll(".e-pane")[1],i={event:null,element:this.splitterObject.element,pane:[e,t],index:[0,1],separator:this.splitterObject.element.querySelector(".e-split-bar"),paneSize:[e.offsetWidth,t.offsetWidth]};this.parent.trigger("splitterResized",i),!0===i.cancel&&(this.splitterObject.paneSettings[0].size=this.getSpliterPositionInPercentage(this.splitterPreviousPositionGrid),this.splitterObject.paneSettings[1].size=this.getSpliterPositionInPercentage(this.splitterPreviousPositionChart))},e.prototype.destroy=function(){this.splitterObject.destroy(),this.parent.off("destroy",this.destroy)},e}(),at=function(){function e(e){this.parent=e,this.createTooltip(),this.parent.on("destroy",this.destroy,this)}return e.prototype.createTooltip=function(){this.toolTipObj=new sf.popups.Tooltip,this.toolTipObj.target=".e-header-cell-label, .e-gantt-child-taskbar,.e-gantt-parent-taskbar, .e-gantt-milestone, .e-gantt-unscheduled-taskbar.e-event-markers, .e-baseline-bar, .e-event-markers,.e-connector-line-container, .e-indicator-span, .e-notes-info, .e-gantt-manualparent-milestone,.e-taskbar-left-resizer, .e-taskbar-right-resizer, .e-baseline-gantt-milestone, .e-gantt-manualparenttaskbar",this.toolTipObj.position="BottomCenter",this.toolTipObj.openDelay=700,this.toolTipObj.enableHtmlSanitizer=!1,this.toolTipObj.cssClass="e-gantt-tooltip",this.toolTipObj.animation={open:{effect:"None",delay:0},close:{effect:"None",delay:0}},this.toolTipObj.afterOpen=this.updateTooltipPosition.bind(this),this.toolTipObj.showTipPointer=!1,this.toolTipObj.beforeRender=this.tooltipBeforeRender.bind(this),this.toolTipObj.afterClose=this.tooltipCloseHandler.bind(this),this.toolTipObj.isStringTemplate=!0,this.toolTipObj.appendTo(this.parent.element)},e.prototype.tooltipBeforeRender=function(e){var i,r=this.parent;r.isOnEdit&&(e.cancel=!0);var a,s=sf.base.closest(e.target,"div."+A);i=sf.base.isNullOrUndefined(s)?t(e.target,"e-chart-row-cell"):e.target;var n={data:{},args:e,cancel:!1,content:""};if(e.target.classList.contains("e-header-cell-label"))r.timelineSettings.showTooltip?n.content=this.toolTipObj.content=r.tooltipModule.getTooltipContent("timeline",a,r,e):e.cancel=!0;else if(r.tooltipSettings.showTooltip)if(i&&(n.data=r.ganttChartModule.getRecordByTaskBar(i),a=n.data),e.target.classList.contains("e-gantt-child-taskbar")||e.target.classList.contains("e-gantt-parent-taskbar")||e.target.classList.contains("e-gantt-milestone")||e.target.classList.contains("e-gantt-unscheduled-taskbar")||e.target.classList.contains("e-taskbar-left-resizer")||e.target.classList.contains("e-taskbar-right-resizer")){var o=void 0;r.tooltipSettings.taskbar&&(o=r.tooltipModule.templateCompiler(r.tooltipSettings.taskbar,r,a,"TooltipTaskbarTemplate")),n.content=this.toolTipObj.content=o?o[0]:r.tooltipModule.getTooltipContent(a.ganttProperties.isMilestone?"milestone":"taskbar",a,r,e)}else if(e.target.classList.contains("e-baseline-bar")||e.target.classList.contains("e-baseline-gantt-milestone")){var d=void 0;r.tooltipSettings.baseline&&(d=r.tooltipModule.templateCompiler(r.tooltipSettings.baseline,r,a,"TooltipBaselineTemplate")),n.content=this.toolTipObj.content=d?d[0]:r.tooltipModule.getTooltipContent(a.ganttProperties.isMilestone?"milestone":"baseline",a,r,e)}else if(e.target.classList.contains("e-event-markers"))n.content=this.toolTipObj.content=r.tooltipModule.getTooltipContent("marker",a,r,e);else if(e.target.classList.contains("e-connector-line-container")){var l=void 0;r.tooltipModule.predecessorTooltipData=r.tooltipModule.getPredecessorTooltipData(e),n.data=this.predecessorTooltipData,r.tooltipSettings.connectorLine&&(l=r.tooltipModule.templateCompiler(r.tooltipSettings.connectorLine,r,r.tooltipModule.predecessorTooltipData,"TooltipConnectorLineTemplate")),n.content=this.toolTipObj.content=l?l[0]:r.tooltipModule.getTooltipContent("connectorLine",a,r,e)}else if(e.target.classList.contains("e-indicator-span"))n.content=this.toolTipObj.content=r.tooltipModule.getTooltipContent("indicator",a,r,e),sf.base.isNullOrUndefined(n.content)&&(e.cancel=!0);else if(e.target.classList.contains("e-notes-info")){var p=this.parent.ganttChartModule.getRecordByTarget(e.event);n.content=this.toolTipObj.content=p.ganttProperties.notes,sf.base.isNullOrUndefined(n.content)&&(e.cancel=!0)}else e.target.classList.contains("e-gantt-manualparenttaskbar")?(n.content=this.toolTipObj.content=r.tooltipModule.getTooltipContent("manualtaskbar",a,r,e),sf.base.isNullOrUndefined(n.content)&&(e.cancel=!0)):e.target.classList.contains("e-gantt-manualparent-milestone")&&(n.content=this.toolTipObj.content=r.tooltipModule.getTooltipContent("manualmilestone",a,r,e),sf.base.isNullOrUndefined(n.content)&&(e.cancel=!0));else e.cancel=!0;if(!1===e.cancel){var h=new sf.data.Deferred;return r.trigger("beforeTooltipRender",n,(function(t){h.resolve(t),t.cancel&&(e.cancel=!0)})),this.parent.isAdaptive||"mouseover"!==e.event.type||(this.currentTarget=e.target,sf.base.EventHandler.add(this.currentTarget,"mousemove",this.mouseMoveHandler.bind(this))),this.parent.renderTemplates(),h}},e.prototype.tooltipCloseHandler=function(e){this.tooltipMouseEvent=null,this.parent.isAdaptive||sf.base.EventHandler.remove(this.currentTarget,"mousemove",this.mouseMoveHandler),this.currentTarget=null},e.prototype.mouseMoveHandler=function(e){this.tooltipMouseEvent=e},e.prototype.updateTooltipPosition=function(e){if(!sf.base.isNullOrUndefined(this.tooltipMouseEvent)&&!e.target.classList.contains("e-notes-info")){var t=this.getPointorPosition(this.tooltipMouseEvent),i=this.parent.getOffsetRect(this.parent.chartPane),r=i.top+this.parent.chartPane.offsetHeight,a=i.left+this.parent.chartPane.offsetWidth,s=t.x,n=t.y,o=!1;a<s+e.element.offsetWidth+20?s=s-e.element.offsetWidth-10:s+=10,r<n+e.element.offsetHeight+20?n=n-e.element.offsetHeight-10:(o=!0,n+=10),window.innerHeight<e.element.offsetHeight+n&&(n=n-e.element.offsetHeight-(o?20:10)),e.element.style.left=s+"px",e.element.style.top=n+"px"}},e.prototype.getPointorPosition=function(e){var t,i;return sf.base.isNullOrUndefined(sf.base.getValue("pageX",e))&&sf.base.isNullOrUndefined(sf.base.getValue("pageY",e))?sf.base.isNullOrUndefined(sf.base.getValue("clientX",e))&&sf.base.isNullOrUndefined(sf.base.getValue("clientY",e))||(t=sf.base.getValue("clientX",e)+document.body.scrollLeft+document.documentElement.scrollLeft,i=sf.base.getValue("clientY",e)+document.body.scrollTop+document.documentElement.scrollTop):(t=sf.base.getValue("pageX",e),i=sf.base.getValue("pageY",e)),{x:t,y:i}},e.prototype.getTooltipContent=function(e,t,i,r){var a,s,n;switch(t&&(s=t.ganttProperties,n=sf.base.isNullOrUndefined(s.taskName)?"":'<tr class = "e-gantt-tooltip-rowcell"><td colspan="3">'+s.taskName+"</td></tr>"),e){case"milestone":a='<table class = "e-gantt-tooltiptable"><tbody>'+n+(sf.base.isNullOrUndefined(s.startDate)?"":'<tr><td class = "e-gantt-tooltip-label"> Date</td><td>:</td><td class = "e-gantt-tooltip-value">'+this.parent.getFormatedDate(s.startDate,this.parent.getDateFormat())+"</td></tr>")+"</tbody></table>";break;case"taskbar":var o=!(t.hasChildRecords&&!s.isAutoSchedule);a='<table class = "e-gantt-tooltiptable"><tbody>'+n+(s.startDate?'<tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant(o?"startDate":"subTasksStartDate")+'</td><td>:</td><td class = "e-gantt-tooltip-value"> '+this.parent.getFormatedDate(o?s.startDate:s.autoStartDate,this.parent.getDateFormat())+"</td></tr>":"")+(s.endDate?'<tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant(o?"endDate":"subTasksEndDate")+'</td><td>:</td><td class = "e-gantt-tooltip-value">'+this.parent.getFormatedDate(o?s.endDate:s.autoEndDate,this.parent.getDateFormat())+"</td></tr>":"")+(sf.base.isNullOrUndefined(s.duration)?"":'<tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("duration")+'</td><td>:</td><td class = "e-gantt-tooltip-value"> '+this.parent.getDurationString(o?s.duration:s.autoDuration,s.durationUnit)+"</td></tr>")+(sf.base.isNullOrUndefined(s.progress)?"":'<tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("progress")+"</td><td>:</td><td>"+s.progress+"</td></tr>")+"</tbody></table>";break;case"baseline":a='<table class = "e-gantt-tooltiptable"><tbody>'+n+'<tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("baselineStartDate")+'</td><td>:</td><td class = "e-gantt-tooltip-value">'+this.parent.getFormatedDate(s.baselineStartDate,this.parent.getDateFormat())+'</td></tr><tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("baselineEndDate")+'</td><td>:</td><td class = "e-gantt-tooltip-value">'+this.parent.getFormatedDate(s.baselineEndDate,this.parent.getDateFormat())+"</td></tr></tbody></table>";break;case"marker":var d=i.tooltipModule.getMarkerTooltipData(r),l=d.label?d.label:"";a='<table class = "e-gantt-tooltiptable"><tbody><tr><td>'+this.parent.getFormatedDate(this.parent.dateValidationModule.getDateFromFormat(d.day),this.parent.getDateFormat())+"</td></tr><tr><td>"+l+"</td></tr></tbody></table>";break;case"connectorLine":a='<table class = "e-gantt-tooltiptable"><tbody><tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("from")+'</td><td>:</td><td class = "e-gantt-tooltip-value">'+i.tooltipModule.predecessorTooltipData.fromName+" ("+i.tooltipModule.predecessorTooltipData.fromId+')</td></tr><tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("to")+'</td><td>:</td><td class = "e-gantt-tooltip-value">'+i.tooltipModule.predecessorTooltipData.toName+" ("+i.tooltipModule.predecessorTooltipData.toId+')</td></tr><tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("taskLink")+'</td><td>:</td><td class = "e-gantt-tooltip-value"> '+i.tooltipModule.predecessorTooltipData.linkText+'</td></tr><tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("lag")+'</td><td>:</td><td class = "e-gantt-tooltip-value">'+i.tooltipModule.predecessorTooltipData.offsetString+"</td></tr></tbody></table>";break;case"indicator":r.target.title.length&&(a='<table class = "e-gantt-tooltiptable"><tbody><tr>'+r.target.title+"</tr></tbody></table>");break;case"timeline":a='<table class = "e-gantt-tooltiptable"><tbody><tr>'+r.target.title+"</tr></tbody></table>";break;case"manualtaskbar":var p=s.autoStartDate?'<tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("subTasksStartDate")+'</td><td>:</td><td class = "e-gantt-tooltip-value"> '+this.parent.getFormatedDate(s.autoStartDate,this.parent.getDateFormat())+"</td></tr>":"",h=s.autoEndDate?'<tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("subTasksEndDate")+'</td><td>:</td><td class = "e-gantt-tooltip-value">'+this.parent.getFormatedDate(s.autoEndDate,this.parent.getDateFormat())+"</td></tr>":"",c=sf.base.isNullOrUndefined(s.duration)?"":'<tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("duration")+'</td><td>:</td><td class = "e-gantt-tooltip-value"> '+this.parent.getDurationString(s.duration,s.durationUnit)+"</td></tr>";a='<table class = "e-gantt-tooltiptable"><tbody>'+n+(s.startDate?'<tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("startDate")+'</td><td>:</td><td class = "e-gantt-tooltip-value"> '+this.parent.getFormatedDate(s.startDate,this.parent.getDateFormat())+"</td></tr>":"")+p+(s.endDate?'<tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("endDate")+'</td><td>:</td><td class = "e-gantt-tooltip-value">'+this.parent.getFormatedDate(s.endDate,this.parent.getDateFormat())+"</td></tr>":"")+h+c+"</tbody></table>";break;case"manualmilestone":var u=s.autoStartDate?'<tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("subTasksStartDate")+'</td><td>:</td><td class = "e-gantt-tooltip-value"> '+this.parent.getFormatedDate(s.autoStartDate,this.parent.getDateFormat())+"</td></tr>":"",f=s.autoEndDate?'<tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("subTasksEndDate")+'</td><td>:</td><td class = "e-gantt-tooltip-value">'+this.parent.getFormatedDate(s.autoEndDate,this.parent.getDateFormat())+"</td></tr>":"";a='<table class = "e-gantt-tooltiptable"><tbody>'+n+('<tr><td class = "e-gantt-tooltip-label"> Date</td><td>:</td><td class = "e-gantt-tooltip-value">'+this.parent.getFormatedDate(s.startDate,this.parent.getDateFormat())+"</tr>")+u+f+"</tbody></table>"}return a},e.prototype.getMarkerTooltipData=function(e){var t=e.target.id.match(/\d+/g);return this.parent.eventMarkers[Number(t)]},e.prototype.getPredecessorTooltipData=function(e){var t,i,r=e.target.parentElement.id.match(/\d+/g);"ResourceView"===this.parent.viewType?(t=this.parent.flatData[this.parent.getTaskIds().indexOf("T"+r[0])],i=this.parent.flatData[this.parent.getTaskIds().indexOf("T"+r[1])]):(t=this.parent.flatData[this.parent.ids.indexOf(r[0])],i=this.parent.flatData[this.parent.ids.indexOf(r[1])]);var a=t.ganttProperties.predecessor.filter((function(e){return e.to===r[1]}));return{fromId:"ResourceView"===this.parent.viewType?t.ganttProperties.taskId:t.ganttProperties.rowUniqueID,toId:"ResourceView"===this.parent.viewType?i.ganttProperties.taskId:i.ganttProperties.rowUniqueID,fromName:t.ganttProperties.taskName,toName:i.ganttProperties.taskName,linkType:a[0].type,linkText:this.parent.getPredecessorTextValue(a[0].type),offset:a[0].offset,offsetUnit:a[0].offsetUnit,offsetString:this.parent.getDurationString(a[0].offset,a[0].offsetUnit)}},e.prototype.templateCompiler=function(e,t,i,r){var a=t.chartRowsModule.templateCompiler(e),s=t.chartRowsModule.getTemplateID(r);return a(sf.base.extend({index:0},i),t,r,s,!0)},e.prototype.destroy=function(){this.toolTipObj.destroy()},e}(),st=function(){function e(e){this.parent=e,this.activeElement=null,this.previousActiveElement=null}return e.prototype.getActiveElement=function(e){return e?this.previousActiveElement:this.activeElement},e.prototype.setActiveElement=function(e){this.previousActiveElement=this.activeElement,this.activeElement=e},e.prototype.onKeyPress=function(e){var t=this.parent,i=t.getExpandedRecords(t.currentViewData),r=this.parent.focusModule.getActiveElement();if("home"!==e.action&&"end"!==e.action&&"downArrow"!==e.action&&"upArrow"!==e.action&&"delete"!==e.action&&"rightArrow"!==e.action&&"leftArrow"!==e.action&&"focusTask"!==e.action&&"focusSearch"!==e.action&&"expandAll"!==e.action&&"collapseAll"!==e.action||sf.base.isNullOrUndefined(t.editModule)||sf.base.isNullOrUndefined(t.editModule.cellEditModule)||!0!==t.editModule.cellEditModule.isCellEdit)switch(t.isAdaptive&&("addRowDialog"!==e.action&&"editRowDialog"!==e.action&&"delete"!==e.action&&"addRow"!==e.action||t.selectionModule&&"Multiple"===t.selectionSettings.type&&(t.selectionModule.hidePopUp(),document.getElementsByClassName("e-gridpopup")[0].style.display="none")),e.action){case"home":if(t.selectionModule&&"Cell"!==t.selectionSettings.mode){if(0===t.selectedRowIndex)return;t.selectionModule.selectRow(0,!1,!0)}break;case"end":if(t.selectionModule&&"Cell"!==t.selectionSettings.mode){var a=i[i.length-1];if(t.selectedRowIndex===t.flatData.indexOf(a))return;t.selectionModule.selectRow(t.flatData.indexOf(a),!1,!0)}break;case"downArrow":case"upArrow":var s=t.element.querySelector("#"+t.element.id+"_searchbar");s&&s.parentElement.classList.contains("e-input-focus")&&t.selectionModule.clearSelection(),t.element.classList.contains("e-scroll-disabled")||(this.upDownKeyNavigate(e),sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.closest(".e-chart-row"))||t.ganttChartModule.manageFocus(this.getActiveElement(),"remove",!0));break;case"expandAll":t.ganttChartModule.expandCollapseAll("expand");break;case"collapseAll":t.ganttChartModule.expandCollapseAll("collapse");break;case"expandRow":case"collapseRow":this.expandCollapseKey(e);break;case"saveRequest":if(!sf.base.isNullOrUndefined(t.editModule)&&!sf.base.isNullOrUndefined(t.editModule.cellEditModule)&&t.editModule.cellEditModule.isCellEdit){var n=t.editModule.cellEditModule.editedColumn;if(n.field===t.columnMapping.duration&&!sf.base.isNullOrUndefined(n.edit)&&!sf.base.isNullOrUndefined(n.edit.read)){var o=e.target.ej2_instances[0],d=e.target.value,l=t.currentViewData[t.selectedRowIndex].ganttProperties;n.field===t.columnMapping.duration&&d!==(sf.base.isNullOrUndefined(n.edit)||sf.base.isNullOrUndefined(n.edit.read)?sf.base.isNullOrUndefined(n.valueAccessor)?t.dataOperation.getDurationString(l.duration,l.durationUnit):n.valueAccessor(t.columnMapping.duration,t.editedRecords,n):n.edit.read()).toString()&&(o.value=d,o.dataBind())}if(t.editModule.dialogModule.dialogObj&&sf.base.getValue("dialogOpen",t.editModule.dialogModule.dialogObj))return;t.editModule.cellEditModule.isCellEdit=!1,t.treeGrid.grid.saveCell(),t.element.querySelector(".e-treegrid").focus()}if(!sf.base.isNullOrUndefined(this.parent.onTaskbarClick)&&!sf.base.isNullOrUndefined(r)&&!sf.base.isNullOrUndefined(r.closest(".e-chart-row"))){var p=e.target,h=r.querySelector(".e-gantt-parent-taskbar,.e-gantt-child-taskbar,.e-gantt-milestone");h&&this.parent.ganttChartModule.onTaskbarClick(e,p,h)}break;case"cancelRequest":sf.base.isNullOrUndefined(t.editModule)||sf.base.isNullOrUndefined(t.editModule.cellEditModule)||(t.editModule.cellEditModule.isCellEdit=!1,sf.base.isNullOrUndefined(t.toolbarModule)||t.toolbarModule.refreshToolbarItems());break;case"addRow":e.preventDefault(),t.element.querySelector(".e-gantt-chart").focus(),t.addRecord();break;case"addRowDialog":if(e.preventDefault(),t.editModule&&t.editModule.dialogModule&&t.editSettings.allowAdding){if(t.editModule.dialogModule.dialogObj&&sf.base.getValue("dialogOpen",t.editModule.dialogModule.dialogObj))return;t.editModule.dialogModule.openAddDialog()}break;case"editRowDialog":if(e.preventDefault(),t.element.querySelector(".e-treegrid").focus(),t.editModule&&t.editModule.dialogModule&&t.editSettings.allowEditing){if(t.editModule.dialogModule.dialogObj&&sf.base.getValue("dialogOpen",t.editModule.dialogModule.dialogObj))return;t.editModule.dialogModule.openToolbarEditDialog()}break;case"delete":t.selectionModule&&t.editModule&&(!t.editModule.dialogModule.dialogObj||t.editModule.dialogModule.dialogObj&&!t.editModule.dialogModule.dialogObj.visible)&&(!t.editSettings.allowTaskbarEditing||t.editSettings.allowTaskbarEditing&&!t.editModule.taskbarEditModule.touchEdit)&&("Cell"!==t.selectionSettings.mode&&t.selectionModule.selectedRowIndexes.length||"Cell"===t.selectionSettings.mode&&t.selectionModule.getSelectedRowCellIndexes().length)&&t.editModule.startDeleteAction();break;case"focusTask":e.preventDefault();var c=void 0;if(t.selectionModule){var u=t.currentViewData;if("Cell"===t.selectionSettings.mode||sf.base.isNullOrUndefined(u[t.selectedRowIndex])){if("Cell"===t.selectionSettings.mode&&t.selectionModule.getSelectedRowCellIndexes().length>0){var f=t.selectionModule.getSelectedRowCellIndexes();c=u[f[f.length-1].rowIndex].ganttProperties.rowUniqueID}}else c=t.currentViewData[t.selectedRowIndex].ganttProperties.rowUniqueID}c&&t.scrollToTask(c.toString());break;case"focusSearch":if(t.element.querySelector("#"+t.element.id+"_searchbar")){var g=t.element.querySelector("#"+t.element.id+"_searchbar");g.setAttribute("tabIndex","-1"),g.focus()}break;case"tab":case"shiftTab":t.element.classList.contains("e-scroll-disabled")||t.ganttChartModule.onTabAction(e);break;case"contextMenu":var m=document.getElementById(this.parent.element.id+"_contextmenu").ej2_instances[0],y=this.parent.getOffsetRect(e.target),b=y.top+y.height/2,v=y.left+y.width/2;this.setActiveElement(e.target),m.open(b,v),e.preventDefault();break;default:var D={requestType:"keyPressed",action:e.action,keyEvent:e};t.trigger("actionComplete",D)}},e.prototype.upDownKeyNavigate=function(e){e.preventDefault();var t=this.parent,i=t.getExpandedRecords(t.currentViewData);if(t.selectionModule){if("Cell"!==t.selectionSettings.mode&&-1!==t.selectedRowIndex){var r=t.currentViewData[t.selectedRowIndex],a=this.parent.ganttChartModule.focusedRowIndex,s=a>-1?a:i.indexOf(r),n="downArrow"===e.action?i[s+1]:i[s-1];t.selectionModule.selectRow(t.currentViewData.indexOf(n),!1,!0)}else if("Cell"===t.selectionSettings.mode&&t.selectionModule.getSelectedRowCellIndexes().length>0){var o=t.selectionModule.getSelectedRowCellIndexes(),d=o[o.length-1],l=d.cellIndexes[d.cellIndexes.length-1],p=(r=t.currentViewData[d.rowIndex],s=i.indexOf(r),n="downArrow"===e.action?i[s+1]:i[s-1],{rowIndex:t.currentViewData.indexOf(n),cellIndex:l});t.selectionModule.selectCell(p)}this.parent.ganttChartModule.focusedRowIndex=this.parent.selectedRowIndex}},e.prototype.expandCollapseKey=function(e){var t=this.parent;if(t.selectionModule&&-1!==t.selectedRowIndex){var i=void 0;if("Cell"!==t.selectionSettings.mode)i=t.selectedRowIndex;else if("Cell"===t.selectionSettings.mode&&t.selectionModule.getSelectedRowCellIndexes().length>0){var r=t.selectionModule.getSelectedRowCellIndexes();i=r[r.length-1].rowIndex}"expandRow"===e.action?t.expandByIndex(i):t.collapseByIndex(i)}},e}(),nt=(I=function(e,t){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}I(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ot=function(e,t,r,a){var s,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var d=e.length-1;d>=0;d--)(s=e[d])&&(o=(n<3?s(o):n>3?s(t,r,o):s(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},dt=function(e){function t(t,i){var r=e.call(this,t,i)||this;return r.isCancelled=!1,r.previousRecords={},r.editedRecords=[],r.modifiedRecords=[],r.isOnEdit=!1,r.isOnDelete=!1,r.isConnectorLineUpdate=!1,r.staticSelectedRowIndex=-1,r.needsID=!0,r.showActiveElement=!0,r.enableHeaderFocus=!0,r.enableValidation=!0,r.isTreeGridRendered=!1,r.isGanttChartRendered=!1,r}return nt(t,e),t.prototype.getModuleName=function(){return"gantt"},t.prototype.preRender=function(){this.initProperties()},t.prototype.initProperties=function(){this.globalize=new sf.base.Internationalization(this.locale),this.isAdaptive=sf.base.Browser.isDevice,this.flatData=[],this.currentViewData=[],this.ids=[],this.ganttColumns=[],this.localeObj=new sf.base.L10n(this.getModuleName(),this.getDefaultLocale(),this.locale),this.dataOperation=new U(this),this.nonWorkingHours=[],this.nonWorkingTimeRanges=[],this.workingTimeRanges=[],this.defaultEndTime=null,this.defaultStartTime=null,this.durationUnitTexts={days:"days",hours:"hours",minutes:"minutes",day:"day",hour:"hour",minute:"minute"},this.durationUnitEditText={minute:["m","min","minute","minutes"],hour:["h","hr","hour","hours"],day:["d","dy","day","days"]},this.perDayWidth=null,this.isMileStoneEdited=!1,this.chartVerticalLineContainer=null,this.updatedConnectorLineCollection=[],this.connectorLineIds=[],this.predecessorsCollection=[],this.isInPredecessorValidation=this.enablePredecessorValidation,this.isValidationEnabled=!0,this.isLoad=!0,this.editedTaskBarItem=null,this.validationDialogElement=null,this.currentEditedArgs={},this.dialogValidateMode={respectLink:!1,removeLink:!1,preserveLinkWithEditing:!0},this.secondsPerDay=this.dataOperation.getSecondsPerDay(),this.nonWorkingDayIndex=[],this.dataOperation.getNonWorkingDayIndex(),this.columnMapping={},this.controlId=this.element.id,this.cloneProjectStartDate=null,this.cloneProjectEndDate=null,this.totalHolidayDates=this.dataOperation.getHolidayDates(),this.ganttChartModule=new J(this),this.timelineModule=new ee(this),this.chartRowsModule=new et(this),this.treeGridModule=new ie(this),this.dateValidationModule=new F(this),this.predecessorModule=new tt(this),this.connectorLineModule=new it(this),this.splitterModule=new rt(this),this.tooltipModule=new at(this),this.keyConfig={home:"home",end:"end",downArrow:"downarrow",upArrow:"uparrow",collapseAll:"ctrl+uparrow",expandAll:"ctrl+downarrow",collapseRow:"ctrl+shift+uparrow",expandRow:"ctrl+shift+downarrow",saveRequest:"13",cancelRequest:"27",addRow:"insert",addRowDialog:"ctrl+insert",editRowDialog:"ctrl+f2",delete:"delete",tab:"tab",shiftTab:"shift+tab",focusTask:"shift+f5",indentLevel:"shift+leftarrow",outdentLevel:"shift+rightarrow",focusSearch:"ctrl+shift+70",contextMenu:"shift+F10"},this.focusModule=new st(this),this.zoomingLevels=this.getZoomingLevels(),this.resourceFieldsMapping(),sf.base.isNullOrUndefined(this.resourceFields.unit)&&(this.resourceFields.unit="unit"),sf.base.isNullOrUndefined(this.taskFields.work)||(this.taskType="FixedWork"),this.taskIds=[]},t.prototype.getDateFormat=function(){return sf.base.isNullOrUndefined(this.dateFormat)?sf.base.isBlazor()?this.globalize.getDatePattern({skeleton:"d"}):this.globalize.getDatePattern({skeleton:"yMd"}):this.dateFormat},t.prototype.resourceFieldsMapping=function(){var e=this.resourceFields;e.id=sf.base.isNullOrUndefined(e.id)?this.resourceIDMapping:e.id,e.name=sf.base.isNullOrUndefined(e.name)?this.resourceNameMapping:e.name},t.prototype.validateDimentionValue=function(e){return sf.base.isNullOrUndefined(e)?null:"string"==typeof e&&"auto"!==e&&-1===e.indexOf("%")?-1===e.indexOf("px")?e+"px":e:"number"==typeof e?e+"px":e.toString()},t.prototype.calculateDimensions=function(){var e=this.validateDimentionValue(this.height),t=this.validateDimentionValue(this.width);sf.base.isNullOrUndefined(this.width)||"string"!=typeof this.width||-1===this.width.indexOf("%")||(t=this.width);var i=this.element.style.height,r=this.element.style.width;t&&(this.element.style.width=t),e&&(this.element.style.height=e),e||i||(this.element.style.height="auto"),t||r||(this.element.style.width="auto"),this.ganttHeight=this.element.offsetHeight,this.ganttWidth=this.element.offsetWidth},t.prototype.render=function(){this.isReact&&(this.treeGrid.isReact=!0,this.treeGrid.grid.isReact=!0),sf.popups.createSpinner({target:this.element},this.createElement),this.trigger("load",{}),this.element.classList.add("e-gantt"),this.isAdaptive?this.element.classList.add("e-device"):this.element.classList.remove("e-device"),this.calculateDimensions(),sf.base.isNullOrUndefined(this.toolbarModule)||this.renderToolbar(),this.splitterModule.renderSplitter(),this.notify("renderPanels",null),this.showSpinner(),this.dataOperation.checkDataBinding()},t.prototype.showSpinner=function(){sf.popups.showSpinner(this.element)},t.prototype.hideSpinner=function(){sf.popups.hideSpinner(this.element)},t.prototype.processTimeline=function(){this.timelineModule.processTimelineUnit(),this.timelineModule.calculateZoomingLevelsPerDayWidth()},t.prototype.renderGantt=function(e){this.predecessorModule&&this.taskFields.dependency&&(this.predecessorModule.updatePredecessors(),this.isInPredecessorValidation&&this.enableValidation&&this.predecessorModule.updatedRecordsDateByPredecessor()),this.enableValidation&&(this.dataOperation.calculateProjectDates(),this.timelineModule.validateTimelineProp()),e?(this.updateProjectDates(this.cloneProjectStartDate,this.cloneProjectEndDate,this.isTimelineRoundOff),this.enableValidation&&this.dataOperation.updateGanttData(),this.treeGrid.dataSource=this.flatData):(this.enableValidation&&this.dataOperation.updateGanttData(),this.treeGridPane.classList.remove("e-temp-content"),sf.base.remove(this.treeGridPane.querySelector(".e-gantt-temp-header")),this.notify("dataReady",{}),this.enableContextMenu&&this.notify("initiate-contextMenu",{}),this.renderTreeGrid(),this.wireEvents(),this.notify("initPredessorDialog",{})),this.splitterModule.updateSplitterPosition(),"Vertical"!==this.gridLines&&"Both"!==this.gridLines||this.renderChartVerticalLines()},t.prototype.wireEvents=function(){this.allowKeyboard&&(this.keyboardModule=new sf.base.KeyboardEvents(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfig,eventName:"keydown"})),sf.base.EventHandler.add(window,"resize",this.windowResize,this)},t.prototype.windowResize=function(){sf.base.isNullOrUndefined(this.element)||(this.updateContentHeight(),this.ganttChartModule.updateWidthAndHeight(),this.treeGridModule.ensureScrollBar(),this.predecessorModule&&this.taskFields.dependency&&(this.updateRowHeightInConnectorLine(this.updatedConnectorLineCollection),this.connectorLineModule.renderConnectorLines(this.updatedConnectorLineCollection)))},t.prototype.keyActionHandler=function(e){this.focusModule.onKeyPress(e)},t.prototype.updateRowHeightInConnectorLine=function(e){if(e&&e.length){var t=this.ganttChartModule.getChartRows()[0]&&this.ganttChartModule.getChartRows()[0].getBoundingClientRect().height;if(t&&!isNaN(t))for(var i=0;i<e.length;i++)e[i].rowHeight=t}},t.prototype.renderToolbar=function(){sf.base.isNullOrUndefined(this.toolbarModule)||(this.toolbarModule.renderToolbar(),this.toolbarModule.refreshToolbarItems())},t.prototype.renderTreeGrid=function(){this.treeGridModule.renderTreeGrid()},t.prototype.updateCurrentViewData=function(){if(sf.base.isBlazor()&&0!==this.flatData.length){var e=this.treeGrid.getCurrentViewRecords().slice();this.currentViewData=[];for(var t=0;t<e.length;t++)this.currentViewData.push(this.getTaskByUniqueID(e[t].uniqueID));this.treeGrid.grid.currentViewData=this.currentViewData}else this.currentViewData=this.treeGrid.getCurrentViewRecords().slice()},t.prototype.getRecordFromFlatdata=function(e){for(var t=[],i=0;i<e.length;i++)t.push(this.getTaskByUniqueID(e[i].uniqueID));return t},t.prototype.updateContentHeight=function(e){if(this.virtualScrollModule&&this.enableVirtualization&&!sf.base.isNullOrUndefined(e)){var t=sf.base.getValue("count",e);this.contentHeight=t*this.rowHeight}else{var i=this.getExpandedRecords(this.currentViewData),r=void 0,a=this.ganttChartModule.getChartRows()[0];r=!sf.base.isNullOrUndefined(a)&&a.getBoundingClientRect().height>0?a.getBoundingClientRect().height:this.rowHeight,this.contentHeight=i.length*r}},t.prototype.getExpandStatus=function(e){var t=this.getParentTask(e.parentItem);return!!sf.base.isNullOrUndefined(t)||!1!==t.expanded&&(!t.parentItem||!1!==this.getParentTask(t.parentItem).expanded&&this.getExpandStatus(this.getParentTask(t.parentItem)))},t.prototype.getExpandedRecords=function(e){var t=this;return e.filter((function(e){return!0===t.getExpandStatus(e)}))},t.prototype.getZoomingLevels=function(){return[{topTier:{unit:"Year",format:"yyyy",count:50},bottomTier:{unit:"Year",format:"yyyy",count:10},timelineUnitSize:99,level:0,timelineViewMode:"Year",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Year",format:"yyyy",count:20},bottomTier:{unit:"Year",format:"yyyy",count:5},timelineUnitSize:99,level:1,timelineViewMode:"Year",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Year",format:"yyyy",count:5},bottomTier:{unit:"Year",format:"yyyy",count:1},timelineUnitSize:99,level:2,timelineViewMode:"Year",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Year",format:"MMM, yy",count:1},bottomTier:{unit:"Month",formatter:this.displayHalfValue,count:6},timelineUnitSize:66,level:3,timelineViewMode:"Year",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Year",format:"MMM, yy",count:1},bottomTier:{unit:"Month",formatter:this.displayHalfValue,count:6},timelineUnitSize:99,level:4,timelineViewMode:"Year",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Year",format:"MMM, yy",count:1},bottomTier:{unit:"Month",formatter:this.displayQuarterValue,count:3},timelineUnitSize:66,level:5,timelineViewMode:"Year",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Year",format:"yyyy",count:1},bottomTier:{unit:"Month",formatter:this.displayQuarterValue,count:3},timelineUnitSize:99,level:6,timelineViewMode:"Year",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Year",format:"yyyy",count:1},bottomTier:{unit:"Month",format:"MMM yyyy",count:1},timelineUnitSize:99,level:7,timelineViewMode:"Year",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Month",format:"MMM, yy",count:1},bottomTier:{unit:"Week",format:"dd",count:1},timelineUnitSize:33,level:8,timelineViewMode:"Month",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Month",format:"MMM, yyyy",count:1},bottomTier:{unit:"Week",format:"dd MMM",count:1},timelineUnitSize:66,level:9,timelineViewMode:"Month",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Month",format:"MMM, yyyy",count:1},bottomTier:{unit:"Week",format:"dd MMM",count:1},timelineUnitSize:99,level:10,timelineViewMode:"Month",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Week",format:"MMM dd, yyyy",count:1},bottomTier:{unit:"Day",format:"d",count:1},timelineUnitSize:33,level:11,timelineViewMode:"Week",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Week",format:"MMM dd, yyyy",count:1},bottomTier:{unit:"Day",format:"d",count:1},timelineUnitSize:66,level:12,timelineViewMode:"Week",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Week",format:"MMM dd, yyyy",count:1},bottomTier:{unit:"Day",format:"d",count:1},timelineUnitSize:99,level:13,timelineViewMode:"Week",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Day",format:"E dd yyyy",count:1},bottomTier:{unit:"Hour",format:"hh a",count:12},timelineUnitSize:66,level:14,timelineViewMode:"Day",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Day",format:"E dd yyyy",count:1},bottomTier:{unit:"Hour",format:"hh a",count:12},timelineUnitSize:99,level:15,timelineViewMode:"Day",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Day",format:"E dd yyyy",count:1},bottomTier:{unit:"Hour",format:"hh a",count:6},timelineUnitSize:66,level:16,timelineViewMode:"Day",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Day",format:"E dd yyyy",count:1},bottomTier:{unit:"Hour",format:"hh a",count:6},timelineUnitSize:99,level:17,timelineViewMode:"Day",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Day",format:"E dd yyyy",count:1},bottomTier:{unit:"Hour",format:"hh a",count:2},timelineUnitSize:66,level:18,timelineViewMode:"Day",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Day",format:"E dd yyyy",count:1},bottomTier:{unit:"Hour",format:"hh a",count:2},timelineUnitSize:99,level:19,timelineViewMode:"Day",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Day",format:"E dd yyyy",count:1},bottomTier:{unit:"Hour",format:"hh a",count:1},timelineUnitSize:66,level:20,timelineViewMode:"Day",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Day",format:"E dd yyyy",count:1},bottomTier:{unit:"Hour",format:"hh a",count:1},timelineUnitSize:99,level:21,timelineViewMode:"Day",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Hour",format:"ddd MMM, h a",count:1},bottomTier:{unit:"Minutes",format:"mm",count:30},timelineUnitSize:66,level:22,timelineViewMode:"Hour",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Hour",format:"ddd MMM, h a",count:1},bottomTier:{unit:"Minutes",format:"mm",count:15},timelineUnitSize:66,level:23,timelineViewMode:"Hour",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Hour",format:"ddd MMM, h a",count:1},bottomTier:{unit:"Minutes",format:"mm",count:1},timelineUnitSize:66,level:24,timelineViewMode:"Hour",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0}]},t.prototype.displayQuarterValue=function(e){var t=e.getMonth();return t>=0&&t<=2?"Q1":t>=3&&t<=5?"Q2":t>=6&&t<=8?"Q3":"Q4"},t.prototype.displayHalfValue=function(e){var t=e.getMonth();return t>=0&&t<=6?"H1":"H2"},t.prototype.getFormatedDate=function(e,t){return sf.base.isNullOrUndefined(e)?null:(sf.base.isNullOrUndefined(t)&&(t=this.getDateFormat()),this.globalize.formatDate(e,{format:t}))},t.prototype.getDurationString=function(e,t){return this.dateValidationModule.getDurationString(e,t)},t.prototype.getWorkString=function(e,t){return this.dateValidationModule.getWorkString(e,t)},t.prototype.treeDataBound=function(e){if(this.isLoad){if(this.updateCurrentViewData(),this.enableVirtualization||this.updateContentHeight(),!this.isTreeGridRendered){this.isTreeGridRendered=!0;var t=0;sf.base.isNullOrUndefined(this.toolbarModule)||sf.base.isNullOrUndefined(this.toolbarModule.element)||(t=this.toolbarModule.element.offsetHeight),this.timelineModule.isSingleTier?(sf.base.addClass(this.treeGrid.element.querySelectorAll(".e-headercell"),L),sf.base.addClass(this.treeGrid.element.querySelectorAll(".e-columnheader"),L)):(sf.base.removeClass(this.treeGrid.element.querySelectorAll(".e-headercell"),L),sf.base.removeClass(this.treeGrid.element.querySelectorAll(".e-columnheader"),L)),this.treeGrid.height=this.ganttHeight-t-this.treeGrid.grid.getHeaderContent().offsetHeight,this.notify("tree-grid-created",{}),this.createGanttPopUpElement(),this.hideSpinner(),sf.base.setValue("isGanttCreated",!0,e),this.renderComplete()}}else this.getCurrentRecords(e);this.notify("recordsUpdated",{}),this.isLoad=!1,this.trigger("dataBound",e)},t.prototype.getCurrentRecords=function(e){this.predecessorModule&&this.taskFields.dependency&&this.connectorLineModule.removePreviousConnectorLines(this.currentViewData),this.updateCurrentViewData(),this.enableVirtualization||this.updateContentHeight(),this.virtualScrollModule&&this.enableVirtualization&&(this.ganttChartModule.virtualRender.adjustTable(),this.ganttChartModule.scrollObject.updateTopPosition())},t.prototype.onPropertyChanged=function(e,t){for(var i=!1,r=0,a=Object.keys(e);r<a.length;r++){var s=a[r];switch(s){case"allowSelection":case"allowRowDragAndDrop":case"allowFiltering":case"showColumnMenu":case"allowResizing":case"allowReordering":case"enableImmutableMode":this.treeGrid[s]=this[s],this.treeGrid.dataBind();break;case"workWeek":this.dataOperation.getNonWorkingDayIndex(),this.dataOperation.reUpdateGanttData(),this.chartRowsModule.initiateTemplates(),this.taskFields.dependency&&this.predecessorModule.updatedRecordsDateByPredecessor(),this.chartRowsModule.refreshGanttRows(),this.treeGrid.refreshColumns(),this.timelineModule.refreshTimeline();break;case"toolbar":this.notify("ui-toolbarupdate",{module:"toolbar",properties:e});break;case"columnMenuItems":this.treeGrid.grid.columnMenuItems=sf.grids.getActualProperties(this.columnMenuItems);break;case"eventMarkers":case"highlightWeekends":this.notify("ui-update",{module:"day-markers",properties:e});break;case"sortSettings":this.treeGrid.sortSettings=sf.grids.getActualProperties(this.sortSettings),this.treeGrid.dataBind();break;case"timelineSettings":this.timelineModule.refreshTimeline();break;case"rowHeight":case"taskbarHeight":this.treeGrid.rowHeight=this.rowHeight,this.treeGrid.dataBind(),this.chartRowsModule.initiateTemplates(),this.timelineModule.updateChartByNewTimeline(),this.taskFields.dependency&&this.ganttChartModule.reRenderConnectorLines();break;case"filterSettings":this.treeGrid.filterSettings=sf.grids.getActualProperties(this.filterSettings),this.treeGrid.dataBind();break;case"gridLines":this.treeGrid.gridLines=this.gridLines,this.treeGrid.dataBind(),this.renderChartGridLines();break;case"tooltipSettings":this.tooltipModule.toolTipObj&&this.tooltipModule.toolTipObj.destroy(),this.tooltipModule.createTooltip();break;case"splitterSettings":this.splitterModule.updateSplitterPosition();break;case"selectionSettings":this.treeGrid.selectionSettings=sf.grids.getActualProperties(this.selectionSettings),this.treeGrid.grid.selectionSettings.enableToggle=this.selectionSettings.enableToggle,this.treeGrid.dataBind();break;case"searchSettings":this.treeGrid.grid.searchSettings=sf.grids.getActualProperties(this.searchSettings),this.treeGrid.grid.dataBind(),this.toolbarModule&&this.toolbarModule.updateSearchTextBox();break;case"labelSettings":case"renderBaseline":case"baselineColor":this.chartRowsModule.initiateTemplates(),this.chartRowsModule.refreshGanttRows();break;case"resourceIDMapping":case"resourceNameMapping":case"resources":this.dataOperation.reUpdateResources(),this.treeGrid.refreshColumns(),this.chartRowsModule.initiateTemplates(),this.chartRowsModule.refreshGanttRows();break;case"includeWeekend":case"dayWorkingTime":case"allowUnscheduledTasks":case"holidays":"holidays"===s&&(this.totalHolidayDates=this.dataOperation.getHolidayDates(),this.notify("ui-update",{module:"day-markers",properties:e})),this.dataOperation.reUpdateGanttData(),this.treeGrid.refreshColumns(),this.chartRowsModule.initiateTemplates(),this.chartRowsModule.refreshGanttRows();break;case"addDialogFields":case"editDialogFields":this.editModule&&this.editModule.dialogModule&&this.editModule.dialogModule.processDialogFields();break;case"columns":this.treeGridModule.treeGridColumns=[],this.treeGridModule.validateGanttColumns(),this.treeGrid.columns=this.treeGridModule.treeGridColumns,this.chartRowsModule.initiateTemplates(),this.timelineModule.updateChartByNewTimeline();break;case"width":case"height":this.reUpdateDimention();break;case"editSettings":this.treeGrid.editSettings.allowAdding=this.editSettings.allowAdding,this.treeGrid.editSettings.allowDeleting=this.editSettings.allowDeleting,this.treeGrid.editSettings.showDeleteConfirmDialog=this.editSettings.showDeleteConfirmDialog,this.treeGrid.editSettings.allowEditing=this.editSettings.allowEditing,sf.base.isNullOrUndefined(this.editModule)||this.editModule.reUpdateEditModules(),sf.base.isNullOrUndefined(this.toolbarModule)||this.toolbarModule.refreshToolbarItems();break;case"connectorLineBackground":case"connectorLineWidth":this.taskFields.dependency&&(this.connectorLineModule.initPublicProp(),this.ganttChartModule.reRenderConnectorLines());break;case"treeColumnIndex":this.treeGrid.treeColumnIndex=this.treeColumnIndex;break;case"projectStartDate":case"projectEndDate":this.dataOperation.calculateProjectDates(),this.updateProjectDates(this.cloneProjectStartDate,this.cloneProjectEndDate,this.isTimelineRoundOff);break;case"selectedRowIndex":sf.base.isNullOrUndefined(this.selectionModule)||this.selectionModule.selectRowByIndex();break;case"dataSource":this.closeGanttActions(),this.dataOperation.checkDataBinding(!0);break;case"enableContextMenu":case"contextMenuItems":this.enableContextMenu||"contextMenuItems"===s?this.notify("reRender-contextMenu",{module:"contextMenu",enable:this.contextMenuItems}):this.treeGrid.contextMenuItems=[],this.treeGrid.dataBind();break;case"currencyCode":case"locale":case"enableRtl":case"readOnly":case"viewType":i=!0;break;case"validateManualTasksOnLinking":this.validateManualTasksOnLinking=e.validateManualTasksOnLinking;break;case"showOverAllocation":this.updateOverAllocationCotainer()}}i&&this.refresh()},t.prototype.updateOverAllocationCotainer=function(){if(this.showOverAllocation&&"ResourceView"===this.viewType)this.ganttChartModule.renderOverAllocationContainer();else{var e=this.element.querySelector(".e-rangecontainer");e&&(e.innerHTML="")}},t.prototype.getPersistData=function(){return this.addOnPersist(["allowSelection"])},t.prototype.destroy=function(){this.notify("destroy",{}),sf.base.isNullOrUndefined(this.validationDialogElement)||this.validationDialogElement.isDestroyed||this.validationDialogElement.destroy();for(var t=["ganttChartModule","timelineModule","chartRowsModule","treeGridModule","ganttDataUpdatesModule","dateValidationModule","tooltipModule"],i=0;i<t.length;i++)this[t[i]]&&(this[t[i]]=null);this.keyboardModule&&this.keyboardModule.destroy(),e.prototype.destroy.call(this),this.chartVerticalLineContainer=null,this.element.innerHTML="",sf.base.removeClass([this.element],"e-gantt"),this.element.innerHTML="",this.isTreeGridRendered=!1,this.resetTemplates(),sf.base.EventHandler.remove(window,"resize",this.windowResize)},t.prototype.getTaskbarHeight=function(){return this.chartRowsModule.taskBarHeight},t.prototype.requiredModules=function(){var e=[];return this.isDestroyed||(this.allowSorting&&e.push({member:"sort",args:[this]}),(this.allowFiltering||this.toolbar&&-1!==this.toolbar.indexOf("Search"))&&e.push({member:"filter",args:[this]}),this.allowReordering&&e.push({member:"reorder",args:[this]}),this.allowExcelExport&&e.push({member:"excelExport",args:[this]}),this.allowRowDragAndDrop&&e.push({member:"rowDragAndDrop",args:[this]}),this.allowResizing&&e.push({member:"resize",args:[this]}),this.toolbar&&e.push({member:"toolbar",args:[this]}),(this.editSettings.allowAdding||this.editSettings.allowEditing||this.editSettings.allowDeleting||this.editSettings.allowTaskbarEditing||this.allowRowDragAndDrop)&&e.push({member:"edit",args:[this]}),this.allowSelection&&e.push({member:"selection",args:[this]}),this.tooltipSettings.showTooltip&&e.push({member:"tooltip",args:[this]}),(this.highlightWeekends||this.holidays&&this.holidays.length>0||this.eventMarkers&&this.eventMarkers.length>0)&&e.push({member:"dayMarkers",args:[this]}),this.enableContextMenu&&e.push({member:"contextMenu",args:[this]}),this.showColumnMenu&&e.push({member:"columnMenu",args:[this]}),this.allowPdfExport&&e.push({member:"pdfExport",args:[this]}),this.enableVirtualization&&e.push({member:"virtualScroll",args:[this]})),e},t.prototype.sortColumn=function(e,t,i){this.sortModule&&this.allowSorting&&this.sortModule.sortColumn(e,t,i)},t.prototype.clearSorting=function(){this.sortModule.clearSorting()},t.prototype.renderChartGridLines=function(){var e="e-chart-row-border",t=this.chartVerticalLineContainer,i=document.getElementById(this.element.id+"GanttTaskTableBody").querySelectorAll("td");if("Vertical"===this.gridLines){if(sf.base.isNullOrUndefined(t)?this.renderChartVerticalLines():"none"===t.style.display&&(t.style.display="block"),i[0].classList.contains(e))for(var r=0;r<i.length;r++)sf.base.removeClass([i[r]],e)}else if("Horizontal"===this.gridLines){if(sf.base.isNullOrUndefined(t)||(t.style.display="none"),!i[0].classList.contains(e))for(r=0;r<i.length;r++)sf.base.addClass([i[r]],e)}else if("Both"===this.gridLines){if(sf.base.isNullOrUndefined(t)?this.renderChartVerticalLines():"none"===t.style.display&&(t.style.display="block"),!i[0].classList.contains(e))for(r=0;r<i.length;r++)sf.base.addClass([i[r]],e)}else if("None"===this.gridLines&&(sf.base.isNullOrUndefined(t)||"none"===t.style.display||(t.style.display="none"),i[0].classList.contains(e)))for(r=0;r<i.length;r++)sf.base.removeClass([i[r]],e)},t.prototype.updateGridLineContainerHeight=function(){this.chartVerticalLineContainer&&(this.chartVerticalLineContainer.style.height=sf.base.formatUnit(this.getContentHeight()))},t.prototype.getContentHeight=function(){var e=this.ganttChartModule.scrollElement.offsetHeight-16,t=this.ganttChartModule.chartBodyContent.offsetHeight;return t<e?t:e},t.prototype.reUpdateDimention=function(){var e=0;this.calculateDimensions(),sf.base.isNullOrUndefined(this.toolbarModule)||sf.base.isNullOrUndefined(this.toolbarModule.element)||(this.toolbarModule.toolbar.refresh(),this.toolbarModule.refreshToolbarItems(),e=this.toolbarModule.element.offsetHeight),this.treeGrid.height=this.ganttHeight-e-this.treeGrid.grid.getHeaderContent().offsetHeight,this.splitterModule.splitterObject.height=(this.ganttHeight-e).toString(),this.splitterModule.splitterObject.width=this.ganttWidth.toString(),this.ganttChartModule.scrollObject.setHeight(this.ganttHeight-this.ganttChartModule.chartTimelineContainer.offsetHeight-e)},t.prototype.renderChartVerticalLines=function(){this.element.contains(this.chartVerticalLineContainer)||(this.chartVerticalLineContainer=sf.base.createElement("div",{id:this.element.id+"line-container",styles:"position:absolute;height:100%;z-index:1"}),this.virtualScrollModule&&this.enableVirtualization?this.ganttChartModule.virtualRender.appendChildElements(this.chartVerticalLineContainer):this.ganttChartModule.chartBodyContent.appendChild(this.chartVerticalLineContainer)),this.chartVerticalLineContainer.innerHTML="";var e=this.element.getElementsByClassName("e-timeline-header-table-container")[1];sf.base.isNullOrUndefined(e)&&(e=this.element.getElementsByClassName("e-timeline-header-table-container")[0]);for(var t,i=e.getElementsByTagName("th"),r=i.length,a=0,s=sf.base.createElement("div"),n=0;n<r;n++){a=0===n?-1:a+parseFloat(t),t=i[n].style.width;var o=sf.base.createElement("div",{className:"e-line-container-cell",styles:"left:"+a+"px"});s.appendChild(o)}this.chartVerticalLineContainer.innerHTML=s.innerHTML},t.prototype.getDefaultLocale=function(){var e={emptyRecord:"No records to display",id:"ID",name:"Name",startDate:"Start Date",endDate:"End Date",duration:"Duration",progress:"Progress",dependency:"Dependency",notes:"Notes",baselineStartDate:"Baseline Start Date",baselineEndDate:"Baseline End Date",taskMode:"Task Mode",changeScheduleMode:"Change Schedule Mode",subTasksStartDate:"SubTasks Start Date",subTasksEndDate:"SubTasks End Date",scheduleStartDate:"Schedule Start Date",scheduleEndDate:"Schedule End Date",auto:"Auto",manual:"Manual",type:"Type",offset:"Offset",resourceName:"Resources",resourceID:"Resource ID",day:"day",hour:"hour",minute:"minute",days:"days",hours:"hours",minutes:"minutes",generalTab:"General",customTab:"Custom Columns",writeNotes:"Write Notes",addDialogTitle:"New Task",editDialogTitle:"Task Information",add:"Add",edit:"Edit",update:"Update",delete:"Delete",cancel:"Cancel",search:"Search",task:" task",tasks:" tasks",zoomIn:"Zoom in",zoomOut:"Zoom out",zoomToFit:"Zoom to fit",excelExport:"Excel export",csvExport:"CSV export",pdfExport:"Pdf export",expandAll:"Expand all",collapseAll:"Collapse all",nextTimeSpan:"Next timespan",prevTimeSpan:"Previous timespan",saveButton:"Save",taskBeforePredecessor_FS:'You moved "{0}" to start before "{1}" finishes and the two tasks are linked.As the result, the links cannot be honored. Select one action below to perform',taskAfterPredecessor_FS:'You moved "{0}" away from "{1}" and the two tasks are linked.As the result, the links cannot be honored. Select one action below to perform',taskBeforePredecessor_SS:'You moved "{0}" to start before "{1}" starts and the two tasks are linked.As the result, the links cannot be honored. Select one action below to perform',taskAfterPredecessor_SS:'You moved "{0}" to start after "{1}" starts and the two tasks are linked.As the result, the links cannot be honored. Select one action below to perform',taskBeforePredecessor_FF:'You moved "{0}" to finish before "{1}" finishes and the two tasks are linked.As the result, the links cannot be honored. Select one action below to perform',taskAfterPredecessor_FF:'You moved "{0}" to finish after "{1}" finishes and the two tasks are linked.As the result, the links cannot be honored. Select one action below to perform',taskBeforePredecessor_SF:'You moved "{0}" away from "{1}" to starts and the two tasks are linked.As the result, the links cannot be honored. Select one action below to perform',taskAfterPredecessor_SF:'You moved "{0}" to finish after "{1}" starts and the two tasks are linked.As the result, the links cannot be honored. Select one action below to perform',okText:"Ok",confirmDelete:"Are you sure you want to Delete Record?",from:"From",to:"To",taskLink:"Task Link",lag:"Lag",start:"Start",finish:"Finish",enterValue:"Enter the value",taskInformation:"Task Information",deleteTask:"Delete Task",deleteDependency:"Delete Dependency",convert:"Convert",save:"Save",above:"Above",below:"Below",child:"Child",milestone:"Milestone",toTask:"To Task",toMilestone:"To Milestone",eventMarkers:"Event markers",leftTaskLabel:"Left task label",rightTaskLabel:"Right task label",timelineCell:"Timeline cell",confirmPredecessorDelete:"Are you sure you want to remove dependency link?",unit:"Unit",work:"Work",taskType:"Task Type",unassignedTask:"Unassigned Task",group:"Group",indent:"Indent",outdent:"Outdent",segments:"Segments",splitTask:"Split Task",mergeTask:"Merge Task",left:"Left",right:"Right"};if(sf.base.isBlazor()){sf.base.extend(e,{zoomIn:"Zoom In",zoomOut:"Zoom Out",zoomToFit:"Zoom To Fit",excelExport:"Excel Export",csvExport:"CSV Export",pdfExport:"Pdf Export",expandAll:"Expand All",collapseAll:"Collapse All",nextTimeSpan:"Next Timespan",prevTimeSpan:"Previous Timespan"},{},!0)}return e},t.prototype.removeSortColumn=function(e){this.sortModule.removeSortColumn(e)},t.prototype.actionBeginTask=function(e){this.trigger("actionBegin",e)},t.prototype.scrollToDate=function(e){var t=this.dateValidationModule.getDateFromFormat(e),i=this.dataOperation.getTaskLeft(t,!1);this.ganttChartModule.updateScrollLeft(i)},t.prototype.scrollToTask=function(e){if(-1!==this.ids.indexOf(e)){var t=this.flatData[this.ids.indexOf(e)].ganttProperties.left;this.ganttChartModule.updateScrollLeft(t)}},t.prototype.updateChartScrollOffset=function(e,t){sf.base.isNullOrUndefined(e)||(e=this.ganttChartModule.scrollElement.scrollWidth<=e?this.ganttChartModule.scrollElement.scrollWidth:e,this.ganttChartModule.scrollObject.setScrollLeft(e)),sf.base.isNullOrUndefined(t)||(t=this.ganttChartModule.scrollElement.scrollHeight<=t?this.ganttChartModule.scrollElement.scrollHeight:t,this.ganttChartModule.scrollObject.setScrollTop(t))},t.prototype.getParentTask=function(e){if(sf.base.isNullOrUndefined(e))return null;var t=this.flatData.filter((function(t){return e.uniqueID===t.uniqueID}));return t.length>0?t[0]:null},t.prototype.getRootParent=function(e,t){return e.level===t?e:this.getRootParent(this.getParentTask(e.parentItem),t)},t.prototype.filterByColumn=function(e,t,i,r,a,s){this.treeGrid.filterByColumn(e,t,i,r,a,s)},t.prototype.excelExport=function(e,t,i,r){return this.excelExportModule?this.treeGrid.excelExport(e,t,i,r):null},t.prototype.csvExport=function(e,t,i,r){return this.excelExportModule?this.treeGrid.csvExport(e,t,i,r):null},t.prototype.pdfExport=function(e,t,i){return this.pdfExportModule?this.pdfExportModule.export(e,t,i):null},t.prototype.clearFiltering=function(e){this.treeGrid.grid.clearFiltering(e)},t.prototype.removeFilteredColsByField=function(e){this.treeGrid.removeFilteredColsByField(e,!1)},t.prototype.renderWorkingDayCell=function(e){var t="Auto"!==this.taskMode||!!this.includeWeekend?[]:this.nonWorkingDayIndex,i=this.totalHolidayDates;if(t.length>0&&-1!==t.indexOf(e.date.getDay()))e.isDisabled=!0;else if(i.length>0){var r=new Date(e.date.getTime());r.setHours(0,0,0),-1!==i.indexOf(r.getTime())&&(e.isDisabled=!0)}},t.prototype.previousTimeSpan=function(e){this.timelineModule.performTimeSpanAction("prevTimeSpan","publicMethod",new Date(this.timelineModule.timelineStartDate.getTime()),new Date(this.timelineModule.timelineEndDate.getTime()),e)},t.prototype.nextTimeSpan=function(e){this.timelineModule.performTimeSpanAction("nextTimeSpan","publicMethod",new Date(this.timelineModule.timelineStartDate.getTime()),new Date(this.timelineModule.timelineEndDate.getTime()),e)},t.prototype.updateProjectDates=function(e,t,i,r){sf.base.isBlazor()&&(e=this.dataOperation.getDateFromFormat(e),t=this.dataOperation.getDateFromFormat(t)),this.timelineModule.totalTimelineWidth=0,this.cloneProjectStartDate=e,this.cloneProjectEndDate=t,this.isTimelineRoundOff=i,this.timelineModule.refreshTimelineByTimeSpan(),this.dataOperation.reUpdateGanttDataPosition(),this.timelineModule.updateChartByNewTimeline(),this.ganttChartModule.chartBodyContent.style.width=sf.base.formatUnit(this.timelineModule.totalTimelineWidth),this.ganttChartModule.updateLastRowBottomWidth(),"Vertical"!==this.gridLines&&"Both"!==this.gridLines||this.renderChartVerticalLines(),this.taskFields.dependency&&this.ganttChartModule.reRenderConnectorLines(),"beforeAdd"!==r&&this.notify("selectRowByIndex",{})},t.prototype.splitTask=function(e,t){this.chartRowsModule.splitTask(e,t)},t.prototype.mergeTask=function(e,t){this.chartRowsModule.mergeTask(e,t)},t.prototype.reorderColumns=function(e,t){this.treeGrid.reorderColumns(e,t)},t.prototype.initiateEditAction=function(e){this.isOnEdit=e,this.previousRecords={},this.editedRecords=[]},t.prototype.setRecordValue=function(e,t,i,r){if(this.isOnEdit||this.isOnDelete){this.makeCloneData(e,i,r);var a=r?i.rowUniqueID:i.ganttProperties.rowUniqueID,s=this.getRecordByID(a);s&&-1===this.editedRecords.indexOf(s)&&(this.editedRecords.push(s),this.enableImmutableMode&&this.modifiedRecords.push(s))}t=sf.base.isUndefined(t)?null:t,sf.base.setValue(e,t,i)},t.prototype.makeCloneData=function(e,t,i){var r,a,s,n=sf.base.getValue(e,t);if(i&&(e="ganttProperties."+e),sf.base.isNullOrUndefined(this.previousRecords[t.uniqueID])){this.previousRecords[t.uniqueID]={}}r=this.previousRecords[t.uniqueID],a=sf.base.getValue(e,r),sf.base.isUndefined(a)&&(s=n instanceof Date?new Date(n.getTime()):sf.base.isObjectArray(n)?sf.base.extend([],n,[],!0):sf.base.isObject(n)?sf.base.extend({},{},n,!0):n,sf.base.isUndefined(s)?sf.base.setValue(e,null,r):sf.base.setValue(e,s,r))},t.prototype.closeGanttActions=function(){this.editModule&&(this.editModule.cellEditModule&&this.editModule.cellEditModule.isCellEdit?(this.treeGrid.closeEdit(),this.editModule.cellEditModule.isCellEdit=!1,sf.base.isNullOrUndefined(this.toolbarModule)||this.toolbarModule.refreshToolbarItems()):this.editModule.dialogModule&&this.editModule.dialogModule.dialogObj&&this.editModule.dialogModule.dialogObj.visible&&(this.editModule.dialogModule.dialogObj.hide(),this.editModule.dialogModule.dialogClose()))},t.prototype.getTaskByUniqueID=function(e){var t=this.flatData.filter((function(t){return t.uniqueID===e}));return t.length>0?t[0]:null},t.prototype.getRecordByID=function(e){return sf.base.isNullOrUndefined(e)?null:this.flatData[this.ids.indexOf(e.toString())]},t.prototype.setSplitterPosition=function(e,t){var i={};i[t]=e;var r=this.splitterModule.calculateSplitterPosition(i,!0),a=this.splitterModule.splitterObject.element.querySelectorAll(".e-pane")[0],s=this.splitterModule.splitterObject.element.querySelectorAll(".e-pane")[1];this.splitterModule.splitterPreviousPositionGrid=a.scrollWidth+1+"px",this.splitterModule.splitterPreviousPositionChart=s.scrollWidth+1+"px",this.splitterModule.splitterObject.paneSettings[0].size=r,this.splitterModule.triggerCustomResizedEvent()},t.prototype.expandByIndex=function(e){if("number"==typeof e){var t=this.contructExpandCollapseArgs(null,e);this.ganttChartModule.isExpandCollapseFromChart=!0,this.ganttChartModule.expandGanttRow(t)}else for(var i=0;i<e.length;i++)if("number"==typeof e[i]){var r=e[i];t=this.contructExpandCollapseArgs(null,r);this.ganttChartModule.isExpandCollapseFromChart=!0,this.ganttChartModule.expandGanttRow(t)}},t.prototype.expandByID=function(e){var t=this.contructExpandCollapseArgs(e);this.ganttChartModule.isExpandCollapseFromChart=!0,this.ganttChartModule.expandGanttRow(t)},t.prototype.collapseByIndex=function(e){var t=this.contructExpandCollapseArgs(null,e);this.ganttChartModule.isExpandCollapseFromChart=!0,this.ganttChartModule.collapseGanttRow(t)},t.prototype.collapseByID=function(e){var t=this.contructExpandCollapseArgs(e);this.ganttChartModule.isExpandCollapseFromChart=!0,this.ganttChartModule.collapseGanttRow(t)},t.prototype.addRecord=function(e,t,r){if(this.editModule&&this.editSettings.allowAdding)if("ResourceView"===this.viewType){this.editModule.addRowPosition=t,this.editModule.addRowIndex=r;var a=e[this.taskFields.resourceInfo],s=void 0,n=void 0;if(!sf.base.isNullOrUndefined(a)&&a.length){for(var o=0;o<a.length&&(s="object"===i(a[o])?a[o][this.resourceFields.id]:a[0],!(n=this.flatData[this.getTaskIds().indexOf("R"+s)]));o++);if(n&&n.childRecords.length||0===n.level){var d=n.childRecords[r];if(d){var l="Above"===t||"Below"===t?t:"Child";"Child"===l?this.editModule.addRecord(e,l,this.getTaskIds().indexOf("R"+s)):this.editModule.addRecord(e,l,this.flatData.indexOf(d))}else this.editModule.addRecord(e,"Child",this.getTaskIds().indexOf("R"+s))}else this.editModule.addRecord(e,"Bottom")}else this.editModule.addRecord(e,"Bottom");this.editModule.addRowPosition=null,this.editModule.addRowIndex=null}else this.editModule.addRecord(e,t,r)},t.prototype.updateRecordByID=function(e){this.editModule&&this.editSettings.allowEditing&&this.editModule.updateRecordByID(e)},t.prototype.updateTaskId=function(e,t){this.editModule&&this.editSettings.allowEditing&&this.editModule.updateTaskId(e,t)},t.prototype.expandAtLevel=function(e){this.ganttChartModule.expandAtLevel(e)},t.prototype.indent=function(){this.editModule&&this.editSettings.allowEditing&&this.editModule.indent()},t.prototype.outdent=function(){this.editModule&&this.editSettings.allowEditing&&this.editModule.outdent()},t.prototype.zoomIn=function(){this.timelineModule.processZooming(!0)},t.prototype.zoomOut=function(){this.timelineModule.processZooming(!1)},t.prototype.fitToProject=function(){this.timelineModule.processZoomToFit(),this.ganttChartModule.updateScrollLeft(0)},t.prototype.reorderRows=function(e,t,i){this.rowDragAndDropModule.reorderRows(e,t,i)},t.prototype.updateRecordByIndex=function(e,t){if(this.editModule&&this.editSettings.allowEditing){var i,r=this.taskFields;i=this.updatedRecords.length>0?sf.base.isNullOrUndefined(this.updatedRecords[e])?null:this.updatedRecords[e]:null,sf.base.isNullOrUndefined(i)||(t[r.id]=i[r.id],this.editModule.updateRecordByID(t))}},t.prototype.addPredecessor=function(e,t){var i=this.getRecordByID(e.toString());this.editModule&&!sf.base.isNullOrUndefined(i)&&this.editSettings.allowTaskbarEditing&&this.connectorLineEditModule.addPredecessor(i,t)},t.prototype.removePredecessor=function(e){var t=this.getRecordByID(e.toString());this.editModule&&!sf.base.isNullOrUndefined(t)&&this.editSettings.allowTaskbarEditing&&this.connectorLineEditModule.removePredecessor(t)},t.prototype.updatePredecessor=function(e,t){var i=this.getRecordByID(e.toString());this.editModule&&!sf.base.isNullOrUndefined(i)&&this.editSettings.allowTaskbarEditing&&this.connectorLineEditModule.updatePredecessor(i,t)},t.prototype.openAddDialog=function(){this.editModule&&this.editModule.dialogModule&&this.editSettings.allowAdding&&this.editModule.dialogModule.openAddDialog()},t.prototype.openEditDialog=function(e){this.editModule&&this.editModule.dialogModule&&this.editSettings.allowEditing&&this.editModule.dialogModule.openEditDialog(e)},t.prototype.contructExpandCollapseArgs=function(e,t){var i,r,a;return sf.base.isNullOrUndefined(t)?(r=this.getRecordByID(e.toString()),i=this.getRowByID(e),a=sf.base.getValue("rowIndex",i)):sf.base.isNullOrUndefined(t)||(i=this.getRowByIndex(t),a=sf.base.getValue("rowIndex",i),r=this.currentViewData[a]),{data:r,gridRow:this.treeGrid.getRows()[a],chartRow:i,cancel:!1}},t.prototype.getRowByIndex=function(e){try{var t=this.element.querySelectorAll(".e-chart-row");return sf.base.isNullOrUndefined(e)?null:t[e]}catch(e){return null}},t.prototype.getRowByID=function(e){var t=this.getRecordByID(e.toString()),i=this.updatedRecords.indexOf(t);return-1!==i?this.getRowByIndex(i):null},t.prototype.getUnscheduledTaskClass=function(e){return sf.base.isNullOrUndefined(e.startDate)&&sf.base.isNullOrUndefined(e.endDate)&&sf.base.isNullOrUndefined(e.duration)||sf.base.isNullOrUndefined(e.startDate)||sf.base.isNullOrUndefined(e.endDate)||sf.base.isNullOrUndefined(e.duration)?" e-gantt-unscheduled-task":""},t.prototype.isUnscheduledTask=function(e){return!!(sf.base.isNullOrUndefined(e.startDate)||sf.base.isNullOrUndefined(e.endDate)||sf.base.isNullOrUndefined(e.duration))},t.prototype.createGanttPopUpElement=function(){var e=this.createElement("div",{className:"e-ganttpopup",styles:"display:none;"}),t=this.createElement("div",{className:"e-content",attrs:{tabIndex:"-1"}});sf.base.append([t,this.createElement("div",{className:"e-uptail e-tail"})],e),t.appendChild(this.createElement("span")),sf.base.append([t,this.createElement("div",{className:"e-downtail e-tail"})],e),document.getElementById(this.element.id+"GanttChart").appendChild(e)},t.prototype.getPredecessorTextValue=function(e){var t;switch(e){case"SS":t=this.localeObj.getConstant("start")+"-"+this.localeObj.getConstant("start");break;case"FF":t=this.localeObj.getConstant("finish")+"-"+this.localeObj.getConstant("finish");break;case"SF":t=this.localeObj.getConstant("start")+"-"+this.localeObj.getConstant("finish");break;case"FS":t=this.localeObj.getConstant("finish")+"-"+this.localeObj.getConstant("start")}return t},t.prototype.search=function(e){this.filterModule&&(this.searchSettings.key=e,this.dataBind())},t.prototype.getOffsetRect=function(e){var t=e.getBoundingClientRect(),i=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,r=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,a=document.documentElement.clientTop||document.body.clientTop||0,s=document.documentElement.clientLeft||document.body.clientLeft||0,n=t.top+i-a,o=t.left+r-s;return{top:Math.round(n),left:Math.round(o),width:t.width,height:t.height}},t.prototype.expandAll=function(){this.ganttChartModule.expandCollapseAll("expand")},t.prototype.updateDataSource=function(e,t){if(!sf.base.isNullOrUndefined(t))for(var i=0,r=Object.keys(t);i<r.length;i++){var a=r[i];switch(a){case"projectStartDate":this.setProperties({projectStartDate:t[a]},!0);break;case"projectEndDate":this.setProperties({projectEndDate:t[a]},!0)}}this.dataSource=e},t.prototype.collapseAll=function(){this.ganttChartModule.expandCollapseAll("collapse")},t.prototype.getGridColumns=function(){return this.treeGrid.getColumns()},t.prototype.getColumnByField=function(e,t){var i=t.filter((function(t){return t.field===e}));return i.length>0?i[0]:null},t.prototype.getGanttColumns=function(){return this.ganttColumns},t.prototype.showColumn=function(e,t){this.treeGrid.showColumns(e,t)},t.prototype.hideColumn=function(e,t){this.treeGrid.hideColumns(e,t)},t.prototype.setScrollTop=function(e){this.ganttChartModule.scrollObject.setScrollTop(e)},t.prototype.cancelEdit=function(){this.isCancelled=!0,this.closeGanttActions()},t.prototype.selectCell=function(e,t){this.selectionModule&&this.selectionModule.selectCell(e,t)},t.prototype.selectCells=function(e){this.selectionModule&&this.selectionModule.selectCells(e)},t.prototype.selectRow=function(e,t){this.selectionModule&&this.selectionModule.selectRow(e,t)},t.prototype.selectRows=function(e){this.selectionModule&&this.selectionModule.selectRows(e)},t.prototype.deleteRecord=function(e){this.editModule&&this.editModule.deleteRecord(e)},t.prototype.enableItems=function(e,t){this.toolbarModule&&this.toolbarModule.enableItems(e,t)},t.prototype.clearSelection=function(){this.selectionModule&&this.selectionModule.clearSelection()},t.prototype.updateDataArgs=function(e){if(!Array.isArray(e.data)){var t=[];t.push(e.data),sf.base.setValue("data",t,e)}return e},t.prototype.convertToMilestone=function(e){var t=this.getRecordByID(e);if(!sf.base.isNullOrUndefined(t)){var i=sf.base.extend({},{},t.taskData,!0),r=this.taskFields;if(sf.base.isNullOrUndefined(r.duration)?(i[r.startDate]=new Date(t.taskData[r.startDate]),i[r.endDate]=new Date(t.taskData[r.startDate])):i[r.duration]=0,sf.base.isNullOrUndefined(r.milestone)||!1===i[r.milestone]&&(i[r.milestone]=!0),sf.base.isNullOrUndefined(r.progress)||(i[r.progress]=0),!sf.base.isNullOrUndefined(r.child)&&i[r.child]&&(i[r.child]=[]),!sf.base.isNullOrUndefined(r.parentID)&&i[r.parentID]&&(i[r.parentID]=null),sf.base.isNullOrUndefined(r.segments)||(i[r.segments]=null),!sf.base.isNullOrUndefined(this.contextMenuModule)&&this.contextMenuModule.isOpen&&"Milestone"===this.contextMenuModule.item){sf.base.isNullOrUndefined(r.dependency)||(i[r.dependency]=null);this.addRecord(i,"Below")}else t.hasChildRecords||t.ganttProperties.isMilestone||this.updateRecordByID(i)}},t.prototype.changeTaskMode=function(e){var t=this.taskFields,i=this.getRecordByID(e[t.id]),r=i.ganttProperties;this.isOnEdit=!0,this.setRecordValue("isAutoSchedule",!r.isAutoSchedule,r,!0),this.setRecordValue("taskData."+t.manual,!r.isAutoSchedule,i),this.setRecordValue(t.manual,!r.isAutoSchedule,i),this.editModule.updateTaskScheduleModes(i);var a={data:i};this.editModule.initiateUpdateAction(a)},t.prototype.getTaskIds=function(){return this.taskIds},t.prototype.setTaskIds=function(e){if("ProjectView"!==this.viewType){var t=e.ganttProperties.taskId;t=0===e.level?"R"+t:"T"+t,this.taskIds.push(t)}},t.prototype.renderTemplates=function(){this.isReact&&this.renderReactTemplates()},t.prototype.resetTemplates=function(){this.isReact&&this.clearTemplate()},ot([sf.base.Property(!0)],t.prototype,"allowKeyboard",void 0),ot([sf.base.Property(!1)],t.prototype,"enableImmutableMode",void 0),ot([sf.base.Property(!0)],t.prototype,"disableHtmlEncode",void 0),ot([sf.base.Property(!0)],t.prototype,"autoFocusTasks",void 0),ot([sf.base.Property(!0)],t.prototype,"allowSelection",void 0),ot([sf.base.Property(!1)],t.prototype,"allowSorting",void 0),ot([sf.base.Property(!0)],t.prototype,"enablePredecessorValidation",void 0),ot([sf.base.Property(!1)],t.prototype,"showColumnMenu",void 0),ot([sf.base.Property()],t.prototype,"columnMenuItems",void 0),ot([sf.base.Property()],t.prototype,"timezone",void 0),ot([sf.base.Property(!1)],t.prototype,"collapseAllParentTasks",void 0),ot([sf.base.Property(!1)],t.prototype,"highlightWeekends",void 0),ot([sf.base.Property(0)],t.prototype,"treeColumnIndex",void 0),ot([sf.base.Property([])],t.prototype,"dataSource",void 0),ot([sf.base.Property("day")],t.prototype,"durationUnit",void 0),ot([sf.base.Property(null)],t.prototype,"query",void 0),ot([sf.base.Property(null)],t.prototype,"dateFormat",void 0),ot([sf.base.Property("auto")],t.prototype,"height",void 0),ot([sf.base.Property(!1)],t.prototype,"renderBaseline",void 0),ot([sf.base.Property("Horizontal")],t.prototype,"gridLines",void 0),ot([sf.base.Complex({},Me)],t.prototype,"labelSettings",void 0),ot([sf.base.Property(null)],t.prototype,"taskbarTemplate",void 0),ot([sf.base.Property(null)],t.prototype,"parentTaskbarTemplate",void 0),ot([sf.base.Property(null)],t.prototype,"milestoneTemplate",void 0),ot([sf.base.Property()],t.prototype,"baselineColor",void 0),ot([sf.base.Property("auto")],t.prototype,"width",void 0),ot([sf.base.Property(!1)],t.prototype,"enableVirtualization",void 0),ot([sf.base.Property()],t.prototype,"toolbar",void 0),ot([sf.base.Property(["Monday","Tuesday","Wednesday","Thursday","Friday"])],t.prototype,"workWeek",void 0),ot([sf.base.Property(!1)],t.prototype,"includeWeekend",void 0),ot([sf.base.Property(!1)],t.prototype,"allowUnscheduledTasks",void 0),ot([sf.base.Property(!1)],t.prototype,"showInlineNotes",void 0),ot([sf.base.Property(36)],t.prototype,"rowHeight",void 0),ot([sf.base.Property(null)],t.prototype,"taskbarHeight",void 0),ot([sf.base.Property(null)],t.prototype,"projectStartDate",void 0),ot([sf.base.Property(null)],t.prototype,"projectEndDate",void 0),ot([sf.base.Property(null)],t.prototype,"resourceIDMapping",void 0),ot([sf.base.Property(null)],t.prototype,"resourceNameMapping",void 0),ot([sf.base.Property([])],t.prototype,"resources",void 0),ot([sf.base.Property([])],t.prototype,"segmentData",void 0),ot([sf.base.Property(null)],t.prototype,"connectorLineBackground",void 0),ot([sf.base.Property(1)],t.prototype,"connectorLineWidth",void 0),ot([sf.base.Property([])],t.prototype,"columns",void 0),ot([sf.base.Property([])],t.prototype,"addDialogFields",void 0),ot([sf.base.Property([])],t.prototype,"editDialogFields",void 0),ot([sf.base.Property(-1)],t.prototype,"selectedRowIndex",void 0),ot([sf.base.Property("hour")],t.prototype,"workUnit",void 0),ot([sf.base.Property("FixedUnit")],t.prototype,"taskType",void 0),ot([sf.base.Property("ProjectView")],t.prototype,"viewType",void 0),ot([sf.base.Collection([{from:8,to:12},{from:13,to:17}],se)],t.prototype,"dayWorkingTime",void 0),ot([sf.base.Collection([],Ce)],t.prototype,"holidays",void 0),ot([sf.base.Collection([],ye)],t.prototype,"eventMarkers",void 0),ot([sf.base.Complex({},Be)],t.prototype,"taskFields",void 0),ot([sf.base.Complex({},Je)],t.prototype,"resourceFields",void 0),ot([sf.base.Complex({},je)],t.prototype,"timelineSettings",void 0),ot([sf.base.Complex({},Ze)],t.prototype,"sortSettings",void 0),ot([sf.base.Complex({},fe)],t.prototype,"editSettings",void 0),ot([sf.base.Complex({},ze)],t.prototype,"tooltipSettings",void 0),ot([sf.base.Complex({},Ee)],t.prototype,"selectionSettings",void 0),ot([sf.base.Property(!1)],t.prototype,"allowFiltering",void 0),ot([sf.base.Property(!1)],t.prototype,"allowExcelExport",void 0),ot([sf.base.Property(!1)],t.prototype,"allowRowDragAndDrop",void 0),ot([sf.base.Property(!1)],t.prototype,"allowReordering",void 0),ot([sf.base.Property(!1)],t.prototype,"readOnly",void 0),ot([sf.base.Property(!1)],t.prototype,"allowResizing",void 0),ot([sf.base.Property(!1)],t.prototype,"enableContextMenu",void 0),ot([sf.base.Property()],t.prototype,"contextMenuItems",void 0),ot([sf.base.Property(!1)],t.prototype,"allowPdfExport",void 0),ot([sf.base.Property(!1)],t.prototype,"validateManualTasksOnLinking",void 0),ot([sf.base.Property(!1)],t.prototype,"enableMultiTaskbar",void 0),ot([sf.base.Property(!1)],t.prototype,"showOverAllocation",void 0),ot([sf.base.Property("Auto")],t.prototype,"taskMode",void 0),ot([sf.base.Complex({},De)],t.prototype,"filterSettings",void 0),ot([sf.base.Complex({},Te)],t.prototype,"searchSettings",void 0),ot([sf.base.Complex({},Ue)],t.prototype,"splitterSettings",void 0),ot([sf.base.Event()],t.prototype,"queryTaskbarInfo",void 0),ot([sf.base.Event()],t.prototype,"beforeExcelExport",void 0),ot([sf.base.Event()],t.prototype,"excelExportComplete",void 0),ot([sf.base.Event()],t.prototype,"excelQueryCellInfo",void 0),ot([sf.base.Event()],t.prototype,"excelHeaderQueryCellInfo",void 0),ot([sf.base.Event()],t.prototype,"rowDrag",void 0),ot([sf.base.Event()],t.prototype,"rowDragStart",void 0),ot([sf.base.Event()],t.prototype,"rowDragStartHelper",void 0),ot([sf.base.Event()],t.prototype,"rowDrop",void 0),ot([sf.base.Event()],t.prototype,"collapsing",void 0),ot([sf.base.Event()],t.prototype,"collapsed",void 0),ot([sf.base.Event()],t.prototype,"expanding",void 0),ot([sf.base.Event()],t.prototype,"expanded",void 0),ot([sf.base.Event()],t.prototype,"actionBegin",void 0),ot([sf.base.Event()],t.prototype,"actionComplete",void 0),ot([sf.base.Event()],t.prototype,"actionFailure",void 0),ot([sf.base.Event()],t.prototype,"taskbarEdited",void 0),ot([sf.base.Event()],t.prototype,"endEdit",void 0),ot([sf.base.Event()],t.prototype,"cellEdit",void 0),ot([sf.base.Event()],t.prototype,"load",void 0),ot([sf.base.Event()],t.prototype,"created",void 0),ot([sf.base.Event()],t.prototype,"destroyed",void 0),ot([sf.base.Event()],t.prototype,"taskbarEditing",void 0),ot([sf.base.Event()],t.prototype,"dataBound",void 0),ot([sf.base.Event()],t.prototype,"resizeStart",void 0),ot([sf.base.Event()],t.prototype,"resizing",void 0),ot([sf.base.Event()],t.prototype,"resizeStop",void 0),ot([sf.base.Event()],t.prototype,"splitterResizeStart",void 0),ot([sf.base.Event()],t.prototype,"splitterResizing",void 0),ot([sf.base.Event()],t.prototype,"splitterResized",void 0),ot([sf.base.Event()],t.prototype,"columnDragStart",void 0),ot([sf.base.Event()],t.prototype,"columnDrag",void 0),ot([sf.base.Event()],t.prototype,"columnDrop",void 0),ot([sf.base.Event()],t.prototype,"beforeTooltipRender",void 0),ot([sf.base.Event()],t.prototype,"rowSelecting",void 0),ot([sf.base.Event()],t.prototype,"rowSelected",void 0),ot([sf.base.Event()],t.prototype,"rowDeselecting",void 0),ot([sf.base.Event()],t.prototype,"rowDeselected",void 0),ot([sf.base.Event()],t.prototype,"cellSelecting",void 0),ot([sf.base.Event()],t.prototype,"cellSelected",void 0),ot([sf.base.Event()],t.prototype,"cellDeselecting",void 0),ot([sf.base.Event()],t.prototype,"cellDeselected",void 0),ot([sf.base.Event()],t.prototype,"queryCellInfo",void 0),ot([sf.base.Event()],t.prototype,"headerCellInfo",void 0),ot([sf.base.Event()],t.prototype,"rowDataBound",void 0),ot([sf.base.Event()],t.prototype,"columnMenuOpen",void 0),ot([sf.base.Event()],t.prototype,"toolbarClick",void 0),ot([sf.base.Event()],t.prototype,"columnMenuClick",void 0),ot([sf.base.Event()],t.prototype,"contextMenuOpen",void 0),ot([sf.base.Event()],t.prototype,"contextMenuClick",void 0),ot([sf.base.Event()],t.prototype,"onTaskbarClick",void 0),ot([sf.base.Event()],t.prototype,"recordDoubleClick",void 0),ot([sf.base.Event()],t.prototype,"onMouseMove",void 0),ot([sf.base.Event()],t.prototype,"beforePdfExport",void 0),ot([sf.base.Event()],t.prototype,"pdfExportComplete",void 0),ot([sf.base.Event()],t.prototype,"pdfQueryCellInfo",void 0),ot([sf.base.Event()],t.prototype,"pdfQueryTaskbarInfo",void 0),ot([sf.base.Event()],t.prototype,"pdfQueryTimelineCellInfo",void 0),ot([sf.base.Event()],t.prototype,"pdfColumnHeaderQueryCellInfo",void 0),t=ot([sf.base.NotifyPropertyChanges],t)}(sf.base.Component);(E=e.PdfHorizontalOverflowType||(e.PdfHorizontalOverflowType={}))[E.NextPage=0]="NextPage",E[E.LastPage=1]="LastPage";var lt,pt,ht,ct,ut=function(){function e(e){this.isCellEdit=!1,this.parent=e,this.bindTreeGridProperties()}return e.prototype.bindTreeGridProperties=function(){this.parent.treeGrid.editSettings.allowEditing=this.parent.editSettings.allowEditing,this.parent.treeGrid.editSettings.mode="Cell",this.parent.treeGrid.cellEdit=this.ensureEditCell.bind(this),this.parent.editSettings.allowEditing&&sf.treegrid.TreeGrid.Inject(sf.treegrid.Edit)},e.prototype.ensureEditCell=function(e){var t=this,i=e.rowData,r=e.columnName;this.editedColumn=this.parent.getColumnByField(r,this.parent.ganttColumns);var a=this.parent.taskFields;if(this.parent.readOnly)e.cancel=!0;else if("Dialog"!==this.parent.editSettings.mode){if(!i.hasChildRecords||r!==a.endDate&&r!==a.duration&&r!==a.dependency&&r!==a.progress&&r!==a.work&&"taskType"!==r){var s=new sf.data.Deferred;return this.parent.trigger("cellEdit",e,(function(e){sf.base.isBlazor()&&(e.cell=sf.base.getElement(e.cell),e.row=sf.base.getElement(e.row)),0===i.level&&"ResourceView"===t.parent.viewType&&(e.cancel=!0),s.resolve(e),e.cancel||(e.columnName===t.parent.taskFields.notes?t.openNotesEditor(e):(t.isCellEdit=!0,sf.base.isNullOrUndefined(t.parent.toolbarModule)||t.parent.toolbarModule.refreshToolbarItems()))})),s}e.cancel=!0}else e.cancel=!0},e.prototype.openNotesEditor=function(e){var t=this.parent.taskFields,i=e.rowData,r=e.columnName;if(r===t.notes&&!this.parent.showInlineNotes){e.cancel=!0;var a=this.parent.editModule.dialogModule.updatedEditFields.map((function(e){return e.type})).indexOf("Notes");if(-1!==a)this.parent.editModule.dialogModule.openEditDialog(i.ganttProperties.rowUniqueID),document.getElementById(this.parent.element.id+"_Tab").ej2_instances[0].selectedItem=a}r===t.notes&&!0===this.parent.showInlineNotes&&(this.isCellEdit=!0)},e.prototype.isValueChange=function(e,t){var i=sf.base.getValue("data",e),r=i[t],a=sf.base.getValue("previousData",e);if(sf.base.isNullOrUndefined(r)&&!sf.base.isNullOrUndefined(a)||!sf.base.isNullOrUndefined(r)&&sf.base.isNullOrUndefined(a))return!0;if(!sf.base.isNullOrUndefined(r)&&!sf.base.isNullOrUndefined(a)){if(r instanceof Date)return r.getTime()!==i.taskData[t].getTime();if(t===this.parent.taskFields.resourceInfo)return r!==a;if(r!==i.taskData[t])return!0}return!1},e.prototype.initiateCellEdit=function(e,t){var i=sf.base.getValue("column",e),r=sf.base.getValue("data",e),a={action:"CellEditing"};a.data=this.parent.getTaskByUniqueID(r.uniqueID);var s=sf.base.getValue("previousData",e),n=this.parent.allowUnscheduledTasks||!sf.base.isNullOrUndefined(r[i.field])&&""!==r[i.field]||this.parent.taskFields.duration!==i.field&&this.parent.taskFields.startDate!==i.field&&this.parent.taskFields.endDate!==i.field?r[i.field]:s;sf.base.isNullOrUndefined(r)?this.parent.editModule.endEditAction(e):(r[i.field]=s,a.data[i.field]=s,this.parent.initiateEditAction(!0),this.parent.setRecordValue(i.field,n,a.data),i.field===this.parent.taskFields.name?this.taskNameEdited(a):i.field===this.parent.taskFields.startDate?this.startDateEdited(a):i.field===this.parent.taskFields.endDate?this.endDateEdited(a):i.field===this.parent.taskFields.duration?this.durationEdited(a):i.field===this.parent.taskFields.resourceInfo?this.resourceEdited(a,t,r):i.field===this.parent.taskFields.progress?this.progressEdited(a):i.field===this.parent.taskFields.baselineStartDate||i.field===this.parent.taskFields.baselineEndDate?this.baselineEdited(a):i.field===this.parent.taskFields.dependency?this.dependencyEdited(a,s):i.field===this.parent.taskFields.notes?this.notedEdited(a):i.field===this.parent.taskFields.work?this.workEdited(a):"taskType"!==i.field||sf.base.isNullOrUndefined(this.parent.taskFields.work)?i.field===this.parent.taskFields.manual?this.taskmodeEdited(a):(this.parent.setRecordValue("taskData."+i.field,a.data[i.field],a.data),this.parent.editModule.initiateSaveAction(a)):this.typeEdited(a,t)),this.isCellEdit=!1,sf.base.isNullOrUndefined(this.parent.toolbarModule)||this.parent.toolbarModule.refreshToolbarItems()},e.prototype.taskNameEdited=function(e){this.parent.setRecordValue("taskData."+this.parent.taskFields.name,e.data[this.parent.taskFields.name],e.data),this.parent.setRecordValue("taskName",e.data[this.parent.taskFields.name],e.data.ganttProperties,!0),this.updateEditedRecord(e)},e.prototype.notedEdited=function(e){this.parent.setRecordValue("taskData."+this.parent.taskFields.notes,e.data[this.parent.taskFields.name],e.data),this.parent.setRecordValue("notes",e.data[this.parent.taskFields.notes],e.data.ganttProperties,!0),this.updateEditedRecord(e)},e.prototype.taskmodeEdited=function(e){this.parent.setRecordValue("isAutoSchedule",!e.data[this.parent.taskFields.manual],e.data.ganttProperties,!0),this.parent.editModule.updateTaskScheduleModes(e.data),this.updateEditedRecord(e)},e.prototype.startDateEdited=function(e){var t=e.data,i=e.data.ganttProperties,r=e.data[this.parent.taskFields.startDate];r=r?new Date(r.getTime()):null,r=this.parent.dateValidationModule.checkStartDate(r),sf.base.isNullOrUndefined(r)?t.hasChildRecords||(this.parent.setRecordValue("startDate",null,i,!0),this.parent.setRecordValue("duration",null,i,!0),this.parent.setRecordValue("isMilestone",!1,i,!0),this.parent.allowUnscheduledTasks&&sf.base.isNullOrUndefined(this.parent.taskFields.endDate)&&this.parent.setRecordValue("endDate",null,i,!0)):i.endDate||!sf.base.isNullOrUndefined(i.duration)?(this.parent.setRecordValue("startDate",new Date(r.getTime()),i,!0),this.parent.dateValidationModule.calculateEndDate(t)):sf.base.isNullOrUndefined(i.endDate)&&sf.base.isNullOrUndefined(i.duration)&&this.parent.setRecordValue("startDate",new Date(r.getTime()),i,!0),this.parent.setRecordValue("isMilestone",0===i.duration,i,!0),this.parent.dataOperation.updateWidthLeft(e.data),this.parent.dataOperation.updateMappingData(t,"startDate"),this.parent.dataOperation.updateMappingData(t,"endDate"),this.parent.dataOperation.updateMappingData(t,"duration"),this.updateEditedRecord(e)},e.prototype.validateEndDateWithSegments=function(e){for(var t=[],i=e.segments,r=0;r<i.length;r++){var a=i[r],s=a.endDate;s=!sf.base.isNullOrUndefined(e.endDate)&&s.getTime()<e.endDate.getTime()&&r!==i.length-1?s:e.endDate,a.duration=this.parent.dataOperation.getDuration(a.startDate,s,e.durationUnit,e.isAutoSchedule,e.isMilestone),i.length>0&&s.getTime()<a.startDate.getTime()&&s.getTime()<=e.endDate.getTime()?i[r-1].duration=this.parent.dataOperation.getDuration(i[r-1].startDate,e.endDate,e.durationUnit,e.isAutoSchedule,e.isMilestone):t.push(a)}return t},e.prototype.endDateEdited=function(e){var t=e.data.ganttProperties,i=e.data[this.parent.taskFields.endDate];i=i?new Date(i.getTime()):null,sf.base.isNullOrUndefined(i)?(this.parent.setRecordValue("endDate",i,t,!0),this.parent.setRecordValue("duration",null,t,!0),this.parent.setRecordValue("isMilestone",!1,t,!0)):(0===i.getHours()&&86400!==this.parent.defaultEndTime&&this.parent.dateValidationModule.setTime(this.parent.defaultEndTime,i),i=this.parent.dateValidationModule.checkEndDate(i,t),this.parent.setRecordValue("endDate",i,t,!0),!sf.base.isNullOrUndefined(t.startDate)&&sf.base.isNullOrUndefined(t.duration)?-1===this.parent.dateValidationModule.compareDates(t.endDate,t.startDate)&&(this.parent.setRecordValue("endDate",new Date(t.startDate.getTime()),t,!0),this.parent.dateValidationModule.setTime(this.parent.defaultEndTime,t.endDate)):!sf.base.isNullOrUndefined(t.duration)&&sf.base.isNullOrUndefined(t.startDate)&&this.parent.setRecordValue("startDate",this.parent.dateValidationModule.getStartDate(t.endDate,t.duration,t.durationUnit,t),t,!0),sf.base.isNullOrUndefined(t.segments)||(t.segments=this.validateEndDateWithSegments(t)),-1===this.compareDatesFromRecord(t)?this.parent.dateValidationModule.calculateDuration(e.data):this.parent.editModule.revertCellEdit(e),this.parent.setRecordValue("isMilestone",0===t.duration,t,!0),t.isMilestone&&this.parent.setRecordValue("startDate",this.parent.dateValidationModule.checkStartDate(t.startDate,t),t,!0)),!sf.base.isNullOrUndefined(e.data.ganttProperties.segments)&&e.data.ganttProperties.segments.length>0&&(this.parent.setRecordValue("segments",this.parent.dataOperation.setSegmentsInfo(e.data,!1),e.data.ganttProperties,!0),this.parent.dataOperation.updateMappingData(e.data,"segments")),this.parent.dataOperation.updateWidthLeft(e.data),this.parent.dataOperation.updateMappingData(e.data,"startDate"),this.parent.dataOperation.updateMappingData(e.data,"endDate"),this.parent.dataOperation.updateMappingData(e.data,"duration"),this.parent.editModule.updateResourceRelatedFields(e.data,"endDate"),this.updateEditedRecord(e)},e.prototype.durationEdited=function(e){var t=e.data.ganttProperties,i=e.data[this.parent.taskFields.duration];this.parent.dataOperation.updateDurationValue(i,t),this.updateDates(e),this.parent.editModule.updateResourceRelatedFields(e.data,"duration"),this.updateEditedRecord(e)},e.prototype.updateDates=function(e){var t=e.data.ganttProperties,i=this.parent.dateValidationModule.getDateFromFormat(t.endDate),r=this.parent.dateValidationModule.getDateFromFormat(t.startDate),a=t.duration;sf.base.isNullOrUndefined(a)?(this.parent.setRecordValue("isMilestone",!1,t,!0),this.parent.setRecordValue("endDate",null,t,!0)):(sf.base.isNullOrUndefined(r)&&!sf.base.isNullOrUndefined(i)&&this.parent.setRecordValue("startDate",this.parent.dateValidationModule.getStartDate(i,a,t.durationUnit,t),t,!0),0!==a&&t.isMilestone&&(this.parent.setRecordValue("isMilestone",!1,t,!0),this.parent.setRecordValue("startDate",this.parent.dateValidationModule.checkStartDate(t.startDate,t),t,!0)),!sf.base.isNullOrUndefined(t.segments)&&t.segments.length>0&&(this.parent.setRecordValue("segments",this.parent.dataOperation.setSegmentsInfo(e.data,!1),t,!0),this.parent.dataOperation.updateMappingData(e.data,"segments")),this.parent.setRecordValue("isMilestone",0===t.duration,t,!0),this.parent.dateValidationModule.calculateEndDate(e.data)),this.parent.dataOperation.updateWidthLeft(e.data),this.parent.dataOperation.updateMappingData(e.data,"endDate"),this.parent.dataOperation.updateMappingData(e.data,"startDate"),this.parent.dataOperation.updateMappingData(e.data,"duration")},e.prototype.progressEdited=function(e){var t=e.data;if(this.parent.setRecordValue("progress",t[this.parent.taskFields.progress]>100?100:t[this.parent.taskFields.progress],t.ganttProperties,!0),this.parent.setRecordValue("taskData."+this.parent.taskFields.progress,t[this.parent.taskFields.progress]>100?100:t[this.parent.taskFields.progress],e.data),!sf.base.isNullOrUndefined(e.data.ganttProperties.segments)&&e.data.ganttProperties.segments.length>0&&this.parent.editModule.taskbarEditModule.updateSegmentProgress(e.data.ganttProperties),!e.data.hasChildRecords){var i=t.ganttProperties.isAutoSchedule?t.ganttProperties.width:t.ganttProperties.autoWidth;this.parent.setRecordValue("progressWidth",this.parent.dataOperation.getProgressWidth(i,t.ganttProperties.progress),t.ganttProperties,!0)}this.updateEditedRecord(e)},e.prototype.baselineEdited=function(e){var t=e.data.ganttProperties,i=e.data[this.parent.taskFields.baselineStartDate],r=e.data[this.parent.taskFields.baselineEndDate];r&&0===r.getHours()&&86400!==this.parent.defaultEndTime&&this.parent.dateValidationModule.setTime(this.parent.defaultEndTime,r),this.parent.setRecordValue("baselineStartDate",this.parent.dateValidationModule.checkBaselineStartDate(i),t,!0),this.parent.setRecordValue("baselineEndDate",this.parent.dateValidationModule.checkBaselineEndDate(r),t,!0),t.baselineStartDate&&t.baselineEndDate&&(this.parent.setRecordValue("baselineLeft",this.parent.dataOperation.calculateBaselineLeft(t),t,!0),this.parent.setRecordValue("baselineWidth",this.parent.dataOperation.calculateBaselineWidth(t),t,!0)),this.updateEditedRecord(e)},e.prototype.resourceEdited=function(e,t,i){var r=this.parent.resourceFields,a=t[this.parent.taskFields.resourceInfo];if(a){for(var s=this.parent.dataOperation.setResourceInfo(t).length,n=i.ganttProperties.resourceInfo,o=void 0,d=[],l=this.parent.resources,p=void 0,h=function(e){if(n){var t=n.length;for(p=0;p<t;p++){if(n[p][r.id]===a[e]){o=p;break}o=-1}}if(sf.base.isNullOrUndefined(o)||-1===o){var i=l.filter((function(t){return a[e]===t[r.id]})),s=sf.base.extend({},i[0]);s[r.unit]=100,d.push(s)}else d.push(n[o])},c=0;c<s;c++)h(c);e.data.ganttProperties.resourceInfo=d,this.parent.dataOperation.updateMappingData(e.data,"resourceInfo"),this.parent.editModule.updateResourceRelatedFields(e.data,"resource"),"ResourceView"===this.parent.viewType&&(this.parent.editModule.dialogModule.isResourceUpdate=!0,this.parent.editModule.dialogModule.previousResource=n),this.updateEditedRecord(e)}},e.prototype.dependencyEdited=function(e,t){this.parent.predecessorModule.updateUnscheduledDependency(e.data),this.parent.connectorLineEditModule.updatePredecessor(e.data,e.data[this.parent.taskFields.dependency],e)||this.parent.editModule.revertCellEdit(t)},e.prototype.workEdited=function(e){var t=e.data.ganttProperties,i=e.data[this.parent.taskFields.work];this.parent.setRecordValue("work",i,t,!0),this.parent.editModule.updateResourceRelatedFields(e.data,"work"),this.updateDates(e),this.updateEditedRecord(e)},e.prototype.typeEdited=function(e,t){var i=e.data.ganttProperties,r=t.taskType;this.parent.setRecordValue("taskType",r,i,!0),this.updateEditedRecord(e)},e.prototype.compareDatesFromRecord=function(e){var t=this.parent.dateValidationModule.getValidStartDate(e),i=this.parent.dateValidationModule.getValidEndDate(e);return this.parent.dateValidationModule.compareDates(t,i)},e.prototype.updateEditedRecord=function(e){this.parent.editModule.initiateUpdateAction(e)},e.prototype.destroy=function(){this.parent.editModule.cellEditModule=void 0},e}(),ft=function(){function e(e,t){this.parent=e,this.taskbarEdit=t}return e.prototype.createTooltip=function(e,t,i){var r=this;this.toolTipObj=new sf.popups.Tooltip({opensOn:e,position:"TopRight",mouseTrail:t,cssClass:"e-gantt-tooltip",target:i||null,animation:{open:{effect:"None"},close:{effect:"None"}}}),this.toolTipObj.beforeRender=function(e){var t={data:r.taskbarEdit.taskBarEditRecord,args:e,content:r.toolTipObj.content};r.parent.trigger("beforeTooltipRender",t)},this.toolTipObj.afterOpen=function(e){r.updateTooltipPosition(e)},this.toolTipObj.isStringTemplate=!0,this.toolTipObj.appendTo(this.parent.chartPane)},e.prototype.updateTooltipPosition=function(e){var t=this.parent.getOffsetRect(this.parent.chartPane).left+this.parent.chartPane.offsetWidth,i=e.element.offsetLeft;t<i+e.element.offsetWidth&&(i+=t-(i+e.element.offsetWidth)),e.element.style.left=i+"px"},e.prototype.showHideTaskbarEditTooltip=function(e,t){e&&this.parent.tooltipSettings.showTooltip?(this.createTooltip("Custom",!1),this.parent.tooltipModule.toolTipObj.close(),this.updateTooltip(t),"ConnectorPointLeftDrag"===this.taskbarEdit.connectorSecondAction?this.toolTipObj.open(this.taskbarEdit.connectorSecondElement.querySelector("."+Y)):"ConnectorPointRightDrag"===this.taskbarEdit.connectorSecondAction?this.toolTipObj.open(this.taskbarEdit.connectorSecondElement.querySelector(".e-connectorpoint-right")):this.toolTipObj.open(this.taskbarEdit.taskBarEditElement)):sf.base.isNullOrUndefined(this.toolTipObj)||(this.toolTipObj.destroy(),this.toolTipObj=null)},e.prototype.updateTooltip=function(e){var t=this.taskbarEdit.taskBarEditRecord.ganttProperties,i=-1===e?t.width:t.segments[e].width,r=-1===e?t.progressWidth:t.segments[e].progressWidth,a=-1===e?t.left:t.left+t.segments[e].left;sf.base.isNullOrUndefined(this.toolTipObj)||("ConnectorPointLeftDrag"===this.taskbarEdit.taskBarEditAction||"ConnectorPointRightDrag"===this.taskbarEdit.taskBarEditAction?(this.toolTipObj.content=this.getTooltipText(e),this.toolTipObj.offsetY=-3):(this.toolTipObj.content=this.getTooltipText(e),this.toolTipObj.refresh(this.taskbarEdit.taskBarEditElement),"LeftResizing"===this.taskbarEdit.taskBarEditAction?this.toolTipObj.offsetX=-i:"RightResizing"===this.taskbarEdit.taskBarEditAction||"ParentResizing"===this.taskbarEdit.taskBarEditAction?this.toolTipObj.offsetX=0:"ProgressResizing"===this.taskbarEdit.taskBarEditAction?this.toolTipObj.offsetX=-(i-r):"MilestoneDrag"===this.taskbarEdit.taskBarEditAction?this.toolTipObj.offsetX=-this.parent.chartRowsModule.milestoneHeight/2:i>5&&(this.toolTipObj.offsetX=-(i+a-this.taskbarEdit.tooltipPositionX))))},e.prototype.getTooltipText=function(e){var t="",i=this.parent.globalize,r=this.taskbarEdit.taskBarEditRecord.ganttProperties;if(!sf.base.isNullOrUndefined(r.segments)&&r.segments.length>0&&-1!==e&&"ProgressResizing"!==this.taskbarEdit.taskBarEditAction&&(r=r.segments[e]),this.parent.tooltipSettings.editing){var a=this.parent.tooltipModule.templateCompiler(this.parent.tooltipSettings.editing,this.parent,this.taskbarEdit.taskBarEditRecord,"TooltipEditingTemplate");sf.base.getValue("tooltipEle",this.toolTipObj)&&this.parent.renderTemplates(),t=a[0]}else switch(this.taskbarEdit.taskBarEditAction){case"ProgressResizing":t=this.parent.localeObj.getConstant("progress")+" : "+r.progress;break;case"LeftResizing":t=this.parent.localeObj.getConstant("startDate")+" : ",t+=i.formatDate(r.startDate,{format:this.parent.getDateFormat()}),t+="<br/>"+this.parent.localeObj.getConstant("duration")+" : "+this.parent.getDurationString(r.duration,r.durationUnit);break;case"RightResizing":case"ParentResizing":t=this.parent.localeObj.getConstant("endDate")+" : ",t+=i.formatDate(r.endDate,{format:this.parent.getDateFormat()}),t+="<br/>"+this.parent.localeObj.getConstant("duration")+" : "+this.parent.getDurationString(r.duration,r.durationUnit);break;case"ChildDrag":case"ParentDrag":case"MilestoneDrag":case"ManualParentDrag":sf.base.isNullOrUndefined(this.taskbarEdit.taskBarEditRecord.ganttProperties.startDate)||(t=this.parent.localeObj.getConstant("startDate")+" : ",t+=i.formatDate(r.startDate,{format:this.parent.getDateFormat()})),sf.base.isNullOrUndefined(this.taskbarEdit.taskBarEditRecord.ganttProperties.endDate)||(t+=""===t?"":"<br/>",t+=this.parent.localeObj.getConstant("endDate")+" : "+i.formatDate(r.endDate,{format:this.parent.getDateFormat()}));break;case"ConnectorPointLeftDrag":case"ConnectorPointRightDrag":t=this.parent.connectorLineModule.tooltipTable,sf.base.isNullOrUndefined(this.toolTipObj)&&(this.parent.connectorLineModule.tooltipTable.innerHTML=this.parent.connectorLineModule.getConnectorLineTooltipInnerTd(this.parent.editModule.taskbarEditModule.taskBarEditRecord.ganttProperties.taskName,this.parent.editModule.taskbarEditModule.fromPredecessorText,"",""))}return t},e}(),gt=(lt=function(e,t){return(lt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}lt(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),mt=function(){return(mt=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var a in t=arguments[i])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},yt=function(e){function i(t){var i=e.call(this,t)||this;return i.isMouseDragged=!1,i.dependencyCancel=!1,i.editElement=null,i.elementOffsetLeft=0,i.elementOffsetTop=0,i.elementOffsetWidth=0,i.elementOffsetHeight=0,i.segmentIndex=-1,i.parent=t,i.initPublicProp(),i.wireEvents(),i.editTooltip=new ft(i.parent,i),i}return gt(i,e),i.prototype.wireEvents=function(){this.parent.on("chartMouseDown",this.mouseDownHandler,this),this.parent.on("chartMouseUp",this.mouseUpHandler,this),this.parent.on("chartMouseLeave",this.mouseLeaveHandler,this),this.parent.on("chartMouseMove",this.mouseMoveAction,this),this.parent.on("chartMouseClick",this.mouseClickHandler,this)},i.prototype.initPublicProp=function(){this.taskBarEditElement=null,this.taskBarEditRecord=null,this.taskBarEditAction=null,this.connectorSecondElement=null,this.connectorSecondRecord=null,this.connectorSecondAction=null,this.highlightedSecondElement=null,this.fromPredecessorText=null,this.toPredecessorText=null,this.finalPredecessor=null,this.drawPredecessor=!1,this.roundOffDuration=!0,this.dragMouseLeave=!1,this.isMouseDragged=!1,this.previousItemProperty=["left","progress","duration","isMilestone","startDate","endDate","width","progressWidth","autoLeft","autoDuration","autoStartDate","autoEndDate","autoWidth"],this.tapPointOnFocus=!1,this.touchEdit=!1},i.prototype.mouseDownHandler=function(e){if(this.parent.editSettings.allowTaskbarEditing&&!this.parent.readOnly)if(this.canDrag=!1,this.parent.isAdaptive&&this.taskBarEditElement){var i=this.getElementByPosition(e),r=t(i,A);!r||r.innerHTML!==this.taskBarEditElement.innerHTML||i.classList.contains(Y)||i.classList.contains("e-connectorpoint-right")||this.tapPointOnFocus||(this.updateTaskBarEditElement(e),this.canDrag=!0,e.preventDefault())}else this.parent.isAdaptive||this.updateTaskBarEditElement(e)},i.prototype.mouseClickHandler=function(e){var i=this.getElementByPosition(e),r=t(i,A);this.parent.selectionModule&&this.parent.selectionModule.enableSelectMultiTouch?this.tapPointOnFocus&&this.updateTaskBarEditElement(e):this.tapPointOnFocus&&r&&r.innerHTML!==this.taskBarEditElement.innerHTML?(this.connectorSecondRecord=this.parent.ganttChartModule.getRecordByTaskBar(r),this.connectorSecondAction="ConnectorPointLeftDrag",this.connectorSecondElement=r,this.fromPredecessorText="Finish",this.validateConnectorPoint()&&this.taskBarEditingAction(e,!0),this.showHideActivePredecessors(!1),this.initPublicProp()):i.classList.contains("e-connectorpoint-left-hover")||i.classList.contains("e-connectorpoint-right-hover")?(this.canDrag=!1,this.multipleSelectionEnabled(),this.showHideTaskBarEditingElements(i,this.taskBarEditElement),this.tapPointOnFocus=!0,this.taskBarEditAction="ConnectorPointRightDrag",this.connectorSecondRecord=this.taskBarEditRecord,this.taskBarEditingAction(e,!1)):(this.tapPointOnFocus&&(this.showHideActivePredecessors(!1),this.showHideTaskBarEditingElements(r,this.taskBarEditElement)),this.updateTaskBarEditElement(e))},i.prototype.showHideActivePredecessors=function(e){var t=this.taskBarEditRecord.ganttProperties,i=t.predecessor,r="ResourceView"===this.parent.viewType?t.taskId:t.rowUniqueID;if(i)for(var a=0;a<i.length;a++){var s=i[a];r.toString()!==s.from&&r.toString()!==s.to||this.applyActiveColor(s.from,s.to,e)}var n=this.parent.ganttChartModule.chartBodyContainer;e?(sf.base.addClass([this.taskBarEditElement],["e-active-child-task"]),sf.base.addClass([n],["e-predecessor-touch-mode"])):(sf.base.removeClass([this.taskBarEditElement],["e-active-child-task"]),sf.base.removeClass([n],["e-predecessor-touch-mode"])),this.touchEdit=e,sf.base.isNullOrUndefined(this.parent.toolbarModule)||this.parent.toolbarModule.refreshToolbarItems()},i.prototype.applyActiveColor=function(e,t,i){var r=("ProjectView"===this.parent.viewType?this.taskBarEditRecord.ganttProperties.taskId.toString():this.taskBarEditRecord.ganttProperties.rowUniqueID.toString())===e?this.parent.connectorLineModule.getRecordByID(t):this.parent.connectorLineModule.getRecordByID(e),a=this.parent.ganttChartModule.getChartRows()[this.parent.currentViewData.indexOf(r)];if(!sf.base.isNullOrUndefined(a)){var s=a.querySelector("."+A),n=this.parent.element.querySelector("#ConnectorLineparent"+e+"child"+t);i?(sf.base.addClass([s],["e-active-connected-task"]),n&&sf.base.addClass([n],["e-active-connected-task"])):(sf.base.removeClass([s],["e-active-connected-task"]),n&&sf.base.removeClass([n],["e-active-connected-task"]))}},i.prototype.validateConnectorPoint=function(){var e=this.taskBarEditRecord.ganttProperties,t=this.connectorSecondRecord.ganttProperties,i=!0,r="ResourceView"===this.parent.viewType?e.taskId:e.rowUniqueID,a="ResourceView"===this.parent.viewType?t.taskId:t.rowUniqueID;if(this.connectorSecondRecord.hasChildRecords)i=!1;else if(t.predecessor)for(var s=0;s<t.predecessor.length;s++){var n=t.predecessor[s];if(n.from===r.toString()&&n.to===a.toString()){this.parent.connectorLineEditModule.childRecord=this.connectorSecondRecord,this.parent.connectorLineEditModule.predecessorIndex=s,this.parent.connectorLineEditModule.renderPredecessorDeleteConfirmDialog(),i=!1;break}if(n.from===a.toString()&&n.to===r.toString()){this.parent.connectorLineEditModule.childRecord=this.taskBarEditRecord,this.parent.connectorLineEditModule.predecessorIndex=s,this.parent.connectorLineEditModule.renderPredecessorDeleteConfirmDialog(),i=!1;break}}return i},i.prototype.mouseLeaveHandler=function(e){this.dragMouseLeave=!0},i.prototype.updateTaskBarEditElement=function(e){var i,r=this.getElementByPosition(e);if(r.classList.contains("e-gantt-manualparenttaskbar-right")||r.classList.contains("e-manualparent-main-container")||r.classList.contains(_))i=t(r,"e-manualparent-main-container");else if(r.classList.contains("e-manualparent-milestone-top")||r.classList.contains("e-manualparent-milestone-bottom")||r.classList.contains("e-gantt-manualparent-milestone"))i=t(r,"e-gantt-manualparent-milestone");else if(i=t(r,A),!sf.base.isNullOrUndefined(i)&&!r.classList.contains("e-connectorpoint-left")&&!r.classList.contains("e-connectorpoint-right")){var a=this.parent.ganttChartModule.getRecordByTaskBar(i);!sf.base.isNullOrUndefined(a.ganttProperties.segments)&&a.ganttProperties.segments.length>0&&(i=t(r,"e-gantt-child-taskbar-inner-div"))}if(this.parent.editSettings.allowTaskbarEditing&&i){this.showHideTaskBarEditingElements(i,this.taskBarEditElement),this.editElement=i,this.taskBarEditElement=i;var s=this.taskBarEditElement.getAttribute("data-segment-index");if(sf.base.isNullOrUndefined(s)?this.segmentIndex=-1:this.segmentIndex=Number(s),this.taskBarEditRecord=this.parent.ganttChartModule.getRecordByTaskBar(this.taskBarEditElement),("mousedown"===e.type||"touchstart"===e.type||"click"===e.type)&&(this.roundOffDuration=!0,this.taskBarEditAction=this.getTaskBarAction(e),"ConnectorPointLeftDrag"!==this.taskBarEditAction&&"ConnectorPointRightDrag"!==this.taskBarEditAction||!sf.base.isNullOrUndefined(this.parent.taskFields.dependency)||(this.taskBarEditAction=null),this.updateMouseDownProperties(e),"ResourceView"===this.parent.viewType)){if(0===this.taskBarEditRecord.level)return;if(this.parent.enableMultiTaskbar){var n=this.parent.getTaskByUniqueID(this.taskBarEditRecord.parentItem.uniqueID);sf.base.isNullOrUndefined(n)||n.expanded||(this.prevZIndex=this.taskBarEditElement.style.zIndex,this.taskBarEditElement.style.zIndex="1000",sf.base.addClass([this.taskBarEditElement.querySelector(".e-gantt-child-taskbar")],"e-collapsed-taskbar-drag"))}}}else this.parent.isAdaptive?(this.taskBarEditElement&&this.showHideTaskBarEditingElements(i,this.taskBarEditElement),this.initPublicProp()):this.showHideTaskBarEditingElements(i,this.taskBarEditElement)},i.prototype.showHideTaskBarEditingElements=function(e,t,i){t=t||this.editElement;var r=!0;if(!this.parent.readOnly){if("ResourceView"===this.parent.viewType&&this.parent.enableMultiTaskbar&&e){var a=this.parent.ganttChartModule.getRecordByTaskBar(e),s=this.parent.getParentTask(a.parentItem);sf.base.isNullOrUndefined(s)||s.expanded||(r=!1)}if(e){if(e.querySelector(".e-taskbar-left-resizer")){if(sf.base.addClass([e.querySelector(".e-taskbar-left-resizer")],["e-left-resize-gripper"]),sf.base.addClass([e.querySelector(".e-taskbar-right-resizer")],["e-right-resize-gripper"]),r)!sf.base.isNullOrUndefined(e.querySelector("."+q))&&sf.base.addClass([e.querySelector("."+q)],["e-progress-resize-gripper"])}else if(this.parent.isAdaptive&&r){(a=this.parent.ganttChartModule.getRecordByTaskBar(e)).hasChildRecords&&sf.base.addClass([e],["e-active-parent-task"])}if(r&&sf.base.addClass(this.parent.ganttChartModule.scrollElement.querySelectorAll(".e-connector-line-container"),["e-connector-line-z-index"]),!sf.base.isNullOrUndefined(this.parent.taskFields.dependency)&&(e.querySelector("."+Y)||e.parentElement.querySelector("."+Y))&&r){var n=sf.base.isNullOrUndefined(e.querySelector("."+Y))?e.parentElement:e;sf.base.addClass([n.querySelector("."+Y)],["e-connectorpoint-left-hover"]),sf.base.addClass([n.querySelector(".e-connectorpoint-right")],["e-connectorpoint-right-hover"])}}else i||sf.base.removeClass(this.parent.ganttChartModule.scrollElement.querySelectorAll(".e-connector-line-container"),["e-connector-line-z-index"]);if(t&&e!==t){if(t.querySelector(".e-taskbar-left-resizer")&&(sf.base.removeClass([t.querySelector(".e-taskbar-left-resizer")],["e-left-resize-gripper"]),sf.base.removeClass([t.querySelector(".e-taskbar-right-resizer")],["e-right-resize-gripper"]),t.querySelector("."+q)&&sf.base.removeClass([t.querySelector("."+q)],["e-progress-resize-gripper"])),sf.base.isNullOrUndefined(this.parent.taskFields.dependency)||!t.querySelector("."+Y)&&!t.parentElement.querySelector("."+Y)){if(this.parent.isAdaptive){(a=this.parent.ganttChartModule.getRecordByTaskBar(t))&&a.hasChildRecords&&sf.base.removeClass([t],["e-active-parent-task"])}}else{n=sf.base.isNullOrUndefined(t.querySelector("."+Y))?t.parentElement:t;sf.base.removeClass([n.querySelector("."+Y)],["e-connectorpoint-left-hover"]),sf.base.removeClass([n.querySelector(".e-connectorpoint-right")],["e-connectorpoint-right-hover"])}this.editElement=null}}},i.prototype.getTaskBarAction=function(e){var t=this.getElementByPosition(e),i=this.taskBarEditRecord,r="";return t.classList.contains("e-taskbar-left-resizer")?r="LeftResizing":t.classList.contains("e-taskbar-right-resizer")?r="RightResizing":t.classList.contains(q)||sf.base.closest(t,"."+q)?r="ProgressResizing":t.classList.contains(Y)?r="ConnectorPointLeftDrag":t.classList.contains("e-connectorpoint-right")?r="ConnectorPointRightDrag":t.classList.contains("e-gantt-manualparenttaskbar-right")?r="ParentResizing":t.classList.contains(_)||t.classList.contains("e-manualparent-main-container")||t.classList.contains("e-gantt-manualparent-milestone")||t.classList.contains("e-manualparent-milestone-top")||t.classList.contains("e-manualparent-milestone-bottom")||t.classList.contains("e-gantt-manualparent-milestone")?r="ManualParentDrag":i&&(r=i.hasChildRecords?"Auto"===this.parent.taskMode?"ParentDrag":"":i.ganttProperties.isMilestone?"MilestoneDrag":"ChildDrag"),r},i.prototype.updateMouseDownProperties=function(e){var t=this.getCoordinate(e);if(t.pageX||t.pageY){var i=this.parent.getOffsetRect(this.parent.ganttChartModule.chartBodyContainer);this.mouseDownX=t.pageX-i.left+this.parent.ganttChartModule.scrollObject.previousScroll.left,this.tooltipPositionX=this.mouseDownX,this.mouseDownY=t.pageY-i.top+this.parent.ganttChartModule.scrollObject.previousScroll.top}"ConnectorPointLeftDrag"!==this.taskBarEditAction&&"ConnectorPointRightDrag"!==this.taskBarEditAction||(this.fromPredecessorText="ConnectorPointLeftDrag"===this.taskBarEditAction?"start":"finish",this.parent.connectorLineModule.tooltipTable.innerHTML=this.parent.connectorLineModule.getConnectorLineTooltipInnerTd(this.taskBarEditRecord.ganttProperties.taskName,this.fromPredecessorText,"",""))},i.prototype.isMouseDragCheck=function(){if(!this.isMouseDragged&&this.taskBarEditAction&&(this.mouseDownX!==this.mouseMoveX&&(this.mouseDownX+3<this.mouseMoveX||this.mouseDownX-3>this.mouseMoveX)||this.mouseDownY!==this.mouseMoveY&&(this.mouseDownY+3<this.mouseMoveY||this.mouseDownY-3>this.mouseMoveY))){this.isMouseDragged=!0,this.parent.initiateEditAction(!0);var e=this.taskBarEditRecord.ganttProperties;this.previousItem=this.parent.timelineModule.extendFunction(e,this.previousItemProperty),"ConnectorPointLeftDrag"!==this.taskBarEditAction&&"ConnectorPointRightDrag"!==this.taskBarEditAction&&this.editTooltip.showHideTaskbarEditTooltip(!0,this.segmentIndex),this.taskBarEditElement.setAttribute("aria-grabbed","true")}},i.prototype.mouseMoveAction=function(e){if(this.parent.isAdaptive){if(!this.canDrag)return;this.multipleSelectionEnabled()}var t=this.parent.getOffsetRect(this.parent.ganttChartModule.chartBodyContainer),i=this.getCoordinate(e);this.mouseMoveX=i.pageX-t.left+this.parent.ganttChartModule.scrollObject.previousScroll.left,this.mouseMoveY=i.pageY-t.top+this.parent.ganttChartModule.scrollObject.previousScroll.top,this.dragMouseLeave=!1,this.isMouseDragCheck(),this.isMouseDragged&&this.taskBarEditAction?this.taskBarEditingAction(e,!1):this.parent.isAdaptive||this.taskBarEditAction||this.updateTaskBarEditElement(e)},i.prototype.taskBarEditingAction=function(e,t){var i=this,r={},a=this.parent.ganttChartModule.getIndexByTaskBar(this.taskBarEditElement);if(null!==this.taskBarEditRecord){if(r.editingFields=this.taskBarEditRecord.ganttProperties,r.data=this.taskBarEditRecord,"ResourceView"===this.parent.viewType&&0===r.data.level)return;r.recordIndex=a,r.taskBarEditAction=this.taskBarEditAction,r.roundOffDuration=this.roundOffDuration,r.cancel=!1,r.previousData=this.previousItem,this.roundOffDuration=r.roundOffDuration,this.targetElement=r.target=sf.base.closest(e.target,".e-gantt-child-taskbar"),this.updateMouseMoveProperties(e),"ProgressResizing"===this.taskBarEditAction?this.performProgressResize(e):"LeftResizing"===this.taskBarEditAction?this.enableLeftResizing(e):"RightResizing"===this.taskBarEditAction||"ParentResizing"===this.taskBarEditAction?this.enableRightResizing(e):"ParentDrag"===this.taskBarEditAction||"ChildDrag"===this.taskBarEditAction||"MilestoneDrag"===this.taskBarEditAction||"ManualParentDrag"===this.taskBarEditAction?this.enableDragging(e):"ConnectorPointLeftDrag"!==this.taskBarEditAction&&"ConnectorPointRightDrag"!==this.taskBarEditAction||(this.updateConnectorLineSecondProperties(e),this.triggerDependencyEvent(e),this.parent.isAdaptive||this.drawFalseLine()),this.setItemPosition(),this.updateEditedItem(),this.editTooltip.updateTooltip(this.segmentIndex),t&&this.taskBarEditedAction(e),this.parent.trigger("taskbarEditing",r,(function(e){e.cancel&&null!==i.taskBarEditRecord&&(i.tapPointOnFocus=!1,sf.base.merge(i.taskBarEditRecord.ganttProperties,e.previousData))}))}},i.prototype.updateMouseMoveProperties=function(e){var t=this.parent.getOffsetRect(this.parent.ganttChartModule.chartBodyContainer),i=this.getCoordinate(e);(i.pageX||i.pageY)&&(this.mouseMoveX=i.pageX-t.left+this.parent.ganttChartModule.scrollObject.previousScroll.left,this.tooltipPositionX=this.mouseMoveX,this.mouseMoveY=i.pageY-t.top+this.parent.ganttChartModule.scrollObject.previousScroll.top);var r="ConnectorPointLeftDrag"===this.taskBarEditAction||"ConnectorPointRightDrag"===this.taskBarEditAction;if(this.taskBarEditRecord.ganttProperties.width>3&&("ProgressResizing"!==this.taskBarEditAction||0!==this.taskBarEditRecord.ganttProperties.progress&&100!==this.taskBarEditRecord.ganttProperties.progress)||r){var a=this.mouseMoveX-this.parent.ganttChartModule.scrollObject.previousScroll.left+t.left,s=this.mouseMoveY-this.parent.ganttChartModule.scrollObject.previousScroll.top+t.top;a+20>t.left+this.parent.ganttChartModule.chartBodyContainer.offsetWidth?(this.timerCount=this.parent.ganttChartModule.scrollObject.previousScroll.left,this.startScrollTimer("right")):a-20<t.left?(this.timerCount=this.parent.ganttChartModule.scrollObject.previousScroll.left,this.startScrollTimer("left")):r&&s+20>t.top+this.parent.ganttChartModule.chartBodyContainer.offsetHeight?(this.timerCount=this.parent.ganttChartModule.scrollObject.previousScroll.top,this.startScrollTimer("bottom")):r&&s-20<t.top?(this.timerCount=this.parent.ganttChartModule.scrollObject.previousScroll.top,this.startScrollTimer("top")):this.stopScrollTimer()}else this.stopScrollTimer()},i.prototype.startScrollTimer=function(e){var t=this;this.stopScrollTimer(),this.scrollTimer=window.setInterval((function(){t.timerCount="right"===e||"bottom"===e?t.timerCount+1>=t.parent.timelineModule.totalTimelineWidth?t.parent.timelineModule.totalTimelineWidth:t.timerCount+1:t.timerCount-1<0?0:t.timerCount-1,"bottom"===e||"top"===e?t.parent.ganttChartModule.scrollObject.setScrollTop(t.timerCount):t.parent.ganttChartModule.scrollObject.setScrollLeft(t.timerCount),"ConnectorPointLeftDrag"!==t.taskBarEditAction&&"ConnectorPointRightDrag"!==t.taskBarEditAction||t.drawFalseLine()}),0)},i.prototype.stopScrollTimer=function(){window.clearInterval(this.scrollTimer),this.scrollTimer=null},i.prototype.enableDragging=function(e){var t=this.taskBarEditRecord.ganttProperties,i=0;if(this.taskBarEditElement.classList.contains("e-segmented-taskbar")&&!this.taskBarEditElement.classList.contains("e-segment-first")){var r=this.taskBarEditRecord.ganttProperties.segments.map((function(e){return mt({},e)})),a=r[this.segmentIndex];this.mouseDownX>this.mouseMoveX?(i=sf.base.isNullOrUndefined(this.previousMouseMove)?this.mouseDownX-this.mouseMoveX:this.previousMouseMove-this.mouseMoveX,this.previousMouseMove=this.mouseMoveX,a.left=a.left-i):(i=sf.base.isNullOrUndefined(this.previousMouseMove)?this.mouseMoveX-this.mouseDownX:this.mouseMoveX-this.previousMouseMove,this.previousMouseMove=this.mouseMoveX,a.left=a.left+i);var s=r[this.segmentIndex-1],n=r[this.segmentIndex+1],o=void 0;o=this.taskBarEditElement.classList.contains("e-segment-inprogress")?a.left<s.left+s.width?s.left+s.width:a.width+a.left>n.left?n.left-a.width:a.left:a.left<s.left+s.width?s.left+s.width:t.left+a.width+a.left>=this.parent.timelineModule.totalTimelineWidth?this.parent.timelineModule.totalTimelineWidth-a.width:a.left,a.left=o,this.parent.setRecordValue("segments",r,t,!0),this.parent.dataOperation.updateMappingData(this.taskBarEditRecord,"segments")}else{this.mouseDownX>this.mouseMoveX?(i=this.mouseDownX-this.mouseMoveX)>0&&this.parent.setRecordValue("left",this.previousItem.left-i,t,!0):(i=this.mouseMoveX-this.mouseDownX,this.parent.setRecordValue("left",this.previousItem.left+i,t,!0));o=t.left<0?0:t.left+t.width>=this.parent.timelineModule.totalTimelineWidth?this.parent.timelineModule.totalTimelineWidth-t.width:t.left;this.parent.setRecordValue("left",o,t,!0)}},i.prototype.performProgressResize=function(e){var t=this.taskBarEditRecord.ganttProperties,i=0;this.mouseDownX>this.mouseMoveX?this.mouseMoveX>t.left&&this.mouseMoveX<t.left+t.width&&t.left>0?(i=this.mouseMoveX-t.left,this.parent.setRecordValue("progressWidth",i,t,!0)):this.mouseMoveX>=t.left+t.width?this.parent.setRecordValue("progressWidth",t.width,t,!0):this.parent.setRecordValue("progressWidth",0,t,!0):this.mouseMoveX>t.left&&this.mouseMoveX<t.left+t.width?(i=this.mouseMoveX-t.left,this.parent.setRecordValue("progressWidth",i,t,!0)):this.mouseMoveX<=t.left?this.parent.setRecordValue("progressWidth",0,t,!0):this.parent.setRecordValue("progressWidth",t.width,t,!0);var r=t.progressWidth>t.width?t.width:t.progressWidth;r=t.progressWidth<0?0:t.progressWidth,this.parent.setRecordValue("progressWidth",r,t,!0);var a=t.width-t.progressWidth;this.progressBorderRadius=a<=4?4-a:0},i.prototype.enableLeftResizing=function(e){var t=this.taskBarEditRecord.ganttProperties,i=0;this.taskBarEditElement.classList.contains("e-segmented-taskbar")?this.enableSplitTaskLeftResize(t):(this.mouseDownX>this.mouseMoveX?this.mouseMoveX<t.left+t.width?(i=this.mouseDownX-this.mouseMoveX,t.left>0&&(this.parent.setRecordValue("left",this.previousItem.left-i,t,!0),this.parent.setRecordValue("width",this.previousItem.width+i,t,!0))):this.mouseMoveX>t.left+t.width&&(i=this.mouseDownX-this.mouseMoveX,this.parent.setRecordValue("left",this.previousItem.left-i,t,!0),this.parent.setRecordValue("width",3,t,!0)):this.mouseMoveX<t.left+t.width?(i=this.mouseMoveX-this.mouseDownX,t.left<t.left+t.width&&this.previousItem.left+i<=this.previousItem.left+this.previousItem.width&&(this.parent.setRecordValue("left",this.previousItem.left+i,t,!0),this.parent.setRecordValue("width",this.previousItem.width-i,t,!0))):(i=this.mouseMoveX-this.mouseDownX,this.parent.setRecordValue("left",this.previousItem.left+i,t,!0),this.parent.setRecordValue("width",3,t,!0)),this.updateEditPosition(e,t),this.parent.setRecordValue("left",this.previousItem.left+this.previousItem.width-t.width,t,!0))},i.prototype.enableSplitTaskLeftResize=function(e){var t=this.taskBarEditRecord.ganttProperties.segments.map((function(e){return mt({},e)})),i=t[this.segmentIndex],r=0;if(this.mouseDownX>this.mouseMoveX)if(this.mouseMoveX<e.left+i.width+i.left){if(r=sf.base.isNullOrUndefined(this.previousMouseMove)?this.mouseDownX-this.mouseMoveX:this.previousMouseMove-this.mouseMoveX,this.previousMouseMove=this.mouseMoveX,i.left>0){if(i.left=i.left-r,i.width=i.width+r,0!==this.segmentIndex){var a=t[this.segmentIndex-1];if(e.left+i.left<e.left+a.left+a.width){e.left,a.left,a.width;var s=e.left+a.left+a.width-(e.left+i.left);i.width-=s,i.left=i.left+s}}}else if(i.left<=0&&0===this.segmentIndex){this.parent.setRecordValue("left",e.left-r,e,!0),this.parent.setRecordValue("width",e.width+r,e,!0),i.width=i.width+r;for(var n=1;n<e.segments.length;n++){var o=t[n];o.left=o.left+r}}}else this.mouseMoveX>e.left+i.width+i.left&&(r=sf.base.isNullOrUndefined(this.previousMouseMove)?this.mouseDownX-this.mouseMoveX:this.previousMouseMove-this.mouseMoveX,this.previousMouseMove=this.mouseMoveX,i.left=i.left-r,i.width=this.parent.perDayWidth);else if(this.mouseMoveX<e.left+i.width+i.left-this.parent.perDayWidth)if(r=sf.base.isNullOrUndefined(this.previousMouseMove)?this.mouseMoveX-this.mouseDownX:this.mouseMoveX-this.previousMouseMove,this.previousMouseMove=this.mouseMoveX,0===this.segmentIndex&&i.left<=0){this.parent.setRecordValue("left",e.left+r,e,!0),this.parent.setRecordValue("width",e.width-r,e,!0),i.width=i.width-r;for(n=1;n<e.segments.length;n++){var d=t[n];d.left=d.left-r}}else i.left<i.left+i.width&&i.left+r<=i.left+i.width&&(i.left=i.left+r,i.width=i.width-r);else if(this.mouseMoveX<e.left+i.left+i.width&&i.width>this.parent.perDayWidth)if(r=sf.base.isNullOrUndefined(this.previousMouseMove)?this.mouseMoveX-this.mouseDownX:this.mouseMoveX-this.previousMouseMove,this.previousMouseMove=this.mouseMoveX,r-=i.width-r<this.parent.perDayWidth?this.parent.perDayWidth>i.width?this.parent.perDayWidth-i.width:i.width-this.parent.perDayWidth:0,0===this.segmentIndex){this.parent.setRecordValue("width",e.width-r,e,!0),this.parent.setRecordValue("left",e.left+r,e,!0);for(n=1;n<e.segments.length;n++){var l=t[n];l.left=l.left-r}}else i.left=i.left+r,i.width=i.width-r;this.parent.setRecordValue("segments",t,e,!0),this.parent.dataOperation.updateMappingData(this.taskBarEditRecord,"segments")},i.prototype.updateEditPosition=function(e,t){this.updateIsMilestone(t),this.parent.setRecordValue("progressWidth",this.parent.dataOperation.getProgressWidth(t.width,t.progress),t,!0)},i.prototype.updateIsMilestone=function(e){e.width<=3?(this.parent.setRecordValue("width",3,e,!0),this.parent.setRecordValue("isMilestone",!0,e,!0)):(this.parent.setRecordValue("width",e.width,e,!0),this.parent.setRecordValue("isMilestone",!1,e,!0))},i.prototype.enableRightResizing=function(e){var t=this.taskBarEditRecord.ganttProperties,i=0;if(this.taskBarEditElement.classList.contains("e-segmented-taskbar")){var r=this.taskBarEditRecord.ganttProperties.segments.map((function(e){return mt({},e)})),a=r[this.segmentIndex];this.mouseDownX>this.mouseMoveX?this.mouseMoveX>t.left+a.left&&this.mouseDownX-this.mouseMoveX>3?(i=sf.base.isNullOrUndefined(this.previousMouseMove)?this.mouseDownX-this.mouseMoveX:this.previousMouseMove-this.mouseMoveX,this.previousMouseMove=this.mouseMoveX,a.width=a.width-i):this.mouseMoveX<t.left+a.left&&(a.width=this.parent.perDayWidth):this.mouseMoveX>a.left&&(i=sf.base.isNullOrUndefined(this.previousMouseMove)?this.mouseMoveX-this.mouseDownX:this.mouseMoveX-this.previousMouseMove,this.previousMouseMove=this.mouseMoveX,a.width=a.width+i);var s=void 0,n=this.segmentIndex!==r.length-1?r[this.segmentIndex+1]:null;sf.base.isNullOrUndefined(n)||(this.taskBarEditElement.classList.contains("e-segment-last")||(s=a.left+a.width>n.left?n.left-a.left:a.width),a.width=s),this.segmentIndex===t.segments.length-1&&0===this.segmentIndex&&this.parent.setRecordValue("width",a.width,t,!0),this.parent.setRecordValue("segments",r,t,!0),this.parent.dataOperation.updateMappingData(this.taskBarEditRecord,"segments")}else this.mouseDownX>this.mouseMoveX?this.mouseMoveX>t.left&&this.mouseDownX-this.mouseMoveX>3?(i=this.mouseDownX-this.mouseMoveX,this.parent.setRecordValue("width",this.previousItem.width-i,t,!0)):this.mouseMoveX<t.left&&this.parent.setRecordValue("width",3,t,!0):this.mouseMoveX>t.left&&(i=this.mouseMoveX-this.mouseDownX,this.parent.setRecordValue("width",this.previousItem.width+i,t,!0)),this.updateEditPosition(e,t)},i.prototype.updateEditedItem=function(){var e,t,i,r,a=this.taskBarEditRecord.ganttProperties;switch(this.taskBarEditAction){case"ProgressResizing":this.parent.setRecordValue("progress",this.getProgressPercent(a.width,a.progressWidth),a,!0);break;case"LeftResizing":-1===this.segmentIndex?(e=this.getRoundOffStartLeft(a,this.roundOffDuration),t=this.getDateByLeft(e),sf.base.isNullOrUndefined(a.endDate)&&(i=this.parent.dateValidationModule.getValidEndDate(a),this.parent.setRecordValue("endDate",i,a,!0)),r=this.parent.dateValidationModule.checkStartDate(t,a,null),this.parent.setRecordValue("startDate",new Date(r.getTime()),a,!0),0===this.parent.dateValidationModule.compareDates(a.startDate,a.endDate)&&sf.base.isNullOrUndefined(a.isMilestone)&&!1===a.isMilestone&&0===a.duration&&this.parent.setRecordValue("duration",1,a,!0),a.isMilestone&&this.parent.setRecordValue("endDate",new Date(r.getTime()),a,!0),this.parent.dateValidationModule.calculateDuration(this.taskBarEditRecord),this.parent.editModule.updateResourceRelatedFields(this.taskBarEditRecord,"duration")):this.updateSplitLeftResize(a);break;case"RightResizing":case"ParentResizing":if(-1===this.segmentIndex){e=this.getRoundOffEndLeft(a,this.roundOffDuration);var s=this.getDateByLeft(e);sf.base.isNullOrUndefined(a.startDate)&&(r=this.parent.dateValidationModule.getValidStartDate(a),this.parent.setRecordValue("startDate",r,a,!0));var n=sf.base.isNullOrUndefined(a.startDate)?r:a.startDate;i=a.isMilestone?n:this.parent.dateValidationModule.checkEndDate(s,this.taskBarEditRecord.ganttProperties),this.parent.setRecordValue("endDate",new Date(i.getTime()),a,!0),this.parent.dateValidationModule.calculateDuration(this.taskBarEditRecord),this.parent.editModule.updateResourceRelatedFields(this.taskBarEditRecord,"duration")}else this.updateSplitRightResizing(a);break;case"ParentDrag":case"ChildDrag":case"MilestoneDrag":case"ManualParentDrag":-1===this.segmentIndex||0===this.segmentIndex?this.updateChildDrag(a):this.setSplitTaskDrag(a)}},i.prototype.updateChildDrag=function(e){var t,i,r;t=this.getRoundOffStartLeft(e,this.roundOffDuration),i=this.getDateByLeft(t),0===this.segmentIndex?(this.parent.setRecordValue("startDate",this.parent.dateValidationModule.checkStartDate(i,e,null),e,!0),e.segments[0].startDate=i,e.segments[0].endDate=this.parent.dataOperation.getEndDate(e.segments[0].startDate,e.segments[0].duration,e.durationUnit,e,!1),this.parent.setRecordValue("segments",e.segments,e,!0),this.parent.dataOperation.updateMappingData(this.taskBarEditRecord,"segments"),this.parent.chartRowsModule.incrementSegments(e.segments,0,this.taskBarEditRecord),this.parent.setRecordValue("endDate",e.segments[e.segments.length-1].endDate,e,!0)):!sf.base.isNullOrUndefined(e.endDate)&&sf.base.isNullOrUndefined(e.startDate)?(r=this.parent.dateValidationModule.checkStartDate(i,e,null),r=this.parent.dateValidationModule.checkEndDate(r,this.taskBarEditRecord.ganttProperties),this.parent.setRecordValue("endDate",r,e,!0)):(this.parent.setRecordValue("startDate",this.parent.dateValidationModule.checkStartDate(i,e,null),e,!0),sf.base.isNullOrUndefined(e.duration)||this.parent.dateValidationModule.calculateEndDate(this.taskBarEditRecord))},i.prototype.updateSplitLeftResize=function(e){var t=e.segments[this.segmentIndex],i=0===this.segmentIndex?this.getRoundOffStartLeft(e,this.roundOffDuration):this.getRoundOffStartLeft(t,this.roundOffDuration),r=0===this.segmentIndex?this.getDateByLeft(i):this.getDateByLeft(e.left+i),a=this.parent.dataOperation.checkStartDate(r,e,!1),s=this.parent.dataOperation.getDuration(a,t.endDate,e.durationUnit,e.isAutoSchedule,e.isMilestone);if(t.startDate=new Date(a.getTime()),t.duration=s,this.parent.setRecordValue("duration",this.sumOfDuration(e.segments),e,!0),0===this.segmentIndex&&this.parent.setRecordValue("startDate",t.startDate,e,!0),this.parent.editModule.updateResourceRelatedFields(this.taskBarEditRecord,"duration"),!sf.base.isNullOrUndefined(e.segments[this.segmentIndex-1])){var n=this.parent.dataOperation.getDuration(e.segments[this.segmentIndex-1].endDate,e.segments[this.segmentIndex].startDate,e.durationUnit,e.isAutoSchedule,e.isMilestone);t.offsetDuration=n}this.parent.setRecordValue("segments",e.segments,e,!0),this.parent.dataOperation.updateMappingData(this.taskBarEditRecord,"segments")},i.prototype.updateSplitRightResizing=function(e){var t=e.segments[this.segmentIndex],i=this.getRoundOffEndLeft(e,this.roundOffDuration),r=this.getDateByLeft(i),a=this.parent.dataOperation.checkEndDate(r,e,!1),s=this.parent.dataOperation.getDuration(t.startDate,a,e.durationUnit,e.isAutoSchedule,e.isMilestone);if(t.endDate=new Date(a.getTime()),t.duration=s,!sf.base.isNullOrUndefined(e.segments[this.segmentIndex+1])){var n=e.segments[this.segmentIndex+1],o=this.parent.dataOperation.getDuration(e.segments[this.segmentIndex].endDate,n.startDate,e.durationUnit,e.isAutoSchedule,e.isMilestone);t.offsetDuration=o}this.parent.setRecordValue("segments",e.segments,e,!0),this.parent.dataOperation.updateMappingData(this.taskBarEditRecord,"segments"),this.parent.setRecordValue("duration",this.sumOfDuration(e.segments),e,!0),this.parent.setRecordValue("endDate",e.segments[e.segments.length-1].endDate,e,!0),this.parent.editModule.updateResourceRelatedFields(this.taskBarEditRecord,"duration")},i.prototype.sumOfDuration=function(e){for(var t=0,i=0;i<e.length;i++){t+=e[i].duration}return t},i.prototype.setSplitTaskDrag=function(e){var t=e.segments[this.segmentIndex],i=this.getRoundOffStartLeft(t,this.roundOffDuration),r=this.getDateByLeft(e.left+i);if(r=this.parent.dateValidationModule.checkStartDate(r,e,null),t.startDate=r,t.endDate=this.parent.dataOperation.getEndDate(t.startDate,t.duration,e.durationUnit,e,!1),t.duration=this.parent.dataOperation.getDuration(t.startDate,t.endDate,e.durationUnit,e.isAutoSchedule,e.isMilestone),this.parent.setRecordValue("duration",this.sumOfDuration(e.segments),e,!0),this.parent.setRecordValue("endDate",e.segments[e.segments.length-1].endDate,e,!0),sf.base.isNullOrUndefined(this.parent.taskFields.endDate)||this.parent.dataOperation.updateMappingData(this.taskBarEditRecord,"endDate"),!sf.base.isNullOrUndefined(e.segments[this.segmentIndex-1])){var a=this.parent.dataOperation.getDuration(e.segments[this.segmentIndex-1].endDate,e.segments[this.segmentIndex].startDate,e.durationUnit,e.isAutoSchedule,e.isMilestone);1!==t.startDate.getDay()||0!==a||this.parent.includeWeekend||(a=1),t.offsetDuration=a}if(!sf.base.isNullOrUndefined(e.segments[this.segmentIndex+1])){var s=e.segments[this.segmentIndex+1];a=this.parent.dataOperation.getDuration(e.segments[this.segmentIndex].endDate,s.startDate,e.durationUnit,e.isAutoSchedule,e.isMilestone);1!==s.startDate.getDay()||0!==a||this.parent.includeWeekend||(a=1),s.offsetDuration=a}this.parent.setRecordValue("segments",e.segments,e,!0),this.parent.dataOperation.updateMappingData(this.taskBarEditRecord,"segments")},i.prototype.getRoundOffEndLeft=function(e,t){var i="None"!==this.parent.timelineModule.bottomTier?this.parent.timelineModule.bottomTier:this.parent.timelineModule.topTier,r=e.width+e.left;if(-1!==this.segmentIndex){var a=e.segments[this.segmentIndex];r=r-e.width+a.width+a.left}var s=1/(this.parent.timelineModule.getIncrement(this.getDateByLeft(r),1,"Day")/864e5),n=this.parent.perDayWidth-this.parent.perDayWidth/s,o=n/this.parent.perDayWidth;if(void 0===t&&(t=!1),t){if(t)if("Hour"===i){var d=this.parent.perDayWidth/24;s=1/(this.parent.timelineModule.getIncrement(this.getDateByLeft(r),1,"Hour")/36e5),0!==(n=this.parent.perDayWidth/24-this.parent.perDayWidth/24/s)&&(r=r-n+d)}else if("Minutes"===i){var l=this.parent.perDayWidth/1440;s=1/(this.parent.timelineModule.getIncrement(this.getDateByLeft(r),1,"Minutes")/6e4),0!==(n=this.parent.perDayWidth/1440-this.parent.perDayWidth/1440/s)&&(r=r-n+l)}else 0!==n&&(r=r-n+this.parent.perDayWidth)}else"Hour"!==i&&"Minutes"!==i&&(o>.5?r=r-n+this.parent.perDayWidth:o<.5&&(r=r-n+this.parent.perDayWidth/2));return r},i.prototype.getRoundOffStartLeft=function(e,t){var i=(sf.base.isNullOrUndefined(e),e.left),r="None"!==this.parent.timelineModule.bottomTier?this.parent.timelineModule.bottomTier:this.parent.timelineModule.topTier,a=1/(this.parent.timelineModule.getIncrement(this.getDateByLeft(i),1,"Day")/864e5),s=this.parent.perDayWidth-this.parent.perDayWidth/a,n=s/this.parent.perDayWidth;return void 0===t&&(t=!1),t?t&&("Hour"===r?(a=1/(this.parent.timelineModule.getIncrement(this.getDateByLeft(i),1,"Hour")/36e5),i-=s=this.parent.perDayWidth/24-this.parent.perDayWidth/24/a):"Minutes"===r?(a=1/(this.parent.timelineModule.getIncrement(this.getDateByLeft(i),1,"Minutes")/6e4),i-=s=this.parent.perDayWidth/1440-this.parent.perDayWidth/1440/a):i-=s):"Hour"!==r&&"Minutes"!==r&&(n<=.5?i-=s:n>.5&&(i=i-s+this.parent.perDayWidth/2)),i},i.prototype.getDateByLeft=function(e){var t=new Date(this.parent.timelineModule.timelineStartDate.toString()),i=864e5/this.parent.perDayWidth;t.setTime(t.getTime()+e*i);var r="None"!==this.parent.timelineModule.bottomTier?this.parent.timelineModule.topTier:this.parent.timelineModule.bottomTier;return"Hour"!==r&&"Minutes"!==r&&(this.isInDst(new Date(this.parent.timelineModule.timelineStartDate.toString()))&&!this.isInDst(t)?t.setTime(t.getTime()+36e5):!this.isInDst(new Date(this.parent.timelineModule.timelineStartDate.toString()))&&this.isInDst(t)&&t.setTime(t.getTime()-36e5)),t},i.prototype.getDefaultTZOffset=function(){var e=new Date((new Date).getFullYear(),0,1),t=new Date((new Date).getFullYear(),6,1);return Math.max(e.getTimezoneOffset(),t.getTimezoneOffset())},i.prototype.isInDst=function(e){return e.getTimezoneOffset()<this.getDefaultTZOffset()},i.prototype.setItemPosition=function(){var e=this.taskBarEditRecord.ganttProperties,t=sf.base.isNullOrUndefined(e.segments)?null:e.segments[this.segmentIndex],i="MilestoneDrag"===this.taskBarEditAction||e.isMilestone?this.parent.chartRowsModule.milestoneHeight:e.width,r=this.parent.isAdaptive?i-2:i-10;sf.base.isNullOrUndefined(t)||(r=this.parent.isAdaptive?t.width-2:t.width-10);var a=this.taskBarEditElement.classList.contains(A)?this.taskBarEditElement:sf.base.closest(this.taskBarEditElement,"tr."+G).querySelector("."+A),s=this.taskBarEditElement.classList.contains("e-segmented-taskbar"),n=sf.base.closest(this.taskBarEditElement,"tr."+G).querySelector("."+N),o=sf.base.closest(this.taskBarEditElement,"tr."+G).querySelector("."+B),d=this.taskBarEditElement.querySelector(".e-gantt-child-progressbar"),l=this.taskBarEditElement.querySelector("."+z),p=this.taskBarEditElement.querySelector("."+q),h=this.taskBarEditElement.querySelector(".e-taskbar-right-resizer"),c=this.taskBarEditElement.querySelector(".e-gantt-parent-taskbar"),u=this.taskBarEditElement.querySelector(".e-gantt-parent-progressbar"),f=this.taskBarEditElement.querySelector(".e-right-connectorpoint-outer-div"),g=this.taskBarEditElement,m=this.taskBarEditElement.querySelector("."+_),y=this.taskBarEditElement.querySelector(".e-gantt-manualparenttaskbar-right"),b=this.taskBarEditElement.querySelector(".e-gantt-manualparenttaskbar-left");if("ConnectorPointRightDrag"!==this.taskBarEditAction&&"ConnectorPointLeftDrag"!==this.taskBarEditAction){if("ParentResizing"!==this.taskBarEditAction&&"ManualParentDrag"!==this.taskBarEditAction){if(!s||sf.base.isNullOrUndefined(e.segments)||"RightResizing"!==this.taskBarEditAction&&0===this.segmentIndex||(this.taskBarEditElement.style.width=t.width+"px",this.taskBarEditElement.style.left=t.left+"px"),a.style.width=i+"px",a.style.left=e.left+"px",n.style.width=e.left+"px","LeftResizing"===this.taskBarEditAction&&0===this.segmentIndex)for(var v=this.taskBarEditElement.parentElement.getElementsByClassName("e-segmented-taskbar"),D=0;D<e.segments.length;D++){var w=e.segments[D],k=v[D];k.style.width=w.width+"px",k.style.left=w.left+"px"}sf.base.isNullOrUndefined(o)||(o.style.left=e.left+i+"px")}f&&(f.style.left=(this.parent.isAdaptive?i+10:i+2)+"px"),"MilestoneDrag"===this.taskBarEditAction||e.isMilestone?(a.style.left=e.left-i/2+"px",n.style.width=e.left-i/2+"px",sf.base.isNullOrUndefined(o)||(o.style.left=e.left+i/2+"px")):"ProgressResizing"===this.taskBarEditAction?-1===this.segmentIndex&&(l.style.left=e.left+e.progressWidth-10+"px",sf.base.isNullOrUndefined(d)||(d.style.width=e.progressWidth+"px",d.style.borderBottomRightRadius=this.progressBorderRadius+"px",d.style.borderTopRightRadius=this.progressBorderRadius+"px",p.style.left=e.progressWidth-8+"px")):"RightResizing"!==this.taskBarEditAction||sf.base.isNullOrUndefined(l)?"ParentDrag"===this.taskBarEditAction?(sf.base.isNullOrUndefined(c)||(c.style.width=i+"px"),sf.base.isNullOrUndefined(d)||(u.style.width=e.progressWidth+"px")):"ParentResizing"===this.taskBarEditAction?(g.style.width=m.style.width=e.width+"px",y.style.left=e.width-b.offsetLeft+"px"):"ManualParentDrag"===this.taskBarEditAction?g.style.left=e.left-e.autoLeft+"px":(sf.base.isNullOrUndefined(l)||s||(l.style.width=i+"px"),sf.base.isNullOrUndefined(d)||(h.style.left=r+"px",d.style.width=e.progressWidth+"px",sf.base.isNullOrUndefined(p)||(p.style.left=e.progressWidth-10+"px")),s&&(h.style.left=r+"px",d.style.width=t.progressWidth+"px",sf.base.isNullOrUndefined(p)||(p.style.left=t.progressWidth-10+"px"))):(l.style.width=i+"px",sf.base.isNullOrUndefined(d)||(d.style.width=e.progressWidth+"px",h.style.left=r+"px",sf.base.isNullOrUndefined(p)||(p.style.left=e.progressWidth-10+"px")))}},i.prototype.mouseUpHandler=function(e){var t=this.isMouseDragged;this.previousMouseMove=null,this.editTooltip.showHideTaskbarEditTooltip(!1,this.segmentIndex),this.taskBarEditAction&&this.isMouseDragged&&(!this.dragMouseLeave&&this.taskBarEditedAction?(this.taskBarEditedAction(e),this.isMouseDragged=!1):this.cancelTaskbarEditActionInMouseLeave()),"ResourceView"===this.parent.viewType&&this.parent.enableMultiTaskbar&&!sf.base.isNullOrUndefined(this.taskBarEditElement)&&(sf.base.isNullOrUndefined(this.taskBarEditElement.querySelector(".e-gantt-child-taskbar"))||this.taskBarEditElement.querySelector(".e-gantt-child-taskbar").classList.contains("e-collapsed-taskbar-drag")&&(sf.base.removeClass([this.taskBarEditElement.querySelector(".e-gantt-child-taskbar")],"e-collapsed-taskbar-drag"),this.taskBarEditElement.style.zIndex=this.prevZIndex,this.prevZIndex="")),this.parent.isAdaptive&&!t||this.initPublicProp(),this.stopScrollTimer()},i.prototype.taskBarEditedAction=function(e){var t,i,r={},a=this.mouseDownX,s=this.mouseDownY,n=this.taskBarEditRecord,o=this.parent.ganttChartModule.getIndexByTaskBar(this.taskBarEditElement),d=this.getCoordinate(e);t=this.mouseMoveX,i=d.pageY-this.parent.ganttChartModule.chartBodyContainer.offsetTop,"ConnectorPointLeftDrag"!==this.taskBarEditAction&&"ConnectorPointRightDrag"!==this.taskBarEditAction||this.drawPredecessor||(this.dependencyCancel=!0),"ConnectorPointLeftDrag"!==this.taskBarEditAction&&"ConnectorPointRightDrag"!==this.taskBarEditAction||!this.drawPredecessor?(a!==t||Math.abs(s-i)>=(this.parent.rowHeight-this.parent.taskbarHeight)/2)&&null!==n&&(r.editingFields=n.ganttProperties,r.data=n,r.recordIndex=o,r.previousData=this.previousItem,r.taskBarEditAction=this.taskBarEditAction,r.action="TaskbarEditing",r.roundOffDuration=this.roundOffDuration,r.target=this.targetElement,this.taskbarEditedArgs=r,this.taskbarEdited(r)):this.parent.connectorLineEditModule.updatePredecessor(this.connectorSecondRecord,this.finalPredecessor)},i.prototype.cancelTaskbarEditActionInMouseLeave=function(){this.parent.editModule.reUpdatePreviousRecords(!0)},i.prototype.updateSegmentProgress=function(e){for(var t=e.segments,i=!0,r=this.splitTasksDuration(t)*this.parent.perDayWidth,a=this.parent.dataOperation.getProgressWidth(r,e.progress),s=0;s<t.length;s++){var n=t[s];delete n.progressWidth,a>0&&a>n.width?(a-=n.width,n.progressWidth=n.width,n.showProgress=!1):i&&(n.progressWidth=a,n.showProgress=!0,a-=n.width,i=!1)}},i.prototype.taskbarEdited=function(e){var t=sf.base.extend({},e),i=t.data,r=i.ganttProperties;if("ProgressResizing"===t.taskBarEditAction)t.previousData.progress!==r.progress&&(this.parent.setRecordValue("progress",this.getProgressPercent(r.width,r.progressWidth),r,!0),i.parentItem&&this.parent.editModule.updateParentProgress(i.parentItem),sf.base.isNullOrUndefined(r.segments)||this.updateSegmentProgress(r));else{var a=t.data.ganttProperties.segments;if(!sf.base.isNullOrUndefined(a)&&a.length>0&&("LeftResizing"===this.taskBarEditAction&&0!==this.segmentIndex||"ChildDrag"===this.taskBarEditAction&&0!==this.segmentIndex||"RightResizing"===this.taskBarEditAction)){var s=a[this.segmentIndex],n=this.taskBarEditRecord.ganttProperties,o=(a.length,0===this.segmentIndex?null:a[this.segmentIndex-1]),d=this.segmentIndex===a.length-1?null:a[this.segmentIndex+1],l=sf.base.isNullOrUndefined(d)?this.parent.cloneProjectEndDate:new Date(d.startDate.getTime()),p=sf.base.isNullOrUndefined(o)?this.parent.cloneProjectStartDate:new Date(o.endDate.getTime());l.setHours(0,0,0,0),p.setHours(0,0,0,0);var h=new Date(s.startDate.getTime()),c=new Date(s.endDate.getTime());if(h.setDate(h.getDate()-1),c.setDate(c.getDate()+1),h.setHours(0,0,0,0),c.setHours(0,0,0,0),h.getTime()<=p.getTime()){var u=[{firstSegmentIndex:o.segmentIndex,secondSegmentIndex:s.segmentIndex}];this.parent.chartRowsModule.mergeTask(n.taskId,u)}else if(c.getTime()>=l.getTime()&&this.segmentIndex!==a.length-1){u=[{firstSegmentIndex:s.segmentIndex,secondSegmentIndex:d.segmentIndex}];this.parent.chartRowsModule.mergeTask(n.taskId,u)}else if(c.getTime()>=l.getTime()){s.endDate.setDate(this.parent.cloneProjectEndDate.getDate()-1),s.startDate=this.parent.dataOperation.getStartDate(s.endDate,s.duration,n.durationUnit,n);for(var f=a.length-2;f>=0;f++){var g=a[f],m=g.endDate;m.setDate(m.getDate()-g.offsetDuration),g.endDate=m,g.startDate=this.parent.dataOperation.getStartDate(g.endDate,g.duration,n.durationUnit,n)}}}this.parent.dataOperation.updateWidthLeft(t.data)}this.parent.dataOperation.updateTaskData(i),this.parent.editModule.initiateUpdateAction(t)},i.prototype.getProgressPercent=function(e,t){return Math.ceil(t/e*100)},i.prototype.drawFalseLine=function(){var e,t,i=this.mouseDownX,r=this.mouseDownY,a=this.mouseMoveX,s=this.mouseMoveY,n=Math.sqrt((i-a)*(i-a)+(r-s)*(r-s)),o="rotate("+180*Math.atan2(s-r,a-i)/Math.PI+"deg)";"ConnectorPointLeftDrag"===this.taskBarEditAction&&(e=this.elementOffsetLeft-this.parent.chartRowsModule.connectorPointWidth/2-this.parent.ganttChartModule.scrollObject.previousScroll.left),"ConnectorPointRightDrag"===this.taskBarEditAction&&(e=this.elementOffsetLeft+this.elementOffsetWidth+this.parent.chartRowsModule.connectorPointWidth/2-this.parent.ganttChartModule.scrollObject.previousScroll.left),t=this.elementOffsetTop+this.elementOffsetHeight/2+this.parent.ganttChartModule.chartBodyContainer.offsetTop-this.parent.ganttChartModule.scrollObject.previousScroll.top,this.removeFalseLine(!1),this.falseLine=sf.base.createElement("div",{className:"e-gantt-false-line",id:"ganttfalseline"+this.parent.element.id,styles:"transform-origin: 0% 100%;right: auto;position: absolute;transform:"+o+";border-top-width: 1px;border-top-style: dashed;z-index: 5;width:"+(n-3)+"px;left:"+e+"px;top:"+t+"px;"}),this.parent.ganttChartModule.chartBodyContainer.appendChild(this.falseLine)},i.prototype.removeFalseLine=function(e){this.falseLine&&(sf.base.remove(this.falseLine),this.falseLine=null,e&&(this.elementOffsetLeft=0,this.elementOffsetTop=0,this.elementOffsetWidth=0,this.elementOffsetHeight=0,sf.base.removeClass(this.parent.ganttChartModule.scrollElement.querySelectorAll(".e-connector-line-container"),["e-connector-line-z-index"])))},i.prototype.updateConnectorLineSecondProperties=function(e){var i=this.getElementByPosition(e),r=t(i,A);this.connectorSecondAction=null;var a=0;if(t(i,Y)?(this.connectorSecondAction="ConnectorPointLeftDrag",this.toPredecessorText="Start"):t(i,"e-connectorpoint-right")?(this.connectorSecondAction="ConnectorPointRightDrag",this.toPredecessorText="Finish"):(this.connectorSecondAction=null,this.toPredecessorText=null),this.taskBarEditElement!==r&&this.taskBarEditElement!==this.highlightedSecondElement){if(this.parent.virtualScrollModule&&this.parent.enableVirtualization)a=this.parent.virtualScrollModule.getTopPosition();(this.parent.virtualScrollModule&&this.parent.enableVirtualization&&!this.elementOffsetLeft||!this.parent.enableVirtualization)&&(this.elementOffsetLeft=this.taskBarEditElement.offsetLeft,this.elementOffsetTop=this.taskBarEditElement.offsetTop+a,this.elementOffsetWidth=this.taskBarEditElement.offsetWidth,this.elementOffsetHeight=this.taskBarEditElement.offsetHeight),this.showHideTaskBarEditingElements(r,this.highlightedSecondElement,!0)}sf.base.isNullOrUndefined(this.connectorSecondAction)&&!sf.base.isNullOrUndefined(this.connectorSecondElement)&&(this.editTooltip.showHideTaskbarEditTooltip(!1,this.segmentIndex),sf.base.removeClass([this.connectorSecondElement.querySelector("."+Y)],["e-connectorpoint-allow-block"]),sf.base.removeClass([this.connectorSecondElement.querySelector(".e-connectorpoint-right")],["e-connectorpoint-allow-block"])),this.connectorSecondElement=this.connectorSecondAction?r:null,this.highlightedSecondElement=r,this.connectorSecondRecord=sf.base.isNullOrUndefined(this.connectorSecondElement)?null:this.parent.ganttChartModule.getRecordByTaskBar(this.connectorSecondElement)},i.prototype.triggerDependencyEvent=function(e,t){var i,r,a=this.taskBarEditRecord.ganttProperties,s=this.connectorSecondRecord?this.connectorSecondRecord.ganttProperties:null,n=this.getElementByPosition(e),o=n,d="ResourceView"===this.parent.viewType?a.taskId:a.rowUniqueID;if("ConnectorPointLeftDrag"===this.taskBarEditAction?i=d+"S":"ConnectorPointRightDrag"===this.taskBarEditAction&&(i=d+"F"),this.connectorSecondAction&&("ConnectorPointLeftDrag"===this.connectorSecondAction?(i+="S",r="start"):"ConnectorPointRightDrag"===this.connectorSecondAction&&(i+="F",r="finish")),sf.base.isNullOrUndefined(s))this.drawPredecessor=!1;else{s.predecessorsName?this.finalPredecessor=s.predecessorsName+","+i:this.finalPredecessor=i;var l=this.parent.connectorLineEditModule.validatePredecessorRelation(this.connectorSecondRecord,this.finalPredecessor),p=this.parent.predecessorModule.calculatePredecessor(i,this.connectorSecondRecord),h={};if(h.fromItem=a,h.toItem=s,h.newPredecessorString=this.finalPredecessor,h.predecessor=p&&p[0],h.isValidLink=l,h.requestType="ValidateDependency",this.parent.trigger("actionBegin",h),h.isValidLink=!(!l&&h.isValidLink)&&h.isValidLink,h.isValidLink){if(this.editTooltip.toolTipObj||this.parent.isAdaptive||this.editTooltip.showHideTaskbarEditTooltip(!0,this.segmentIndex),this.editTooltip.toolTipObj){this.parent.connectorLineModule.tooltipTable.innerHTML=this.parent.connectorLineModule.getConnectorLineTooltipInnerTd(this.parent.editModule.taskbarEditModule.taskBarEditRecord.ganttProperties.taskName,this.parent.editModule.taskbarEditModule.fromPredecessorText,"","");var c=this.parent.connectorLineModule.tooltipTable.querySelector("#toPredecessor").querySelectorAll("td");c[1].innerText=s.taskName,c[2].innerText=this.parent.localeObj.getConstant(r);var u=this.parent.connectorLineModule.tooltipTable.parentElement.parentElement;u.offsetTop+u.offsetHeight>e.pageY&&(u.style.top=e.pageY-u.offsetHeight-20+"px")}this.drawPredecessor=!0}else this.parent.isAdaptive?(n.classList.contains(Y)||n.classList.contains("e-connectorpoint-right"))&&this.showHideActivePredecessors(!0):sf.base.addClass([o],["e-connectorpoint-allow-block"]),this.drawPredecessor=!1}},i.prototype.getCoordinate=function(e){var t={};if(this.parent.isAdaptive&&e&&"click"!==e.type)"touchmove"!==(i=e).type&&"touchstart"!==i.type&&"touchend"!==i.type||(t.pageX=i.changedTouches[0].pageX,t.pageY=i.changedTouches[0].pageY);else if(e){var i=e;t.pageX=i.pageX,t.pageY=i.pageY}return t},i.prototype.getElementByPosition=function(e){if(this.parent.isAdaptive){var t=this.getCoordinate(e);return document.elementFromPoint(t.pageX-window.pageXOffset,t.pageY-window.pageYOffset)}return e.target},i.prototype.multipleSelectionEnabled=function(){this.parent.selectionModule&&"Cell"!==this.parent.selectionSettings.mode&&"Multiple"===this.parent.selectionSettings.type&&this.parent.selectionModule.hidePopUp()},i.prototype.unWireEvents=function(){this.parent.isDestroyed||(this.parent.off("chartMouseDown",this.mouseDownHandler),this.parent.off("chartMouseUp",this.mouseUpHandler),this.parent.off("chartMouseLeave",this.mouseLeaveHandler),this.parent.off("chartMouseMove",this.mouseMoveAction),this.parent.off("chartMouseClick",this.mouseClickHandler))},i.prototype.destroy=function(){this.unWireEvents(),this.stopScrollTimer(),this.parent.editModule.taskbarEditModule=void 0},i}(F),bt=function(){function e(e){this.updatedEditFields=null,this.updatedAddFields=null,this.addedRecord=null,this.dialogEditValidationFlag=!1,this.ganttResources=[],this.previousResource=[],this.isResourceUpdate=!1,this.parent=e,this.localeObj=this.parent.localeObj,this.beforeOpenArgs={cancel:!1},this.types=this.getPredecessorType(),this.rowData={},this.editedRecord={},this.inputs={booleanedit:sf.buttons.CheckBox,dropdownedit:sf.dropdowns.DropDownList,datepickeredit:sf.calendars.DatePicker,datetimepickeredit:sf.calendars.DateTimePicker,maskededit:sf.inputs.MaskedTextBox,numericedit:sf.inputs.NumericTextBox,stringedit:sf.inputs.TextBox},this.processDialogFields(),this.wireEvents()}return e.prototype.wireEvents=function(){this.parent.on("chartDblClick",this.dblClickHandler,this)},e.prototype.dblClickHandler=function(e){var t=this.parent.ganttChartModule.getRecordByTarget(e);sf.base.isNullOrUndefined(t)||this.openEditDialog(t)},e.prototype.processDialogFields=function(){sf.base.isNullOrUndefined(this.parent.editDialogFields)||this.parent.editDialogFields&&0===this.parent.editDialogFields.length?(this.updatedEditFields=this.getDefaultDialogFields(),this.updatedEditFields=this.validateDialogFields(this.updatedEditFields)):this.updatedEditFields=this.validateDialogFields(this.parent.editDialogFields),sf.base.isNullOrUndefined(this.parent.addDialogFields)||this.parent.addDialogFields&&0===this.parent.addDialogFields.length?(this.updatedAddFields=this.getDefaultDialogFields(),this.updatedAddFields=this.validateDialogFields(this.updatedAddFields)):this.updatedAddFields=this.validateDialogFields(this.parent.addDialogFields)},e.prototype.validateDialogFields=function(e){for(var t=[],i=0,r=0;r<e.length;r++){var a=sf.grids.getActualProperties(e[r]);"General"!==a.type||!sf.base.isNullOrUndefined(a.fields)&&0!==a.fields.length||(a.fields=this.getGeneralColumnFields()),"Dependency"===a.type&&sf.base.isNullOrUndefined(this.parent.taskFields.dependency)||"Resources"===a.type&&sf.base.isNullOrUndefined(this.parent.taskFields.resourceInfo)||"Notes"===a.type&&sf.base.isNullOrUndefined(this.parent.taskFields.notes)||("Custom"!==a.type||!sf.base.isNullOrUndefined(a.fields)&&0!==a.fields.length||(i+=1,a.fields=this.getCustomColumnFields()),i>1||t.push(a))}return t},e.prototype.getGeneralColumnFields=function(){for(var e=[],t=0,i=Object.keys(this.parent.columnMapping);t<i.length;t++){var r=i[t];"dependency"!==r&&"resourceInfo"!==r&&"notes"!==r&&e.push(this.parent.columnMapping[r])}return e},e.prototype.getCustomColumnFields=function(){for(var e=[],t=0;t<this.parent.customColumns.length;t++)e.push(this.parent.customColumns[t]);return e},e.prototype.getDefaultDialogFields=function(){var e=[],t={},i=this.parent.taskFields,r=this.parent.columnMapping;return 0!==Object.keys(r).length&&(t.type="General",e.push(t)),sf.base.isNullOrUndefined(sf.base.getValue("dependency",r))||(t={},!1!==this.parent.columnByField[r.dependency.valueOf()].visible&&(t.type="Dependency"),e.push(t)),sf.base.isNullOrUndefined(sf.base.getValue("resourceInfo",r))||(t={},!1!==this.parent.columnByField[r.resourceInfo.valueOf()].visible&&(t.type="Resources"),e.push(t)),sf.base.isNullOrUndefined(sf.base.getValue("notes",r))||(t={},!1!==this.parent.columnByField[r.notes.valueOf()].visible&&(t.type="Notes"),e.push(t)),sf.base.isNullOrUndefined(sf.base.getValue("segments",i))||((t={}).type="Segments",e.push(t)),this.parent.customColumns.length>0&&((t={}).type="Custom",e.push(t)),e},e.prototype.openAddDialog=function(){this.isEdit=!1,this.editedRecord=this.composeAddRecord(),this.createDialog()},e.prototype.getMinimumStartDate=function(){var e=sf.data.DataUtil.aggregates.min(this.parent.flatData,"ganttProperties.startDate");return e=sf.base.isNullOrUndefined(e)?new Date(this.parent.timelineModule.timelineStartDate.getTime()):new Date(e.getTime()),e=this.parent.dateValidationModule.checkStartDate(e),new Date(e.getTime())},e.prototype.composeAddRecord=function(){for(var e={ganttProperties:{}},t=this.parent.ganttColumns,i=this.parent.taskFields,r=this.parent.editModule.getNewTaskId(),a=0;a<t.length;a++){var s=t[a].field;s===i.id?(e[s]=r,e.ganttProperties.rowUniqueID=e[s]):t[a].field===i.startDate?(sf.base.isNullOrUndefined(e[i.endDate])?e[s]=this.getMinimumStartDate():e[s]=new Date(e[i.endDate]),e.ganttProperties.startDate=new Date(e[s])):t[a].field===i.endDate?(sf.base.isNullOrUndefined(e[i.startDate])?e[s]=this.getMinimumStartDate():e[s]=new Date(e[i.startDate]),e.ganttProperties.endDate=new Date(e[s])):t[a].field===i.duration?(e[s]=1,e.ganttProperties.duration=e[s],e.ganttProperties.durationUnit=this.parent.durationUnit.toLocaleLowerCase()):t[a].field===i.name?(e[s]="New Task "+r,e.ganttProperties.taskName=e[s]):t[a].field===i.progress?(e[s]=0,e.ganttProperties.progress=e[s]):t[a].field===i.work?(e[s]=0,e.ganttProperties.work=e[s]):"taskType"===t[a].field?(e[s]=this.parent.taskType,e.ganttProperties.taskType=e[s]):e[this.parent.ganttColumns[a].field]=""}return e.ganttProperties.isAutoSchedule="Auto"===this.parent.taskMode||"Manual"!==this.parent.taskMode&&!0!==e[i.manual],e},e.prototype.openToolbarEditDialog=function(){var e=this.parent;if(e.editModule&&e.editSettings.allowEditing){this.parent.ganttChartModule.focusedRowIndex>-1&&e.selectionModule&&e.selectionModule.selectRow(this.parent.ganttChartModule.focusedRowIndex,!1,!1);var t=e.selectionModule?"Row"!==e.selectionSettings.mode&&"Both"!==e.selectionSettings.mode||1!==e.selectionModule.selectedRowIndexes.length?"Cell"===e.selectionSettings.mode&&1===e.selectionModule.getSelectedRowCellIndexes().length?e.updatedRecords[e.selectionModule.getSelectedRowCellIndexes()[0].rowIndex].ganttProperties.rowUniqueID:null:e.updatedRecords[e.selectionModule.selectedRowIndexes[0]].ganttProperties.rowUniqueID:null;sf.base.isNullOrUndefined(t)||this.openEditDialog(t)}},e.prototype.openEditDialog=function(e){var t=this.parent;"object"!==i(e)||sf.base.isNullOrUndefined(e)?sf.base.isNullOrUndefined(e)?t.selectedRowIndex>-1&&(this.rowData=t.currentViewData[t.selectedRowIndex],this.rowIndex=t.selectedRowIndex):(this.rowIndex=t.ids.indexOf(e.toString()),this.rowIndex>-1&&(this.rowData=t.flatData[this.rowIndex])):(this.rowIndex=this.parent.currentViewData.indexOf(e),this.rowIndex>-1&&(this.rowData=e)),this.isEdit=!0,"ResourceView"===this.parent.viewType&&0===this.rowData.level||0!==Object.keys(this.rowData).length&&(this.editedRecord=sf.base.extend({},{},this.rowData,!0),this.createDialog())},e.prototype.createDialog=function(){var e=this,t=this.parent,i={};this.beforeOpenArgs.dialogModel=i,this.beforeOpenArgs.rowData=this.editedRecord,this.beforeOpenArgs.rowIndex=this.rowIndex;var r=this.parent.isAdaptive?"":"600px",a=this.parent.createElement("div",{id:t.element.id+"_dialog",styles:"max-width:"+r});t.element.appendChild(a),i.animationSettings={effect:"None"},i.header=this.localeObj.getConstant(this.isEdit?"editDialogTitle":"addDialogTitle"),i.isModal=!0,i.cssClass="e-gantt-dialog",i.allowDragging=!this.parent.isAdaptive,i.showCloseIcon=!0;var s=this.parent.isAdaptive?{X:"top",Y:"left"}:{X:"center",Y:"center"};i.position=s,i.height=this.parent.isAdaptive?"100%":"auto",i.target=this.parent.element,i.close=this.dialogClose.bind(this),i.closeOnEscape=!0,i.open=function(t){var i=sf.base.getValue("element",t),r=i.querySelector("#"+e.parent.element.id+"GeneralTabContainer");r&&r.scrollHeight>r.offsetHeight&&r.classList.add("e-scroll"),0===e.tabObj.selectedItem&&e.tabObj.select(0),e.parent.isAdaptive&&(i.style.maxHeight="none"),e.parent.focusModule&&e.parent.focusModule.setActiveElement(i)},i.locale=this.parent.locale,i.buttons=[{buttonModel:{content:this.localeObj.getConstant("saveButton"),cssClass:"e-primary"},click:this.buttonClick.bind(this)},{buttonModel:{cssClass:"e-flat",content:this.localeObj.getConstant("cancel")},click:this.buttonClick.bind(this)}],this.createTab(i,a)},e.prototype.buttonClick=function(e){var t=e.target;t.style.pointerEvents="none",this.localeObj.getConstant("cancel").toLowerCase()===e.target.innerText.trim().toLowerCase()?this.dialog&&!this.dialogObj.isDestroyed&&(this.dialogObj.hide(),this.dialogClose()):(this.initiateDialogSave(),t.style.pointerEvents="auto")},e.prototype.dialogClose=function(){this.dialog&&this.resetValues(),sf.base.isNullOrUndefined(this.parent.focusModule)||sf.base.isNullOrUndefined(this.parent.focusModule.getActiveElement(!0))||this.parent.focusModule.getActiveElement(!0).focus()},e.prototype.resetValues=function(){this.isEdit=!1,this.isAddNewResource=!1,this.editedRecord={},this.rowData={},this.rowIndex=-1,this.addedRecord=null,this.ganttResources=[],this.dialog&&!this.dialogObj.isDestroyed&&(this.destroyDialogInnerElements(),this.dialogObj.destroy(),sf.base.remove(this.dialog))},e.prototype.destroyDialogInnerElements=function(){for(var e=this.parent,t=this.beforeOpenArgs.tabModel.items,i=0;i<t.length;i++){var r=t[i].content,a=r.id;if(!sf.base.isNullOrUndefined(a)||""!==a)if("General"===(a=(a=a.replace(e.element.id,"")).replace("TabContainer","")))this.destroyCustomField(r);else if("Dependency"===a){r.ej2_instances[0].destroy()}else if("Notes"===a){r.ej2_instances[0].destroy()}else if("Resources"===a){r.ej2_instances[0].destroy()}else-1!==a.indexOf("Custom")&&this.destroyCustomField(r)}},e.prototype.destroyCustomField=function(e){for(var t=e.childNodes,i=this.parent,r=0;r<t.length;r++){var a=t[r],s=a.querySelector('input[id^="'+i.element.id+'"]');if(s){var n=s.id.replace(i.element.id,""),o=a.querySelector("#"+i.element.id+n).ej2_instances[0];if(!sf.base.isNullOrUndefined(o)){var d=i.columnByField[n];if(!sf.base.isNullOrUndefined(d.edit)&&sf.base.isNullOrUndefined(d.edit.params)){var l=d.edit.destroy;"string"==typeof l?(l=sf.grids.getObject(l,window))():d.edit.destroy()}else o.destroy()}}}},e.prototype.destroy=function(){this.resetValues(),this.parent.isDestroyed||(this.parent.off("chartDblClick",this.dblClickHandler),this.parent.editModule.dialogModule=void 0)},e.prototype.getEditFields=function(){return this.isEdit?this.updatedEditFields:this.updatedAddFields},e.prototype.createTab=function(e,t){var i,r=this,a=this.parent,s={},n=[],o=this.getEditFields(),d=a.taskFields,l=o.length;s.items=n,s.locale=this.parent.locale,this.beforeOpenArgs.tabModel=s;var p=0;if(l>0)for(var h=0;h<l;h++){var c=o[h],u={};if("General"===c.type){if(0===Object.keys(a.columnMapping).length)continue;sf.base.isNullOrUndefined(c.headerText)&&(c.headerText=this.localeObj.getConstant("generalTab")),u.content="General",this.beforeOpenArgs[u.content]=this.getFieldsModel(c.fields)}else if("Segments"===c.type){if(sf.base.isNullOrUndefined(d.segments))continue;sf.base.isNullOrUndefined(c.headerText)&&(c.headerText=this.localeObj.getConstant("segments")),u.content="Segments",this.beforeOpenArgs[u.content]=this.getSegmentsModel(c.fields)}else if("Dependency"===c.type){if(sf.base.isNullOrUndefined(d.dependency))continue;sf.base.isNullOrUndefined(c.headerText)&&(c.headerText=this.localeObj.getConstant("dependency")),u.content="Dependency",this.beforeOpenArgs[u.content]=this.getPredecessorModel(c.fields)}else if("Resources"===c.type){if(sf.base.isNullOrUndefined(d.resourceInfo))continue;sf.base.isNullOrUndefined(c.headerText)&&(c.headerText=this.localeObj.getConstant("resourceName")),u.content="Resources",this.beforeOpenArgs[u.content]=this.getResourcesModel(c.fields)}else if("Notes"===c.type){if(sf.base.isNullOrUndefined(d.notes))continue;sf.base.isNullOrUndefined(c.headerText)&&(c.headerText=this.localeObj.getConstant("notes")),u.content="Notes",this.beforeOpenArgs[u.content]=this.getNotesModel(c.fields)}else{if(sf.base.isNullOrUndefined(c.fields)||0===c.fields.length)continue;sf.base.isNullOrUndefined(c.headerText)&&(c.headerText=this.localeObj.getConstant("customTab")),u.content="Custom"+p++,this.beforeOpenArgs[u.content]=this.getFieldsModel(c.fields)}u.header={text:c.headerText},n.push(u)}this.beforeOpenArgs.requestType=this.isEdit?"beforeOpenEditDialog":"beforeOpenAddDialog";var f={rowData:this.beforeOpenArgs.rowData,name:this.beforeOpenArgs.name,requestType:this.beforeOpenArgs.requestType,cancel:this.beforeOpenArgs.cancel};this.parent.trigger("actionBegin",sf.base.isBlazor()?f:this.beforeOpenArgs,(function(n){if(r.renderTabItems(),!n.cancel){s.selected=r.tabSelectedEvent.bind(r),s.height=r.parent.isAdaptive?"100%":"auto",s.overflowMode="Scrollable",r.tabObj=new sf.navigations.Tab(s),r.tabObj.isStringTemplate=!0,i=r.parent.createElement("div",{id:a.element.id+"_Tab"}),r.tabObj.appendTo(i),e.content=i,r.dialog=t,r.dialogObj=new sf.popups.Dialog(e),r.dialogObj.isStringTemplate=!0,r.dialogObj.appendTo(r.dialog);var o={action:"OpenDialog",requestType:r.isEdit?"openEditDialog":"openAddDialog",data:r.beforeOpenArgs.rowData,element:r.dialog,cancel:!1};sf.base.isBlazor()&&r.parent.updateDataArgs(o),r.parent.trigger("actionComplete",o,(function(e){e.cancel&&r.resetValues()}))}}))},e.prototype.tabSelectedEvent=function(e){var t=this.parent,i=e.selectedContent.childNodes[0].id;if(this.parent.isAdaptive&&this.responsiveTabContent(i,t),i===t.element.id+"ResourcesTabContainer"){var r=t.element.querySelector("#"+i).ej2_instances[0],a=this.ganttResources,s=r.getCurrentViewRecords();a&&a.length>0&&s.forEach((function(e,i){for(var s=0;s<a.length;s++)e.taskData[t.resourceFields.id]!==a[s][t.resourceFields.id]||sf.base.isNullOrUndefined(r.selectionModule)||-1!==r.getSelectedRowIndexes().indexOf(i)||r.selectRow(i)}))}else i===t.element.id+"NotesTabContainer"?t.element.querySelector("#"+i).ej2_instances[0].refresh():i===t.element.id+"SegmentsTabContainer"&&(sf.base.isNullOrUndefined(this.beforeOpenArgs.rowData.ganttProperties.startDate)?t.element.querySelector("#"+i).ej2_instances[0].enableToolbarItems([this.parent.element.id+"SegmentsTabContainer_add"],!1):t.element.querySelector("#"+i).ej2_instances[0].enableToolbarItems([this.parent.element.id+"SegmentsTabContainer_add"],!0))},e.prototype.responsiveTabContent=function(e,t){var i=document.getElementById(t.element.id+"_dialog_dialog-content"),r=i.clientHeight;r-=i.querySelector(".e-tab-header").offsetHeight;var a=document.querySelector("#"+e);if(a.classList.contains("e-grid")){r-=a.ej2_instances[0].getHeaderContent().offsetHeight;var s=a.querySelector(".e-toolbar");s&&(r-=s.offsetHeight)}a.parentElement.style.height=r+"px"},e.prototype.getFieldsModel=function(e){for(var t={},i=this.parent.columnByField,r=0;r<e.length;r++)if(e[r]!==this.parent.taskFields.dependency&&e[r]!==this.parent.taskFields.resourceInfo&&e[r]!==this.parent.taskFields.notes&&!sf.base.isNullOrUndefined(i[e[r]])){var a=e[r];this.createInputModel(i[a],t)}return t},e.prototype.createInputModel=function(e,t){var i=this,r=this.parent,a=this.parent.locale,s=this.parent.taskFields,n={placeholder:e.headerText,floatLabelType:"Auto"};switch(e.editType){case"booleanedit":var o={label:e.headerText,locale:a};t[e.field]=o;break;case"stringedit":var d=n;e.field!==r.columnMapping.duration&&e.field!==r.columnMapping.startDate&&e.field!==r.columnMapping.endDate||(d.change=function(t){i.validateScheduleFields(t,e,r)}),t[e.field]=n;break;case"numericedit":var l=n;s.progress===e.field&&(l.min=0,l.max=100),s.work===e.field&&(l.change=function(t){i.validateScheduleFields(t,e,r)}),t[e.field]=l;break;case"datepickeredit":var p=n;p.format=this.parent.getDateFormat(),p.strictMode=!0,p.firstDayOfWeek=r.timelineModule.customTimelineSettings.weekStartDay,e.field!==r.columnMapping.startDate&&e.field!==r.columnMapping.endDate||(p.renderDayCell=this.parent.renderWorkingDayCell.bind(this.parent),p.change=function(t){i.validateScheduleFields(t,e,r)}),t[e.field]=p;break;case"datetimepickeredit":var h=n;h.format=this.parent.getDateFormat(),h.strictMode=!0,h.firstDayOfWeek=r.timelineModule.customTimelineSettings.weekStartDay,e.field!==r.columnMapping.startDate&&e.field!==r.columnMapping.endDate||(h.renderDayCell=this.parent.renderWorkingDayCell.bind(this.parent),h.change=function(t){i.validateScheduleFields(t,e,r)}),t[e.field]=h;break;case"dropdownedit":if("taskType"===e.field||e.field===r.columnMapping.manual){n.dataSource=[{ID:1,Value:"FixedUnit"},{ID:2,Value:"FixedWork"},{ID:3,Value:"FixedDuration"}],n.fields={value:"Value"},n.change=function(t){e.field===s.manual&&(i.editedRecord.ganttProperties.isAutoSchedule=!t.value),i.validateScheduleFields(t,e,r)}}t[e.field]=n;break;case"maskededit":t[e.field]=n}return sf.base.isNullOrUndefined(e.edit)||sf.base.isNullOrUndefined(e.edit.params)||sf.base.extend(t[e.field],e.edit.params),t},e.prototype.validateScheduleFields=function(e,t,i){var r,a=i.editModule.dialogModule.dialog,s=null,n=i.editModule.dialogModule.editedRecord;sf.base.isNullOrUndefined(e.element)?sf.base.isNullOrUndefined(e.container)?sf.base.isNullOrUndefined(e.event.path[1])||(s=(r=e.event.path[1]).querySelector("input").getAttribute("id"),r=r.querySelector("#"+s)):(s=(r=e.container).querySelector("input").getAttribute("id"),r=r.querySelector("#"+s)):s=(r=e.element).getAttribute("id");var o=r.value,d=s.replace(i.element.id,"");if(0===d.search("Segments"))return d=d.replace("SegmentsTabContainer",""),this.validateSegmentFields(i,d,o,e),!0;this.validateScheduleValuesByCurrentField(d,o,this.editedRecord);var l=n.ganttProperties,p=i.taskFields;return sf.base.isNullOrUndefined(p.startDate)||this.updateScheduleFields(a,l,"startDate"),sf.base.isNullOrUndefined(p.endDate)||this.updateScheduleFields(a,l,"endDate"),sf.base.isNullOrUndefined(p.duration)||this.updateScheduleFields(a,l,"duration"),sf.base.isNullOrUndefined(p.work)||this.updateScheduleFields(a,l,"work"),this.dialogEditValidationFlag=!1,!0},e.prototype.updateScheduleFields=function(e,t,i){var r,a=this.parent,s=a.element.id,n=sf.base.getValue(i,a.columnMapping),o=a.columnByField[n],d=this.parent.taskFields;if("stringedit"===o.editType){var l=e.querySelector("#"+s+n).ej2_instances[0];r=sf.base.isNullOrUndefined(o.edit)||sf.base.isNullOrUndefined(o.edit.read)?sf.base.isNullOrUndefined(o.valueAccessor)?this.parent.dataOperation.getDurationString(t.duration,t.durationUnit):o.valueAccessor(n,a.editModule.dialogModule.editedRecord,o):o.edit.read(),l.value!==r.toString()&&d.duration===n?(l.value=r,l.dataBind()):d.startDate!==n&&d.endDate!==n||(l.value=d.startDate===n?t.startDate.toString():t.endDate.toString(),l.dataBind())}else if("datepickeredit"===o.editType||"datetimepickeredit"===o.editType){var p=(o.editType,e.querySelector("#"+s+n).ej2_instances[0]);r=t[i],(sf.base.isNullOrUndefined(p.value)&&!sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r)&&!sf.base.isNullOrUndefined(p.value)||p.value!==r&&!sf.base.isNullOrUndefined(p.value)&&!sf.base.isNullOrUndefined(r)&&p.value.toString()!==r.toString())&&(p.value=r,p.dataBind())}else if("numericedit"===o.editType){var h=e.querySelector("#"+s+n).ej2_instances[0];r=t[i],sf.base.isNullOrUndefined(r)||(h.value=r,h.dataBind())}},e.prototype.validateDuration=function(e){var t=e.ganttProperties;if(!this.dialogEditValidationFlag){sf.base.isNullOrUndefined(t.duration)?(this.parent.setRecordValue("endDate",null,t,!0),this.parent.setRecordValue("isMilestone",!1,t,!0)):r(t)||!sf.base.isNullOrUndefined(t.startDate)?(e.ganttProperties.isMilestone&&0!==e.ganttProperties.duration&&this.parent.dateValidationModule.calculateStartDate(e),this.parent.dateValidationModule.calculateEndDate(e)):r(t)||sf.base.isNullOrUndefined(t.endDate)||this.parent.dateValidationModule.calculateStartDate(e);var i=0===t.duration;this.parent.setRecordValue("isMilestone",i,t,!0),this.dialogEditValidationFlag=!0}},e.prototype.validateStartDate=function(e){var t=e.ganttProperties,i=this.parent.taskFields;this.dialogEditValidationFlag||(sf.base.isNullOrUndefined(t.startDate)?(this.parent.setRecordValue("duration",null,t,!0),this.parent.setRecordValue("isMilestone",!1,t,!0),this.parent.allowUnscheduledTasks&&sf.base.isNullOrUndefined(i.endDate)&&this.parent.setRecordValue("endDate",null,t,!0)):r(t)?sf.base.isNullOrUndefined(i.duration)?this.parent.dateValidationModule.calculateDuration(e):(sf.base.isNullOrUndefined(i.endDate),this.parent.dateValidationModule.calculateEndDate(e)):sf.base.isNullOrUndefined(t.endDate)?sf.base.isNullOrUndefined(t.duration)||this.parent.dateValidationModule.calculateEndDate(e):this.parent.dateValidationModule.calculateDuration(e),this.dialogEditValidationFlag=!0)},e.prototype.validateEndDate=function(e){var t=e.ganttProperties,i=this.parent.taskFields;this.dialogEditValidationFlag||(sf.base.isNullOrUndefined(t.endDate)?(this.parent.setRecordValue("duration",null,t,!0),this.parent.setRecordValue("isMilestone",!1,t,!0)):r(t)?sf.base.isNullOrUndefined(i.duration)?this.parent.dateValidationModule.calculateDuration(e):sf.base.isNullOrUndefined(t.startDate)?this.parent.dateValidationModule.calculateStartDate(e):(!sf.base.isNullOrUndefined(t.segments)&&t.segments.length>0&&(t.segments=this.parent.editModule.cellEditModule.validateEndDateWithSegments(t)),this.parent.dateValidationModule.calculateDuration(e)):sf.base.isNullOrUndefined(t.duration)?sf.base.isNullOrUndefined(t.startDate)||this.parent.dateValidationModule.calculateDuration(e):this.parent.dateValidationModule.calculateStartDate(e),this.dialogEditValidationFlag=!0)},e.prototype.validateScheduleValuesByCurrentField=function(e,t,i){var r=this.parent,a=i.ganttProperties,s=r.taskFields;if(s.duration===e&&(sf.base.isNullOrUndefined(t)||""===t?r.allowUnscheduledTasks&&this.parent.setRecordValue("duration",null,a,!0):r.dataOperation.updateDurationValue(t,a),this.validateDuration(i),this.parent.editModule.updateResourceRelatedFields(i,"duration")),s.startDate===e){if(""!==t){var n=this.parent.dateValidationModule.getDateFromFormat(t);n=this.parent.dateValidationModule.checkStartDate(n,a),this.parent.setRecordValue("startDate",n,a,!0)}else r.allowUnscheduledTasks&&!i.hasChildRecords&&this.parent.setRecordValue("startDate",null,a,!0);this.validateStartDate(i)}if(s.endDate===e){if(""!==t){var o=this.parent.dateValidationModule.getDateFromFormat(t);0===o.getHours()&&86400!==r.defaultEndTime&&this.parent.dateValidationModule.setTime(r.defaultEndTime,o),o=this.parent.dateValidationModule.checkEndDate(o,a),(sf.base.isNullOrUndefined(a.startDate)||o.getTime()>a.startDate.getTime())&&this.parent.setRecordValue("endDate",o,a,!0)}else r.allowUnscheduledTasks&&this.parent.setRecordValue("endDate",null,a,!0);this.validateEndDate(i)}return s.work===e&&(sf.base.isNullOrUndefined(t)||""===t||(this.parent.setRecordValue("work",t,a,!0),this.parent.editModule.updateResourceRelatedFields(i,"work"),this.validateDuration(i))),"taskType"===e&&this.parent.setRecordValue("taskType",t,a,!0),s.manual===e&&this.parent.editModule.updateTaskScheduleModes(i),!0},e.prototype.getSegmentsModel=function(e){var t=this,i=this.parent.taskFields;(sf.base.isNullOrUndefined(e)||0===e.length)&&(e=[],sf.base.isNullOrUndefined(i.startDate)||e.push("startDate"),sf.base.isNullOrUndefined(i.endDate)||e.push("endDate"),sf.base.isNullOrUndefined(i.duration)||e.push("duration"));var r={editSettings:{allowEditing:!0,allowAdding:!0,allowDeleting:!0,mode:"Normal",newRowPosition:"Bottom"}};r.locale=this.parent.locale,r.dataSource=[],r.rowHeight=this.parent.isAdaptive?48:null,r.toolbar=[{id:this.parent.element.id+"SegmentsTabContainer_add",prefixIcon:"e-add",tooltipText:this.localeObj.getConstant("add"),align:"Right",text:this.parent.isAdaptive?"":this.localeObj.getConstant("add")},{id:this.parent.element.id+"SegmentsTabContainer_delete",prefixIcon:"e-delete",tooltipText:this.localeObj.getConstant("delete"),align:"Right",text:this.parent.isAdaptive?"":this.localeObj.getConstant("delete")}];for(var a=[],s=function(i){var r={};switch(e[i]){case"startDate":case"endDate":r={field:e[i],headerText:n.localeObj.getConstant(e[i]),editType:"stringedit",width:"200px",edit:{write:function(r){var a=t.beforeOpenArgs.General[t.parent.taskFields[e[i]]],s=r.rowData[r.column.field];sf.base.setValue("value",s,a),new sf.calendars.DatePicker(a).appendTo(r.element)},read:function(e){return e.ej2_instances[0].value}},format:n.parent.getDateFormat()},"startDate"===e[i]&&(r.validationRules={required:!0}),a.push(r);break;case"duration":r={field:e[i],headerText:n.localeObj.getConstant(e[i]),editType:"stringedit",width:"100px",edit:{write:function(r){var a=t.beforeOpenArgs.General[t.parent.taskFields[e[i]]];a.floatLabelType="Never";var s=r.rowData[r.column.field];sf.base.isNullOrUndefined(s)?sf.base.setValue("value",null,a):sf.base.setValue("value",s,a),sf.base.setValue("value",s,a),new sf.inputs.TextBox(a).appendTo(r.element)},read:function(e){return e.ej2_instances[0].value.toString()}}},a.push(r)}},n=this,o=0;o<e.length;o++)s(o);return r.columns=a,r.height=this.parent.isAdaptive?"100%":"153px",r},e.prototype.getGridColumnByField=function(e,t){for(var i,r=0;r<t.length;r++)t[r].field===e&&(i=t[r]);return i},e.prototype.updateSegmentField=function(e,t,i){var r,a,s=this.parent.editModule.dialogModule.dialog,n=sf.base.getValue("Segments",this.beforeOpenArgs),o=this.getGridColumnByField(e,n.columns),d=this.parent.element.id;r=i[e],("stringedit"===o.editType||"datepickeredit"===o.editType)&&(a=s.querySelector("#"+d+"SegmentsTabContainer"+e).ej2_instances[0]),a.value!==r.toString()&&(a.value=r,a.dataBind())},e.prototype.validateSegmentFields=function(e,t,i,r){var a=this.parent.taskFields;if(!sf.base.isNullOrUndefined(a.duration)&&a.duration.toLowerCase()===t.toLowerCase()&&!sf.base.isNullOrUndefined(i)&&""!==i){this.selectedSegment.duration=Number(i);var s=e.dataOperation.getEndDate(this.selectedSegment.startDate,Number(i),this.editedRecord.ganttProperties.durationUnit,this.editedRecord.ganttProperties,!1);s=e.dataOperation.checkEndDate(s,this.editedRecord.ganttProperties,!1),this.selectedSegment.endDate=s}if(!sf.base.isNullOrUndefined(a.startDate)&&a.startDate.toLowerCase()===t.toLowerCase()&&""!==i){var n=this.parent.dateValidationModule.getDateFromFormat(i);n=this.parent.dateValidationModule.checkStartDate(n),this.selectedSegment.startDate=n,sf.base.isNullOrUndefined(a.endDate)||(this.selectedSegment.endDate=this.parent.dataOperation.getEndDate(n,this.selectedSegment.duration,this.editedRecord.ganttProperties.durationUnit,this.editedRecord.ganttProperties,!1))}sf.base.isNullOrUndefined(a.endDate)||a.endDate.toLowerCase()!==t.toLowerCase()||""!==i&&(0===(s=this.parent.dateValidationModule.getDateFromFormat(i)).getHours()&&86400!==e.defaultEndTime&&this.parent.dateValidationModule.setTime(e.defaultEndTime,s),s=this.parent.dateValidationModule.checkEndDate(s,this.editedRecord.ganttProperties),this.selectedSegment.endDate=s,this.selectedSegment.duration=this.parent.dataOperation.getDuration(this.selectedSegment.startDate,this.selectedSegment.endDate,this.editedRecord.ganttProperties.durationUnit,!0,!1,!0));sf.base.isNullOrUndefined(a.startDate)||this.updateSegmentField("startDate",r,this.selectedSegment),sf.base.isNullOrUndefined(a.endDate)||this.updateSegmentField("endDate",r,this.selectedSegment),sf.base.isNullOrUndefined(a.duration)||this.updateSegmentField("duration",r,this.selectedSegment)},e.prototype.getPredecessorModel=function(e){(sf.base.isNullOrUndefined(e)||0===e.length)&&(e=["ID","Name","Type","Offset","UniqueId"]);var t={editSettings:{allowEditing:!0,allowAdding:!0,allowDeleting:!0,mode:"Normal"}};t.locale=this.parent.locale,t.dataSource=[],t.rowHeight=this.parent.isAdaptive?48:null,t.toolbar=[{id:this.parent.element.id+"DependencyTabContainer_add",prefixIcon:"e-add",tooltipText:this.localeObj.getConstant("add"),align:"Right",text:this.parent.isAdaptive?"":this.localeObj.getConstant("add")},{id:this.parent.element.id+"DependencyTabContainer_delete",prefixIcon:"e-delete",tooltipText:this.localeObj.getConstant("delete"),align:"Right",text:this.parent.isAdaptive?"":this.localeObj.getConstant("delete")}];for(var i=[],r=0;r<e.length;r++){var a={};"id"===e[r].toLowerCase()?(a={field:"id",headerText:this.localeObj.getConstant("id"),allowEditing:!1,width:"70px"},i.push(a)):"name"===e[r].toLowerCase()?(a={field:"name",headerText:this.localeObj.getConstant("name"),editType:"stringedit",width:"250px",validationRules:{required:!0}},i.push(a)):"type"===e[r].toLowerCase()?(a={field:"type",headerText:this.localeObj.getConstant("type"),editType:"dropdownedit",dataSource:this.types,foreignKeyField:"id",foreignKeyValue:"text",defaultValue:"FS",validationRules:{required:!0},width:"150px"},i.push(a)):"offset"===e[r].toLowerCase()?(a={field:"offset",headerText:this.localeObj.getConstant("offset"),editType:"stringedit",defaultValue:this.parent.dataOperation.getDurationString(0,this.beforeOpenArgs.rowData.ganttProperties.durationUnit),validationRules:{required:!0},width:"100px"},i.push(a)):"uniqueid"===e[r].toLowerCase()&&(a={field:"uniqueId",isPrimaryKey:!0,visible:!1,defaultValue:c().toString()},i.push(a))}return t.columns=i,t.height=this.parent.isAdaptive?"100%":"153px",t},e.prototype.getResourcesModel=function(e){var t=this.parent.resourceFields;(sf.base.isNullOrUndefined(e)||0===e.length)&&(e=[t.id,t.name,t.unit,t.group]);for(var i={allowFiltering:!0,treeColumnIndex:-1,childMapping:"",editSettings:{allowEditing:!0,mode:"Cell"},locale:this.parent.locale,allowSelection:!0,rowHeight:this.parent.isAdaptive?48:null,filterSettings:{type:"Menu"},selectionSettings:{checkboxOnly:!0,checkboxMode:"Default",persistSelection:!0,type:"Multiple"}},r=[{type:"checkbox",allowEditing:!1,allowSorting:!1,allowFiltering:!1,width:60}],a=0;a<e.length;a++){var s={};e[a]===t.id?(s={field:t.id,headerText:this.localeObj.getConstant("id"),isPrimaryKey:!0,width:"100px",allowEditing:!1},r.push(s)):e[a]===t.name?(s={field:t.name,headerText:this.localeObj.getConstant("name"),allowEditing:!1},r.push(s)):e[a]===t.unit?(s={field:t.unit,headerText:this.localeObj.getConstant("unit"),editType:"numericedit",edit:{params:{min:0}}},r.push(s)):e[a]!==t.group||sf.base.isNullOrUndefined(t.group)||(s={field:t.group,headerText:this.localeObj.getConstant("group"),allowEditing:!1},r.push(s))}return i.columns=r,i.height=this.parent.isAdaptive?"100%":"196px",i},e.prototype.getNotesModel=function(e){return(sf.base.isNullOrUndefined(e)||0===e.length)&&(e=["Bold","Italic","Underline","StrikeThrough","FontName","FontSize","FontColor","BackgroundColor","LowerCase","UpperCase","|","Alignments","OrderedList","UnorderedList","Outdent","Indent","|","CreateTable","CreateLink","|","ClearFormat","Print","|","Undo","Redo"]),{placeholder:this.localeObj.getConstant("writeNotes"),toolbarSettings:{items:e},height:this.parent.isAdaptive?"100%":"auto",locale:this.parent.locale}},e.prototype.createDivElement=function(e,t){return sf.base.createElement("div",{className:e,id:t})},e.prototype.createInputElement=function(e,t,i,r){return sf.base.createElement(r||"input",{className:e,attrs:{type:"text",id:t,name:i,title:i}})},e.prototype.renderTabItems=function(){for(var e=this.beforeOpenArgs.tabModel.items,t=0,i=0;i<e.length;i++){var r=e[i];r.content instanceof HTMLElement||("General"===r.content?r.content=this.renderGeneralTab(r.content):"Dependency"===r.content?(this.editedRecord.hasChildRecords&&(r.disabled=!0),r.content=this.renderPredecessorTab(r.content)):"Resources"===r.content?r.content=this.renderResourceTab(r.content):r.content==="Custom"+t?(r.content=this.renderCustomTab(r.content),t++):"Notes"===r.content?r.content=this.renderNotesTab(r.content):"Segments"===r.content&&(this.editedRecord.hasChildRecords&&(r.disabled=!0),r.content=this.renderSegmentsTab(r.content)))}},e.prototype.segmentGridActionBegin=function(e){var t=this.parent.taskFields,i=this.beforeOpenArgs.Segments;if("add"===e.requestType||"beginEdit"===e.requestType||"save"===e.requestType){e.requestType;var r=i.dataSource,a=sf.base.getValue("rowData",e),s=this.beforeOpenArgs.rowData.ganttProperties.startDate;if(!sf.base.isNullOrUndefined(s)&&"add"===e.requestType){var n,o=sf.base.getValue("startDate",a),d=sf.base.getValue("endDate",a),l=(sf.base.getValue("duration",a),!sf.base.isNullOrUndefined(r)&&r.length>0?sf.base.isNullOrUndefined(t.endDate)?new Date(sf.base.getValue("startDate",r[0]).getTime()):new Date(sf.base.getValue("endDate",r[0]).getTime()):!sf.base.isNullOrUndefined(this.beforeOpenArgs.rowData.ganttProperties.startDate)&&new Date(this.beforeOpenArgs.rowData.ganttProperties.startDate.getTime()));l.setHours(0,0,0,0),!sf.base.isNullOrUndefined(r)&&r.length>0&&l.setDate(l.getDate()+2),o=this.parent.dataOperation.checkStartDate(l),0===(d=this.parent.dateValidationModule.getDateFromFormat(o)).getHours()&&86400!==this.parent.defaultEndTime&&this.parent.dateValidationModule.setTime(this.parent.defaultEndTime,d),n={startDate:o,endDate:d=!sf.base.isNullOrUndefined(t.endDate)&&!sf.base.isNullOrUndefined(r)&&r.length<=0?this.beforeOpenArgs.rowData.ganttProperties.endDate:d,duration:!sf.base.isNullOrUndefined(t.duration)&&!sf.base.isNullOrUndefined(r)&&r.length<=0?this.beforeOpenArgs.rowData.ganttProperties.duration:1},e.rowData=n}this.selectedSegment=e.rowData}},e.prototype.renderSegmentsTab=function(e){var t=this.parent,i=this.beforeOpenArgs[e],r=this.beforeOpenArgs.rowData,a=[];this.isEdit&&(a=sf.base.isNullOrUndefined(r.ganttProperties.segments)?[]:r.ganttProperties.segments),i.dataSource=a,i.actionBegin=this.segmentGridActionBegin.bind(this),sf.grids.Grid.Inject(sf.grids.Edit,sf.grids.Page,sf.grids.Toolbar,sf.grids.ForeignKey);var s=new sf.grids.Grid(i),n=this.createDivElement("",t.element.id+""+e+"TabContainer");return s.appendTo(n),n},e.prototype.renderGeneralTab=function(e){for(var t=this.parent,i=this.beforeOpenArgs[e],r=this.createDivElement("e-edit-form-row",t.element.id+""+e+"TabContainer"),a=0,s=Object.keys(i);a<s.length;a++){var n=s[a];if(!1!==this.parent.columnByField[n].visible){var o=this.parent.columnByField[n],d=i[n];r.appendChild(this.renderInputElements(d,o))}}return r},e.prototype.isCheckIsDisabled=function(e){var t=!1;return(!1===e.allowEditing||e.isPrimaryKey||this.parent.readOnly)&&(-1!==this.parent.customColumns.indexOf(e.field)?t=!0:e.field!==this.parent.taskFields.id&&e.field!==this.parent.taskFields.name&&e.field!==this.parent.taskFields.duration&&e.field!==this.parent.taskFields.progress&&e.field!==this.parent.taskFields.startDate&&e.field!==this.parent.taskFields.endDate&&e.field!==this.parent.taskFields.baselineStartDate&&e.field!==this.parent.taskFields.baselineEndDate&&e.field!==this.parent.taskFields.work&&"taskType"!==e.field||(t=!0)),this.isEdit&&(e.field===this.parent.taskFields.id&&(t=!0),this.editedRecord.hasChildRecords&&(e.field!==this.parent.taskFields.endDate&&e.field!==this.parent.taskFields.duration&&e.field!==this.parent.taskFields.progress&&e.field!==this.parent.taskFields.work&&"taskType"!==e.field||(t=!0))),t},e.prototype.renderPredecessorTab=function(e){var t=this,i=this.parent,r=this.beforeOpenArgs[e],a=this.parent.columnByField[this.parent.taskFields.dependency];(!1===a.allowEditing||a.isPrimaryKey||this.parent.readOnly)&&(r.editSettings.allowEditing=!1,r.editSettings.allowAdding=!1,r.editSettings.allowDeleting=!1);var s=this.beforeOpenArgs.rowData,n=[];this.taskNameCollection(),this.isEdit&&(n=this.predecessorEditCollection(s),this.updatePredecessorDropDownData(s)),r.dataSource=n,r.actionBegin=this.gridActionBegin.bind(this),r.columns[1].edit={write:function(e){"add"===sf.base.getValue("requestType",e)&&sf.base.setValue("rowData.uniqueId",c(),e);new sf.dropdowns.ComboBox({dataSource:new sf.data.DataManager(t.idCollection),popupHeight:"180px",allowCustom:!1,fields:{value:"text"},value:e.rowData.name,change:function(e){var i=sf.base.closest(e.element,"tr").querySelector("#"+t.parent.element.id+"DependencyTabContainerid");i&&(sf.base.isNullOrUndefined(e.itemData)||sf.base.isNullOrUndefined(e.item)?i.value="":i.value=e.itemData.id)},autofill:!0}).appendTo(e.element)},read:function(e){return e.ej2_instances[0].value}},sf.grids.Grid.Inject(sf.grids.Edit,sf.grids.Page,sf.grids.Toolbar,sf.grids.ForeignKey);var o=new sf.grids.Grid(r),d=this.createDivElement("e-dependent-div",i.element.id+""+e+"TabContainer");return o.appendTo(d),d},e.prototype.gridActionBegin=function(e){var t=this,i=this.beforeOpenArgs.Dependency;if("add"===e.requestType||"beginEdit"===e.requestType){var r="add"!==e.requestType;this.idCollection=sf.base.extend([],[],this.preTableCollection,!0);for(var a=i.dataSource,s=function(i){n.idCollection.forEach((function(s,n){if(s.id===sf.base.getValue("id",a[i])){var o=sf.base.getValue("rowData",e);if(r&&sf.base.getValue("id",o)===s.id)return;t.idCollection.splice(t.idCollection.indexOf(s),1)}}))},n=this,o=0;o<=a.length;o++)s(o)}},e.prototype.updateResourceCollection=function(e,t){if(!sf.base.isNullOrUndefined(e.data)&&Object.keys(e.data).length){var i=this.parent.element.querySelector("#"+t).ej2_instances[0];if(!sf.base.isNullOrUndefined(i)&&i.getSelectedRecords().length>0){var r=i.getSelectedRecords(),a=void 0,s=[];for(a=0;a<r.length;a++)s.push(r[a].taskData);this.ganttResources=sf.base.extend([],s)}else this.ganttResources=[]}else this.ganttResources=[]},e.prototype.renderResourceTab=function(e){var t=this,i=this.parent,r=i.resourceFields,a=this.beforeOpenArgs.rowData,s=a.ganttProperties.resourceInfo,n=this.beforeOpenArgs[e],o=i.element.id+""+e+"TabContainer",d=sf.base.extend([],[],i.resources,!0);if(this.parent.dataOperation.updateResourceUnit(d),!sf.base.isNullOrUndefined(s)){var l=void 0,p=s.length,h=void 0,c=d.length;for(l=0;l<p;l++)for(h=0;h<c;h++)s[l][r.id]===d[h][r.id]&&(d[h][r.unit]=s[l][r.unit])}n.dataSource=d;var u=a.ganttProperties.resourceInfo;if(this.isEdit&&!sf.base.isNullOrUndefined(u))for(var f=0;f<u.length;f++)this.ganttResources.push(u[f]);n.rowSelected=function(e){t.updateResourceCollection(e,o)},n.rowDeselected=function(e){t.updateResourceCollection(e,o)};var g=this.createDivElement("e-resource-div",o);sf.treegrid.TreeGrid.Inject(sf.treegrid.Selection,sf.treegrid.Filter,sf.treegrid.Edit,sf.treegrid.VirtualScroll);var m=new sf.treegrid.TreeGrid(n),y=this.parent.columnByField[this.parent.taskFields.resourceInfo];return(!1===y.allowEditing||y.isPrimaryKey||this.parent.readOnly)&&(m.allowSelection=!1,m.allowFiltering=!1,m.editSettings.allowEditing=!1),m.appendTo(g),g},e.prototype.renderCustomTab=function(e){return this.renderGeneralTab(e)},e.prototype.renderNotesTab=function(e){var t=this.parent,i=this.beforeOpenArgs[e],r=this.editedRecord.ganttProperties,a=this.createDivElement("",t.element.id+""+e+"TabContainer");sf.richtexteditor.RichTextEditor.Inject(sf.richtexteditor.Toolbar,sf.richtexteditor.Link,sf.richtexteditor.HtmlEditor,sf.richtexteditor.QuickToolbar,sf.richtexteditor.Count),i.value=r.notes;var s=this.parent.columnByField[this.parent.taskFields.notes];return(!1===s.allowEditing||s.isPrimaryKey||this.parent.readOnly)&&(i.enabled=!1),new sf.richtexteditor.RichTextEditor(i).appendTo(a),a},e.prototype.renderInputElements=function(e,t){var i,r=this,a=this.parent.element.id,s=this.editedRecord,n=this.createDivElement("e-edit-form-column"),o={column:t,data:s};if(!sf.base.isNullOrUndefined(t.edit)&&sf.base.isNullOrUndefined(t.edit.params)){var d=t.edit.create;(i="string"==typeof d?(d=sf.grids.getObject(d,window))(o):t.edit.create(o)).className="",i.setAttribute("type","text"),i.setAttribute("id",a+""+t.field),i.setAttribute("name",t.field),i.setAttribute("title",t.field),n.appendChild(i)}else i=this.createInputElement("",a+""+t.field,t.field),n.appendChild(i);if(e.enabled=!this.isCheckIsDisabled(t),t.field===this.parent.taskFields.duration)if(sf.base.isNullOrUndefined(t.valueAccessor)){if(sf.base.isNullOrUndefined(t.edit)){var l=s.ganttProperties;e.value=this.parent.dataOperation.getDurationString(l.duration,l.durationUnit)}}else e.value=t.valueAccessor(t.field,s,t);else"booleanedit"===t.editType?!0===s[t.field]?e.checked=!0:e.checked=!1:e.value=s[t.field];if(!sf.base.isNullOrUndefined(t.edit)&&sf.base.isNullOrUndefined(t.edit.params)){var p=t.edit.write,h=void 0;h="string"==typeof p?(p=sf.grids.getObject(p,window))({column:t,rowData:s,element:i}):t.edit.write({column:t,rowData:s,element:i}),t.field===this.parent.taskFields.duration&&(h.change=function(e){r.validateScheduleFields(e,t,r.parent)})}else{(h=new this.inputs[t.editType](e)).appendTo(i)}return n},e.prototype.taskNameCollection=function(){var e=this.parent.flatData;this.preTaskIds=[],this.preTableCollection=[];for(var t=0;t<e.length;t++){var i=e[t];if(!i.hasChildRecords){var r="ResourceView"===this.parent.viewType?i.ganttProperties.taskId.toString():i.ganttProperties.rowUniqueID.toString(),a={id:r,text:r+"-"+i.ganttProperties.taskName,value:r};this.preTaskIds.push(a.id),this.preTableCollection.push(a)}}},e.prototype.predecessorEditCollection=function(e){var t=[],i=e.ganttProperties;if(this.isEdit&&!sf.base.isNullOrUndefined(this.parent.taskFields.dependency)&&!sf.base.isNullOrUndefined(e)&&!sf.base.isNullOrUndefined(i.predecessor))for(var r=i.predecessor,a=this.preTableCollection,s=0;s<r.length;s++){var n=r[s].from.toString(),o={};if(("ResourceView"===this.parent.viewType?i.taskId:i.rowUniqueID).toString()!==n){o.id=n;for(var d=0;d<a.length;d++)if(a[d].value===n){o.name=a[d].text;break}o.type=r[s].type;var l=r[s].offset,p=r[s].offsetUnit;o.offset=this.parent.dataOperation.getDurationString(l,p),o.uniqueId=c(),t.push(o)}}return t},e.prototype.updatePredecessorDropDownData=function(e){var t,i="ResourceView"===this.parent.viewType?e.ganttProperties.taskId.toString():e.ganttProperties.rowUniqueID.toString();t=this.preTaskIds.indexOf(i),this.preTableCollection.splice(t,1),this.preTaskIds.splice(t,1),this.validSuccessorTasks(e,this.preTaskIds,this.preTableCollection)},e.prototype.validSuccessorTasks=function(e,t,i){var r=this,a=e.ganttProperties;if(a.predecessor&&a.predecessor.length>0){var s=a.predecessor,n="ResourceView"===this.parent.viewType?a.taskId.toString():a.rowUniqueID.toString();s.forEach((function(e){if(e.from.toString()===n){var a,s=e.to;(a=t.indexOf(s))>-1&&(t.splice(a,1),i.splice(a,1));var o=r.parent.connectorLineModule.getRecordByID(s);r.validSuccessorTasks(o,t,i)}}))}},e.prototype.getPredecessorType=function(){var e=[this.parent.getPredecessorTextValue("SS"),this.parent.getPredecessorTextValue("SF"),this.parent.getPredecessorTextValue("FS"),this.parent.getPredecessorTextValue("FF")];return[{id:"FS",text:e[2],value:e[2]},{id:"FF",text:e[3],value:e[3]},{id:"SS",text:e[0],value:e[0]},{id:"SF",text:e[1],value:e[1]}]},e.prototype.initiateDialogSave=function(){this.isEdit?this.parent.initiateEditAction(!0):this.addedRecord={};for(var e=this.parent,t=this.beforeOpenArgs.tabModel.items,i=0;i<t.length;i++){var r=t[i].content,a=r.id;sf.base.isNullOrUndefined(a)&&""===a||("General"===(a=(a=a.replace(e.element.id,"")).replace("TabContainer",""))?this.updateGeneralTab(r,!1):"Dependency"===a?this.updatePredecessorTab(r):"Notes"===a?this.updateNotesTab(r):"Resources"===a?this.updateResourceTab(r):-1!==a.indexOf("Custom")?this.updateCustomTab(r):"Segments"===a&&this.updateSegmentsData(r,this.beforeOpenArgs.rowData))}if(this.isEdit){this.parent.dataOperation.updateWidthLeft(this.rowData);var s={data:this.rowData,action:"DialogEditing"};this.parent.editModule.initiateUpdateAction(s)}else if("ResourceView"===this.parent.viewType){var n=sf.base.extend({},this.addedRecord,!0);if(n[this.parent.taskFields.resourceInfo].length)for(i=0;i<n[this.parent.taskFields.resourceInfo].length;i++){a=n[this.parent.taskFields.resourceInfo][i].toString();var o=this.parent.getTaskIds().indexOf("R"+a.toString());if(-1!==o){this.parent.editModule.addRecord(this.addedRecord,"Child",o);break}}else this.parent.editModule.addRecord(this.addedRecord,"Bottom")}else this.parent.editModule.addRecord(this.addedRecord,this.parent.editSettings.newRowPosition);return!0},e.prototype.updateSegmentTaskData=function(e){for(var t=[],i=this.parent.taskFields,r=0;r<e.length;r++){var a={};sf.base.isNullOrUndefined(i.startDate)||(a[this.parent.taskFields.startDate]=e[r].startDate),sf.base.isNullOrUndefined(i.endDate)||(a[this.parent.taskFields.endDate]=e[r].endDate),sf.base.isNullOrUndefined(i.duration)||(a[this.parent.taskFields.duration]=Number(e[r].duration),e[r].duration=a[this.parent.taskFields.duration]),t.push(a)}this.isEdit?(this.rowData.ganttProperties.segments=e,this.parent.setRecordValue("segments",this.parent.dataOperation.setSegmentsInfo(this.rowData,!1),this.rowData.ganttProperties,!0),this.parent.setRecordValue("taskData."+this.parent.taskFields.segments,t,this.rowData)):this.addedRecord[i.segments]=t},e.prototype.updateSegmentsData=function(e,t){var i=e.ej2_instances[0];i.isEdit&&i.endEdit();var r=i.currentViewData;this.updateSegmentTaskData(r)},e.prototype.updateGeneralTab=function(e,t){var i=this.parent,r=e.childNodes,a={};this.isEdit||(a=this.addedRecord);for(var s=0;s<r.length;s++){var n=r[s],o=n.querySelector('input[id^="'+i.element.id+'"]');if(o){var d=o.id.replace(i.element.id,""),l=n.querySelector("#"+i.element.id+d).ej2_instances[0],p=i.columnByField[d];if(!sf.base.isNullOrUndefined(p.edit)&&sf.base.isNullOrUndefined(p.edit.params)){var h=p.edit.read;"string"==typeof h?(h=sf.grids.getObject(h,window),a[d]=h(o,l.value)):a[d]=p.edit.read(o,l.value)}else t&&"booleanedit"===p.editType?!0===o.checked?a[d]=!0:a[d]=!1:a[d]=l.value}}this.isEdit&&(this.updateScheduleProperties(this.editedRecord,this.rowData),i.editModule.validateUpdateValues(a,this.rowData,!0))},e.prototype.updateScheduleProperties=function(e,t){this.parent.setRecordValue("startDate",e.ganttProperties.startDate,t.ganttProperties,!0),this.parent.setRecordValue("endDate",e.ganttProperties.endDate,t.ganttProperties,!0),this.parent.setRecordValue("duration",e.ganttProperties.duration,t.ganttProperties,!0),this.parent.setRecordValue("durationUnit",e.ganttProperties.durationUnit,t.ganttProperties,!0),this.parent.setRecordValue("work",e.ganttProperties.work,t.ganttProperties,!0),sf.base.isNullOrUndefined(this.parent.taskFields.startDate)||this.parent.dataOperation.updateMappingData(this.rowData,this.parent.taskFields.startDate),sf.base.isNullOrUndefined(this.parent.taskFields.endDate)||this.parent.dataOperation.updateMappingData(this.rowData,this.parent.taskFields.endDate),sf.base.isNullOrUndefined(this.parent.taskFields.duration)||(this.parent.dataOperation.updateMappingData(this.rowData,this.parent.taskFields.duration),this.parent.setRecordValue("durationUnit",e.ganttProperties.durationUnit,this.rowData,!0),0===this.rowData.ganttProperties.duration?this.parent.setRecordValue("isMilestone",!0,this.rowData.ganttProperties,!0):this.parent.setRecordValue("isMilestone",!1,this.rowData.ganttProperties,!0)),sf.base.isNullOrUndefined(this.parent.taskFields.work)||this.parent.dataOperation.updateMappingData(this.rowData,this.parent.taskFields.work),sf.base.isNullOrUndefined(this.parent.taskFields.manual)||this.parent.dataOperation.updateMappingData(this.rowData,this.parent.taskFields.manual)},e.prototype.updatePredecessorTab=function(e){var t=e.ej2_instances[0];t.isEdit&&t.endEdit();for(var i=t.dataSource,r=[],a=[],s="",n=[],o=0;o<i.length;o++){var d=i[o],l=d.name.split("-")[0];if(d.id!==l&&(d.id=l),-1===n.indexOf(d.id)){var p=d.id+d.type;d.offset&&-1!==d.offset.indexOf("-")?p+=d.offset:p+="+"+d.offset,r.push(p),n.push(d.id)}}this.isEdit?(r.length>0?(a=this.parent.predecessorModule.calculatePredecessor(r.join(","),this.rowData),this.parent.setRecordValue("predecessor",a,this.rowData.ganttProperties,!0),s=this.parent.predecessorModule.getPredecessorStringValue(this.rowData)):(a=[],this.parent.setRecordValue("predecessor",a,this.rowData.ganttProperties,!0),s=""),this.parent.setRecordValue("predecessorsName",s,this.rowData.ganttProperties,!0),this.parent.setRecordValue("taskData."+this.parent.taskFields.dependency,s,this.rowData),this.parent.setRecordValue(this.parent.taskFields.dependency,s,this.rowData),this.parent.predecessorModule.updateUnscheduledDependency(this.rowData)):this.addedRecord[this.parent.taskFields.dependency]=r.length>0?r.join(","):""},e.prototype.updateResourceTab=function(e){var t=e.ej2_instances[0];t&&t.grid.endEdit();var i=this.ganttResources;"ResourceView"!==this.parent.viewType||sf.base.isNullOrUndefined(this.rowData.ganttProperties)||(JSON.stringify(this.ganttResources)!==JSON.stringify(this.rowData.ganttProperties.resourceInfo)?(this.isResourceUpdate=!0,this.previousResource=sf.base.isNullOrUndefined(this.rowData.ganttProperties.resourceInfo)?[]:this.rowData.ganttProperties.resourceInfo.slice()):this.isResourceUpdate=!1);var r=[];if(this.isEdit)this.parent.setRecordValue("resourceInfo",i,this.rowData.ganttProperties,!0),this.parent.dataOperation.updateMappingData(this.rowData,"resourceInfo"),this.parent.editModule.updateResourceRelatedFields(this.rowData,"resource"),this.validateDuration(this.rowData);else{for(var a=0;a<i.length;a++)r.push(i[a][this.parent.resourceFields.id]),this.isAddNewResource=!0;this.addedRecord[this.parent.taskFields.resourceInfo]=r}},e.prototype.updateNotesTab=function(e){var t=this.parent,i=e.ej2_instances[0];this.isEdit?(this.parent.setRecordValue("notes",i.getHtml(),this.rowData.ganttProperties,!0),t.dataOperation.updateMappingData(this.rowData,"notes")):this.addedRecord[this.parent.taskFields.notes]=i.getHtml()},e.prototype.updateCustomTab=function(e){this.updateGeneralTab(e,!0)},e}(),vt=function(){function e(e){this.validationPredecessor=null,this.confirmPredecessorDialog=null,this.predecessorIndex=null,this.childRecord=null,this.parent=e,this.dateValidateModule=this.parent.dateValidationModule,this.parent.on("initPredessorDialog",this.initPredecessorValidationDialog,this)}return e.prototype.updateConnectorLineEditElement=function(e){var t=this.getConnectorLineHoverElement(e.target);sf.base.getValue("editModule.taskbarEditModule.taskBarEditAction",this.parent)||this.highlightConnectorLineElements(t)},e.prototype.getConnectorLineHoverElement=function(e){var i=t(e,"e-line"),r=t(e,"e-connector-line-right-arrow"),a=t(e,"e-connector-line-left-arrow");return i||r||a?t(e,"e-connector-line-container"):null},e.prototype.highlightConnectorLineElements=function(e){e?e!==this.connectorLineElement&&(this.removeHighlight(),this.addHighlight(e)):this.removeHighlight()},e.prototype.addHighlight=function(e){this.connectorLineElement=e,sf.base.addClass([e],["e-connector-line-hover-z-index"]),sf.base.addClass(e.querySelectorAll(".e-line"),["e-connector-line-hover"]),sf.base.addClass(e.querySelectorAll(".e-connector-line-right-arrow"),["e-connector-line-right-arrow-hover"]),sf.base.addClass(e.querySelectorAll(".e-connector-line-left-arrow"),["e-connector-line-left-arrow-hover"])},e.prototype.removeHighlight=function(){sf.base.isNullOrUndefined(this.connectorLineElement)||(sf.base.removeClass([this.connectorLineElement],["e-connector-line-hover-z-index"]),sf.base.removeClass(this.connectorLineElement.querySelectorAll(".e-line"),["e-connector-line-hover"]),sf.base.removeClass(this.connectorLineElement.querySelectorAll(".e-connector-line-right-arrow"),["e-connector-line-right-arrow-hover"]),sf.base.removeClass(this.connectorLineElement.querySelectorAll(".e-connector-line-left-arrow"),["e-connector-line-left-arrow-hover"]),this.connectorLineElement=null)},e.prototype.getEditedConnectorLineString=function(e){for(var t,i,r,a,s,n=[],o=[],d="",l=0;l<e.length;l++)if(t=e[l].ganttProperties.predecessor){for(var p=0;p<t.length;p++){i=t[p];if(this.parent.connectorLineModule.removeConnectorLineById("parent"+i.from+"child"+i.to),r=this.parent.connectorLineModule.getRecordByID(i.from),a=this.parent.connectorLineModule.getRecordByID(i.to),(r&&!0===r.expanded||a&&!0===a.expanded)&&(s=this.parent.predecessorModule.updateConnectorLineObject(r,a,i),!sf.base.isNullOrUndefined(s))){var h=n.indexOf(s.connectorLineId),c=this.parent.connectorLineModule.getConnectorLineTemplate(s);-1!==h?o[h]=c:(n.push(s.connectorLineId),o.push(c))}}d=o.join("")}return d},e.prototype.refreshEditedRecordConnectorLine=function(e){var t;this.parent.connectorLineModule.removePreviousConnectorLines(this.parent.previousRecords),this.parent.connectorLineModule.expandedRecords=this.parent.virtualScrollModule&&this.parent.enableVirtualization?this.parent.updatedRecords:this.parent.getExpandedRecords(this.parent.updatedRecords),t=this.getEditedConnectorLineString(e),this.parent.connectorLineModule.dependencyViewContainer.innerHTML=this.parent.connectorLineModule.dependencyViewContainer.innerHTML+t},e.prototype.idFromPredecessor=function(e){for(var t=e.split(","),i=[],r=0;r<t.length;r++){for(var a=[],s=0;s<t[r].length&&(!sf.base.isNullOrUndefined(t[r].charAt(s))&&"NaN"!==parseInt(t[r].charAt(s),10).toString());s++)a.push(t[r].charAt(s));i.push(a.join(""))}return i},e.prototype.predecessorValidation=function(e,t){for(var r,a,s=t.rowUniqueID,n=0;n<e.length;n++){r=e[n];var o=[];e.slice(0).splice(n,1);for(var d=function(){var e=[];return-1!==o.indexOf(r)?"break":sf.base.isNullOrUndefined(l.parent.connectorLineModule.getRecordByID(r))?{value:!1}:(a=l.parent.connectorLineModule.getRecordByID(r).ganttProperties,!sf.base.isNullOrUndefined(a.predecessor)&&a.predecessor.length>0&&a.predecessor.forEach((function(t){a.rowUniqueID.toString()!==t.from&&e.push(t.from.toString())})),s.toString()===a.rowUniqueID.toString()||-1!==e.indexOf(s.toString())?{value:!1}:(o.push(r),!sf.base.isNullOrUndefined(a.predecessor)&&a.predecessor.length>0?void(r=a.predecessor[0].from):"break"))},l=this;null!==r;){var p=d();if("object"===i(p))return p.value;if("break"===p)break}}return!0},e.prototype.validatePredecessorRelation=function(e,t){var r,a,s="ResourceView"===this.parent.viewType?e.ganttProperties.taskId:e.ganttProperties.rowUniqueID;if(!sf.base.isNullOrUndefined(t)&&t.length>0){r=this.idFromPredecessor(t);for(var n=function(t){if(!o.checkParentRelation(e,r))return{value:!1};var n=r.slice(0),d=[],l=!0;if(n.forEach((function(e){-1===d.indexOf(e)?d.push(e):l=!1})),!l)return{value:!1};a=r[t];var p=[];r.slice(0).splice(t,1);for(var h=function(){var t,i,r=[];if(-1!==p.indexOf(a))return"break";if(sf.base.isNullOrUndefined(o.parent.connectorLineModule.getRecordByID(a.toString())))return{value:!1};if(i=o.parent.connectorLineModule.getRecordByID(a.toString()).ganttProperties,!sf.base.isNullOrUndefined(i.predecessor)&&i.predecessor.length>0&&i.predecessor.forEach((function(e,a){i.rowUniqueID.toString()!==e.from&&(r.push(e.from.toString()),t=a)})),s.toString()===i.rowUniqueID.toString()||-1!==r.indexOf(s.toString()))return{value:!1};if(p.push(a),sf.base.isNullOrUndefined(i.predecessor)||!(i.predecessor.length>0))return"break";var n=void 0;return r.length>1?n=o.predecessorValidation(r,e.ganttProperties):1===r.length&&(a=i.predecessor[t].from),!1===n?{value:!1}:void 0};null!==a;){var c=h();if("object"===i(c))return c;if("break"===c)break}},o=this,d=0;d<r.length;d++){var l=n(d);if("object"===i(l))return l.value}}return!0},e.prototype.addPredecessor=function(e,t){var i=sf.base.isNullOrUndefined(e.ganttProperties.predecessorsName)||""===e.ganttProperties.predecessorsName?t:e.ganttProperties.predecessorsName+","+t;this.updatePredecessorHelper(e,i)},e.prototype.removePredecessor=function(e){this.updatePredecessorHelper(e,null)},e.prototype.updatePredecessor=function(e,t,i){return this.updatePredecessorHelper(e,t,i)},e.prototype.updatePredecessorHelper=function(e,t,i){if(sf.base.isUndefined(t)||this.validatePredecessorRelation(e,t)){this.parent.isOnEdit=!0;var r=[];sf.base.isNullOrUndefined(t)||""===t||(r=this.parent.predecessorModule.calculatePredecessor(t,e)),this.parent.setRecordValue("predecessor",r,e.ganttProperties,!0);var a=this.parent.predecessorModule.getPredecessorStringValue(e);this.parent.setRecordValue("predecessorsName",a,e.ganttProperties,!0),this.parent.setRecordValue("taskData."+this.parent.taskFields.dependency,a,e),this.parent.setRecordValue(this.parent.taskFields.dependency,a,e);var s={};return s.action=i&&i.action&&"CellEditing"===i.action?i.action:"DrawConnectorLine",s.data=e,this.parent.editModule.initiateUpdateAction(s),!0}return!1},e.prototype.checkParentRelation=function(e,t){var r=e;if(r&&r.parentItem&&-1!==t.indexOf(r.parentItem.taskId.toString()))return!1;for(var a=function(e){var i=s.parent.currentViewData.filter((function(i){return i&&i.ganttProperties.rowUniqueID.toString()===t[e].toString()}));if(i[0]&&i[0].hasChildRecords)return{value:!1}},s=this,n=0;n<t.length;n++){var o=a(n);if("object"===i(o))return o.value}return!0},e.prototype.initPredecessorValidationDialog=function(){if(this.parent.taskFields.dependency&&this.parent.isInPredecessorValidation){var e=sf.base.createElement("div",{id:this.parent.element.id+"_dialogValidationRule"});this.parent.element.appendChild(e),this.renderValidationDialog()}},e.prototype.renderValidationDialog=function(){var e=new sf.popups.Dialog({header:"Validate Editing",isModal:!0,visible:!1,width:"50%",showCloseIcon:!0,close:this.validationDialogClose.bind(this),content:"",buttons:[{click:this.validationDialogOkButton.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("okText"),isPrimary:!0}},{click:this.validationDialogCancelButton.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("cancel")}}],target:this.parent.element,animationSettings:{effect:"None"}});document.getElementById(this.parent.element.id+"_dialogValidationRule").innerHTML="",e.isStringTemplate=!0,e.appendTo("#"+this.parent.element.id+"_dialogValidationRule"),this.parent.validationDialogElement=e},e.prototype.validationDialogOkButton=function(){var e=this.parent.currentEditedArgs;e.validateMode.preserveLinkWithEditing=document.getElementById(this.parent.element.id+"_ValidationAddlineOffset").checked,e.validateMode.removeLink=document.getElementById(this.parent.element.id+"_ValidationRemoveline").checked,e.validateMode.respectLink=document.getElementById(this.parent.element.id+"_ValidationCancel").checked,this.applyPredecessorOption(),this.parent.validationDialogElement.hide()},e.prototype.validationDialogCancelButton=function(){this.parent.currentEditedArgs.validateMode.respectLink=!0,this.applyPredecessorOption(),this.parent.validationDialogElement.hide()},e.prototype.validationDialogClose=function(e){sf.base.getValue("isInteraction",e)&&(this.parent.currentEditedArgs.validateMode.respectLink=!0,this.applyPredecessorOption())},e.prototype.applyPredecessorOption=function(){var e=this.parent.currentEditedArgs,t=e.data;e.validateMode.respectLink?(this.parent.editModule.reUpdatePreviousRecords(),this.parent.chartRowsModule.refreshRecords([e.data])):e.validateMode.removeLink?(this.removePredecessors(t,this.validationPredecessor),this.parent.editModule.updateEditedTask(e.editEventArgs)):e.validateMode.preserveLinkWithEditing&&(this.calculateOffset(t),this.parent.editModule.updateEditedTask(e.editEventArgs))},e.prototype.calculateOffset=function(e){for(var t=sf.base.extend([],e.ganttProperties.predecessor,[],!0),i=this.parent.predecessorModule.getValidPredecessor(e),a=0;a<i.length;a++){var s=i[a],n=this.parent.connectorLineModule.getRecordByID(s.from),o=void 0;if(r(n.ganttProperties)&&r(e.ganttProperties)){var l=void 0,p=void 0,h=void 0,c=void 0;switch(s.type){case"FS":l=new Date(n.ganttProperties.endDate.getTime()),p=new Date(e.ganttProperties.startDate.getTime());break;case"SS":l=new Date(n.ganttProperties.startDate.getTime()),p=new Date(e.ganttProperties.startDate.getTime());break;case"SF":l=new Date(n.ganttProperties.startDate.getTime()),p=new Date(e.ganttProperties.endDate.getTime());break;case"FF":l=new Date(n.ganttProperties.endDate.getTime()),p=new Date(e.ganttProperties.endDate.getTime())}if(l.getTime()<p.getTime())l=this.dateValidateModule.checkStartDate(l),p=this.dateValidateModule.checkEndDate(p,null),c=!1;else{var u=new Date(l.getTime());l=this.dateValidateModule.checkStartDate(p),p=this.dateValidateModule.checkEndDate(u,null),c=!0}l.getTime()<p.getTime()?(h=this.dateValidateModule.getDuration(l,p,s.offsetUnit,!0,!1),o=c?-1*h:h):o=0}else o=0;t[d(s,"from",t,"to")].offset=o;var f=sf.base.extend([],n.ganttProperties.predecessor,[],!0);f[d(s,"from",f,"to")].offset=o,this.parent.setRecordValue("predecessor",f,n.ganttProperties,!0)}this.parent.setRecordValue("predecessor",t,e.ganttProperties,!0);var g=this.parent.predecessorModule.getPredecessorStringValue(e);this.parent.setRecordValue("taskData."+this.parent.taskFields.dependency,g,e),this.parent.setRecordValue(this.parent.taskFields.dependency,g,e),this.parent.setRecordValue("predecessorsName",g,e.ganttProperties,!0)},e.prototype.removePredecessors=function(e,t){for(var i=sf.base.extend([],[],e.ganttProperties.predecessor,!0),r=t.length,a=0;a<r;a++){var s=this.parent.connectorLineModule.getRecordByID(t[a].from),n=sf.base.extend([],[],s.ganttProperties.predecessor,!0),o=d(t[a],"from",i,"to");i.splice(o,1);var l=d(t[a],"from",n,"to");n.splice(l,1),this.parent.setRecordValue("predecessor",n,s.ganttProperties,!0)}if(i.length!==e.ganttProperties.predecessor.length){this.parent.setRecordValue("predecessor",i,e.ganttProperties,!0);var p=this.parent.predecessorModule.getPredecessorStringValue(e);this.parent.setRecordValue("predecessorsName",p,e.ganttProperties,!0),this.parent.setRecordValue("taskData."+this.parent.taskFields.dependency,p,e),this.parent.setRecordValue(this.parent.taskFields.dependency,p,e)}},e.prototype.openValidationDialog=function(e){var t=this.validationDialogTemplate(e);this.parent.validationDialogElement.setProperties({content:t}),this.parent.validationDialogElement.show()},e.prototype.validationDialogTemplate=function(e){var t,i,r=this.parent.element.id,a=sf.base.createElement("div",{className:"e-ValidationContent"}),s=sf.base.getValue("task",e),n=sf.base.getValue("parentTask",e),d=sf.base.getValue("violationType",e),l=s.ganttProperties.taskName,p=this.parent.getFormatedDate(s.ganttProperties.startDate,"MM/dd/yyyy"),h=[l,n.ganttProperties.taskName];"taskBeforePredecessor_FS"===d?i=this.parent.localeObj.getConstant("taskBeforePredecessor_FS"):"taskAfterPredecessor_FS"===d?i=this.parent.localeObj.getConstant("taskAfterPredecessor_FS"):"taskBeforePredecessor_SS"===d?i=this.parent.localeObj.getConstant("taskBeforePredecessor_SS"):"taskAfterPredecessor_SS"===d?i=this.parent.localeObj.getConstant("taskAfterPredecessor_SS"):"taskBeforePredecessor_FF"===d?i=this.parent.localeObj.getConstant("taskBeforePredecessor_FF"):"taskAfterPredecessor_FF"===d?i=this.parent.localeObj.getConstant("taskAfterPredecessor_FF"):"taskBeforePredecessor_SF"===d?i=this.parent.localeObj.getConstant("taskBeforePredecessor_SF"):"taskAfterPredecessor_SF"===d&&(i=this.parent.localeObj.getConstant("taskAfterPredecessor_SF")),t='<div id="'+r+'_ValidationText">'+(i=o(i,h))+"<div>";var c='<table><tr><td><input type="radio" id="'+r+'_ValidationCancel" name="ValidationRule" checked/><label for="'+r+'_ValidationCancel" id= "'+r+'_cancelLink">Cancel, keep the existing link</label></td></tr><tr><td><input type="radio" id="'+r+'_ValidationRemoveline" name="ValidationRule"/><label for="'+r+'_ValidationRemoveline" id="'+r+'_removeLink">Remove the link and move <b>'+l+"</b> to start on <b>"+p+'</b>.</label></td></tr><tr><td><input type="radio" id="'+r+'_ValidationAddlineOffset" name="ValidationRule"/><label for="'+r+'_ValidationAddlineOffset" id="'+r+'_preserveLink">Move the <b>'+l+"</b> to start on <b>"+p+"</b> and keep the link.</label></td></tr></table>";return a.innerHTML=t+c,a},e.prototype.validateTypes=function(e){var t,i,r,a=this.parent.predecessorModule.getValidPredecessor(e);this.validationPredecessor=[];for(var s=this.parent.predecessorModule.getPredecessorDate(e,a),n=e.ganttProperties,o=this.parent.allowUnscheduledTasks&&sf.base.isNullOrUndefined(s)?n.endDate:this.dateValidateModule.getEndDate(s,n.duration,n.durationUnit,n,!1),d=0;d<a.length;d++){t=this.parent.connectorLineModule.getRecordByID(a[d].from);var l=null;"FS"===a[d].type?n.startDate<s?(this.validationPredecessor.push(a[d]),l="taskBeforePredecessor_FS"):n.startDate>s&&(this.validationPredecessor.push(a[d]),l="taskAfterPredecessor_FS"):"SS"===a[d].type?n.startDate<s?(this.validationPredecessor.push(a[d]),l="taskBeforePredecessor_SS"):n.startDate>s&&(this.validationPredecessor.push(a[d]),l="taskAfterPredecessor_SS"):"FF"===a[d].type?o<=t.ganttProperties.endDate?(this.validationPredecessor.push(a[d]),l="taskBeforePredecessor_FF"):o>t.ganttProperties.endDate&&(this.validationPredecessor.push(a[d]),l="taskAfterPredecessor_FF"):"SF"===a[d].type&&(o<t.ganttProperties.startDate?(this.validationPredecessor.push(a[d]),l="taskBeforePredecessor_SF"):o>=t.ganttProperties.startDate&&(this.validationPredecessor.push(a[d]),l="taskAfterPredecessor_SF")),!sf.base.isNullOrUndefined(l)&&sf.base.isNullOrUndefined(r)&&(i=t,r=l)}return{parentTask:i,task:e,violationType:r}},e.prototype.addRemovePredecessor=function(e){var t=this.parent.previousRecords[e.uniqueID],i=e.ganttProperties.predecessor.slice();if(t&&t.ganttProperties&&t.ganttProperties.hasOwnProperty("predecessor")){var r=t.ganttProperties.predecessor;if(!sf.base.isNullOrUndefined(r))for(var a=0;a<r.length;a++){if((l=this.parent.connectorLineModule.getRecordByID(r[a].from))===e)e.ganttProperties.predecessor.push(r[a]);else{var s=sf.base.extend([],[],l.ganttProperties.predecessor,!0),n=d(r[a],"from",s,"to");-1!==n&&(s.splice(n,1),this.parent.setRecordValue("predecessor",s,l.ganttProperties,!0))}}if(!sf.base.isNullOrUndefined(i))for(var o=0;o<i.length;o++){var l=this.parent.connectorLineModule.getRecordByID(i[o].from);(s=sf.base.extend([],[],l.ganttProperties.predecessor,!0)).push(i[o]),this.parent.setRecordValue("predecessor",s,l.ganttProperties,!0)}}},e.prototype.removePredecessorByIndex=function(e,t){var i=e.ganttProperties.predecessor,r=i.splice(t,1),a=this.parent.connectorLineModule.getRecordByID(r[0].from).ganttProperties.predecessor,s=d(r[0],"from",a,"to");a.splice(s,1);var n=this.parent.predecessorModule.getPredecessorStringValue(e);i.push(r[0]),this.parent.connectorLineEditModule.updatePredecessor(e,n)},e.prototype.renderPredecessorDeleteConfirmDialog=function(){this.confirmPredecessorDialog=new sf.popups.Dialog({width:"320px",isModal:!0,content:this.parent.localeObj.getConstant("confirmPredecessorDelete"),buttons:[{click:this.confirmOkDeleteButton.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("okText"),isPrimary:!0}},{click:this.confirmCloseDialog.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("cancel")}}],target:this.parent.element,animationSettings:{effect:"None"}});var e=sf.base.createElement("div",{id:this.parent.element.id+"_deletePredecessorConfirmDialog"});this.parent.element.appendChild(e),this.confirmPredecessorDialog.isStringTemplate=!0,this.confirmPredecessorDialog.appendTo(e)},e.prototype.confirmCloseDialog=function(){this.confirmPredecessorDialog.destroy()},e.prototype.confirmOkDeleteButton=function(){this.removePredecessorByIndex(this.childRecord,this.predecessorIndex),this.confirmPredecessorDialog.destroy()},e}(),Dt=function(){return(Dt=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var a in t=arguments[i])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},wt=function(){function e(e){if(this.isFromDeleteMethod=!1,this.targetedRecords=[],this.updateParentRecords=[],this.isaddtoBottom=!1,this.confirmDialog=null,this.taskbarMoved=!1,this.predecessorUpdated=!1,this.isBreakLoop=!1,this.deletedTaskDetails=[],this.parent=e,this.validatedChildItems=[],this.parent.editSettings.allowEditing&&"Auto"===this.parent.editSettings.mode&&(this.cellEditModule=new ut(this.parent)),this.parent.taskFields.dependency&&(this.parent.connectorLineEditModule=new vt(this.parent)),(this.parent.editSettings.allowAdding||this.parent.editSettings.allowEditing&&("Dialog"===this.parent.editSettings.mode||"Auto"===this.parent.editSettings.mode))&&(this.dialogModule=new bt(this.parent)),this.parent.editSettings.allowTaskbarEditing&&(this.taskbarEditModule=new yt(this.parent)),this.parent.editSettings.allowDeleting){var t=sf.base.createElement("div",{id:this.parent.element.id+"_deleteConfirmDialog"});this.parent.element.appendChild(t),this.renderDeleteConfirmDialog()}this.parent.treeGrid.recordDoubleClick=this.recordDoubleClick.bind(this),this.parent.treeGrid.editSettings.allowAdding=this.parent.editSettings.allowAdding,this.parent.treeGrid.editSettings.allowDeleting=this.parent.editSettings.allowDeleting,this.parent.treeGrid.editSettings.showDeleteConfirmDialog=this.parent.editSettings.showDeleteConfirmDialog,this.updateDefaultColumnEditors()}return e.prototype.getModuleName=function(){return"edit"},e.prototype.updateDefaultColumnEditors=function(){for(var e=[this.parent.taskFields.id,this.parent.taskFields.progress,this.parent.taskFields.resourceInfo,"taskType"],t=0;t<e.length;t++)if(!sf.base.isNullOrUndefined(e[t])&&e[t].length>0){var i=this.parent.getColumnByField(e[t],this.parent.treeGridModule.treeGridColumns);i&&(i.field===this.parent.taskFields.id?this.updateIDColumnEditParams(i):i.field===this.parent.taskFields.progress?this.updateProgessColumnEditParams(i):i.field===this.parent.taskFields.resourceInfo?this.updateResourceColumnEditor(i):"taskType"===i.field&&this.updateTaskTypeColumnEditor(i))}},e.prototype.updateIDColumnEditParams=function(e){this.updateEditParams(e,{min:0,decimals:0,validateDecimalOnType:!0,format:"n0",showSpinButton:!1})},e.prototype.updateProgessColumnEditParams=function(e){this.updateEditParams(e,{min:0,decimals:0,validateDecimalOnType:!0,max:100,format:"n0"})},e.prototype.updateEditParams=function(e,t){sf.base.isNullOrUndefined(e.edit)?(e.edit={},e.edit.params={}):sf.base.isNullOrUndefined(e.edit.params)&&(e.edit.params={}),sf.base.extend(t,e.edit.params),e.edit.params=t,this.parent.getColumnByField(e.field,this.parent.ganttColumns).edit=e.edit},e.prototype.updateResourceColumnEditor=function(e){if(this.parent.editSettings.allowEditing&&sf.base.isNullOrUndefined(e.edit)&&"Auto"===this.parent.editSettings.mode){e.editType="dropdownedit",e.edit=this.getResourceEditor();var t=this.parent.getColumnByField(e.field,this.parent.ganttColumns);t.editType="dropdownedit",t.edit=e.edit}},e.prototype.getResourceEditor=function(){var e,t=this,i=this.parent.resourceFields,r={};return sf.dropdowns.MultiSelect.Inject(sf.dropdowns.CheckBoxSelection),r.write=function(r){t.parent.treeGridModule.currentEditRow={},(e=new sf.dropdowns.MultiSelect({dataSource:new sf.data.DataManager(t.parent.resources),fields:{text:i.name,value:i.id},mode:"CheckBox",showDropDownIcon:!0,popupHeight:"350px",delimiterChar:",",value:t.parent.treeGridModule.getResourceIds(r.rowData)})).appendTo(r.element)},r.read=function(e){var r=e.ej2_instances[0].value,a=[];sf.base.isNullOrUndefined(r)&&(r=[]);for(var s=0;s<r.length;s++)for(var n=0;n<t.parent.resources.length;n++)if(t.parent.resources[n][i.id]===r[s]){a.push(t.parent.resources[n][i.name]);break}return t.parent.treeGridModule.currentEditRow[t.parent.taskFields.resourceInfo]=r,a.join(",")},r.destroy=function(){e&&e.destroy()},r},e.prototype.updateTaskTypeColumnEditor=function(e){if(this.parent.editSettings.allowEditing&&sf.base.isNullOrUndefined(e.edit)&&"Auto"===this.parent.editSettings.mode){e.editType="dropdownedit",e.edit=this.getTaskTypeEditor();var t=this.parent.getColumnByField(e.field,this.parent.ganttColumns);t.editType="dropdownedit",t.edit=e.edit}},e.prototype.getTaskTypeEditor=function(){var e,t=this,i={},r=[{ID:1,Value:"FixedUnit"},{ID:2,Value:"FixedWork"},{ID:3,Value:"FixedDuration"}];return i.write=function(i){t.parent.treeGridModule.currentEditRow={},(e=new sf.dropdowns.DropDownList({dataSource:new sf.data.DataManager(r),fields:{value:"Value"},popupHeight:"350px",value:sf.base.getValue("taskType",i.rowData.ganttProperties)})).appendTo(i.element)},i.read=function(e){var i=e.ej2_instances[0].value;return t.parent.treeGridModule.currentEditRow.taskType=i,i},i.destroy=function(){e&&e.destroy()},i},e.prototype.reUpdateEditModules=function(){var e=this.parent.editSettings;if(e.allowEditing?(this.parent.editModule.cellEditModule&&"Dialog"===e.mode?(this.cellEditModule.destroy(),this.parent.treeGrid.recordDoubleClick=this.recordDoubleClick.bind(this)):sf.base.isNullOrUndefined(this.parent.editModule.cellEditModule)&&"Auto"===e.mode&&(this.cellEditModule=new ut(this.parent)),this.parent.editModule.dialogModule&&"Auto"===e.mode?this.parent.treeGrid.recordDoubleClick=void 0:sf.base.isNullOrUndefined(this.parent.editModule.dialogModule)&&(this.dialogModule=new bt(this.parent))):(this.cellEditModule&&this.cellEditModule.destroy(),this.dialogModule&&this.dialogModule.destroy()),e.allowDeleting&&e.showDeleteConfirmDialog){if(sf.base.isNullOrUndefined(this.confirmDialog)){var t=sf.base.createElement("div",{id:this.parent.element.id+"_deleteConfirmDialog"});this.parent.element.appendChild(t),this.renderDeleteConfirmDialog()}}else e.allowDeleting&&e.showDeleteConfirmDialog||this.confirmDialog&&!this.confirmDialog.isDestroyed&&this.confirmDialog.destroy();e.allowTaskbarEditing?sf.base.isNullOrUndefined(this.parent.editModule.taskbarEditModule)&&(this.taskbarEditModule=new yt(this.parent)):this.taskbarEditModule&&this.taskbarEditModule.destroy()},e.prototype.recordDoubleClick=function(e){if(this.parent.editSettings.allowEditing&&"Dialog"===this.parent.editSettings.mode){var t=void 0;if(e.row){var i=sf.base.getValue("rowIndex",e.row);t=this.parent.currentViewData[i]}sf.base.isNullOrUndefined(t)||this.dialogModule.openEditDialog(t)}this.parent.ganttChartModule.recordDoubleClick(e)},e.prototype.destroy=function(){this.cellEditModule&&this.cellEditModule.destroy(),this.taskbarEditModule&&this.taskbarEditModule.destroy(),this.dialogModule&&this.dialogModule.destroy(),this.confirmDialog&&!this.confirmDialog.isDestroyed&&this.confirmDialog.destroy()},e.prototype.updateRecordByID=function(e){if(!this.parent.readOnly){var t=this.parent.taskFields;if(sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(e[t.id]))return;var i,r="ResourceView"===this.parent.viewType?this.parent.flatData[this.parent.getTaskIds().indexOf("T"+e[t.id])]:this.parent.getRecordByID(e[t.id]);if(sf.base.isBlazor())-1===(i=Object.keys(e)).indexOf(t.startDate)||sf.base.isNullOrUndefined(sf.base.getValue(this.parent.taskFields.startDate,e))||sf.base.setValue(this.parent.taskFields.startDate,this.parent.dataOperation.getDateFromFormat(sf.base.getValue(this.parent.taskFields.startDate,e)),e),-1===i.indexOf(t.endDate)||sf.base.isNullOrUndefined(sf.base.getValue(this.parent.taskFields.endDate,e))||sf.base.setValue(this.parent.taskFields.endDate,this.parent.dataOperation.getDateFromFormat(sf.base.getValue(this.parent.taskFields.endDate,e)),e),-1===i.indexOf(t.baselineStartDate)||sf.base.isNullOrUndefined(sf.base.getValue(this.parent.taskFields.baselineStartDate,e))||sf.base.setValue(this.parent.taskFields.baselineStartDate,this.parent.dataOperation.getDateFromFormat(sf.base.getValue(this.parent.taskFields.baselineStartDate,e)),e),-1===i.indexOf(t.baselineEndDate)||sf.base.isNullOrUndefined(sf.base.getValue(this.parent.taskFields.baselineEndDate,e))||sf.base.setValue(this.parent.taskFields.baselineEndDate,this.parent.dataOperation.getDateFromFormat(sf.base.getValue(this.parent.taskFields.baselineEndDate,e)),e);if(!sf.base.isNullOrUndefined(this.parent.editModule)&&r)if(this.parent.isOnEdit=!0,this.validateUpdateValues(e,r,!0),-1===(i=Object.keys(e)).indexOf(t.startDate)&&-1===i.indexOf(t.endDate)&&-1===i.indexOf(t.duration)||this.parent.dataOperation.calculateScheduledValues(r,r.taskData,!1),this.parent.dataOperation.updateWidthLeft(r),sf.base.isUndefined(e[this.parent.taskFields.dependency])||e[this.parent.taskFields.dependency]===r.ganttProperties.predecessorsName){var a={};a.data=r,"ResourceView"===this.parent.viewType&&(a.action="methodUpdate"),this.parent.editModule.initiateUpdateAction(a)}else this.parent.connectorLineEditModule.updatePredecessor(r,e[this.parent.taskFields.dependency])}},e.prototype.validateUpdateValues=function(e,t,i){for(var r=this.parent,s=r.taskFields,n=a(r.columnMapping),o=[],d=!1,l=0,p=Object.keys(e);l<p.length;l++){var h=p[l];if(-1!==[s.startDate,s.endDate,s.duration].indexOf(h)){if(sf.base.isNullOrUndefined(e[h])&&!r.allowUnscheduledTasks)continue;if(i)if(s.duration===h)r.dataOperation.updateDurationValue(e[h],t.ganttProperties),t.ganttProperties.duration>0&&t.ganttProperties.isMilestone&&this.parent.setRecordValue("isMilestone",!1,t.ganttProperties,!0),r.dataOperation.updateMappingData(t,n[h]);else{var c="string"==typeof e[h]?new Date(e[h]):e[h];r.setRecordValue(n[h],c,t.ganttProperties,!0),r.dataOperation.updateMappingData(t,n[h])}else o.push(h),d=!0}else if(s.resourceInfo===h){var u=r.dataOperation.setResourceInfo(e);"ResourceView"===this.parent.viewType&&(JSON.stringify(u)!==JSON.stringify(t.ganttProperties.resourceInfo)?(this.parent.editModule.dialogModule.isResourceUpdate=!0,this.parent.editModule.dialogModule.previousResource=sf.base.isNullOrUndefined(t.ganttProperties.resourceInfo)?[]:t.ganttProperties.resourceInfo.slice()):this.parent.editModule.dialogModule.isResourceUpdate=!1),t.ganttProperties.resourceInfo=u,r.dataOperation.updateMappingData(t,"resourceInfo")}else if(s.dependency===h);else if(-1!==[s.progress,s.notes,s.durationUnit,s.expandState,s.milestone,s.name,s.baselineStartDate,s.baselineEndDate,s.id,s.segments].indexOf(h)){var f=r.columnByField[h],g=e[h];sf.base.isNullOrUndefined(f)||"datepickeredit"!==f.editType&&"datetimepickeredit"!==f.editType||(g=r.dataOperation.getDateFromFormat(g));var m=n[h];h===s.id?m="taskId":h===s.name?m="taskName":h===s.segments&&(m="segments"),sf.base.isNullOrUndefined(m)||r.setRecordValue(m,g,t.ganttProperties,!0),(h===s.baselineStartDate||h===s.baselineEndDate)&&t.ganttProperties.baselineStartDate&&t.ganttProperties.baselineEndDate&&(r.setRecordValue("baselineLeft",r.dataOperation.calculateBaselineLeft(t.ganttProperties),t.ganttProperties,!0),r.setRecordValue("baselineWidth",r.dataOperation.calculateBaselineWidth(t.ganttProperties),t.ganttProperties,!0)),r.setRecordValue("taskData."+h,g,t),r.setRecordValue(h,g,t)}else if(s.indicators===h){g=e[h];r.setRecordValue("indicators",g,t.ganttProperties,!0),r.setRecordValue("taskData."+h,g,t),r.setRecordValue(h,g,t)}else if(s.work===h)r.setRecordValue("work",e[h],t.ganttProperties,!0),this.parent.dataOperation.updateMappingData(t,"work"),this.parent.dataOperation.updateMappingData(t,"duration"),this.parent.dataOperation.updateMappingData(t,"endDate");else if("taskType"===h)r.setRecordValue("taskType",e[h],t.ganttProperties,!0);else if(-1!==r.customColumns.indexOf(h)){f=r.columnByField[h],g=e[h];sf.base.isNullOrUndefined(f.edit)&&("datepickeredit"!==f.editType&&"datetimepickeredit"!==f.editType||(g=r.dataOperation.getDateFromFormat(g))),r.setRecordValue("taskData."+h,g,t),r.setRecordValue(h,g,t)}else s.manual===h&&(r.setRecordValue("isAutoSchedule",!e[h],t.ganttProperties,!0),this.parent.setRecordValue(h,e[h],t),this.updateTaskScheduleModes(t))}d&&this.validateScheduleValues(o,t,e)},e.prototype.updateResourceRelatedFields=function(e,t){var i=e.ganttProperties,r=i.taskType,a=i.isAutoSchedule;if(!sf.base.isNullOrUndefined(i.resourceInfo))if(i.work>0||"work"===t)switch(r){case"FixedUnit":a&&i.resourceInfo.length&&("work"===t||"resource"===t)?this.parent.dataOperation.updateDurationWithWork(e):a||"work"!==t?this.parent.dataOperation.updateWorkWithDuration(e):this.parent.dataOperation.updateUnitWithWork(e);break;case"FixedWork":if(0===i.resourceInfo.length)return;a?"duration"===t||"endDate"===t?(this.parent.dataOperation.updateUnitWithWork(e),0===i.duration&&(this.parent.setRecordValue("work",0,i,!0),sf.base.isNullOrUndefined(this.parent.taskFields.work)||this.parent.dataOperation.updateMappingData(e,"work"))):this.parent.dataOperation.updateDurationWithWork(e):"work"===t?this.parent.dataOperation.updateUnitWithWork(e):this.parent.dataOperation.updateWorkWithDuration(e);break;case"FixedDuration":i.resourceInfo.length&&"work"===t?this.parent.dataOperation.updateUnitWithWork(e):this.parent.dataOperation.updateWorkWithDuration(e)}else this.parent.dataOperation.updateWorkWithDuration(e)},e.prototype.validateScheduleValues=function(e,t,i){var r=this.parent;e.length>2?r.dataOperation.calculateScheduledValues(t,i,!1):e.length>1?this.validateScheduleByTwoValues(i,e,t):this.dialogModule.validateScheduleValuesByCurrentField(e[0],i[e[0]],t)},e.prototype.validateScheduleByTwoValues=function(e,t,i){var r,a,s,n=this.parent,o=n.taskFields,d=i.ganttProperties,l=n.allowUnscheduledTasks;-1!==t.indexOf(o.startDate)&&(r=e[o.startDate]),-1!==t.indexOf(o.endDate)&&(a=e[o.endDate]),-1!==t.indexOf(o.duration)&&(s=e[o.duration]),r&&a||l&&-1!==t.indexOf(o.startDate)&&-1!==t.indexOf(o.endDate)?(n.setRecordValue("startDate",n.dataOperation.getDateFromFormat(r),d,!0),n.setRecordValue("endDate",n.dataOperation.getDateFromFormat(a),d,!0),n.dataOperation.calculateDuration(i)):a&&s||l&&-1!==t.indexOf(o.endDate)&&-1!==t.indexOf(o.duration)?(n.setRecordValue("endDate",n.dataOperation.getDateFromFormat(a),d,!0),n.dataOperation.updateDurationValue(s,d)):(r&&s||l&&-1!==t.indexOf(o.startDate)&&-1!==t.indexOf(o.duration))&&(n.setRecordValue("startDate",n.dataOperation.getDateFromFormat(r),d,!0),n.dataOperation.updateDurationValue(s,d))},e.prototype.isTaskbarMoved=function(e){var t=!1,i=e.ganttProperties,r=this.parent.previousRecords&&this.parent.previousRecords[e.uniqueID];if(r&&r.ganttProperties){var a=sf.base.getValue("ganttProperties.startDate",r),s=sf.base.getValue("ganttProperties.endDate",r),n=sf.base.getValue("ganttProperties.duration",r),o=sf.base.getValue("ganttProperties.durationUnit",r),d=Object.keys(r.ganttProperties);-1===d.indexOf("startDate")&&-1===d.indexOf("endDate")&&-1===d.indexOf("duration")&&-1===d.indexOf("durationUnit")||(sf.base.isNullOrUndefined(a)&&!sf.base.isNullOrUndefined(i.startDate)||sf.base.isNullOrUndefined(s)&&!sf.base.isNullOrUndefined(i.endDate)||sf.base.isNullOrUndefined(i.startDate)&&!sf.base.isNullOrUndefined(a)||sf.base.isNullOrUndefined(i.endDate)&&!sf.base.isNullOrUndefined(s)||a&&a.getTime()!==i.startDate.getTime()||s&&s.getTime()!==i.endDate.getTime()||!sf.base.isNullOrUndefined(n)&&n!==i.duration||!sf.base.isNullOrUndefined(n)&&n===i.duration&&o!==i.durationUnit)&&(t=!0)}return t},e.prototype.isPredecessorUpdated=function(e){var t=!1,i=this.parent.previousRecords[e.uniqueID];return i&&i.ganttProperties&&i.ganttProperties.hasOwnProperty("predecessor")&&(e.ganttProperties.predecessorsName!==i.ganttProperties.predecessorsName?t=!0:this.parent.setRecordValue("predecessor",i.ganttProperties.predecessor,e.ganttProperties,!0)),t},e.prototype.isCheckPredecessor=function(e){var t=!1;return this.parent.previousRecords[e.uniqueID]&&this.parent.taskFields.dependency&&this.parent.isInPredecessorValidation&&this.parent.predecessorModule.getValidPredecessor(e).length>0&&this.isTaskbarMoved(e)&&(t=!0),t},e.prototype.updateGanttProperties=function(e,t){var i=["taskId","uniqueID","rowUniqueID","parentId"];Object.keys(e.ganttProperties).forEach((function(r){-1===i.indexOf(r)&&(t.ganttProperties[r]=e.ganttProperties[r])}))},e.prototype.initiateUpdateAction=function(e){var t=this.isCheckPredecessor(e.data);this.taskbarMoved=this.isTaskbarMoved(e.data),this.predecessorUpdated=this.isPredecessorUpdated(e.data),this.predecessorUpdated&&(this.parent.isConnectorLineUpdate=!0,this.parent.connectorLineEditModule.addRemovePredecessor(e.data));var i={};if(t)if(i=this.parent.connectorLineEditModule.validateTypes(e.data),this.parent.isConnectorLineUpdate=!0,sf.base.isNullOrUndefined(sf.base.getValue("violationType",i)))this.updateEditedTask(e);else{var r=this.validateTaskEvent(e);!1===r.validateMode.preserveLinkWithEditing&&!1===r.validateMode.removeLink&&!1===r.validateMode.respectLink?this.parent.connectorLineEditModule.openValidationDialog(i):this.parent.connectorLineEditModule.applyPredecessorOption()}else this.taskbarMoved&&(this.parent.isConnectorLineUpdate=!0),this.updateEditedTask(e)},e.prototype.validateTaskEvent=function(e){var t={},i={};return this.resetValidateArgs(),this.parent.currentEditedArgs=t,t.cancel=!1,t.data=e.data,t.requestType="validateLinkedTask",t.validateMode=this.parent.dialogValidateMode,t.editEventArgs=e,sf.base.isBlazor()&&(i=Dt({},t),this.parent.updateDataArgs(t),this.parent.currentEditedArgs=i),this.parent.actionBeginTask(t),sf.base.isBlazor()?i:t},e.prototype.resetValidateArgs=function(){this.parent.dialogValidateMode.preserveLinkWithEditing=!0,this.parent.dialogValidateMode.removeLink=!1,this.parent.dialogValidateMode.respectLink=!1},e.prototype.updateEditedTask=function(e){var t=e.data;if(this.updateParentChildRecord(t),this.parent.isConnectorLineUpdate){for(var i=0;i<this.validatedChildItems.length;i++){var r=this.validatedChildItems[i];r.ganttProperties.predecessor&&r.ganttProperties.predecessor.length>0&&(this.parent.editedTaskBarItem=r,this.parent.predecessorModule.validatePredecessor(r,[],""))}t.ganttProperties.predecessor&&(this.parent.isMileStoneEdited=t.ganttProperties.isMilestone,this.taskbarMoved&&(this.parent.editedTaskBarItem=t),this.parent.predecessorModule.validatePredecessor(t,[],""))}(t.parentItem||"Auto"!==this.parent.taskMode)&&this.parent.dataOperation.updateParentItems(t,!0),this.initiateSaveAction(e)},e.prototype.updateParentChildRecord=function(e){var t=e;t.hasChildRecords&&this.taskbarMoved&&"Auto"===this.parent.taskMode&&this.updateChildItems(t)},e.prototype.updateTaskScheduleModes=function(e){var t=e[this.parent.taskFields.startDate],i=e.ganttProperties;if(e.hasChildRecords&&i.isAutoSchedule)this.parent.setRecordValue("startDate",i.autoStartDate,i,!0),this.parent.setRecordValue("endDate",i.autoEndDate,i,!0),this.parent.setRecordValue("width",this.parent.dataOperation.calculateWidth(e,!0),i,!0),this.parent.setRecordValue("left",this.parent.dataOperation.calculateLeft(i,!0),i,!0),this.parent.setRecordValue("progressWidth",this.parent.dataOperation.getProgressWidth(i.width,i.progress),i,!0),this.parent.dataOperation.calculateDuration(e);else if(e.hasChildRecords&&!i.isAutoSchedule)this.parent.dataOperation.updateWidthLeft(e),this.parent.dataOperation.calculateDuration(e),this.parent.setRecordValue("autoStartDate",i.startDate,i,!0),this.parent.setRecordValue("autoEndDate",i.endDate,i,!0),this.parent.setRecordValue("autoDuration",this.parent.dataOperation.calculateAutoDuration(e),i,!0),this.parent.dataOperation.updateAutoWidthLeft(e);else{var r=this.parent.dateValidationModule.checkStartDate(t,e.ganttProperties);this.parent.setRecordValue("startDate",r,e.ganttProperties,!0),this.parent.dataOperation.updateMappingData(e,"startDate"),this.parent.dateValidationModule.calculateEndDate(e),this.parent.setRecordValue("taskData."+this.parent.taskFields.manual,e[this.parent.taskFields.manual],e),this.parent.dataOperation.updateWidthLeft(e)}},e.prototype.calculateDateByRoundOffDuration=function(e,t){var i=e,r=i.ganttProperties,a=new Date(t.getTime());if(!sf.base.isNullOrUndefined(r.endDate)&&sf.base.isNullOrUndefined(r.startDate)){var s=this.parent.dateValidationModule.checkStartDate(a,r,null);this.parent.setRecordValue("endDate",this.parent.dateValidationModule.checkEndDate(s,i.ganttProperties),r,!0)}else this.parent.setRecordValue("startDate",this.parent.dateValidationModule.checkStartDate(a,r,!1),r,!0),sf.base.isNullOrUndefined(r.duration)||this.parent.dateValidationModule.calculateEndDate(i);this.parent.dataOperation.updateWidthLeft(e),this.parent.dataOperation.updateTaskData(i)},e.prototype.updateParentProgress=function(e){var t=0,i=this.parent.getParentTask(e),a=i.childRecords,s=a?a.length:0,n=0,o=0,d=0,l={};if(a){for(var p=0;p<s;p++)a[p].ganttProperties.isMilestone&&!a[p].hasChildRecords||!r(a[p].ganttProperties)?o+=1:(l=this.parent.dataOperation.getParentProgress(a[p]),n+=sf.base.getValue("totalProgress",l),d+=sf.base.getValue("totalDuration",l));t=s-o>0?Math.round(n/d):0,isNaN(t)&&(t=0),this.parent.setRecordValue("progressWidth",this.parent.dataOperation.getProgressWidth(i.ganttProperties.isAutoSchedule?i.ganttProperties.width:i.ganttProperties.autoWidth,t),i.ganttProperties,!0),this.parent.setRecordValue("progress",Math.floor(t),i.ganttProperties,!0),this.parent.setRecordValue("totalProgress",n,i.ganttProperties,!0),this.parent.setRecordValue("totalDuration",d,i.ganttProperties,!0)}this.parent.dataOperation.updateTaskData(i),i.parentItem&&this.updateParentProgress(i.parentItem)},e.prototype.revertCellEdit=function(e){this.parent.editModule.reUpdatePreviousRecords(!1,!0),this.resetEditProperties()},e.prototype.reUpdatePreviousRecords=function(e,t){for(var i=this.parent.previousRecords,r=Object.keys(i),a=0;a<r.length;a++){var s=r[a],n=i[s],o=this.parent.getTaskByUniqueID(s);this.copyTaskData(o.taskData,n.taskData),delete n.taskData,this.copyTaskData(o.ganttProperties,n.ganttProperties),delete n.ganttProperties,this.copyTaskData(o,n);var d=this.parent.currentViewData.indexOf(o);if(e&&this.parent.chartRowsModule.refreshRow(d),t){var l="ProjectView"===this.parent.viewType?o.ganttProperties.taskId:o.ganttProperties.rowUniqueID;this.parent.treeGrid.grid.setRowData(l,o),this.parent.treeGrid.grid.getRowObjectFromUID(this.parent.treeGrid.grid.getDataRows()[d].getAttribute("data-uid")).data=o}}},e.prototype.copyTaskData=function(e,t){sf.base.isNullOrUndefined(t)||sf.base.extend(e,t)},e.prototype.updateScheduleDatesOnEditing=function(e){},e.prototype.updateChildItems=function(e){var t,i=this.parent.previousRecords[e.uniqueID];t=sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.ganttProperties)?new Date(e.ganttProperties.startDate.getTime()):new Date(i.ganttProperties.startDate.getTime());var a,s,n,o,d,l=e.ganttProperties.startDate,p=[];if(this.getUpdatableChildRecords(e,p),0!==p.length){t.getTime()>l.getTime()?(a=this.parent.dateValidationModule.checkStartDate(l),s=this.parent.dateValidationModule.checkEndDate(t,e.ganttProperties),o=!1):(a=this.parent.dateValidationModule.checkStartDate(t),s=this.parent.dateValidationModule.checkEndDate(l,e.ganttProperties),o=!0),d=a.getTime()>=s.getTime()?0:this.parent.dateValidationModule.getDuration(a,s,"minute",!0,!1);for(var h=0;h<p.length;h++)if(p[h].ganttProperties.isAutoSchedule)if(d>0){var c=r(p[h].ganttProperties)||p[h].ganttProperties.startDate?p[h].ganttProperties.startDate:p[h].ganttProperties.endDate?p[h].ganttProperties.endDate:new Date(t.toString());n=o?this.parent.dateValidationModule.getEndDate(this.parent.dateValidationModule.checkStartDate(c,p[h].ganttProperties,p[h].ganttProperties.isMilestone),d,"minute",p[h].ganttProperties,!1):this.parent.dateValidationModule.getStartDate(this.parent.dateValidationModule.checkEndDate(c,p[h].ganttProperties),d,"minute",p[h].ganttProperties),this.calculateDateByRoundOffDuration(p[h],n),this.parent.isOnEdit&&-1===this.validatedChildItems.indexOf(p[h])&&this.validatedChildItems.push(p[h])}else sf.base.isNullOrUndefined(i)&&(n=t,this.calculateDateByRoundOffDuration(p[h],n),this.parent.isOnEdit&&-1===this.validatedChildItems.indexOf(p[h])&&this.validatedChildItems.push(p[h]));p.length&&this.parent.dataOperation.updateParentItems(e,!0)}},e.prototype.getUpdatableChildRecords=function(e,t){for(var i=e.childRecords,r=0;r<i.length;r++)i[r].ganttProperties.isAutoSchedule&&(t.push(i[r]),i[r].hasChildRecords&&this.getUpdatableChildRecords(i[r],t))},e.prototype.initiateSaveAction=function(e){var t=this;this.parent.showSpinner();var i={requestType:"beforeSave"};i.data=e.data,i.modifiedRecords=this.parent.editedRecords,sf.base.isNullOrUndefined(e.target)||(i.target=e.target),i.modifiedTaskData=n(this.parent.editedRecords,!0),e.action&&"DrawConnectorLine"===e.action&&(i.action="DrawConnectorLine"),sf.base.isBlazor()&&(i=this.parent.updateDataArgs(i)),this.parent.trigger("actionBegin",i,(function(i){if(i.cancel)t.reUpdatePreviousRecords(),t.parent.chartRowsModule.refreshRecords([e.data]),t.resetEditProperties();else if(i.modifiedTaskData=n(i.modifiedRecords),s(t.parent.dataSource)){var r=t.parent.dataSource,a={changedRecords:i.modifiedTaskData},o=t.parent.query instanceof sf.data.Query?t.parent.query:new sf.data.Query,d=null,l=r.adaptor;if(l instanceof sf.data.WebApiAdaptor&&l instanceof sf.data.ODataAdaptor&&!r.dataSource.batchUrl){d=r.update(t.parent.taskFields.id,a.changedRecords,null,o)}else d=r.saveChanges(a,t.parent.taskFields.id,null,o);d.then((function(i){return t.dmSuccess(i,e)})).catch((function(i){return t.dmFailure(i,e)}))}else t.saveSuccess(e)}))},e.prototype.dmSuccess=function(e,t){this.saveSuccess(t)},e.prototype.dmFailure=function(e,t){if(this.deletedTaskDetails.length){for(var i=this.deletedTaskDetails,r=0;r<i.length;r++)i[r].isDelete=!1;this.deletedTaskDetails=[]}this.reUpdatePreviousRecords(!0,!0),this.resetEditProperties(),this.parent.trigger("actionFailure",{error:e})},e.prototype.updateSharedTask=function(e){for(var t=e.ganttProperties.sharedTaskUniqueIds,i=0;i<t.length;i++){var r=this.parent.flatData[this.parent.ids.indexOf(t[i].toString())];r.uniqueID!==e.uniqueID&&(this.updateGanttProperties(e,r),this.parent.setRecordValue("taskData",e.taskData,r,!0),this.parent.dataOperation.updateTaskData(r),this.parent.dataOperation.updateResourceName(r),sf.base.isNullOrUndefined(r.parentItem)||this.parent.dataOperation.updateParentItems(r.parentItem))}},e.prototype.saveSuccess=function(e){var t={};if(this.parent.timelineSettings.updateTimescaleView){var i=this.parent.editedRecords;this.parent.timelineModule.updateTimeLineOnEditing(i,e.action)}if("ResourceView"===this.parent.viewType){"TaskbarEditing"===e.action?this.updateSharedTask(e.data):"DialogEditing"!==e.action&&"CellEditing"!==e.action&&"methodUpdate"!==e.action||(this.parent.editModule.dialogModule.isResourceUpdate?(this.updateResoures(this.parent.editModule.dialogModule.previousResource,e.data.ganttProperties.resourceInfo,e.data),this.updateSharedTask(e.data),this.isTreeGridRefresh=!0):this.updateSharedTask(e.data));for(var r=0;r<this.updateParentRecords.length;r++)this.parent.dataOperation.updateParentItems(this.updateParentRecords[r]);this.updateParentRecords=[],this.parent.editModule.dialogModule.isResourceUpdate=!1,this.parent.editModule.dialogModule.previousResource=[]}this.isTreeGridRefresh||(this.parent.chartRowsModule.refreshRecords(this.parent.editedRecords),this.parent.isConnectorLineUpdate&&!sf.base.isNullOrUndefined(this.parent.connectorLineEditModule)&&(this.parent.updatedConnectorLineCollection=[],this.parent.connectorLineIds=[],this.parent.connectorLineEditModule.refreshEditedRecordConnectorLine(this.parent.editedRecords),this.updateScheduleDatesOnEditing(e))),!this.parent.editSettings.allowTaskbarEditing||this.parent.editSettings.allowTaskbarEditing&&!this.taskbarEditModule.dependencyCancel?(t.requestType="save",t.data=e.data,t.modifiedRecords=this.parent.editedRecords,t.modifiedTaskData=n(this.parent.editedRecords),sf.base.isNullOrUndefined(e.action)||sf.base.setValue("action",e.action,t),"TaskbarEditing"===e.action&&(t.taskBarEditAction=e.taskBarEditAction),this.endEditAction(e),sf.base.isBlazor()&&this.parent.updateDataArgs(t),this.parent.trigger("actionComplete",t)):(this.taskbarEditModule.dependencyCancel=!1,this.resetEditProperties(),sf.base.isBlazor()&&this.parent.updateDataArgs(t)),"ResourceView"===this.parent.viewType&&this.isTreeGridRefresh&&(this.parent.treeGrid.parentData=[],this.parent.treeGrid.refresh(),this.isTreeGridRefresh=!1)},e.prototype.updateResoures=function(e,t,i){var r=this.parent.flatData,a=t?t.length:0,s=e?e.length:0;if(0!==a||0!==s){for(var n=0;n<a;n++){for(var o=[],d=parseInt(t[n][this.parent.resourceFields.id],10),l=0;l<e.length;l++)if(parseInt(e[l][this.parent.resourceFields.id],10)===d){o.push(l);break}if(0===o.length){var p=r[this.parent.getTaskIds().indexOf("R"+d)];p&&this.addNewRecord(i,p)}else e.splice(parseInt(o[0].toString(),10),1)}var h=e?e.length:0;for(n=0;n<h;n++)for(var c=i.ganttProperties.taskId,u=(d=e[n][this.parent.resourceFields.id],r[this.parent.getTaskIds().indexOf("R"+d)]),f=0;f<u.childRecords.length;f++)u.childRecords[f].ganttProperties.taskId===c&&this.removeChildRecord(u.childRecords[f]);if(a>0){var g=this.parent.getParentTask(i.parentItem);g&&g.ganttProperties.taskName===this.parent.localeObj.getConstant("unassignedTask")&&this.removeChildRecord(i)}0===a&&this.checkWithUnassignedTask(i)}},e.prototype.checkWithUnassignedTask=function(e){for(var t=null,i=0;i<this.parent.flatData.length;i++)this.parent.flatData[i].ganttProperties.taskName===this.parent.localeObj.getConstant("unassignedTask")&&(t=this.parent.flatData[i]);if(sf.base.isNullOrUndefined(t)){var r={};r[this.parent.taskFields.id]=0,r[this.parent.taskFields.name]=this.parent.localeObj.getConstant("unassignedTask");var a,s=this.parent.isOnEdit;this.parent.isOnEdit=!1,a=this.parent.dataOperation.createRecord(r,0),this.parent.isOnEdit=s,this.addRecordAsBottom(a);var n=this.parent.flatData[this.parent.flatData.length-1];this.addNewRecord(e,n)}else this.addNewRecord(e,t)},e.prototype.addRecordAsBottom=function(e){var t=this.parent.flatData.length;this.parent.taskFields.parentID&&this.parent.dataSource.length>0&&this.parent.dataSource.splice(t+1,0,e.taskData),this.parent.currentViewData.splice(t+1,0,e),this.parent.flatData.splice(t+1,0,e),this.parent.ids.splice(t+1,0,e.ganttProperties.rowUniqueID.toString());var i=0===e.level?"R"+e.ganttProperties.taskId:"T"+e.ganttProperties.taskId;this.parent.getTaskIds().splice(t+1,0,i),this.updateTreeGridUniqueID(e,"add")},e.prototype.addNewRecord=function(e,t){var i=null;i=sf.base.extend({},{},e,!0),this.parent.setRecordValue("uniqueID",sf.grids.getUid(this.parent.element.id+"_data_"),i),this.parent.setRecordValue("uniqueID",i.uniqueID,i.ganttProperties,!0);var r=i.uniqueID.replace(this.parent.element.id+"_data_","");this.parent.setRecordValue("rowUniqueID",r,i),this.parent.setRecordValue("rowUniqueID",r,i.ganttProperties,!0),this.parent.setRecordValue("level",1,i),this.parent.taskFields.parentID&&this.parent.setRecordValue("parentId",t.ganttProperties.taskId,i.ganttProperties,!0),this.parent.setRecordValue("parentItem",this.parent.dataOperation.getCloneParent(t),i);var a=i.parentItem?i.parentItem.uniqueID:null;this.parent.setRecordValue("parentUniqueID",a,i),e.ganttProperties.sharedTaskUniqueIds.push(r),i.ganttProperties.sharedTaskUniqueIds=e.ganttProperties.sharedTaskUniqueIds,this.addRecordAsChild(t,i)},e.prototype.removeChildRecord=function(e){var t,i=this.parent,r=[];r=this.parent.dataSource instanceof sf.data.DataManager&&this.parent.dataSource.dataSource.json.length>0?this.parent.dataSource.dataSource.json:this.parent.currentViewData,t=this.parent.dataSource;var a=e,s=this.parent.getParentTask(a.parentItem);if(a){if(a.parentItem){var n=s?s.childRecords:[],o=0;n&&n.length>0&&(1===n.length&&(this.parent.isOnDelete=!0,n[0].isDelete=!0,this.parent.dataOperation.updateParentItems(s),this.parent.isOnDelete=!1,n[0].isDelete=!1),o=n.indexOf(a),s.childRecords.splice(o,1),this.updateParentRecords.push(s))}if(a.ganttProperties.sharedTaskUniqueIds.length){var d=a.ganttProperties.sharedTaskUniqueIds.indexOf(a.ganttProperties.rowUniqueID);a.ganttProperties.sharedTaskUniqueIds.splice(d,1)}if(this.updateTreeGridUniqueID(a,"delete"),!this.parent.taskFields.parentID){var l=[];l.push(a.ganttProperties.rowUniqueID.toString()),this.parent.editModule.removeFromDataSource(l)}if(i.taskFields.parentID){for(var p=void 0,h=this.parent.currentViewData,c=0;c<h.length;c++)h[c].ganttProperties.rowUniqueID===a.ganttProperties.rowUniqueID&&(p=c);-1!==p&&(t.length>0&&t.splice(p,1),r.splice(p,1),this.parent.flatData.splice(p,1),this.parent.ids.splice(p,1),this.parent.getTaskIds().splice(p,1))}var u=r.indexOf(a);if(!i.taskFields.parentID){var f=this.parent.editModule.getChildCount(a,0);r.splice(u,f+1),this.parent.flatData.splice(u,f+1),this.parent.ids.splice(u,f+1),this.parent.getTaskIds().splice(u,f+1)}a.parentItem&&s&&s.childRecords&&!s.childRecords.length&&(this.parent.setRecordValue("expanded",!1,s),this.parent.setRecordValue("hasChildRecords",!1,s))}},e.prototype.addRecordAsChild=function(e,t){var i,r=this.parent,a=this.parent.flatData.indexOf(e),s=this.parent.editModule.getChildCount(e,0);if(!sf.base.isNullOrUndefined(this.addRowIndex)&&this.addRowPosition&&e.childRecords&&"Child"!==this.addRowPosition){var n=e.childRecords[this.addRowIndex],o="Above"===this.addRowPosition||"Below"===this.addRowPosition?this.addRowPosition:"Child";i=n?this.addRowIndex+a+1:s+a+1,i="Above"===o?i:i+1}else i=sf.base.isNullOrUndefined(s)||0===s?a+1:s+a+1;r.taskFields.parentID&&this.parent.dataSource.length>0&&this.parent.dataSource.splice(i,0,t.taskData),this.parent.currentViewData.splice(i,0,t),this.parent.flatData.splice(i,0,t),this.parent.ids.splice(i,0,t.ganttProperties.rowUniqueID.toString()),this.updateTreeGridUniqueID(t,"add");var d=0===t.level?"R"+t.ganttProperties.taskId:"T"+t.ganttProperties.taskId;this.parent.getTaskIds().splice(i,0,d),e.hasChildRecords||(this.parent.setRecordValue("hasChildRecords",!0,t),this.parent.setRecordValue("expanded",!0,t),e.childRecords.length||(e.childRecords=[],!r.taskFields.parentID&&sf.base.isNullOrUndefined(e.taskData[this.parent.taskFields.child])&&(e.taskData[this.parent.taskFields.child]=[]))),e.childRecords.splice(e.childRecords.length,0,t),sf.base.isNullOrUndefined(t)||this.parent.taskFields.parentID||sf.base.isNullOrUndefined(e.taskData[this.parent.taskFields.child])||e.taskData[this.parent.taskFields.child].splice(e.childRecords.length,0,t.taskData),sf.base.isNullOrUndefined(t.parentItem)||this.updateParentRecords.push(e)},e.prototype.resetEditProperties=function(){this.parent.currentEditedArgs={},this.resetValidateArgs(),this.parent.editedTaskBarItem=null,this.parent.isOnEdit=!1,this.validatedChildItems=[],this.parent.isConnectorLineUpdate=!1,this.parent.editedTaskBarItem=null,this.taskbarMoved=!1,this.predecessorUpdated=!1,sf.base.isNullOrUndefined(this.dialogModule)||(this.dialogModule.dialog&&!this.dialogModule.dialogObj.isDestroyed&&this.dialogModule.dialogObj.hide(),this.dialogModule.dialogClose()),this.parent.hideSpinner(),this.parent.initiateEditAction(!1)},e.prototype.endEditAction=function(e){this.resetEditProperties(),"TaskbarEditing"===e.action?this.parent.trigger("taskbarEdited",e):"CellEditing"===e.action?this.parent.trigger("endEdit",e):"DialogEditing"===e.action&&(this.dialogModule.dialog&&!this.dialogModule.dialogObj.isDestroyed&&this.dialogModule.dialogObj.hide(),this.dialogModule.dialogClose())},e.prototype.saveFailed=function(e){this.reUpdatePreviousRecords(),this.parent.hideSpinner()},e.prototype.renderDeleteConfirmDialog=function(){var e=new sf.popups.Dialog({width:"320px",isModal:!0,visible:!1,content:this.parent.localeObj.getConstant("confirmDelete"),buttons:[{click:this.confirmDeleteOkButton.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("okText"),isPrimary:!0}},{click:this.closeConfirmDialog.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("cancel")}}],target:this.parent.element,animationSettings:{effect:"None"}});e.appendTo("#"+this.parent.element.id+"_deleteConfirmDialog"),this.confirmDialog=e},e.prototype.closeConfirmDialog=function(){this.confirmDialog.hide()},e.prototype.confirmDeleteOkButton=function(){this.deleteSelectedItems(),this.confirmDialog.hide(),this.parent.element.querySelector(".e-treegrid").focus()},e.prototype.startDeleteAction=function(){this.parent.editSettings.allowDeleting&&!this.parent.readOnly&&(this.parent.editSettings.showDeleteConfirmDialog?this.confirmDialog.show():this.deleteSelectedItems())},e.prototype.deleteResourceRecords=function(e){for(var t=[],i=0;i<e.length;i++)if(e[i].parentItem)for(var r=e[i].ganttProperties.sharedTaskUniqueIds,a=0;a<r.length;a++)t.push(this.parent.flatData[this.parent.ids.indexOf(r[a].toString())]);this.deleteRow(t)},e.prototype.deleteSelectedItems=function(){if(this.isFromDeleteMethod)this.targetedRecords.length&&("ResourceView"===this.parent.viewType?this.deleteResourceRecords(this.targetedRecords):this.deleteRow(this.targetedRecords)),this.isFromDeleteMethod=!1;else{var e=[];"Cell"!==this.parent.selectionSettings.mode?e=this.parent.selectionModule.getSelectedRecords():"Cell"===this.parent.selectionSettings.mode&&(e=this.parent.selectionModule.getCellSelectedRecords()),"ResourceView"===this.parent.viewType?this.deleteResourceRecords(e):this.deleteRow(e)}},e.prototype.deleteRecord=function(e){this.isFromDeleteMethod=!0;var t=i(e);switch(this.targetedRecords=[],t){case"number":case"string":var r=e.toString();"ResourceView"===this.parent.viewType?sf.base.isNullOrUndefined(r)||-1===this.parent.getTaskIds().indexOf("T"+r)||this.targetedRecords.push(this.parent.flatData[this.parent.getTaskIds().indexOf("T"+r)]):sf.base.isNullOrUndefined(r)||-1===this.parent.ids.indexOf(r)||this.targetedRecords.push(this.parent.getRecordByID(r));break;case"object":Array.isArray(e)?this.updateTargetedRecords(e):this.targetedRecords.push(e.valueOf())}this.startDeleteAction()},e.prototype.updateTargetedRecords=function(e){if(e.length)if("object"===i(e[0]))this.targetedRecords=e;else for(var t=0;t<e.length;t++){var r=e[t].toString();"ResourceView"===this.parent.viewType?sf.base.isNullOrUndefined(r)||-1===this.parent.getTaskIds().indexOf("T"+r)||this.targetedRecords.push(this.parent.flatData[this.parent.getTaskIds().indexOf("T"+r)]):sf.base.isNullOrUndefined(r)||-1===this.parent.ids.indexOf(r)||this.targetedRecords.push(this.parent.getRecordByID(r))}},e.prototype.deleteRow=function(e){var t=e&&e.length?e:this.parent.selectionModule.getSelectedRecords();if(t.length){this.parent.isOnDelete=!0,t.forEach((function(e){e.isDelete=!0})),"ResourceView"!==this.parent.viewType||e.length||(t=[]);for(var i=0;i<t.length;i++){var r=t[i];if(-1===this.deletedTaskDetails.indexOf(r)){if(r.parentItem){var a=this.parent.getParentTask(r.parentItem).childRecords;(1===a.length?a:a.filter((function(e){return!e.isDelete}))).length>0&&this.parent.dataOperation.updateParentItems(r.parentItem)}var s=r.ganttProperties.predecessor;s&&s.length&&this.removePredecessorOnDelete(r),this.deletedTaskDetails.push(r),r.hasChildRecords&&this.deleteChildRecords(r)}}this.parent.selectionModule&&this.parent.allowSelection&&this.parent.selectionModule.clearSelection();var n={};n.deletedRecordCollection=this.deletedTaskDetails,n.updatedRecordCollection=this.parent.editedRecords,n.cancel=!1,n.action="delete",this.initiateDeleteAction(n),this.parent.isOnDelete=!1}sf.base.isNullOrUndefined(this.parent.toolbarModule)||this.parent.toolbarModule.refreshToolbarItems()},e.prototype.removePredecessorOnDelete=function(e){for(var t=e.ganttProperties.predecessor,i=0;i<t.length;i++){var r=t[i],a="ResourceView"===this.parent.viewType?e.ganttProperties.taskId:e.ganttProperties.rowUniqueID;if(r.from.toString()===a.toString()){var s=this.parent.connectorLineModule.getRecordByID(r.to.toString());if(!sf.base.isNullOrUndefined(s)){for(var n=sf.base.extend([],[],s.ganttProperties.predecessor,!0),o=void 0,d=0;d<n.length;d++){var l="ResourceView"===this.parent.viewType?s.ganttProperties.taskId:s.ganttProperties.rowUniqueID;if(n[d].to.toString()===l.toString()&&n[d].from.toString()===a.toString()){o=d;break}}n.splice(o,1),this.updatePredecessorValues(s,n)}}else if(r.to.toString()===a.toString()){var p=this.parent.connectorLineModule.getRecordByID(r.from.toString());if(!sf.base.isNullOrUndefined(p)){var h=sf.base.extend([],[],p.ganttProperties.predecessor,!0);for(o=void 0,d=0;d<h.length;d++){var c="ResourceView"===this.parent.viewType?p.ganttProperties.taskId:p.ganttProperties.rowUniqueID;if(h[d].from.toString()===c.toString()&&h[d].to.toString()===a.toString()){o=d;break}}h.splice(o,1),this.updatePredecessorValues(p,h)}}}},e.prototype.updatePredecessorValues=function(e,t){this.parent.setRecordValue("predecessor",t,e.ganttProperties,!0);var i=this.parent.predecessorModule.getPredecessorStringValue(e);this.parent.setRecordValue("predecessorsName",i,e.ganttProperties,!0),this.parent.setRecordValue("taskData."+this.parent.taskFields.dependency,i,e),this.parent.setRecordValue(this.parent.taskFields.dependency,i,e)},e.prototype.updateTaskId=function(e,t){if(!this.parent.readOnly){var i="number"==typeof e?e.toString():e,r="number"==typeof t?t.toString():t,a=this.parent.ids;if(!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(r)){var s=a.indexOf(i),n=a.indexOf(r);if(-1===s||n>-1)return;var o=this.parent.flatData[s];if(o.ganttProperties.taskId=o.ganttProperties.rowUniqueID=r,o.taskData[this.parent.taskFields.id]=r,o[this.parent.taskFields.id]=r,a[s]=r,o.hasChildRecords&&this.parent.taskFields.parentID)for(var d=o.childRecords,l=0;l<d.length;l++){var p=d[l];p[this.parent.taskFields.parentID]=t,this.parent.chartRowsModule.refreshRecords([p])}if(this.parent.taskFields.dependency&&!sf.base.isNullOrUndefined(o.ganttProperties.predecessor))for(var h=o.ganttProperties.predecessor,c=void 0,u=0;u<h.length;u++){var f=h[u];f.to===i?c=this.parent.flatData[a.indexOf(f.from)]:f.from===i&&(c=this.parent.flatData[a.indexOf(f.to)]),this.updatePredecessorOnUpdateId(c,i,r)}this.updatePredecessorOnUpdateId(o,i,r),this.parent.treeGrid.parentData=[],this.parent.treeGrid.refresh()}}},e.prototype.updatePredecessorOnUpdateId=function(e,t,i){if(this.parent.flatData.indexOf(e)>-1)for(var r=e.ganttProperties.predecessor,a=0;a<r.length;a++){var s=r[a];s.to===t?s.to=i:s.from===t&&(s.from=i)}this.updatePredecessorValues(e,e.ganttProperties.predecessor)},e.prototype.deleteChildRecords=function(e){for(var t=e.childRecords,i=0;i<t.length;i++){var r=t[i];if(-1===this.deletedTaskDetails.indexOf(r)){var a=r.ganttProperties.predecessor;a&&a.length&&this.removePredecessorOnDelete(r),this.deletedTaskDetails.push(r),r.hasChildRecords&&this.deleteChildRecords(r)}}},e.prototype.removeFromDataSource=function(e){var t;t=this.parent.dataSource instanceof sf.data.DataManager?this.parent.dataSource.dataSource.json:this.parent.dataSource,this.removeData(t,e),this.isBreakLoop=!1},e.prototype.removeData=function(e,t){for(var i=0;i<e.length&&!this.isBreakLoop;i++)if(-1!==t.indexOf(sf.base.getValue(this.parent.taskFields.id,e[i]).toString())){if(e[i][this.parent.taskFields.child]){var r=e[i][this.parent.taskFields.child];this.removeData(r,t)}if(t.splice(t.indexOf(sf.base.getValue(this.parent.taskFields.id,e[i]).toString()),1),e.splice(i,1),0===t.length){this.isBreakLoop=!0;break}}else if(e[i][this.parent.taskFields.child]){r=e[i][this.parent.taskFields.child];this.removeData(r,t)}},e.prototype.initiateDeleteAction=function(e){var t=this;this.parent.showSpinner();var i={requestType:"beforeDelete"};i.data=e.deletedRecordCollection,i.modifiedRecords=e.updatedRecordCollection,i.modifiedTaskData=n(e.updatedRecordCollection);var r={};sf.base.isBlazor()&&(i=this.parent.updateDataArgs(i),r.modifiedTaskData=i.modifiedTaskData,r.data=i.data),this.parent.trigger("actionBegin",i,(function(i){if(i.cancel){for(var a=t.deletedTaskDetails,o=0;o<a.length;o++)a[o].isDelete=!1;t.deletedTaskDetails=[],t.reUpdatePreviousRecords(),t.parent.initiateEditAction(!1),t.parent.hideSpinner()}else if(s(t.parent.dataSource)){var d=t.parent.dataSource,l={deletedRecords:sf.base.isBlazor()?n(r.data):n(i.data),changedRecords:sf.base.isBlazor()?r.modifiedTaskData:i.modifiedTaskData};if(sf.base.isBlazor()){l.addedRecords=[]}var p=d.adaptor;if(p instanceof sf.data.WebApiAdaptor&&p instanceof sf.data.ODataAdaptor&&!d.dataSource.batchUrl){for(var h=t.parent.query instanceof sf.data.Query?t.parent.query:new sf.data.Query,c=null,u=0;u<l.deletedRecords.length;u++)c=d.remove(t.parent.taskFields.id,l.deletedRecords[u],null,h);c.then((function(i){d.update(t.parent.taskFields.id,l.changedRecords,null,h).then((function(i){return t.deleteSuccess(e)})).catch((function(i){return t.dmFailure(i,e)}))})).catch((function(i){return t.dmFailure(i,e)}))}else{d.saveChanges(l,t.parent.taskFields.id).then((function(i){return t.deleteSuccess(e)})).catch((function(i){return t.dmFailure(i,e)}))}}else t.deleteSuccess(e)}))},e.prototype.deleteSuccess=function(e){for(var t=this.parent.flatData,i=this.parent.currentViewData,r=this.parent.getRecordFromFlatdata(e.deletedRecordCollection),a=[],s=0;s<r.length;s++){var o=r[s],d=i.indexOf(o),l=t.indexOf(o),p=this.parent.treeGrid.parentData.indexOf(o),h=sf.base.getValue("dataOperation.dataArray",this.parent),c=h.indexOf(o.taskData),u=void 0;if(-1!==d&&i.splice(d,1),-1!==l&&t.splice(l,1),-1!==c&&h.splice(c,1),!sf.base.isNullOrUndefined(o)){if(a.push(o.ganttProperties.rowUniqueID.toString()),-1!==l&&(this.parent.ids.splice(l,1),"ResourceView"===this.parent.viewType&&this.parent.getTaskIds().splice(l,1)),0===o.level&&-1!==p&&this.parent.treeGrid.parentData.splice(p,1),o.parentItem){var f=this.parent.getParentTask(o.parentItem);if(f){var g=f.childRecords;-1!==(u=g.indexOf(o))&&g.splice(u,1),g.length||this.parent.setRecordValue("hasChildRecords",!1,f)}}this.updateTreeGridUniqueID(o,"delete")}}a.length>0&&this.removeFromDataSource(a);var m={};this.parent.updatedConnectorLineCollection=[],this.parent.connectorLineIds=[],this.parent.predecessorModule.createConnectorLinesCollection(this.parent.flatData),this.parent.taskFields.dependency&&this.parent.predecessorModule.updatedRecordsDateByPredecessor(),this.parent.treeGrid.parentData=[],this.parent.treeGrid.refresh(),this.parent.enableImmutableMode&&this.refreshRecordInImmutableMode(),m.requestType="delete",m.data=e.deletedRecordCollection,m.modifiedRecords=e.updatedRecordCollection,m.modifiedTaskData=n(e.updatedRecordCollection),sf.base.setValue("action",e.action,m),sf.base.isBlazor()&&this.parent.updateDataArgs(m),this.parent.trigger("actionComplete",m),this.deletedTaskDetails=[],this.parent.initiateEditAction(!1),this.parent.hideSpinner()},e.prototype.getNewTaskId=function(){var e=sf.data.DataUtil.aggregates.max(this.parent.flatData,this.parent.taskFields.id);return sf.base.isNullOrUndefined(e)?1:parseInt(e.toString(),10)+1},e.prototype.prepareNewlyAddedData=function(e,t){var i,r=this.parent.taskFields,a=this.parent.ids;if(e[r.id]&&(-1!==a.indexOf(e[r.id].toString())?e[r.id]=null:e[r.id]=sf.base.isNullOrUndefined(e[r.id])?null:parseInt(e[r.id],10)),e[r.id]||(i=this.getNewTaskId(),e[r.id]=i),r.name&&!e[r.name]&&(e[r.name]="New Task "+e[r.id]),this.parent.allowUnscheduledTasks||e[r.startDate]||(e[r.startDate]=this.parent.projectStartDate),!this.parent.allowUnscheduledTasks&&r.duration&&sf.base.isNullOrUndefined(e[r.duration])&&(e[r.endDate]||(e[r.duration]="5")),r.progress&&(e[r.progress]=e[r.progress]?e[r.progress]>100?100:e[r.progress]:0),!this.parent.allowUnscheduledTasks&&!e[r.endDate]&&r.endDate&&!e[r.duration]){var s=this.parent.dataOperation.getDateFromFormat(this.parent.projectStartDate);s.setDate(s.getDate()+4),e[r.endDate]=this.parent.getFormatedDate(s,this.parent.getDateFormat())}},e.prototype.updateNewlyAddedDataBeforeAjax=function(e,t,i,r){var a;if((a=this.parent.dataOperation.createRecord(e,t)).index=parseInt(a.ganttProperties.rowUniqueID.toString(),10)-1,!sf.base.isNullOrUndefined(r)){this.parent.setRecordValue("parentItem",this.parent.dataOperation.getCloneParent(r),a);var s=a.parentItem?a.parentItem.index:null;this.parent.setRecordValue("parentIndex",s,a);var n=a.parentItem?a.parentItem.uniqueID:null;this.parent.setRecordValue("parentUniqueID",n,a),sf.base.isNullOrUndefined(this.parent.taskFields.id)||sf.base.isNullOrUndefined(this.parent.taskFields.parentID)||!a.parentItem||(this.parent.setRecordValue(this.parent.taskFields.parentID,a.parentItem.taskId,a.taskData,!0),this.parent.setRecordValue("parentId",a.parentItem.taskId,a.ganttProperties,!0),this.parent.setRecordValue(this.parent.taskFields.parentID,a.parentItem.taskId,a,!0))}return this.parent.isOnEdit=!0,this.backUpAndPushNewlyAddedRecord(a,i,r),this.parent.taskFields.dependency&&a.ganttProperties.predecessorsName?(this.parent.predecessorModule.ensurePredecessorCollectionHelper(a,a.ganttProperties),this.parent.predecessorModule.updatePredecessorHelper(a),this.parent.predecessorModule.validatePredecessorDates(a)):a.parentItem&&this.parent.getParentTask(a.parentItem).ganttProperties.isAutoSchedule&&this.parent.dataOperation.updateParentItems(a.parentItem),a},e.prototype.getChildCount=function(e,t){var i;if(!e.hasChildRecords)return 0;for(var r=0;r<e.childRecords.length;r++)t++,(i=e.childRecords[r]).hasChildRecords&&(t=this.getChildCount(i,t));return t},e.prototype.getVisibleChildRecordCount=function(e,t,i){var r,a;if(e.hasChildRecords){a=(r=e.childRecords).length;for(var s=0;s<a;s++)-1!==i.indexOf(r[s])&&t++,r[s].hasChildRecords&&(t=this.getVisibleChildRecordCount(r[s],t,i))}else-1!==i.indexOf(e)&&t++;return t},e.prototype.updatePredecessorOnIndentOutdent=function(e){for(var t,i,r=e.ganttProperties.predecessor.length,a=e.ganttProperties,s=a.predecessor,n=0;n<r;n++)if(s[n].to===a.rowUniqueID.toString()){t=this.parent.getRecordByID(s[n].from),i=d(s[n],"from",t.ganttProperties.predecessor,"to");var o=void 0;(o=sf.base.extend([],t.ganttProperties.predecessor,[],!0)).splice(i,1),this.parent.setRecordValue("predecessor",o,t.ganttProperties,!0)}else if(s[n].from===a.rowUniqueID.toString()){var l=(t=this.parent.getRecordByID(s[n].to)).ganttProperties.predecessorsName.toString().split(","),p=s[n].from+s[n].type,h=l.indexOf(p);l.splice(h,1),this.parent.setRecordValue("predecessorsName",l.join(","),t.ganttProperties,!0),this.parent.setRecordValue(this.parent.taskFields.dependency,l.join(","),t),i=d(s[n],"from",t.ganttProperties.predecessor,"to");var c=void 0;(c=sf.base.extend([],t.ganttProperties.predecessor,[],!0)).splice(i,1),this.parent.setRecordValue("predecessor",c,t.ganttProperties,!0),this.parent.predecessorModule.validatePredecessorDates(t)}this.parent.setRecordValue("predecessor",[],e.ganttProperties,!0),this.parent.setRecordValue("predecessorsName","",e.ganttProperties,!0)},e.prototype.predecessorToString=function(e,t){for(var i=[],r=0,a=e.length;r<a;r++)if(t.ganttProperties.rowUniqueID.toString()!==e[r].from){var s=e[r].from+e[r].type;e[r].offset=isNaN(e[r].offset)?0:e[r].offset,0!==e[r].offset&&(e[r].offset<0?s+=e[r].offset.toString()+"d":e[r].offset>0&&(s+="+"+e[r].offset.toString()+"d")),i.push(s)}return i.join(",")},e.prototype.backUpAndPushNewlyAddedRecord=function(e,t,i){var r,a,s,n=this.parent.flatData,o=this.parent.currentViewData,d=this.parent.ids;switch(t){case"Top":n.splice(0,0,e),o.splice(0,0,e),d.splice(0,0,e.ganttProperties.rowUniqueID.toString());break;case"Bottom":if(n.push(e),o.push(e),d.push(e.ganttProperties.rowUniqueID.toString()),"ResourceView"===this.parent.viewType){var l=0===e.level?"R"+e.ganttProperties.taskId:"T"+e.ganttProperties.taskId;this.parent.getTaskIds().push(l)}break;case"Above":a=n.indexOf(this.addRowSelectedItem),s=o.indexOf(this.addRowSelectedItem),this.recordCollectionUpdate(void 0,a,s,e,i);break;case"Below":if(r=n.indexOf(this.addRowSelectedItem),this.addRowSelectedItem.hasChildRecords)a=r+this.getChildCount(this.addRowSelectedItem,0)+1,s=o.indexOf(this.addRowSelectedItem)+this.getVisibleChildRecordCount(this.addRowSelectedItem,0,o)+1;else a=r+1,s=o.indexOf(this.addRowSelectedItem)+1;this.recordCollectionUpdate(NaN,a,s,e,i);break;case"Child":if(r=n.indexOf(this.addRowSelectedItem),this.addRowSelectedItem.hasChildRecords)a=r+this.getChildCount(this.addRowSelectedItem,0)+1,this.addRowSelectedItem.expanded||this.parent.enableMultiTaskbar||this.parent.expandByID(Number(this.addRowSelectedItem.ganttProperties.rowUniqueID)),s=o.indexOf(this.addRowSelectedItem)+this.getVisibleChildRecordCount(this.addRowSelectedItem,0,o)+1;else this.parent.setRecordValue("hasChildRecords",!0,this.addRowSelectedItem),this.parent.setRecordValue("isMilestone",!1,this.addRowSelectedItem.ganttProperties,!0),this.parent.setRecordValue("expanded",!0,this.addRowSelectedItem),this.parent.setRecordValue("childRecords",[],this.addRowSelectedItem),a=r+1,s=o.indexOf(this.addRowSelectedItem)+1,this.addRowSelectedItem.ganttProperties.predecessor&&this.updatePredecessorOnIndentOutdent(this.addRowSelectedItem),sf.base.isNullOrUndefined(this.addRowSelectedItem.ganttProperties.segments)||(this.addRowSelectedItem.ganttProperties.segments=null);this.recordCollectionUpdate(NaN,a,s,e,i)}this.newlyAddedRecordBackup=e},e.prototype.recordCollectionUpdate=function(e,t,i,r,a){var s=this.parent.flatData,n=this.parent.currentViewData,o=this.parent.ids;if(s.splice(t,0,r),n.splice(i,0,r),o.splice(t,0,r.ganttProperties.rowUniqueID.toString()),"ResourceView"===this.parent.viewType){var d=0===r.level?"R"+r.ganttProperties.taskId:"T"+r.ganttProperties.taskId;this.parent.getTaskIds().splice(t,0,d)}if(!sf.base.isNullOrUndefined(a)&&(e=a.childRecords.indexOf(this.addRowSelectedItem),a.childRecords.splice(e,0,r),this.parent.dataSource instanceof sf.data.DataManager&&sf.base.isNullOrUndefined(a.taskData[this.parent.taskFields.parentID]))){var l=this.parent.taskFields.child;a.taskData[l]&&a.taskData[l].length>0||(a.taskData[l]=[]),a.taskData[l].push(r.taskData)}},e.prototype.constructTaskAddedEventArgs=function(e,t,i){var r={};return r.action=r.requestType=i,r.data=e,r.newTaskData=n([e])[0],r.recordIndex=e.index,r.modifiedRecords=t,r.modifiedTaskData=n(t),r},e.prototype.addSuccess=function(e){this.parent.treeGrid.parentData=[],this.parent.treeGrid.refresh(),this.parent.enableImmutableMode&&this.refreshRecordInImmutableMode()},e.prototype.refreshRecordInImmutableMode=function(){for(var e=0;e<this.parent.editedRecords.length;e++){var t=this.parent.editedRecords[e],i="ProjectView"===this.parent.viewType?t.ganttProperties.taskId:t.ganttProperties.rowUniqueID;this.parent.treeGrid.grid.setRowData(i,t)}},e.prototype.updateRealDataSource=function(e,t){var i=this.parent.taskFields,r=this.parent.dataSource;"Top"===t?r.splice(0,0,e.taskData):"Bottom"===t?r.push(e):sf.base.isNullOrUndefined(i.id)||sf.base.isNullOrUndefined(i.parentID)?this.addDataInRealDataSource(r,e.taskData,t):r.push(e.taskData),this.isBreakLoop=!1},e.prototype.addDataInRealDataSource=function(e,t,i){for(var r=0;r<e.length;r++){var a=this.parent.taskFields.child;if(this.isBreakLoop)break;if(sf.base.getValue(this.parent.taskFields.id,e[r]).toString()===this.addRowSelectedItem.ganttProperties.rowUniqueID.toString()){"Above"===i?e.splice(r,0,t):"Below"===i?e.splice(r+1,0,t):"Child"===i&&(e[r][a]&&e[r][a].length>0||(e[r][a]=[]),e[r][a].push(t)),this.isBreakLoop=!0;break}if(e[r][a]){var s=e[r][a];this.addDataInRealDataSource(s,t,i)}}},e.prototype.addRecord=function(e,t,i){var r=this;if(this.parent.editModule&&this.parent.editSettings.allowAdding){var a=sf.base.isNullOrUndefined(i)||isNaN(parseInt(i.toString(),10))?this.parent.selectionModule?"Row"!==this.parent.selectionSettings.mode&&"Both"!==this.parent.selectionSettings.mode||1!==this.parent.selectionModule.selectedRowIndexes.length?"Cell"===this.parent.selectionSettings.mode&&1===this.parent.selectionModule.getSelectedRowCellIndexes().length?this.parent.selectionModule.getSelectedRowCellIndexes()[0].rowIndex:null:this.parent.updatedRecords.indexOf(this.parent.selectionModule.getSelectedRecords()[0]):null:i;this.addRowSelectedItem=sf.base.isNullOrUndefined(a)?null:this.parent.updatedRecords[a],t=sf.base.isNullOrUndefined(t)?this.parent.editSettings.newRowPosition:t,e=sf.base.isNullOrUndefined(e)?this.parent.editModule.dialogModule.composeAddRecord():e,((sf.base.isNullOrUndefined(a)||a<0||sf.base.isNullOrUndefined(this.addRowSelectedItem))&&("Above"===t||"Below"===t||"Child"===t)||!t||"Above"!==t&&"Below"!==t&&"Child"!==t&&"Top"!==t&&"Bottom"!==t)&&(t="Top");var n,o,d=0,l=void 0;switch(t){case"Top":case"Bottom":d=0;break;case"Above":case"Below":d=this.addRowSelectedItem.level,l=this.parent.getParentTask(this.addRowSelectedItem.parentItem);break;case"Child":d=this.addRowSelectedItem.level+1,l=this.addRowSelectedItem}this.prepareNewlyAddedData(e,t),n=this.updateNewlyAddedDataBeforeAjax(e,d,t,l),o=this.constructTaskAddedEventArgs(n,this.parent.editedRecords,"beforeAdd"),this.parent.showSpinner();var p={};if(sf.base.isBlazor()){if(!Array.isArray(o.data)){var h=[];h.push(o.data),sf.base.setValue("data",h,o)}p=Dt({},o)}this.parent.trigger("actionBegin",o,(function(e){if(e.cancel)e=sf.base.isBlazor()?p:e,r.removeAddedRecord(),r.reUpdatePreviousRecords(),r.dialogModule.dialog&&!r.dialogModule.dialogObj.isDestroyed&&r.dialogModule.dialogObj.hide(),r.dialogModule.dialogClose(),r._resetProperties();else if(sf.base.isBlazor()&&(p.data=p.data[0],e=p,r._resetProperties()),s(r.parent.dataSource)){var i=r.parent.dataSource,a={addedRecords:[e.newTaskData],changedRecords:e.modifiedTaskData},o=e.data.ganttProperties.taskId.toString(),d=r.parent.query instanceof sf.data.Query?r.parent.query:new sf.data.Query,l=i.adaptor;if(l instanceof sf.data.WebApiAdaptor&&l instanceof sf.data.ODataAdaptor&&!i.dataSource.batchUrl){i.insert(a.addedRecords,null,d).then((function(t){var s=t[0];i.update(r.parent.taskFields.id,a.changedRecords,null,d).then((function(t){if(r.parent.taskFields.id&&!sf.base.isNullOrUndefined(s[r.parent.taskFields.id])&&s[r.parent.taskFields.id].toString()!==o){r.parent.setRecordValue("taskId",s[r.parent.taskFields.id],e.data.ganttProperties,!0),r.parent.setRecordValue("taskData."+r.parent.taskFields.id,s[r.parent.taskFields.id],e.data),r.parent.setRecordValue(r.parent.taskFields.id,s[r.parent.taskFields.id],e.data),r.parent.setRecordValue("rowUniqueID",s[r.parent.taskFields.id].toString(),e.data.ganttProperties,!0);var i=r.parent.ids.indexOf(o);-1!==i&&(r.parent.ids[i]=s[r.parent.taskFields.id].toString())}r.updateNewRecord(n,e)})).catch((function(t){r.removeAddedRecord(),r.dmFailure(t,e),r._resetProperties()}))})).catch((function(t){r.removeAddedRecord(),r.dmFailure(t,e),r._resetProperties()}))}else{i.saveChanges(a,r.parent.taskFields.id,null,d).then((function(t){if(r.parent.taskFields.id&&!sf.base.isNullOrUndefined(t.addedRecords[0][r.parent.taskFields.id])&&t.addedRecords[0][r.parent.taskFields.id].toString()!==o){r.parent.setRecordValue("taskId",t.addedRecords[0][r.parent.taskFields.id],e.data.ganttProperties,!0),r.parent.setRecordValue("taskData."+r.parent.taskFields.id,t.addedRecords[0][r.parent.taskFields.id],e.data),r.parent.setRecordValue(r.parent.taskFields.id,t.addedRecords[0][r.parent.taskFields.id],e.data),r.parent.setRecordValue("rowUniqueID",t.addedRecords[0][r.parent.taskFields.id].toString(),e.data.ganttProperties,!0);var i=r.parent.ids.indexOf(o);-1!==i&&(r.parent.ids[i]=t.addedRecords[0][r.parent.taskFields.id].toString())}r.updateNewRecord(n,e)})).catch((function(t){r.removeAddedRecord(),r.dmFailure(t,e),r._resetProperties()}))}}else r.updateRealDataSource(e.data,t),0===n.level&&r.parent.treeGrid.parentData.splice(0,0,n),r.updateTreeGridUniqueID(n,"add"),r.refreshNewlyAddedRecord(e,n),r._resetProperties()}))}},e.prototype.updateNewRecord=function(e,t){0===e.level&&(this.parent.treeGrid.parentData.splice(0,0,e),sf.base.getValue("dataOperation.dataArray",this.parent).splice(0,0,e.taskData));this.updateTreeGridUniqueID(e,"add"),this.refreshNewlyAddedRecord(t,e),this._resetProperties()},e.prototype._resetProperties=function(){this.parent.isOnEdit=!1,this.parent.hideSpinner(),this.addRowSelectedItem=null,this.newlyAddedRecordBackup=null,this.isBreakLoop=!1,this.parent.element.tabIndex=0,this.parent.initiateEditAction(!1)},e.prototype.updateTreeGridUniqueID=function(e,t){"add"===t?sf.base.setValue("uniqueIDCollection."+e.uniqueID,e,this.parent.treeGrid):"delete"===t&&sf.base.deleteObject(sf.base.getValue("uniqueIDCollection",this.parent.treeGrid),e.uniqueID)},e.prototype.refreshNewlyAddedRecord=function(e,t){if(this.parent.selectionModule&&this.parent.allowSelection&&("Row"===this.parent.selectionSettings.mode||"Both"===this.parent.selectionSettings.mode)&&(this.parent.staticSelectedRowIndex=this.parent.currentViewData.indexOf(e.data)),this.parent.timelineSettings.updateTimescaleView){var i=[];e.modifiedRecords.length>0?(i.push(e.data),i.push.apply(i,e.modifiedRecords)):i=[e.data],this.parent.timelineModule.updateTimeLineOnEditing(i,e.action)}if(this.addSuccess(e),e=this.constructTaskAddedEventArgs(t,e.modifiedRecords,"add"),sf.base.isBlazor()&&this.parent.updateDataArgs(e),this.parent.trigger("actionComplete",e),this.dialogModule.dialog&&!this.dialogModule.dialogObj.isDestroyed&&this.dialogModule.dialogObj.hide(),this.dialogModule.dialogClose(),"ResourceView"===this.parent.viewType){if(e.data.ganttProperties.sharedTaskUniqueIds.push(e.data.ganttProperties.rowUniqueID),e.data.ganttProperties.resourceInfo.length){if(e.data.ganttProperties.resourceInfo.length>1){var r=sf.base.extend([],[],e.data.ganttProperties.resourceInfo,!0);r.splice(0,1),this.updateResoures([],r,e.data)}}else this.removeChildRecord(e.data),this.parent.editModule.checkWithUnassignedTask(e.data);for(var a=0;a<this.updateParentRecords.length;a++)this.parent.dataOperation.updateParentItems(this.updateParentRecords[a]);this.updateParentRecords=[]}},e.prototype.removeAddedRecord=function(){var e=this.parent.flatData,t=this.parent.currentViewData,i=this.parent.ids,r=e.indexOf(this.newlyAddedRecordBackup),a=t.indexOf(this.newlyAddedRecordBackup),s=i.indexOf(this.newlyAddedRecordBackup.ganttProperties.rowUniqueID.toString());if(sf.base.deleteObject(this.parent.previousRecords,e[r].uniqueID),this.newlyAddedRecordBackup.parentItem){var n=this.parent.getParentTask(this.newlyAddedRecordBackup.parentItem),o=n.childRecords.indexOf(this.newlyAddedRecordBackup);n.childRecords.splice(o,1)}e.splice(r,1),t.splice(a,1),i.splice(s,1)},e.prototype.getPrevRecordIndex=function(){var e=this.parent.updatedRecords[this.parent.selectionModule.getSelectedRowIndexes()[0]-1],t=this.parent.selectionModule.getSelectedRecords()[0],i=this.parent.getRootParent(e,t.level);return this.parent.updatedRecords.indexOf(i)},e.prototype.indent=function(){var e,t=this.parent.selectedRowIndex,i=!!this.parent.selectionModule&&(1===this.parent.selectionModule.selectedRowIndexes.length||1===this.parent.selectionModule.getSelectedRowCellIndexes().length),r=this.parent.updatedRecords[this.parent.selectionModule.getSelectedRowIndexes()[0]-1],a=this.parent.selectionModule.getSelectedRecords()[0];this.parent.editSettings.allowEditing&&0!==t&&-1!==t&&i&&"ResourceView"!==this.parent.viewType&&this.parent.updatedRecords[t].level-r.level!=1&&(e=r.level-a.level==0?this.parent.selectionModule.getSelectedRowIndexes()[0]-1:this.getPrevRecordIndex(),this.indentOutdentRow([this.parent.selectionModule.getSelectedRowIndexes()[0]],e,"child"))},e.prototype.outdent=function(){var e,t=this.parent.selectionModule.getSelectedRowIndexes()[0],i=!!this.parent.selectionModule&&(1===this.parent.selectionModule.selectedRowIndexes.length||1===this.parent.selectionModule.getSelectedRowCellIndexes().length);if(this.parent.editSettings.allowEditing&&-1!==t&&0!==t&&i&&"ResourceView"!==this.parent.viewType&&0!==this.parent.updatedRecords[t].level){var r=this.parent.getTaskByUniqueID(this.parent.selectionModule.getSelectedRecords()[0].parentItem.uniqueID);e=this.parent.updatedRecords.indexOf(r),this.indentOutdentRow([t],e,"below")}},e.prototype.indentOutdentRow=function(e,t,i){var r=this;e[0],"above"===i&&(this.dropPosition="topSegment"),"below"===i&&(this.dropPosition="bottomSegment"),"child"===i&&(this.dropPosition="middleSegment");for(var a=void 0,s=[],n=0;n<e.length;n++)s[n]=this.parent.updatedRecords[e[n]];var o={data:s,dropIndex:t,dropPosition:this.dropPosition};"middleSegment"===this.dropPosition?a="indenting":"bottomSegment"===this.dropPosition&&(a="outdenting");var d={action:a,data:s[0],cancel:!1};this.parent.trigger("actionBegin",d,(function(e){e.cancel||r.reArrangeRows(o,!0)}))},e.prototype.reArrangeRows=function(e,t){var i=this;if(this.dropPosition=e.dropPosition,"Invalid"!==e.dropPosition&&this.parent.editModule){var r=this.parent,a=void 0,o=void 0;this.droppedRecord=r.updatedRecords[e.dropIndex];var d=[];o=this.droppedRecord,e.data[0]?d=e.data:d.push(e.data);for(var l=0,p=d.length,h=0;h<p;h++){if(this.parent.isOnEdit=!0,a=d[h],this.draggedRecord=a,"Invalid"!==this.dropPosition){t&&this.deleteDragRow();var c=this.treeGridData.indexOf(o);if("bottomSegment"===this.dropPosition){if(o.hasChildRecords){l=this.parent.editModule.getChildCount(o,0),this.parent.taskFields.parentID&&this.ganttData.length>0&&this.ganttData.splice(c+l+1,0,this.draggedRecord.taskData),this.treeGridData.splice(c+l+1,0,this.draggedRecord),this.parent.ids.splice(c+l+1,0,this.draggedRecord.ganttProperties.rowUniqueID.toString());var u=this.parent.ids.indexOf(this.draggedRecord[this.parent.taskFields.id].toString());u!==c+l+1&&(this.parent.ids.splice(u,1),this.parent.ids.splice(c+l+1,0,this.draggedRecord[this.parent.taskFields.id].toString()))}else this.parent.taskFields.parentID&&this.ganttData.length>0&&this.ganttData.splice(c+1,0,this.draggedRecord.taskData),this.treeGridData.splice(c+1,0,this.draggedRecord),this.parent.ids.splice(c+1,0,this.draggedRecord.ganttProperties.rowUniqueID.toString());if(this.parent.setRecordValue("parentItem",this.treeGridData[c].parentItem,a),this.parent.setRecordValue("parentUniqueID",this.treeGridData[c].parentUniqueID,a),this.parent.setRecordValue("level",this.treeGridData[c].level,a),a.hasChildRecords){this.updateChildRecordLevel(a,1),this.updateChildRecord(a,c+l+1)}if(o.parentItem){var f=this.parent.getParentTask(o.parentItem).childRecords,g=f.indexOf(o)+1;f.splice(g,0,a)}}"middleSegment"===this.dropPosition&&this.dropMiddle(c),sf.base.isNullOrUndefined(a.parentItem&&-1!==this.updateParentRecords.indexOf(a.parentItem))||this.updateParentRecords.push(a.parentItem)}if(sf.base.isNullOrUndefined(a.parentItem)){var m=this.parent.treeGrid.parentData,y=m.indexOf(this.droppedRecord);"bottomSegment"===this.dropPosition&&m.splice(y+1,0,a)}this.refreshDataSource()}"middleSegment"===this.dropPosition&&(o.ganttProperties.predecessor&&(this.parent.editModule.removePredecessorOnDelete(o),o.ganttProperties.predecessor=null,o.ganttProperties.predecessorsName=null,o[this.parent.taskFields.dependency]=null,o.taskData[this.parent.taskFields.dependency]=null),o.ganttProperties.isMilestone&&(this.parent.setRecordValue("isMilestone",!1,o.ganttProperties,!0),sf.base.isNullOrUndefined(o.taskData[this.parent.taskFields.milestone])||!0===o.taskData[this.parent.taskFields.milestone]&&(o.taskData[this.parent.taskFields.milestone]=!1)));for(var b=0;b<this.updateParentRecords.length;b++)this.parent.dataOperation.updateParentItems(this.updateParentRecords[b]);this.updateParentRecords=[],this.parent.isOnEdit=!1}if(s(this.parent.dataSource)){var v=this.parent.dataSource,D={changedRecords:n(this.parent.editedRecords)},w=this.parent.query instanceof sf.data.Query?this.parent.query:new sf.data.Query,k=null,T=v.adaptor;if(T instanceof sf.data.WebApiAdaptor&&T instanceof sf.data.ODataAdaptor&&!v.dataSource.batchUrl){k=v.update(this.parent.taskFields.id,D.changedRecords,null,w)}else k=v.saveChanges(D,this.parent.taskFields.id,null,w);k.then((function(t){return i.indentSuccess(t,e)})).catch((function(e){return i.indentFailure(e)}))}else this.indentOutdentSuccess(e)},e.prototype.indentSuccess=function(e,t){this.indentOutdentSuccess(t)},e.prototype.indentFailure=function(e){this.parent.trigger("actionFailure",{error:e})},e.prototype.indentOutdentSuccess=function(e){this.parent.treeGrid.parentData=[],this.parent.treeGrid.refresh(),this.parent.enableImmutableMode&&this.refreshRecordInImmutableMode(),"middleSegment"===this.dropPosition?e.requestType="indented":"bottomSegment"===this.dropPosition&&(e.requestType="outdented"),e.modifiedRecords=this.parent.editedRecords,this.parent.trigger("actionComplete",e),this.parent.editedRecords=[]},e.prototype.refreshDataSource=function(){var e,t,i=this.draggedRecord,r=this.droppedRecord,a=this.parent;if((e=this.parent.dataSource instanceof sf.data.DataManager?sf.base.getValue("dataOperation.dataArray",this.parent):a.dataSource).length>0&&!sf.base.isNullOrUndefined(r)&&!r.parentItem){for(var s=0;s<Object.keys(e).length;s++)e[s][this.parent.taskFields.child]===r.taskData[this.parent.taskFields.child]&&(t=s);"topSegment"===this.dropPosition?this.parent.taskFields.parentID||e.splice(t,0,i.taskData):"bottomSegment"===this.dropPosition&&(this.parent.taskFields.parentID||e.splice(t+1,0,i.taskData))}else if(!this.parent.taskFields.parentID&&!sf.base.isNullOrUndefined(r)&&r.parentItem&&("topSegment"===this.dropPosition||"bottomSegment"===this.dropPosition)){var n="topSegment"===this.dropPosition?"Above":"Below";this.parent.editModule.addRowSelectedItem=r,this.parent.editModule.updateRealDataSource(i,n),delete this.parent.editModule.addRowSelectedItem}this.parent.taskFields.parentID&&(i.parentItem?"topSegment"===this.dropPosition||"bottomSegment"===this.dropPosition?(i[this.parent.taskFields.parentID]=r[this.parent.taskFields.parentID],i.taskData[this.parent.taskFields.parentID]=r[this.parent.taskFields.parentID]):(i[this.parent.taskFields.parentID]=r[this.parent.taskFields.id],i.taskData[this.parent.taskFields.parentID]=r[this.parent.taskFields.id]):(i[this.parent.taskFields.parentID]=null,i.taskData[this.parent.taskFields.parentID]=null))},e.prototype.deleteDragRow=function(){var e;this.parent.dataSource instanceof sf.data.DataManager?this.ganttData=sf.base.getValue("dataOperation.dataArray",this.parent):this.ganttData=this.parent.dataSource,this.treeGridData=this.parent.treeGrid.dataSource,e=this.parent.getTaskByUniqueID(this.draggedRecord.uniqueID),this.removeRecords(e)},e.prototype.dropMiddle=function(e){var t=this.parent,i=this.parent.editModule.getChildCount(this.droppedRecord,0),r=sf.base.isNullOrUndefined(i)||0===i?e+1:i+e+1;"middleSegment"===this.dropPosition&&(t.taskFields.parentID&&this.ganttData.length>0&&this.ganttData.splice(r,0,this.draggedRecord.taskData),this.treeGridData.splice(r,0,this.draggedRecord),this.parent.ids.splice(r,0,this.draggedRecord[this.parent.taskFields.id].toString()),this.recordLevel(),this.draggedRecord.hasChildRecords&&this.updateChildRecord(this.draggedRecord,r,this.droppedRecord.expanded),sf.base.isNullOrUndefined(this.draggedRecord.parentItem&&-1!==this.updateParentRecords.indexOf(this.draggedRecord.parentItem))&&this.updateParentRecords.push(this.draggedRecord.parentItem))},e.prototype.updateChildRecordLevel=function(e,t){var i,r;if(t++,!e.hasChildRecords)return 0;i=e.childRecords.length;for(var a=0;a<i;a++){r=e.childRecords[a];var s=void 0;if(e.parentItem){s=this.parent.treeGrid.uniqueIDCollection[e.parentItem.uniqueID]}r.level=e.parentItem?s.level+t:e.level+1,r.hasChildRecords&&(t--,t=this.updateChildRecordLevel(r,t))}return t},e.prototype.updateChildRecord=function(e,t,i){var r,a,s=this.parent;if(!e.hasChildRecords)return 0;a=e.childRecords.length;for(var n=0;n<a;n++)r=e.childRecords[n],t++,s.flatData.splice(t,0,r),this.parent.ids.splice(t,0,r.ganttProperties.rowUniqueID.toString()),s.taskFields.parentID&&this.ganttData.length>0&&this.ganttData.splice(t,0,r.taskData),r.hasChildRecords&&(t=this.updateChildRecord(r,t));return t},e.prototype.removeRecords=function(e){var t,i=this.parent;t=this.parent.dataSource instanceof sf.data.DataManager?sf.base.getValue("dataOperation.dataArray",this.parent):this.parent.dataSource;var r=e,a=this.parent.getParentTask(r.parentItem);if(r){if(r.parentItem){var s=a?a.childRecords:[],n=0;s&&s.length>0&&(n=s.indexOf(r),a.childRecords.splice(n,1),this.parent.taskFields.parentID||a.taskData[this.parent.taskFields.child].splice(n,1),this.updateParentRecords.push(a))}if(i.taskFields.parentID){r.hasChildRecords&&r.childRecords.length>0&&this.removeChildItem(r);for(var o=void 0,d=t.length>0?t:this.parent.currentViewData,l=0;l<d.length;l++)d[l][this.parent.taskFields.id]===r.taskData[this.parent.taskFields.id]&&(o=l);if(-1!==o){t.length>0&&t.splice(o,1);var p=void 0;for(l=0;l<this.treeGridData.length;l++)this.treeGridData[l][this.parent.taskFields.id]===r.taskData[this.parent.taskFields.id]&&(p=l);this.treeGridData.splice(p,1),this.parent.ids.splice(p,1),-1!==this.parent.treeGrid.parentData.indexOf(r)&&this.parent.treeGrid.parentData.splice(this.parent.treeGrid.parentData.indexOf(r),1)}}var h=this.treeGridData.indexOf(r);if(!i.taskFields.parentID){var c=this.getChildCount(r,0);this.treeGridData.splice(h,c+1),this.parent.ids.splice(h,c+1);var u=this.ganttData.indexOf(r.taskData);-1!==u&&(this.ganttData.splice(u,1),this.parent.treeGrid.parentData.splice(u,1))}r.parentItem&&a&&a.childRecords&&!a.childRecords.length&&(this.parent.setRecordValue("expanded",!1,a),this.parent.setRecordValue("hasChildRecords",!1,a))}},e.prototype.removeChildItem=function(e){for(var t,i,r=0;r<e.childRecords.length;r++){t=e.childRecords[r];var a=void 0;a=this.parent.dataSource instanceof sf.data.DataManager?sf.base.getValue("dataOperation.dataArray",this.parent):this.parent.dataSource;for(var s=0;s<a.length;s++)a[s][this.parent.taskFields.id]===t.taskData[this.parent.taskFields.id]&&(i=s);if(-1!==i){a.length>0&&a.splice(i,1);for(var n=void 0,o=0;o<this.treeGridData.length;o++)this.treeGridData[o][this.parent.taskFields.id]===t.taskData[this.parent.taskFields.id]&&(n=o);this.treeGridData.splice(n,1),this.parent.ids.splice(n,1)}t.hasChildRecords&&this.removeChildItem(t)}},e.prototype.recordLevel=function(){var e=this.parent,t=this.draggedRecord,i=this.droppedRecord,r=e.taskFields.child;if(i.hasChildRecords||(i.hasChildRecords=!0,i.childRecords.length||(i.childRecords=[],!e.taskFields.parentID&&sf.base.isNullOrUndefined(i.taskData[r])&&(i.taskData[r]=[]))),"middleSegment"===this.dropPosition){var a=sf.base.extend({},i);delete a.childRecords;var s={uniqueID:a.uniqueID,expanded:a.expanded,level:a.level,index:a.index,taskId:a.ganttProperties.rowUniqueID};if(this.parent.setRecordValue("parentItem",s,t),this.parent.setRecordValue("parentUniqueID",i.uniqueID,t),i.childRecords.splice(i.childRecords.length,0,t),sf.base.isNullOrUndefined(t)||e.taskFields.parentID||sf.base.isNullOrUndefined(i.taskData[r])||i.taskData[e.taskFields.child].splice(i.childRecords.length,0,t.taskData),!sf.base.isNullOrUndefined(i.ganttProperties.segments)&&i.ganttProperties.segments.length>0&&(i.ganttProperties.segments=null,i.taskData[e.taskFields.segments]=null),t.hasChildRecords){t.level=i.level+1,this.updateChildRecordLevel(t,1)}else t.level=i.level+1;i.expanded=!0}},e}(),kt=function(){function e(e){this.parent=e,sf.treegrid.TreeGrid.Inject(sf.treegrid.Reorder),this.parent.treeGrid.allowReordering=this.parent.allowReordering,this.bindEvents()}return e.prototype.getModuleName=function(){return"reorder"},e.prototype.bindEvents=function(){var e=this;this.parent.treeGrid.columnDragStart=function(t){e.parent.trigger("columnDragStart",t)},this.parent.treeGrid.columnDrag=function(t){e.parent.trigger("columnDrag",t)},this.parent.treeGrid.columnDrop=function(t){e.parent.trigger("columnDrop",t)}},e.prototype.destroy=function(){},e}(),Tt=function(){function e(e){this.parent=e,sf.treegrid.TreeGrid.Inject(sf.treegrid.Resize),this.parent.treeGrid.allowResizing=this.parent.allowResizing,this.bindEvents()}return e.prototype.getModuleName=function(){return"resize"},e.prototype.bindEvents=function(){var e=this;this.parent.treeGrid.resizeStart=function(t){e.parent.trigger("resizeStart",t)},this.parent.treeGrid.resizing=function(t){e.parent.trigger("resizing",t)},this.parent.treeGrid.resizeStop=function(t){e.parent.trigger("resizeStop",t)}},e.prototype.destroy=function(){},e}(),St=function(){function e(e){this.parent=e,sf.treegrid.TreeGrid.Inject(sf.treegrid.Filter),this.parent.treeGrid.allowFiltering=this.parent.allowFiltering,this.updateCustomFilters(),this.parent.treeGrid.filterSettings=sf.grids.getActualProperties(this.parent.filterSettings),this.addEventListener()}return e.prototype.getModuleName=function(){return"filter"},e.prototype.updateCustomFilters=function(){for(var e=this.parent.taskFields,t=0;t<this.parent.ganttColumns.length;t++){var i=this.parent.ganttColumns[t];("datepickeredit"!==i.editType&&"datetimepickeredit"!==i.editType||i.field!==e.startDate&&i.field!==e.endDate&&i.field!==e.baselineStartDate&&i.field!==e.baselineEndDate)&&(i.field!==e.duration||"stringedit"!==i.editType)||this.initiateFiltering(this.parent.ganttColumns[t])}},e.prototype.updateModel=function(){this.parent.filterSettings=this.parent.treeGrid.filterSettings},e.prototype.addEventListener=function(){this.parent.on("updateModel",this.updateModel,this),this.parent.on("actionBegin",this.actionBegin,this),this.parent.on("actionComplete",this.actionComplete,this),this.parent.on("columnMenuOpen",this.columnMenuOpen,this)},e.prototype.initiateFiltering=function(e){var t=this.parent.getColumnByField(e.field,this.parent.treeGridModule.treeGridColumns);e.allowFiltering=!1!==e.allowFiltering,e.allowFiltering&&"Menu"===this.parent.filterSettings.type&&!e.filter&&(e.filter={ui:this.getCustomFilterUi(e)}),t&&(t.allowFiltering=e.allowFiltering,t.filter=e.filter)},e.prototype.getCustomFilterUi=function(e){var t=this.parent.taskFields,i={};return"datepickeredit"!==e.editType||e.field!==t.startDate&&e.field!==t.endDate&&e.field!==t.baselineStartDate&&e.field!==t.baselineEndDate?"datetimepickeredit"!==e.editType||e.field!==t.startDate&&e.field!==t.endDate&&e.field!==t.baselineStartDate&&e.field!==t.baselineEndDate?e.field===t.duration&&"stringedit"===e.editType&&(i=this.getDurationFilter()):i=this.getDateTimePickerFilter():i=this.getDatePickerFilter(e.field),i},e.prototype.getDatePickerFilter=function(e){var t,i=this,r=this.parent,a=e===r.taskFields.startDate||e===r.taskFields.baselineStartDate?r.defaultStartTime:r.defaultEndTime;return{create:function(e){var r=sf.grids.getCustomDateFormat(e.column.format,e.column.type),a=sf.base.createElement("input",{className:"flm-input"});e.target.appendChild(a),(t=new sf.calendars.DatePicker({placeholder:i.parent.localeObj.getConstant("enterValue"),format:r})).appendTo(a)},write:function(e){t.value=e.filteredValue},read:function(e){t.value&&t.value.setSeconds(a),e.fltrObj.filterByColumn(e.column.field,e.operator,t.value)}}},e.prototype.getDateTimePickerFilter=function(){var e,t=this;return{create:function(i){var r=sf.grids.getCustomDateFormat(i.column.format,i.column.type),a=sf.base.createElement("input",{className:"flm-input"});i.target.appendChild(a),(e=new sf.calendars.DateTimePicker({placeholder:t.parent.localeObj.getConstant("enterValue"),format:r})).appendTo(a)},write:function(t){e.value=t.filteredValue},read:function(t){t.fltrObj.filterByColumn(t.column.field,t.operator,e.value)}}},e.prototype.getDurationFilter=function(){var e,t=this,i=this.parent,r="";return{create:function(i){var r=sf.base.createElement("input",{className:"e-input"});r.setAttribute("placeholder",t.parent.localeObj.getConstant("enterValue")),i.target.appendChild(r),(e=new sf.inputs.TextBox).appendTo(r)},write:function(t){e.value=t.filteredValue?r:""},read:function(a){var s=t.parent.dataOperation.getDurationValue(e.value),n=sf.base.getValue("duration",s),o=sf.base.getValue("durationUnit",s);if(n>=0){var d=void 0;"minute"===o?d=60*n/i.secondsPerDay:"hour"===o?d=60*n*60/i.secondsPerDay:(d=n,o="day"),a.fltrObj.filterByColumn(a.column.field,a.operator,d),r=t.parent.dataOperation.getDurationString(n,o)}else a.fltrObj.filterByColumn(a.column.field,a.operator,null),r=null}}},e.prototype.columnMenuOpen=function(e){this.filterMenuElement&&document.body.contains(this.filterMenuElement)&&sf.base.remove(this.filterMenuElement),this.filterMenuElement=null},e.prototype.actionBegin=function(e){},e.prototype.closeFilterOnContextClick=function(e){if(this.filterMenuElement&&document.body.contains(this.filterMenuElement)){var t=sf.base.closest(e,"#"+this.parent.element.id)||e.querySelector("#"+this.parent.element.id);(this.filterMenuElement.contains(e)||sf.base.isNullOrUndefined(t))&&"HTML"!==e.nodeName&&"DIV"!==e.nodeName||(sf.base.remove(this.filterMenuElement),this.parent.treeGrid.grid.notify("filter-menu-close",{isOpen:!1}),this.filterMenuElement=null)}},e.prototype.actionComplete=function(e){if(e.requestType===sf.grids.filterAfterOpen){this.filterMenuElement=sf.base.getValue("filterModel.dlgObj.element",e),this.updateFilterMenuPosition(this.filterMenuElement,e);var t=this.parent.taskFields.id,i=this.parent.taskFields.dependency,r=this.parent.taskFields.resourceInfo,a=this.parent.treeGrid.grid.filterModule,s=sf.base.getValue("values",a);if(e.columnName===i&&sf.base.isNullOrUndefined(sf.base.getValue(i,s))||e.columnName===r&&sf.base.isNullOrUndefined(sf.base.getValue(r,s))){var n=this.filterMenuElement.querySelector(".e-dropdownlist");(o=sf.base.getValue("ej2_instances[0]",n)).index=2,o.dataBind()}else if(e.columnName===t&&sf.base.isNullOrUndefined(sf.base.getValue(t,s))){n=this.filterMenuElement.querySelector(".e-numerictextbox");var o=sf.base.getValue("ej2_instances[0]",n);!sf.base.isNullOrUndefined(o)&&sf.base.isNullOrUndefined(this.parent.columnByField[e.columnName].format)&&(o.format="n")}}},e.prototype.setPosition=function(e,t){var i=this.parent.element.getBoundingClientRect(),r=e.getBoundingClientRect(),a=r.right+window.scrollX,s=r.top+window.scrollY;i.right<a+t.offsetWidth&&(r.left-t.offsetWidth>i.left?a=r.left-t.offsetWidth:a-=a+t.offsetWidth-i.right),t.style.top=s+"px",t.style.left=a+"px"},e.prototype.updateFilterMenuPosition=function(e,t){var i;sf.base.addClass([e],"e-gantt"),document.body.appendChild(e),this.parent.showColumnMenu?(i=document.querySelector("#treeGrid"+this.parent.controlId+"_gridcontrol_colmenu_Filter"),e.style.zIndex=i.parentElement.style.zIndex,this.setPosition(i,sf.base.getValue("filterModel.dlgObj.element",t))):(i=this.parent.treeGrid.grid.getColumnHeaderByField(t.columnName).querySelector(".e-filtermenudiv"),sf.grids.getFilterMenuPostion(i,sf.base.getValue("filterModel.dlgObj",t),this.parent.treeGrid.grid)),e.querySelector(".e-valid-input").focus()},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("updateModel",this.updateModel),this.parent.off("actionBegin",this.actionBegin),this.parent.off("actionComplete",this.actionComplete),this.parent.off("columnMenuOpen",this.columnMenuOpen))},e.prototype.destroy=function(){this.removeEventListener()},e}(),Pt=function(){function e(e){this.parent=e,sf.treegrid.TreeGrid.Inject(sf.treegrid.Sort),this.parent.treeGrid.allowSorting=this.parent.allowSorting,this.parent.treeGrid.sortSettings=sf.grids.getActualProperties(this.parent.sortSettings),this.addEventListener()}return e.prototype.getModuleName=function(){return"sort"},e.prototype.addEventListener=function(){this.parent.on("updateModel",this.updateModel,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off("updateModel",this.updateModel)},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.sortColumn=function(e,t,i){this.parent.treeGrid.sortByColumn(e,t,i)},e.prototype.clearSorting=function(){this.parent.treeGrid.clearSorting()},e.prototype.updateModel=function(){this.parent.sortSettings=this.parent.treeGrid.sortSettings},e.prototype.removeSortColumn=function(e){this.parent.treeGrid.grid.removeSortColumn(e)},e}(),Ct=function(){function e(e){this.isSelectionFromChart=!1,this.multipleIndexes=[],this.selectedRowIndexes=[],this.enableSelectMultiTouch=!1,this.openPopup=!1,this.parent=e,this.bindEvents(),this.parent.treeGrid.selectedRowIndex=this.parent.selectedRowIndex,this.parent.treeGrid.allowSelection=this.parent.allowSelection,this.parent.treeGrid.grid.selectionSettings.enableToggle=this.parent.selectionSettings.enableToggle,this.parent.treeGrid.selectionSettings=sf.grids.getActualProperties(this.parent.selectionSettings),this.wireEvents()}return e.prototype.getModuleName=function(){return"selection"},e.prototype.wireEvents=function(){this.parent.on("selectRowByIndex",this.selectRowByIndex,this),this.parent.isAdaptive?(this.parent.on("chartMouseClick",this.mouseUpHandler,this),this.parent.on("treeGridClick",this.popUpClickHandler,this)):this.parent.on("chartMouseUp",this.mouseUpHandler,this)},e.prototype.selectRowByIndex=function(){-1===this.parent.selectedRowIndex&&-1===this.parent.staticSelectedRowIndex||!this.parent.isLoad||(this.selectRow(-1!==this.parent.staticSelectedRowIndex?this.parent.staticSelectedRowIndex:this.parent.selectedRowIndex),this.parent.staticSelectedRowIndex=-1)},e.prototype.bindEvents=function(){this.parent.treeGrid.rowSelecting=this.rowSelecting.bind(this),this.parent.treeGrid.rowSelected=this.rowSelected.bind(this),this.parent.treeGrid.rowDeselecting=this.rowDeselecting.bind(this),this.parent.treeGrid.rowDeselected=this.rowDeselected.bind(this),this.parent.treeGrid.cellSelecting=this.cellSelecting.bind(this),this.parent.treeGrid.cellSelected=this.cellSelected.bind(this),this.parent.treeGrid.cellDeselecting=this.cellDeselecting.bind(this),this.parent.treeGrid.cellDeselected=this.cellDeselected.bind(this)},e.prototype.rowSelecting=function(e){this.parent.isGanttChartRendered?(e.isCtrlPressed=this.isMultiCtrlRequest,e.isShiftPressed=this.isMultiShiftRequest,e.target=this.actualTarget,sf.base.isNullOrUndefined(e.foreignKeyData)||0!==Object.keys(e.foreignKeyData).length||delete e.foreignKeyData,this.parent.trigger("rowSelecting",e)):e.cancel=!0},e.prototype.rowSelected=function(e){var t="Multiple"!==this.parent.selectionSettings.type||sf.base.isNullOrUndefined(e.rowIndexes)?[e.rowIndex]:e.rowIndexes;this.addRemoveClass(t),this.selectedRowIndexes=sf.base.extend([],this.getSelectedRowIndexes(),[],!0),this.parent.setProperties({selectedRowIndex:this.parent.treeGrid.grid.selectedRowIndex},!0),this.isMultiShiftRequest&&(this.selectedRowIndexes=t),this.parent.autoFocusTasks&&this.parent.ganttChartModule.updateScrollLeft(sf.base.getValue("data.ganttProperties.left",e)),e.target=this.actualTarget,sf.base.isNullOrUndefined(e.foreignKeyData)||0!==Object.keys(e.foreignKeyData).length||delete e.foreignKeyData,this.prevRowIndex=e.rowIndex,sf.base.isNullOrUndefined(this.parent.toolbarModule)||this.parent.toolbarModule.refreshToolbarItems(e),this.parent.trigger("rowSelected",e)},e.prototype.rowDeselecting=function(e){e.target=this.actualTarget,e.isInteracted=this.isInteracted,sf.base.isBlazor()&&"Multiple"===this.parent.selectionSettings.type&&(this.multipleIndexes=sf.base.extend([],e.rowIndex,[],!0)),this.parent.trigger("rowDeselecting",e)},e.prototype.rowDeselected=function(e){var t,i;if(0!==this.multipleIndexes.length)t=this.multipleIndexes;else if(sf.base.isNullOrUndefined(e.rowIndexes))t=[e.rowIndex];else{for(var r=0;r<e.rowIndexes.length;r++)e.rowIndexes[r]===e.rowIndex&&(i=!0);t=i?e.rowIndexes:[e.rowIndex]}this.addRemoveClass(t),this.selectedRowIndexes=sf.base.extend([],this.getSelectedRowIndexes(),[],!0),this.parent.setProperties({selectedRowIndex:-1},!0),sf.base.isNullOrUndefined(this.parent.toolbarModule)||this.parent.toolbarModule.refreshToolbarItems(),"Multiple"===this.parent.selectionSettings.type&&this.parent.isAdaptive&&0===this.selectedRowIndexes.length&&this.hidePopUp(),e.target=this.actualTarget,e.isInteracted=this.isInteracted,this.parent.trigger("rowDeselected",e),this.isInteracted=!1,this.multipleIndexes=[]},e.prototype.cellSelecting=function(e){var t=new sf.data.Deferred;return this.parent.trigger("cellSelecting",e,(function(e){t.resolve(e)})),t},e.prototype.cellSelected=function(e){this.parent.trigger("cellSelected",e),sf.base.isNullOrUndefined(this.parent.toolbarModule)||this.parent.toolbarModule.refreshToolbarItems()},e.prototype.cellDeselecting=function(e){this.parent.trigger("cellDeselecting",e)},e.prototype.cellDeselected=function(e){this.parent.trigger("cellDeselected",e),sf.base.isNullOrUndefined(this.parent.toolbarModule)||this.parent.toolbarModule.refreshToolbarItems()},e.prototype.selectCell=function(e,t){this.parent.treeGrid.selectCell(e,t)},e.prototype.selectCells=function(e){this.parent.treeGrid.grid.selectCells(e)},e.prototype.selectRow=function(e,t,i){var r,a=[].slice.call(this.parent.ganttChartModule.chartBodyContent.querySelector("tbody").children).filter((function(t){return parseInt(t.getAttribute("aria-rowindex"),0)===e}))[0];-1===e||sf.base.isNullOrUndefined(a)||"Cell"===this.parent.selectionSettings.mode||(this.parent.showActiveElement&&!i?this.parent.treeGrid.grid.selectionModule.preventFocus=!0:this.parent.treeGrid.grid.selectionModule.preventFocus=!1,sf.base.isNullOrUndefined(this.selectedClass)||this.selectedClass!==a||t||(r=!0),!0!==r&&this.parent.treeGrid.selectRow(e,t),this.parent.treeGrid.grid.selectionModule.preventFocus=!0!==this.parent.treeGrid.grid.selectionModule.preventFocus&&this.parent.treeGrid.grid.selectionModule.preventFocus,this.prevRowIndex=e,this.selectedClass=a)},e.prototype.selectRows=function(e){!sf.base.isNullOrUndefined(e)&&e.length>0&&this.parent.treeGrid.selectRows(e)},e.prototype.getSelectedRowIndexes=function(){return this.parent.treeGrid.getSelectedRowIndexes()},e.prototype.getSelectedRowCellIndexes=function(){return this.parent.treeGrid.getSelectedRowCellIndexes()},e.prototype.getSelectedRecords=function(){return sf.base.isBlazor()?this.parent.getRecordFromFlatdata(this.parent.treeGrid.getSelectedRecords()):this.parent.treeGrid.getSelectedRecords()},e.prototype.getCellSelectedRecords=function(){for(var e=this.parent.selectionModule.getSelectedRowCellIndexes(),t=[],i=0;i<e.length;i++)t.push(this.parent.currentViewData[e[i].rowIndex]);return sf.base.isBlazor()?this.parent.getRecordFromFlatdata(t):t},e.prototype.getSelectedRows=function(){return this.parent.treeGrid.getSelectedRows()},e.prototype.clearSelection=function(){this.addRemoveClass(this.selectedRowIndexes),this.parent.treeGrid.clearSelection(),this.parent.selectedRowIndex=-1,this.selectedRowIndexes=[],this.selectedClass=null,sf.base.isNullOrUndefined(this.parent.toolbarModule)||this.parent.toolbarModule.refreshToolbarItems(),this.isInteracted=!1},e.prototype.highlightSelectedRows=function(e,t){sf.base.closest(e.target,"tbody").children;if(this.isMultiCtrlRequest=e.ctrlKey||this.enableSelectMultiTouch,this.isMultiShiftRequest=e.shiftKey,this.actualTarget=e.target,this.isInteracted=!0,this.isSelectionFromChart=t,t){var i=sf.base.closest(e.target,"tr.e-chart-row"),r=parseInt(i.getAttribute("aria-rowindex"),10),a=this.parent.selectionSettings.enableToggle;if("Single"===this.parent.selectionSettings.type||!this.isMultiCtrlRequest&&!this.isMultiShiftRequest)this.selectRow(r,a);else if(this.isMultiShiftRequest)this.selectRowsByRange(sf.base.isNullOrUndefined(this.prevRowIndex)?r:this.prevRowIndex,r);else sf.base.setValue("isMultiCtrlRequest",!0,this.parent.treeGrid.grid.selectionModule),this.parent.treeGrid.grid.selectionModule.addRowsToSelection([r]),this.selectedRowIndexes.indexOf(r)>-1&&this.addRemoveClass([r])}},e.prototype.getselectedrowsIndex=function(e,t){for(var i=[],r=e<t?{i:e,max:t}:{i:t,max:e},a=r.i,s=r.max;a<=s;a++)i.push(a);e>t&&i.reverse(),this.selectedRowIndexes=i},e.prototype.selectRowsByRange=function(e,t){this.isSelectionFromChart=!0,this.getselectedrowsIndex(e,t),this.selectRows(this.selectedRowIndexes)},e.prototype.addRemoveClass=function(e){for(var t=[].slice.call(this.parent.ganttChartModule.chartBodyContent.querySelector("tbody").children),i=function(i){var a=t.filter((function(t){return parseInt(t.getAttribute("aria-rowindex"),0)===e[i]}))[0];sf.base.isNullOrUndefined(a)||(r.getSelectedRowIndexes().indexOf(e[i])>-1?r.addClass(a):r.removeClass(a))},r=this,a=0;a<e.length;a++)i(a)},e.prototype.addClass=function(e){sf.base.addClass([e],"e-active"),e.setAttribute("aria-selected","true")},e.prototype.removeClass=function(e){sf.base.removeClass([e],"e-active"),e.removeAttribute("aria-selected")},e.prototype.showPopup=function(e){this.isSelectionFromChart?(sf.grids.setCssInGridPopUp(this.parent.element.querySelector(".e-ganttpopup"),e,"e-rowselect e-icons e-icon-rowselect"+(this.enableSelectMultiTouch&&(this.getSelectedRecords().length>1||this.getSelectedRowCellIndexes().length>1)?" e-spanclicked":"")),document.getElementsByClassName("e-gridpopup")[0].style.display="none",this.openPopup=!0):0===this.selectedRowIndexes.length&&this.hidePopUp()},e.prototype.hidePopUp=function(){this.openPopup?(document.getElementsByClassName("e-ganttpopup")[0].style.display="none",this.openPopup=!1):document.getElementsByClassName("e-gridpopup")[0].style.display="none"},e.prototype.popUpClickHandler=function(e){var t=e.target,i=this.parent.treeGrid.grid,r=sf.base.closest(t,".e-ganttpopup")?sf.base.closest(t,".e-ganttpopup"):sf.base.closest(t,".e-gridpopup");if(r){var a=r.querySelector(".e-rowselect");sf.base.closest(t,".e-ganttpopup")&&!a.classList.contains("e-spanclicked")?(this.enableSelectMultiTouch=!0,a.classList.add("e-spanclicked")):sf.base.closest(t,".e-gridpopup")&&a.classList.contains("e-spanclicked")?(this.openPopup=!0,this.enableSelectMultiTouch=!0):(this.hidePopUp(),this.enableSelectMultiTouch=!1,sf.base.closest(t,".e-ganttpopup")&&a.classList.remove("e-spanclicked"))}else if("Multiple"===this.parent.selectionSettings.type&&this.parent.isAdaptive){sf.base.closest(t,".e-rowcell")&&0===this.selectedRowIndexes.length&&this.hidePopUp()}i&&sf.base.setValue("enableSelectMultiTouch",this.enableSelectMultiTouch,i.selectionModule)},e.prototype.mouseUpHandler=function(e){var t=!1,i=null;if(e.target.closest(".e-rowcell")?i=e.target:e.target.closest(".e-chart-row")&&(i=e.target.closest(".e-left-label-container")||e.target.closest(".e-taskbar-main-container")||e.target.closest(".e-right-label-container")),this.parent.focusModule&&this.parent.focusModule.setActiveElement(i),this.parent.editModule&&this.parent.editSettings.allowTaskbarEditing&&this.parent.editModule.taskbarEditModule){var r=this.parent.editModule.taskbarEditModule;(r.isMouseDragged||r.tapPointOnFocus)&&(t=!0)}if(!t&&this.parent.element.contains(e.target)){var a=sf.grids.parentsUntil(e.target,"e-chart-row"),s=e.target.classList.contains("e-rowcell")||e.target.classList.contains("e-row")||e.target.classList.contains("e-treegridexpand")||e.target.classList.contains("e-treegridcollapse")||!sf.base.isNullOrUndefined(a);this.popUpClickHandler(e),"Cell"!==this.parent.selectionSettings.mode&&s?(sf.base.closest(e.target,"tr.e-chart-row")?this.highlightSelectedRows(e,!0):this.highlightSelectedRows(e,!1),"Multiple"===this.parent.selectionSettings.type&&this.parent.isAdaptive&&(this.selectedRowIndexes.length>0?this.showPopup(e):this.hidePopUp())):this.isSelectionFromChart=!1}},e.prototype.maintainSelectedRecords=function(e){this.parent.selectionModule.getSelectedRowIndexes().indexOf(e)>-1&&this.addRemoveClass([e])},e.prototype.destroy=function(){this.parent.isDestroyed||(this.parent.off("selectRowByIndex",this.selectRowByIndex),this.parent.isAdaptive?(this.parent.off("chartMouseClick",this.mouseUpHandler),this.parent.off("treeGridClick",this.popUpClickHandler)):this.parent.off("chartMouseUp",this.mouseUpHandler))},e}(),xt=function(){function e(e){this.predefinedItems={},this.items=["Add","Edit","Update","Delete","Cancel","ExpandAll","CollapseAll","Search","PrevTimeSpan","NextTimeSpan","ZoomIn","ZoomOut","ZoomToFit","ExcelExport","CsvExport","PdfExport","Indent","Outdent"],this.parent=e,this.id=this.parent.element.id,this.parent.on("ui-toolbarupdate",this.propertyChanged,this)}return e.prototype.getModuleName=function(){return"toolbar"},e.prototype.renderToolbar=function(){if((this.parent.toolbar||[]).length>0){this.element=sf.base.createElement("div",{id:this.parent.controlId+"_Gantt_Toolbar",className:"e-gantt-toolbar"}),this.parent.treeGrid.grid.headerModule?this.parent.element.insertBefore(this.element,this.parent.treeGridPane.offsetParent):this.parent.element.appendChild(this.element);for(var e=0,t=["Add","Edit","Update","Delete","Cancel","ExpandAll","CollapseAll","PrevTimeSpan","NextTimeSpan","ZoomIn","ZoomOut","ZoomToFit","ExcelExport","CsvExport","PdfExport","Indent","Outdent"];e<t.length;e++){var i=t[e],r=i.toLowerCase(),a=i[0].toLowerCase()+i.slice(1);this.predefinedItems[i]={id:this.parent.element.id+"_"+r,prefixIcon:"e-"+r,text:this.parent.isAdaptive?"":this.parent.localeObj.getConstant(a),tooltipText:this.parent.localeObj.getConstant(a)+("add"===a||"edit"===a||"delete"===a?this.parent.localeObj.getConstant("task"):"expandAll"===a||"collapseAll"===a?this.parent.localeObj.getConstant("tasks"):""),align:this.parent.isAdaptive?"Right":"Left"}}var s=this.parent.localeObj.getConstant("search");this.parent.isAdaptive?this.predefinedItems.Search={id:this.id+"_searchbutton",prefixIcon:"e-search-icon",tooltipText:s,align:"Right"}:this.predefinedItems.Search={id:this.id+"_search",template:'<div class="e-input-group e-search" role="search"><input id="'+this.id+'_searchbar" class="e-input" name="input" type="search"placeholder= "'+s+'"/><span id="'+this.id+'_searchbutton" class="e-input-group-icon e-search-icon e-icons"tabindex="-1" title="'+s+'" aria-label= "search"></span></div>',tooltipText:s,align:"Right",cssClass:"e-search-wrapper"},this.createToolbar()}},e.prototype.createToolbar=function(){var e=this.getItems();this.toolbar=new sf.navigations.Toolbar({items:e,clicked:this.toolbarClickHandler.bind(this),height:this.parent.isAdaptive?48:"auto"}),this.toolbar.isStringTemplate=!0,this.toolbar.appendTo(this.element);var t=this.element.querySelector("#"+this.parent.element.id+"_cancel"),i=this.element.querySelector("#"+this.parent.element.id+"_update");(t&&sf.base.addClass([t],"e-grid"),i&&sf.base.addClass([i],"e-grid"),this.parent.isAdaptive)?(this.element.insertBefore(this.getSearchBarElement(),this.element.childNodes[0]),this.searchElement=this.element.querySelector("#"+this.parent.element.id+"_searchbar"),new sf.inputs.TextBox({placeholder:this.parent.localeObj.getConstant("search"),floatLabelType:"Never",showClearButton:!0}).appendTo(this.searchElement)):this.searchElement=this.element.querySelector("#"+this.parent.element.id+"_searchbar");this.parent.filterModule&&(this.wireEvent(),this.parent.searchSettings&&this.updateSearchTextBox()),this.parent.readOnly&&this.enableItems([this.parent.element.id+"_add",this.parent.element.id+"_update",this.parent.element.id+"_delete",this.parent.element.id+"_cancel",this.parent.element.id+"_indent",this.parent.element.id+"_outdent"],!1)},e.prototype.getSearchBarElement=function(){var e=this,t=sf.base.createElement("div",{className:"e-adaptive-searchbar",styles:"display: none"}),i=sf.base.createElement("input",{attrs:{type:"text"},id:this.parent.element.id+"_searchbar"}),r=sf.base.createElement("span",{className:"e-backarrowspan e-icons"});return r.onclick=function(){t.style.display="none",e.element.childNodes[1].style.display="block"},t.appendChild(r),t.appendChild(i),t},e.prototype.wireEvent=function(){this.searchElement&&(sf.base.EventHandler.add(this.searchElement,"keyup",this.keyUpHandler,this),sf.base.EventHandler.add(this.searchElement,"focus",this.focusHandler,this),sf.base.EventHandler.add(this.searchElement,"blur",this.blurHandler,this))},e.prototype.propertyChanged=function(e){sf.base.getValue("module",e)===this.getModuleName()&&this.parent.toolbar&&(this.element&&this.element.parentNode&&sf.base.remove(this.element),this.renderToolbar(),this.refreshToolbarItems())},e.prototype.unWireEvent=function(){this.searchElement&&(sf.base.EventHandler.remove(this.searchElement,"keyup",this.keyUpHandler),sf.base.EventHandler.remove(this.searchElement,"focus",this.focusHandler),sf.base.EventHandler.remove(this.searchElement,"blur",this.blurHandler),this.searchElement=null),this.parent.off("ui-toolbarupdate",this.propertyChanged)},e.prototype.keyUpHandler=function(e){13===e.keyCode&&this.parent.searchSettings.key!==this.searchElement.value&&(this.parent.searchSettings.key=this.searchElement.value,this.parent.dataBind())},e.prototype.focusHandler=function(e){e.target.parentElement.classList.add("e-input-focus")},e.prototype.blurHandler=function(e){e.target.parentElement.classList.remove("e-input-focus")},e.prototype.updateSearchTextBox=function(){this.searchElement&&this.searchElement.value!==this.parent.searchSettings.key&&(this.searchElement.value=this.parent.searchSettings.key)},e.prototype.getItems=function(){var e=[],t=this.parent.toolbar,r=-1;if(t.forEach((function(e,t){("string"==typeof e&&"Search"===e||"object"===i(e)&&"Search"===e.text)&&(r=t)})),r>-1){var a=t.splice(r,1);t.push(a[0])}for(var s=0,n=t;s<n.length;s++){var o=n[s];"string"==typeof o?e.push(this.getItemObject(o)):e.push(this.getItem(o))}return e},e.prototype.getItem=function(e){var t=this.predefinedItems[e.text];return t?sf.base.extend(t,t,e):e},e.prototype.getItemObject=function(e){return this.predefinedItems[e]||{text:e,id:this.id+"_"+e}},e.prototype.toolbarClickHandler=function(e){var t=this,i=this.parent,r=this.id;sf.base.extend(e,{cancel:!1}),i.trigger("toolbarClick",e,(function(e){if(!e.cancel)switch(!0===t.parent.isAdaptive&&(e.item.id!==r+"_edit"&&e.item.id!==r+"_add"&&e.item.id!==r+"_delete"&&e.item.id!==r+"_searchbutton"&&e.item.id!==r+"_expandall"&&e.item.id!==r+"_collapseall"||t.parent.selectionModule&&"Multiple"===t.parent.selectionSettings.type&&(t.parent.selectionModule.hidePopUp(),document.getElementsByClassName("e-gridpopup")[0].style.display="none")),!sf.base.isNullOrUndefined(e.item)&&e.item.id){case r+"_edit":i.editModule&&i.editSettings.allowEditing&&i.editModule.dialogModule.openToolbarEditDialog();break;case r+"_indent":i.editModule&&i.selectionModule.getSelectedRecords().length&&i.indent();break;case r+"_outdent":i.editModule&&i.selectionModule.getSelectedRecords().length&&i.outdent();break;case r+"_update":i.editModule.cellEditModule.isCellEdit=!1,i.treeGrid.grid.saveCell();break;case r+"_cancel":i.cancelEdit();break;case r+"_add":i.editModule&&i.editSettings.allowAdding&&i.editModule.dialogModule.openAddDialog();break;case r+"_delete":t.parent.selectionModule&&t.parent.editModule&&("Cell"!==t.parent.selectionSettings.mode&&t.parent.selectionModule.selectedRowIndexes.length||"Cell"===t.parent.selectionSettings.mode&&t.parent.selectionModule.getSelectedRowCellIndexes().length)&&t.parent.editModule.startDeleteAction();break;case r+"_search":if(sf.base.getValue("originalEvent.target.id",e)===t.parent.element.id+"_searchbutton"&&t.parent.filterModule){var a=t.element.querySelector("#"+t.parent.element.id+"_searchbar").value;t.parent.searchSettings.key!==a&&(t.parent.searchSettings.key=a,t.parent.dataBind())}break;case r+"_searchbutton":var s=t.element.querySelector(".e-adaptive-searchbar");s.parentElement.childNodes[1].style.display="none",s.style.display="block";break;case r+"_expandall":t.parent.ganttChartModule.expandCollapseAll("expand");break;case r+"_collapseall":t.parent.ganttChartModule.expandCollapseAll("collapse");break;case r+"_prevtimespan":t.parent.previousTimeSpan();break;case r+"_nexttimespan":t.parent.nextTimeSpan();break;case r+"_zoomin":t.zoomIn();break;case r+"_zoomout":t.zoomOut();break;case r+"_zoomtofit":t.zoomToFit()}}))},e.prototype.zoomIn=function(){this.parent.timelineModule.processZooming(!0)},e.prototype.zoomToFit=function(){this.parent.timelineModule.processZoomToFit(),this.parent.ganttChartModule.updateScrollLeft(0)},e.prototype.zoomOut=function(){this.parent.timelineModule.processZooming(!1)},e.prototype.refreshToolbarItems=function(e){var t,i=this.parent,r=[],a=[],s=i.editSettings,n=this.id,o=i.selectedRowIndex,d=!!i.selectionModule&&(1===i.selectionModule.selectedRowIndexes.length||1===i.selectionModule.getSelectedRowCellIndexes().length),l=this.toolbar?this.toolbar.items:[],p=[n+"_add",n+"_edit",n+"_delete",n+"_update",n+"_cancel",n+"_indent",n+"_outdent"],h="ResourceView"===this.parent.viewType&&0!==sf.base.getValue("data.level",e)||"ProjectView"===this.parent.viewType;if(sf.base.isNullOrUndefined(this.parent.editModule))a.push(n+"_delete"),a.push(n+"_add"),a.push(n+"_edit"),a.push(n+"_update"),a.push(n+"_cancel");else{var c=!!i.editModule.taskbarEditModule&&i.editModule.taskbarEditModule.touchEdit,u=i.flatData&&i.flatData.length;s.allowAdding&&!c?r.push(n+"_add"):a.push(n+"_add"),s.allowEditing&&h&&u&&d&&!c?r.push(n+"_edit"):a.push(n+"_edit"),s.allowEditing&&0!==o&&-1!==o&&u&&d&&"ResourceView"!==this.parent.viewType?0===i.updatedRecords[o].level&&u&&!c?(r.push(n+"_indent"),a.push(n+"_outdent")):(t=i.updatedRecords[o-1],i.updatedRecords[o].level-t.level==1&&-1!==o?(a.push(n+"_indent"),r.push(n+"_outdent")):-1!==o&&(r.push(n+"_indent"),r.push(n+"_outdent"))):(a.push(n+"_indent"),a.push(n+"_outdent"));var f=!!i.selectionModule&&(i.selectionModule.selectedRowIndexes.length>0||i.selectionModule.getSelectedRowCellIndexes().length>0);if(s.allowDeleting&&h&&u&&f&&!c?r.push(n+"_delete"):a.push(n+"_delete"),"Auto"===i.editSettings.mode&&!sf.base.isNullOrUndefined(i.editModule.cellEditModule)&&i.editModule.cellEditModule.isCellEdit){(r=[]).push(n+"_update",n+"_cancel"),a=[];for(var g=0;g<l.length;g++)l[g].id!==n+"_update"&&l[g].id!==n+"_cancel"&&-1!==p.indexOf(l[g].id)&&a.push(l[g].id)}else{a.push(n+"_update",n+"_cancel");for(g=0;g<l.length;g++)-1===r.indexOf(l[g].id)&&-1===a.indexOf(l[g].id)&&r.push(l[g].id)}}for(var m=0;m<r.length;m++){var y=void 0;for(g=0;g<l.length;g++)if(l[g].id===r[m]){y=g;break}l.length>0&&this.toolbar.hideItem(y,!1)}for(var b=0;b<a.length;b++){for(y=void 0,g=0;g<l.length;g++)if(l[g].id===a[b]){y=g;break}l.length>0&&this.toolbar.hideItem(y,!0)}},e.prototype.enableItems=function(e,t){for(var i=0,r=e;i<r.length;i++){var a=r[i],s=this.element.querySelector("#"+a);s&&this.toolbar.enableItems(s.parentElement,t)}},e.prototype.destroy=function(){this.parent.isDestroyed||(this.toolbar.destroy(),this.parent.filterModule&&this.unWireEvent(),sf.base.remove(this.element))},e}(),Rt=function(){function e(e){this.parent=e,this.nonworkingContainer=null,this.holidayContainer=null,this.weekendContainer=null}return e.prototype.createNonworkingContainer=function(){this.parent.ganttChartModule.chartBodyContent.contains(this.nonworkingContainer)||(this.nonworkingContainer=sf.base.createElement("div",{className:"e-nonworking-day-container"}),this.parent.virtualScrollModule&&this.parent.enableVirtualization?this.parent.ganttChartModule.virtualRender.appendChildElements(this.nonworkingContainer):this.parent.ganttChartModule.chartBodyContent.appendChild(this.nonworkingContainer))},e.prototype.renderHolidays=function(){this.parent.holidays&&this.parent.holidays.length>0?(this.createNonworkingContainer(),this.nonworkingContainer.contains(this.holidayContainer)||(this.holidayContainer=sf.base.createElement("div",{className:"e-holiday-container"}),this.nonworkingContainer.appendChild(this.holidayContainer)),this.holidayContainer.innerHTML=this.getHolidaysElement().innerHTML):this.holidayContainer&&(sf.base.remove(this.holidayContainer),this.nonworkingContainer&&0===this.nonworkingContainer.childNodes.length&&sf.base.remove(this.nonworkingContainer))},e.prototype.getHolidaysElement=function(){for(var e,t,i=sf.base.createElement("div"),r=this.parent.contentHeight,a=this.parent.ganttChartModule.scrollElement,s=parseInt(a.style.height,10),n=0;n<this.parent.holidays.length;n++){this.parent.holidays[n].from&&this.parent.holidays[n].to?(e=this.parent.dateValidationModule.getDateFromFormat(this.parent.holidays[n].from),(t=this.parent.dateValidationModule.getDateFromFormat(this.parent.holidays[n].to)).setDate(t.getDate()+1),e.setHours(0,0,0,0),t.setHours(0,0,0,0)):this.parent.holidays[n].from?(e=this.parent.dateValidationModule.getDateFromFormat(this.parent.holidays[n].from)).setHours(0,0,0,0):this.parent.holidays[n].to&&(e=this.parent.dateValidationModule.getDateFromFormat(this.parent.holidays[n].to)).setHours(0,0,0,0);var o=this.parent.holidays[n].from&&this.parent.holidays[n].to?this.parent.dataOperation.getTaskWidth(e,t):this.parent.perDayWidth,d=this.parent.dataOperation.getTaskLeft(e,!1),l=sf.base.createElement("div",{className:"e-holiday",styles:"left:"+d+"px; width:"+o+"px; height:100%;"}),p=s<r?s/2:r/2,h=sf.base.createElement("span",{className:"e-span",styles:"top:"+p+"px;left:"+o/2+"px;"});h[this.parent.disableHtmlEncode?"textContent":"innerHTML"]=this.parent.holidays[n].label?this.parent.holidays[n].label:"",l.appendChild(h),this.parent.holidays[n].cssClass&&l.classList.add(this.parent.holidays[n].cssClass),i.appendChild(l)}return i},e.prototype.renderWeekends=function(){this.parent.highlightWeekends?(this.createNonworkingContainer(),this.nonworkingContainer.contains(this.weekendContainer)||(this.weekendContainer=sf.base.createElement("div",{className:"e-weekend-container"}),this.nonworkingContainer.appendChild(this.weekendContainer)),this.weekendContainer.innerHTML=this.getWeekendElements().innerHTML):this.weekendContainer&&(sf.base.remove(this.weekendContainer),this.nonworkingContainer&&0===this.nonworkingContainer.childNodes.length&&sf.base.remove(this.nonworkingContainer))},e.prototype.getWeekendElements=function(){var e=sf.base.createElement("div"),t=new Date(this.parent.timelineModule.timelineStartDate.getTime()),i=new Date(this.parent.timelineModule.timelineEndDate.getTime()),r=this.parent.nonWorkingDayIndex,a=!0;do{if(-1!==r.indexOf(t.getDay())){var s=this.parent.dataOperation.getTaskLeft(t,!1),n=this.parent.perDayWidth;if(a){var o=new Date(t.getTime()),d=new Date(o.getTime());d.setDate(d.getDate()+1),d.setHours(0,0,0,0),n=this.parent.dataOperation.getTaskWidth(o,d),a=!1}var l=sf.base.createElement("div",{className:"e-weekend",styles:"left:"+s+"px;width:"+n+"px;height:100%;"});e.appendChild(l)}t.setDate(t.getDate()+1),t.setHours(0,0,0,0)}while(t<i);return e},e.prototype.updateHolidayLabelHeight=function(){for(var e=this.parent.contentHeight,t=this.parent.ganttChartModule.scrollElement,i=parseInt(t.style.height,10),r=i<e?i/2:e/2,a=this.holidayContainer.querySelectorAll(".e-span"),s=0;s<a.length;s++)a[s].style.top=sf.base.formatUnit(r)},e.prototype.updateContainerHeight=function(){var e=this.parent.getContentHeight();this.holidayContainer&&(this.holidayContainer.style.height=sf.base.formatUnit(e),this.updateHolidayLabelHeight()),this.weekendContainer&&(this.weekendContainer.style.height=sf.base.formatUnit(e))},e.prototype.removeContainers=function(){this.holidayContainer&&sf.base.remove(this.holidayContainer),this.weekendContainer&&sf.base.remove(this.weekendContainer),this.nonworkingContainer&&sf.base.remove(this.nonworkingContainer)},e}(),Mt=function(){function e(e){this.parent=e,this.eventMarkersContainer=null}return e.prototype.renderEventMarkers=function(){this.parent.eventMarkers&&this.parent.eventMarkers.length>0?(this.parent.ganttChartModule.chartBodyContent.contains(this.eventMarkersContainer)||(this.eventMarkersContainer=sf.base.createElement("div",{className:"e-event-markers-container"}),this.parent.virtualScrollModule&&this.parent.enableVirtualization?this.parent.ganttChartModule.virtualRender.appendChildElements(this.eventMarkersContainer):this.parent.ganttChartModule.chartBodyContent.appendChild(this.eventMarkersContainer)),this.eventMarkersContainer.innerHTML="",this.getEventMarkersElements(this.eventMarkersContainer)):this.removeContainer()},e.prototype.removeContainer=function(){this.eventMarkersContainer&&(sf.base.remove(this.eventMarkersContainer),this.eventMarkersContainer=null)},e.prototype.getEventMarkersElements=function(e){for(var t,i,r,a,s=0;s<this.parent.eventMarkers.length;s++){if(t=this.parent.dataOperation.getTaskLeft(this.parent.dateValidationModule.getDateFromFormat(this.parent.eventMarkers[s].day,!0),!1),i=sf.base.createElement("div",{className:"e-event-markers",styles:"left:"+t+"px;  height:100%;",id:"stripline"+s}),this.parent.eventMarkers[s].label)(r=sf.base.createElement("div",{className:"e-span-label"}))[this.parent.disableHtmlEncode?"textContent":"innerHTML"]=this.parent.eventMarkers[s].label,i.appendChild(r),a=sf.base.createElement("div",{className:"e-gantt-right-arrow"}),i.appendChild(a);this.parent.eventMarkers[s].cssClass&&i.classList.add(this.parent.eventMarkers[s].cssClass),i.setAttribute("tabindex","-1"),sf.base.isNullOrUndefined(this.parent.eventMarkers[s].day)||i.setAttribute("aria-label",this.parent.localeObj.getConstant("eventMarkers")+" "+("string"==typeof this.parent.eventMarkers[s].day?this.parent.eventMarkers[s].day:this.parent.getFormatedDate(this.parent.eventMarkers[s].day))+" "+this.parent.eventMarkers[s].label),e.appendChild(i)}},e.prototype.updateContainerHeight=function(){this.eventMarkersContainer&&(this.eventMarkersContainer.style.height=sf.base.formatUnit(this.parent.getContentHeight()))},e}(),Ot=function(){function e(e){this.parent=e,this.nonworkingDayRender=new Rt(this.parent),this.eventMarkerRender=new Mt(this.parent),this.wireEvents()}return e.prototype.wireEvents=function(){this.parent.on("refreshDayMarkers",this.refreshMarkers,this),this.parent.on("updateHeight",this.updateHeight,this),this.parent.on("ui-update",this.propertyChanged,this)},e.prototype.propertyChanged=function(e){for(var t=Object.keys(sf.base.getValue("properties",e)),i=0;i<t.length;i++){switch(t[i]){case"eventMarkers":this.eventMarkerRender.renderEventMarkers(),this.updateHeight();break;case"highlightWeekends":this.nonworkingDayRender.renderWeekends(),this.updateHeight();break;case"holidays":this.nonworkingDayRender.renderHolidays(),this.updateHeight()}}},e.prototype.refreshMarkers=function(){this.eventMarkerRender.renderEventMarkers(),this.nonworkingDayRender.renderWeekends(),this.nonworkingDayRender.renderHolidays()},e.prototype.updateHeight=function(){this.nonworkingDayRender.updateContainerHeight(),this.eventMarkerRender.updateContainerHeight()},e.prototype.getModuleName=function(){return"dayMarkers"},e.prototype.destroy=function(){this.parent.isDestroyed||(this.nonworkingDayRender.removeContainers(),this.eventMarkerRender.removeContainer(),this.parent.off("refreshDayMarkers",this.refreshMarkers),this.parent.off("updateHeight",this.updateHeight),this.parent.off("ui-update",this.propertyChanged))},e}(),It=function(){function e(e){var t=this;this.segmentIndex=-1,this.headerContextMenuClick=function(e){var i=sf.base.closest(e.event.target,".e-row"),r=sf.base.closest(e.event.target,".e-chart-row");sf.base.isNullOrUndefined(i)&&sf.base.isNullOrUndefined(r)&&(e.type="Header",t.parent.trigger("contextMenuClick",e))},this.headerContextMenuOpen=function(e){var i=sf.base.closest(e.event.target,".e-row"),r=sf.base.closest(e.event.target,".e-chart-row");sf.base.isNullOrUndefined(i)&&sf.base.isNullOrUndefined(r)?(e.type="Header",t.parent.trigger("contextMenuOpen",e)):e.cancel=!0},this.parent=e,this.ganttID=e.element.id,sf.treegrid.TreeGrid.Inject(sf.treegrid.ContextMenu),this.parent.treeGrid.contextMenuClick=this.headerContextMenuClick.bind(this),this.parent.treeGrid.contextMenuOpen=this.headerContextMenuOpen.bind(this),this.addEventListener(),this.resetItems()}return e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on("initiate-contextMenu",this.render,this),this.parent.on("reRender-contextMenu",this.reRenderContextMenu,this),this.parent.on("contextMenuClick",this.contextMenuItemClick,this),this.parent.on("contextMenuOpen",this.contextMenuBeforeOpen,this))},e.prototype.reRenderContextMenu=function(e){e.module===this.getModuleName()&&e.enable&&(this.contextMenu&&(this.contextMenu.destroy(),sf.base.remove(this.element)),this.resetItems(),this.render())},e.prototype.render=function(){this.element=this.parent.createElement("ul",{id:this.ganttID+"_contextmenu",className:"e-grid"}),this.parent.element.appendChild(this.element);var e="#"+this.ganttID;this.contextMenu=new sf.navigations.ContextMenu({items:this.getMenuItems(),locale:this.parent.locale,target:e,animationSettings:{effect:"None"},select:this.contextMenuItemClick.bind(this),beforeOpen:this.contextMenuBeforeOpen.bind(this),onOpen:this.contextMenuOpen.bind(this),onClose:this.contextMenuOnClose.bind(this),cssClass:"e-gantt"}),this.contextMenu.appendTo(this.element),this.parent.treeGrid.contextMenuItems=this.headerMenuItems},e.prototype.contextMenuItemClick=function(e){var t,i,r;this.item=this.getKeyFromId(e.item.id);var a=sf.base.getValue("parentObj",e.item),s=-1;switch(a&&!sf.base.isNullOrUndefined(a.id)&&"DeleteDependency"===this.getKeyFromId(a.id)&&(s=a.items.indexOf(e.item)),this.parent.isAdaptive&&("TaskInformation"!==this.item&&"Above"!==this.item&&"Below"!==this.item&&"Child"!==this.item&&"DeleteTask"!==this.item||this.parent.selectionModule&&"Multiple"===this.parent.selectionSettings.type&&(this.parent.selectionModule.hidePopUp(),document.getElementsByClassName("e-gridpopup")[0].style.display="none")),this.item){case"TaskInformation":this.parent.openEditDialog(Number(this.rowData.ganttProperties.rowUniqueID));break;case"Above":case"Below":case"Child":if(t=this.item,i=sf.base.extend({},{},this.rowData.taskData,!0),r=this.parent.taskFields,sf.base.isNullOrUndefined(r.dependency)||(i[r.dependency]=null),!sf.base.isNullOrUndefined(r.child)&&i[r.child]&&delete i[r.child],!sf.base.isNullOrUndefined(r.parentID)&&i[r.parentID]&&(i[r.parentID]=null),this.rowData){var n=this.parent.updatedRecords.indexOf(this.rowData);this.parent.addRecord(i,t,n)}break;case"Milestone":case"ToMilestone":this.parent.convertToMilestone(this.rowData.ganttProperties.rowUniqueID);break;case"DeleteTask":this.parent.editModule.deleteRecord(this.rowData);break;case"ToTask":if(i=sf.base.extend({},{},this.rowData.taskData,!0),r=this.parent.taskFields,sf.base.isNullOrUndefined(r.duration)){i[r.startDate]=new Date(this.rowData.taskData[r.startDate]);var o=new Date(this.rowData.taskData[r.startDate]);o.setDate(o.getDate()+1),i[r.endDate]=o}else{var d=this.rowData.ganttProperties;i[r.duration]="1 "+d.durationUnit}sf.base.isNullOrUndefined(i[r.milestone])||!0===i[r.milestone]&&(i[r.milestone]=!1),this.parent.updateRecordByID(i);break;case"Cancel":this.parent.cancelEdit();break;case"Save":this.parent.editModule.cellEditModule.isCellEdit=!1,this.parent.treeGrid.grid.saveCell();break;case"Dependency"+s:this.parent.connectorLineEditModule.removePredecessorByIndex(this.rowData,s);break;case"Auto":case"Manual":this.parent.changeTaskMode(this.rowData);break;case"Indent":this.parent.indent();break;case"Outdent":this.parent.outdent();break;case"Left":case"Right":this.mergeCall(this.item);break;case"SplitTask":this.splitTaskCall(e)}e.type="Content",e.rowData=this.rowData,this.parent.trigger("contextMenuClick",e)},e.prototype.splitTaskCall=function(e){var t=this,i=this.parent.taskFields,r=this.getClickedDate(e.element);r.setHours(0,0,0,0);var a={rowData:this.rowData,requestType:"splitTaskbar",splitDate:r,cancel:!1,target:this.targetElement};this.parent.trigger("actionBegin",a,(function(e){t.parent.chartRowsModule.splitTask(t.rowData[i.id],r)}))},e.prototype.mergeCall=function(e){var t=this,i=this.parent.taskFields,r=this.rowData.ganttProperties.segments,a=[{firstSegmentIndex:"Right"===e?this.segmentIndex:r[this.segmentIndex-1].segmentIndex,secondSegmentIndex:"Left"===e?this.segmentIndex:r[this.segmentIndex+1].segmentIndex}],s={rowData:this.rowData,mergeSegmentIndexes:a,requestType:"mergeSegment",cancel:!1,target:this.targetElement};this.parent.trigger("actionBegin",s,(function(e){t.parent.chartRowsModule.mergeTask(t.rowData[i.id],a)}))},e.prototype.getClickedDate=function(e){this.parent.taskFields;var t=this.parent.getOffsetRect(this.parent.element).left-this.parent.element.offsetLeft+this.parent.ganttChartModule.chartElement.offsetLeft+this.rowData.ganttProperties.left-this.parent.ganttChartModule.scrollElement.scrollLeft,i=this.clickedPosition-t,r=Math.ceil(i/this.parent.perDayWidth),a=this.rowData.ganttProperties.startDate;return this.parent.dataOperation.getEndDate(a,r,this.rowData.ganttProperties.durationUnit,this.rowData,!1)},e.prototype.contextMenuBeforeOpen=function(e){var t=this,i=e.event?e.event.target:this.parent.focusModule?this.parent.ganttChartModule.targetElement:this.parent.focusModule.getActiveElement();sf.base.isNullOrUndefined(e.element)||e.element.id!==this.parent.element.id+"_contextmenu"||(this.clickedPosition=sf.base.getValue("event",e).clientX);var r=sf.base.closest(i,".e-gantt-child-taskbar");r&&(this.targetElement=e.target=r),e.gridRow=sf.base.closest(i,".e-row"),e.chartRow=sf.base.closest(i,".e-chart-row");var a=sf.base.closest(i,".e-gantt");if(!sf.base.closest(i,".e-gridform")&&this.parent.editModule&&this.parent.editModule.cellEditModule&&this.parent.editModule.cellEditModule.isCellEdit&&this.parent.editModule.dialogModule.dialogObj&&!this.parent.editModule.dialogModule.dialogObj.open&&(this.parent.treeGrid.grid.saveCell(),this.parent.editModule.cellEditModule.isCellEdit=!1),this.parent.readOnly&&this.contextMenu.enableItems(["Add","Save","Convert","Delete Dependency","Delete Task","TaskMode","Indent","Outdent","SplitTask","MergeTask"],!1),(sf.base.isNullOrUndefined(e.gridRow)&&sf.base.isNullOrUndefined(e.chartRow)||0===this.contentMenuItems.length)&&(sf.base.isNullOrUndefined(e.parentItem)||sf.base.isNullOrUndefined(a)?e.cancel=!0:e.cancel=!1),!e.cancel){var s=-1;e.gridRow?s=parseInt(e.gridRow.getAttribute("aria-rowindex"),0):e.chartRow&&(s=parseInt(e.chartRow.getAttribute("aria-rowindex"),0)),this.parent.selectionModule&&this.parent.allowSelection&&!e.parentItem&&!sf.base.isNullOrUndefined(e.chartRow)&&this.parent.selectionModule.selectRow(s),e.parentItem||(this.rowData=this.parent.updatedRecords[s]);for(var n=0,o=e.items;n<o.length;n++){var d=o[n];d.separator||this.updateItemStatus(d,i,s)}if(e.rowData=this.rowData,e.type="Content",e.disableItems=this.disableItems,e.hideItems=this.hideItems,e.hideChildItems=[],0===e.rowData.level&&"ResourceView"===this.parent.viewType)return void(e.cancel=!0);var l=new sf.data.Deferred;return this.parent.trigger("contextMenuOpen",e,(function(i){l.resolve(i),sf.base.isBlazor()&&(i.element=sf.base.isNullOrUndefined(i.element)?i.element:sf.base.getElement(i.element),i.gridRow=sf.base.isNullOrUndefined(i.gridRow)?i.gridRow:sf.base.getElement(i.gridRow),i.chartRow=sf.base.isNullOrUndefined(i.chartRow)?i.chartRow:sf.base.getElement(i.chartRow)),t.hideItems=i.hideItems,t.disableItems=i.disableItems,i.parentItem||i.hideItems.length!==i.items.length||(t.revertItemStatus(),i.cancel=!0),t.hideItems.length>0&&t.contextMenu.hideItems(t.hideItems),t.disableItems.length>0&&t.contextMenu.enableItems(t.disableItems,!1),e.hideChildItems.length>0&&t.contextMenu.hideItems(e.hideChildItems)})),l}},e.prototype.updateItemStatus=function(e,t,i){var r=this.getKeyFromId(e.id),a=sf.base.closest(t,".e-gridform"),s=[],n=sf.base.closest(t,".e-gantt-child-taskbar");if(a)"Save"!==r&&"Cancel"!==r&&this.hideItems.push(e.text);else switch(r){case"TaskInformation":this.parent.editSettings.allowEditing&&this.parent.editModule||this.updateItemVisibility(e.text);break;case"Add":this.parent.editSettings.allowAdding&&this.parent.editModule||this.updateItemVisibility(e.text);break;case"Save":case"Cancel":this.hideItems.push(e.text);break;case"Convert":this.rowData.hasChildRecords?this.hideItems.push(e.text):this.parent.editSettings.allowEditing&&this.parent.editModule?(this.rowData.ganttProperties.isMilestone?s.push(this.createItemModel(Z,"ToTask",this.getLocale("toTask"))):s.push(this.createItemModel(Z,"ToMilestone",this.getLocale("toMilestone"))),e.items=s):this.updateItemVisibility(e.text);break;case"DeleteDependency":var o=this.getPredecessorsItems();this.rowData.hasChildRecords?this.hideItems.push(e.text):this.parent.editSettings.allowDeleting&&0!==o.length&&this.parent.editModule?o.length>0&&(e.items=o):this.updateItemVisibility(e.text);break;case"DeleteTask":this.parent.editSettings.allowDeleting&&this.parent.editModule||this.updateItemVisibility(e.text);break;case"TaskMode":"Custom"!==this.parent.taskMode?this.updateItemVisibility(e.text):(this.rowData.ganttProperties.isAutoSchedule?s.push(this.createItemModel(Z,"Manual",this.getLocale("manual"))):s.push(this.createItemModel(Z,"Auto",this.getLocale("auto"))),e.items=s);break;case"Indent":var d=this.parent.selectedRowIndex,l=!!this.parent.selectionModule&&(1===this.parent.selectionModule.selectedRowIndexes.length||1===this.parent.selectionModule.getSelectedRowCellIndexes().length),p=this.parent.updatedRecords[this.parent.selectionModule.getSelectedRowIndexes()[0]-1];this.parent.editSettings.allowEditing&&0!==d&&-1!==d&&l&&"ResourceView"!==this.parent.viewType&&this.parent.updatedRecords[d].level-p.level!=1||this.updateItemVisibility(e.text);break;case"Outdent":var h=this.parent.selectionModule.getSelectedRowIndexes()[0],c=!!this.parent.selectionModule&&(1===this.parent.selectionModule.selectedRowIndexes.length||1===this.parent.selectionModule.getSelectedRowCellIndexes().length);this.parent.editSettings.allowEditing&&-1!==h&&0!==h&&c&&"ResourceView"!==this.parent.viewType&&0!==this.parent.updatedRecords[h].level||this.updateItemVisibility(e.text);break;case"SplitTask":var u=this.parent.taskFields;(this.parent.readOnly||!n||sf.base.isNullOrUndefined(u.segments)||this.parent.currentViewData[i].hasChildRecords)&&this.updateItemVisibility(e.text);break;case"MergeTask":this.parent.readOnly||!n?this.updateItemVisibility(e.text):this.mergeItemVisiblity(t,e)}},e.prototype.mergeItemVisiblity=function(e,t){var i=[],r=this.parent.taskFields,a=this.getClickedDate(e);this.segmentIndex=this.parent.chartRowsModule.getSegmentIndex(a,this.rowData);var s=this.rowData.ganttProperties.segments;!sf.base.isNullOrUndefined(s)&&s.length>0?sf.base.isNullOrUndefined(r.segments)&&-1===this.segmentIndex?this.updateItemVisibility(t.text):(0===this.segmentIndex?i.push(this.createItemModel(Z,"Right",this.getLocale("right"))):(this.segmentIndex===s.length-1||i.push(this.createItemModel(Z,"Right",this.getLocale("right"))),i.push(this.createItemModel(Z,"Left",this.getLocale("left")))),t.items=i):this.hideItems.push(t.text)},e.prototype.updateItemVisibility=function(e){!!sf.base.isNullOrUndefined(this.parent.contextMenuItems)?this.hideItems.push(e):this.disableItems.push(e)},e.prototype.contextMenuOpen=function(e){this.isOpen=!0;var t=e.element.querySelectorAll("li:not(.e-menu-hide)")[0];sf.base.addClass([t],"e-focused")},e.prototype.getMenuItems=function(){for(var e=0,t=sf.base.isNullOrUndefined(this.parent.contextMenuItems)?this.getDefaultItems():this.parent.contextMenuItems;e<t.length;e++){var i=t[e];"string"==typeof i&&-1!==this.getDefaultItems().indexOf(i)?this.buildDefaultItems(i):"string"!=typeof i&&(-1!==this.getDefaultItems().indexOf(i.text)?this.buildDefaultItems(i.text,i.iconCss):".e-gridheader"===i.target?this.headerMenuItems.push(i):this.contentMenuItems.push(i))}return this.contentMenuItems},e.prototype.createItemModel=function(e,t,i,r){return{text:i,id:this.generateID(t),target:e,iconCss:r?"e-icons "+r:null}},e.prototype.getLocale=function(e){return this.parent.localeObj.getConstant(e)},e.prototype.buildDefaultItems=function(e,t){var i;switch(e){case"AutoFitAll":case"AutoFit":case"SortAscending":case"SortDescending":this.headerMenuItems.push(e);break;case"TaskInformation":i=this.createItemModel(Z,e,this.getLocale("taskInformation"),this.getIconCSS("e-edit",t));break;case"Indent":i=this.createItemModel(Z,e,this.getLocale("indent"),this.getIconCSS("e-indent",t));break;case"Outdent":i=this.createItemModel(Z,e,this.getLocale("outdent"),this.getIconCSS("e-outdent",t));break;case"Save":i=this.createItemModel("e-edit",e,this.getLocale("save"),this.getIconCSS("e-save",t));break;case"Cancel":i=this.createItemModel("e-edit",e,this.getLocale("cancel"),this.getIconCSS("e-cancel",t));break;case"Add":(i=this.createItemModel(Z,e,this.getLocale("add"),this.getIconCSS("e-add",t))).items=[],i.items.push(this.createItemModel(Z,"Above",this.getLocale("above"),this.getIconCSS("e-add-above",t))),i.items.push(this.createItemModel(Z,"Below",this.getLocale("below"),this.getIconCSS("e-add-below",t))),"ResourceView"!==this.parent.viewType&&i.items.push(this.createItemModel(Z,"Child",this.getLocale("child"))),i.items.push(this.createItemModel(Z,"Milestone",this.getLocale("milestone")));break;case"DeleteTask":i=this.createItemModel(Z,e,this.getLocale("deleteTask"),this.getIconCSS("e-delete",t));break;case"DeleteDependency":(i=this.createItemModel(Z,e,this.getLocale("deleteDependency"))).items=[],i.items.push({});break;case"Convert":(i=this.createItemModel(Z,e,this.getLocale("convert"))).items=[],i.items.push({});break;case"TaskMode":(i=this.createItemModel(Z,e,this.getLocale("changeScheduleMode"))).items=[],i.items.push({});break;case"SplitTask":i=this.createItemModel(Z,e,this.getLocale("splitTask"));break;case"MergeTask":(i=this.createItemModel(Z,e,this.getLocale("mergeTask"))).items=[],i.items.push({})}i&&this.contentMenuItems.push(i)},e.prototype.getIconCSS=function(e,t){return sf.base.isNullOrUndefined(t)?e:t},e.prototype.getPredecessorsItems=function(){this.predecessors=this.parent.predecessorModule.getValidPredecessor(this.rowData);for(var e,t=[],i=0,r=0,a=this.predecessors;r<a.length;r++){var s=a[r],n=this.parent.getRecordByID(s.from).ganttProperties,o=n.rowUniqueID+" - "+n.taskName,d="Dependency"+i++;e=this.createItemModel(Z,d,o),t.push(e)}return t},e.prototype.getDefaultItems=function(){return["AutoFitAll","AutoFit","TaskInformation","DeleteTask","Save","Cancel","SortAscending","SortDescending","Add","DeleteDependency","Convert","TaskMode","Indent","Outdent","SplitTask","MergeTask"]},e.prototype.getModuleName=function(){return"contextMenu"},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("initiate-contextMenu",this.render),this.parent.off("reRender-contextMenu",this.reRenderContextMenu),this.parent.off("contextMenuClick",this.contextMenuItemClick),this.parent.off("contextMenuOpen",this.contextMenuOpen))},e.prototype.contextMenuOnClose=function(e){e.items.length>0&&e.items[0].parentObj instanceof sf.navigations.ContextMenu&&this.revertItemStatus()},e.prototype.revertItemStatus=function(){sf.base.isBlazor()&&sf.base.isNullOrUndefined(this.disableItems)&&(this.disableItems=[]),this.contextMenu.showItems(this.hideItems),this.contextMenu.enableItems(this.disableItems),this.hideItems=[],this.disableItems=[],this.isOpen=!1},e.prototype.resetItems=function(){this.hideItems=[],this.disableItems=[],this.headerMenuItems=[],this.contentMenuItems=[],this.item=null},e.prototype.generateID=function(e){return this.ganttID+"_contextMenu_"+e},e.prototype.getKeyFromId=function(e){var t=this.ganttID+"_contextMenu_";return e.indexOf(t)>-1?e.replace(t,""):"Custom"},e.prototype.destroy=function(){this.contextMenu.destroy(),sf.base.remove(this.element),this.removeEventListener(),this.contextMenu=null,this.element=null},e}(),Et=function(){function e(e){this.parent=e,sf.treegrid.TreeGrid.Inject(sf.treegrid.ExcelExport),this.parent.treeGrid.allowExcelExport=this.parent.allowExcelExport,this.bindEvents()}return e.prototype.getModuleName=function(){return"excelExport"},e.prototype.destroy=function(){},e.prototype.bindEvents=function(){var e=this;this.parent.treeGrid.beforeExcelExport=function(t){e.parent.trigger("beforeExcelExport",t)},this.parent.treeGrid.excelQueryCellInfo=function(t){e.parent.trigger("excelQueryCellInfo",t)},this.parent.treeGrid.excelHeaderQueryCellInfo=function(t){e.parent.trigger("excelHeaderQueryCellInfo",t)},this.parent.treeGrid.excelExportComplete=function(t){e.parent.trigger("excelExportComplete",t)}},e}(),Ft=function(){function e(e){sf.treegrid.TreeGrid.Inject(sf.treegrid.ColumnMenu),this.parent=e}return e.prototype.getColumnMenu=function(){return this.parent.treeGrid.columnMenuModule.getColumnMenu()},e.prototype.destroy=function(){},e.prototype.getModuleName=function(){return"columnMenu"},e}(),Vt=function(){function e(e){this.isTest=!1,this.updateParentRecords=[],this.isaddtoBottom=!1,this.isSharedTask=!1,this.canDrop=!0,this.parent=e,sf.treegrid.TreeGrid.Inject(sf.treegrid.RowDD),this.parent.treeGrid.allowRowDragAndDrop=this.parent.allowRowDragAndDrop,this.bindEvents()}return e.prototype.getModuleName=function(){return"rowDragAndDrop"},e.prototype.destroy=function(){},e.prototype.bindEvents=function(){this.parent.treeGrid.rowDragStart=this.rowDragStart.bind(this),this.parent.treeGrid.rowDragStartHelper=this.rowDragStartHelper.bind(this),this.parent.treeGrid.rowDrag=this.rowDrag.bind(this),this.parent.treeGrid.rowDrop=this.rowDrop.bind(this)},e.prototype.rowDragStart=function(e){this.parent.trigger("rowDragStart",e),this.parent.element.style.position="relative"},e.prototype.addErrorElem=function(){var e=document.getElementsByClassName("e-ganttdrag")[0];if(!e.querySelectorAll(".e-errorelem").length){var t=document.createElement("div");sf.base.classList(t,["e-errorcontainer"],[]),sf.base.classList(t,["e-icons","e-errorelem"],[]);var i=e.querySelector(".errorValue"),r=e.querySelector(".e-rowcell").innerHTML;i&&(r=i.innerHTML,i.parentNode.removeChild(i)),e.querySelector(".e-rowcell").innerHTML="";var a=document.createElement("span");a.className="errorValue",a.style.paddingLeft="16px",a.innerHTML=r,e.querySelector(".e-rowcell").appendChild(t),e.querySelector(".e-rowcell").appendChild(a)}},e.prototype.removeErrorElem=function(){var e=document.querySelector(".e-errorelem");e&&e.remove()},e.prototype.rowDrag=function(e){var t=this.parent.element.querySelector(".e-cloneproperties");t.style.display="none";var i=t.cloneNode(!0);i.classList.add("e-ganttdrag"),i.style.display="",this.parent.element.querySelectorAll(".e-cloneproperties").length<=1?this.parent.element.appendChild(i):document.getElementsByClassName("e-cloneproperties")[0].querySelectorAll(".e-errorelem").length?this.addErrorElem():this.removeErrorElem(),"Both"===this.parent.gridLines&&sf.base.addClass(this.parent.element.querySelectorAll(".e-ganttdrag .e-rowcell"),["e-bothganttlines"]);var r=this.parent.element.querySelector(".e-ganttdrag"),a=this.parent.element.getClientRects()[0].top,s=this.parent.element.getClientRects()[0].left,n=sf.base.getValue("event",e.originalEvent).clientX-s,o=sf.base.getValue("event",e.originalEvent).clientY-a;r.style.left=n+20+"px",r.style.top=o+20+"px",this.parent.trigger("rowDrag",e)},e.prototype.rowDragStartHelper=function(e){this.parent.trigger("rowDragStartHelper",e),(this.parent.readOnly||this.parent.filterSettings.columns.length>0)&&(e.cancel=!0),"ResourceView"===this.parent.viewType&&0===sf.base.getValue("level",e.data[0])&&(e.cancel=!0)},e.prototype.rowDrop=function(e){var t=document.querySelector(".e-ganttdrag");t&&t.remove();var i=sf.base.closest(e.target,".e-row"),r=i?parseInt(i.getAttribute("aria-rowindex"),10):e.dropIndex;e.dropIndex=r,e.dropRecord=this.parent.updatedRecords[e.dropIndex],this.parent.trigger("rowDrop",e),"ResourceView"===this.parent.viewType&&("middleSegment"===e.dropPosition&&(1!==e.dropRecord.level&&e.dropRecord.uniqueID!==sf.base.getValue("parentItem",e.data[0]).uniqueID||(e.cancel=!0)),"middleSegment"!==e.dropPosition&&(0!==e.dropRecord.level&&sf.base.getValue("parentItem",e.data[0]).uniqueID!==e.dropRecord.parentItem.uniqueID||(e.cancel=!0))),e.cancel||(e.cancel=!0,e.requestType="beforeDrop",this.parent.trigger("actionBegin",e),this.dropRows(e,!0))},e.prototype.dropRows=function(e,t){if(!this.parent.readOnly){if(this.dropPosition=e.dropPosition,"Invalid"!==e.dropPosition&&this.parent.editModule){var i=this.parent,r=void 0,a=void 0;this.droppedRecord=i.updatedRecords[e.dropIndex];var s=[];a=this.droppedRecord,e.data[0]?s=e.data:s.push(e.data);for(var n=0,o=s.length,d=0;d<o;d++){if(this.parent.isOnEdit=!0,r=s[d],this.draggedRecord=r,"Invalid"!==this.dropPosition){if("ResourceView"===this.parent.viewType&&(this.checkisSharedTask(),this.previousParent=this.draggedRecord.parentItem.uniqueID),this.isSharedTask)return;t&&this.deleteDragRow();var l=this.treeGridData.indexOf(a);if("topSegment"===this.dropPosition&&this.dropAtTop(l),"bottomSegment"===this.dropPosition&&!this.isSharedTask){if(a.hasChildRecords){if(n=this.parent.editModule.getChildCount(a,0),this.parent.taskFields.parentID&&this.ganttData.length>0&&this.ganttData.splice(l+n+1,0,this.draggedRecord.taskData),this.treeGridData.splice(l+n+1,0,this.draggedRecord),this.parent.ids.splice(l+n+1,0,this.draggedRecord.ganttProperties.rowUniqueID.toString()),"ResourceView"===this.parent.viewType){var p=0===this.draggedRecord.level?"R"+this.draggedRecord.ganttProperties.taskId:"T"+this.draggedRecord.ganttProperties.taskId;this.parent.getTaskIds().splice(l+n+1,0,p)}}else if(this.parent.taskFields.parentID&&this.ganttData.length>0&&this.ganttData.splice(l+1,0,this.draggedRecord.taskData),this.treeGridData.splice(l+1,0,this.draggedRecord),this.parent.ids.splice(l+1,0,this.draggedRecord.ganttProperties.rowUniqueID.toString()),"ResourceView"===this.parent.viewType){var h=0===this.draggedRecord.level?"R"+this.draggedRecord.ganttProperties.taskId:"T"+this.draggedRecord.ganttProperties.taskId;this.parent.getTaskIds().splice(l+1,0,h)}if(r.parentItem=this.treeGridData[l].parentItem,r.parentUniqueID=this.treeGridData[l].parentUniqueID,r.level=this.treeGridData[l].level,r.hasChildRecords){this.updateChildRecordLevel(r,1),this.updateChildRecord(r,l+n+1)}if(a.parentItem){var c=this.parent.getParentTask(a.parentItem).childRecords,u=c.indexOf(a)+1;c.splice(u,0,r)}}"middleSegment"===this.dropPosition&&this.dropMiddle(l),sf.base.isNullOrUndefined(r.parentItem&&-1!==this.updateParentRecords.indexOf(r.parentItem))||this.updateParentRecords.push(r.parentItem)}i.rowDragAndDropModule.refreshDataSource()}if("middleSegment"===this.dropPosition&&(a.ganttProperties.predecessor&&(this.parent.editModule.removePredecessorOnDelete(a),a.ganttProperties.predecessor=null,a.ganttProperties.predecessorsName=null,a[this.parent.taskFields.dependency]=null,a.taskData[this.parent.taskFields.dependency]=null),a.ganttProperties.isMilestone&&(this.parent.setRecordValue("isMilestone",!1,a.ganttProperties,!0),sf.base.isNullOrUndefined(a.taskData[this.parent.taskFields.milestone])||!0===a.taskData[this.parent.taskFields.milestone]&&(a.taskData[this.parent.taskFields.milestone]=!1))),"ResourceView"===this.parent.viewType&&!this.isSharedTask){var f=void 0;f="middleSegment"===this.dropPosition?this.droppedRecord.uniqueID:this.droppedRecord.parentItem.uniqueID;var g=this.parent.getTaskByUniqueID(f),m={};m[this.parent.taskFields.resourceInfo]=[],m[this.parent.taskFields.resourceInfo].push(g.ganttProperties.taskId),this.removeExistingResources();var y=this.parent.dataOperation.setResourceInfo(m),b=this.draggedRecord;sf.base.isNullOrUndefined(b.ganttProperties.resourceInfo)&&(b.ganttProperties.resourceInfo=[]),"Unassigned Task"===g.ganttProperties.taskName?(b.ganttProperties.resourceInfo=[],b.ganttProperties.sharedTaskUniqueIds=[b.ganttProperties.rowUniqueID]):b.ganttProperties.resourceInfo.push(y[0]),this.updateCurrentTask(b),"Unassigned Task"===g.ganttProperties.taskName?this.deleteSharedResourceTask():this.updateSharedResourceTask()}for(var v=0;v<this.updateParentRecords.length;v++)this.parent.dataOperation.updateParentItems(this.updateParentRecords[v]);this.updateParentRecords=[],this.parent.isOnEdit=!1}this.parent.treeGrid.parentData=[],this.parent.treeGrid.refresh(),e.requestType="rowDropped",e.modifiedRecords=this.parent.editedRecords,this.parent.trigger("actionComplete",e),this.parent.editedRecords=[]}},e.prototype.updateCurrentTask=function(e){this.parent.dataOperation.updateMappingData(e,"resourceInfo"),this.parent.editModule.updateResourceRelatedFields(e,"resource"),this.parent.editModule.dialogModule.dialogEditValidationFlag=!1,this.parent.editModule.dialogModule.validateDuration(e),this.parent.dataOperation.updateWidthLeft(e),this.parent.dataOperation.updateTaskData(e)},e.prototype.deleteSharedResourceTask=function(){for(var e=0;e<this.parent.getTaskIds().length;e++)this.parent.getTaskIds()[e]==="T"+this.draggedRecord.ganttProperties.taskId&&("Unassigned Task"!==this.parent.getTaskByUniqueID(this.parent.currentViewData[e].parentItem.uniqueID).ganttProperties.taskName&&this.removeRecords(this.parent.currentViewData[e]),sf.base.isNullOrUndefined(this.parent.currentViewData[e].parentItem&&-1!==this.updateParentRecords.indexOf(this.parent.currentViewData[e].parentItem))||this.updateParentRecords.push(this.parent.currentViewData[e].parentItem))},e.prototype.removeExistingResources=function(){var e=this.parent.getTaskByUniqueID(this.previousParent);if(this.draggedRecord.ganttProperties.resourceInfo)for(var t=0;t<this.draggedRecord.ganttProperties.resourceInfo.length;t++)if(this.draggedRecord.ganttProperties.resourceInfo[t][this.parent.resourceFields.id]===e.ganttProperties.taskId){this.draggedRecord.ganttProperties.resourceInfo.splice(t,1);break}},e.prototype.updateSharedResourceTask=function(){for(var e=0;e<this.parent.getTaskIds().length;e++)this.parent.getTaskIds()[e]==="T"+this.draggedRecord.ganttProperties.taskId&&(this.parent.editModule.updateGanttProperties(this.draggedRecord,this.parent.currentViewData[e]),this.parent.dataOperation.updateTaskData(this.parent.currentViewData[e]),sf.base.isNullOrUndefined(this.parent.currentViewData[e].parentItem&&-1!==this.updateParentRecords.indexOf(this.parent.currentViewData[e].parentItem))||this.updateParentRecords.push(this.parent.currentViewData[e].parentItem))},e.prototype._getExistingTaskWithID=function(e){for(var t=[],i=0;i<this.parent.getTaskIds().length;i++)this.parent.getTaskIds()[i]==="T"+e.ganttProperties.taskId&&t.push(this.parent.currentViewData[i]);return t},e.prototype.removeResourceInfo=function(e){var t=this.parent.getTaskByUniqueID(this.draggedRecord.parentItem.uniqueID);if(e.ganttProperties.resourceInfo&&e.ganttProperties.resourceInfo.length>1){var i=this._getExistingTaskWithID(e),r=void 0;if(null==i)return;for(var a=0;a<i.length;a++)for(var s=(r=i[a]).ganttProperties.resourceInfo,n=0;n<s.length;n++)if(s[n][this.parent.resourceFields.id]===t.ganttProperties.taskId){s.splice(n,1),this.parent.setRecordValue("resourceInfo",s,r.ganttProperties,!0),this.updateCurrentTask(r),sf.base.isNullOrUndefined(r.parentItem&&-1!==this.updateParentRecords.indexOf(r.parentItem))||this.updateParentRecords.push(r.parentItem);break}}},e.prototype.refreshDataSource=function(){var e,t,i=this.draggedRecord,r=this.droppedRecord,a=this.parent;if((e=this.parent.dataSource instanceof sf.data.DataManager?sf.base.getValue("dataOperation.dataArray",this.parent):a.dataSource).length>0&&!sf.base.isNullOrUndefined(r)&&!r.parentItem){for(var s=0;s<Object.keys(e).length;s++)e[s][this.parent.taskFields.child]===r.taskData[this.parent.taskFields.child]&&(t=s);"topSegment"===this.dropPosition?this.parent.taskFields.parentID||e.splice(t,0,i.taskData):"bottomSegment"===this.dropPosition&&(this.parent.taskFields.parentID||e.splice(t+1,0,i.taskData))}else if(!this.parent.taskFields.parentID&&!sf.base.isNullOrUndefined(r)&&r.parentItem&&("topSegment"===this.dropPosition||"bottomSegment"===this.dropPosition)){var n="topSegment"===this.dropPosition?"Above":"Below";this.parent.editModule.addRowSelectedItem=r,this.parent.editModule.updateRealDataSource(i,n),delete this.parent.editModule.addRowSelectedItem}this.parent.taskFields.parentID&&(i.parentItem?"topSegment"===this.dropPosition||"bottomSegment"===this.dropPosition?(i[this.parent.taskFields.parentID]=r[this.parent.taskFields.parentID],i.taskData[this.parent.taskFields.parentID]=r[this.parent.taskFields.parentID],i.ganttProperties.parentId=r[this.parent.taskFields.parentID]):(i[this.parent.taskFields.parentID]=r[this.parent.taskFields.id],i.taskData[this.parent.taskFields.parentID]=r[this.parent.taskFields.id],i.ganttProperties.parentId=r[this.parent.taskFields.id]):(i[this.parent.taskFields.parentID]=null,i.taskData[this.parent.taskFields.parentID]=null,i.ganttProperties.parentId=null))},e.prototype.dropMiddle=function(e){var t=this.parent,i=this.parent.editModule.getChildCount(this.droppedRecord,0),r=sf.base.isNullOrUndefined(i)||0===i?e+1:i+e+1;if("middleSegment"===this.dropPosition&&!this.isSharedTask){if(t.taskFields.parentID&&this.ganttData.length>0&&this.ganttData.splice(r,0,this.draggedRecord.taskData),this.treeGridData.splice(r,0,this.draggedRecord),this.parent.ids.splice(r,0,this.draggedRecord.ganttProperties.rowUniqueID.toString()),"ResourceView"===this.parent.viewType){var a=0===this.draggedRecord.level?"R"+this.draggedRecord.ganttProperties.taskId:"T"+this.draggedRecord.ganttProperties.taskId;this.parent.getTaskIds().splice(r,0,a)}this.draggedRecord.hasChildRecords&&this.updateChildRecord(this.draggedRecord,r,this.droppedRecord.expanded),this.recordLevel(),sf.base.isNullOrUndefined(this.draggedRecord.parentItem&&-1!==this.updateParentRecords.indexOf(this.draggedRecord.parentItem))&&this.updateParentRecords.push(this.draggedRecord.parentItem)}},e.prototype.recordLevel=function(){var e=this.parent,t=this.draggedRecord,i=this.droppedRecord,r=e.taskFields.child;if(i.hasChildRecords||(i.hasChildRecords=!0,i.childRecords.length||(i.childRecords=[],!e.taskFields.parentID&&sf.base.isNullOrUndefined(i.taskData[r])&&(i.taskData[r]=[]))),"middleSegment"===this.dropPosition){var a=sf.base.extend({},i);delete a.childRecords;var s={uniqueID:a.uniqueID,expanded:a.expanded,level:a.level,index:a.index,taskId:a.ganttProperties.rowUniqueID};if(t.parentItem=s,t.parentUniqueID=i.uniqueID,i.childRecords.splice(i.childRecords.length,0,t),sf.base.isNullOrUndefined(t)||e.taskFields.parentID||sf.base.isNullOrUndefined(i.taskData[r])||i.taskData[e.taskFields.child].splice(i.childRecords.length,0,t.taskData),t.hasChildRecords){t.level=i.level+1,this.updateChildRecordLevel(t,1)}else t.level=i.level+1;i.expanded=!0}},e.prototype.deleteDragRow=function(){var e;this.treeGridData=this.parent.treeGrid.dataSource,this.parent.dataSource instanceof sf.data.DataManager?this.ganttData=sf.base.getValue("dataOperation.dataArray",this.parent):this.ganttData=this.parent.dataSource,e=this.parent.getTaskByUniqueID(this.draggedRecord.uniqueID),this.removeRecords(e)},e.prototype.checkisSharedTask=function(){this.isSharedTask=!1;for(var e=null,t=0===this.droppedRecord.level?this.droppedRecord.uniqueID:this.droppedRecord.parentItem.uniqueID,i=this.parent.getTaskByUniqueID(t).childRecords,r=0;r<i.length;r++)"T"+this.draggedRecord.ganttProperties.taskId=="T"+i[r].ganttProperties.taskId&&(this.isSharedTask=!0,e=i[r]);this.isSharedTask&&this.removeResourceInfo(e)},e.prototype.dropAtTop=function(e){var t=this.parent;if(!this.isSharedTask){if(t.taskFields.parentID&&this.ganttData.length>0&&this.ganttData.splice(e,0,this.draggedRecord.taskData),this.draggedRecord.parentItem=this.treeGridData[e].parentItem,this.draggedRecord.parentUniqueID=this.treeGridData[e].parentUniqueID,this.draggedRecord.level=this.treeGridData[e].level,this.treeGridData.splice(e,0,this.draggedRecord),this.parent.ids.splice(e,0,this.draggedRecord.ganttProperties.rowUniqueID.toString()),"ResourceView"===this.parent.viewType){var i=0===this.draggedRecord.level?"R"+this.draggedRecord.ganttProperties.taskId:"T"+this.draggedRecord.ganttProperties.taskId;this.parent.getTaskIds().splice(e,0,i)}if(this.draggedRecord.hasChildRecords){this.updateChildRecord(this.draggedRecord,e),this.updateChildRecordLevel(this.draggedRecord,1)}if(this.droppedRecord.parentItem){var r=this.parent.getParentTask(this.droppedRecord.parentItem).childRecords,a=r.indexOf(this.droppedRecord);r.splice(a,0,this.draggedRecord)}sf.base.isNullOrUndefined(this.draggedRecord.parentItem&&-1!==this.updateParentRecords.indexOf(this.draggedRecord.parentItem))||this.updateParentRecords.push(this.draggedRecord.parentItem)}},e.prototype.updateChildRecordLevel=function(e,t){var i,r;if(t++,!e.hasChildRecords)return 0;i=e.childRecords.length;for(var a=0;a<i;a++){r=e.childRecords[a];var s=void 0;if(e.parentItem){s=this.parent.treeGrid.uniqueIDCollection[e.parentItem.uniqueID]}r.level=e.parentItem?s.level+t:e.level+1,r.hasChildRecords&&(t--,t=this.updateChildRecordLevel(r,t))}return t},e.prototype.updateChildRecord=function(e,t,i){var r,a,s=this.parent;if(!e.hasChildRecords)return 0;a=e.childRecords.length;for(var n=0;n<a;n++)r=e.childRecords[n],t++,s.flatData.splice(t,0,r),this.parent.ids.splice(t,0,r.ganttProperties.rowUniqueID.toString()),s.taskFields.parentID&&s.dataSource.length>0&&this.ganttData.splice(t,0,r.taskData),r.hasChildRecords&&(t=this.updateChildRecord(r,t));return t},e.prototype.removeRecords=function(e){var t,i=this.parent;t=this.parent.dataSource instanceof sf.data.DataManager?sf.base.getValue("dataOperation.dataArray",this.parent):this.parent.dataSource;var r=e,a=this.parent.getParentTask(r.parentItem);if(r){if(r.parentItem){var s=a?a.childRecords:[],n=0;s&&s.length>0&&("ResourceView"===this.parent.viewType&&1===s.length&&(this.parent.isOnDelete=!0,s[0].isDelete=!0,this.parent.dataOperation.updateParentItems(a),this.parent.isOnDelete=!1,s[0].isDelete=!1),n=s.indexOf(r),a.childRecords.splice(n,1),this.parent.taskFields.parentID||a.taskData[this.parent.taskFields.child].splice(n,1),this.updateParentRecords.push(a))}if(!this.parent.taskFields.parentID){var o=[];o.push(r.ganttProperties.rowUniqueID.toString()),this.parent.editModule.removeFromDataSource(o)}if(i.taskFields.parentID){r.hasChildRecords&&r.childRecords.length>0&&this.removeChildItem(r);for(var d=void 0,l=t.length>0&&"ResourceView"!==this.parent.viewType?t:this.parent.updatedRecords,p=0;p<l.length;p++)"ResourceView"===this.parent.viewType?l[p].ganttProperties.rowUniqueID===r.ganttProperties.rowUniqueID&&(d=p):l[p][this.parent.taskFields.id]===r.taskData[this.parent.taskFields.id]&&(d=p);if(-1!==d){t.length>0&&t.splice(d,1);var h=this.treeGridData.indexOf(r);this.treeGridData.splice(h,1),this.parent.ids.splice(h,1),-1!==this.parent.treeGrid.parentData.indexOf(r)&&this.parent.treeGrid.parentData.splice(this.parent.treeGrid.parentData.indexOf(r),1),"ResourceView"===this.parent.viewType&&this.parent.getTaskIds().splice(d,1)}}var c=this.treeGridData.indexOf(r);if(!i.taskFields.parentID){var u=this.parent.editModule.getChildCount(r,0);this.treeGridData.splice(c,u+1),this.parent.ids.splice(c,u+1);var f=this.ganttData.indexOf(r.taskData);-1!==f&&(this.ganttData.splice(f,1),this.parent.treeGrid.parentData.splice(f,1)),"ResourceView"===this.parent.viewType&&this.parent.getTaskIds().splice(c,u+1)}r.parentItem&&a&&a.childRecords&&!a.childRecords.length&&(a.expanded=!1,a.hasChildRecords=!1)}},e.prototype.removeChildItem=function(e){for(var t,i,r=0;r<e.childRecords.length;r++){t=e.childRecords[r];var a=void 0;a=this.parent.dataSource instanceof sf.data.DataManager?sf.base.getValue("dataOperation.dataArray",this.parent):this.parent.dataSource;for(var s=0;s<a.length;s++)a[s][this.parent.taskFields.id]===t.taskData[this.parent.taskFields.id]&&(i=s);if(-1!==i){a.length>0&&a.splice(i,1);var n=this.treeGridData.indexOf(t);this.treeGridData.splice(n,1),this.parent.ids.splice(n,1),"ResourceView"===this.parent.viewType&&this.parent.getTaskIds().splice(i,1)}t.hasChildRecords&&this.removeChildItem(t)}},e.prototype.reorderRows=function(e,t,i){if(!this.parent.readOnly){e[0],"above"===i&&(this.dropPosition="topSegment"),"below"===i&&(this.dropPosition="bottomSegment"),"child"===i&&(this.dropPosition="middleSegment");for(var r=[],a=0;a<e.length;a++)r[a]=this.parent.updatedRecords[e[a]];var s={data:r,dropIndex:t,dropPosition:this.dropPosition};this.dropRows(s,!0)}},e}(),Ut=function(){function e(e){this.theme=e,this.ganttStyle={},this.setTheme(this.ganttStyle,this.theme)}return Object.defineProperty(e.prototype,"style",{get:function(){return this.ganttStyle||this.setTheme(this.ganttStyle,"Material"),this.ganttStyle},enumerable:!0,configurable:!0}),e.prototype.setTheme=function(e,t){switch(this.initStyles(e),e.columnHeader.fontSize=9.5,e.columnHeader.fontColor=new sf.pdfexport.PdfColor(0,0,0),e.columnHeader.fontColor.gray=.2,e.columnHeader.backgroundColor=new sf.pdfexport.PdfColor(255,255,255),e.columnHeader.borderColor=new sf.pdfexport.PdfColor(234,234,234),e.columnHeader.format.lineAlignment=1,e.columnHeader.format.alignment=0,e.fontFamily=sf.pdfexport.PdfFontFamily.Helvetica,e.cell.fontSize=9.5,e.cell.backgroundColor=new sf.pdfexport.PdfColor(255,255,255),e.cell.borderColor=new sf.pdfexport.PdfColor(234,234,234),e.cell.fontColor=new sf.pdfexport.PdfColor(0,0,0),e.cell.fontColor.gray=.2,e.cell.format.lineAlignment=1,e.cell.format.alignment=0,e.footer.fontSize=9.5,e.footer.fontStyle=0,e.footer.format.alignment=1,e.footer.format.lineAlignment=1,e.timeline.fontSize=9.5,e.timeline.fontStyle=0,e.timeline.backgroundColor=new sf.pdfexport.PdfColor(252,252,252),e.timeline.fontColor=new sf.pdfexport.PdfColor(40,40,39),e.chartGridLineColor=new sf.pdfexport.PdfColor(206,206,206),e.timeline.borderColor=new sf.pdfexport.PdfColor(206,206,206),t){case"Bootstrap":e.taskbar.taskColor=new sf.pdfexport.PdfColor(49,122,185),e.taskbar.progressColor=new sf.pdfexport.PdfColor(33,82,125),e.taskbar.parentTaskColor=new sf.pdfexport.PdfColor(119,119,119),e.taskbar.parentProgressColor=new sf.pdfexport.PdfColor(85,85,85),e.taskbar.taskBorderColor=new sf.pdfexport.PdfColor(33,82,125),e.taskbar.parentTaskBorderColor=new sf.pdfexport.PdfColor(85,85,85),e.taskbar.milestoneColor=new sf.pdfexport.PdfColor(85,85,85),e.footer.fontColor=new sf.pdfexport.PdfColor(0,0,0),e.footer.fontColor.gray=.2,e.connectorLineColor=new sf.pdfexport.PdfColor(33,82,125),e.footer.backgroundColor=new sf.pdfexport.PdfColor(255,255,255),e.taskbar.progressFontColor=new sf.pdfexport.PdfColor(255,255,255),e.label.fontColor=new sf.pdfexport.PdfColor(0,0,0);break;case"Bootstrap 4":e.taskbar.taskColor=new sf.pdfexport.PdfColor(0,123,255),e.taskbar.progressColor=new sf.pdfexport.PdfColor(0,86,179),e.taskbar.parentTaskColor=new sf.pdfexport.PdfColor(108,117,125),e.taskbar.parentProgressColor=new sf.pdfexport.PdfColor(73,80,87),e.taskbar.taskBorderColor=new sf.pdfexport.PdfColor(0,86,179),e.taskbar.parentTaskBorderColor=new sf.pdfexport.PdfColor(73,80,87),e.taskbar.milestoneColor=new sf.pdfexport.PdfColor(73,80,87),e.footer.fontColor=new sf.pdfexport.PdfColor(0,0,0),e.footer.fontColor.gray=.2,e.connectorLineColor=new sf.pdfexport.PdfColor(0,86,179),e.footer.backgroundColor=new sf.pdfexport.PdfColor(255,255,255),e.taskbar.progressFontColor=new sf.pdfexport.PdfColor(255,255,255),e.label.fontColor=new sf.pdfexport.PdfColor(33,37,41);break;case"Fabric":e.columnHeader.fontColor=new sf.pdfexport.PdfColor(102,102,102),e.cell.fontColor=new sf.pdfexport.PdfColor(51,51,51),e.taskbar.taskColor=new sf.pdfexport.PdfColor(0,120,214),e.taskbar.progressColor=new sf.pdfexport.PdfColor(0,91,163),e.taskbar.parentTaskColor=new sf.pdfexport.PdfColor(118,118,118),e.taskbar.parentProgressColor=new sf.pdfexport.PdfColor(80,80,80),e.taskbar.taskBorderColor=new sf.pdfexport.PdfColor(0,91,163),e.taskbar.parentTaskBorderColor=new sf.pdfexport.PdfColor(80,80,80),e.taskbar.milestoneColor=new sf.pdfexport.PdfColor(80,80,80),e.footer.fontColor=new sf.pdfexport.PdfColor(51,51,51),e.footer.fontColor.gray=.2,e.connectorLineColor=new sf.pdfexport.PdfColor(0,69,122),e.footer.backgroundColor=new sf.pdfexport.PdfColor(255,255,255),e.taskbar.progressFontColor=new sf.pdfexport.PdfColor(255,255,255),e.label.fontColor=new sf.pdfexport.PdfColor(51,51,51);break;default:e.taskbar.taskColor=new sf.pdfexport.PdfColor(88,105,197),e.taskbar.progressColor=new sf.pdfexport.PdfColor(63,81,181),e.taskbar.parentTaskColor=new sf.pdfexport.PdfColor(132,132,132),e.taskbar.parentProgressColor=new sf.pdfexport.PdfColor(97,97,97),e.taskbar.taskBorderColor=new sf.pdfexport.PdfColor(63,81,181),e.taskbar.parentTaskBorderColor=new sf.pdfexport.PdfColor(51,51,51),e.taskbar.milestoneColor=new sf.pdfexport.PdfColor(97,97,97),e.footer.fontColor=new sf.pdfexport.PdfColor(0,0,0),e.footer.fontColor.gray=.2,e.connectorLineColor=new sf.pdfexport.PdfColor(63,81,181),e.footer.backgroundColor=new sf.pdfexport.PdfColor(255,255,255),e.taskbar.progressFontColor=new sf.pdfexport.PdfColor(255,255,255),e.label.fontColor=new sf.pdfexport.PdfColor(51,51,51)}},e.prototype.initStyles=function(e){e.columnHeader={},e.columnHeader.format=new sf.pdfexport.PdfStringFormat,e.cell={},e.cell.format=new sf.pdfexport.PdfStringFormat,e.timeline={},e.footer={},e.footer.format=new sf.pdfexport.PdfStringFormat,e.label={},e.taskbar={}},e}(),Lt=function(){function e(){this.mKeys=[],this.mValues=[]}return e.prototype.size=function(){return this.mKeys.length},e.prototype.add=function(e,t){if(null==e||null==t)throw new ReferenceError("Provided key or value is not valid.");if(this.mKeys.indexOf(e)<0)return this.mKeys.push(e),this.mValues.push(t),1;throw new RangeError("An item with the same key has already been added.")},e.prototype.keys=function(){return this.mKeys},e.prototype.values=function(){return this.mValues},e.prototype.getValue=function(e){if(null==e)throw new ReferenceError("Provided key is not valid.");var t=this.mKeys.indexOf(e);if(t<0)throw new RangeError("No item with the specified key has been added.");return this.mValues[t]},e.prototype.setValue=function(e,t){if(null==e)throw new ReferenceError("Provided key is not valid.");var i=this.mKeys.indexOf(e);i<0?(this.mKeys.push(e),this.mValues.push(t)):this.mValues[i]=t},e.prototype.remove=function(e){if(null==e)throw new ReferenceError("Provided key is not valid.");var t=this.mKeys.indexOf(e);if(t<0)throw new RangeError("No item with the specified key has been added.");return this.mKeys.splice(t,1),this.mValues.splice(t,1),!0},e.prototype.containsKey=function(e){if(null==e)throw new ReferenceError("Provided key is not valid.");return!(this.mKeys.indexOf(e)<0)},e.prototype.clear=function(){this.mKeys=[],this.mValues=[]},e}(),Nt=function(){function e(){var e=new sf.pdfexport.PdfPen(new sf.pdfexport.PdfColor(0,0,0));e.dashStyle=sf.pdfexport.PdfDashStyle.Solid;var t=new sf.pdfexport.PdfPen(new sf.pdfexport.PdfColor(0,0,0));t.dashStyle=sf.pdfexport.PdfDashStyle.Solid;var i=new sf.pdfexport.PdfPen(new sf.pdfexport.PdfColor(0,0,0));i.dashStyle=sf.pdfexport.PdfDashStyle.Solid;var r=new sf.pdfexport.PdfPen(new sf.pdfexport.PdfColor(0,0,0));r.dashStyle=sf.pdfexport.PdfDashStyle.Solid,this.leftPen=e,this.rightPen=t,this.topPen=i,this.bottomPen=r}return Object.defineProperty(e.prototype,"left",{get:function(){return this.leftPen},set:function(e){this.leftPen=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.rightPen},set:function(e){this.rightPen=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.topPen},set:function(e){this.topPen=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.bottomPen},set:function(e){this.bottomPen=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"all",{set:function(e){this.leftPen=this.rightPen=this.topPen=this.bottomPen=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAll",{get:function(){return this.leftPen===this.rightPen&&this.leftPen===this.topPen&&this.leftPen===this.bottomPen},enumerable:!0,configurable:!0}),Object.defineProperty(e,"default",{get:function(){return new e},enumerable:!0,configurable:!0}),e}(),Bt=function(){function e(e,t,i,r){this.hasLeftPad=!1,this.hasRightPad=!1,this.hasTopPad=!1,this.hasBottomPad=!1,void 0===e?(this.leftPad=this.rightPad=5.76,this.bottomPad=this.topPad=.5):(this.leftPad=e,this.rightPad=t,this.topPad=i,this.bottomPad=r,this.hasLeftPad=!0,this.hasRightPad=!0,this.hasTopPad=!0,this.hasBottomPad=!0)}return Object.defineProperty(e.prototype,"left",{get:function(){return this.leftPad},set:function(e){this.leftPad=e,this.hasLeftPad=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.rightPad},set:function(e){this.rightPad=e,this.hasRightPad=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.topPad},set:function(e){this.topPad=e,this.hasTopPad=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.bottomPad},set:function(e){this.bottomPad=e,this.hasBottomPad=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"all",{set:function(e){this.leftPad=this.rightPad=this.topPad=this.bottomPad=e,this.hasLeftPad=!0,this.hasRightPad=!0,this.hasTopPad=!0,this.hasBottomPad=!0},enumerable:!0,configurable:!0}),e}(),At=function(){this.cellSpacing=0,this.borderOverlapStyle=sf.pdfexport.PdfBorderOverlapStyle.Overlap,this.allowHorizontalOverflow=!1,this.horizontalOverflowType=e.PdfHorizontalOverflowType.LastPage,this.cellPadding=new Bt},Wt=(pt=function(e,t){return(pt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}pt(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Ht=function(t){function i(e){var i=t.call(this,e)||this;return i.columnRanges=[],i.repeatRowIndex=-1,i.currentBounds=new sf.pdfexport.RectangleF(0,0,0,0),i}return Wt(i,t),Object.defineProperty(i.prototype,"treegrid",{get:function(){return this.elements},enumerable:!0,configurable:!0}),i.prototype.layoutInternal=function(e){if(sf.base.isNullOrUndefined(e))throw Error("Argument Null Expection");this.currentPage=e.page;var t=e.format;if(null!==this.currentPage&&(this.currentPageBounds=this.currentPage.getClientSize()),this.currentGraphics=this.currentPage.graphics,null!==t&&t.break===sf.pdfexport.PdfLayoutBreakType.FitColumnsToPage?this.currentBounds=new sf.pdfexport.RectangleF(new sf.pdfexport.PointF(e.bounds.x,e.bounds.y),new sf.pdfexport.SizeF(this.treegrid.columns.width,this.currentGraphics.clientSize.height)):this.currentBounds=new sf.pdfexport.RectangleF(new sf.pdfexport.PointF(e.bounds.x,e.bounds.y),this.currentGraphics.clientSize),0===this.treegrid.rows.count)throw Error("Please add row or header into grid");return this.currentBounds.width=e.bounds.width>0?e.bounds.width:this.currentBounds.width-this.treegrid.rows.getRow(0).cells.getCell(0).style.borders.left.width/2,this.startLocation=new sf.pdfexport.PointF(e.bounds.x,e.bounds.y),e.bounds.height>0&&(this.currentBounds.height=e.bounds.height),this.treegrid.style.allowHorizontalOverflow||this.treegrid.isFitToWidth?(this.treegrid.measureColumnsWidth(this.currentBounds),this.columnRanges.push([0,this.treegrid.columns.count-1])):(this.treegrid.measureColumnsWidth(),this.determineColumnDrawRanges()),this.layoutOnPage(e)},i.prototype.determineColumnDrawRanges=function(){for(var e=0,t=0,i=0,r=this.currentGraphics.clientSize.width-this.currentBounds.x,a=0;a<this.treegrid.columns.count;a++)if((i+=this.treegrid.columns.getColumn(a).width)>=r){for(var s=0,n=e;n<=a&&!((s+=this.treegrid.columns.getColumn(n).width)>r);n++)t=n;this.columnRanges.push([e,t]),e=t+1,i=t<=a?this.treegrid.columns.getColumn(a).width:0}this.columnRanges.push([e,this.treegrid.columns.count-1])},i.prototype.getFormat=function(e){return e},i.prototype.layoutOnPage=function(t){for(var i,r=this.getFormat(t.format),a=new Lt,s=t.page,n=0;n<this.columnRanges.length;n++){var o=this.columnRanges[n];this.cellStartIndex=o[0],this.cellEndIndex=o[1];for(var d=this.treegrid.rows.count,l=0,p=!1,h=0;h<d;h++){var c=this.treegrid.rows.getRow(h);l++;var u=this.currentBounds.y;null===this.currentPage||a.containsKey(this.currentPage)||a.add(this.currentPage,o);var f=this.drawRow(c);for(u===this.currentBounds.y?(p=!0,this.repeatRowIndex=this.treegrid.rows.rowCollection.indexOf(c)):(p=!1,this.repeatRowIndex=-1);!f.isFinish&&null!==s;)if(this.treegrid.allowRowBreakAcrossPages)this.currentPage=this.getNextPageFormat(r),this.treegrid.enableHeader&&this.drawHeader(),this.checkBounds(r),f=this.drawRow(c);else{if(!this.treegrid.allowRowBreakAcrossPages&&l<length){this.currentPage=this.getNextPageFormat(r),this.treegrid.enableHeader&&this.drawHeader();break}if(l>=length)break}!f.isFinish&&null!==s&&r.layout!==sf.pdfexport.PdfLayoutType.OnePage&&p&&(this.startLocation.x=this.currentBounds.x,this.currentPage=this.getNextPageFormat(r),this.treegrid.enableHeader&&this.drawHeader(),this.startLocation.y=this.currentBounds.y,r.paginateBounds===new sf.pdfexport.RectangleF(0,0,0,0)&&(this.currentBounds.x+=this.startLocation.x),this.currentBounds.x===Nt.default.left.width/2&&(this.currentBounds.y+=this.startLocation.x),this.drawRow(c),null===this.currentPage||a.containsKey(this.currentPage)||a.add(this.currentPage,o))}this.columnRanges.indexOf(o)<this.columnRanges.length-1&&null!==s&&r.layout!==sf.pdfexport.PdfLayoutType.OnePage&&(this.currentPage=this.getNextPageFormat(r),this.checkBounds(r))}return i=this.getLayoutResult(),this.treegrid.style.allowHorizontalOverflow&&this.treegrid.style.horizontalOverflowType===e.PdfHorizontalOverflowType.NextPage&&this.reArrangePages(a),i},i.prototype.checkBounds=function(e){var t=new sf.pdfexport.PointF(Nt.default.right.width/2,Nt.default.top.width/2);e.paginateBounds===new sf.pdfexport.RectangleF(0,0,0,0)&&this.startLocation===t&&(this.currentBounds.x+=this.startLocation.x,this.currentBounds.y+=this.startLocation.y)},i.prototype.drawHeader=function(){this.drawRow(this.treegrid.rows.getRow(0))},i.prototype.reArrangePages=function(e){for(var t=this.currentPage.document,i=[],r=e.keys(),a=0;a<r.length;a++){(o=r[a]).section=null,i.push(o),t.pages.remove(o)}for(a=0;a<e.size();a++)for(var s=e.size()/this.columnRanges.length,n=a;n<e.size();n+=s){var o=i[n];-1===t.pages.indexOf(o)&&t.pages.add(o)}},i.prototype.getNextPageFormat=function(e){var t=this.currentPage.section,i=null,r=t.indexOf(this.currentPage);return i=r===t.count-1?t.add():t.getPages()[r+1],this.currentGraphics=i.graphics,this.currentBounds=new sf.pdfexport.RectangleF(new sf.pdfexport.PointF(0,0),i.getClientSize()),i},i.prototype.getLayoutResult=function(){var e=new sf.pdfexport.RectangleF(this.startLocation,new sf.pdfexport.SizeF(this.currentBounds.width,this.currentBounds.y-this.startLocation.y));return new jt(this.currentPage,e)},i.prototype.checkIfDefaultFormat=function(e){var t=new sf.pdfexport.PdfStringFormat;return e.alignment===t.alignment&&e.characterSpacing===t.characterSpacing&&e.clipPath===t.clipPath&&e.firstLineIndent===t.firstLineIndent&&e.horizontalScalingFactor===t.horizontalScalingFactor&&e.lineAlignment===t.lineAlignment&&e.lineLimit===t.lineLimit&&e.lineSpacing===t.lineSpacing&&e.measureTrailingSpaces===t.measureTrailingSpaces&&e.noClip===t.noClip&&e.paragraphIndent===t.paragraphIndent&&e.rightToLeft===t.rightToLeft&&e.subSuperScript===t.subSuperScript&&e.wordSpacing===t.wordSpacing&&e.wordWrap===t.wordWrap},i.prototype.drawRow=function(e,t,i){if(sf.base.isNullOrUndefined(t)){var r=new sf.pdfexport.RowLayoutResult;return(i=e.rowBreakHeight>0?e.rowBreakHeight:e.height)>this.currentPageBounds.height?this.treegrid.allowRowBreakAcrossPages?(r.isFinish=!0,this.drawRowWithBreak(r,e,i)):(r.isFinish=!1,this.drawRow(e,r,i)):this.currentBounds.y+i>this.currentPageBounds.height||this.currentBounds.y+i>this.currentBounds.height?this.repeatRowIndex>-1&&this.repeatRowIndex===e.rowIndex?this.treegrid.allowRowBreakAcrossPages?(r.isFinish=!0,this.drawRowWithBreak(r,e,i)):(r.isFinish=!1,this.drawRow(e,r,i)):r.isFinish=!1:(r.isFinish=!0,this.drawRow(e,r,i)),r}var a=new sf.pdfexport.PointF(this.currentBounds.x,this.currentBounds.y);t.bounds=new sf.pdfexport.RectangleF(a,new sf.pdfexport.SizeF(0,0));var s=0;i=this.reCalculateHeight(e,i);for(var n=this.cellStartIndex;n<=this.cellEndIndex;n++){var o=e.cells.getCell(n),d=this.treegrid.columns.getColumn(n);d.isTreeColumn&&(s=10*e.level);var l=n>this.cellEndIndex+1&&o.columnSpan>1;if(!l)for(var p=1;p<o.columnSpan;p++)e.cells.getCell(n+p).isCellMergeContinue=!0;var h=new sf.pdfexport.SizeF(d.width,i);!this.checkIfDefaultFormat(d.format)&&this.checkIfDefaultFormat(o.style.format)&&(o.style.format=d.format),o.draw(this.currentGraphics,new sf.pdfexport.RectangleF(a,h),l,s),e.treegrid.style.allowHorizontalOverflow&&(o.columnSpan>this.cellEndIndex||n+o.columnSpan>this.cellEndIndex+1)&&this.cellEndIndex<e.cells.count-1&&(e.rowOverflowIndex=this.cellEndIndex),a.x+=d.width,s=0}return this.currentBounds.y+=i,t.bounds=new sf.pdfexport.RectangleF(new sf.pdfexport.PointF(t.bounds.x,t.bounds.y),new sf.pdfexport.SizeF(a.x,a.y)),null},i.prototype.drawRowWithBreak=function(e,t,i){var r=new sf.pdfexport.PointF(this.currentBounds.x,this.currentBounds.y);e.bounds=new sf.pdfexport.RectangleF(r,new sf.pdfexport.SizeF(0,0));var a=0;this.treegridHeight=this.currentBounds.height,t.rowBreakHeight=this.currentBounds.y+i-this.currentBounds.height;for(var s=0;s<t.cells.count;s++){(d=t.cells.getCell(s)).measureHeight()===i&&null===d.value&&(t.rowBreakHeight=this.currentBounds.y+i-this.currentBounds.height)}for(var n=this.cellStartIndex;n<=this.cellEndIndex;n++){var o=this.treegrid.columns.getColumn(n);o.isTreeColumn&&(a=10*t.level);var d,l=(d=t.cells.getCell(n)).columnSpan+n>this.cellEndIndex+1&&d.columnSpan>1;if(!l)for(var p=1;p<d.columnSpan;p++)t.cells.getCell(n+p).isCellMergeContinue=!0;var h=this.treegridHeight>0?this.treegridHeight:this.currentBounds.height,c=new sf.pdfexport.SizeF(o.width,h);!this.checkIfDefaultFormat(o.format)&&this.checkIfDefaultFormat(d.style.format)&&(d.style.format=o.format),d.draw(this.currentGraphics,new sf.pdfexport.RectangleF(r,c),l,a),e.isFinish=e.isFinish?d.finishedDrawingCell:e.isFinish,r.x+=o.width,a=0,this.currentBounds.y+=this.treegridHeight>0?this.treegridHeight:i,e.bounds=new sf.pdfexport.RectangleF(new sf.pdfexport.PointF(e.bounds.x,e.bounds.y),new sf.pdfexport.SizeF(r.x,r.y))}},i.prototype.reCalculateHeight=function(e,t){for(var i=0,r=this.cellStartIndex;r<=this.cellEndIndex;r++)sf.base.isNullOrUndefined(e.cells.getCell(r).remainingString)&&""!==e.cells.getCell(r).remainingString||(i=Math.max(i,e.cells.getCell(r).measureHeight()));return Math.max(t,i)},i}(sf.pdfexport.ElementLayouter),jt=function(e){function t(t,i){return e.call(this,t,i)||this}return Wt(t,e),t}(sf.pdfexport.PdfLayoutResult),Gt=function(e){function t(t){return void 0===t?e.call(this)||this:e.call(this,t)||this}return Wt(t,e),t}(sf.pdfexport.PdfLayoutFormat),qt=(ht=function(e,t){return(ht=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}ht(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),zt=function(e){function t(){var t=e.call(this)||this;return t.treeGridSize=new sf.pdfexport.SizeF(0,0),t.treeColumnIndex=0,t.allowRowBreakAcrossPages=!0,t.enableHeader=!0,t.isFitToWidth=!1,t.columns=new Jt(t),t.rows=new Zt(t),t.headers=new Qt(t),t.style=new At,t.rowHeight=0,t}return qt(t,e),Object.defineProperty(t.prototype,"raiseBeginCellDraw",{get:function(){return void 0!==this.beginCellDraw&&null!==typeof this.beginCellDraw},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"raiseEndCellDraw",{get:function(){return void 0!==this.endCellDraw&&null!==typeof this.endCellDraw},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return 0===this.treeGridSize.width&&0===this.treeGridSize.height&&(this.treeGridSize=this.calculateTreeGridSize()),this.treeGridSize},set:function(e){this.treeGridSize=e},enumerable:!0,configurable:!0}),t.prototype.draw=function(e,t,i,r){if(t instanceof sf.pdfexport.PointF&&void 0===t.width&&void 0===i)return this.drawHelper(e,t.x,t.y);if("number"==typeof t&&"number"==typeof i&&void 0===r)return this.drawHelper(e,t,i,null);if(t instanceof sf.pdfexport.RectangleF&&void 0!==t.width&&void 0===i)return this.drawHelper(e,t,null);if(t instanceof sf.pdfexport.PointF&&void 0===t.width&&i instanceof sf.pdfexport.PdfLayoutFormat)return this.drawHelper(e,t.x,t.y,i);if("number"==typeof t&&"number"==typeof i&&(r instanceof sf.pdfexport.PdfLayoutFormat||null==r)){var a=e.graphics.clientSize.width-t,s=new sf.pdfexport.RectangleF(t,i,a,0);return this.drawHelper(e,s,r)}return t instanceof sf.pdfexport.RectangleF&&void 0!==t.width&&"boolean"==typeof i?this.drawHelper(e,t,null):this.drawHelper(e,t,i)},t.prototype.measureColumnsWidth=function(e){if(void 0!==e)for(var t=this.columns.getDefaultWidths(e.width-e.x),i=0;i<this.columns.count;i++)this.columns.getColumn(i).width<0&&(this.columns.getColumn(i).width=t[i]);else{t=[];var r=0,a=0,s=this.columns.count;for(i=0;i<s;i++){for(var n=this.rows.count,o=0;o<n;o++){var d=this.rows.getRow(o).cells.getCell(i).width,l=this.initialWidth>0?Math.min(this.initialWidth,d):d;r=Math.max(r,l),r=Math.max(this.columns.getColumn(i).width,r),this.columns.getColumn(i).isTreeColumn&&(a=Math.max(a,this.rows.getRow(o).level))}this.columns.getColumn(i).isTreeColumn?t.push(r+10*a):t.push(r),r=0}for(i=0;i<this.columns.count;i++)this.columns.getColumn(i).width<0&&(this.columns.getColumn(i).width=t[i])}},t.prototype.calculateTreeGridSize=function(){for(var e=0,t=this.columns.width,i=0;i<this.headers.count;i++){e+=this.headers.getHeader(i).height}for(i=0;i<this.rows.count;i++){e+=this.rows.getRow(i).height}return new sf.pdfexport.SizeF(t,e)},t.prototype.drawGrid=function(e,t,i,r){this.initialWidth=e.graphics.clientSize.width;var a=new sf.pdfexport.RectangleF(0,0,e.getClientSize().height,0);return this.draw(e,a,r)},t.prototype.layout=function(e){if(0!==this.rows.count){var t=this.rows.getRow(0).cells.getCell(0).style;if(1!==t.borders.left.width){var i=t.borders.left.width/2,r=t.borders.top.width/2;if(e.bounds.x===Nt.default.right.width/2&&e.bounds.y===Nt.default.right.width/2){var a=new sf.pdfexport.RectangleF(new sf.pdfexport.PointF(i,r),new sf.pdfexport.SizeF(this.size.width,this.size.height));e.bounds=a}}}return this.setSpan(),this.layouter=new Ht(this),this.layouter.layoutInternal(e)},t.prototype.onBeginCellDraw=function(e){this.raiseBeginCellDraw&&this.beginCellDraw(this,e)},t.prototype.onEndCellDraw=function(e){this.raiseEndCellDraw&&this.endCellDraw(this,e)},t.prototype.setSpan=function(){for(var e=1,t=1,i=0,r=0,a=0,s=this.headers.count,n=0;n<s;n++){a=0;for(var o=(p=this.headers.getHeader(n)).cells.count,d=0;d<o;d++){var l=p.cells.getCell(d);if(a=Math.max(a,l.rowSpan),!l.isCellMergeContinue&&!l.isRowMergeContinue&&(l.columnSpan>1||l.rowSpan>1)){if(l.columnSpan+d>p.cells.count)throw new Error("Invalid span specified at row "+d.toString()+" column "+n.toString());if(l.rowSpan+n>this.headers.count)throw new Error("Invalid span specified at Header "+d.toString()+" column "+n.toString());if(l.columnSpan>1&&l.rowSpan>1){for(e=l.columnSpan,t=l.rowSpan,i=d,r=n,l.isCellMergeStart=!0,l.isRowMergeStart=!0;e>1;)i++,p.cells.getCell(i).isCellMergeContinue=!0,p.cells.getCell(i).isRowMergeContinue=!0,p.cells.getCell(i).rowSpan=t,e--;for(i=d,e=l.columnSpan;t>1;){for(r++,this.headers.getHeader(r).cells.getCell(d).isRowMergeContinue=!0,this.headers.getHeader(r).cells.getCell(i).isRowMergeContinue=!0,t--;e>1;)i++,this.headers.getHeader(r).cells.getCell(i).isCellMergeContinue=!0,this.headers.getHeader(r).cells.getCell(i).isRowMergeContinue=!0,e--;e=l.columnSpan,i=d}}else if(l.columnSpan>1&&1===l.rowSpan)for(e=l.columnSpan,i=d,l.isCellMergeStart=!0;e>1;)i++,p.cells.getCell(i).isCellMergeContinue=!0,e--;else if(1===l.columnSpan&&l.rowSpan>1)for(t=l.rowSpan,r=n;t>1;)r++,this.headers.getHeader(r).cells.getCell(d).isRowMergeContinue=!0,t--}}p.maximumRowSpan=a}e=t=1,i=r=0,s=this.rows.count;for(n=0;n<s;n++){var p,h=(p=this.rows.getRow(n)).cells.count;for(d=0;d<h;d++){if(!(l=p.cells.getCell(d)).isCellMergeContinue&&!l.isRowMergeContinue&&(l.columnSpan>1||l.rowSpan>1)){if(l.columnSpan+d>p.cells.count)throw new Error("Invalid span specified at row {0} column {1} "+d.toString());if(l.rowSpan+n>this.rows.count)throw new Error("Invalid span specified at row {0} column {1} "+d.toString());if(l.columnSpan>1&&l.rowSpan>1){for(e=l.columnSpan,t=l.rowSpan,i=d,r=n,l.isCellMergeStart=!0,l.isRowMergeStart=!0;e>1;)i++,p.cells.getCell(i).isCellMergeContinue=!0,e--;for(i=d,e=l.columnSpan;t>1;){for(r++,this.rows.getRow(r).cells.getCell(d).isRowMergeContinue=!0,t--;e>1;)i++,this.rows.getRow(r).cells.getCell(i).isCellMergeContinue=!0,e--;e=l.columnSpan,i=d}}else if(l.columnSpan>1&&1===l.rowSpan)for(e=l.columnSpan,i=d,l.isCellMergeStart=!0;e>1;)i++,p.cells.getCell(i).isCellMergeContinue=!0,e--;else if(1===l.columnSpan&&l.rowSpan>1)for(t=l.rowSpan,r=n;t>1;)r++,this.rows.getRow(r).cells.getCell(d).isRowMergeContinue=!0,t--}}}},t}(sf.pdfexport.PdfLayoutElement),_t=function(){function e(e){this.cellWidth=0,this.cellHeight=0,this.finishedDrawingCell=!0,sf.base.isNullOrUndefined(e)?(this.rowSpan=1,this.columnSpan=1):this.row=e,this.style={}}return Object.defineProperty(e.prototype,"height",{get:function(){return 0===this.cellHeight&&(this.cellHeight=this.measureHeight()),this.cellHeight},set:function(e){this.cellHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return 0===this.cellWidth&&(this.cellWidth=this.measureWidth()),Math.round(this.cellWidth)},set:function(e){this.cellWidth=e},enumerable:!0,configurable:!0}),e.prototype.measureWidth=function(){var e=0,t=new sf.pdfexport.PdfStringLayouter;if("string"==typeof this.value){var i=new sf.pdfexport.PdfStandardFont(this.row.treegrid.ganttStyle.fontFamily,this.style.fontSize,this.style.fontStyle);e+=t.layout(this.value,i,this.style.format,new sf.pdfexport.SizeF(Number.MAX_VALUE,Number.MAX_VALUE),!1,new sf.pdfexport.SizeF(0,0)).actualSize.width,e+=2*(this.style.borders.left.width+this.style.borders.right.width)}return void 0!==this.row.treegrid.style.cellPadding.left&&this.row.treegrid.style.cellPadding.hasLeftPad&&(e+=this.row.treegrid.style.cellPadding.left),void 0!==this.row.treegrid.style.cellPadding.right&&this.row.treegrid.style.cellPadding.hasRightPad&&(e+=this.row.treegrid.style.cellPadding.right),e+=this.row.treegrid.style.cellSpacing},e.prototype.measureHeight=function(){var e=this.row.treegrid.rowHeight,t=0,i=this.calculateWidth();i-=this.row.treegrid.style.cellPadding.right+this.row.treegrid.style.cellPadding.left,i-=this.style.borders.left.width+this.style.borders.right.width;var r=new sf.pdfexport.PdfStringLayouter;if("string"==typeof this.value||"string"==typeof this.remainingString){var a=this.value;this.finishedDrawingCell||(a=sf.base.isNullOrUndefined(this.remainingString)||""===this.remainingString?this.value:this.remainingString);var s=new sf.pdfexport.PdfStandardFont(this.row.treegrid.ganttStyle.fontFamily,this.style.fontSize,this.style.fontStyle);t+=r.layout(a,s,this.style.format,new sf.pdfexport.SizeF(i,0),!1,new sf.pdfexport.SizeF(0,0)).actualSize.height,t+=2*(this.style.borders.top.width+this.style.borders.bottom.width)}return t+=this.row.treegrid.style.cellPadding.top+this.row.treegrid.style.cellPadding.bottom,(t+=this.row.treegrid.style.cellSpacing)>e?t:e},e.prototype.calculateWidth=function(){for(var e=this.row.cells.indexOf(this),t=this.columnSpan,i=0,r=0;r<t;r++)i+=this.row.treegrid.columns.getColumn(e+r).width;return this.row.treegrid.columns.getColumn(e).isTreeColumn&&(i-=10*this.row.level),i},e.prototype.draw=function(e,t,i,r){var a=null;if(i){for(var s=this.row.cells.indexOf(this),n=s+1;n<=s+this.columnSpan;n++)this.row.cells.getCell(n).isCellMergeContinue=!1,this.row.cells.getCell(n).isRowMergeContinue=!1;this.columnSpan=1}if((this.isCellMergeContinue||this.isRowMergeContinue)&&this.isCellMergeContinue&&this.row.treegrid.style.allowHorizontalOverflow)return this.row.rowOverflowIndex>0&&this.row.cells.indexOf(this)!==this.row.rowOverflowIndex+1||0===this.row.rowOverflowIndex&&this.isCellMergeContinue,a;this.drawCellBackground(e,t);var o=new sf.pdfexport.PdfSolidBrush(this.style.fontColor),d=null;d=this.row.isParentRow?new sf.pdfexport.PdfStandardFont(this.row.treegrid.ganttStyle.fontFamily,this.style.fontSize,sf.pdfexport.PdfFontStyle.Bold):new sf.pdfexport.PdfStandardFont(this.row.treegrid.ganttStyle.fontFamily,this.style.fontSize,this.style.fontStyle);var l=t;if(this.isHeaderCell||(l.x=l.x,l.width=l.width),l.height>=e.clientSize.height&&(this.row.treegrid.allowRowBreakAcrossPages?(l.height-=l.y,t.height-=t.y):(l.height=e.clientSize.height,t.height=e.clientSize.height)),l=this.adjustContentLayoutArea(l),"string"==typeof this.value||"string"==typeof this.remainingString){var p=null;this.finishedDrawingCell?(p=""===this.remainingString?this.remainingString:this.value,e.drawString(p,d,null,o,l.x+r,l.y,l.width-r-10,l.height-10,this.style.format)):e.drawString(this.remainingString,d,null,o,l.x+r,l.y,this.style.format),a=e.stringLayoutResult}return null!=this.style.borders&&this.drawCellBorder(e,t),a},e.prototype.drawCellBackground=function(e,t){var i=new sf.pdfexport.PdfSolidBrush(this.style.backgroundColor);null!=i&&(e.save(),e.drawRectangle(i,t.x,t.y,t.width,t.height),e.restore())},e.prototype.adjustContentLayoutArea=function(e){var t=new sf.pdfexport.RectangleF(new sf.pdfexport.PointF(e.x,e.y),new sf.pdfexport.SizeF(e.width,e.height)),i=this.style.padding;if(this.value instanceof zt){var r=this.value.size;this.style.format.alignment===sf.pdfexport.PdfTextAlignment.Center?(t.x+=i.left+(t.width-r.width)/2,t.y+=i.top+(t.height-r.height)/2):this.style.format.alignment===sf.pdfexport.PdfTextAlignment.Left?(t.x+=i.left,t.y+=i.top):this.style.format.alignment===sf.pdfexport.PdfTextAlignment.Right&&(t.x+=i.left+(t.width-r.width),t.y+=i.top)}else t.x+=i.left,t.y+=i.top;return t},e.prototype.drawCellBorder=function(e,t){if(this.row.treegrid.style.borderOverlapStyle===sf.pdfexport.PdfBorderOverlapStyle.Inside&&(t.x+=this.style.borders.left.width,t.y+=this.style.borders.top.width,t.width-=this.style.borders.right.width,t.height-=this.style.borders.bottom.width),this.style.borders.isAll&&this.isHeaderCell)return e.drawRectangle(this.style.borders.left,t.x,t.y,t.width,t.height),void e.restore();var i=new sf.pdfexport.PointF(t.x,t.y+t.height),r=new sf.pdfexport.PointF(t.x,t.y),a=this.style.borders.left;this.style.borders.left.dashStyle===sf.pdfexport.PdfDashStyle.Solid&&(a.lineCap=sf.pdfexport.PdfLineCap.Square),e.drawLine(a,i,r),e.restore(),i=new sf.pdfexport.PointF(t.x+t.width,t.y),r=new sf.pdfexport.PointF(t.x+t.width,t.y+t.height),a=this.style.borders.right,t.x+t.width>e.clientSize.width-a.width/2&&(i=new sf.pdfexport.PointF(e.clientSize.width-a.width/2,t.y),r=new sf.pdfexport.PointF(e.clientSize.width-a.width/2,t.y+t.height)),this.style.borders.right.dashStyle===sf.pdfexport.PdfDashStyle.Solid&&(a.lineCap=sf.pdfexport.PdfLineCap.Square),e.drawLine(a,i,r),e.restore(),i=new sf.pdfexport.PointF(t.x,t.y),r=new sf.pdfexport.PointF(t.x+t.width,t.y),a=this.style.borders.top,this.style.borders.top.dashStyle===sf.pdfexport.PdfDashStyle.Solid&&(a.lineCap=sf.pdfexport.PdfLineCap.Square),e.drawLine(a,i,r),e.restore(),i=new sf.pdfexport.PointF(t.x+t.width,t.y+t.height),r=new sf.pdfexport.PointF(t.x,t.y+t.height),a=this.style.borders.bottom,t.y+t.height>e.clientSize.height-a.width/2&&(i=new sf.pdfexport.PointF(t.x+t.width,e.clientSize.height-a.width/2),r=new sf.pdfexport.PointF(t.x,e.clientSize.height-a.width/2)),this.style.borders.bottom.dashStyle===sf.pdfexport.PdfDashStyle.Solid&&(a.lineCap=sf.pdfexport.PdfLineCap.Square),e.drawLine(a,i,r),e.restore()},e}(),Xt=function(){function e(e){this.treegridRow=e,this.cells=[]}return e.prototype.getCell=function(e){if(e<0||e>=this.count)throw new Error("IndexOutOfRangeException");return this.cells[e]},Object.defineProperty(e.prototype,"count",{get:function(){return this.cells.length},enumerable:!0,configurable:!0}),e.prototype.add=function(e){if(void 0===e){var t=new _t;return this.add(t),e}e.row=this.treegridRow,this.cells.push(e)},e.prototype.indexOf=function(e){return this.cells.indexOf(e)},e}(),Yt=function(){function e(e){this.treegridRowOverflowIndex=0,this.rowHeight=0,this.rowWidth=0,this._isParentRow=!1,this.intendLevel=0,this.pdfTreeGrid=e}return Object.defineProperty(e.prototype,"cells",{get:function(){return sf.base.isNullOrUndefined(this.treegridCells)&&(this.treegridCells=new Xt(this)),this.treegridCells},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isParentRow",{get:function(){return this._isParentRow},set:function(e){this._isParentRow=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"treegrid",{get:function(){return this.pdfTreeGrid},set:function(e){this.pdfTreeGrid=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rowBreakHeight",{get:function(){return void 0===this.treegridRowBreakHeight&&(this.treegridRowBreakHeight=0),this.treegridRowBreakHeight},set:function(e){this.treegridRowBreakHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rowOverflowIndex",{get:function(){return this.treegridRowOverflowIndex},set:function(e){this.treegridRowOverflowIndex=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"level",{get:function(){return this.intendLevel},set:function(e){this.intendLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 0===this.rowHeight&&(this.rowHeight=this.measureHeight()),this.rowHeight},set:function(e){this.rowHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return 0===this.rowWidth&&(this.rowWidth=this.measureWidth()),this.rowWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rowIndex",{get:function(){return this.treegrid.rows.rowCollection.indexOf(this)},enumerable:!0,configurable:!0}),e.prototype.measureWidth=function(){for(var e=this.treegrid.columns.columns,t=0,i=0;i<e.length;i++){t+=e[i].width}return t},e.prototype.measureHeight=function(){for(var e=this.cells.getCell(0).height,t=0;t<this.cells.count;t++){var i=this.cells.getCell(t);e=1===i.columnSpan||1===i.rowSpan?Math.max(e,i.height):Math.min(e,i.height),i.height=e}return e},e}(),Zt=function(){function e(e){this.rows=[],this.treegrid=e}return Object.defineProperty(e.prototype,"count",{get:function(){return this.rows.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rowCollection",{get:function(){return this.rows},enumerable:!0,configurable:!0}),e.prototype.addRow=function(e){if(void 0===e){var t=new Yt(this.treegrid);return this.addRow(t),t}if(0===e.cells.count)for(var i=0;i<this.treegrid.columns.count;i++)e.cells.add(new _t);this.rows.push(e)},e.prototype.getRow=function(e){return this.rows[e]},e}(),Qt=function(){function e(e){this.rows=[],this.treegrid=e,this.rows=[]}return e.prototype.getHeader=function(e){return this.rows[e]},Object.defineProperty(e.prototype,"count",{get:function(){return this.rows.length},enumerable:!0,configurable:!0}),e.prototype.add=function(e){this.rows.push(e)},e.prototype.indexOf=function(e){return this.rows.indexOf(e)},e}(),Kt=function(){function e(e){this.columnWidth=0,this.treeColumnIndex=!1,this._headerText="",this._field="",this.treegrid=e}return Object.defineProperty(e.prototype,"headerText",{get:function(){return this._headerText},set:function(e){this._headerText=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"field",{get:function(){return this._field},set:function(e){this._field=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.columnWidth},set:function(e){this.columnWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isTreeColumn",{get:function(){return this.treeColumnIndex},set:function(e){this.treeColumnIndex=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"format",{get:function(){return null==this.stringFormat&&(this.stringFormat=new sf.pdfexport.PdfStringFormat),this.stringFormat},set:function(e){this.stringFormat=e},enumerable:!0,configurable:!0}),e}(),Jt=function(){function e(e){this.internalColumns=[],this.columnWidth=0,this.treegrid=e,this.internalColumns=[]}return e.prototype.add=function(e){for(var t=0;t<e;t++){this.internalColumns.push(new Kt(this.treegrid));for(var i=0;i<this.treegrid.rows.count;i++){var r=this.treegrid.rows.getRow(i),a=new _t;a.value="",r.cells.add(a)}}},Object.defineProperty(e.prototype,"count",{get:function(){return this.internalColumns.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return 0===this.columnWidth&&(this.columnWidth=this.measureColumnsWidth()),this.columnWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columns",{get:function(){return this.internalColumns},enumerable:!0,configurable:!0}),e.prototype.getColumn=function(e){if(e>=0&&e<=this.columns.length)return this.columns[e];throw Error("can not get the column from the index: "+e)},e.prototype.measureColumnsWidth=function(){var e=0;this.treegrid.measureColumnsWidth();for(var t=0,i=this.internalColumns.length;t<i;t++)e+=this.internalColumns[t].width;return e},e.prototype.getDefaultWidths=function(e){for(var t=[],i=this.count,r=0;r<this.count;r++)t[r]=this.internalColumns[r].width,this.internalColumns[r].width>0?(e-=this.internalColumns[r].width,i--):t[r]=0;for(r=0;r<this.count;r++){var a=e/i;t[r]<=0&&(t[r]=a)}return t},e}(),$t=function(){function e(e){this.parent=e}return e.prototype.processGridExport=function(e,t,i){this.flatData=e,this.gantt=t,this.exportValueFormatter=new ei(this.parent.locale),this.exportProps=i,this.rowIndex=0,this.colIndex=0,this.columns=this.parent.treeGrid.columns,this.gantt.treeColumnIndex=this.parent.treeColumnIndex,this.gantt.rowHeight=l(this.parent.rowHeight),this.gantt.style.cellPadding.left=0,this.gantt.style.cellPadding.right=0,this.ganttStyle=this.gantt.ganttStyle,this.gantt.borderColor=this.ganttStyle.chartGridLineColor,this.processHeaderContent(),this.processGanttContent(),this.processTimeline(),this.processTaskbar(),this.processPredecessor()},e.prototype.processHeaderContent=function(){var e=this;this.rowIndex++,this.row=this.gantt.rows.addRow();var t=0;this.columns.forEach((function(i){e.isColumnVisible(i)&&(e.processColumnHeader(i,t),t++)}))},e.prototype.processColumnHeader=function(e,t){this.gantt.columns.add(1);var i=this.gantt.columns.getColumn(t);this.parent.treeColumnIndex===t&&(i.isTreeColumn=!0);var r=parseInt(e.width,10);i.width=l(r),this.totalColumnWidth+=i.width,i.headerText=e.headerText,i.field=e.field;var a=this.row.cells.getCell(t);a.value=e.headerText,a.isHeaderCell=!0;var s=this.parent.timelineModule.isSingleTier?45:60;this.row.height=l(s),this.copyStyles(this.ganttStyle.columnHeader,a,!1),e.headerTextAlign&&(a.style.format.alignment=sf.pdfexport.PdfTextAlignment[e.headerTextAlign]);var n={cell:a,style:a.style,value:a.value,column:e};this.parent.pdfColumnHeaderQueryCellInfo&&this.parent.trigger("pdfColumnHeaderQueryCellInfo",n),a.value=n.value},e.prototype.isColumnVisible=function(e){var t=e.visible||this.exportProps.includeHiddenColumn,i=!!sf.base.isNullOrUndefined(e.template);return t&&i},e.prototype.processGanttContent=function(){var e=this;0===this.flatData.length?this.renderEmptyGantt():this.flatData.forEach((function(t){e.row=e.gantt.rows.addRow(),t.hasChildRecords?(e.gantt.rows.getRow(e.rowIndex).isParentRow=!0,e.processRecordRow(t)):e.processRecordRow(t),e.rowIndex++}))},e.prototype.processTimeline=function(){var e=this.parent.timelineModule;this.gantt.chartHeader.topTierHeight=this.gantt.chartHeader.bottomTierHeight=this.parent.timelineModule.isSingleTier?45:30,this.gantt.chartHeader.topTierCellWidth=e.topTierCellWidth,this.gantt.chartHeader.bottomTierCellWidth=e.bottomTierCellWidth,this.gantt.chartHeader.topTier=sf.base.extend([],[],e.topTierCollection,!0),this.gantt.chartHeader.bottomTier=sf.base.extend([],[],e.bottomTierCollection,!0),this.gantt.chartHeader.width=e.totalTimelineWidth,this.gantt.chartHeader.height=this.gantt.rows.getRow(0).height,this.gantt.timelineStartDate=new Date(e.timelineStartDate.getTime())},e.prototype.processPredecessor=function(){var e=this;(sf.base.isNullOrUndefined(this.exportProps.showPredecessorLines)||this.exportProps.showPredecessorLines)&&(this.parent.pdfExportModule.isPdfExport=!0,this.parent.predecessorModule.createConnectorLinesCollection(),this.parent.updatedConnectorLineCollection.forEach((function(t){var i=e.gantt.predecessor.add();i.parentLeft=t.parentLeft,i.childLeft=t.childLeft,i.parentWidth=t.parentWidth,i.childWidth=t.childWidth,i.parentIndex=t.parentIndex,i.childIndex=t.childIndex,i.rowHeight=t.rowHeight,i.type=t.type,i.milestoneParent=t.milestoneParent,i.milestoneChild=t.milestoneChild,i.lineWidth=e.parent.connectorLineWidth>5?l(5):l(e.parent.connectorLineWidth),i.connectorLineColor=e.ganttStyle.connectorLineColor,e.gantt.predecessorCollection.push(i)})),this.parent.pdfExportModule.isPdfExport=!1)},e.prototype.processRecordRow=function(e){var t=this;this.colIndex=0,this.row.level=e.level,this.columns.forEach((function(i){t.isColumnVisible(i)&&(t.processRecordCell(e,i,t.row),t.colIndex++)}))},e.prototype.processRecordCell=function(e,t,i){var r=i.cells.getCell(this.colIndex),a=this.parent.taskFields,s=e.ganttProperties;if("datepickeredit"===t.editType||"datetimepickeredit"===t.editType?r.value=this.parent.getFormatedDate(e[t.field],this.parent.getDateFormat()):t.field===a.duration?r.value=this.parent.getDurationString(s.duration,s.durationUnit):t.field===a.resourceInfo?r.value=s.resourceNames:t.field===a.work?r.value=this.parent.getWorkString(s.work,s.workUnit):r.value=sf.base.isNullOrUndefined(e[t.field])?"":e[t.field].toString(),r.isHeaderCell=!1,r.style.padding=new Bt,this.copyStyles(this.ganttStyle.cell,r,i.isParentRow),this.colIndex!==this.parent.treeColumnIndex?r.style.format.alignment=sf.pdfexport.PdfTextAlignment[t.textAlign]:r.style.format.paragraphIndent=10*r.row.level,null!=this.parent.pdfQueryCellInfo){var n={data:e,value:r.value,column:t,style:r.style,cell:r};n.value=this.exportValueFormatter.formatCellValue(n),this.parent.pdfQueryCellInfo&&this.parent.trigger("pdfQueryCellInfo",n),r.value=n.value}},e.prototype.processTaskbar=function(){var e=this;this.flatData.forEach((function(t){var i=e.gantt.taskbar.add(),a=t.ganttProperties;i.left=a.left,i.width=a.width,i.left<0&&(i.width=i.width+i.left,i.left=0),i.progress=a.progress,i.isScheduledTask=r(a),r?sf.base.isNullOrUndefined(a.endDate)&&sf.base.isNullOrUndefined(a.duration)?i.unscheduledTaskBy="startDate":sf.base.isNullOrUndefined(a.startDate)&&sf.base.isNullOrUndefined(a.duration)?i.unscheduledTaskBy="endDate":(i.unscheduledTaskBy="duration",i.unscheduleStarteDate=e.parent.dateValidationModule.getValidStartDate(t.ganttProperties),i.unscheduleEndDate=e.parent.dateValidationModule.getValidEndDate(t.ganttProperties)):(i.unscheduleStarteDate=null,i.unscheduleEndDate=null),i.startDate=a.startDate,i.endDate=a.endDate,i.height=e.parent.chartRowsModule.taskBarHeight,i.isMilestone=a.isMilestone,i.milestoneColor=new sf.pdfexport.PdfColor(e.ganttStyle.taskbar.milestoneColor),i.isParentTask=t.hasChildRecords,a.isMilestone&&(i.height=a.width),t[e.parent.labelSettings.leftLabel]&&(i.leftTaskLabel.value=t[e.parent.labelSettings.leftLabel].toString()),t[e.parent.labelSettings.rightLabel]&&(i.rightTaskLabel.value=t[e.parent.labelSettings.rightLabel].toString());var s=a.isMilestone?Math.floor(e.parent.chartRowsModule.taskBarHeight/2)+33:33;i.rightTaskLabel.left=a.left+a.width+s,i.fontFamily=e.ganttStyle.fontFamily,i.progressWidth=a.progressWidth,i.labelColor=new sf.pdfexport.PdfColor(e.ganttStyle.label.fontColor),i.progressFontColor=new sf.pdfexport.PdfColor(e.ganttStyle.taskbar.progressFontColor),i.isParentTask?(i.taskColor=new sf.pdfexport.PdfColor(e.ganttStyle.taskbar.parentTaskColor),i.taskBorderColor=new sf.pdfexport.PdfColor(e.ganttStyle.taskbar.parentTaskBorderColor),i.progressColor=new sf.pdfexport.PdfColor(e.ganttStyle.taskbar.parentProgressColor)):(i.taskColor=new sf.pdfexport.PdfColor(e.ganttStyle.taskbar.taskColor),i.taskBorderColor=new sf.pdfexport.PdfColor(e.ganttStyle.taskbar.taskBorderColor),i.progressColor=new sf.pdfexport.PdfColor(e.ganttStyle.taskbar.progressColor)),i.gridLineColor=new sf.pdfexport.PdfColor(e.ganttStyle.chartGridLineColor),e.gantt.taskbarCollection.push(i);var n={};n.progressFontColor=i.progressFontColor,n.taskColor=i.taskColor,n.taskBorderColor=i.taskBorderColor,n.progressColor=i.progressColor,n.milestoneColor=i.milestoneColor;var o={taskbar:n,data:t};e.parent.pdfQueryTaskbarInfo&&(e.parent.trigger("pdfQueryTaskbarInfo",o),i.progressFontColor=o.taskbar.progressFontColor,i.taskColor=o.taskbar.taskColor,i.taskBorderColor=o.taskbar.taskBorderColor,i.progressColor=o.taskbar.progressColor,i.milestoneColor=o.taskbar.milestoneColor)}))},e.prototype.getHorizontalAlignment=function(e,t){switch(void 0===t&&(t=new sf.pdfexport.PdfStringFormat),e){case"Right":t.alignment=sf.pdfexport.PdfTextAlignment.Right;break;case"Center":t.alignment=sf.pdfexport.PdfTextAlignment.Center;break;case"Justify":t.alignment=sf.pdfexport.PdfTextAlignment.Justify;break;case"Left":t.alignment=sf.pdfexport.PdfTextAlignment.Left}return t},e.prototype.getVerticalAlignment=function(e,t,i){switch(void 0===t&&(t=new sf.pdfexport.PdfStringFormat,t=this.getHorizontalAlignment(i,t)),e){case"Bottom":t.lineAlignment=sf.pdfexport.PdfVerticalAlignment.Bottom;break;case"Middle":t.lineAlignment=sf.pdfexport.PdfVerticalAlignment.Middle;break;case"Top":t.lineAlignment=sf.pdfexport.PdfVerticalAlignment.Top}return t},e.prototype.getFontFamily=function(e){switch(e){case"TimesRoman":return 2;case"Courier":return 1;case"Symbol":return 3;case"ZapfDingbats":return 4;default:return 0}},e.prototype.getFont=function(e){if(e.font)return e.font;var t=sf.base.isNullOrUndefined(e.style.fontSize)?9.75:.75*e.style.fontSize,i=sf.base.isNullOrUndefined(e.style.fontFamily)?sf.pdfexport.PdfFontFamily.TimesRoman:this.getFontFamily(e.style.fontFamily),r=sf.pdfexport.PdfFontStyle.Regular;return!sf.base.isNullOrUndefined(e.style.bold)&&e.style.bold&&(r|=sf.pdfexport.PdfFontStyle.Bold),!sf.base.isNullOrUndefined(e.style.italic)&&e.style.italic&&(r|=sf.pdfexport.PdfFontStyle.Italic),!sf.base.isNullOrUndefined(e.style.underline)&&e.style.underline&&(r|=sf.pdfexport.PdfFontStyle.Underline),!sf.base.isNullOrUndefined(e.style.strikeout)&&e.style.strikeout&&(r|=sf.pdfexport.PdfFontStyle.Strikeout),new sf.pdfexport.PdfStandardFont(i,t,r)},e.prototype.renderEmptyGantt=function(){var e=this.gantt.rows.addRow();e.cells.getCell(0).isHeaderCell=!1,e.height=l(this.parent.rowHeight),this.copyStyles(this.ganttStyle.columnHeader,e.cells.getCell(0),e.isParentRow);var t=this.columns.length;this.mergeCells(0,0,t)},e.prototype.mergeCells=function(e,t,i){this.gantt.rows.getRow(e).cells.getCell(t).columnSpan=i},e.prototype.copyStyles=function(e,t,i){t.style.fontColor=new sf.pdfexport.PdfColor(e.fontColor),t.style.backgroundColor=new sf.pdfexport.PdfColor(e.backgroundColor),t.style.borderColor=new sf.pdfexport.PdfColor(e.borderColor),t.style.fontSize=e.fontSize,t.style.fontStyle=e.fontStyle,t.style.format=Object.assign(new sf.pdfexport.PdfStringFormat,e.format),t.style.borders=new Nt,t.style.borders.all=new sf.pdfexport.PdfPen(t.style.borderColor),t.style.padding=new Bt;var r=0;r=t.isHeaderCell?this.parent.timelineModule.isSingleTier?22.5:30:this.parent.rowHeight/2,t.style.padding.top=r-e.fontSize,t.style.padding.bottom=r-e.fontSize,t.style.padding.left=10,t.style.padding.right=10},e.prototype.initializePdf=function(e){this.pdfDoc=e;var t=[],i=this.pdfDoc.pageSettings.width-82;this.totalColumnWidth>this.pdfDoc.pageSettings.width-82?this.gantt.style.allowHorizontalOverflow=!0:i/this.columns.length<t[0]&&(this.gantt.columns.getColumn(0).width=t[0]);this.pdfDoc.sections.add();if(this.exportProps.enableFooter||sf.base.isNullOrUndefined(this.exportProps.enableFooter)){var r=new sf.pdfexport.RectangleF(0,0,e.pageSettings.width,35),a=new sf.pdfexport.PdfPen(this.ganttStyle.chartGridLineColor),s=new sf.pdfexport.PdfPageTemplateElement(r),n=new sf.pdfexport.PdfSolidBrush(this.ganttStyle.footer.backgroundColor);s.graphics.drawRectangle(a,n,0,0,e.pageSettings.width,35);var o=new sf.pdfexport.PdfStandardFont(this.ganttStyle.fontFamily,this.ganttStyle.footer.fontSize,this.ganttStyle.footer.fontStyle),d=new sf.pdfexport.PdfSolidBrush(this.ganttStyle.footer.fontColor),l=new sf.pdfexport.PdfPageNumberField(o),p=new sf.pdfexport.PdfPageCountField(o,d),h=new sf.pdfexport.PdfCompositeField(o,d,"Page {0}",l,p);h.stringFormat=this.ganttStyle.footer.format,h.bounds=r,h.draw(s.graphics,new sf.pdfexport.PointF(0,0)),e.template.bottom=s}},e}(),ei=function(){function e(e){this.valueFormatter=new sf.grids.ValueFormatter(e),this.internationalization=new sf.base.Internationalization(e)}return e.prototype.returnFormattedValue=function(e,t){return!sf.base.isNullOrUndefined(e.value)&&e.value?this.valueFormatter.getFormatFunction(t)(e.value):""},e.prototype.formatCellValue=function(e){if(e.isForeignKey&&(e.value=sf.base.getValue(e.column.foreignKeyValue,sf.grids.getForeignData(e.column,{},e.value)[0])),"number"===e.column.type&&void 0!==e.column.format&&""!==e.column.format)return e.value?this.internationalization.getNumberFormat({format:e.column.format})(e.value):"";if("boolean"===e.column.type)return e.value?"true":"false";if("date"!==e.column.type&&"datetime"!==e.column.type&&"time"!==e.column.type||void 0===e.column.format)return(sf.base.isNullOrUndefined(e.column.type)||sf.base.isNullOrUndefined(e.value))&&sf.base.isNullOrUndefined(e.value)?"":e.value.toString();if("string"==typeof e.value&&(e.value=new Date(e.value)),"string"==typeof e.column.format){var t=void 0;return t="date"===e.column.type?{type:"date",skeleton:e.column.format}:"time"===e.column.type?{type:"time",skeleton:e.column.format}:{type:"dateTime",skeleton:e.column.format},this.returnFormattedValue(e,t)}if(e.column.format instanceof Object&&void 0===e.column.format.type)return e.value.toString();var i=void 0;return i="date"===e.column.type?{type:e.column.format.type,format:e.column.format.format,skeleton:e.column.format.skeleton}:"time"===e.column.type?{type:"time",format:e.column.format.format,skeleton:e.column.format.skeleton}:{type:"dateTime",format:e.column.format.format,skeleton:e.column.format.skeleton},this.returnFormattedValue(e,i)},e}(),ti=function(){return(ti=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var a in t=arguments[i])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},ii=function(){function e(e){this.leftTaskLabel={},this.rightTaskLabel={},this.startPage=-1,this.endPage=-1,this.parent=e}return e.prototype.add=function(){return new e(this.parent)},e.prototype.GetNextPage=function(e){var t=e.section,i=t.indexOf(e);return i===t.count-1?t.add():t.getPages()[i+1]},e.prototype.drawTaskbar=function(e,t,i,r,a,s){var n=e.graphics,o=!1,d=e.getClientSize();t.y+a>d.height&&(n=(e=this.GetNextPage(e)).graphics,t.y=0,this.parent.pdfExportModule.gantt.enableHeader&&(this.parent.pdfExportModule.gantt.chartHeader.drawPageTimeline(e,t,i),t.y=l(this.parent.timelineModule.isSingleTier?45:60)),o=!0),this.drawLeftLabel(e,t,i,r);var p=new sf.pdfexport.PdfStandardFont(this.fontFamily,9,sf.pdfexport.PdfFontStyle.Regular),h=new sf.pdfexport.PdfSolidBrush(this.progressFontColor),c=new sf.pdfexport.PdfStringFormat;c.lineAlignment=sf.pdfexport.PdfVerticalAlignment.Middle,c.alignment=sf.pdfexport.PdfTextAlignment.Right;var u=-1;if(s.isMilestone)this.drawMilestone(e,t,i,r);else{var f=new sf.pdfexport.PdfPen(s.taskBorderColor),g=new sf.pdfexport.PdfSolidBrush(s.taskColor),m=new sf.pdfexport.PdfPen(s.progressColor),y=new sf.pdfexport.PdfSolidBrush(s.progressColor),b=l((this.parent.rowHeight-this.height)/2);u=e.section.indexOf(e);var v=sf.base.isNullOrUndefined(this.unscheduleStarteDate)?this.startDate:this.unscheduleStarteDate,D=sf.base.isNullOrUndefined(this.unscheduleEndDate)?this.endDate:this.unscheduleEndDate;if(i.startDate<=v&&D<=i.endDate)this.isStartPoint||(this.taskStartPoint=ti({},t),this.isStartPoint=!0),this.isScheduledTask||"duration"===this.unscheduledTaskBy?(n.drawRectangle(f,g,t.x+l(this.left-r)+.5,t.y+b,l(s.width),l(s.height)),this.progress>0&&this.progressWidth>0&&this.isScheduledTask&&(n.drawRectangle(m,y,t.x+l(this.left-r)+.5,t.y+b,l(s.progressWidth),l(s.height)),sf.base.isNullOrUndefined(this.parent.taskFields.progress)||sf.base.isNullOrUndefined(this.parent.labelSettings.taskLabel)||n.drawString(this.progress.toString(),p,null,h,t.x+l(this.left-r),t.y+b,l(this.progressWidth),l(this.height),c))):this.drawUnscheduledTask(n,t,r,b),this.isCompleted=!0,this.startPage=u,this.endPage=u;else if(i.startDate<=v&&i.endDate>=v&&D>=i.endDate){this.isStartPoint||(this.taskStartPoint=ti({},t),this.isStartPoint=!0);var w;if(this.width=this.width-(i.totalWidth-(this.left-r)),w=i.totalWidth-(this.left-r),this.isScheduledTask||"duration"===this.unscheduledTaskBy){if(n.drawRectangle(f,g,t.x+l(this.left-r)+.5,t.y+b,l(w),l(s.height)),this.progress>0&&this.progressWidth>0&&this.isScheduledTask){var k=0;k=this.progressWidth<=w?this.progressWidth:w,n.drawRectangle(m,y,t.x+l(this.left-r)+.5,t.y+b,l(k),l(s.height)),this.progressWidth-=k,0===this.progressWidth&&0!==this.progress&&this.parent.labelSettings.taskLabel&&n.drawString(this.progress.toString(),p,null,h,t.x+l(this.left-r),t.y+b,l(k),l(this.height),c)}}else this.drawUnscheduledTask(n,t,r,b);this.left=0,this.isCompleted=!1,this.startPage=u}else if(D<=i.endDate&&i.startDate<=D&&!this.isCompleted)this.isStartPoint||(this.taskStartPoint=ti({},t),this.isStartPoint=!0),n.drawRectangle(f,g,t.x+l(s.left+.5),t.y+b,l(s.width),l(s.height)),this.isScheduledTask&&(n.drawRectangle(m,y,t.x+l(s.left+.5),t.y+b,l(s.progressWidth),l(s.height)),0===this.progressWidth&&0!==this.progress&&n.drawString(this.progress.toString(),p,null,h,t.x+l(this.left),t.y+b,l(this.progressWidth),l(this.height),c)),this.isCompleted=!0,this.endPage=u;else if(v<i.startDate&&D>i.endDate){if(this.isStartPoint||(this.taskStartPoint=ti({},t),this.isStartPoint=!0),n.drawRectangle(f,g,t.x+l(s.left)+.5,t.y+b,l(i.totalWidth),l(s.height)),this.progress>0&&this.progressWidth>0&&this.isScheduledTask){k=0;k=this.progressWidth<=i.totalWidth?this.progressWidth:i.totalWidth,n.drawRectangle(m,y,t.x+l(s.left)+.5,t.y+b,l(k),l(s.height)),this.progressWidth-=k,0===this.progressWidth&&0!==this.progress&&n.drawString(this.progress.toString(),p,null,h,t.x+l(this.left),t.y+b,l(k),l(this.height),c)}this.isCompleted=!1,this.width-=i.totalWidth}}return this.drawRightLabel(e,t,i,r),o},e.prototype.drawRightLabel=function(e,t,i,r){var a,s=e.graphics,n=(a=this.rightTaskLabel.isLeftCalculated?this.rightTaskLabel.left:l(this.rightTaskLabel.left))-l(r)+t.x;if(i.startPoint<=a&&a<i.endPoint&&!sf.base.isNullOrUndefined(this.rightTaskLabel.value)&&!this.rightTaskLabel.isCompleted){var o=this.getWidth(this.rightTaskLabel.value,i.endPoint-a,15),d=new sf.pdfexport.PdfStandardFont(this.fontFamily,9),p=(l(this.parent.rowHeight)-o.actualSize.height)/2,h=new sf.pdfexport.PointF(n,t.y+p),c=new sf.pdfexport.SizeF(o.actualSize.width,o.actualSize.height),u=new sf.pdfexport.RectangleF(h,c),f=new sf.pdfexport.PdfStringFormat;if(f.alignment=sf.pdfexport.PdfTextAlignment.Right,f.lineAlignment=sf.pdfexport.PdfVerticalAlignment.Middle,o.actualSize.width>0){var g=new sf.pdfexport.PdfSolidBrush(this.labelColor);s.drawString(o.lines[0].text,d,null,g,u.x,u.y,o.actualSize.width,o.actualSize.height,f),null!==o.remainder?(this.rightTaskLabel.value=o.remainder,this.rightTaskLabel.left=i.endPoint,this.rightTaskLabel.isLeftCalculated=!0):this.rightTaskLabel.isCompleted=!0}else this.rightTaskLabel.left=i.endPoint}},e.prototype.drawLeftLabel=function(e,t,i,r){var a,s=e.graphics;if(!sf.base.isNullOrUndefined(this.leftTaskLabel.value)){var n;if(n=this.left,this.leftTaskLabel.isLeftCalculated)a=this.leftTaskLabel.left;else{var o=this.getWidth(this.leftTaskLabel.value,Number.MAX_VALUE,15);a=l(n-(this.isMilestone?Math.floor(this.parent.chartRowsModule.taskBarHeight/2)+33:33))-o.actualSize.width,this.leftTaskLabel.left=a,this.leftTaskLabel.isLeftCalculated=!0}var d=a-l(r)+t.x;if(i.startPoint<=a&&a<i.endPoint&&!sf.base.isNullOrUndefined(this.leftTaskLabel.value)&&!this.leftTaskLabel.isCompleted){o=this.getWidth(this.leftTaskLabel.value,i.endPoint-a,15);var p=new sf.pdfexport.PdfStandardFont(this.fontFamily,9),h=(l(this.parent.rowHeight)-o.actualSize.height)/2,c=new sf.pdfexport.PointF(d,t.y+h),u=new sf.pdfexport.SizeF(o.actualSize.width,o.actualSize.height),f=new sf.pdfexport.RectangleF(c,u),g=new sf.pdfexport.PdfStringFormat;if(g.alignment=sf.pdfexport.PdfTextAlignment.Right,g.lineAlignment=sf.pdfexport.PdfVerticalAlignment.Middle,o.actualSize.width>0){var m=new sf.pdfexport.PdfSolidBrush(this.labelColor);s.drawString(o.lines[0].text,p,null,m,f.x,f.y,o.actualSize.width,o.actualSize.height,g),null!==o.remainder?(this.leftTaskLabel.value=o.remainder,this.leftTaskLabel.left=i.endPoint):this.leftTaskLabel.isCompleted=!0}else this.leftTaskLabel.left=i.endPoint}}},e.prototype.getWidth=function(e,t,i){var r=new sf.pdfexport.PdfStandardFont(this.fontFamily,9),a=new sf.pdfexport.PdfStringLayouter,s=new sf.pdfexport.PdfStringFormat;return s.alignment=sf.pdfexport.PdfTextAlignment.Left,s.wordWrap=sf.pdfexport.PdfWordWrapType.Character,s.lineAlignment=sf.pdfexport.PdfVerticalAlignment.Middle,a.layout(e,r,s,new sf.pdfexport.SizeF(t,i),!1,new sf.pdfexport.SizeF(t,i))},e.prototype.drawUnscheduledTask=function(e,t,i,r){var a=new sf.pdfexport.PdfSolidBrush(this.taskColor);e.drawRectangle(a,t.x+l(this.left-i),t.y+r,l(3),l(this.height))},e.prototype.drawMilestone=function(e,t,i,r){if(i.startDate<=this.startDate&&this.startDate<=i.endDate){var a=e.graphics,s=e.section.indexOf(e);this.taskStartPoint=ti({},t);var n=new sf.pdfexport.PdfPen(this.milestoneColor),o=l((this.parent.rowHeight-this.height)/2),d=new sf.pdfexport.PdfSolidBrush(this.milestoneColor);a.save();var p=Math.floor(.6*this.parent.chartRowsModule.taskBarHeight);a.translateTransform(t.x+l(this.left-r),t.y+o-.7*this.parent.chartRowsModule.taskBarHeight/2),a.rotateTransform(45),a.drawRectangle(n,d,0,0,l(p),l(p)),a.restore(),this.endPage=this.startPage=s}},e}(),ri=function(){function e(e){this.width=0,this.gantt=e,this.parent=e.parent,this.topTierPoint=new sf.pdfexport.PointF,this.bottomTierPoint=new sf.pdfexport.PointF,this.topTierIndex=0,this.bottomTierIndex=0,this.prevTopTierIndex=0,this.prevBottomTierIndex=0}return e.prototype.drawTimeline=function(e,t,i){var r=Math.floor(i.totalWidth),a=0;for(this.topTierPoint.x=t.x,this.topTierPoint.y=t.y,this.prevTopTierIndex=this.topTierIndex,this.prevBottomTierIndex=this.bottomTierIndex;r>0;){var s=this.topTier[this.topTierIndex];if(this.topTier.length>this.topTierIndex){var n=!1;this.topTier[this.topTierIndex].isFinished||(r>=s.width?(a=s.width,s.isFinished=!0,s.completedWidth=a,n=!0):(a=r,n=!1,s.isFinished=!1,s.width=s.width-r,s.completedWidth=a)),this.triggerQueryTimelinecell(e,this.topTierPoint.x,this.topTierPoint.y,this.topTierHeight,a,s.value,!0),this.topTierPoint.x+=l(a),r-=a,n&&this.topTierIndex++}else r=0}r=Math.floor(i.totalWidth);var o=this.parent.timelineModule.isSingleTier?0:this.topTierHeight;for(this.bottomTierPoint=new sf.pdfexport.PointF(t.x,l(t.y+o));r>0;){var d=this.bottomTier[this.bottomTierIndex];if(this.bottomTier.length>this.bottomTierIndex){n=!0;var p=d.width;r<p&&(p=r,n=!1,d.completedWidth=p),this.triggerQueryTimelinecell(e,this.bottomTierPoint.x,this.bottomTierPoint.y,this.bottomTierHeight,p,d.value,!1),this.bottomTierPoint.x=this.bottomTierPoint.x+l(p),r-=p,d.completedWidth=p,n&&this.bottomTierIndex++}else r=0}},e.prototype.drawPageTimeline=function(e,t,i){this.topTierPoint=sf.base.extend({},{},t,!0);for(var r=this.prevTopTierIndex;r<=this.topTierIndex;r++)if(this.topTier.length>r){var a=this.topTier[r];a.completedWidth>0&&(this.triggerQueryTimelinecell(e,this.topTierPoint.x,this.topTierPoint.y,this.topTierHeight,a.completedWidth,a.value,!0),this.topTierPoint.x+=l(a.completedWidth))}this.bottomTierPoint.x=t.x,this.bottomTierPoint.y=l(t.y+this.topTierHeight);for(r=this.prevBottomTierIndex;r<=this.bottomTierIndex;r++)if(this.bottomTier.length>r){var s=this.bottomTier[r];s.completedWidth>0&&(this.triggerQueryTimelinecell(e,this.bottomTierPoint.x,this.bottomTierPoint.y,this.bottomTierHeight,s.width,s.value,!1),this.bottomTierPoint.x=this.bottomTierPoint.x+l(s.width))}},e.prototype.triggerQueryTimelinecell=function(e,t,i,r,a,s,n){var o=e.graphics,d={},p=this.gantt.ganttStyle;d.borderColor=new sf.pdfexport.PdfColor(p.timeline.borderColor),d.fontColor=new sf.pdfexport.PdfColor(p.timeline.fontColor),d.fontSize=p.timeline.fontSize,d.fontStyle=p.timeline.fontStyle,d.backgroundColor=new sf.pdfexport.PdfColor(p.timeline.backgroundColor),p.timeline.padding&&(d.padding=p.timeline.padding);var h=new sf.pdfexport.PdfStringFormat;sf.base.isNullOrUndefined(p.timeline.format)?n?(h.lineAlignment=sf.pdfexport.PdfVerticalAlignment.Middle,h.alignment=sf.pdfexport.PdfTextAlignment.Left):(h.lineAlignment=sf.pdfexport.PdfVerticalAlignment.Middle,h.alignment=sf.pdfexport.PdfTextAlignment.Center,h.wordWrap=sf.pdfexport.PdfWordWrapType.Character):h=p.timeline.format,d.format=h;var c={timelineCell:d,value:s};this.parent.pdfQueryTimelineCellInfo&&this.parent.trigger("pdfQueryTimelineCellInfo",c);var u=c.timelineCell,f=new sf.pdfexport.PdfPen(c.timelineCell.borderColor),g=new sf.pdfexport.PdfSolidBrush(c.timelineCell.backgroundColor);o.drawRectangle(f,g,t,i,l(a),l(r));var m=new sf.pdfexport.PdfStandardFont(p.fontFamily,u.fontSize,u.fontStyle),y=new sf.pdfexport.PdfSolidBrush(c.timelineCell.fontColor),b=p.timeline.padding?c.timelineCell.padding.left:0,v=p.timeline.padding?c.timelineCell.padding.top:0;o.drawString(c.value,m,null,y,t+b,i+v,l(a),l(r),u.format)},e}(),ai=function(){return(ai=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var a in t=arguments[i])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},si=function(){function e(e,t){this.parent=e,this.pdfGantt=t}return e.prototype.add=function(){return new e(this.parent)},e.prototype.drawPredecessor=function(e){this.pdfGantt=e;var t,i,r,a,s=e.result.page.section.getPages(),n=e.taskbarCollection[this.parentIndex],o=e.taskbarCollection[this.childIndex],d=new sf.pdfexport.PdfPage,p=new sf.pdfexport.PdfPage,h="";switch(this.type){case"FS":if(!(o.startPage>-1&&n.endPage>-1))return;d=s[n.endPage],p=s[o.startPage],t=e.pdfPageDetail[n.endPage-e.chartPageIndex],i=e.pdfPageDetail[o.startPage-e.chartPageIndex],h=this.parentIndex<this.childIndex?this.parentLeft<this.childLeft&&this.childLeft>this.parentLeft+this.parentWidth+25?"FSType1":"FSType2":this.parentLeft<this.childLeft&&this.childLeft>this.parentLeft+this.parentWidth+25?"FSType3":"FSType4";break;case"SF":if(!(o.endPage>-1&&n.startPage>-1))return;d=s[n.startPage],p=s[o.endPage],t=e.pdfPageDetail[n.endPage-e.chartPageIndex],i=e.pdfPageDetail[o.startPage-e.chartPageIndex],h=this.parentIndex<this.childIndex?this.parentLeft>this.childLeft+this.childWidth?"SFType1":"SFType2":this.parentLeft>this.childLeft+this.childWidth?"SFType3":"SFType4";break;case"FF":if(!(o.endPage>-1&&n.endPage>-1))return;d=s[n.endPage],p=s[o.endPage],t=e.pdfPageDetail[n.endPage-e.chartPageIndex],i=e.pdfPageDetail[o.endPage-e.chartPageIndex],h=this.parentIndex<this.childIndex?this.childLeft+this.childWidth>=this.parentLeft+this.parentWidth?"FFType1":"FFType2":this.childLeft+this.childWidth>=this.parentLeft+this.parentWidth?"FFType3":"FFType4";break;case"SS":if(!(o.startPage>-1&&n.startPage>-1))return;d=s[n.startPage],p=s[o.startPage],t=e.pdfPageDetail[n.startPage-e.chartPageIndex],i=e.pdfPageDetail[o.startPage-e.chartPageIndex],h=this.parentIndex<this.childIndex?this.parentLeft>=this.childLeft?"SSType1":"SSType2":this.parentLeft>=this.childLeft?"SSType3":"SSType4"}var c,u,f,g,m,y,b=Math.round((this.parent.rowHeight-1)/2);b=l(b),c=u=f=g=m=y=new sf.pdfexport.PointF;var v=ai({},n.taskStartPoint),D=ai({},o.taskStartPoint);r=v.y+t.startPoint.y,a=D.y+i.startPoint.y;var w=new sf.pdfexport.PointF(l(this.parentLeft+this.parentWidth),r+b),k=new sf.pdfexport.PointF(l(this.parentLeft)-1,r+b),T=new sf.pdfexport.PointF(l(this.childLeft-20),a+b),S=new sf.pdfexport.PointF(l(this.childLeft-6-this.lineWidth)-1,a+b),P=new sf.pdfexport.PointF(l(this.childLeft+this.childWidth+6+this.lineWidth)+1,a+b);switch(h){case"FSType1":case"FSType3":c=w,u=new sf.pdfexport.PointF(l(this.childLeft-20),r+b),f=T,g=S,this.connectLines(d,p,c,u,f,g,o,b);break;case"FSType2":c=w,u=new sf.pdfexport.PointF(c.x+10,r+b),f=new sf.pdfexport.PointF(c.x+10,a+2),g=new sf.pdfexport.PointF(l(this.childLeft-20),a+2),m=T,y=S,this.connectLines(d,p,c,u,f,g,o,b,m,y);break;case"FSType4":c=w,u=new sf.pdfexport.PointF(c.x+10,r+b),f=new sf.pdfexport.PointF(c.x+10,r+2),g=new sf.pdfexport.PointF(l(this.childLeft-20),r+2),m=T,y=S,this.connectLines(d,p,c,u,f,g,o,b,m,y);break;case"FFType1":case"FFType3":c=new sf.pdfexport.PointF(l(this.parentLeft+this.parentWidth)+1,r+b),u=new sf.pdfexport.PointF(l(this.childLeft+this.childWidth+20),r+b),f=new sf.pdfexport.PointF(u.x,a+b),g=P,this.connectLines(d,p,c,u,f,g,o,b);break;case"FFType2":case"FFType4":c=new sf.pdfexport.PointF(l(this.parentLeft+this.parentWidth)+1,r+b),u=new sf.pdfexport.PointF(l(this.parentLeft+this.parentWidth+20),r+b),f=new sf.pdfexport.PointF(u.x,a+b),g=P,this.connectLines(d,p,c,u,f,g,o,b);break;case"SSType1":case"SSType3":c=k,u=new sf.pdfexport.PointF(l(this.childLeft-20),r+b),f=new sf.pdfexport.PointF(u.x,a+b),g=S,this.connectLines(d,p,c,u,f,g,o,b);break;case"SSType2":case"SSType4":c=k,u=new sf.pdfexport.PointF(l(this.parentLeft-20),r+b),f=new sf.pdfexport.PointF(u.x,a+b),g=S,this.connectLines(d,p,c,u,f,g,o,b);break;case"SFType1":case"SFType3":c=k,u=new sf.pdfexport.PointF(l(this.childLeft+this.childWidth+20),r+b),f=new sf.pdfexport.PointF(u.x,a+b),g=P,this.connectLines(d,p,c,u,f,g,o,b);break;case"SFType2":c=k,u=new sf.pdfexport.PointF(l(this.parentLeft-20),r+b),f=new sf.pdfexport.PointF(u.x,a+2),g=new sf.pdfexport.PointF(l(this.childLeft+this.childWidth+20),a+2),m=new sf.pdfexport.PointF(g.x,a+b),y=P,this.connectLines(d,p,c,u,f,g,o,b,m,y);break;case"SFType4":c=k,u=new sf.pdfexport.PointF(l(this.parentLeft-20),r+b),f=new sf.pdfexport.PointF(u.x,r+2),g=new sf.pdfexport.PointF(l(this.childLeft+this.childWidth+20),r+2),m=new sf.pdfexport.PointF(g.x,a+b),y=P,this.connectLines(d,p,c,u,f,g,o,b,m,y)}},e.prototype.connectLines=function(e,t,i,r,a,s,n,o,d,l){this.drawLine(e,i,r),this.drawLine(e,r,a),this.drawLine(e,a,s),sf.base.isNullOrUndefined(d)||sf.base.isNullOrUndefined(l)||(this.drawLine(e,s,d),this.drawLine(e,d,l)),this.drawArrow(t,n,o)},e.prototype.contains=function(e,t,i){return e.x<=t&&t<e.x+e.width&&e.y<=i&&i<e.y+e.height},e.prototype.findPageIndex=function(e){for(var t=-1,i=0;i<this.pdfGantt.pdfPageDetail.length;i++){var r=this.pdfGantt.pdfPageDetail[i],a=new sf.pdfexport.RectangleF(r.startPoint.x,r.startPoint.y,r.width,r.height);if(this.contains(a,e.x,e.y)){t=i;break}}return t},e.prototype.drawLine=function(e,t,i){var r=this.pdfGantt.result.page.section.getPages(),a=e.graphics,s=ai({},i),n=ai({},i),o=ai({},i),d=this.pdfGantt.pdfPageDetail[e.section.indexOf(e)-this.pdfGantt.chartPageIndex],p=new sf.pdfexport.RectangleF(d.startPoint.x,d.startPoint.y,d.width,d.height),h=this.contains(p,t.x,t.y),c=this.contains(p,i.x,i.y),u=-1;if(t=new sf.pdfexport.PointF(t.x,t.y),i=new sf.pdfexport.PointF(i.x,i.y),!h&&!c||c&&!h)(u=this.findPageIndex(t))>-1&&(d=this.pdfGantt.pdfPageDetail[u],n=t,s=i,this.drawLine(r[u+this.pdfGantt.chartPageIndex],n,s));else if(!c&&h){var f=p.x,g=p.x+p.width,m=p.y+p.height,y=p.y;f>i.x?(o.x=i.x=f-1,n.x=f-1):g<i.x?(o.x=i.x=g,n.x=g,o.x+=1):m<i.y?(o.y=i.y=m,n.y=m,o.y+=1,this.pdfGantt.enableHeader&&(n.y+=this.parent.timelineModule.isSingleTier?l(45):l(62))):y>i.y&&(n.y=o.y=y-1,i.y=y,this.pdfGantt.enableHeader&&(o.y+=this.parent.timelineModule.isSingleTier?l(45):l(62),i.y+=this.parent.timelineModule.isSingleTier?l(45):l(62))),-1!==(u=this.findPageIndex(o))&&this.drawLine(r[u+this.pdfGantt.chartPageIndex],n,s)}if(h){t=new sf.pdfexport.PointF(t.x,t.y),i=new sf.pdfexport.PointF(i.x,i.y),t.x=t.x+d.pageStartX-d.startPoint.x,t.y=t.y-d.startPoint.y,i.x=i.x+d.pageStartX-d.startPoint.x,i.y=i.y-d.startPoint.y;var b=new sf.pdfexport.PdfSolidBrush(this.connectorLineColor),v=new sf.pdfexport.PdfPen(b,l(this.lineWidth));a.drawLine(v,t,i)}},e.prototype.drawArrow=function(e,t,i){var r,a=this.pdfGantt.pdfPageDetail[e.section.indexOf(e)-this.pdfGantt.chartPageIndex],s=new sf.pdfexport.RectangleF(new sf.pdfexport.PointF(a.startPoint.x,a.startPoint.y),new sf.pdfexport.SizeF(a.width,a.height)),n=new sf.pdfexport.PointF,o=e.section.getPages(),d=6+this.lineWidth;if(n="FS"===this.type||"SS"===this.type?new sf.pdfexport.PointF(l(this.childLeft)-1,t.taskStartPoint.y+a.startPoint.y):new sf.pdfexport.PointF(l(this.childLeft+this.childWidth)+1,t.taskStartPoint.y+a.startPoint.y),!this.contains(s,n.x,n.y)){var p=this.findPageIndex(n);p>-1&&(a=this.pdfGantt.pdfPageDetail[p],e=o[p+this.pdfGantt.chartPageIndex])}var h=e.graphics;n.x=n.x-a.startPoint.x+a.pageStartX,n.y=n.y-a.startPoint.y;var c=new sf.pdfexport.PointF(n.x,n.y+i);r="FS"===this.type||"SS"===this.type?new sf.pdfexport.PointF(c.x-l(d),c.y-l(d)):new sf.pdfexport.PointF(c.x+l(d),c.y-l(d));var u=new sf.pdfexport.PointF(r.x,r.y+l(2*d)),f=new sf.pdfexport.PdfSolidBrush(this.connectorLineColor),g=new sf.pdfexport.PdfPen(f,l(this.lineWidth));h.drawLine(g,c,r),h.drawLine(g,r,u),h.drawLine(g,u,c)},e}(),ni=(ct=function(e,t){return(ct=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}ct(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),oi=function(){return(oi=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var a in t=arguments[i])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},di=function(e){function t(t){var i=e.call(this)||this;return i.exportProps={},i.parent=t,i.chartHeader=new ri(i),i.predecessor=new si(t,i),i.headerDetails=[],i.pdfPageDetail=[],i.taskbarCollection=[],i.predecessorCollection=[],i}return ni(t,e),Object.defineProperty(t.prototype,"taskbar",{get:function(){return sf.base.isNullOrUndefined(this.taskbars)&&(this.taskbars=new ii(this.parent)),this.taskbars},enumerable:!0,configurable:!0}),t.prototype.drawChart=function(e){this.result=e,this.totalPages=this.result.page.section.count,this.perColumnPages=this.totalPages/this.layouter.columnRanges.length,this.calculateRange(),this.drawGantttChart(),this.drawPageBorder()},t.prototype.calculateRange=function(){for(var e=this.layouter.columnRanges[this.layouter.columnRanges.length-1],t=0,i=!0,r=0,a=0,s=0,n=l(this.chartHeader.width),o=this.parent.timelineModule,d=e[0];d<=e[1];d++)t+=this.layouter.treegrid.columns.getColumn(d).width;for((t+=.5)+100<this.result.page.getClientSize().width?(a=this.result.page.getClientSize().width-t,this.chartPageIndex=this.startPageIndex=this.totalPages-this.perColumnPages,i=!1,this.startPoint=new sf.pdfexport.PointF(t,0)):(this.result.page.section.add(),this.chartPageIndex=this.startPageIndex=this.totalPages,i=!0,this.startPoint=new sf.pdfexport.PointF(s,0));Math.round(s)<Math.round(n);){i?r=this.result.page.getClientSize().width:(r=a,i=!0);var h={},c=[],u=l(this.chartHeader.bottomTierCellWidth),f=0;0!==this.chartHeader.bottomTierCellWidth&&(f=Math.floor(r/u)*u),c[0]=s,n-s<=f?(c[1]=n,h.totalWidth=p(n-s)):(c[1]=s+f,h.totalWidth=p(f)),h.startPoint=c[0],h.endPoint=c[1],0===this.parent.cloneProjectStartDate.getHours()&&0===this.parent.cloneProjectStartDate.getMinutes()&&0===this.parent.cloneProjectStartDate.getSeconds()&&this.parent.cloneProjectStartDate.setHours(8);var g=this.parent.dataOperation.getDateFromFormat(this.parent.cloneProjectStartDate),m=sf.base.isNullOrUndefined(o.customTimelineSettings.bottomTier.count)?o.customTimelineSettings.topTier.count:o.customTimelineSettings.bottomTier.count;switch("None"===o.customTimelineSettings.bottomTier.unit?o.customTimelineSettings.topTier.unit:o.customTimelineSettings.bottomTier.unit){case"Minutes":h.startDate=new Date(g.getTime());var y=Math.floor(p(h.startPoint)/this.chartHeader.bottomTierCellWidth);h.startDate.setMinutes(h.startDate.getMinutes()+y*m),h.startDate.setSeconds(h.startDate.getSeconds()+1),h.endDate=new Date(h.startDate.getTime());var b=Math.floor(p(h.endPoint-h.startPoint)/this.chartHeader.bottomTierCellWidth);h.endDate.setMinutes(h.endDate.getMinutes()+b*m);break;case"Hour":h.startDate=new Date(g.getTime());var v=Math.floor(p(h.startPoint)/this.chartHeader.bottomTierCellWidth);h.startDate.setHours(h.startDate.getHours()+v*m),h.startDate.setMinutes(h.startDate.getMinutes()+1),h.endDate=new Date(h.startDate.getTime());var D=Math.floor(p(h.endPoint-h.startPoint)/this.chartHeader.bottomTierCellWidth);h.endDate.setHours(h.endDate.getHours()+D*m);break;case"Day":h.startDate=new Date(g.getTime());var w=Math.round(h.startPoint/l(this.chartHeader.bottomTierCellWidth));h.startDate.setDate(h.startDate.getDate()+w*m);var k=Math.round((h.endPoint-h.startPoint)/l(this.chartHeader.bottomTierCellWidth))-1;h.endDate=new Date(h.startDate.getTime()),h.endDate.setDate(h.startDate.getDate()+k*m);break;case"Week":h.startDate=new Date(g.getTime());var T=h.startPoint/l(this.chartHeader.bottomTierCellWidth)*7;h.startDate.setDate(h.startDate.getDate()+T*m);var S=7*Math.round((h.endPoint-h.startPoint)/l(this.chartHeader.bottomTierCellWidth))-1;h.endDate=new Date(h.startDate.getTime()),h.endDate.setDate(h.startDate.getDate()+S*m);break;case"Month":h.startDate=new Date(g.getTime());var P=h.startPoint/l(this.chartHeader.bottomTierCellWidth)*31;h.startDate.setDate(h.startDate.getDate()+P*m);var C=31*Math.round((h.endPoint-h.startPoint)/l(this.chartHeader.bottomTierCellWidth))-1;h.endDate=new Date(h.startDate.getTime()),h.endDate.setDate(h.startDate.getDate()+C*m);break;case"Year":h.startDate=new Date(g.getTime());var x=h.startPoint/l(this.chartHeader.bottomTierCellWidth)*365;h.startDate.setDate(h.startDate.getDate()+x*m);var R=365*Math.round((h.endPoint-h.startPoint)/l(this.chartHeader.bottomTierCellWidth))-1;h.endDate=new Date(h.startDate.getTime()),h.endDate.setDate(h.startDate.getDate()+R*m)}this.headerDetails.push(h),s+=f}},t.prototype.drawPageBorder=function(){for(var e=this.result.page.section.getPages(),t=0;t<e.length;t++){var i=e[t],r=i.graphics,a=i.getClientSize(),s=new sf.pdfexport.PdfPen(new sf.pdfexport.PdfColor(206,206,206));r.drawRectangle(s,0,0,a.width,a.height)}},t.prototype.drawGantttChart=function(){var e,t=this,i=this.startPoint,r=new sf.pdfexport.PointF,a=0,s=0,n=0;this.headerDetails.forEach((function(o,d){var p=t.result.page.section.getPages()[t.startPageIndex];t.chartHeader.drawTimeline(p,t.startPoint,o),i.y=i.y+l(t.parent.timelineModule.isSingleTier?45:60),a=i.x,n=l(t.parent.timelineModule.isSingleTier?45:60),t.headerDetails[t.headerDetails.indexOf(o)].startIndex=t.startPageIndex,t.headerDetails[t.headerDetails.indexOf(o)].pageStartPoint=i;for(var h=0;h<t.taskbarCollection.length;h++){var c=t.taskbarCollection[h],u=t.rows.getRow(h+1).height,f=t.result.page.section.getPages()[t.startPageIndex];c.drawTaskbar(f,i,o,s,u,t.taskbarCollection[h])&&(t.enableHeader?i.y=l(t.parent.timelineModule.isSingleTier?45:60):i.y=0,t.startPageIndex++,(e={}).height=n,e.pageStartX=a,e.startPoint=oi({},r),e.width=l(o.totalWidth),t.pdfPageDetail.push(e),r.y+=e.height,t.enableHeader?n=t.chartHeader.height:(i.y=0,n=0)),i.y+=u,n+=u}t.headerDetails[d].endIndex=t.startPageIndex,s+=o.totalWidth,(e={}).height=n,e.pageStartX=a,e.startPoint=oi({},r),e.width=l(o.totalWidth),t.pdfPageDetail.push(e),r.x+=e.width,r.y=0,t.enableHeader?n=t.chartHeader.height:i.y=0,t.headerDetails.indexOf(o)!==t.headerDetails.length-1&&(t.result.page.section.add(),t.startPageIndex=t.result.page.section.count-1,i=t.startPoint=new sf.pdfexport.PointF(0,0))}));for(var o=0;o<this.predecessorCollection.length;o++){this.predecessorCollection[o].drawPredecessor(this)}},t}(zt),li=function(){function e(e){this.isPdfExport=!1,this.parent=e,this.helper=new $t(this.parent),this.pdfDocument=void 0}return e.prototype.getModuleName=function(){return"pdfExport"},e.prototype.destroy=function(){},e.prototype.initGantt=function(){this.pdfDocument=void 0,this.gantt=new di(this.parent)},e.prototype.export=function(e,t,i){var r=this,a={requestType:"beforePdfExport",ganttObject:this.parent,cancel:!1};return this.parent.trigger("beforePdfExport",a),sf.base.getValue("cancel",a)?new Promise((function(e,t){return e()})):new Promise((function(a,s){r.exportWithData(i,a,e,t)}))},e.prototype.exportWithData=function(e,t,i,r){var a=this,s=[];sf.base.isNullOrUndefined(i)&&(i={}),s="CurrentViewData"===i.exportType?this.parent.currentViewData:this.parent.flatData,this.initGantt(),sf.base.isNullOrUndefined(e)?this.pdfDocument=new sf.pdfexport.PdfDocument:this.pdfDocument=e,this.processExport(s,i,r).then((function(){a.parent.trigger("pdfExportComplete",{}),t(a.pdfDocument)}))},e.prototype.processExport=function(e,t,i){var r=this,a=this.pdfDocument.sections.add();this.processSectionExportProperties(a,t);var s=a.pages.add();return new Promise((function(i,a){r.helper.processGridExport(e,r.gantt,t),r.helper.initializePdf(r.pdfDocument),i()})).then((function(){var e=new Gt;e.break=sf.pdfexport.PdfLayoutBreakType.FitElement;var a=r.gantt.drawGrid(s,0,0,e);return r.gantt.drawChart(a),i||(!sf.base.isNullOrUndefined(t)&&t.fileName?r.pdfDocument.save(t.fileName):r.pdfDocument.save("Export.pdf"),r.pdfDocument.destroy()),r.pdfDocument}))},e.prototype.processSectionExportProperties=function(e,t){if(sf.base.isNullOrUndefined(t))this.gantt.ganttStyle=new Ut(t.theme).style;else{var i=new sf.pdfexport.PdfPageSettings;if(sf.base.isNullOrUndefined(t.pageOrientation&&"Portrait"===t.pageOrientation)?i.orientation=sf.pdfexport.PdfPageOrientation.Landscape:i.orientation=sf.pdfexport.PdfPageOrientation.Portrait,sf.base.isNullOrUndefined(t.pageSize)||(i.size=this.getPageSize(t.pageSize)),e.setPageSettings(i),sf.base.isNullOrUndefined(t.ganttStyle))this.gantt.ganttStyle=new Ut(t.theme).style;else{var r=new Ut(t.theme).style;this.gantt.ganttStyle=sf.base.extend({},r,t.ganttStyle,!0)}}},e.prototype.getPageSize=function(e){switch(e){case"Letter":return new sf.pdfexport.SizeF(612,792);case"Note":return new sf.pdfexport.SizeF(540,720);case"Legal":return new sf.pdfexport.SizeF(612,1008);case"A0":return new sf.pdfexport.SizeF(2380,3368);case"A1":return new sf.pdfexport.SizeF(1684,2380);case"A2":return new sf.pdfexport.SizeF(1190,1684);case"A3":return new sf.pdfexport.SizeF(842,1190);case"A5":return new sf.pdfexport.SizeF(421,595);case"A6":return new sf.pdfexport.SizeF(297,421);case"A7":return new sf.pdfexport.SizeF(210,297);case"A8":return new sf.pdfexport.SizeF(148,210);case"A9":return new sf.pdfexport.SizeF(105,148);case"B0":return new sf.pdfexport.SizeF(2836,4008);case"B1":return new sf.pdfexport.SizeF(2004,2836);case"B2":return new sf.pdfexport.SizeF(1418,2004);case"B3":return new sf.pdfexport.SizeF(1002,1418);case"B4":return new sf.pdfexport.SizeF(709,1002);case"B5":return new sf.pdfexport.SizeF(501,709);case"Archa":return new sf.pdfexport.SizeF(648,864);case"Archb":return new sf.pdfexport.SizeF(864,1296);case"Archc":return new sf.pdfexport.SizeF(1296,1728);case"Archd":return new sf.pdfexport.SizeF(1728,2592);case"Arche":return new sf.pdfexport.SizeF(2592,3456);case"Flsa":return new sf.pdfexport.SizeF(612,936);case"HalfLetter":return new sf.pdfexport.SizeF(396,612);case"Letter11x17":return new sf.pdfexport.SizeF(792,1224);case"Ledger":return new sf.pdfexport.SizeF(1224,792);default:return new sf.pdfexport.SizeF(595,842)}},e}(),pi=function(){function e(e){this.parent=e,this.bindTreeGridProperties()}return e.prototype.getModuleName=function(){return"virtualScroll"},e.prototype.bindTreeGridProperties=function(){this.parent.treeGrid.enableVirtualization=this.parent.enableVirtualization,sf.treegrid.TreeGrid.Inject(sf.treegrid.VirtualScroll)},e.prototype.getTopPosition=function(){var e=this.parent.ganttChartModule.scrollElement.querySelector(".e-virtualtable").style.transform.split(",")[1].trim().split(")")[0];return parseFloat(e)},e.prototype.destroy=function(){},e}();return dt.Inject(St,Ct,Pt,kt,Tt,wt,Ot,xt,It,Et,Vt,Ft,li,pi),e.Gantt=dt,e.parentsUntil=t,e.isScheduledTask=r,e.getSwapKey=a,e.isRemoteData=s,e.getTaskData=n,e.formatString=o,e.getIndex=d,e.pixelToPoint=l,e.pointToPixel=p,e.getUid=c,e.load="load",e.rowDataBound="rowDataBound",e.queryCellInfo="queryCellInfo",e.toolbarClick="toolbarClick",e.keyPressed="key-pressed",e.Edit=wt,e.Reorder=kt,e.Resize=Tt,e.Filter=St,e.Sort=Pt,e.Dependency=tt,e.Selection=Ct,e.Toolbar=xt,e.DayMarkers=Ot,e.ContextMenu=It,e.ExcelExport=Et,e.ColumnMenu=Ft,e.RowDD=Vt,e.PdfExport=li,e.VirtualScroll=pi,e.Column=te,e.DayWorkingTime=se,e.AddDialogFieldSettings=de,e.EditDialogFieldSettings=he,e.EditSettings=fe,e.EventMarker=ye,e.FilterSettings=De,e.SearchSettings=Te,e.Holiday=Ce,e.LabelSettings=Me,e.SelectionSettings=Ee,e.SplitterSettings=Ue,e.TaskFields=Be,e.TimelineTierSettings=He,e.TimelineSettings=je,e.TooltipSettings=ze,e.SortDescriptor=Ye,e.SortSettings=Ze,e.ResourceFields=Je,e}({}))}});