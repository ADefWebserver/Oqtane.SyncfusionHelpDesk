!function(e){var t={};function i(a){if(t[a])return t[a].exports;var s=t[a]={i:a,l:!1,exports:{}};return e[a].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=e,i.c=t,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(a,s,function(t){return e[t]}.bind(null,s));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="_content/Syncfusion.Blazor/scripts/",i(i.s="./bundles/pivotview.js")}({"./bundles/pivotview.js":function(e,t,i){"use strict";i.r(t);i("./modules/pivotview.js")},"./modules/pivotview.js":function(e,t,i){function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}window.sf=window.sf||{},window.sf.pivotview=function(e){"use strict";var t,i,s,r=function(){function e(){}return e.getType=function(e){return e&&e.getDay?e.getHours()>0||e.getMinutes()>0||e.getSeconds()>0||e.getMilliseconds()>0?"datetime":"date":isNaN(Number(e))?a(e):"number"},e.resetTime=function(e){return e.setHours(0,0,0,0),e},e.getClonedData=function(e){var t=[];if(e)for(var i=0,a=e;i<a.length;i++){for(var s=a[i],r=Object.keys(s),n=0,o={};n<r.length;)o[r[n]]=s[r[n]],n++;t.push(o)}return t},e.getClonedPivotValues=function(e){for(var t=[],i=0;i<e.length;i++)if(e[i]){t[i]=[];for(var a=0;a<e[i].length;a++)e[i][a]&&(t[i][a]=this.getClonedPivotValueObj(e[i][a]))}return t},e.getClonedPivotValueObj=function(e){var t=0,i={};if(null!=e)for(var a=Object.keys(e);t<a.length;)i[a[t]]=e[a[t]],t++;else i=e;return i},e.getDefinedObj=function(e){var t=0,i={};if(null!=e)for(var a=Object.keys(e);t<a.length;)null!==e[a[t]]&&void 0!==e[a[t]]&&(i[a[t]]=e[a[t]]),t++;else i=e;return i},e.inArray=function(e,t){if(t)for(var i=0,a=t.length;i<a;i++)if(t[i]===e)return i;return-1},e.isContainCommonElements=function(e,t){for(var i=0,a=e.length;i<a;i++)for(var s=0,r=t.length;s<r;s++)if(t[s]===e[i])return!0;return!1},e.setPivotProperties=function(e,t){e.allowServerDataBinding=!1,e.pivotGridModule&&(e.pivotGridModule.allowServerDataBinding=!1),e.setProperties(t,!0),e.allowServerDataBinding=!0,e.pivotGridModule&&(e.pivotGridModule.allowServerDataBinding=!0)},e.getClonedDataSourceSettings=function(e){return this.getDefinedObj({type:e.type,catalog:e.catalog,cube:e.cube,providerType:e.providerType,url:e.url,localeIdentifier:e.localeIdentifier,excludeFields:sf.base.isNullOrUndefined(e.excludeFields)?[]:e.excludeFields.slice(),expandAll:e.expandAll,allowLabelFilter:e.allowLabelFilter,allowValueFilter:e.allowValueFilter,allowMemberFilter:e.allowMemberFilter,enableSorting:!!e.enableSorting,rows:this.cloneFieldSettings(e.rows),columns:this.cloneFieldSettings(e.columns),filters:this.cloneFieldSettings(e.filters),values:this.cloneFieldSettings(e.values),filterSettings:this.cloneFilterSettings(e.filterSettings),sortSettings:this.cloneSortSettings(e.sortSettings),drilledMembers:this.cloneDrillMemberSettings(e.drilledMembers),valueSortSettings:this.CloneValueSortObject(e.valueSortSettings),valueAxis:e.valueAxis,formatSettings:this.cloneFormatSettings(e.formatSettings),calculatedFieldSettings:this.cloneCalculatedFieldSettings(e.calculatedFieldSettings),fieldMapping:this.cloneFieldSettings(e.fieldMapping),showSubTotals:e.showSubTotals,showRowSubTotals:e.showRowSubTotals,showColumnSubTotals:e.showColumnSubTotals,showGrandTotals:e.showGrandTotals,showRowGrandTotals:e.showRowGrandTotals,showColumnGrandTotals:e.showColumnGrandTotals,showHeaderWhenEmpty:e.showHeaderWhenEmpty,alwaysShowValueHeader:e.alwaysShowValueHeader,conditionalFormatSettings:this.cloneConditionalFormattingSettings(e.conditionalFormatSettings),emptyCellsTextContent:e.emptyCellsTextContent,groupSettings:this.cloneGroupSettings(e.groupSettings),showAggregationOnValueField:e.showAggregationOnValueField,authentication:this.CloneAuthenticationObject(e.authentication)})},e.updateDataSourceSettings=function(e,t){e&&this.setPivotProperties(e,{dataSourceSettings:this.getDefinedObj({type:t.type,catalog:t.catalog,cube:t.cube,providerType:t.providerType,url:t.url,localeIdentifier:t.localeIdentifier,excludeFields:sf.base.isNullOrUndefined(t.excludeFields)?[]:t.excludeFields,expandAll:t.expandAll,allowLabelFilter:t.allowLabelFilter,allowValueFilter:t.allowValueFilter,allowMemberFilter:t.allowMemberFilter,enableSorting:!!t.enableSorting,rows:t.rows,columns:t.columns,filters:t.filters,values:t.values,filterSettings:t.filterSettings,sortSettings:t.sortSettings,drilledMembers:t.drilledMembers,valueSortSettings:t.valueSortSettings,valueAxis:t.valueAxis,formatSettings:t.formatSettings,calculatedFieldSettings:t.calculatedFieldSettings,fieldMapping:t.fieldMapping,showSubTotals:t.showSubTotals,showRowSubTotals:t.showRowSubTotals,showColumnSubTotals:t.showColumnSubTotals,showGrandTotals:t.showGrandTotals,showRowGrandTotals:t.showRowGrandTotals,showColumnGrandTotals:t.showColumnGrandTotals,showHeaderWhenEmpty:t.showHeaderWhenEmpty,alwaysShowValueHeader:t.alwaysShowValueHeader,conditionalFormatSettings:t.conditionalFormatSettings,emptyCellsTextContent:t.emptyCellsTextContent,groupSettings:t.groupSettings,showAggregationOnValueField:t.showAggregationOnValueField,authentication:this.CloneAuthenticationObject(t.authentication)})})},e.cloneFieldSettings=function(e){if(e){for(var t=[],i=0,a=e;i<a.length;i++){var s=a[i];t.push(this.getDefinedObj({name:s.name,caption:s.caption,axis:s.axis,baseField:s.baseField,baseItem:s.baseItem,isCalculatedField:s.isCalculatedField,isNamedSet:s.isNamedSet,showNoDataItems:s.showNoDataItems,showSubTotals:s.showSubTotals,type:s.type,dataType:s.dataType,showFilterIcon:s.showFilterIcon,showSortIcon:s.showSortIcon,showRemoveIcon:s.showRemoveIcon,showValueTypeIcon:s.showValueTypeIcon,showEditIcon:s.showEditIcon,allowDragAndDrop:s.allowDragAndDrop}))}return t}return e},e.cloneFilterSettings=function(e){if(e){for(var t=[],i=0,a=e;i<a.length;i++){var s=a[i];t.push(this.getDefinedObj({name:s.name,type:s.type,condition:s.condition,items:s.items?s.items.slice():s.items,levelCount:s.levelCount,measure:s.measure,selectedField:s.selectedField,showDateFilter:s.showDateFilter,showLabelFilter:s.showLabelFilter,showNumberFilter:s.showNumberFilter,value1:s.value1,value2:s.value2}))}return t}return e},e.cloneSortSettings=function(e){if(e){for(var t=[],i=0,a=e;i<a.length;i++){var s=a[i];t.push(this.getDefinedObj({name:s.name,order:s.order}))}return t}return e},e.cloneDrillMemberSettings=function(e){if(e){for(var t=[],i=0,a=e;i<a.length;i++){var s=a[i];t.push(this.getDefinedObj({name:s.name,delimiter:s.delimiter,items:s.items?s.items.slice():s.items}))}return t}return e},e.cloneFormatSettings=function(e){if(e){for(var t=[],i=0,a=e;i<a.length;i++){var s=a[i];t.push(this.getDefinedObj({name:s.name,calendar:s.calendar,currency:s.currency,format:s.format,maximumFractionDigits:s.maximumFractionDigits,maximumSignificantDigits:s.maximumSignificantDigits,minimumFractionDigits:s.minimumFractionDigits,minimumIntegerDigits:s.minimumIntegerDigits,minimumSignificantDigits:s.minimumSignificantDigits,skeleton:s.skeleton,type:s.type,useGrouping:s.useGrouping}))}return t}return e},e.CloneValueSortObject=function(e){return e?{columnIndex:e.columnIndex,headerDelimiter:e.headerDelimiter,headerText:e.headerText,measure:e.measure,sortOrder:e.sortOrder}:e},e.CloneAuthenticationObject=function(e){return e?{userName:e.userName,password:e.password}:e},e.cloneCalculatedFieldSettings=function(e){if(e){for(var t=[],i=0,a=e;i<a.length;i++){var s=a[i];t.push(this.getDefinedObj({name:s.name,formatString:s.formatString,formula:s.formula,hierarchyUniqueName:s.hierarchyUniqueName}))}return t}return e},e.cloneConditionalFormattingSettings=function(e){if(e){for(var t=[],i=0,a=e;i<a.length;i++){var s=a[i];t.push(this.getDefinedObj({applyGrandTotals:s.applyGrandTotals,conditions:s.conditions,label:s.label,measure:s.measure,style:s.style?{backgroundColor:s.style.backgroundColor,color:s.style.color,fontFamily:s.style.fontFamily,fontSize:s.style.fontSize}:s.style,value1:s.value1,value2:s.value2}))}return t}return e},e.cloneGroupSettings=function(e){if(e){for(var t=[],i=0,a=e;i<a.length;i++){var s=a[i];t.push(this.getDefinedObj({name:s.name,caption:s.caption,customGroups:this.cloneCustomGroups(s.customGroups),endingAt:s.endingAt,startingAt:s.startingAt,groupInterval:s.groupInterval,rangeInterval:s.rangeInterval,type:s.type}))}return t}return e},e.cloneCustomGroups=function(e){if(e){for(var t=[],i=0,a=e;i<a.length;i++){var s=a[i];t.push(this.getDefinedObj({groupName:s.groupName,items:s.items?s.items.slice():s.items}))}return t}return e},e.getFilterItemByName=function(e,t){var i=new sf.data.DataManager({json:t}).executeLocal((new sf.data.Query).where("name","equal",e));if(i&&i.length>0)return i[i.length-1]},e.getFieldByName=function(e,t){return new sf.data.DataManager({json:t}).executeLocal((new sf.data.Query).where("name","equal",e))[0]},e.getFieldInfo=function(e,t){for(var i=[this.cloneFieldSettings(t.dataSourceSettings.rows),this.cloneFieldSettings(t.dataSourceSettings.columns),this.cloneFieldSettings(t.dataSourceSettings.values),this.cloneFieldSettings(t.dataSourceSettings.filters)],a=0,s=i.length;a<s;a++)for(var r=0,n=i[a]?i[a].length:0;r<n;r++)if(i[a][r]&&i[a][r].name===e)return{fieldName:e,fieldItem:i[a][r],axis:0===a?"rows":1===a?"columns":2===a?"values":"filters",position:r};var o="olap"===t.dataType?t.olapEngineModule.fieldList[e]:t.engineModule.fieldList[e];return{fieldName:e,fieldItem:o?{name:e,caption:o.caption,baseField:o.baseField,baseItem:o.baseItem,isCalculatedField:o.isCalculatedField,isNamedSet:o.isNamedSets,showNoDataItems:o.showNoDataItems,showSubTotals:o.showSubTotals,type:o.aggregateType,showFilterIcon:o.showFilterIcon,showSortIcon:o.showSortIcon,showRemoveIcon:o.showRemoveIcon,showValueTypeIcon:o.showValueTypeIcon,showEditIcon:o.showEditIcon,allowDragAndDrop:o.allowDragAndDrop}:void 0,axis:"fieldlist",position:-1}},e.isButtonIconRefesh=function(e,t,i){var a=!1;try{if("dataSourceSettings"===e&&t.dataSourceSettings&&i.dataSourceSettings){var s=["notAvail","notAvail","notAvail","notAvail"],r=Object.keys(t.dataSourceSettings),n=Object.keys(i.dataSourceSettings);if(r&&n&&n.length>0&&r.length===n.length)for(var o=["rows","columns","values","filters"],l=0;l<n.length;l++){var d=n[l]in t.dataSourceSettings&&!sf.base.isNullOrUndefined(t.dataSourceSettings[n[l]])?Object.keys(t.dataSourceSettings[n[l]]):[],p=n[l]in i.dataSourceSettings&&!sf.base.isNullOrUndefined(i.dataSourceSettings[n[l]])?Object.keys(i.dataSourceSettings[n[l]]):[];if(-1!==o.indexOf(n[l])&&-1!==o.indexOf(r[l])&&d&&p&&p.length>0&&d.length===p.length)for(var h=["showFilterIcon","showSortIcon","showRemoveIcon","showValueTypeIcon","showEditIcon","allowDragAndDrop"],u=0;u<p.length;u++){for(var c=Object.keys(t.dataSourceSettings[n[l]][p[u]]),g=Object.keys(i.dataSourceSettings[n[l]][p[u]]),f=0;f<g.length;f++){if(-1===h.indexOf(g[f])||-1===h.indexOf(c[f])){s[l]="break";break}s[l]="update"}if("break"===s[l])break}else s[l]="break";if("break"===s[l])break}for(var m=0,v=0,b=0,S=0,y=s;S<y.length;S++){var C=y[S];"break"===C&&m++,"notAvail"===C&&v++,"update"===C&&b++}a=!(m>0||4===v)&&(0===m&&v<4&&b>0)}}catch(e){a=!1}return a},e.formatPivotValues=function(e){for(var t=[],i=0;i<e.length;i++)if(e[i]){t[i]=[];for(var a=0;a<e[i].length;a++)e[i][a]&&(t[i][a]={axis:e[i][a].Axis,actualText:e[i][a].ActualText,indexObject:e[i][a].IndexObject,index:e[i][a].Index,rowHeaders:e[i][a].RowHeaders,columnHeaders:e[i][a].ColumnHeaders,formattedText:e[i][a].FormattedText,actualValue:e[i][a].ActualValue,rowIndex:e[i][a].RowIndex,colIndex:e[i][a].ColIndex,colSpan:e[i][a].ColSpan,level:e[i][a].Level,rowSpan:e[i][a].RowSpan,isSum:e[i][a].IsSum,isGrandSum:e[i][a].IsGrandSum,valueSort:e[i][a].ValueSort,ordinal:e[i][a].Ordinal,hasChild:e[i][a].HasChild,isDrilled:e[i][a].IsDrilled,value:e[i][a].Value,type:e[i][a].Type,members:e[i][a].Members})}return t},e.formatPdfHeaderFooter=function(e){var t=[];if(!sf.base.isNullOrUndefined(e))for(var i=0;i<e.length;i++){var a=e[i],s={type:a.Type,pageNumberType:a.PageNumberType,style:a.Style?{penColor:a.Style.PenColor,penSize:a.Style.PenSize,dashStyle:a.Style.DashStyle,textBrushColor:a.Style.TextBrushColor,textPenColor:a.Style.TextPenColor,fontSize:a.Style.FontSize,hAlign:a.Style.HAlign,vAlign:a.Style.VAlign}:a.Style,points:null!==a.Points?{x1:a.Points.X1,y1:a.Points.Y1,x2:a.Points.X2,y2:a.Points.Y2}:null,format:a.Format,position:null!==a.Position?{x:a.Position.X,y:a.Position.Y}:null,size:null!==a.Size?{height:a.Size.Height,width:a.Size.Width}:null,src:a.Src,value:a.Value,font:a.Font};t.push(s)}return t},e.formatPdfExportProperties=function(e){return this.getDefinedObj({pageOrientation:"string"==typeof e.PageOrientation?e.PageOrientation:null,pageSize:"string"==typeof e.PageSize?e.PageSize:null,header:sf.base.isNullOrUndefined(e.Header)?null:{fromTop:e.Header.FromTop,height:e.Header.Height,contents:this.formatPdfHeaderFooter(e.Header.Contents)},columns:e.Columns,footer:sf.base.isNullOrUndefined(e.Footer)?null:{fromTop:e.Footer.FromBottom,height:e.Footer.Height,contents:this.formatPdfHeaderFooter(e.Footer.Contents)},includeHiddenColumn:e.IncludeHiddenColumn,dataSource:e.DataSource,exportType:"string"==typeof e.ExportType?e.ExportType:null,theme:sf.base.isNullOrUndefined(e.Theme)?null:{header:e.Theme.Header,record:e.Theme.Record,caption:e.Theme.Caption},fileName:e.FileName,hierarchyExportMode:"string"==typeof e.HierarchyExportMode?e.HierarchyExportMode:null,allowHorizontalOverflow:e.AllowHorizontalOverflow})},e.formatExcelStyle=function(e){var t;return sf.base.isNullOrUndefined(e)||(t=this.getDefinedObj({fontColor:e.FontColor,fontName:e.FontName,fontSize:e.FontSize,hAlign:e.HAlign===String?e.HAlign:null,vAlign:e.VAlign===String?e.VAlign:null,bold:e.Bold,indent:e.Indent,italic:e.Italic,underline:e.Underline,backColor:e.BackColor,wrapText:e.WrapText,borders:e.Borders,numberFormat:e.NumberFormat,type:e.Type})),t},e.formatExcelCell=function(e){if(!sf.base.isNullOrUndefined(e))for(var t=0;t<e.length;t++)this.getDefinedObj({index:sf.base.isNullOrUndefined(e[t].Index)?null:e[t].Index,colSpan:sf.base.isNullOrUndefined(e[t].ColSpan)?null:e[t].ColSpan,value:sf.base.isNullOrUndefined(e[t].Value)?null:e[t].Value,hyperlink:{target:sf.base.isNullOrUndefined(e[t].Hyperlink)?null:e[t].Hyperlink.Target,displayText:sf.base.isNullOrUndefined(e[t].Hyperlink)?null:e[t].Hyperlink.DisplayText},styles:this.formatExcelStyle(e[t].Style),rowSpan:sf.base.isNullOrUndefined(e[t].RowSpan)?null:e[t].RowSpan});return[]},e.formatExcelHeaderFooter=function(e){var t=[];if(!sf.base.isNullOrUndefined(e))for(var i=0;i<e.Rows.length;i++){var a=e.Rows[i],s=this.getDefinedObj({index:sf.base.isNullOrUndefined(a.Index)?null:a.Index,cells:this.formatExcelCell(a.Cells),grouping:sf.base.isNullOrUndefined(a.Grouping)?null:a.Grouping});t.push(s)}return t},e.formatExcelExportProperties=function(e){return this.getDefinedObj({dataSource:e.DataSource,query:e.Query,multipleExport:this.getDefinedObj({type:sf.base.isNullOrUndefined(e.MultipleExport)?null:e.MultipleExport.Type,blankRows:sf.base.isNullOrUndefined(e.MultipleExport)?null:e.MultipleExport.BlankRows}),header:this.getDefinedObj({headerRows:sf.base.isNullOrUndefined(e.Header)?null:e.Header.HeaderRows,rows:this.formatExcelHeaderFooter(e.Header)}),footer:this.getDefinedObj({footerRows:sf.base.isNullOrUndefined(e.Footer)?null:e.Footer.FooterRows,rows:this.formatExcelHeaderFooter(e.Footer)}),columns:e.Columns,exportType:"string"==typeof e.ExportType?e.ExportType:void 0,includeHiddenColumn:e.IncludeHiddenColumn,theme:sf.base.isNullOrUndefined(e.Theme)?void 0:{header:this.formatExcelStyle(e.Theme.Header),record:this.formatExcelStyle(e.Theme.Record),caption:this.formatExcelStyle(e.Theme.Caption)},fileName:e.FileName,hierarchyExportMode:"string"==typeof e.HierarchyExportMode?e.HierarchyExportMode:void 0})},e.formatFieldList=function(e){for(var t=Object.keys(e),i={},a=0;a<t.length;a++)e[t[a]]&&(i[t[a]]={id:e[t[a]].Id,caption:e[t[a]].Caption,type:e[t[a]].Type,formatString:e[t[a]].FormatString,index:e[t[a]].Index,members:e[t[a]].Members,formattedMembers:e[t[a]].FormattedMembers,dateMember:e[t[a]].DateMember,filter:e[t[a]].Filter,sort:e[t[a]].Sort,aggregateType:e[t[a]].AggregateType,baseField:e[t[a]].BaseField,baseItem:e[t[a]].BaseItem,filterType:e[t[a]].FilterType,format:e[t[a]].Format,formula:e[t[a]].Formula,isSelected:e[t[a]].IsSelected,isExcelFilter:e[t[a]].IsExcelFilter,showNoDataItems:e[t[a]].ShowNoDataItems,isCustomField:e[t[a]].IsCustomField,showFilterIcon:e[t[a]].ShowFilterIcon,showSortIcon:e[t[a]].ShowSortIcon,showRemoveIcon:e[t[a]].ShowRemoveIcon,showEditIcon:e[t[a]].ShowEditIcon,showValueTypeIcon:e[t[a]].ShowValueTypeIcon,allowDragAndDrop:e[t[a]].AllowDragAndDrop,isCalculatedField:e[t[a]].IsCalculatedField,showSubTotals:e[t[a]].ShowSubTotals});return i},e.frameContent=function(e,t,i,a){var s=[],r=a;if(r.dataSourceSettings.values.length>0&&!r.engineModule.isEmptyData&&(r.enableValueSorting||!r.engineModule.isEngineUpdated))for(var n=0,o="value"===t?i:0,l="value"===t?e.length:i,d=o;d<l;d++)if(e[d]){s[n="header"===t?d:n]={};for(var p=0;p<e[d].length;p++)e[d][p]&&(s[n][p]=e[d][p]);n++}return s},e.getLocalizedObject=function(e){var t=new Object;return t.Null=e.localeObj.getConstant("null"),t.Years=e.localeObj.getConstant("Years"),t.Quarters=e.localeObj.getConstant("Quarters"),t.Months=e.localeObj.getConstant("Months"),t.Days=e.localeObj.getConstant("Days"),t.Hours=e.localeObj.getConstant("Hours"),t.Minutes=e.localeObj.getConstant("Minutes"),t.Seconds=e.localeObj.getConstant("Seconds"),t.QuarterYear=e.localeObj.getConstant("QuarterYear"),t.Of=e.localeObj.getConstant("of"),t.Qtr=e.localeObj.getConstant("qtr"),t.Undefined=e.localeObj.getConstant("undefined"),t.GroupOutOfRange=e.localeObj.getConstant("groupOutOfRange"),t.Group=e.localeObj.getConstant("group"),t},e.updateReport=function(e,t){e.setProperties({dataSourceSettings:{rows:[]}},!0),e.setProperties({dataSourceSettings:{columns:[]}},!0),e.setProperties({dataSourceSettings:{formatSettings:[]}},!0);for(var i=0;i<t.Rows.length;i++)e.dataSourceSettings.rows.push({name:t.Rows[i].Name,caption:t.Rows[i].Caption,showNoDataItems:t.Rows[i].ShowNoDataItems,baseField:t.Rows[i].BaseField,baseItem:t.Rows[i].BaseItem,showFilterIcon:t.Rows[i].ShowFilterIcon,showSortIcon:t.Rows[i].ShowSortIcon,showEditIcon:t.Rows[i].ShowEditIcon,showRemoveIcon:t.Rows[i].ShowRemoveIcon,showSubTotals:t.Rows[i].ShowValueTypeIcon,allowDragAndDrop:t.Rows[i].AllowDragAndDrop,axis:t.Rows[i].Axis,dataType:t.Rows[i].DataType,isCalculatedField:t.Rows[i].IsCalculatedField,showValueTypeIcon:t.Rows[i].ShowValueTypeIcon,type:t.Rows[i].Type});for(i=0;i<t.Columns.length;i++)e.dataSourceSettings.columns.push({name:t.Columns[i].Name,caption:t.Columns[i].Caption,showNoDataItems:t.Columns[i].ShowNoDataItems,baseField:t.Columns[i].BaseField,baseItem:t.Columns[i].BaseItem,showFilterIcon:t.Columns[i].ShowFilterIcon,showSortIcon:t.Columns[i].ShowSortIcon,showEditIcon:t.Columns[i].ShowEditIcon,showRemoveIcon:t.Columns[i].ShowRemoveIcon,showSubTotals:t.Columns[i].ShowValueTypeIcon,allowDragAndDrop:t.Columns[i].AllowDragAndDrop,axis:t.Columns[i].Axis,dataType:t.Columns[i].DataType,isCalculatedField:t.Columns[i].IsCalculatedField,showValueTypeIcon:t.Columns[i].ShowValueTypeIcon,type:t.Columns[i].Type});for(i=0;i<t.FormatSettings.length;i++)e.dataSourceSettings.formatSettings.push({name:t.FormatSettings[i].Name,format:t.FormatSettings[i].Format,type:t.FormatSettings[i].Type,currency:t.FormatSettings[i].Currency,maximumFractionDigits:t.FormatSettings[i].MaximumFractionDigits,maximumSignificantDigits:t.FormatSettings[i].MaximumSignificantDigits,minimumFractionDigits:t.FormatSettings[i].MinimumFractionDigits,minimumIntegerDigits:t.FormatSettings[i].MinimumIntegerDigits,minimumSignificantDigits:t.FormatSettings[i].MinimumSignificantDigits,skeleton:t.FormatSettings[i].Skeleton,useGrouping:t.FormatSettings[i].UseGrouping})},e.generateUUID=function(){var e=(new Date).getTime(),t=performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(i){var a=16*Math.random();return e>0?(a=(e+a)%16|0,e=Math.floor(e/16)):(a=(t+a)%16|0,t=Math.floor(t/16)),("x"===i?a:3&a|8).toString(16)}))},e}(),n=function(){return(n=Object.assign||function(e){for(var t,i=1,a=arguments.length;i<a;i++)for(var s in t=arguments[i])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},o=function(){function e(){this.aggregatedValueMatrix=[],this.valueContent=[],this.formatFields={},this.dateFormatFunction={},this.calculatedFields={},this.calculatedFormulas={},this.valueAxis=0,this.saveDataHeaders={},this.columnCount=0,this.rowCount=0,this.colFirstLvl=0,this.rowFirstLvl=0,this.rowStartPos=0,this.colStartPos=0,this.enableValueSorting=!1,this.headerCollection={rowHeaders:[],columnHeaders:[],rowHeadersCount:0,columnHeadersCount:0},this.rMembers=[],this.cMembers=[],this.groupingFields={},this.valueMatrix=[],this.indexMatrix=[],this.memberCnt=-1,this.pageInLimit=!1,this.endPos=0,this.removeCount=0,this.colHdrBufferCalculated=!1,this.colValuesLength=1,this.rowValuesLength=1,this.slicedHeaders=[],this.fieldFilterMem={},this.filterPosObj={},this.selectedHeaders={selectedHeader:[],values:[]},this.rowGrandTotal=null,this.columnGrandTotal=null,this.removeRowGrandTotal=!1,this.removeColumnGrandTotal=!1,this.isValueHasAdvancedAggregate=!1,this.rawIndexObject={},this.isEditing=!1,this.data=[],this.actualData=[],this.groupRawIndex={},this.fieldKeys={},this.allowDataCompression=!1,this.dataSourceSettings={},this.frameHeaderObjectsCollection=!1,this.headerObjectsCollection={},this.columnKeys={},this.fieldDrillCollection={},this.fieldMapping=[],this.customRegex=/^(('[^']+'|''|[^*#@0,.])*)(\*.)?((([0#,]*[0,]*[0#]*)(\.[0#]*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@0,.E])*)$/,this.formatRegex=/(^[ncpae]{1})([0-1]?[0-9]|20)?$/i}return e.prototype.renderEngine=function(e,t,i){var a;if(this.getValueCellInfo=i,this.formatFields={},this.dateFormatFunction={},this.calculatedFields={},this.calculatedFormulas={},this.valueAxis=0,this.saveDataHeaders={},this.columnCount=0,this.rowCount=0,this.colFirstLvl=0,this.rowFirstLvl=0,this.rowStartPos=0,this.colStartPos=0,this.excludeFields=sf.base.isNullOrUndefined(e.excludeFields)?[]:e.excludeFields,this.enableValueSorting=!1,this.headerCollection={rowHeaders:[],columnHeaders:[],rowHeadersCount:0,columnHeadersCount:0},this.valueMatrix=[],this.indexMatrix=[],this.aggregatedValueMatrix=[],this.rMembers=[],this.cMembers=[],this.memberCnt=-1,this.pageInLimit=!1,this.endPos=0,this.removeCount=0,this.colHdrBufferCalculated=!1,this.colValuesLength=1,this.rowValuesLength=1,this.slicedHeaders=[],this.fieldFilterMem={},this.filterPosObj={},this.selectedHeaders={selectedHeader:[],values:[]},this.rowGrandTotal=null,this.columnGrandTotal=null,this.removeRowGrandTotal=!1,this.removeColumnGrandTotal=!1,this.isValueHasAdvancedAggregate=!1,this.rawIndexObject={},this.isEditing=!1,this.globalize=new sf.base.Internationalization,this.localeObj=t?t.localeObj:void 0,this.fieldsType=t?t.fieldsType:{},this.clonedReport=t?t.clonedReport:{},this.enableSort=e.enableSorting,this.alwaysShowValueHeader=e.alwaysShowValueHeader,this.showHeaderWhenEmpty=!!sf.base.isNullOrUndefined(e.showHeaderWhenEmpty)||e.showHeaderWhenEmpty,this.showSubTotals=!!sf.base.isNullOrUndefined(e.showSubTotals)||e.showSubTotals,this.showRowSubTotals=!!sf.base.isNullOrUndefined(e.showRowSubTotals)||e.showRowSubTotals,this.showColumnSubTotals=!!sf.base.isNullOrUndefined(e.showColumnSubTotals)||e.showColumnSubTotals,this.showGrandTotals=!!sf.base.isNullOrUndefined(e.showGrandTotals)||e.showGrandTotals,this.showRowGrandTotals=!!sf.base.isNullOrUndefined(e.showRowGrandTotals)||e.showRowGrandTotals,this.showColumnGrandTotals=!!sf.base.isNullOrUndefined(e.showColumnGrandTotals)||e.showColumnGrandTotals,this.allowValueFilter=e.allowValueFilter,this.isValueFilterEnabled=!1,this.enableValueSorting=!!t&&t.enableValueSorting,this.isDrillThrough=!!t&&(!!t.isDrillThrough&&t.isDrillThrough),this.valueContent=[],this.dataSourceSettings=e,e.dataSource instanceof sf.data.DataManager||(this.data=sf.base.isBlazor()&&!e.dataSource&&this.data&&this.data.length>0?this.data:e.dataSource),this.data&&this.data[0]){if(!this.fieldList){"CSV"===e.type?this.fields=this.data.shift():this.fields=Object.keys(this.data[0]);for(var s=0;s<this.fields.length;s++)this.fieldKeys[this.fields[s]]="CSV"===e.type?s:this.fields[s]}t&&t.pageSettings&&t.pageSettings.allowDataCompression&&(this.actualData=this.data,this.data=this.getGroupedRawData(e)),this.rows=e.rows?e.rows:[],this.columns=e.columns?e.columns:[],this.filters=e.filters?e.filters:[],this.values=e.values?e.values:[],this.formats=e.formatSettings?e.formatSettings:[],this.groups=e.groupSettings?e.groupSettings:[],this.calculatedFieldSettings=e.calculatedFieldSettings?e.calculatedFieldSettings:[],this.enableSort=void 0===e.enableSorting||e.enableSorting,this.fieldMapping=e.fieldMapping?e.fieldMapping:[],a=this.getGroupData(this.data);for(s=0;s<this.fields.length;s++)this.fieldKeys[this.fields[s]]="CSV"===e.type?s:this.fields[s];this.validateFilters(e),this.isExpandAll=!(!this.isValueFiltersAvail||!e.allowValueFilter)||e.expandAll,this.drilledMembers=e.drilledMembers?this.isValueFiltersAvail&&e.allowValueFilter?[]:e.drilledMembers:[],this.isMutiMeasures=this.values.length>1,this.valueAxis="row"===e.valueAxis?1:0,this.emptyCellTextContent=e.emptyCellsTextContent?e.emptyCellsTextContent:"",this.rowValuesLength=1===this.valueAxis?this.values.length:1,this.colValuesLength=0===this.valueAxis?this.values.length:1,this.valueSortSettings=e.valueSortSettings||{sortOrder:"None",headerDelimiter:".",headerText:"",columnIndex:void 0},this.valueSortData=[],this.pageSettings=t?t.pageSettings?t.pageSettings:this.pageSettings:void 0,this.allowDataCompression=this.pageSettings&&this.pageSettings.allowDataCompression,this.savedFieldList=t?t.savedFieldList:void 0,this.getFieldList(a,this.enableSort,e.allowValueFilter),this.removeIrrelevantFields(e,Object.keys(this.fieldList)),this.fillFieldMembers(this.data,this.indexMatrix),this.updateSortSettings(e.sortSettings,this.enableSort),this.valueMatrix=this.generateValueMatrix(this.data),this.filterMembers=[];var r=this.columns.length-1;for(this.columnKeys={};r>-1;)this.columnKeys[this.columns[r].name]=this.columns[r],r--;this.updateFilterMembers(e),this.generateGridData(e)}},e.prototype.removeIrrelevantFields=function(e,t){var i={};i[0]=e.rows,i[1]=e.columns,i[2]=e.values,i[3]=e.filters;for(var a=0;a<4;){if(i[a])for(var s=0;s<i[a].length;s++)(this.excludeFields.indexOf(i[a][s].name)>-1||!sf.base.isNullOrUndefined(t)&&-1===t.indexOf(i[a][s].name))&&(i[a].splice(s,1),s--);a++}},e.prototype.getGroupedRawData=function(e){this.data=[];for(var t=0,i=this.actualData;t<i.length;t++){var a=i[t];this.data[this.data.length]=this.frameHeaderWithKeys(a)}var s=e.values.filter((function(e){return"Count"===e.type||"DistinctCount"===e.type})).map((function(e){return e.name})),r=s.length>0,n=this.data,o=e.rows.concat(e.columns.concat(e.filters)).map((function(e){return e.name})),l={},d=[];this.groupRawIndex={};for(var p={},h=0,u=0;u<n.length;u++){var c=n[u],g=[];if(r)for(var f=0;f<s.length;f++)c[this.fieldKeys[s[f]]]=sf.base.isNullOrUndefined(c[this.fieldKeys[s[f]]])?c[this.fieldKeys[s[f]]]:1;for(var m=0;m<o.length;m++)g.push(c[this.fieldKeys[o[m]]]);var v=g.join("-");if(l[v]){for(f=0;f<e.values.length;f++){var b=e.values[f].name,S=c[this.fieldKeys[b]],y=l[v],C=e.values[f].type;sf.base.isNullOrUndefined(S)||("number"==typeof S&&"DistinctCount"!==C||(C="Count"),sf.base.isNullOrUndefined(y[b])?y[b]="Product"===C?1:"Min"===C||"Max"===C?void 0:0:"number"!=typeof y[b]&&(y[b]=1),"Count"===C?y[b]+=1:"Min"===C?sf.base.isNullOrUndefined(y[b])||(y[b]=y[b]>S?S:y[b]):"Max"===C?sf.base.isNullOrUndefined(y[b])||(y[b]=y[b]<S?S:y[b]):"Product"===C?y[b]*=S:y[b]+=S)}this.isDrillThrough&&this.groupRawIndex[p[v]].push(u)}else l[v]=c,d.push(c),this.isDrillThrough&&(this.groupRawIndex[h]=[u],p[v]=h,h++)}return d},e.prototype.getGroupData=function(e){for(var t=this,i=e[0],s=function(a){var s=a.name,o=a.caption;if(!(n.fields.indexOf(s)>-1))return{value:i};var l={},d=void 0;if("Date"===a.type&&n.groupingFields[s])return{value:i};if("Number"===a.type){if("number"!==r.getType(i[s])&&n.groupingFields[s])return{value:i};a.rangeInterval&&e.sort((function(e,i){return Number(e[t.fieldKeys[s]])>Number(i[t.fieldKeys[s]])?1:Number(i[t.fieldKeys[s]])>Number(e[t.fieldKeys[s]])?-1:0}))}else if("Custom"===a.type&&n.fields.indexOf(s+"_custom_group")>-1)return{value:i};for(var p=e.length;p--;){var h=e[p];if(h[n.fieldKeys[s]]&&"Date"===a.type){var u=new Date(h[n.fieldKeys[s]].toString());if(!sf.base.isNullOrUndefined(u)&&a.groupInterval.length>0)for(var c=0,g=a.groupInterval.length;c<g;c++){var f=a.groupInterval[c],m=n.getRange(a,u.getTime()),v=r.resetTime(new Date);switch(f){case"Years":l[S=c===a.groupInterval.length-1?s:s+"_date_group_years"]=f,n.fieldKeys[S]="CSV"===n.dataSourceSettings.type?n.fieldKeys[S]?n.fieldKeys[S]:n.fields.length:S,-1===n.fields.indexOf(S)&&n.fields.push(S),h[n.fieldKeys[S]]=m?void 0:new Date(v.setFullYear(u.getFullYear())).toString();break;case"Quarters":l[S=c===a.groupInterval.length-1?s:s+"_date_group_quarters"]=f;var b=Math.ceil((u.getMonth()+1)/3);n.fieldKeys[S]="CSV"===n.dataSourceSettings.type?n.fieldKeys[S]?n.fieldKeys[S]:n.fields.length:S,-1===n.fields.indexOf(S)&&n.fields.push(S),h[n.fieldKeys[S]]=m?void 0:(n.localeObj?n.localeObj.getConstant("qtr"):"Qtr")+b.toString();break;case"QuarterYear":l[S=c===a.groupInterval.length-1?s:s+"_date_group_quarterYear"]=f;b=Math.ceil((u.getMonth()+1)/3);n.fieldKeys[S]="CSV"===n.dataSourceSettings.type?n.fieldKeys[S]?n.fieldKeys[S]:n.fields.length:S,-1===n.fields.indexOf(S)&&n.fields.push(S),h[n.fieldKeys[S]]=m?void 0:(n.localeObj?n.localeObj.getConstant("qtr"):"Qtr")+b.toString()+" "+(n.localeObj?n.localeObj.getConstant("of"):"of")+" "+u.getFullYear().toString();break;case"Months":l[S=c===a.groupInterval.length-1?s:s+"_date_group_months"]=f,n.fieldKeys[S]="CSV"===n.dataSourceSettings.type?n.fieldKeys[S]?n.fieldKeys[S]:n.fields.length:S,-1===n.fields.indexOf(S)&&n.fields.push(S),h[n.fieldKeys[S]]=m?void 0:new Date(v.setMonth(u.getMonth(),v.getDate())).toString();break;case"Days":l[S=c===a.groupInterval.length-1?s:s+"_date_group_days"]=f,n.fieldKeys[S]="CSV"===n.dataSourceSettings.type?n.fieldKeys[S]?n.fieldKeys[S]:n.fields.length:S,-1===n.fields.indexOf(S)&&n.fields.push(S),h[n.fieldKeys[S]]=m?void 0:new Date(v.setMonth(u.getMonth(),u.getDate())).toString();break;case"Hours":l[S=c===a.groupInterval.length-1?s:s+"_date_group_hours"]=f,n.fieldKeys[S]="CSV"===n.dataSourceSettings.type?n.fieldKeys[S]?n.fieldKeys[S]:n.fields.length:S,-1===n.fields.indexOf(S)&&n.fields.push(S),h[n.fieldKeys[S]]=m?void 0:new Date(v.setHours(u.getHours())).toString();break;case"Minutes":l[S=c===a.groupInterval.length-1?s:s+"_date_group_minutes"]=f,n.fieldKeys[S]="CSV"===n.dataSourceSettings.type?n.fieldKeys[S]?n.fieldKeys[S]:n.fields.length:S,-1===n.fields.indexOf(S)&&n.fields.push(S),h[n.fieldKeys[S]]=m?void 0:new Date(v.setMinutes(u.getMinutes())).toString();break;case"Seconds":l[S=c===a.groupInterval.length-1?s:s+"_date_group_seconds"]=f,n.fieldKeys[S]="CSV"===n.dataSourceSettings.type?n.fieldKeys[S]?n.fieldKeys[S]:n.fields.length:S,-1===n.fields.indexOf(S)&&n.fields.push(S),h[n.fieldKeys[S]]=m?void 0:new Date(v.setSeconds(u.getSeconds())).toString()}}}else if(h[n.fieldKeys[s]]&&"Number"===a.type){m=n.getRange(a,Number(h[n.fieldKeys[s]]));h[n.fieldKeys[s]]=m?void 0:h[n.fieldKeys[s]]}else if(h[n.fieldKeys[s]]&&"Custom"===a.type&&a.customGroups&&a.customGroups.length>0)for(var S=s+"_custom_group",y=a.customGroups,C=void 0,w=(c=0,y.length);c<w;c++){var x=y[c];if(x.items&&x.items.length>1){d=S,n.fieldKeys[S]="CSV"===n.dataSourceSettings.type?n.fieldKeys[S]?n.fieldKeys[S]:n.fields.length:S,-1===n.fields.indexOf(S)&&n.fields.push(S);var T=-1!==r.inArray(h[n.fieldKeys[s]].toString(),x.items);h[n.fieldKeys[S]]=T?x.groupName&&""!==x.groupName?x.groupName:n.localeObj.getConstant("group")+" "+c:C&&C!==h[n.fieldKeys[s]].toString()?C:h[n.fieldKeys[s]].toString(),C=h[n.fieldKeys[S]]}}for(var M=[],D=0,E=ie=Object.keys(h);D<E.length;D++){var O=E[D];M.push(!!h[O])}i=-1===M.indexOf(!1)&&ie.length===Object.keys(e[0]).length?h:i}if("Date"===a.type){for(var P=!1,N=[n.rows,n.columns,n.values,n.filters],F=Object.keys(l),I=Object.keys(F).length,L=void 0,A=0,R=N;A<R.length;A++){var k=R[A];if(!P&&k){var j=k.length;for(c=0;c<j;){if(k[c].name===s){P=!0;var q=k[c];for(k.splice(c,1),pe=(pe=n.rows).concat(n.columns,n.values,n.filters);I--;){var V=q.caption?q.caption:q.name;if(n.clonedReport){var B=n.clonedReport.rows;B=B.concat(n.clonedReport.columns,n.clonedReport.values,n.clonedReport.filters);var _=r.getFieldByName(F[I],B);_&&(V=_.caption?_.caption:_.name)}if(!r.getFieldByName(F[I],pe)){L=l[F[I]];var H={name:F[I],caption:(n.localeObj?n.localeObj.getConstant(L):L)+" ("+V+")",type:"Count",showNoDataItems:q.showNoDataItems,baseField:q.baseField,baseItem:q.baseItem,showFilterIcon:q.showFilterIcon,showSortIcon:q.showSortIcon,showEditIcon:q.showEditIcon,showRemoveIcon:q.showRemoveIcon,showSubTotals:q.showValueTypeIcon,allowDragAndDrop:q.allowDragAndDrop};k.splice(c,0,H)}}break}c++}if(P)break}}for(I=Object.keys(F).length;I--;){L=l[F[I]];c=0;for(var U=n.formats.length;c<U;c++)if(n.formats[c].name===F[I]){n.formats.splice(c,1);break}if("Quarters"!==L&&"QuarterYear"!==L){var G={name:F[I],type:["Years","Months","Days"].indexOf(L)>-1?"date":"time",format:"Years"===L?"yyyy":"Months"===L?"MMM":"Days"===L?"d-MMM":"Hours"===L?"hh a":"Minutes"===L?":mm":"Seconds"===L?":ss":void 0};n.formats.push(G)}}}else if("Number"===a.type&&a.rangeInterval){var z=void 0,W=void 0,Q=void 0,Y=void 0,K=[],J=[],X=e.length;j=0;for(n.groupingFields[s]=s;j<X;)J.push(Number(e[j][n.fieldKeys[s]])),e[j][n.fieldKeys[s]]&&-1===K.indexOf(Number(e[j][n.fieldKeys[s]]))&&K.push(Number(e[j][n.fieldKeys[s]])),j++;for(var Z=Math.max.apply(Math,K),$=(c=K[0],Z);c<$;c++)if(J.indexOf(c)<0){var ee=n.frameData(e[0]);ee[n.fieldKeys[s]]=c;var te=J.lastIndexOf(c-1);J.splice(te+1,0,c),e.splice(te+1,0,ee)}for(X=e.length,j=0;j<X;){if(e[j]&&e[j][n.fieldKeys[s]]){Y=(Q=Number(e[j][n.fieldKeys[s]]))+(a.rangeInterval-1),W=W?W>Z?Z:W:Y>Z?Z:Y,Q>=(z=z||Q)&&Q<=W?e[j][n.fieldKeys[s]]=z===W?z.toString():z.toString()+"-"+W.toString():Q>W&&Q===W+1&&(W=(z=W+1)+(a.rangeInterval-1)>Z?Z:z+(a.rangeInterval-1),e[j][n.fieldKeys[s]]=z===W?z.toString():z.toString()+"-"+W.toString());M=[];for(var ie,ae=0,se=ie=Object.keys(e[j]);ae<se.length;ae++){O=se[ae];M.push(!!e[j][O])}i=-1===M.indexOf(!1)&&ie.length===Object.keys(e[0]).length?e[j]:i}j++}for(var re=0,ne=N=[n.rows,n.columns,n.values,n.filters];re<ne.length;re++){var oe=ne[re],le=r.getFieldByName(s,oe);le&&((le=le.properties?le.properties:le).type="Count")}c=0;for(var de=n.formats.length;c<de;c++)if(n.formats[c].name===s){n.formats.splice(c,1);break}}else if("Custom"===a.type&&d){var pe,he=d;P=!1,N=[n.rows,n.columns,n.values,n.filters];pe=(pe=n.rows).concat(n.columns,n.values,n.filters);var ue=[];o&&""!==o||(ue=he.match(/_custom_group/g));for(var ce=r.getFieldByName(s.replace(/_custom_group/g,""),pe),ge=r.getFieldByName(he,pe),fe=0,me=N;fe<me.length;fe++){k=me[fe];if(!P&&k){for(j=k.length,c=0;c<j;){if(k[c].name===a.name&&!ge){P=!0;q=k[c],H={name:he,caption:o&&""!==o?o:(ce.caption?ce.caption:ce.name)+(ue.length+1),type:"Count",showNoDataItems:q.showNoDataItems,baseField:q.baseField,baseItem:q.baseItem,showSubTotals:q.showValueTypeIcon,allowDragAndDrop:q.allowDragAndDrop,showFilterIcon:q.showFilterIcon,showSortIcon:q.showSortIcon,showRemoveIcon:q.showRemoveIcon,showEditIcon:q.showEditIcon};k.splice(c,0,H);break}if(k[c].name===he&&ge){H={name:ge.name,caption:o&&""!==o?o:ge.caption,type:ge.type,showNoDataItems:ge.showNoDataItems,baseField:ge.baseField,baseItem:ge.baseItem,showRemoveIcon:ge.showRemoveIcon,showSubTotals:ge.showValueTypeIcon,allowDragAndDrop:ge.allowDragAndDrop,showFilterIcon:ge.showFilterIcon,showSortIcon:ge.showSortIcon,showEditIcon:ge.showEditIcon};k.splice(c,1,H);break}c++}if(P)break}}var ve=r.getFieldByName(s,r.cloneFormatSettings(n.formats));ve&&(ve.name=he,n.formats.push(ve))}n.groupingFields=sf.base.extend(n.groupingFields,l)},n=this,o=0,l=this.groups;o<l.length;o++){var d=s(l[o]);if("object"===a(d))return d.value}return i},e.prototype.frameData=function(e){for(var t=Object.keys(e),i=0,a={};i<t.length;)a[t[i]]=void 0,i++;return a},e.prototype.getRange=function(e,t){var i;if("Date"===e.type){var a=new Date(t),s="string"==typeof e.startingAt?new Date(e.startingAt):e.startingAt,r="string"==typeof e.endingAt?new Date(e.endingAt):e.endingAt;i=!!(s&&a.getTime()<s.getTime()||r&&a.getTime()>r.getTime())}else{var n="string"==typeof e.startingAt?parseInt(e.startingAt,10):e.startingAt,o="string"==typeof e.endingAt?parseInt(e.endingAt,10):e.endingAt;i=!!(n&&t<n||o&&t>o)}return i},e.prototype.getPercentFormat=function(e,t){var i=sf.base.isNullOrUndefined(e[t])||sf.base.isNullOrUndefined(this.formatFields[t].format)?void 0:this.formatFields[t].format.toLowerCase().match(/p[0-9]/);return sf.base.isNullOrUndefined(i)?"P0":this.formatFields[t].format},e.prototype.getFormattedFields=function(e){for(var t=this.formats.length;t--;)this.formatFields[this.formats[t].name]=this.formats[t],this.formats[t].type&&(this.dateFormatFunction[this.formats[t].name]={exactFormat:this.globalize.getDateFormat(this.formats[t]),fullFormat:this.globalize.getDateFormat({format:"yyyy/MM/dd/HH/mm/ss",type:this.formats[t].type})})},e.prototype.getFieldList=function(e,t,i){var a,s=this.fields,n=sf.base.extend([],this.rows,null,!0);n=n.concat(this.columns,this.values,this.filters),this.getFormattedFields(n),this.getCalculatedField(s),s=this.fields;var o=this.excludeFields.length;for(o-=1;o>-1;){var l=this.fields.indexOf(this.excludeFields[o]);this.fields.splice(l,1),this.fieldList&&delete this.fieldList[this.excludeFields[o]],o--}var d=s.length,p=["string","number","datetime","date","boolean"];if(this.savedFieldList)for(this.fieldList=this.savedFieldList;d--;){var h=s[d],u=this.getMappingField(h);this.fieldList[h]?(this.fieldList[h].isSelected=!1,this.fieldList[h].index=d,this.fieldList[h].filter=[],this.fieldList[h].sort=t?"Ascending":"None",this.fieldList[h].isExcelFilter=!1,this.fieldList[h].filterType="",this.fieldList[h].showFilterIcon=!u||!("showFilterIcon"in u)||u.showFilterIcon,this.fieldList[h].showRemoveIcon=!u||!("showRemoveIcon"in u)||u.showRemoveIcon,this.fieldList[h].showSortIcon=!u||!("showSortIcon"in u)||u.showSortIcon,this.fieldList[h].showEditIcon=!u||!("showEditIcon"in u)||u.showEditIcon,this.fieldList[h].showValueTypeIcon=!u||!("showValueTypeIcon"in u)||u.showValueTypeIcon,this.fieldList[h].allowDragAndDrop=!u||!("allowDragAndDrop"in u)||u.allowDragAndDrop,this.fieldList[h].isCalculatedField=!(!u||!("isCalculatedField"in u))&&u.isCalculatedField,this.fieldList[h].showNoDataItems=!(!u||!("showNoDataItems"in u))&&u.showNoDataItems,this.fieldList[h].showSubTotals=!u||!("showSubTotals"in u)||u.showSubTotals,this.isValueFiltersAvail&&i&&(this.fieldList[h].dateMember=[],this.fieldList[h].formattedMembers={},this.fieldList[h].members={})):(a=u&&"dataType"in u&&u.dataType&&p.indexOf(u.dataType.toLowerCase())>-1?u.dataType.toLowerCase():a,this.fieldList[h]={caption:u&&"caption"in u&&u.caption?u.caption:h,id:h,type:-1!==h.indexOf("_custom_group")||-1!==h.indexOf("_date_group")?"string":void 0===a||"undefined"===a?"number":a,isSelected:!1,sort:t?"Ascending":"None",filterType:"",index:d,filter:[],isCustomField:-1!==h.indexOf("_custom_group")||-1!==h.indexOf("_date_group"),showRemoveIcon:!u||!("showRemoveIcon"in u)||u.showRemoveIcon,showFilterIcon:!u||!("showFilterIcon"in u)||u.showFilterIcon,showSortIcon:!u||!("showSortIcon"in u)||u.showSortIcon,showNoDataItems:!(!u||!("showNoDataItems"in u))&&u.showNoDataItems,isCalculatedField:!(!u||!("isCalculatedField"in u))&&u.isCalculatedField,showEditIcon:!u||!("showEditIcon"in u)||u.showEditIcon,showValueTypeIcon:!u||!("showValueTypeIcon"in u)||u.showValueTypeIcon,allowDragAndDrop:!u||!("allowDragAndDrop"in u)||u.allowDragAndDrop,showSubTotals:!u||!("showSubTotals"in u)||u.showSubTotals,aggregateType:u&&"type"in u?u.type:"number"===(-1!==h.indexOf("_custom_group")||-1!==h.indexOf("_date_group")?"string":void 0===a||"undefined"===a?"number":a)?"Sum":"Count",baseField:u&&"baseField"in u?u.baseField:void 0,baseItem:u&&"baseItem"in u?u.baseItem:void 0})}else for(this.fieldList={};d--;){h=s[d];a=(u=this.getMappingField(h))&&"dataType"in u&&u.dataType&&p.indexOf(u.dataType.toLowerCase())>-1?u.dataType.toLowerCase():r.getType(e[this.fieldKeys[h]]),this.fieldList[h]={id:h,caption:u&&"caption"in u&&u.caption?u.caption:h,type:-1!==h.indexOf("_custom_group")||-1!==h.indexOf("_date_group")?"string":void 0===a||"undefined"===a?"number":a,filterType:"",index:d,filter:[],sort:t?"Ascending":"None",isSelected:!1,isCustomField:-1!==h.indexOf("_custom_group")||-1!==h.indexOf("_date_group"),showFilterIcon:!u||!("showFilterIcon"in u)||u.showFilterIcon,showRemoveIcon:!u||!("showRemoveIcon"in u)||u.showRemoveIcon,showSortIcon:!u||!("showSortIcon"in u)||u.showSortIcon,showEditIcon:!u||!("showEditIcon"in u)||u.showEditIcon,showValueTypeIcon:!u||!("showValueTypeIcon"in u)||u.showValueTypeIcon,allowDragAndDrop:!u||!("allowDragAndDrop"in u)||u.allowDragAndDrop,showSubTotals:!u||!("showSubTotals"in u)||u.showSubTotals,showNoDataItems:!(!u||!("showNoDataItems"in u))&&u.showNoDataItems,isCalculatedField:!(!u||!("isCalculatedField"in u))&&u.isCalculatedField,aggregateType:u&&"type"in u?u.type:"number"===(-1!==h.indexOf("_custom_group")||-1!==h.indexOf("_date_group")?"string":void 0===a||"undefined"===a?"number":a)?"Sum":"Count",baseField:u&&"baseField"in u?u.baseField:void 0,baseItem:u&&"baseItem"in u?u.baseItem:void 0}}this.updateTreeViewData(n)},e.prototype.getMappingField=function(e){var t={};if(this.fieldMapping.length>0)for(var i=0,a=this.fieldMapping.length;i<a;i++)if(this.fieldMapping[i].name===e){t=this.fieldMapping[i];break}return t},e.prototype.updateFieldList=function(e){for(var t=this.fields,i=t.length;i--;)this.fieldList[t[i]].isExcelFilter=e[t[i]].isExcelFilter},e.prototype.updateTreeViewData=function(e){for(var t=e.length,i=this.calculatedFieldSettings.length;t--;)if(this.fieldList[e[t].name]){var a=this.fieldList[e[t].name];a.type=e[t].dataType?e[t].dataType.toLowerCase():a.type,a.caption=e[t].caption?e[t].caption:e[t].name,a.isSelected=!0,a.showNoDataItems=e[t].showNoDataItems,a.aggregateType=e[t].type,a.baseField=e[t].baseField,a.baseItem=e[t].baseItem,a.allowDragAndDrop=e[t].allowDragAndDrop,a.showFilterIcon=e[t].showFilterIcon,a.showSortIcon=e[t].showSortIcon,a.showRemoveIcon=e[t].showRemoveIcon,a.showValueTypeIcon=e[t].showValueTypeIcon,a.showEditIcon=e[t].showEditIcon,a.showSubTotals=e[t].showSubTotals}for(;i--;)this.fieldList[this.calculatedFieldSettings[i].name]&&(this.fieldList[this.calculatedFieldSettings[i].name].aggregateType="CalculatedField",this.fieldList[this.calculatedFieldSettings[i].name].isCalculatedField=!0,this.fieldList[this.calculatedFieldSettings[i].name].formula=this.calculatedFieldSettings[i].formula)},e.prototype.getCalculatedField=function(e){for(var t=0,i=this.calculatedFieldSettings;t<i.length;t++){var a=i[t];this.calculatedFields[a.name]=sf.base.extend({},a,null,!0),this.calculatedFields[a.name].actualFormula=a.formula}for(var s=Object.keys(this.calculatedFields),r=function(t,i){var a=n.calculatedFields[s[t]],r=a.properties,o=(r?r.formula:a.formula).replace(/ +/g,""),l=o.replace(/"/g,"");a.formula=l.indexOf("^")>-1?n.powerFunction(l):l,-1===a.formula.indexOf("Math.min(")&&a.formula.indexOf("min(")>-1&&(a.formula=a.formula.replace(/min\(/g,"Math.min(")),-1===a.formula.indexOf("Math.max(")&&a.formula.indexOf("max(")>-1&&(a.formula=a.formula.replace(/max\(/g,"Math.max(")),-1===a.formula.indexOf("Math.abs(")&&a.formula.indexOf("abs(")>-1&&(a.formula=a.formula.replace(/abs\(/g,"Math.abs(")),a.name=r?r.name:a.name,(e=e.filter((function(e){return e!==a.name}))).push(a.name);for(var d=o.split('"'),p=0,h=d.length;p<h;p++){var u=d[p],c=u.split(/[ .:;?!~,`"&|()<>{}\[\]\r\n/\\]+/),g="DistinctCount"===c[0]?"DistinctCount":"PopulationStDev"===c[0]?"PopulationStDev":"SampleStDev"===c[0]?"SampleStDev":"PopulationVar"===c[0]?"PopulationVar":"SampleVar"===c[0]?"SampleVar":c[0];if(-1!==["Sum","Count","Min","Max","Avg","Product","DistinctCount","PopulationStDev","SampleStDev","PopulationVar","SampleVar","Median"].indexOf(g)){var f=e.indexOf(c[1]);n.calculatedFormulas[a.name]?n.calculatedFormulas[a.name].push({index:f,type:g,formula:u}):n.calculatedFormulas[a.name]=[{index:f,type:g,formula:u}]}}},n=this,o=0,l=s.length;o<l;o++)r(o);this.fields=e},e.prototype.validateFilters=function(e){this.isValueFiltersAvail=!1;var t=e.filterSettings?e.filterSettings:[],i=sf.base.extend([],this.rows,null,!0);i=i.concat(this.columns);for(var a=0,s=t;a<s.length;a++){for(var r=s[a],n=0,o=i;n<o.length;n++){var l=o[n];if(r.name===l.name&&"Value"===r.type){this.isValueFiltersAvail=!0;break}}if(this.isValueFiltersAvail)break}},e.prototype.validateValueFields=function(){this.isValueHasAdvancedAggregate=!1;for(var e=0,t=this.values;e<t.length;e++){var i=t[e];if(-1!==["DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentRowTotal","PercentageOfParentColumnTotal","PercentageOfParentTotal","RunningTotals"].indexOf(i.type)){this.isValueHasAdvancedAggregate=!0;break}}},e.prototype.fillFieldMembers=function(e,t){for(var i=this.fields,a=e.length,s=this.fieldList,r=i.length,n=0;n<r;n++){var o=i[n];s[o].members&&!this.allowDataCompression||(s[o].members={}),s[o].formattedMembers&&!this.allowDataCompression||(s[o].formattedMembers={}),s[o].dateMember&&!this.allowDataCompression||(s[o].dateMember=[]);for(var l=s[o].members,d=Object.keys(l).length>0,p=s[o].formattedMembers,h=s[o].dateMember,u=0,c=0,g=0;g<a;g++){var f=e[g][this.fieldKeys[o]];if(!d){var m=f,v=!this.pageSettings||this.formatFields[o]&&["date","dateTime","time"].indexOf(this.formatFields[o].type)>-1?this.getFormattedValue(f,o):{formattedText:null===f?this.localeObj?this.localeObj.getConstant("null"):String(f):void 0===f?this.localeObj?o in this.groupingFields?this.localeObj.getConstant("groupOutOfRange"):this.localeObj.getConstant("undefined"):String(f):f.toString(),actualText:null===f?this.localeObj?this.localeObj.getConstant("null"):String(f):void 0===f?this.localeObj?o in this.groupingFields?this.localeObj.getConstant("groupOutOfRange"):this.localeObj.getConstant("undefined"):String(f):f};v.formattedText&&(m=v.formattedText),l.hasOwnProperty(f)?l[f].index.push(g):(u++,l[f]={index:[g],ordinal:u,isDrilled:!!this.isExpandAll},h.push({formattedText:v.formattedText,actualText:v.dateText?v.dateText:v.actualText})),p.hasOwnProperty(m)?p[m].index.push(g):(c++,p[m]={index:[g],ordinal:c,isDrilled:!!this.isExpandAll})}t[g]||(t[g]=[]),t[g][n]=l[f].ordinal}}},e.prototype.generateValueMatrix=function(e){for(var t=this.fields,i=e.length,a=[],s=t.length,r=this.fieldList;i--;){var n=s;for(a[i]=[];n--;){var o=t[n];a[i][n]="number"===r[o].type||sf.base.isNullOrUndefined(e[i][this.fieldKeys[o]])?isNaN(Number(e[i][this.fieldKeys[o]]))?void 0:Number(e[i][this.fieldKeys[o]]):1}}return a},e.prototype.updateSortSettings=function(e,t){for(var i=0,a=e?e.length:0;i<a&&t;i++)this.fieldList[e[i].name]&&(this.fieldList[e[i].name].sort=e[i].order)},e.prototype.updateFilterMembers=function(e){var t=this.filterMembers,i={},a=this.getFilters(e,i),s=this.indexMatrix.length;if(a)for(var r=i.include.index,n=0;n<r.length;n++)void 0!==i.exclude&&void 0!==i.exclude.indexObject[r[n]]||t.push(r[n]);else for(n=0;n<s;n++)void 0!==i.exclude&&void 0!==i.exclude.indexObject[n]||t.push(n)},e.prototype.getFilters=function(e,t){for(var i=e.filterSettings?e.filterSettings:[],a=!1,s=[],r=0,n=i.length;r<n;r++){var o=i[r].properties?i[r].properties:i[r];this.fieldList[o.name]&&this.fieldList[o.name].isSelected&&this.isValidFilterField(o,e.allowMemberFilter,e.allowLabelFilter)&&(this.applyLabelFilter(o),o&&(s=o.items),o.type&&"Include"===o.type?(this.frameFilterList(s,o.name,t,"include",o.showLabelFilter,a),a=!0):this.frameFilterList(s,o.name,t,"exclude",o.showLabelFilter),o.showLabelFilter&&(o.items=[],o.type=o.showDateFilter?"Date":o.showNumberFilter?"Number":"Label"))}return a},e.prototype.isValidFilterField=function(e,t,i){var a=e.name,s=!1,r=sf.base.extend([],this.rows,null,!0);if(r=r.concat(this.columns),this.fieldList[a].isSelected&&t&&["Include","Exclude"].indexOf(e.type)>=0){s=!0;for(var n=0,o=this.values;n<o.length;n++){if(a===o[n].name){s=!1;break}}}else if(i)for(var l=0,d=r;l<d.length;l++){if(a===d[l].name&&["Label","Date","Number"].indexOf(e.type)>=0){s=!0;break}}return s},e.prototype.applyLabelFilter=function(e){if(["Label","Date","Number"].indexOf(e.type)>=0){var t=Object.keys(this.fieldList[e.name].members);if(e.showLabelFilter=!0,"Label"===e.type)e.items=this.getLabelFilterMembers(t,e.condition,e.value1,e.value2);else if("Date"===e.type){e.showDateFilter=!0;var i="string"==typeof e.value1?new Date(e.value1):e.value1,a="string"==typeof e.value2?new Date(e.value2):e.value2;e.items=this.getDateFilterMembers(t,e.name,e.condition,i,a)}else{e.showNumberFilter=!0,e.items=[];for(var s=0,r=t;s<r.length;s++){var n=r[s],o=this.getParsedValue(e.name,e.value1),l=this.getParsedValue(e.name,e.value2),d=this.getParsedValue(e.name,n);this.validateFilterValue(d,e.condition,o,l)&&e.items.push(n)}}e.type=e.condition?["DoesNotBeginWith","DoesNotContains","DoesNotEndsWith","DoesNotEquals","NotBetween"].indexOf(e.condition)>-1&&!e.showNumberFilter?"Exclude":"Include":"Exclude"}else e.showLabelFilter=!1},e.prototype.getLabelFilterMembers=function(e,t,i,a){for(var s=[],r=0,n=e;r<n.length;r++){var o=n[r],l=o.toLowerCase();if(i.toString())switch(t){case"Equals":case"DoesNotEquals":l===i.toLowerCase()&&s.push(o);break;case"BeginWith":case"DoesNotBeginWith":0===l.indexOf(i.toLowerCase())&&s.push(o);break;case"EndsWith":case"DoesNotEndsWith":null!==l.match(i.toLowerCase()+"$")&&s.push(o);break;case"Contains":case"DoesNotContains":l.indexOf(i.toLowerCase())>-1&&s.push(o);break;case"GreaterThan":l>i.toLowerCase()&&s.push(o);break;case"GreaterThanOrEqualTo":l>=i.toLowerCase()&&s.push(o);break;case"LessThan":l<i.toLowerCase()&&s.push(o);break;case"LessThanOrEqualTo":l<=i.toLowerCase()&&s.push(o);break;case"Between":case"NotBetween":l>=i.toLowerCase()&&l<=a.toLowerCase()&&s.push(o);break;default:l===i.toLowerCase()&&s.push(o)}}return s},e.prototype.getDateFilterMembers=function(e,t,i,a,s){for(var r=[],n=0,o=e;n<o.length;n++){var l=o[n],d=new Date(l);if(a)switch(i){case"Equals":case"DoesNotEquals":this.getFormattedValue(d.toString(),t).formattedText===this.getFormattedValue(a.toString(),t).formattedText&&r.push(this.getFormattedValue(l,t).formattedText);break;case"After":d.getTime()>a.getTime()&&r.push(this.getFormattedValue(l,t).formattedText);break;case"AfterOrEqualTo":d.getTime()>=a.getTime()&&r.push(this.getFormattedValue(l,t).formattedText);break;case"Before":d.getTime()<a.getTime()&&r.push(this.getFormattedValue(l,t).formattedText);break;case"BeforeOrEqualTo":d.getTime()<=a.getTime()&&r.push(this.getFormattedValue(l,t).formattedText);break;case"Between":case"NotBetween":d.getTime()>=a.getTime()&&d.getTime()<=s.getTime()&&r.push(this.getFormattedValue(l,t).formattedText);break;default:this.getFormattedValue(d.toString(),t).formattedText===this.getFormattedValue(a.toString(),t).formattedText&&r.push(this.getFormattedValue(l,t).formattedText)}}return r},e.prototype.validateFilterValue=function(e,t,i,a){var s=!1;if("number"==typeof i)switch(t){case"Equals":e===i&&(s=!0);break;case"DoesNotEquals":e!==i&&(s=!0);break;case"GreaterThan":e>i&&(s=!0);break;case"GreaterThanOrEqualTo":e>=i&&(s=!0);break;case"LessThan":e<i&&(s=!0);break;case"LessThanOrEqualTo":e<=i&&(s=!0);break;case"Between":e>=i&&e<=a&&(s=!0);break;case"NotBetween":e>=i&&e<=a||(s=!0);break;default:e!==i&&(s=!0)}return s},e.prototype.frameFilterList=function(e,t,i,a,s,r){i[a]||(i[a]={indexObject:{},index:[]}),this.updateFilter(e,t,i,a,s,r)},e.prototype.updateFilter=function(e,t,i,a,s,r){var n=0,o=this.fieldList[t];o.filter=e,o.filterType=a,o.isExcelFilter=s;var l=this.formatFields[t]&&["date","dateTime","time"].indexOf(this.formatFields[t].type)>-1?o.formattedMembers:o.members,d=r,p={},h={};for(p[a]={indexObject:{},index:[]},this.fieldFilterMem[t]={memberObj:{}};e[n];){if(l[e[n]]){var u=l[e[n]].index;if("include"===a)for(var c=0,g=u.length;c<g;c++)d&&void 0===i[a].indexObject[u[c]]||(p[a].indexObject[u[c]]=u[c],p[a].index.push(u[c]));else{for(c=0,g=u.length;c<g;c++)void 0===i[a].indexObject[u[c]]&&(i[a].indexObject[u[c]]=u[c],i[a].index.push(u[c]));this.fieldFilterMem[t].memberObj[e[n]]=e[n]}}n++}if("include"===a){i[a]=p[a];for(c=0;c<e.length;c++)l[e[c]]&&(h[e[c]]=e[c]);var f=Object.keys(l);for(c=0,g=f.length;c<g;c++)void 0===h[f[c]]&&(this.fieldFilterMem[t].memberObj[f[c]]=f[c])}},e.prototype.applyValueFiltering=function(e,t,i,a,s,r,n){this.isValueFiltered=!1;var o=sf.base.extend({},"row"===n&&this.rowGrandTotal?this.rowGrandTotal:"column"===n&&this.columnGrandTotal?this.columnGrandTotal:i[i.length-1],null,!0);return this.getFilteredData(i,a,s,r,t,e.name,o,n),this.isValueFiltered&&(("row"===n&&null===this.rowGrandTotal||"column"===n&&null===this.columnGrandTotal)&&r.push(o),i=r),i},e.prototype.getFilteredData=function(e,t,i,a,s,r,n,o){for(var l=e.length,d=0;d<l;d++)if(i[r])if(e[d].level===s){this.isValueFiltered=!0,this.fieldList[r].isExcelFilter=!0;var p=0,h=i[r].measure,u=this.fieldList[h].index,c=this.fieldList[h].aggregateType;this.rawIndexObject={},p="row"===o?this.getAggregateValue(e[d].index,t.indexObject,u,c):this.getAggregateValue(t.index,e[d].indexObject,u,c);var g={fieldName:h,row:e[d],column:t,value:p,cellSets:this.getCellSet(this.rawIndexObject),rowCellType:e[d].hasChild&&e[d].isDrilled?"subTotal":"grand sum"===e[d].type?"grandTotal":"value",columnCellType:t.hasChild&&t.isDrilled?"subTotal":"grand sum"===t.type?"grandTotal":"value",aggregateType:c,skipFormatting:!1};this.getValueCellInfo&&this.getValueCellInfo(g),p=g.value,this.rawIndexObject={};var f=this.getParsedValue(h,i[r].value1),m=this.getParsedValue(h,i[r].value2);if(this.validateFilterValue(p,i[r].condition,f,m)||"grand sum"===e[d].type)"grand sum"!==e[d].type&&(a.push(sf.base.extend({},e[d],null,!0)),a[a.length-1].isLevelFiltered=!0);else{var v=this.removefilteredData(e[d],this.valueFilteredData),b=v||e[d];this.validateFilteredParentData(b,this.valueFilteredData,n,0,s,o)}}else e[d].hasChild&&e[d].members.length>0&&"grand sum"!==e[d].type&&(a.push(sf.base.extend({},e[d],null,!0)),a[a.length-1].members=[],a[a.length-1].isLevelFiltered=!0,this.getFilteredData(e[d].members,t,i,a[a.length-1].members,s,r,n,o))},e.prototype.getParsedValue=function(e,t){var i=t?t.toString():"";if(this.formatFields[e]&&t){var a=sf.base.extend({},this.formatFields[e],null,!0);return delete a.name,this.globalize.parseNumber(i,a)}return this.globalize.parseNumber(i,{format:"N"})},e.prototype.removefilteredData=function(e,t){for(var i,a=sf.base.extend([],t,null,!0),s=0;s<a.length;s++){if(e.isLevelFiltered&&e.axis===a[s].axis&&e.valueSort.levelName===a[s].valueSort.levelName&&e.actualText===a[s].actualText&&e.axis===a[s].axis&&e.level===a[s].level&&e.ordinal===a[s].ordinal){i=a[s],t.splice(s,1);break}t[s].hasChild&&t[s].members.length>0&&this.removefilteredData(e,t[s].members)}return i},e.prototype.validateFilteredParentData=function(e,t,i,a,s,r){if(t.length>0)for(var n=0,o=t;n<o.length;n++){var l=o[n];if(l.level===a){if("row"===r)for(var d=0,p=u=e.index;d<p.length;d++){var h=p[d];i.index.indexOf(h)>=0&&i.index.splice(i.index.indexOf(h),1),e.valueSort.levelName.toString().indexOf(l.valueSort.levelName.toString())>=0&&l.level!==s&&l.index.indexOf(h)>=0&&l.index.splice(l.index.indexOf(h),1)}else for(var u=e.indexObject,c=0,g=Object.keys(u);c<g.length;c++){h=g[c];u.hasOwnProperty(h)&&(delete i.indexObject[h],e.valueSort.levelName.toString().indexOf(l.valueSort.levelName.toString())>=0&&l.level!==s&&delete l.indexObject[h])}l&&l.members.length>0&&l.members[0].level===a+1&&l.members[0].level!==s&&this.validateFilteredParentData(e,l.members,i,a+1,s,r)}}else if("row"===r)for(var f=0,m=u=e.index;f<m.length;f++){h=m[f];i.index.indexOf(h)>=0&&i.index.splice(i.index.indexOf(h),1)}else{u=e.indexObject;for(var v=0,b=Object.keys(u);v<b.length;v++){h=b[v];u.hasOwnProperty(h)&&delete i.indexObject[h]}}},e.prototype.updateFramedHeaders=function(e,t,i,a,s){for(var r=0,n=e;r<n.length;r++){var o=n[r];this.isHeaderAvail=!1,(this.validateFilteredHeaders(o,i,s)||"grand sum"===o.type)&&("row"===s?this.rowCount+=this.rowValuesLength:this.columnCount+=this.colValuesLength,a.push(sf.base.extend({},o,null,!0)),a[a.length-1].members=[],o.hasChild&&o.isDrilled&&o.members.length>0&&this.updateFramedHeaders(o.members,t,i,a[a.length-1].members,s))}return this.filterFramedHeaders},e.prototype.validateFilteredHeaders=function(e,t,i){for(var a=0,s=t;a<s.length;a++){var r=s[a];if(!this.isHeaderAvail){if(e.actualText===r.actualText&&e.level===r.level&&e.valueSort.levelName===r.valueSort.levelName)return"row"===i?r.index.length>0?(this.isHeaderAvail=!0,e.index=r.index,!0):(this.isHeaderAvail=!1,e.index=r.index,!1):Object.keys(r.indexObject).length>0?(this.isHeaderAvail=!0,e.indexObject=r.indexObject,!0):(this.isHeaderAvail=!1,e.indexObject=r.indexObject,!1);r.hasChild&&r.members.length>0&&"grand sum"!==r.type&&this.validateFilteredHeaders(e,r.members,i)}}return this.isHeaderAvail},e.prototype.isEmptyDataAvail=function(e,t){this.isEmptyData=!1,e.length>0&&"grand sum"===e[e.length-1].type&&0===e[e.length-1].index.length&&(this.isEmptyData=!0),t.length>0&&"grand sum"===t[t.length-1].type&&0===Object.keys(t[t.length-1].indexObject).length&&(this.isEmptyData=!0),0!==e.length&&0!==t.length||(this.isEmptyData=!0)},e.prototype.updateGridData=function(e){this.data=e.dataSource,this.pageSettings&&this.pageSettings.allowDataCompression&&(this.actualData=this.data,this.data=this.getGroupedRawData(e)),this.indexMatrix=[];for(var t=0,i=this.fields;t<i.length;t++){var a=i[t];this.fieldList[a].members={},this.fieldList[a].formattedMembers={},this.fieldList[a].dateMember=[]}this.fillFieldMembers(this.data,this.indexMatrix),this.valueMatrix=this.generateValueMatrix(this.data),this.filterMembers=[],this.cMembers=[],this.rMembers=[],this.updateFilterMembers(e),this.isEditing=!0,this.isDrillThrough=!0,this.generateGridData(e),this.isEditing=!1},e.prototype.generateGridData=function(e,t){var i=e.columns?e.columns:[],a=this.data,s=e.rows?e.rows:[],r=e.filterSettings,n=e.values?e.values:[];this.removeCount=0,this.isExpandAll=e.expandAll,this.drilledMembers=e.drilledMembers?e.drilledMembers:[],this.isEmptyData=!1;var o=[],l=s[0]&&s[0].showNoDataItems||i[0]&&i[0].showNoDataItems,d=sf.base.extend([],this.rows,null,!0);if(d=d.concat(this.columns,this.values,this.filters),l)for(var p=0;p<this.indexMatrix.length;p++)o.push(p);for(p=0;p<this.filterMembers.length;p++)this.filterPosObj[this.filterMembers[p]]=this.filterMembers[p];this.valueSortSettings.columnIndex=void 0,this.validateValueFields(),this.frameDrillObject(),this.isValueFilterEnabled&&!this.isEditing||t||(this.columnCount=0,this.rowCount=0,this.cMembers=[],this.rMembers=[],0!==s.length&&(this.rMembers=this.getIndexedHeaders(s,a,0,s[0].showNoDataItems?o:this.filterMembers,"row","",this.allowValueFilter)),0!==i.length&&(this.cMembers=this.getIndexedHeaders(i,a,0,i[0].showNoDataItems?o:this.filterMembers,"column","",this.allowValueFilter)),this.insertAllMembersCommon(),this.saveDataHeaders=this.isValueFiltersAvail&&e.allowValueFilter?{rowHeaders:sf.base.extend([],this.rMembers,null,!0),columnHeaders:sf.base.extend([],this.cMembers,null,!0)}:{}),this.pivotValues=[],this.headerContent=[],this.valueContent=[],this.valueFilteredData=[],this.filterFramedHeaders=[];var h=[],u=[],c=[],g=[],f=this.values.length;if(this.isValueFiltersAvail&&e.allowValueFilter&&!t){this.valueFilteredData=[];var m=this.saveDataHeaders.rowHeaders,v=this.saveDataHeaders.columnHeaders;if(r.length>0){for(var b={},S={},y=0,C=n;y<C.length;y++){var w=C[y];S[w.name]=w}for(var x=0,T=r;x<T.length;x++){var M=T[x];m=c.length>0?c:m,v=g.length>0?g:v,this.valueFilteredData=[];var D=M.properties?M.properties:M;if("Value"===D.type&&this.fieldList[M.name]&&this.fieldList[M.name].isSelected){b[M.name]=M,D.items=[];for(var E=!1,O=s.length,P=i.length,N=0;N<O;N++)if(D.name===s[N].name&&S[D.measure]&&!E){E=!0,c=this.applyValueFiltering(s[N],N,m,this.columnGrandTotal?this.columnGrandTotal:v[v.length-1],b,this.valueFilteredData,"row");break}for(var F=0;F<P;F++)if(D.name===i[F].name&&S[D.measure]&&!E){E=!0,g=this.applyValueFiltering(i[F],F,v,this.rowGrandTotal?this.rowGrandTotal:m[m.length-1],b,this.valueFilteredData,"column");break}}}}c=c.length>0?c:m,g=g.length>0?g:v,this.isEmptyDataAvail(c,g);var I=sf.base.extend({},this.fieldList,null,!0);this.indexMatrix=[];var L=this.data[0];this.getFieldList(L,this.enableSort,e.allowValueFilter),this.fillFieldMembers(this.data,this.indexMatrix),this.updateSortSettings(e.sortSettings,this.enableSort),this.valueMatrix=this.generateValueMatrix(this.data),this.filterMembers=[],this.updateFilterMembers(e),this.rMembers=0!==s.length?this.getIndexedHeaders(s,a,0,s[0].showNoDataItems?o:this.filterMembers,"row",""):[],this.cMembers=0!==i.length?this.getIndexedHeaders(i,a,0,i[0].showNoDataItems?o:this.filterMembers,"column",""):[],this.insertAllMembersCommon(),this.updateFieldList(I),this.rowCount=0,this.columnCount=0,this.rMembers=this.updateFramedHeaders(this.rMembers,this.rMembers,c,this.filterFramedHeaders,"row"),this.filterFramedHeaders=[],this.cMembers=this.updateFramedHeaders(this.cMembers,this.cMembers,g,this.filterFramedHeaders,"column"),this.isValueFilterEnabled=!0}t||this.applyValueSorting(),this.pageSettings&&(t?(this.rMembers=t.rowHeaders,this.cMembers=t.columnHeaders,this.rowCount=t.rowHeadersCount,this.columnCount=t.columnHeadersCount):(this.headerCollection.rowHeaders=this.rMembers,this.headerCollection.columnHeaders=this.cMembers,this.headerCollection.rowHeadersCount=this.rowCount,this.headerCollection.columnHeadersCount=this.columnCount),this.calculatePagingValues()),this.getAggregatedHeaders(s,i,this.rMembers,this.cMembers,n),this.getHeaderData(this.cMembers,u,this.pivotValues,0,this.valueAxis?1:f),this.insertSubTotals(),this.getTableData(this.rMembers,h,u,0,this.pivotValues,f,this.rowGrandTotal?this.rowGrandTotal:this.rMembers[this.rMembers.length-1],this.columnGrandTotal?this.columnGrandTotal:this.cMembers[this.cMembers.length-1]),this.applyAdvancedAggregate(h,u,this.pivotValues),this.isEngineUpdated=!0,this.isEmptyDataAvail(this.rMembers,this.cMembers)},e.prototype.updateHeaders=function(e,t){e=sf.base.isNullOrUndefined(e)?!(!this.showGrandTotals||!this.showRowGrandTotals)||!(this.rows.length>0):e,(this.pageSettings&&this.removeRowGrandTotal||!e&&!this.rowGrandTotal)&&"grand sum"===this.rMembers[this.rMembers.length-1].type&&(this.rMembers=this.rMembers.slice(0,this.rMembers.length-1)),t=sf.base.isNullOrUndefined(t)?!(!this.showGrandTotals||!this.showColumnGrandTotals)||!(this.columns.length>0):t,(this.pageSettings&&this.removeColumnGrandTotal||!t&&!this.columnGrandTotal)&&"grand sum"===this.cMembers[this.cMembers.length-1].type&&(this.cMembers=this.cMembers.slice(0,this.cMembers.length-1))},e.prototype.updatePivotValues=function(e){var t=!(!this.showGrandTotals||!this.showRowGrandTotals)||!(this.rows.length>0),i=!(!this.showGrandTotals||!this.showColumnGrandTotals)||!(this.columns.length>0);if(e&&this.updateHeaders(t,i),(this.pageSettings&&this.removeRowGrandTotal||!t&&!this.rowGrandTotal)&&this.valueContent.length>0){var a=1;this.valueAxis&&this.values.length>0&&(a=1+this.values.length),this.pivotValues[this.pivotValues.length-a]&&"grand sum"===this.pivotValues[this.pivotValues.length-a][0].type&&(this.pivotValues=this.pivotValues.slice(0,this.pivotValues.length-a),this.valueContent=this.valueContent.slice(0,this.valueContent.length-a))}if((this.pageSettings&&this.removeColumnGrandTotal||!i&&!this.columnGrandTotal)&&this.headerContent.length>0){a=this.values.length;if(this.valueAxis&&this.values.length>0&&(a=1),this.pivotValues[0][this.pivotValues[0].length-a]&&"grand sum"===this.pivotValues[0][this.pivotValues[0].length-a].type)for(var s=0;s<this.pivotValues.length;s++)if(this.pivotValues[s]&&(this.pivotValues[s]=this.pivotValues[s].slice(0,this.pivotValues[s].length-a)),this.headerContent[s])for(var r=this.pivotValues[s].length;r<this.pivotValues[s].length+a;r++)delete this.headerContent[s][r]}this.removeRowGrandTotal=this.removeColumnGrandTotal=!1},e.prototype.onDrill=function(e){this.frameDrillObject();var t=this.getHeadersInfo(e.fieldName,e.axis);this.performDrillOperation(t.headers,e,t.fields,t.position,0),this.headerCollection.rowHeadersCount=this.rowCount,this.headerCollection.columnHeadersCount=this.columnCount,"row"===t.axis?this.headerCollection.rowHeaders=t.headers:this.headerCollection.columnHeaders=t.headers,this.updateEngine()},e.prototype.onSort=function(e){var t=this.getHeadersInfo(e.name,"");this.fieldList[e.name].sort=e.order,this.performSortOperation(t.headers,e,t,0),this.updateEngine()},e.prototype.onFilter=function(e,t){var i=this.getHeadersInfo(e.name,"");"Include"===e.type&&e.items.length===this.fieldList[e.name].dateMember.length?(this.fieldList[e.name].filter=[],this.fieldList[e.name].filterType=""):(this.fieldList[e.name].filter=e.items,this.fieldList[e.name].filterType=e.type);for(var a={},s=0,r=this.filterMembers;s<r.length;s++){var n=r[s];a[n]=n}this.filterMembers=[],this.fieldFilterMem={},this.updateFilterMembers(t);for(var o=this.filterMembers.filter((function(e){return void 0===a[e]})),l=0,d=e.items;l<d.length;l++)d[l];if(this.rows[0]&&this.rows[0].showNoDataItems||this.columns[0]&&this.columns[0].showNoDataItems){var p=[];this.filterPosObj={};for(var h=0;h<o.length;h++)this.filterPosObj[o[h]]=o[h];for(h=0;h<this.indexMatrix.length;h++)p.push(h);o=p}this.performFilterCommonUpdate(e,i,o),this.frameHeaderObjectsCollection=!1,this.headerObjectsCollection={},this.updateEngine()},e.prototype.onAggregation=function(e){this.fieldList[e.name].aggregateType=e.type,this.rMembers=this.headerCollection.rowHeaders,this.cMembers=this.headerCollection.columnHeaders,this.allowDataCompression&&(this.data=this.getGroupedRawData(this.dataSourceSettings),this.valueMatrix=this.generateValueMatrix(this.data)),this.updateEngine()},e.prototype.onCalcOperation=function(e){this.rMembers=this.headerCollection.rowHeaders,this.cMembers=this.headerCollection.columnHeaders,this.getCalculatedField(this.fields),this.fieldList[e.name]?this.fieldList[e.name].formula=e.formula:(this.fieldList[e.name]={id:e.name,caption:e.name,type:"number",aggregateType:"CalculatedField",filterType:"",index:this.fields.length-1,filter:[],sort:this.enableSort?"Ascending":"None",isSelected:!0,isExcelFilter:!1,formula:e.formula},1===this.valueAxis?this.headerCollection.rowHeadersCount=this.rowCount=this.rowCount/(this.values.length-1)*this.values.length:this.headerCollection.columnHeadersCount=this.columnCount=this.columnCount/(this.values.length-1)*this.values.length),this.updateEngine()},e.prototype.performDrillOperation=function(e,t,i,a,s){for(var r=0;r<e.length;){if(a===s){if(t.memberName===e[r].valueSort.levelName.split(this.valueSortSettings.headerDelimiter).join(t.delimiter?t.delimiter:"**")){if("down"===t.action){e[r].isDrilled=!0,e[r].members=this.getIndexedHeaders(i,this.data,a+1,e[r].index,t.axis,t.memberName.split(t.delimiter?t.delimiter:"**").join(this.valueSortSettings.headerDelimiter));var n=void 0;if("row"===t.axis)n=this.applyValueSorting(e[r].members,this.cMembers),e[r].members=n.rMembers;else{var o=this.showSubTotals&&this.showColumnSubTotals&&i[a].showSubTotals;this.columnCount-=o?0:this.colValuesLength,n=this.applyValueSorting(this.rMembers,e[r].members),e[r].members=n.cMembers}}else e[r].isDrilled=!1,this.updateHeadersCount(e[r].members,t.axis,a,i,"minus",!0),e[r].members=[];break}}else e[r].members.length>0&&(e[r].members=this.performDrillOperation(e[r].members,t,i,a,s+1));r++}return e},e.prototype.performSortOperation=function(e,t,i,a){for(var s=0;s<e.length;){if(i.position===a){e=this.getSortedHeaders(e,t.order.toString());break}e[s].members.length>0&&(e[s].members=this.performSortOperation(e[s].members,t,i,a+1)),s++}return e},e.prototype.performFilterDeletion=function(e,t,i,a,s){for(var r=0,n=!0,o=function(){if(i.position===s){var o=l;e=e.filter((function(e){return!o.fieldFilterMem[t.name].memberObj[e.formattedText]||"grand sum"===e.type})),n=!1}else e[r].members.length>0&&(e[r].members=l.performFilterDeletion(e[r].members,t,i,a,s+1));r++},l=this;r<e.length&&n;)o();var d=this;return e.filter((function(e){return e.members.length>0?e.members.length>0:d.matchIndexes(e.indexObject,a)}))},e.prototype.matchIndexes=function(e,t){var i=Object.keys(e),a=i.length;if(0===a)return!0;for(;a>-1;){if(void 0!==t[e[i[a]]])return!0;a--}return!1},e.prototype.performFilterAddition=function(e,t,i){for(var a=0,s=function(){var s=e[a].valueSort.levelName;if(r.headerObjectsCollection[s]){for(var n={},o=0,l=e[a].members;o<l.length;o++){var d=l[o];n[d.valueSort.levelName.toString()]=d.valueSort.levelName.toString()}var p=r.headerObjectsCollection[s].filter((function(e){return!n[e.valueSort.levelName.toString()]}));e[a].members=e[a].members.concat(p),e[a].members=r.getSortedHeaders(e[a].members,r.fieldList[i.fields[e[a].members[0].level].name].sort),delete r.headerObjectsCollection[s]}e[a].members.length>0&&(e[a].members=r.performFilterAddition(e[a].members,t,i)),a++},r=this;a<e.length;)s();return e},e.prototype.performFilterCommonUpdate=function(e,t,i){for(var a="row"===t.axis?this.rMembers:this.cMembers,s={},r=0,n=this.filterMembers;r<n.length;r++){var o=n[r];s[o]=o}if(this.fieldFilterMem[e.name]&&(a=this.performFilterDeletion(t.headers,e,t,s,0)),i.length>0&&t.fields.length>0){if(this.frameHeaderObjectsCollection=!0,t.fields.filter((function(e){return e.showNoDataItems})).length>0)for(var l=0;l<this.data.length;l++)i.push(l);this.headerObjectsCollection.parent=this.getIndexedHeaders(t.fields,this.data,0,i,t.axis,""),a=this.performFilterAddition(a,t.fields,t);for(var d={},p=0,h=a;p<h.length;p++){var u=h[p];d[u.valueSort.levelName.toString()]=u.valueSort.levelName.toString()}var c=this.headerObjectsCollection.parent.filter((function(e){return!d[e.valueSort.levelName.toString()]})),g=a.filter((function(e){return"grand sum"===e.type}));g.length>0&&a.pop(),a=this.getSortedHeaders(a.concat(c),this.fieldList[t.fields[0].name].sort).concat(g)}"row"===t.axis?this.rowCount=0:this.columnCount=0,this.updateHeadersCount(a,t.axis,0,t.fields,"plus",!1),"row"===t.axis?(t.position>0&&this.insertPosition(this.rows,this.data,0,this.filterMembers,"row","",a),this.insertTotalPosition(a),this.rMembers=this.headerCollection.rowHeaders=a,this.headerCollection.rowHeadersCount=this.rowCount):(t.position>0&&this.insertPosition(this.columns,this.data,0,this.filterMembers,"column","",a),this.insertTotalPosition(a),this.cMembers=this.headerCollection.columnHeaders=a,this.headerCollection.columnHeadersCount=this.columnCount),this.applyValueSorting()},e.prototype.getHeadersInfo=function(e,t){this.rMembers=this.headerCollection.rowHeaders,this.cMembers=this.headerCollection.columnHeaders;for(var i="row"===(t=""===t?this.getAxisByFieldName(e):t)?this.rMembers:this.cMembers,a="row"===t?this.rows:this.columns,s=0,r=0,n=a;r<n.length;r++){if(n[r].name===e)break;s++}return{axis:t,fields:a,headers:i,position:s}},e.prototype.updateEngine=function(){this.removeCount=0,this.validateValueFields(),this.calculatePagingValues(),this.pivotValues=[],this.headerContent=[],this.valueContent=[];var e=[],t=[],i=this.values.length;this.getAggregatedHeaders(this.rows,this.columns,this.rMembers,this.cMembers,this.values),this.getHeaderData(this.cMembers,t,this.pivotValues,0,this.valueAxis?1:i),this.insertSubTotals(),this.getTableData(this.rMembers,e,t,0,this.pivotValues,i,this.rowGrandTotal?this.rowGrandTotal:this.rMembers[this.rMembers.length-1],this.columnGrandTotal?this.columnGrandTotal:this.cMembers[this.cMembers.length-1]),this.applyAdvancedAggregate(e,t,this.pivotValues),this.isEngineUpdated=!0,this.isEmptyDataAvail(this.rMembers,this.cMembers)},e.prototype.getAxisByFieldName=function(e){for(var t=0,i="";t<4&&""===i;){switch(t){case 0:i=this.getFieldByName(e,this.rows)?"row":"";break;case 1:i=this.getFieldByName(e,this.columns)?"column":""}t++}return i},e.prototype.getFieldByName=function(e,t){return new sf.data.DataManager({json:t}).executeLocal((new sf.data.Query).where("name","equal",e))[0]},e.prototype.updateHeadersCount=function(e,t,i,a,s,r){var n=0,o=a[i],l=!0;for(l="column"===t?!(this.showSubTotals&&this.showColumnSubTotals&&o)||o.showSubTotals:!(this.showSubTotals&&this.showRowSubTotals&&o)||o.showSubTotals;n<e.length;)"row"===t?this.rowCount=this.rowCount-("plus"===s?-(1===this.valueAxis?this.values.length:1):1===this.valueAxis?this.values.length:1):this.columnCount=this.columnCount-("plus"===s?-(1===this.valueAxis?1:this.values.length):1===this.valueAxis?1:this.values.length),e[n].members.length>0&&this.updateHeadersCount(e[n].members,t,i+1,a,s,!0),n++;"column"===t&&!l&&r&&(this.columnCount+="plus"===s?-this.colValuesLength:this.colValuesLength)},e.prototype.frameHeaderWithKeys=function(e){for(var t=Object.keys(e),i=0,a={};i<t.length;)a[t[i]]=e[t[i]],i++;return a},e.prototype.getSortedHeaders=function(e,t){var i=!(this.formatFields&&this.formatFields[e[0].valueSort.axis]&&this.formatFields[e[0].valueSort.axis].type),a=this.fieldList[e[0].valueSort.axis];if(i){if(a&&"number"==a.type&&e.length>0&&"string"==typeof e[0].actualText){for(var s=[],r=[],n=[],o=0;o<e.length;o++)isNaN(e[o].actualText.toString().charAt(0))?s.push(e[o]):""===e[o].actualText?n.push(e[o]):r.push(e[o]);return s.length>0&&(s="Ascending"===a.sort?s.sort((function(e,t){return e.actualText>t.actualText?1:t.actualText>e.actualText?-1:0})):"Descending"===a.sort?s.sort((function(e,t){return e.actualText<t.actualText?1:t.actualText<e.actualText?-1:0})):s),r.length>0&&(r="Ascending"===a.sort?r.sort((function(e,t){return Number(e.actualText.toString().match(/\d+/)[0])>Number(t.actualText.toString().match(/\d+/)[0])?1:Number(t.actualText.toString().match(/\d+/)[0])>Number(e.actualText.toString().match(/\d+/)[0])?-1:0})):"Descending"===a.sort?r.sort((function(e,t){return Number(e.actualText.toString().match(/\d+/)[0])<Number(t.actualText.toString().match(/\d+/)[0])?1:Number(t.actualText.toString().match(/\d+/)[0])<Number(e.actualText.toString().match(/\d+/)[0])?-1:0})):r),n.concat(r,s)}return"Ascending"===t?e.sort((function(e,t){return e.actualText>t.actualText?1:t.actualText>e.actualText?-1:0})):"Descending"===t?e.sort((function(e,t){return e.actualText<t.actualText?1:t.actualText<e.actualText?-1:0})):e}return"Ascending"===t?e.sort((function(e,t){return e.dateText>t.dateText?1:t.dateText>e.dateText?-1:0})):"Descending"===t?e.sort((function(e,t){return e.dateText<t.dateText?1:t.dateText<e.dateText?-1:0})):e},e.prototype.applyValueSorting=function(e,t){var i=!1;if(void 0!==e&&void 0!==t||(e=this.rMembers,t=this.cMembers,i=!0),this.enableValueSorting&&this.valueSortSettings.headerText&&""!==this.valueSortSettings.headerText&&this.values.length>0){for(var a=this.valueSortSettings.headerText.split(this.valueSortSettings.headerDelimiter),s="",r=void 0,n=void 0,o=void 0,l=0;l<this.values.length;l++){if(this.values[l].caption===a[a.length-1]){o=this.values[l].name;break}o=a[a.length-1]}if((1===this.values.length&&0===this.columns.length||this.values.length>1)&&o&&this.fieldList[o]){for(l=0;l<a.length-1;l++)s=""===s?a[l]:s+this.valueSortSettings.headerDelimiter+a[l];r=this.fieldList[o].index,n=this.fieldList[o].aggregateType}else{if(this.alwaysShowValueHeader&&1!==a.length)for(l=0;l<a.length-1;l++)s=""===s?a[l]:s+this.valueSortSettings.headerDelimiter+a[l];else s=this.valueSortSettings.headerText;r=this.fieldList[this.values[0].name].index,n=this.fieldList[this.values[0].name].aggregateType}var d=void 0;0===this.valueAxis?(d=this.getMember(t,s))&&(e=this.sortByValueRow(e,d,this.valueSortSettings.sortOrder,r,n)):(d=this.getMember(e,s))&&(t=this.sortByValueRow(t,d,this.valueSortSettings.sortOrder,r,n)),i&&(this.rMembers=e,this.cMembers=t,this.pageSettings&&(this.headerCollection.rowHeaders=this.rMembers,this.headerCollection.columnHeaders=this.cMembers))}return{rMembers:e,cMembers:t}},e.prototype.getMember=function(e,t){for(var i,a=e.length,s=0;s<a;s++){if(e[s].valueSort.levelName===t){i=e[s];break}if(e[s].members.length>0&&(i=this.getMember(e[s].members,t)),i)return i}return i},e.prototype.sortByValueRow=function(e,t,i,a,s){for(var r=[],n=0,o=e;n<o.length;n++){if("grand sum"===(u=o[n]).type)r.push({header:u});else{this.rawIndexObject={};var l=this.getAggregateValue(u.index,t.indexObject,a,s),d={fieldName:this.fields[a],row:u,column:t,value:l,cellSets:this.getCellSet(this.rawIndexObject),rowCellType:u.hasChild&&u.isDrilled?"subTotal":"grand sum"===u.type?"grandTotal":"value",columnCellType:t.hasChild&&t.isDrilled?"subTotal":"grand sum"===t.type?"grandTotal":"value",aggregateType:s,skipFormatting:!1};this.getValueCellInfo&&this.getValueCellInfo(d),l=d.value,this.rawIndexObject={},r.push({header:u,value:l})}}r.sort((function(e,t){return"Descending"===i?(t.value||"grand sum"===t.header.type?t.value:0)-(e.value||"grand sum"===e.header.type?e.value:0):(e.value||"grand sum"===e.header.type?e.value:0)-(t.value||"grand sum"===t.header.type?t.value:0)}));for(var p=0,h=e=r.map((function(e){return e.header}));p<h.length;p++){var u;(u=h[p]).members.length>0&&(u.members=this.sortByValueRow(u.members,t,i,a,s))}return e},e.prototype.insertAllMembersCommon=function(){this.rowGrandTotal=this.columnGrandTotal=null;var e=!(!this.showGrandTotals||!this.showRowGrandTotals)||!(this.rows.length>0),t=!(!this.showGrandTotals||!this.showColumnGrandTotals)||!(this.columns.length>0);this.isValueHasAdvancedAggregate?(this.insertAllMember(this.rMembers,this.filterMembers,"","row"),e&&(this.rowCount+=this.rowValuesLength),this.insertAllMember(this.cMembers,this.filterMembers,"","column"),t&&(this.columnCount+=this.colValuesLength)):(e?(this.insertAllMember(this.rMembers,this.filterMembers,"","row"),this.rowCount+=this.rowValuesLength):this.rowGrandTotal=this.insertAllMember([],this.filterMembers,"","row")[0],t?(this.insertAllMember(this.cMembers,this.filterMembers,"","column"),this.columnCount+=this.colValuesLength):this.columnGrandTotal=this.insertAllMember([],this.filterMembers,"","column")[0])},e.prototype.insertSubTotals=function(){for(var e=this.pivotValues.length,t=0;t<e;t++){var i=this.pivotValues[t];if(i)for(var a=void 0,s=1,r=void 0,n=i.length-1;n>0;n--){var o=i[n];if(o){a&&(a.colSpan=s,a.colIndex=a.colIndex-(s-1)),r={index:o.index,indexObject:o.indexObject},o.index=[],o.indexObject={},a=sf.base.extend({},o,null,!0),o.index=r.index,o.indexObject=r.indexObject;for(var l=t+1;this.pivotValues[l]&&!this.pivotValues[l][n];){this.pivotValues[t][n].isDrilled||(this.pivotValues[t][n].rowSpan=l-t+1,a.rowSpan=l-t+1);var d="sum"===o.type||"grand sum"===o.type?o.type:"sum";this.pivotValues[l][n]=this.headerContent[l][n]={type:d,formattedText:"sum"===o.type||"grand sum"===o.type?o.formattedText:o.formattedText+" Total",axis:"column",level:-1,colIndex:n,rowIndex:l,valueSort:o.valueSort},o.valueSort&&o.valueSort[this.valueSortSettings.headerText]&&(this.valueSortSettings.columnIndex=n);var p=!1;"grand sum"===d?(this.pivotValues[t][n].rowSpan=l-t+1,a.rowSpan=l-t+1):"sum"!==this.pivotValues[t][n].type&&this.pivotValues[t][n].isDrilled?(this.pivotValues[t+1][n].rowSpan=l-t,p=!0):this.pivotValues[l][n].rowSpan=-1,l>t+1&&("sum"===this.pivotValues[t][n].type||p)&&(this.pivotValues[l][n].rowSpan=-1),l++}s=1}else i[n]=this.headerContent[t][n]=sf.base.extend({},a,null,!0),i[n].index=this.headerContent[t][n].index=r.index,i[n].indexObject=this.headerContent[t][n].indexObject=r.indexObject,s++,i[n].colSpan=s,i[n].colIndex=i[n].colIndex-(s-1);1===n&&a&&(a.colSpan=s,a.colIndex=a.colIndex-(s-1))}}},e.prototype.frameDrillObject=function(){this.fieldDrillCollection={};for(var e=0;e<this.drilledMembers.length;e++)for(var t=this.drilledMembers[e],i=0;i<t.items.length;i++){var a=t.name+this.valueSortSettings.headerDelimiter+t.items[i].split(t.delimiter).join(this.valueSortSettings.headerDelimiter);this.fieldDrillCollection[a]=a}},e.prototype.getIndexedHeaders=function(e,t,i,a,s,r,n){var o=[];if(e){var l=e.length,d={},p=e[i].name,h=e[i],u=this.fieldList[p];if(sf.base.isNullOrUndefined(this.reportDataType)){this.reportDataType={};for(var c=0;c<this.dataSourceSettings.rows.length;c++)this.reportDataType[this.dataSourceSettings.rows[c].name]=this.dataSourceSettings.rows[c].dataType;for(c=0;c<this.dataSourceSettings.columns.length;c++)this.reportDataType[this.dataSourceSettings.columns[c].name]=this.dataSourceSettings.columns[c].dataType;for(c=0;c<this.dataSourceSettings.values.length;c++)this.reportDataType[this.dataSourceSettings.values[c].name]=this.dataSourceSettings.values[c].dataType}u.type=sf.base.isNullOrUndefined(this.reportDataType[u.id])?u.type:this.reportDataType[u.id];var g=!1,f=this.formatFields[p]&&["date","dateTime","time"].indexOf(this.formatFields[p].type)>-1,m=a.length<1&&i>0||h.showNoDataItems,v={};if(m){for(var b=Object.keys(u.members),S=0,y=b.length;S<y;S++)(this.showHeaderWhenEmpty||this.localeObj&&b[S]!==this.localeObj.getConstant("undefined"))&&(v[b[S]]=b[S]);a.length<1&&(g=!0,a.length=b.length)}for(S=0,y=a.length;S<y;S++){var C={};sf.base.isNullOrUndefined(e[i].showSubTotals)||e[i].showSubTotals||(C.showSubTotals=!1),C.hasChild=i<l-1,C.level=i,C.axis=s,C.colSpan=1;var w=g?u.members[Object.keys(v)[0]].ordinal:this.indexMatrix[a[S]][u.index],x=g?Object.keys(v)[0]:t[a[S]][this.fieldKeys[p]];if(!(sf.base.isNullOrUndefined(x)||this.localeObj&&x===this.localeObj.getConstant("undefined"))||this.showHeaderWhenEmpty){if(delete v[x],!m||!this.fieldFilterMem[p]||this.fieldFilterMem[p].memberObj[x]!==x){var T=f?{actualText:x,formattedText:u.dateMember[w-1].formattedText,dateText:u.dateMember[w-1].actualText}:{formattedText:null===x?this.localeObj?this.localeObj.getConstant("null"):String(x):void 0===x&&this.localeObj?p in this.groupingFields?this.localeObj.getConstant("groupOutOfRange"):this.localeObj.getConstant("undefined"):String(x),actualText:null===x?this.localeObj?this.localeObj.getConstant("null"):String(x):void 0===x?this.localeObj?p in this.groupingFields?this.localeObj.getConstant("groupOutOfRange"):this.localeObj.getConstant("undefined"):String(x):x};C.actualText=T.actualText,C.formattedText=T.formattedText,f&&(C.dateText=T.dateText);var M=!m||void 0!==this.filterPosObj[a[S]]&&!g;if(d&&d[w])M&&(d[w].index.push(a[S]),d[w].indexObject[a[S]]=a[S]);else{d[w]={index:[],indexObject:{}},C.index=d[w].index,C.indexObject=d[w].indexObject,M&&(C.index=d[w].index=[a[S]],d[w].indexObject[a[S]]=a[S],C.indexObject=d[w].indexObject),C.ordinal=w,C.valueSort={},C.valueSort.axis=p,0!==i?(C.valueSort.levelName=r+this.valueSortSettings.headerDelimiter+C.formattedText,C.valueSort[r+this.valueSortSettings.headerDelimiter+C.formattedText]=1):(C.valueSort[C.formattedText]=1,C.valueSort.levelName=C.formattedText);var D=C.valueSort.axis+this.valueSortSettings.headerDelimiter+C.valueSort.levelName;C.isDrilled=!(!n||!this.isValueFiltersAvail)||(C.hasChild&&this.fieldDrillCollection[D]?!this.isExpandAll:u.members[x].isDrilled),C.members=[],o.push(C)}m&&!g&&i>0&&S+1===a.length&&Object.keys(v).length>0&&(g=!0,y=Object.keys(v).length,S=-1)}}else m&&!g&&i>0&&S+1===a.length&&Object.keys(v).length>0&&(y=Object.keys(v).length,g=!0,S=-1)}for(var E=0,O=o.length;E<O;E++){this.frameHeaderObjectsCollection||("row"===s?this.rowCount+=this.rowValuesLength:this.columnCount+=this.colValuesLength);var P=null;if(o[E].valueSort&&o[E].valueSort.levelName&&(P=o[E].valueSort.levelName),r=P||o[E].formattedText,!this.showHeaderWhenEmpty&&l-1>i&&o[E].index&&o[E].index.length>0)if(m&&e[i+1]&&e[i+1].name&&Object.keys(this.fieldList[e[i+1].name].members).length>0)o[E].hasChild=!0;else{for(var N=o[E].index.length,F=0,I=0;I<N;I++){x=t[o[E].index[I]][this.fieldKeys[e[i+1].name]];(sf.base.isNullOrUndefined(x)||this.localeObj&&x===this.localeObj.getConstant("undefined"))&&F++}o[E].hasChild=F!==N}if(l-1>i&&o[E].isDrilled){this.columnCount-=this.showSubTotals&&this.showColumnSubTotals&&h.showSubTotals||"column"!==s?0:this.colValuesLength;var L=o[E].index;o[E].members=this.getIndexedHeaders(e,t,i+1,void 0===L?[]:L,s,r),this.frameHeaderObjectsCollection&&(this.headerObjectsCollection[r]=o[E].members)}}if(this.enableSort){if(f)return"Ascending"===u.sort?o.sort((function(e,t){return e.dateText>t.dateText?1:t.dateText>e.dateText?-1:0})):"Descending"===u.sort?o.sort((function(e,t){return e.dateText<t.dateText?1:t.dateText<e.dateText?-1:0})):o;if("number"===u.type&&o.length>0&&"string"==typeof o[0].actualText){var A=[],R=[],k=[];for(c=0;c<o.length;c++)isNaN(o[c].actualText.toString().charAt(0))?A.push(o[c]):""===o[c].actualText?k.push(o[c]):R.push(o[c]);return A.length>0&&(A="Ascending"===u.sort?A.sort((function(e,t){return e.actualText>t.actualText?1:t.actualText>e.actualText?-1:0})):"Descending"===u.sort?A.sort((function(e,t){return e.actualText<t.actualText?1:t.actualText<e.actualText?-1:0})):A),R.length>0&&(R="Ascending"===u.sort?R.sort((function(e,t){return Number(e.actualText.toString().match(/\d+/)[0])>Number(t.actualText.toString().match(/\d+/)[0])?1:Number(t.actualText.toString().match(/\d+/)[0])>Number(e.actualText.toString().match(/\d+/)[0])?-1:0})):"Descending"===u.sort?R.sort((function(e,t){return Number(e.actualText.toString().match(/\d+/)[0])<Number(t.actualText.toString().match(/\d+/)[0])?1:Number(t.actualText.toString().match(/\d+/)[0])<Number(e.actualText.toString().match(/\d+/)[0])?-1:0})):R),k.concat(R,A)}return"Ascending"===u.sort?o.sort((function(e,t){return e.actualText>t.actualText?1:t.actualText>e.actualText?-1:0})):"Descending"===u.sort?o.sort((function(e,t){return e.actualText<t.actualText?1:t.actualText<e.actualText?-1:0})):o}return o}return o},e.prototype.getOrderedIndex=function(e){for(var t={},i=0;i<e.length;i++)"grand sum"!==e[i].type&&(t[e[i].ordinal]=i);return t},e.prototype.insertPosition=function(e,t,i,a,s,r,n){var o=[],l=this.getOrderedIndex(n);if(e){for(var d={},p=e[i].name,h=this.fieldList[p],u=0,c=a.length;u<c;u++){var g={},f=this.indexMatrix[a[u]][h.index],m=n[l[f]],v=t[a[u]][this.fieldKeys[p]];v=null===v?this.localeObj?this.localeObj.getConstant("null"):String(v):v;var b=this.formatFields[p]&&["date","dateTime","time"].indexOf(this.formatFields[p].type)>-1?this.getFormattedValue(v,p):{formattedText:v.toString(),actualText:v.toString()};m&&m.formattedText===b.formattedText&&(d&&d[f]?(d[f].index.push(a[u]),d[f].indexObject[a[u]]=a[u]):(d[f]={index:[],indexObject:{}},m.index=d[f].index=[a[u]],d[f].indexObject[a[u]]=a[u],m.indexObject=d[f].indexObject,m.valueSort={},m.valueSort.axis=p,0!==i?(m.valueSort.levelName=r+this.valueSortSettings.headerDelimiter+m.formattedText,m.valueSort[r+this.valueSortSettings.headerDelimiter+m.formattedText]=1):(m.valueSort[m.formattedText]=1,m.valueSort.levelName=m.formattedText),g.members=[],o.push(g)))}for(var S=n.length-o.length;S>0;)o.push({members:[]}),S--;for(var y=0,C=o.length;y<C;y++)if(n[y].members.length>0){var w=null;n[y].valueSort&&n[y].valueSort.levelName&&(w=n[y].valueSort.levelName),r=w||n[y].formattedText,o[y].members=this.insertPosition(e,t,i+1,n[y].index,s,r,n[y].members)}return o}return o},e.prototype.insertTotalPosition=function(e){var t=e[e.length-1];if(t&&"grand sum"===t.type){t.index=this.filterMembers;for(var i=0,a=this.filterMembers.length;i<a;i++)t.indexObject[this.filterMembers[i]]=this.filterMembers[i]}return e},e.prototype.calculatePagingValues=function(){if(this.pageSettings){1===this.valueAxis?this.rowValuesLength=this.values.length:this.colValuesLength=this.values.length,this.memberCnt=-this.rowValuesLength,this.rowStartPos=(this.pageSettings.rowCurrentPage*this.pageSettings.rowSize-this.pageSettings.rowSize)*this.rowValuesLength;var e=this.rowStartPos+3*this.pageSettings.rowSize*this.rowValuesLength>this.rowCount?this.rowCount-3*this.pageSettings.rowSize*this.rowValuesLength:this.rowStartPos;e<0&&(e=this.rowStartPos=0,this.pageSettings.rowCurrentPage=1),this.rowFirstLvl=(this.rowStartPos-e)%this.pageSettings.rowSize,this.rowStartPos=e,this.endPos=this.rowStartPos+3*this.pageSettings.rowSize*this.rowValuesLength,this.endPos=this.endPos>this.rowCount?this.rowCount:this.endPos,this.rMembers=this.performSlicing(this.rMembers,[],this.rowStartPos,"row"),this.memberCnt=-this.colValuesLength,this.pageInLimit=!1,this.colHdrBufferCalculated=!1,this.colStartPos=(this.pageSettings.columnCurrentPage*this.pageSettings.columnSize-this.pageSettings.columnSize)*this.colValuesLength,(e=this.colStartPos+3*this.pageSettings.columnSize*this.colValuesLength>this.columnCount?this.columnCount-3*this.pageSettings.columnSize*this.colValuesLength:this.colStartPos)<0&&(e=this.colStartPos=0,this.pageSettings.columnCurrentPage=1),this.colFirstLvl=(this.colStartPos-e)%this.pageSettings.columnSize,this.colStartPos=e,this.endPos=this.colStartPos+3*this.pageSettings.columnSize*this.colValuesLength,this.endPos=this.endPos>this.columnCount?this.columnCount:this.endPos,this.cMembers=this.performSlicing(this.cMembers,[],this.colStartPos,"column"),this.memberCnt=-1,this.pageInLimit=!1,this.isValueHasAdvancedAggregate?("grand sum"!==this.rMembers[this.rMembers.length-1].type&&"grand sum"===this.headerCollection.rowHeaders[this.headerCollection.rowHeaders.length-1].type&&(this.rMembers.push(this.headerCollection.rowHeaders[this.headerCollection.rowHeaders.length-1]),this.removeRowGrandTotal=!0),"grand sum"!==this.cMembers[this.cMembers.length-1].type&&"grand sum"===this.headerCollection.columnHeaders[this.headerCollection.columnHeaders.length-1].type&&(this.cMembers.push(this.headerCollection.columnHeaders[this.headerCollection.columnHeaders.length-1]),this.removeColumnGrandTotal=!0)):(this.rowGrandTotal=this.rowGrandTotal?this.rowGrandTotal:this.headerCollection.rowHeaders[this.headerCollection.rowHeaders.length-1],this.columnGrandTotal=this.columnGrandTotal?this.columnGrandTotal:this.headerCollection.columnHeaders[this.headerCollection.columnHeaders.length-1])}},e.prototype.performSlicing=function(e,t,i,a){for(var s=0;e[s];){if(this.memberCnt+="column"===a?this.colValuesLength:this.rowValuesLength,i<=this.memberCnt&&this.endPos>=this.memberCnt&&!this.pageInLimit&&("column"===a?this.colFirstLvl=this.colFirstLvl+e[s].level:this.rowFirstLvl=this.rowFirstLvl+e[s].level,this.pageInLimit=!0),this.pageInLimit&&this.endPos<=this.memberCnt){if("column"!==a)break;if(0===e[s].members.length){if(this.colHdrBufferCalculated)break;this.colHdrBufferCalculated=!0,this.endPos+=e[s].level*this.colValuesLength}else if(this.colHdrBufferCalculated)break}if(t.push(e[s].members.length>0?this.removeChildMembers(e[s]):e[s]),e[s].members.length>0&&("column"===a&&(this.memberCnt-=this.showSubTotals&&this.showColumnSubTotals&&this.columnKeys[e[s].valueSort.axis].showSubTotals?0:this.colValuesLength),t[t.length-1].members=this.performSlicing(e[s].members,[],i,a)),this.pageInLimit||t.pop(),0===e[s].level&&this.pageInLimit&&this.endPos<=this.memberCnt)break;s++}return t},e.prototype.removeChildMembers=function(e){for(var t=Object.keys(e),i=0,a={};i<t.length;)a[t[i]]=e[t[i]],"members"===t[i]&&(a.members=[]),i++;return a},e.prototype.insertAllMember=function(e,t,i,a){var s=e.length;e[s]={hasChild:!1,index:t,level:0,axis:a,isDrilled:!1,indexObject:{},members:[],formattedText:"Grand Total",ordinal:s,type:"grand sum",valueSort:{}},e[s].valueSort[e[s].formattedText]=1,e[s].valueSort.levelName=e[s].formattedText;for(var r=0,n=t.length;r<n;r++)e[s].indexObject[t[r]]=t[r];return e},e.prototype.getTableData=function(e,t,i,a,s,r,n,o){for(var l=e.length,d=0;d<l;d++){t[a=s.length]=e[d];var p=a-Number(Object.keys(t)[0]),h=!t[a].members.length;if(e[d].colIndex=0,e[d].rowIndex=a,s[a]||(s[a]=[],this.valueContent[p]={}),s[a][0]=this.valueContent[p][0]=this.frameHeaderWithKeys(e[d]),this.valueAxis&&(this.isMutiMeasures||this.alwaysShowValueHeader)){var u=a,c=p,g=a;if(!e[d].hasChild||(sf.base.isNullOrUndefined(e[d].showSubTotals)||e[d].showSubTotals)&&this.showSubTotals&&this.showRowSubTotals){for(var f=0;f<r;f++){a++,p++;var m=this.values[f].caption?this.values[f].caption:this.values[f].name,v={axis:"row",actualText:this.values[f].name,formattedText:m,level:0,valueSort:{},colIndex:0,rowIndex:a,type:"value"};s[a]||(s[a]=[],this.valueContent[p]={},s[a][0]=this.valueContent[p][0]=v);var b=s[a][0].valueSort;b[s[a-f-1][0].valueSort.levelName+this.valueSortSettings.headerDelimiter+m]=1,b.levelName=s[a-f-1][0].valueSort.levelName+this.valueSortSettings.headerDelimiter+m;for(var S=0,y=1,C=i.length;S<C;++S)this.updateRowData(e,i,a,s,f,d,S,y,p,n,o),y=s[a].length,s[u][y-1]=this.valueContent[c][y-1]={axis:"value",actualText:"",colSpan:1,colIndex:y,formattedText:"",hasChild:!1}}g=a}else{for(S=0,y=1,C=i.length;S<C;++S)y=s[a].length,s[u][y]=this.valueContent[c][y]={axis:"value",actualText:"",colSpan:1,colIndex:y,formattedText:"",hasChild:!1};g=a+r}this.recursiveRowData(e,t,i,g,s,r,h,d,r,n,o)}else{for(S=0,y=1,C=i.length;S<C;++S)for(f=0;f<r;f++)this.updateRowData(e,i,a,s,f,d,S,y,p,n,o),y=s[a].length;this.recursiveRowData(e,t,i,a,s,r,h,d,0,n,o)}}},e.prototype.getAggregatedHeaders=function(e,t,i,a,s){this.selectedHeaders={selectedHeader:[],values:[]};for(var r=s.length,n=0;n<r;n++)switch(s[n].type){case"DifferenceFrom":case"PercentageOfDifferenceFrom":var o=void 0,l=void 0;this.selectedHeaders.values.push(s[n].name),s[n].baseField&&s[n].baseItem?(o=s[n].baseField,l=s[n].baseItem):this.valueAxis&&(this.isMutiMeasures||this.alwaysShowValueHeader)&&t.length>0?(o=t[0].name,l=Object.keys(this.fieldList[t[0].name].members)[0]):e.length>0&&(o=e[0].name,l=Object.keys(this.fieldList[e[0].name].members)[0]);for(var d=!1,p=0,h=e;p<h.length;p++){if(h[p].name===o){this.getAggregatedHeaderData(i,s[n].name,l,!1,"row",s[n].type,this.selectedHeaders.selectedHeader,n),d=!0;break}}if(!d)for(var u=0,c=t;u<c.length;u++){if(c[u].name===o){this.getAggregatedHeaderData(a,s[n].name,l,!1,"column",s[n].type,this.selectedHeaders.selectedHeader,n);break}}break;case"PercentageOfParentRowTotal":case"PercentageOfParentColumnTotal":this.selectedHeaders.values.push(s[n].name),this.getAggregatedHeaderData("PercentageOfParentRowTotal"===s[n].type?i:a,s[n].name,void 0,!1,"PercentageOfParentRowTotal"===s[n].type?"row":"column",s[n].type,this.selectedHeaders.selectedHeader,n);break;case"RunningTotals":this.selectedHeaders.values.push(s[n].name),this.getAggregatedHeaderData(this.valueAxis&&(this.isMutiMeasures||this.alwaysShowValueHeader)?a:i,s[n].name,void 0,!1,this.valueAxis&&(this.isMutiMeasures||this.alwaysShowValueHeader)?"column":"row",s[n].type,this.selectedHeaders.selectedHeader,n);break;case"PercentageOfParentTotal":o=void 0;this.selectedHeaders.values.push(s[n].name),s[n].baseField?o=s[n].baseField:this.valueAxis&&(this.isMutiMeasures||this.alwaysShowValueHeader)&&t.length>0?o=t[0].name:e.length>0&&(o=e[0].name);d=!1;for(var g=e.length,f=0;f<g;f++)if(e[f].name===o){this.getAggregatedHeaderData(i,s[n].name,void 0,!1,"row",s[n].type,this.selectedHeaders.selectedHeader,n,f),d=!0;break}if(!d)for(g=t.length,f=0;f<g;f++)if(t[f].name===o){this.getAggregatedHeaderData(a,s[n].name,void 0,!1,"column",s[n].type,this.selectedHeaders.selectedHeader,n,f);break}}},e.prototype.getAggregatedHeaderData=function(e,t,i,a,s,r,n,o,l){for(var d=0,p=e;d<p.length;d++){var h=p[d];switch(r){case"DifferenceFrom":case"PercentageOfDifferenceFrom":-1!==h.valueSort.levelName.toString().split(this.valueSortSettings.headerDelimiter).indexOf(i)?(n.push(this.updateSelectedHeaders(i,h.level,s,a,t,r,h.valueSort.levelName,a?[h]:e,o+1)),h.members.length>0&&this.getAggregatedHeaderData(h.members,t,i,!0,s,r,n[n.length-1].childMembers,o)):h.members.length>0&&this.getAggregatedHeaderData(h.members,t,i,!1,s,r,n,o);break;case"RunningTotals":case"PercentageOfParentRowTotal":case"PercentageOfParentColumnTotal":"grand sum"===h.type?n.push(this.updateSelectedHeaders(void 0,h.level,s,!1,t,r,h.valueSort.levelName,e,o+1)):h.members.length>0&&(n.push(this.updateSelectedHeaders(void 0,h.level,s,!1,t,r,h.valueSort.levelName,h.members,o+1)),this.getAggregatedHeaderData(h.members,t,void 0,!1,s,r,n,o));break;case"PercentageOfParentTotal":if("grand sum"!==h.type)if(h.level===l)if(h.members.length>0){if(a)for(var u=n[n.length-1].aggregateHeaders,c=0,g=h.members;c<g.length;c++){var f=g[c];u.push(f)}else{var m=sf.base.extend([],h.members,null,!0);n.push(this.updateSelectedHeaders(void 0,h.level,s,!1,t,r,h.valueSort.levelName,m,o+1)),(u=n[n.length-1].aggregateHeaders).push(h)}this.getAggregatedHeaderData(h.members,t,void 0,!0,s,r,n,o,l+1)}else a||n.push(this.updateSelectedHeaders(void 0,h.level,s,!1,t,r,h.valueSort.levelName,[h],o+1));else h.members.length>0&&this.getAggregatedHeaderData(h.members,t,void 0,!1,s,r,n,o,l)}}},e.prototype.updateSelectedHeaders=function(e,t,i,a,s,r,n,o,l){return{name:e,level:t,axis:i,isChild:a,value:s,type:r,uniqueName:n,aggregateHeaders:o,childMembers:[],valueCount:l}},e.prototype.applyAdvancedAggregate=function(e,t,i){if(this.aggregatedValueMatrix=[],this.selectedHeaders.values.length>0){for(var a={},s=[],r=!1,n=i.length,o=0;o<n;o++)if(void 0!==i[o]&&void 0!==i[o][0]){if(!r)for(var l=i[o].length,d=0;d<l;d++)"value"===i[o][d].axis&&-1!==this.selectedHeaders.values.indexOf(i[o][d].actualText)&&(s.push(d),r=!0);if(s.length>0&&"value"===i[o][s[0]].axis&&-1!==this.selectedHeaders.values.indexOf(i[o][s[0]].actualText))for(var p=0,h=s;p<h.length;p++){a[o+","+(g=h[p])]=[o,g]}}this.updateAggregates(e,t,i,this.selectedHeaders.selectedHeader,s,a);for(var u=0,c=Object.keys(a);u<c.length;u++){var g;i[a[g=c[u]][0]][a[g][1]].formattedText=this.selectedHeaders.selectedHeader.length>0?this.emptyCellTextContent:"#N/A",this.aggregatedValueMatrix[a[g][0]]||(this.aggregatedValueMatrix[a[g][0]]=[]),this.aggregatedValueMatrix[a[g][0]][a[g][1]]=0}this.updatePivotValues(!0)}},e.prototype.updateAggregates=function(e,t,i,a,s,r){for(var n=0,o=a;n<o.length;n++){var l=o[n],d=l.aggregateHeaders,p=l.value,h=this.valueAxis&&(this.isMutiMeasures||this.alwaysShowValueHeader)?l.valueCount:0,u=l.type,c=l.uniqueName,g="row"===l.axis,f=void 0,m=[],v=[],b=[],S=[],y=[],C=[];if(-1!==["DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentRowTotal","PercentageOfParentColumnTotal","PercentageOfParentTotal","RunningTotals"].indexOf(l.type))if(g){if("RunningTotals"!==l.type)for(var w=e.length,x=0;x<w;x++)if(void 0!==e[x]&&e[x].valueSort[c]){f=e[x],y=0===this.valueAxis||this.valueAxis&&i[x+h]&&i[x+h][0].actualText===p?i[x+h]:[];break}}else{for(var T=i.length,M=0;M<T&&(void 0!==i[M]&&void 0===i[M][0]);M++)b.push(i[M]);for(var D=b.length;D--;){var E=(A=b[D][s[0]]).actualText;-1===this.selectedHeaders.values.indexOf(E)&&(v=b[D],D=0)}if("RunningTotals"!==l.type){for(var O=v.length,P=0;P<O;P++){var N=!1;if(void 0!==v[P]&&v[P].valueSort[c]){f=v[P];var F=i.length;for(M=0;M<F;M++){void 0!==(A=i[M])&&void 0!==A[0]&&"value"===A[P].axis&&-1!==this.selectedHeaders.values.indexOf(A[P].actualText)&&(N=!0,C[M]=A[P],S.push(M))}if(N)break}}if(0===C.length&&0===S.length)for(O=v.length,P=0;P<O;P++){N=!1;if(void 0!==v[P]&&0===v[P].valueSort.levelName.indexOf(c)){f=v[P];for(var I=i.length,L=0;L<I;L++){var A;void 0!==(A=i[L])&&void 0!==A[0]&&"value"===A[P].axis&&-1!==this.selectedHeaders.values.indexOf(A[P].actualText)&&(N=!0,S.push(L))}if(N)break}}}}switch(l.type){case"DifferenceFrom":case"PercentageOfDifferenceFrom":var R=l.isChild;if(g){if(R)for(var k=c.split(this.valueSortSettings.headerDelimiter),j=(w=e.length,0);j<w;j++){if(void 0!==e[j])if(-1!==e[j].valueSort.levelName.split(this.valueSortSettings.headerDelimiter).indexOf(k[k.length-1])&&e[j].level===f.level)for(var q=0,V=s;q<V.length;q++){z=V[q];"value"===(re=i[j+h][z]).axis&&re.actualText===p&&(m.push([j+h,z]),r[j+h+","+z]&&delete r[j+h+","+z])}}else for(var B=0,_=d;B<_.length;B++){var H=_[B],w=e.length;for(x=0;x<w;x++)if(void 0!==e[x]&&e[x].valueSort[H.valueSort.levelName]&&e[x].level===f.level&&"grand sum"!==e[x].type)for(var U=0,G=s;U<G.length;U++){var z=G[U];"value"===(re=i[x+h][z]).axis&&re.actualText===p&&(m.push([x+h,z]),r[x+h+","+z]&&delete r[x+h+","+z])}}for(var W=0,Q=m;W<Q.length;W++){var Y=(re=i[(z=Q[W])[0]][z[1]]).actualValue-y[z[1]].actualValue;Y=isNaN(Y)||0===re.value&&0===y[z[1]].value?0:Y,this.aggregatedValueMatrix[z[0]]||(this.aggregatedValueMatrix[z[0]]=[]),"DifferenceFrom"===u?(this.aggregatedValueMatrix[z[0]][z[1]]=Y,re.formattedText=0===Y?this.emptyCellTextContent:this.getFormattedValue(Y,p).formattedText):(Y=0===y[z[1]].actualValue?0:Y/y[z[1]].actualValue,this.aggregatedValueMatrix[z[0]][z[1]]=Y,re.formattedText=re.showSubTotals?0!==Y?this.globalize.formatNumber(Y,{format:this.getPercentFormat(this.formatFields,re.actualText),maximumFractionDigits:2}):this.emptyCellTextContent:re.formattedText)}}else{if(R){k=c.split(this.valueSortSettings.headerDelimiter),O=v.length;for(var K=0;K<O;K++){N=!1;if(void 0!==v[K])if(-1!==v[K].valueSort.levelName.split(this.valueSortSettings.headerDelimiter).indexOf(k[k.length-1])&&v[K].level===f.level){for(var J=0,X=S;J<X.length;J++){"value"===(re=i[z=X[J]][K]).axis&&re.actualText===p&&(N=!0,m.push([z,K]),r[z+","+K]&&delete r[z+","+K])}if(N)break}}}else for(var Z=0,$=d;Z<$.length;Z++){H=$[Z];var O=v.length;for(P=0;P<O;P++){var N=!1;if(void 0!==v[P]&&v[P].valueSort[H.valueSort.levelName]&&v[P].level===f.level&&"grand sum"!==v[P].type){for(var ee=0,te=S;ee<te.length;ee++){"value"===(re=i[z=te[ee]][P]).axis&&re.actualText===p&&(N=!0,m.push([z,P]),r[z+","+P]&&delete r[z+","+P])}if(N)break}}}var ie=void 0;0===C.length&&(ie=this.getSelectedColumn(l.uniqueName,t));for(var ae=0,se=m;ae<se.length;ae++){var re=i[(z=se[ae])[0]][z[1]],ne=0;if(0===C.length){var oe=this.getSelectedRow(re.rowHeaders,e);ne=this.getAggregateValue(oe.index,ie.indexObject,this.fieldList[p].index,l.type)}else ne=C[z[0]].value;Y=re.value-ne;Y=isNaN(Y)?0:Y,this.aggregatedValueMatrix[z[0]]||(this.aggregatedValueMatrix[z[0]]=[]),"DifferenceFrom"===u?(re.formattedText=0===Y?this.emptyCellTextContent:this.getFormattedValue(Y,p).formattedText,this.aggregatedValueMatrix[z[0]][z[1]]=Y):(Y=0===C[z[0]].value?0:Y/C[z[0]].value,re.formattedText=0!==Y?this.globalize.formatNumber(Y,{format:this.getPercentFormat(this.formatFields,re.actualText),maximumFractionDigits:2}):this.emptyCellTextContent,this.aggregatedValueMatrix[z[0]][z[1]]=Y)}}l.childMembers.length>0&&this.updateAggregates(e,t,i,l.childMembers,s,r);break;case"PercentageOfParentRowTotal":case"PercentageOfParentColumnTotal":case"PercentageOfParentTotal":if(g){for(var le=0,de=d;le<de.length;le++)for(H=de[le],w=e.length,M=0;M<w;M++)if(void 0!==e[M]&&e[M].valueSort[H.valueSort.levelName]&&e[M].level===H.level)for(var pe=0,he=s;pe<he.length;pe++){z=he[pe];"value"===(re=i[M+h][z]).axis&&re.actualText===p&&(m.push([M+h,z]),r[M+h+","+z]&&delete r[M+h+","+z])}for(var ue=0,ce=m;ue<ce.length;ue++){re=i[(M=ce[ue])[0]][M[1]];var ge=0;ge=0===y.length&&f?this.getAggregateValue(f.index,t[M[1]-1].indexObject,this.fieldList[p].index,l.type):y[M[1]].actualValue;Y=re.value/ge;Y=isNaN(Y)?0:Y,re.formattedText=re.showSubTotals?0!==Y?this.globalize.formatNumber(Y,{format:this.getPercentFormat(this.formatFields,re.actualText),maximumFractionDigits:2}):this.emptyCellTextContent:re.formattedText,this.aggregatedValueMatrix[M[0]]||(this.aggregatedValueMatrix[M[0]]=[]),this.aggregatedValueMatrix[M[0]][M[1]]=Y}}else{for(var fe=0,me=d;fe<me.length;fe++)for(H=me[fe],O=v.length,L=0;L<O;L++){N=!1;if(void 0!==v[L]&&v[L].valueSort[H.valueSort.levelName]){for(var ve=0,be=S;ve<be.length;ve++){"value"===(re=i[z=be[ve]][L]).axis&&re.actualText===p&&(N=!0,m.push([z,L]),r[z+","+L]&&delete r[z+","+L])}if(N)break}}var Se=void 0;0===C.length&&(Se=this.getSelectedColumn(l.uniqueName,t));for(var ye=0,Ce=m;ye<Ce.length;ye++){re=i[(M=Ce[ye])[0]][M[1]];var we=0;if(0===C.length){oe=this.getSelectedRow(re.rowHeaders,e);we=this.getAggregateValue(oe.index,Se.indexObject,this.fieldList[p].index,l.type)}else we=C[M[0]].value;var xe=re.value/we;xe=isNaN(xe)?0:xe,re.formattedText=0!==xe?this.globalize.formatNumber(xe,{format:this.getPercentFormat(this.formatFields,re.actualText),maximumFractionDigits:2}):this.emptyCellTextContent,this.aggregatedValueMatrix[M[0]]||(this.aggregatedValueMatrix[M[0]]=[]),this.aggregatedValueMatrix[M[0]][M[1]]=xe}}break;case"RunningTotals":if(g)for(var Te=0,Me=s;Te<Me.length;Te++){z=Me[Te],Y=0;for(var De=0,Ee=d;De<Ee.length;De++)for(H=Ee[De],w=e.length,j=0;j<w;j++)if(void 0!==e[j]){re=i[j+h][z];if(void 0!==e[j]&&e[j].valueSort[H.valueSort.levelName]&&e[j].level===H.level&&"value"===re.axis&&re.actualText===p){"grand sum"!==e[j].type&&(Y+=re.showSubTotals||!sf.base.isNullOrUndefined(re.actualValue)&&isNaN(re.actualValue)?re.value:re.actualValue,re.formattedText=re.showSubTotals?0===Y&&re.actualValue&&0!==re.actualValue?"":this.getFormattedValue(Y,p).formattedText:re.formattedText,this.aggregatedValueMatrix[j+h]||(this.aggregatedValueMatrix[j+h]=[]),this.aggregatedValueMatrix[j+h][z]=Y),r[j+h+","+z]&&delete r[j+h+","+z];break}}}else for(w=e.length,x=0;x<w;x++)if(void 0!==e[x]){Y=0;for(var Oe=0,Pe=d;Oe<Pe.length;Oe++)for(H=Pe[Oe],O=v.length,P=0;P<O;P++){re=i[x+h][P];if(void 0!==v[P]&&v[P].valueSort[H.valueSort.levelName]&&"value"===re.axis&&re.actualText===p){"grand sum"!==v[P].type&&(Y+=re.value,re.formattedText=this.getFormattedValue(Y,p).formattedText,this.aggregatedValueMatrix[x+h]||(this.aggregatedValueMatrix[x+h]=[]),this.aggregatedValueMatrix[x+h][P]=Y),r[x+h+","+P]&&delete r[x+h+","+P];break}}}}}},e.prototype.getSelectedColumn=function(e,t){for(var i={axis:"column",index:[],indexObject:{}},a=0,s=t;a<s.length;a++){var r=s[a];r&&r.valueSort&&0===r.valueSort.levelName.indexOf(e)&&(i.index=i.index.concat(r.index).sort((function(e,t){return e-t})),i.indexObject=n({},i.indexObject,r.indexObject))}return i},e.prototype.getSelectedRow=function(e,t){for(var i=0,a=t;i<a.length;i++){var s=a[i];if(s){if(s.valueSort&&s.valueSort.levelName===e)return s;if(""===e&&"grand sum"===s.type)return s}}return null},e.prototype.recursiveRowData=function(e,t,i,a,s,r,n,o,l,d,p){n||this.getTableData(t[a-l].members,t,i,a,s,r,d,p),this.pageSettings||(t[a-l].members=[])},e.prototype.updateRowData=function(e,t,i,a,s,r,n,o,l,d,p){var h=this.fieldList[this.values[s].name].index,u=this.fieldList[this.values[s].name].aggregateType,c=this.values[s].name,g=[],f={},m=0,v=0;switch(u){case"Index":for(var b=["cVal","rTotalVal","cTotalVal","gTotalVal"],S=0,y=0,C=g=[[e[r],t[n]],[e[r],p],[d,t[n]],[d,p]];y<C.length;y++){var w=C[y];f[b[S]]=this.getAggregateValue(w[0].index,w[1].indexObject,h,u),S++}var x=f.cVal*f.gTotalVal/(f.rTotalVal*f.cTotalVal);m=!(e[r].members.length>0)||(sf.base.isNullOrUndefined(e[r].showSubTotals)||e[r].showSubTotals)&&this.showRowSubTotals&&this.showSubTotals?sf.base.isNullOrUndefined(f.cVal)?f.cVal:isNaN(x)?0:x:void 0,v=sf.base.isNullOrUndefined(f.cVal)?f.cVal:isNaN(x)?0:x;break;case"PercentageOfGrandTotal":case"PercentageOfColumnTotal":case"PercentageOfRowTotal":(g=[[e[r],t[n]]]).push("PercentageOfGrandTotal"===u?[d,p]:"PercentageOfColumnTotal"===u?[d,t[n]]:[e[r],p]);b=["cVal","gTotalVal"],S=0;for(var T=0,M=g;T<M.length;T++){w=M[T];f[b[S]]=this.getAggregateValue(w[0].index,w[1].indexObject,h,u),S++}var D=f.cVal/f.gTotalVal;m=!(e[r].members.length>0)||(sf.base.isNullOrUndefined(e[r].showSubTotals)||e[r].showSubTotals)&&this.showSubTotals&&this.showRowSubTotals?sf.base.isNullOrUndefined(f.cVal)?f.cVal:isNaN(D)?0:D:void 0,v=sf.base.isNullOrUndefined(f.cVal)?f.cVal:isNaN(D)?0:D;break;default:var E=this.getAggregateValue(e[r].index,t[n].indexObject,h,u);m=!(e[r].members.length>0)||(sf.base.isNullOrUndefined(e[r].showSubTotals)||e[r].showSubTotals)&&this.showSubTotals&&this.showRowSubTotals?E:void 0,v=E}var O={fieldName:this.values[s].name,row:e[r],column:t[n],value:m,cellSets:this.getCellSet(this.rawIndexObject),rowCellType:e[r].hasChild&&e[r].isDrilled?"subTotal":"grand sum"===e[r].type?"grandTotal":"value",columnCellType:t[n].hasChild&&t[n].isDrilled?"subTotal":"grand sum"===t[n].type?"grandTotal":"value",aggregateType:u,skipFormatting:!1};this.getValueCellInfo&&this.getValueCellInfo(O),m=O.value;var P=e[r].hasChild||t[n].hasChild||"grand sum"===e[r].type||"grand sum"===t[n].type,N="grand sum"===e[r].type||"grand sum"===t[n].type,F=e[r].members.length>0&&(!sf.base.isNullOrUndefined(e[r].showSubTotals)&&!e[r].showSubTotals||!this.showSubTotals||!this.showRowSubTotals),I=F?"":void 0===m?this.emptyCellTextContent:"Count"===u||"DistinctCount"===u?m.toLocaleString():this.getFormattedValue(m,c).formattedText;!isNaN(m)&&!sf.base.isNullOrUndefined(m)&&["PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal"].indexOf(u)>=0?I=this.globalize.formatNumber(m,{format:this.getPercentFormat(this.formatFields,O.fieldName),maximumFractionDigits:2}):F||!isNaN(m)||sf.base.isNullOrUndefined(m)||-1===["PopulationStDev","SampleStDev","PopulationVar","SampleVar"].indexOf(u)||(I="#DIV/0!"),I=O.skipFormatting?sf.base.isNullOrUndefined(m)?this.emptyCellTextContent:m.toString():I,a[i][o]=this.valueContent[l][o]={axis:"value",actualText:c,indexObject:this.isDrillThrough?this.rawIndexObject:{},rowHeaders:"grand sum"===e[r].type?"":e[r].valueSort.levelName,columnHeaders:"grand sum"===t[n].type?"":t[n].valueSort.levelName,formattedText:I,value:sf.base.isNullOrUndefined(m)?0:m,actualValue:sf.base.isNullOrUndefined(v)?0:v,rowIndex:i,colIndex:o,isSum:P,isGrandSum:N,showSubTotals:!F},this.rawIndexObject={}},e.prototype.getCellSet=function(e){for(var t=[],i=0,a=Object.keys(e);i<a.length;i++){var s=a[i];this.data[parseInt(s,10)]&&t.push(this.data[parseInt(s,10)])}return t},e.prototype.getHeaderData=function(e,t,i,a,s){for(var r=e.length,n=this.columns.length,o=this.valueSortSettings.headerText,l=0;l<r;l++){e[l].members.length&&this.getHeaderData(e[l].members,t,i,a,s);var d=!0;(sf.base.isNullOrUndefined(e[l].showSubTotals)||e[l].showSubTotals)&&this.showSubTotals&&this.showColumnSubTotals?t[a=t.length]=this.frameHeaderWithKeys(e[l]):(e[l].members.length>0?(this.removeCount++,d=!1):t[t.length]=this.frameHeaderWithKeys(e[l]),a=t.length-1);var p=e[l].level;e[l].rowIndex=p,e[l].colIndex=a*s+s,i[p]||(i[p]=[],this.headerContent[p]={}),i[p][a*s+s]=this.headerContent[p][a*s+s]=this.frameHeaderWithKeys(e[l]);var h=0===this.columns.length&&1===this.values.length;if((this.isMutiMeasures||this.alwaysShowValueHeader||h)&&!this.valueAxis&&d)for(var u=0;u<s;u++){var c=this.values[u].caption?this.values[u].caption:this.values[u].name,g={axis:"column",actualText:this.values[u].name,formattedText:c,level:0,valueSort:{},colIndex:a*s+1+u,rowIndex:n};i[n]||(i[n]=[],this.headerContent[n]={}),i[n][a*s+1+u]=this.headerContent[n][a*s+1+u]=g;var f=i[n][a*s+1+u].valueSort;f[e[l].valueSort.levelName+this.valueSortSettings.headerDelimiter+c]=1,f.levelName=e[l].valueSort.levelName+this.valueSortSettings.headerDelimiter+c,f&&f[o]&&(this.valueSortSettings.columnIndex=a*s+1+u)}else e[l].valueSort&&e[l].valueSort[o]&&(this.valueSortSettings.columnIndex=a*s+1);this.pageSettings||(t[a].members=[])}},e.prototype.getAggregateValue=function(e,t,i,a){e.length;var s=0,r=0,n=0,o=!0,l=!1;switch(a.toLowerCase()){case"median":for(var d=[],p=0;void 0!==e[s];)void 0!==t[e[s]]&&(l=!0,this.rawIndexObject[e[s]]=e[s],sf.base.isNullOrUndefined(this.valueMatrix[e[s]][i])||d.push(this.valueMatrix[e[s]][i])),s++;var h=d.length;h>0&&(d.sort((function(e,t){return e-t})),r=h%2==0?(d[p=h/2<=1?0:h/2-1]+d[p+1])/2:d[p=(h+1)/2<=1?0:(h+1)/2-1]);break;case"count":for(;void 0!==e[s];)void 0!==t[e[s]]&&(l=!0,this.rawIndexObject[e[s]]=e[s],r+=sf.base.isNullOrUndefined(this.valueMatrix[e[s]][i])?0:this.allowDataCompression?this.valueMatrix[e[s]][i]:1),s++;break;case"distinctcount":for(var u=[];void 0!==e[s];){if(void 0!==t[e[s]]){this.rawIndexObject[e[s]]=e[s],l=!0;var c=this.data[e[s]][this.fieldKeys[this.fields[i]]],g=void 0;sf.base.isNullOrUndefined(c)||(g=c.toString(),(0===u.length||u.length>0&&-1===u.indexOf(g))&&(r+=this.allowDataCompression&&"number"==typeof c?c:1,u.push(g)))}s++}break;case"product":for(;void 0!==e[s];){if(void 0!==t[e[s]]){this.rawIndexObject[e[s]]=e[s],l=!0;g=this.valueMatrix[e[s]][i];sf.base.isNullOrUndefined(g)?o&&(r=g):(r=o||sf.base.isNullOrUndefined(r)?1:r,r*=g),o=!1}s++}break;case"populationstdev":case"samplestdev":case"populationvar":case"samplevar":for(var f=0,m=0,v=[],b=0,S=0,y=0;void 0!==e[s];){if(void 0!==t[e[s]]){l=!0,this.rawIndexObject[e[s]]=e[s];g=this.valueMatrix[e[s]][i];sf.base.isNullOrUndefined(g)||(m+=g,v.push(g),f++)}s++}if(f>0){b=m/f;for(var C=0,w=v;C<w.length;C++){var x=w[C];y+=Math.pow(x-b,2)}r=0===(S=-1!==["populationstdev","samplestdev"].indexOf(a.toLowerCase())?Math.sqrt(y/("populationstdev"===a.toLowerCase()?f:f-1)):y/("populationvar"===a.toLowerCase()?f:f-1))?NaN:S}else r=m;break;case"min":var T=!0;for(r=void 0;void 0!==e[s];)void 0!==t[e[s]]&&void 0!==this.valueMatrix[e[s]][i]&&(l=!0,this.rawIndexObject[e[s]]=e[s],sf.base.isNullOrUndefined(r)&&sf.base.isNullOrUndefined(this.valueMatrix[e[s]][i])?r=this.valueMatrix[e[s]][i]:T?(r=this.valueMatrix[e[s]][i],T=!1):r=this.valueMatrix[e[s]][i]<r?this.valueMatrix[e[s]][i]:r),s++;break;case"max":for(var M=!0;void 0!==e[s];)void 0!==t[e[s]]&&void 0!==this.valueMatrix[e[s]][i]&&(l=!0,this.rawIndexObject[e[s]]=e[s],M?(r=this.valueMatrix[e[s]][i],M=!1):r=this.valueMatrix[e[s]][i]>r?this.valueMatrix[e[s]][i]:r),s++;break;case"calculatedfield":l=!0,this.rawIndexObject[e[s]]=e[s];var D=this.calculatedFields[this.fields[i]],E=D.formula,O={};if(this.calculatedFormulas[D.name])for(var P=this.calculatedFormulas[D.name],N=0,F=P.length;N<F;N++){var I=P[N],L=O[I.formula];if(void 0===L){var A=I.type;L=this.getAggregateValue(e,t,I.index,A),O[I.formula]=L}E=E.replace(I.formula,String(L))}r=(r=this.evaluate(E))===1/0||r===-1/0?1/0:void 0===r||isNaN(r)?void 0:JSON.parse(String(r));break;default:for(r=void 0;void 0!==e[s];){if(void 0!==t[e[s]]){l=!0,this.rawIndexObject[e[s]]=e[s];g=this.valueMatrix[e[s]][i];sf.base.isNullOrUndefined(r)&&sf.base.isNullOrUndefined(g)?r=g:(sf.base.isNullOrUndefined(r)&&(r=0),r+=sf.base.isNullOrUndefined(g)?0:g),sf.base.isNullOrUndefined(g)||n++}s++}}return a&&"avg"===a.toLowerCase()&&0!==r&&!sf.base.isNullOrUndefined(r)?r/n:l?r:void 0},e.prototype.evaluate=function(e){return Function('"use strict";return ('+e+")")()},e.prototype.getFormattedValue=function(e,t){var i=null===e?this.localeObj?this.localeObj.getConstant("null"):String(e):void 0===e?this.localeObj?t in this.groupingFields?this.localeObj.getConstant("groupOutOfRange"):this.localeObj.getConstant("undefined"):String(e):e,a={formattedText:i.toString(),actualText:i,dateText:i};if(this.formatFields[t]&&!sf.base.isNullOrUndefined(e))try{var s=this.formatFields[t].properties?this.formatFields[t].properties:this.formatFields[t],r=sf.base.extend({},s,null,!0);if(delete r.name,!r.minimumSignificantDigits&&r.minimumSignificantDigits<1&&delete r.minimumSignificantDigits,!r.maximumSignificantDigits&&r.maximumSignificantDigits<1&&delete r.maximumSignificantDigits,r.type)a.formattedText=this.dateFormatFunction[t].exactFormat(new Date(e)),a.actualText=e;else{if(delete r.type,r.format&&!this.formatRegex.test(r.format)){var n=r.format.match(this.customRegex),o=!0;sf.base.isNullOrUndefined(r.minimumFractionDigits)&&delete r.minimumFractionDigits,sf.base.isNullOrUndefined(r.maximumFractionDigits)&&delete r.maximumFractionDigits,sf.base.isNullOrUndefined(r.minimumIntegerDigits)&&delete r.minimumIntegerDigits,sf.base.isNullOrUndefined(n)&&(n=r.format.match(/^(('[^']+'|''|[^*@0])*)(\*.)?((([0#,]*[0,]*[0#]*)(\.[0#]*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@,.E])*)$/),delete r.useGrouping,o=!1);var l=n[6];o&&(r.useGrouping=-1!==l.indexOf(","));var d=n[5];sf.base.isBlazor()&&d&&-1!==d.indexOf(".")&&r.maximumFractionDigits&&delete r.maximumFractionDigits}a.formattedText=this.globalize.formatNumber(isNaN(Number(e))?e:Number(e),r),a.actualText=isNaN(Number(e))?e:Number(e),a.dateText=isNaN(Number(e))?e:Number(e)}"None"!==this.fieldList[t].sort&&r.type&&["date","dateTime","time"].indexOf(this.formatFields[t].type)>-1&&(a.dateText=this.dateFormatFunction[t].fullFormat(new Date(e))),this.fieldList[t].isCustomField&&(a.formattedText="NaN"===a.formattedText?i.toString():a.formattedText,a.dateText="NaN"===a.dateText?i.toString():a.dateText)}catch(e){if(!this.fieldList[t].isCustomField)throw e}finally{this.fieldList[t].isCustomField&&(a.formattedText=sf.base.isNullOrUndefined(a.formattedText)||"NaN"===a.formattedText?i.toString():a.formattedText,a.dateText=sf.base.isNullOrUndefined(a.dateText)||"NaN"===a.dateText?i.toString():a.dateText)}return a},e.prototype.powerFunction=function(e){if(e.indexOf("^")>-1){for(var t=[];e.indexOf("(")>-1;)e=e.replace(/(\([^\(\)]*\))/g,(function(e,i){return t.push(i),"~"+(t.length-1)}));for(t.push(e),e="~"+(t.length-1);e.indexOf("~")>-1;)e=e.replace(new RegExp("~(\\d+)","g"),(function(e,i){return t[i].replace(/(\w*)\^(\w*)/g,"Math.pow($1,$2)")}))}return e},e}(),l="initial-load",d="ui-update",p="content-ready",h="data-ready",u="e-pivotfieldlist",c="e-rtl",g="e-device",f="e-icons",m="e-collapse",v="e-expand",b="e-table",S="e-pivot-calc-input",y="e-flat",C="e-format",w="e-pivot-formula",x="e-menu-hide",T="e-input",M="e-movablescrollbar",D="e-cellselectionbackground",E="e-selectionbackground",O="e-remove-report",P="e-pivot-toolbar",N="e-pivotchart",F="e-pivotview-disable-icon",I="e-pivotview-select-icon",L=function(){function e(e){this.menuInfo=[],this.parent=e}return e.prototype.render=function(e,t){this.parentElement=t,this.openContextMenu(e)},e.prototype.openContextMenu=function(e){var t=this,i=e.target.parentElement.id;this.buttonElement=e.target.parentElement;var a="number"!==this.parent.engineModule.fieldList[i].type?1:0;this.summaryTypes=this.getMenuItem(a).slice();var s={cancel:!1,fieldName:i,aggregateTypes:this.summaryTypes};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger("aggregateMenuOpen",s,(function(i){if(!i.cancel){t.summaryTypes=i.aggregateTypes,t.createContextMenu(a),t.currentMenu=e.target;var s=t.currentMenu.getBoundingClientRect();t.parent.enableRtl?t.menuInfo[a].open(s.top+(window.scrollY||document.documentElement.scrollTop),s.left-105):t.menuInfo[a].open(s.top+(window.scrollY||document.documentElement.scrollTop),s.left)}}))},e.prototype.createContextMenu=function(e){var t=this,i=[];i[e]=[],this.menuInfo[e]&&!this.menuInfo[e].isDestroyed&&this.menuInfo[e].destroy();for(var a,s=[],r=0;r<this.summaryTypes.length;r++){var n=this.summaryTypes[r];e?["Count","DistinctCount"].indexOf(n)>-1&&s.indexOf(n)<0&&(i[e].push({text:this.parent.localeObj.getConstant(n),id:this.parent.element.id+"StringMenu_"+n}),s.push(n)):this.parent.getAllSummaryType().indexOf(n)>-1&&s.indexOf(n)<0&&(i[e].push({text:this.parent.localeObj.getConstant(n),id:this.parent.element.id+"_"+n}),s.push(n))}i[e].length>=7&&(i[e].splice(7),i[e].push({text:this.parent.localeObj.getConstant("MoreOption"),id:this.parent.element.id+"_MoreOption"})),a={items:i[e],enableRtl:this.parent.enableRtl,beforeOpen:this.beforeMenuOpen.bind(this,e),onClose:function(e){sf.base.select("#"+t.buttonElement.id,t.parentElement).focus()},select:this.selectOptionInContextMenu.bind(this)};var o=document.getElementById(this.parent.element.id+(e?"valueFieldStringContextMenu":"valueFieldContextMenu"));null!==o?o.innerHTML="":o=sf.base.createElement("ul",{id:this.parent.element.id+(e?"valueFieldStringContextMenu":"valueFieldContextMenu")}),this.parent.element.appendChild(o),this.menuInfo[e]=new sf.navigations.ContextMenu(a),this.menuInfo[e].isStringTemplate=!0,this.menuInfo[e].appendTo(o)},e.prototype.getMenuItem=function(e){for(var t=[],i=0;i<this.parent.aggregateTypes.length;i++){var a=this.parent.aggregateTypes[i];e?["Count","DistinctCount"].indexOf(a)>-1&&-1===t.indexOf(a)&&t.push(a):this.parent.getAllSummaryType().indexOf(a)>-1&&-1===t.indexOf(a)&&t.push(a)}return t},e.prototype.beforeMenuOpen=function(e,t){t.element.style.zIndex=(this.menuInfo[e].element.style.zIndex+3).toString(),t.element.style.display="inline"},e.prototype.createValueSettingsDialog=function(e,t,i){var a=this;this.parentElement=t;var s=sf.base.createElement("div",{id:this.parentElement.id+"_ValueDialog",className:"e-value-field-settings",attrs:{"data-field":e.id}});this.parentElement.appendChild(s),this.valueDialog=new sf.popups.Dialog({animationSettings:{effect:"Fade"},allowDragging:!0,header:this.parent.localeObj.getConstant("valueFieldSettings"),content:this.createFieldOptions(e,i),isModal:!0,visible:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,width:"auto",height:"auto",position:{X:"center",Y:"center"},buttons:[{click:this.updateValueSettings.bind(this),buttonModel:{cssClass:"e-ok-btn",content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:function(){a.valueDialog.hide()},buttonModel:{cssClass:"e-cancel-btn",content:this.parent.localeObj.getConstant("cancel")}}],closeOnEscape:"pivotfieldlist"!==this.parent.getModuleName()||"Popup"!==this.parent.renderMode,target:this.parentElement,overlayClick:function(){a.removeDialog()},close:this.removeDialog.bind(this)}),this.valueDialog.isStringTemplate=!0,this.valueDialog.appendTo(s)},e.prototype.createFieldOptions=function(e,t){var i=e.getAttribute("data-caption"),a=t&&"MoreOption"!==t?t:e.getAttribute("data-type"),s=e.getAttribute("data-basefield"),r=e.getAttribute("data-baseitem");a="undefined"!==a.toString()?a:"Sum";for(var n=[],o=this.parent.aggregateTypes,l=[],d=0;d<o.length;d++)this.parent.getAllSummaryType().indexOf(o[d])>-1&&l.indexOf(o[d])<0&&(n.push({value:o[d],text:this.parent.localeObj.getConstant(o[d])}),l.push(o[d]));var p=["DifferenceFrom","PercentageOfDifferenceFrom"],h=["DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentTotal"],u=sf.base.extend([],this.parent.dataSourceSettings.rows,null,!0);u=u.concat(this.parent.dataSourceSettings.columns);for(var c=[],g=[],f=0,m=u;f<m.length;f++){var v=m[f],b=v.name,S=v.caption?v.caption:v.name;c.push({value:b,text:S})}0===Object.keys(c).length?(c.push({value:"",text:""}),s="",g=[]):(s=s&&"undefined"!==s.toString()&&"null"!==s.toString()?s:c[0].value,g=Object.keys(this.parent.engineModule.fieldList["undefined"!==s.toString()?s:c[0].value].formattedMembers)),r="undefined"!==r.toString()?r:g[0];var y=sf.base.createElement("div",{className:"e-value-field-div-content",id:this.parentElement.id+"_field_div_content",attrs:{"data-type":a,"data-caption":i,"data-basefield":s,"data-baseitem":r}}),C=sf.base.createElement("div",{className:"e-field-name-text-wrapper"}),w=sf.base.createElement("div",{className:"e-field-option-wrapper"}),x=sf.base.createElement("div",{className:"e-type-option-wrapper"}),T=sf.base.createElement("div",{className:"e-base-field-option-wrapper"}),M=sf.base.createElement("div",{className:"e-base-item-option-wrapper"}),D=sf.base.createElement("div",{className:"e-field-name-title",innerHTML:this.parent.localeObj.getConstant("sourceName")+"&nbsp;"}),E=sf.base.createElement("div",{className:"e-field-name-content",innerHTML:e.id.toString()}),O=sf.base.createElement("div",{className:"e-type-option-text",innerHTML:this.parent.localeObj.getConstant("sourceCaption")}),P=sf.base.createElement("div",{className:"e-base-field-option-text",innerHTML:this.parent.localeObj.getConstant("summarizeValuesBy")}),N=sf.base.createElement("div",{className:"e-base-item-option-text",innerHTML:this.parent.localeObj.getConstant("baseField")}),F=sf.base.createElement("div",{className:"e-type-option-text",innerHTML:this.parent.localeObj.getConstant("baseItem")}),I=sf.base.createElement("div",{className:"e-caption-input-wrapper"}),L=sf.base.createElement("div",{id:this.parentElement.id+"_type_option"}),A=sf.base.createElement("div",{id:this.parentElement.id+"_base_field_option"}),R=sf.base.createElement("div",{id:this.parentElement.id+"_base_item_option"}),k=sf.base.createElement("input",{id:this.parentElement.id+"type_input_option",className:"e-caption-input-text",attrs:{type:"text"}});C.appendChild(D),C.appendChild(E),I.appendChild(O),I.appendChild(k),x.appendChild(P),T.appendChild(N),M.appendChild(F),x.appendChild(L),T.appendChild(A),M.appendChild(R),w.appendChild(C),w.appendChild(I),w.appendChild(x),w.appendChild(T),w.appendChild(M),y.appendChild(w);var j=this,q=new sf.dropdowns.DropDownList({dataSource:n,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text"},value:a,cssClass:"e-value-options",width:"100%",change:function(e){V.enabled=-1!==h.indexOf(e.value),B.enabled=-1!==p.indexOf(e.value),B.enabled&&1===B.dataSource.length&&(B.dataSource=g,B.dataBind())}});q.isStringTemplate=!0,q.appendTo(L);var V=new sf.dropdowns.DropDownList({dataSource:c,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text"},value:s,enabled:-1!==h.indexOf(a),cssClass:"e-value-options",width:"100%",change:function(e){g=Object.keys(j.parent.engineModule.fieldList[e.value].formattedMembers),B.dataSource=g,B.value=g[0],B.filterBarPlaceholder=j.parent.localeObj.getConstant("example")+" "+g[0],B.dataBind()}});V.isStringTemplate=!0,V.appendTo(A);var B=new sf.dropdowns.DropDownList({dataSource:[g[0]],enableRtl:this.parent.enableRtl,value:r,allowFiltering:!0,filterBarPlaceholder:this.parent.localeObj.getConstant("example")+" "+g[0],enabled:-1!==p.indexOf(a),cssClass:"e-filter-operator",width:"100%"});B.isStringTemplate=!0,B.appendTo(R);var _=new sf.inputs.MaskedTextBox({placeholder:"Enter field caption",enableRtl:this.parent.enableRtl,value:i,width:"100%"});return _.isStringTemplate=!0,_.appendTo(k),y},e.prototype.selectOptionInContextMenu=function(e){if(null!==e.item.text){var t=this.currentMenu.parentElement,i=e.item.id.split("_").pop();if("MoreOption"===i||"PercentageOfDifferenceFrom"===i||"PercentageOfParentTotal"===i||"DifferenceFrom"===i)this.createValueSettingsDialog(t,this.parentElement,i);else{var a=t.getAttribute("data-uid"),s=this.parent.dataSourceSettings.values,r=t.querySelector(".e-content"),n=e.item.text+" "+this.parent.localeObj.getConstant("of")+" "+this.parent.engineModule.fieldList[a].caption;r.innerHTML=n,r.setAttribute("title",n),t.setAttribute("data-type",i);for(var o=0;o<this.parent.dataSourceSettings.values.length;o++)if(this.parent.dataSourceSettings.values[o].name===a){var l=sf.base.extend({},s[o].properties?s[o].properties:s[o],null,!0);l.type=i,this.parent.engineModule.fieldList[a].aggregateType=i,s.splice(o,1,l),this.parent.lastAggregationInfo=l}this.updateDataSource()}}},e.prototype.updateDataSource=function(e){this.parent.allowDeferLayoutUpdate&&"pivotview"!==this.parent.getModuleName()?"pivotfieldlist"===this.parent.getModuleName()&&"Popup"===this.parent.renderMode?(this.parent.pivotGridModule.setProperties({dataSourceSettings:this.parent.dataSourceSettings.properties},!0),this.parent.pivotGridModule.notify(d,this),this.parent.pivotGridModule.engineModule=this.parent.engineModule):this.parent.triggerPopulateEvent():this.parent.updateDataSource(e)},e.prototype.updateValueSettings=function(){var e,t=this.valueDialog.element,i=sf.base.getInstance("#"+this.parentElement.id+"type_input_option",sf.inputs.MaskedTextBox),a=sf.base.getInstance("#"+this.parentElement.id+"_type_option",sf.dropdowns.DropDownList),s=sf.base.getInstance("#"+this.parentElement.id+"_base_field_option",sf.dropdowns.DropDownList),n=sf.base.getInstance("#"+this.parentElement.id+"_base_item_option",sf.dropdowns.DropDownList),o=t.getAttribute("data-field");if(this.parentElement.querySelector(".e-pivot-button")&&(e=this.parentElement.querySelector(".e-pivot-button."+o.replace(/[^A-Z0-9]/gi,""))),e){var l=e.querySelector(".e-content"),d=this.parent.localeObj.getConstant(a.value)+" "+this.parent.localeObj.getConstant("of")+" "+i.value;l.innerHTML=d,l.setAttribute("title",d),e.setAttribute("data-type",a.value),e.setAttribute("data-caption",i.value),e.setAttribute("data-basefield",s.value),e.setAttribute("data-baseitem",n.value)}var p=r.getFieldByName(o,this.parent.dataSourceSettings.values);(p=p.properties?p.properties:p).caption=i.value,p.type=a.value,p.baseField=s.value,p.baseItem=n.value,this.valueDialog.close(),this.parent.lastAggregationInfo=p,this.updateDataSource(!0)},e.prototype.removeDialog=function(){sf.base.select("#"+this.buttonElement.id,this.parentElement)&&sf.base.select("#"+this.buttonElement.id,this.parentElement).focus(),this.valueDialog&&!this.valueDialog.isDestroyed&&this.valueDialog.destroy(),document.getElementById(this.parentElement.id+"_ValueDialog")&&sf.base.remove(document.getElementById(this.parentElement.id+"_ValueDialog"))},e.prototype.destroy=function(){this.parent.isDestroyed||this.menuInfo&&(void 0===this.menuInfo[1]||this.menuInfo[1].isDestroyed||this.menuInfo[1].destroy(),void 0===this.menuInfo[0]||this.menuInfo[0].isDestroyed||this.menuInfo[0].destroy())},e}(),A=function(){function e(e){this.indentCollection={},this.colPos=0,this.lastSpan=0,this.lvlCollection={},this.hierarchyCollection={},this.lvlPosCollection={},this.hierarchyPosCollection={},this.position=0,this.measurePos=0,this.maxMeasurePos=0,this.hierarchyCount=0,this.actualText="",this.isInitial=!0,this.parent=e,this.resColWidth=this.parent.showGroupingBar&&this.parent.groupingBarModule?this.parent.isAdaptive?180:250:this.parent.isAdaptive?140:200,this.engine="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,this.gridSettings=e.gridSettings,this.formatList=this.getFormatList(),this.aggMenu=new L(this.parent)}return e.prototype.render=function(){var e=this.parent,t="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule;if(this.parent.gridHeaderCellInfo=[],this.parent.gridCellCollection={},this.injectGridModules(e),this.rowStartPos=this.getRowStartPos(),this.parent.grid&&this.parent.grid.element&&this.parent.element.querySelector(".e-grid")){if(t.isEngineUpdated?(this.parent.enableValueSorting&&(t.valueContent=this.frameDataSource("value")),t.isEngineUpdated=!1):(t.headerContent=this.frameDataSource("header"),t.valueContent=this.frameDataSource("value")),this.parent.grid.setProperties({columns:this.frameStackedHeaders(),dataSource:("olap"===this.parent.dataType||e.dataSourceSettings.values.length>0)&&!this.engine.isEmptyData?t.valueContent:this.frameDataSource("value")},!0),"auto"===this.parent.grid.height){var i=this.parent.element.querySelector(".e-movablecontent").offsetHeight,a=this.parent.grid.dataSource.length*this.parent.gridSettings.rowHeight;i>50&&i<a&&this.parent.grid.contentModule.setHeightToContent(a)}this.parent.grid.notify("datasource-modified",{}),this.parent.isScrolling&&(this.parent.resizeInfo={}),this.parent.grid.refreshColumns(),this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector(".e-grouping-bar")&&this.parent.groupingBarModule.setGridRowWidth(),this.parent.element.querySelector(".e-movablecontent").querySelector("colGroup").innerHTML=this.parent.grid.getHeaderContent().querySelector(".e-movableheader").querySelector("colgroup").innerHTML,this.parent.grid.width=this.calculateGridWidth(),!this.gridSettings.allowAutoResizing&&this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector(".e-grouping-bar")&&this.parent.groupingBarModule.refreshUI(),this.parent.isScrolling||this.calculateGridHeight(!0)}else this.parent.element.innerHTML="",this.bindGrid(this.parent,!!this.engine.isEmptyData),this.parent.element.appendChild(sf.base.createElement("div",{id:this.parent.element.id+"_grid"})),this.parent.grid.isStringTemplate=!0,this.parent.grid.appendTo("#"+this.parent.element.id+"_grid");this.parent.grid.on(sf.grids.headerRefreshed,this.refreshHeader,this)},e.prototype.refreshHeader=function(){if(this.parent.enableVirtualization){var e=this.parent.element.querySelector(".e-movableheader"),t=this.parent.element.querySelector(".e-movablecontent"),i=t.querySelector(".e-virtualtrack");this.parent.virtualHeaderDiv=e.querySelector(".e-virtualtrack"),e.querySelector(".e-virtualtrack")?sf.base.remove(e.querySelector(".e-virtualtrack")):this.parent.virtualHeaderDiv=sf.base.createElement("div",{className:"e-virtualtrack"}),e.appendChild(this.parent.virtualHeaderDiv),i&&sf.base.setStyleAttribute(this.parent.virtualHeaderDiv,{height:0,width:i.style.width}),sf.base.setStyleAttribute(e.querySelector(".e-table"),{transform:t.querySelector(".e-table").style.transform.split(",")[0]+",0px)"}),e.scrollLeft=t.parentElement.parentElement.querySelector("."+M).scrollLeft}},e.prototype.bindGrid=function(e,t){if(this.injectGridModules(e),this.parent.grid=new sf.grids.Grid({frozenColumns:1,frozenRows:0,enableHover:!1,dataSource:t?this.frameEmptyData():this.frameDataSource("value"),columns:t?this.frameEmptyColumns():this.frameStackedHeaders(),height:t?"auto":this.calculateGridHeight(),width:t?this.gridSettings.allowAutoResizing?this.parent.width:400:this.calculateGridWidth(),locale:e.locale,enableRtl:e.enableRtl,allowExcelExport:e.allowExcelExport,allowPdfExport:e.allowPdfExport,allowResizing:this.gridSettings.allowResizing,allowTextWrap:this.gridSettings.allowTextWrap,allowReordering:!this.parent.showGroupingBar&&this.gridSettings.allowReordering,allowSelection:this.gridSettings.allowSelection,contextMenuItems:this.gridSettings.contextMenuItems,selectedRowIndex:this.gridSettings.selectedRowIndex,selectionSettings:this.gridSettings.selectionSettings,textWrapSettings:this.gridSettings.textWrapSettings,printMode:this.gridSettings.printMode,rowHeight:this.gridSettings.rowHeight,gridLines:this.gridSettings.gridLines,contextMenuClick:this.contextMenuClick.bind(this),contextMenuOpen:this.contextMenuOpen.bind(this),beforeCopy:this.gridSettings.beforeCopy?this.gridSettings.beforeCopy.bind(this.parent):void 0,beforePrint:this.gridSettings.beforePrint?this.gridSettings.beforePrint.bind(this.parent):void 0,printComplete:this.gridSettings.printComplete?this.gridSettings.printComplete.bind(this.parent):void 0,rowSelecting:this.gridSettings.rowSelecting?this.gridSettings.rowSelecting.bind(this.parent):void 0,rowSelected:this.rowSelected.bind(this),rowDeselecting:this.gridSettings.rowDeselecting?this.gridSettings.rowDeselecting.bind(this.parent):void 0,rowDeselected:this.rowDeselected.bind(this),cellSelecting:this.gridSettings.cellSelecting?this.gridSettings.cellSelecting.bind(this.parent):void 0,cellSelected:this.cellSelected.bind(this),cellDeselecting:this.gridSettings.cellDeselecting?this.gridSettings.cellDeselecting.bind(this.parent):void 0,cellDeselected:this.cellDeselected.bind(this),resizeStart:this.gridSettings.resizeStart?this.gridSettings.resizeStart.bind(this.parent):void 0,columnDragStart:this.gridSettings.columnDragStart?this.gridSettings.columnDragStart.bind(this):void 0,columnDrag:this.gridSettings.columnDrag?this.gridSettings.columnDrag.bind(this):void 0,columnDrop:this.gridSettings.columnDrop?this.gridSettings.columnDrop.bind(this):void 0,beforeExcelExport:this.beforeExcelExport.bind(this),resizing:this.setGroupWidth.bind(this),resizeStop:this.onResizeStop.bind(this),queryCellInfo:this.queryCellInfo.bind(this),dataBound:this.dataBound.bind(this),headerCellInfo:this.headerCellInfo.bind(this),excelHeaderQueryCellInfo:this.excelHeaderQueryCellInfo.bind(this),pdfHeaderQueryCellInfo:this.pdfHeaderQueryCellInfo.bind(this),excelQueryCellInfo:this.excelQueryCellInfo.bind(this),pdfQueryCellInfo:this.pdfQueryCellInfo.bind(this),beforePdfExport:this.gridSettings.beforePdfExport?this.gridSettings.beforePdfExport.bind(this):void 0,pdfExportComplete:this.pdfExportComplete.bind(this),excelExportComplete:this.excelExportComplete.bind(this)}),sf.base.isBlazor()){this.parent.grid.isJsComponent=!0}this.parent.grid.on("header-refreshed",this.headerRefreshed.bind(this)),this.parent.grid.on("export-DataBound",this.excelDataBound.bind(this))},e.prototype.headerRefreshed=function(e){this.parent.lastGridSettings&&Object.keys(this.parent.lastGridSettings).indexOf("allowResizing")>-1&&(this.parent.lastGridSettings=void 0,this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector(".e-grouping-bar")&&this.parent.groupingBarModule.setGridRowWidth())},e.prototype.beforeExcelExport=function(e){sf.base.isNullOrUndefined(e.gridObject.columns)||sf.base.isNullOrUndefined(this.parent.pivotColumns)||(e.gridObject.columns[e.gridObject.columns.length-1].width=this.parent.pivotColumns[this.parent.pivotColumns.length-1].width),this.parent.trigger("beforeExcelExport",e)},e.prototype.rowSelected=function(e){this.parent.renderModule.selected(),this.parent.trigger("rowSelected",e)},e.prototype.rowDeselected=function(e){this.parent.renderModule.selected(),this.parent.trigger("rowDeselected",e)},e.prototype.cellSelected=function(e){this.parent.rowRangeSelection.enable?(this.parent.grid.selectionModule.selectRowsByRange(this.parent.rowRangeSelection.startIndex,this.parent.rowRangeSelection.endIndex),this.parent.rowRangeSelection.enable=!1):(this.parent.renderModule.selected(),this.parent.trigger("selected",e))},e.prototype.cellSelecting=function(e){this.parent.trigger("cellSelecting",e)},e.prototype.cellDeselected=function(e){this.parent.renderModule.selected(),this.parent.trigger("cellDeselected",e)},e.prototype.queryCellInfo=function(e){this.parent.renderModule.rowCellBoundEvent(e)},e.prototype.headerCellInfo=function(e){this.parent.renderModule.columnCellBoundEvent(e)},e.prototype.excelHeaderQueryCellInfo=function(e){this.parent.renderModule.excelColumnEvent(e)},e.prototype.pdfQueryCellInfo=function(e){this.parent.renderModule.pdfRowEvent(e)},e.prototype.excelQueryCellInfo=function(e){this.parent.renderModule.excelRowEvent(e)},e.prototype.pdfHeaderQueryCellInfo=function(e){this.parent.renderModule.pdfColumnEvent(e)},e.prototype.pdfExportComplete=function(e){void 0!==this.parent.lastColumn&&"auto"!==this.parent.lastColumn.width&&(this.parent.lastColumn.width="auto",this.parent.lastColumn=void 0)},e.prototype.excelExportComplete=function(e){void 0!==this.parent.lastColumn&&"auto"!==this.parent.lastColumn.width&&(this.parent.lastColumn.width="auto",this.parent.lastColumn=void 0)},e.prototype.dataBound=function(e){if(this.parent.cellTemplate&&!sf.base.isBlazor()){for(var t=0,i=this.parent.gridHeaderCellInfo;t<i.length;t++){var a=i[t];if(this.parent.cellTemplate){var s=this.parent.getCellTemplate()(a,this.parent,"cellTemplate",this.parent.element.id+"_cellTemplate",null,null,a.targetCell);s&&""!==s&&s.length>0&&(this.parent.enableHtmlSanitizer?this.parent.appendHtml(a.targetCell,sf.base.SanitizeHtmlHelper.sanitize(s[0].outerHTML)):this.parent.appendHtml(a.targetCell,s[0].outerHTML))}}this.parent.gridHeaderCellInfo=[]}!this.parent.element.querySelector(".e-firstcell")||1===this.parent.dataSourceSettings.values.length&&this.parent.dataSourceSettings.columns.length>0||(this.parent.enableRtl?this.parent.element.querySelector(".e-firstcell").style.borderRight="none":this.parent.element.querySelector(".e-firstcell").style.borderLeft="none"),this.parent.grid&&this.parent.grid.widthService&&this.parent.grid.widthService.setWidthToTable(),this.parent.notEmpty&&this.calculateGridHeight(!0),this.parent.isScrolling=!1,this.setFocusOnLastCell(),sf.base.isNullOrUndefined(this.parent.renderReactTemplates)||this.parent.renderReactTemplates(),this.isInitial&&this.parent.refreshData(),this.isInitial=!1,this.parent.notify(p,{})},e.prototype.setFocusOnLastCell=function(){if(this.parent.keyboardModule&&this.parent.keyboardModule.event&&"TD"===this.parent.keyboardModule.event.target.nodeName){var e=this.parent.grid.serviceLocator.getService("focus");e.setFocusedElement(this.parent.keyboardModule.event.target),e.focus(this.parent.keyboardModule.event),sf.base.addClass([this.parent.keyboardModule.event.target],["e-focused","e-focus"]),this.parent.keyboardModule.event.target.setAttribute("tabindex","0"),this.parent.keyboardModule.event=void 0}},e.prototype.contextMenuOpen=function(e){for(var t=this,i=function(i){var a=s.parent.lastCellClicked,n=null,o=void 0,l=void 0;if(a.classList.contains("e-stackedheadercelldiv")||a.classList.contains("e-cellvalue")||a.classList.contains("e-headercelldiv")||a.classList.contains("e-icons")||a.classList.contains("e-rhandler")?n=a.parentElement:a.classList.contains("e-headercell")||a.classList.contains("e-rowcell")||a.classList.contains("e-columnsheader")||a.classList.contains("e-rowsheader")||a.classList.contains("e-valuescontent")||a.classList.contains("e-valuesheader")?n=a:a.classList.contains("e-headertext")&&(n=a.parentElement.parentElement),!n)return e.cancel=!0,{value:void 0};(n.classList.contains("e-valuesheader")||n.classList.contains("e-stot"))&&(o=!0),s.parent.allowGrouping&&s.parent.groupingModule&&!s.validateField(n)&&(l=!0);var d=Number(n.getAttribute("index")),p=Number(n.getAttribute("aria-colindex")),h=s.parent.pivotValues[d][p];switch(i.id){case s.parent.element.id+"_expand":n.querySelectorAll("."+v).length>0?(sf.base.selectAll("#"+s.parent.element.id+"_expand",e.element)&&sf.base.select("#"+s.parent.element.id+"_expand",e.element).classList.add("e-disabled"),sf.base.select("#"+s.parent.element.id+"_expand",e.element).classList.contains("e-disabled")&&sf.base.select("#"+s.parent.element.id+"_expand",e.element).classList.remove("e-disabled"),sf.base.select("#"+s.parent.element.id+"_expand",e.element).classList.contains(x)&&(sf.base.select("#"+s.parent.element.id+"_expand",e.element).classList.remove(x),sf.base.select("#"+s.parent.element.id+"_collapse",e.element).classList.remove(x))):o?sf.base.select("#"+s.parent.element.id+"_expand",e.element).classList.add(x):sf.base.select("#"+s.parent.element.id+"_expand",e.element).classList.add("e-disabled");break;case s.parent.element.id+"_collapse":n.querySelectorAll("."+m).length>0?(sf.base.select("#"+s.parent.element.id+"_expand",e.element)&&sf.base.select("#"+s.parent.element.id+"_expand",e.element).classList.add("e-disabled"),sf.base.select("#"+s.parent.element.id+"_collapse",e.element).classList.contains("e-disabled")&&sf.base.select("#"+s.parent.element.id+"_collapse",e.element).classList.remove("e-disabled"),sf.base.select("#"+s.parent.element.id+"_collapse",e.element).classList.contains(x)&&(sf.base.select("#"+s.parent.element.id+"_collapse",e.element).classList.remove(x),sf.base.select("#"+s.parent.element.id+"_expand",e.element).classList.remove(x))):o?sf.base.select("#"+s.parent.element.id+"_collapse",e.element).classList.add(x):sf.base.select("#"+s.parent.element.id+"_collapse",e.element).classList.add("e-disabled");break;case s.parent.element.id+"_custom_group":l||2!==e.items.length||(e.cancel=!0),sf.base.selectAll("#"+s.parent.element.id+"_custom_group",e.element)&&sf.base.addClass([sf.base.select("#"+s.parent.element.id+"_custom_group",e.element)],x),l&&sf.base.selectAll("#"+s.parent.element.id+"_custom_group",e.element)&&sf.base.removeClass([sf.base.select("#"+s.parent.element.id+"_custom_group",e.element)],x);break;case s.parent.element.id+"_custom_ungroup":if(sf.base.selectAll("#"+s.parent.element.id+"_custom_ungroup",e.element)&&sf.base.addClass([sf.base.select("#"+s.parent.element.id+"_custom_ungroup",e.element)],x),l){var u=!1,c=n.getAttribute("fieldname"),g=r.getFieldByName(c,s.parent.dataSourceSettings.groupSettings);if(g&&"Custom"===g.type||s.parent.engineModule.fieldList[c].isCustomField&&c.indexOf("_custom_group")>-1){if(g=r.getFieldByName(c.replace("_custom_group",""),s.parent.dataSourceSettings.groupSettings)){var f=s.parent.engineModule.pivotValues[Number(n.getAttribute("index"))][Number(n.getAttribute("aria-colindex"))],b=s.parent.groupingModule.getSelectedCells(f.axis,c,f.actualText.toString());b.push({axis:f.axis,fieldName:c,name:f.actualText.toString(),cellInfo:f});for(var S=s.parent.groupingModule.getSelectedOptions(b),y=0,C=g.customGroups;y<C.length;y++){var w=C[y];if(S.indexOf(w.groupName)>-1){u=!0;break}}}}else(g&&("Date"===g.type||"Number"===g.type)||s.parent.engineModule.fieldList[c].isCustomField&&c.indexOf("_date_group")>-1)&&(u=!0);sf.base.selectAll("#"+s.parent.element.id+"_custom_ungroup",e.element)&&u&&sf.base.removeClass([sf.base.select("#"+s.parent.element.id+"_custom_ungroup",e.element)],x)}break;case s.parent.element.id+"_drillthrough":s.parent.allowDrillThrough?n.classList.contains("e-summary")?sf.base.select("#"+s.parent.element.id+"_drillthrough",e.element).classList.contains("e-disabled")&&sf.base.select("#"+s.parent.element.id+"_drillthrough",e.element).classList.remove("e-disabled"):""===n.innerText&&sf.base.select("#"+s.parent.element.id+"_drillthrough",e.element)&&sf.base.select("#"+s.parent.element.id+"_drillthrough",e.element).classList.add("e-disabled"):sf.base.select("#"+s.parent.element.id+"_drillthrough",e.element)&&sf.base.select("#"+s.parent.element.id+"_drillthrough",e.element).classList.add("e-disabled");break;case s.parent.element.id+"_sortasc":s.parent.enableValueSorting?n.querySelectorAll(".e-icon-descending").length>0?(sf.base.select("#"+s.parent.element.id+"_sortdesc",e.element)?sf.base.select("#"+s.parent.element.id+"_sortdesc",e.element).classList.add("e-disabled"):sf.base.select("#"+s.parent.element.id+"_sortdesc",e.element).classList.remove("e-disabled"),sf.base.select("#"+s.parent.element.id+"_sortasc",e.element).classList.contains("e-disabled")&&sf.base.select("#"+s.parent.element.id+"_sortasc",e.element).classList.remove("e-disabled")):sf.base.select("#"+s.parent.element.id+"_sortdesc",e.element).classList.contains("e-disabled")&&sf.base.select("#"+s.parent.element.id+"_sortdesc",e.element).classList.remove("e-disabled"):sf.base.select("#"+s.parent.element.id+"_sortasc",e.element)&&sf.base.select("#"+s.parent.element.id+"_sortasc",e.element).classList.add("e-disabled");break;case s.parent.element.id+"_sortdesc":s.parent.enableValueSorting?n.querySelectorAll(".e-icon-ascending").length>0?(sf.base.select("#"+s.parent.element.id+"_sortasc",e.element)?sf.base.select("#"+s.parent.element.id+"_sortasc",e.element).classList.add("e-disabled"):sf.base.select("#"+s.parent.element.id+"_sortasc",e.element).classList.remove("e-disabled"),sf.base.select("#"+s.parent.element.id+"_sortdesc",e.element).classList.contains("e-disabled")&&sf.base.select("#"+s.parent.element.id+"_sortdesc",e.element).classList.remove("e-disabled")):sf.base.select("#"+s.parent.element.id+"_sortasc",e.element).classList.contains("e-disabled")&&sf.base.select("#"+s.parent.element.id+"_sortasc",e.element).classList.remove("e-disabled"):sf.base.select("#"+s.parent.element.id+"_sortdesc",e.element)&&sf.base.select("#"+s.parent.element.id+"_sortdesc",e.element).classList.add("e-disabled");break;case s.parent.element.id+"_CalculatedField":s.parent.allowCalculatedField||sf.base.select("#"+s.parent.element.id+"_CalculatedField",e.element).classList.add("e-disabled");break;case s.parent.element.id+"_pdf":s.parent.allowPdfExport||sf.base.select("#"+s.parent.element.id+"_pdf",e.element).classList.add("e-disabled");break;case s.parent.element.id+"_excel":s.parent.allowExcelExport||sf.base.select("#"+s.parent.element.id+"_excel",e.element).classList.add("e-disabled");break;case s.parent.element.id+"_csv":s.parent.allowExcelExport||sf.base.select("#"+s.parent.element.id+"_csv",e.element).classList.add("e-disabled");break;case s.parent.element.id+"_exporting":s.parent.allowExcelExport||s.parent.allowPdfExport||sf.base.select("#"+s.parent.element.id+"_exporting",e.element).classList.add("e-disabled");break;case s.parent.element.id+"_aggregate":if(sf.base.select("#"+s.parent.element.id+"_aggregate",e.element)&&!sf.base.select("#"+s.parent.element.id+"_aggregate",e.element).classList.contains("e-disabled")&&sf.base.select("#"+s.parent.element.id+"_aggregate",e.element).classList.add("e-disabled"),(n.classList.contains("e-valuesheader")||n.classList.contains("e-valuescontent")||n.classList.contains("e-stot")&&n.classList.contains("e-rowsheader"))&&"olap"!==s.parent.dataType){var T;""!==n.innerText&&(T=s.parent.engineModule.fieldList[h.actualText.toString()].type);var M={cancel:!1,fieldName:h.actualText.toString(),aggregateTypes:s.getMenuItem(T).slice()};s.parent.trigger("aggregateMenuOpen",M,(function(a){if(!a.cancel&&""!==n.innerText){for(var s=[],r=[],o=0;o<a.aggregateTypes.length;o++){var l=a.aggregateTypes[o];"number"!==T?["Count","DistinctCount"].indexOf(l)>-1&&r.indexOf(l)<0&&(s.push({text:t.parent.localeObj.getConstant(l),id:t.parent.element.id+"_Agg"+l}),r.push(l)):t.parent.getAllSummaryType().indexOf(l)>-1&&r.indexOf(l)<0&&(s.push({text:t.parent.localeObj.getConstant(l),id:t.parent.element.id+"_Agg"+l}),r.push(l))}s.length>=7&&(s.splice(7),s.push({text:t.parent.localeObj.getConstant("MoreOption"),id:t.parent.element.id+"_AggMoreOption"})),s&&s.length>=1&&(i.items=s,sf.base.select("#"+t.parent.element.id+"_aggregate",e.element).classList.remove("e-disabled"))}}))}}},s=this,n=0,o=e.items;n<o.length;n++){var l=i(o[n]);if("object"===a(l))return l.value}this.parent.trigger("contextMenuOpen",e)},e.prototype.getMenuItem=function(e){for(var t=[],i=0;i<this.parent.aggregateTypes.length;i++){var a=this.parent.aggregateTypes[i];"string"!==e?this.parent.getAllSummaryType().indexOf(a)>-1&&-1===t.indexOf(a)&&t.push(a):["Count","DistinctCount"].indexOf(a)>-1&&-1===t.indexOf(a)&&t.push(a)}return t},e.prototype.contextMenuClick=function(e){var t=this,i=this.parent.lastCellClicked,a=e.item.id,s=new MouseEvent("dblclick",{view:window,bubbles:!0,cancelable:!0}),n={},o=null;i.classList.contains("e-stackedheadercelldiv")||i.classList.contains("e-cellvalue")||i.classList.contains("e-headercelldiv")||i.classList.contains("e-icons")||i.classList.contains("e-rhandler")?o=i.parentElement:i.classList.contains("e-headercell")||i.classList.contains("e-rowcell")?o=i:i.classList.contains("e-headertext")&&(o=i.parentElement.parentElement);var l,d=Number(o.getAttribute("index")),p=Number(o.getAttribute("aria-colindex")),h=this.parent.pivotValues[d][p];switch(e.item.id.indexOf(this.parent.element.id+"_Agg")>-1&&(this.field=this.parent.engineModule.fieldList[h.actualText.toString()].id,this.fieldCaption=this.parent.engineModule.fieldList[h.actualText.toString()].caption,l=e.item.id.split("_Agg")[1]),a){case this.parent.element.id+"_pdf":n={pdfDoc:void 0,isBlob:!1,isMultipleExport:!1,pdfExportProperties:{fileName:"Export.pdf"}},this.parent.trigger("beforeExport",n,(function(e){if(sf.base.isBlazor()){var i=r.formatPdfExportProperties(e.pdfExportProperties);t.parent.pdfExport(i,e.isMultipleExport,e.pdfDoc,e.isBlob)}else t.parent.pdfExport(e.pdfExportProperties,e.isMultipleExport,e.pdfDoc,e.isBlob)}));break;case this.parent.element.id+"_excel":n={isBlob:!1,isMultipleExport:!1,workbook:void 0,excelExportProperties:{fileName:"Export.xlsx"}},this.parent.trigger("beforeExport",n,(function(e){if(sf.base.isBlazor()){var i=r.formatExcelExportProperties(e.excelExportProperties);t.parent.excelExport(i,e.isMultipleExport,e.workbook,e.isBlob)}else t.parent.excelExport(e.excelExportProperties,e.isMultipleExport,e.workbook,e.isBlob)}));break;case this.parent.element.id+"_csv":n={isBlob:!1,workbook:void 0,isMultipleExport:!1,excelExportProperties:{fileName:"Export.csv"}},this.parent.trigger("beforeExport",n,(function(e){if(sf.base.isBlazor()){var i=r.formatExcelExportProperties(e.excelExportProperties);t.parent.csvExport(i,e.isMultipleExport,e.workbook,e.isBlob)}else t.parent.csvExport(e.excelExportProperties,e.isMultipleExport,e.workbook,e.isBlob)}));break;case this.parent.element.id+"_drillthrough_menu":o.dispatchEvent(s);break;case this.parent.element.id+"_sortasc":this.parent.setProperties({dataSourceSettings:{valueSortSettings:{headerText:h.valueSort.levelName,headerDelimiter:this.parent.dataSourceSettings.valueSortSettings.headerDelimiter}}}),this.parent.dataSourceSettings.valueSortSettings.sortOrder="Ascending";break;case this.parent.element.id+"_sortdesc":this.parent.setProperties({dataSourceSettings:{valueSortSettings:{headerText:h.valueSort.levelName,headerDelimiter:this.parent.dataSourceSettings.valueSortSettings.headerDelimiter}}}),this.parent.dataSourceSettings.valueSortSettings.sortOrder="Descending";break;case this.parent.element.id+"_expand":if(o.querySelectorAll("."+v)){var u=o.querySelectorAll("."+v)[0];this.parent.onDrill(u)}break;case this.parent.element.id+"_collapse":if(o.querySelectorAll("."+m)){var c=o.querySelectorAll("."+m)[0];this.parent.onDrill(c)}break;case this.parent.element.id+"_CalculatedField":this.parent.calculatedFieldModule.createCalculatedFieldDialog();break;case this.parent.element.id+"_AggMoreOption":case this.parent.element.id+"_AggDifferenceFrom":case this.parent.element.id+"_AggPercentageOfDifferenceFrom":case this.parent.element.id+"_AggPercentageOfParentTotal":o.setAttribute("id",this.field),o.setAttribute("data-caption",this.fieldCaption),o.setAttribute("data-field",this.field),o.setAttribute("data-type",this.engine.fieldList[h.actualText.toString()].aggregateType),o.setAttribute("data-basefield",this.engine.fieldList[h.actualText.toString()].baseField),o.setAttribute("data-baseItem",this.engine.fieldList[h.actualText.toString()].baseItem),this.aggMenu.createValueSettingsDialog(o,this.parent.element,l);break;case this.parent.element.id+"_Agg"+l:this.updateAggregate(l);break;case this.parent.element.id+"_custom_group":case this.parent.element.id+"_custom_ungroup":if(this.parent.groupingModule){var g={target:o,option:a,parentElement:this.parent.element};this.parent.notify("init-grouping",g),this.parent.grid.contextMenuModule.contextMenu.close()}}this.parent.trigger("contextMenuClick",e)},e.prototype.validateColumnTotalcell=function(e){for(var t=Object.keys(this.engine.headerContent),i=!1,a="",s=t.length-1;s>=0;s--){var r=this.engine.headerContent[t[s]][e];if(!r)return!1;if(i=!(!i||""===a)&&a===r.valueSort.axis,a=r.valueSort.axis?r.valueSort.axis.toString():"","sum"===r.type&&(i=!0),i&&r.members&&r.members.length>0)return!0}return!1},e.prototype.validateField=function(e){var t=!1;if(e.classList.contains("e-stot")||e.classList.contains("e-gtot")||e.classList.contains("e-valuescontent")||e.classList.contains("e-valuesheader"))t=!0;else{var i=e.getAttribute("fieldName");if(!i||""==i){var a=Number(e.getAttribute("index")),s=Number(e.getAttribute("aria-colindex"));i=this.engine.pivotValues[a][s].actualText}for(var r=this.parent.dataSourceSettings.values,n=0;n<r.length;n++)if(this.parent.dataSourceSettings.values[n].name===i){t=!0;break}}return t},e.prototype.updateAggregate=function(e){if(this.parent.getAllSummaryType().indexOf(e)>-1)for(var t=this.parent.dataSourceSettings.values,i=0;i<this.parent.dataSourceSettings.values.length;i++){if(this.parent.dataSourceSettings.values[i].name===this.field)t[i].type=e}},e.prototype.injectGridModules=function(e){sf.grids.Grid.Inject(sf.grids.Freeze),e.allowExcelExport&&sf.grids.Grid.Inject(sf.grids.ExcelExport),e.allowPdfExport&&sf.grids.Grid.Inject(sf.grids.PdfExport),sf.grids.Grid.Inject(sf.grids.Selection,sf.grids.Reorder,sf.grids.Resize),this.gridSettings.contextMenuItems&&sf.grids.Grid.Inject(sf.grids.ContextMenu)},e.prototype.updateGridSettings=function(){if(this.injectGridModules(this.parent),this.parent.grid.allowResizing=this.gridSettings.allowResizing,this.parent.grid.allowTextWrap=this.gridSettings.allowTextWrap,this.parent.grid.allowReordering=!this.parent.showGroupingBar&&this.gridSettings.allowReordering,this.parent.grid.allowSelection=this.gridSettings.allowSelection,this.parent.grid.contextMenuItems=this.gridSettings.contextMenuItems,this.parent.grid.selectedRowIndex=this.gridSettings.selectedRowIndex,this.parent.grid.selectionSettings=this.gridSettings.selectionSettings,this.parent.grid.textWrapSettings=this.gridSettings.textWrapSettings,this.parent.grid.printMode=this.gridSettings.printMode,this.parent.grid.rowHeight=this.gridSettings.rowHeight,this.parent.grid.gridLines=this.gridSettings.gridLines,this.parent.lastGridSettings){var e=Object.keys(this.parent.lastGridSettings);e.indexOf("height")>-1&&(this.parent.grid.height=this.gridSettings.height),e.indexOf("width")>-1&&(this.parent.grid.width=this.gridSettings.width),this.updatePivotColumns(),e.indexOf("allowTextWrap")>-1&&this.parent.layoutRefresh()}this.clearColumnSelection()},e.prototype.updatePivotColumns=function(){for(var e=Object.keys(this.parent.lastGridSettings),t=0;t<this.parent.pivotColumns.length;t++)for(var i=this.parent.pivotColumns[t],a=0;a<e.length;a++){var s=e[a];sf.base.isNullOrUndefined(this.parent.pivotColumns[t][s])||(i[s]=this.parent.lastGridSettings[s])}this.parent.fillGridColumns(this.parent.grid.columns)},e.prototype.clearColumnSelection=function(){sf.base.removeClass(this.parent.element.querySelectorAll(".e-active"),["e-active",E])},e.prototype.appendValueSortIcon=function(e,t,i,a){if(this.parent.enableValueSorting&&"pivot"===this.parent.dataType){var s=this.parent.dataSourceSettings.valueSortSettings,r="grand sum"!==e.type||1!==this.parent.dataSourceSettings.values.length||this.parent.dataSourceSettings.alwaysShowValueHeader?this.parent.dataSourceSettings.values.length>1||this.parent.dataSourceSettings.alwaysShowValueHeader?this.parent.engineModule.headerContent.length-1:0===this.parent.dataSourceSettings.columns.length?0:this.parent.engineModule.headerContent.length-1:0,n=s&&s.headerText?e.valueSort.levelName===s.headerText:a===s.columnIndex;if(void 0!==s&&n&&i===r&&"column"===this.parent.dataSourceSettings.valueAxis&&(t.querySelector(".e-sortfilterdiv")?(t.querySelector(".e-sortfilterdiv").classList.add("Descending"===s.sortOrder?"e-descending":"e-ascending"),t.querySelector(".e-sortfilterdiv").classList.add("Descending"===s.sortOrder?"e-icon-descending":"e-icon-ascending")):t.appendChild(sf.base.createElement("div",{className:"Descending"===s.sortOrder?"e-icon-descending e-icons e-descending e-sortfilterdiv":"e-icon-ascending e-icons e-ascending e-sortfilterdiv"})),!sf.base.isNullOrUndefined(e.hasChild)&&"grand sum"!==e.type&&t.querySelector(".e-expand")&&(t.querySelector(".e-icon-descending")||t.querySelector(".e-icon-ascending")))){var o=t.querySelector(".e-icon-descending")||t.querySelector(".e-icon-ascending");sf.base.setStyleAttribute(o,{"padding-top":"12px"})}}return t},e.prototype.onResizeStop=function(e){var t="0.formattedText"===e.column.field?"0.formattedText":e.column.customAttributes.cell.valueSort.levelName;this.parent.resizeInfo[t]=Number(e.column.width.toString().split("px")[0]),this.setGroupWidth(e),this.calculateGridHeight(!0),this.parent.grid.hideScroll()},e.prototype.setGroupWidth=function(e){if(this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector(".e-grouping-bar")){if(this.parent.groupingBarModule.refreshUI(),this.parent.element.querySelector(".e-group-row").offsetWidth<245&&!this.parent.firstColWidth){e.cancel=!0;var t=this.parent.grid.columns;t&&t.length>0&&(t[0].width=this.resColWidth),this.parent.element.querySelector(".e-frozenheader").querySelector("col").style.width=this.resColWidth+"px",this.parent.element.querySelector(".e-frozencontent").querySelector("col").style.width=this.resColWidth+"px"}this.parent.element.querySelector(".e-group-rows").style.height="auto",this.parent.element.querySelector(".e-group-values").style.width=this.parent.element.querySelector(".e-group-row").offsetWidth+"px";var i=this.parent.element.querySelector(".e-headercontent").offsetHeight;this.parent.element.querySelector(".e-group-rows").style.height=i+"px"}this.parent.trigger("touchend"===e.e.type||"mouseup"===e.e.type?"resizeStop":"resizing",e)},e.prototype.selected=function(){clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.onSelect.bind(this),300)},e.prototype.onSelect=function(){for(var e={selectedCellsInfo:[],pivotValues:this.parent.pivotValues,currentCell:null},t=0,i=this.parent.element.querySelectorAll("."+D+",."+E);t<i.length;t++){var a=i[t],s=Number(a.getAttribute("aria-colindex")),r=Number(a.getAttribute("index")),n=this.engine.pivotValues[r][s];n&&("value"===n.axis?e.selectedCellsInfo.push({currentCell:n,value:n.value,columnHeaders:n.columnHeaders,rowHeaders:n.rowHeaders,measure:n.actualText.toString()}):"column"===n.axis?e.selectedCellsInfo.push({currentCell:n,value:n.formattedText,columnHeaders:n.valueSort.levelName,rowHeaders:"",measure:""}):e.selectedCellsInfo.push({currentCell:n,value:n.formattedText,columnHeaders:"",rowHeaders:n.valueSort.levelName,measure:""}))}this.parent.trigger("cellSelected",e)},e.prototype.rowCellBoundEvent=function(e){var t=e.cell;if(t&&this.parent.notEmpty&&this.engine.headerContent){var i=this.parent.hyperlinkSettings.cssClass;t.setAttribute("index",(Number(t.getAttribute("index"))+this.engine.headerContent.length).toString());var a=e.data[0];if("0"===t.getAttribute("aria-colindex")){if("pivot"===this.parent.dataType){var s=a.type&&"value"===a.type;t.innerText="";var r=a.level?a.level:s?this.lastSpan+1:0;do{r>0&&t.appendChild(sf.base.createElement("span",{className:0===r?"":"e-nextspan"})),r--}while(r>-1);r=a.level?a.level:0,this.lastSpan=s?this.lastSpan:r,!a.hasChild&&r>0&&t.appendChild(sf.base.createElement("span",{className:"e-lastspan"}));var n=void 0;this.parent.dataSourceSettings.rows.length>0&&(!a.valueSort||Object.keys(a.valueSort).length>0)&&(n=r>-1?this.parent.dataSourceSettings.rows[r].name:"",t.setAttribute("fieldname",n))}else t=this.onOlapRowCellBoundEvent(t,a);var o=a.formattedText;a.type&&("grand sum"===a.type?(this.rowGrandPos=a.rowIndex,t.classList.add("e-gtot"),o=this.parent.localeObj.getConstant("grandTotal")):a.valueSort.levelName===this.parent.localeObj.getConstant("grandTotal")+this.parent.dataSourceSettings.valueSortSettings.headerDelimiter+a.formattedText?t.classList.add("e-gtot"):t.classList.add("e-stot")),t.classList.add("e-rowsheader"),!0!==a.hasChild||a.isNamedSet||t.appendChild(sf.base.createElement("div",{className:(!0===a.isDrilled?m:v)+" "+f,attrs:{title:!0===a.isDrilled?this.parent.localeObj.getConstant("collapse"):this.parent.localeObj.getConstant("expand")}})),t.appendChild(sf.base.createElement("span",{className:"e-cellvalue",innerHTML:this.parent.isRowCellHyperlink||a.enableHyperlink?'<a  data-url="'+o+'" class="e-hyperlinkcell '+i+'">'+o+"</a>":o}));var l=this.parent.pivotView.dataSourceSettings.valueSortSettings;if(this.parent.enableValueSorting&&l&&l.headerText&&"row"===this.parent.dataSourceSettings.valueAxis&&this.parent.pivotValues[Number(t.getAttribute("index"))][0].valueSort.levelName&&this.parent.pivotValues[Number(t.getAttribute("index"))][0].valueSort.levelName===l.headerText){var d=t.querySelector(".e-expand")||t.querySelector(".e-collapse")?"padding-top: 18px":"padding-top: 12px";t.appendChild(sf.base.createElement("div",{className:"Descending"===l.sortOrder?"e-icon-descending e-icons e-descending e-sortfilterdiv":"e-icon-ascending e-icons e-ascending e-sortfilterdiv",styles:d}))}}else{var p=t.innerText;t.innerText="",t.classList.add("e-valuescontent"),(a=e.data[Number(t.getAttribute("aria-colindex"))]).isSum&&t.classList.add("e-summary"),a.isGrandSum||this.colGrandPos===Number(t.getAttribute("aria-colindex"))||this.rowGrandPos===Number(t.getAttribute("index"))?t.classList.add("e-gtot"):("olap"===this.parent.dataType?a.isSum:this.validateColumnTotalcell(sf.base.isNullOrUndefined(a.value)?a.colIndex-1:a.colIndex))&&t.classList.add("e-colstot"),a.cssClass&&t.classList.add(a.cssClass),t.appendChild(sf.base.createElement("span",{className:"e-cellvalue",innerHTML:-1!==t.className.indexOf("e-summary")&&this.parent.isSummaryCellHyperlink||-1===t.className.indexOf("e-summary")&&this.parent.isValueCellHyperlink||a.enableHyperlink?'<a data-url="'+p+'" class="e-hyperlinkcell '+i+'">'+p+"</a>":p})),this.parent.gridSettings.allowReordering&&!this.parent.showGroupingBar&&t.setAttribute("aria-colindex",e.column.customAttributes.cell.colIndex.toString())}if(this.parent.cellTemplate){var h=t.getAttribute("index"),u=t.getAttribute("aria-colindex"),c=h+"_"+u;if(window&&sf.base.isBlazor())h&&u&&(this.parent.gridCellCollection[c]=t);else{var g=this.parent.getCellTemplate()({targetCell:t,cellInfo:a},this.parent,"cellTemplate",this.parent.element.id+"_cellTemplate",null,null,t);g&&""!==g&&g.length>0&&(this.parent.enableHtmlSanitizer?this.parent.appendHtml(t,sf.base.SanitizeHtmlHelper.sanitize(g[0].outerHTML)):this.parent.appendHtml(t,g[0].outerHTML))}}this.unWireEvents(t),this.wireEvents(t)}e.pivotview=this.parent,this.parent.trigger("queryCellInfo",e)},e.prototype.onOlapRowCellBoundEvent=function(e,t){e.innerText="";var i=this.engine.rowMeasurePos;if(this.parent.enableVirtualization){if(t.ordinal>-1&&this.parent.olapEngineModule.tupRowInfo.length>0){var a=this.parent.olapEngineModule.tupRowInfo[t.ordinal],s=a.uNameCollection.indexOf(t.actualText.toString()),r=(a.uNameCollection.substring(0,s)+(3===t.memberType?"":t.actualText.toString())).split("::[").map((function(e){return"["===e[0]?e:"["+e}));3===t.memberType&&i&&r.push(t.actualText.toString());for(var n=-1,o=0,l=!1,d=0;d<r.length;d++){n+=r[d].split("~~").length;var p="2"!==a.typeCollection[d]&&(!!(this.engine.fieldList[a.members[d].getAttribute("Hierarchy")]&&this.engine.fieldList[a.members[d].getAttribute("Hierarchy")].isHierarchy&&d<this.parent.dataSourceSettings.rows.length-1&&!this.parent.dataSourceSettings.rows[d+1].isNamedSet&&this.parent.dataSourceSettings.rows[d+1].name.indexOf("[Measures]")<0&&this.engine.fieldList[this.parent.dataSourceSettings.rows[d+1].name]&&this.engine.fieldList[this.parent.dataSourceSettings.rows[d+1].name].hasAllMember)||Number(a.members[d].querySelector("CHILDREN_CARDINALITY").textContent)>0);o+=d>0&&l&&!p?1:0,l=p}for(var h=0,u=0;u<n;u++)e.appendChild(sf.base.createElement("span",{className:"e-nextspan"})),h++;for(u=0;u<o&&n>0;u++)e.appendChild(sf.base.createElement("span",{className:"e-lastspan"}));this.indentCollection[t.rowIndex]=h,this.maxIndent=this.maxIndent>h?this.maxIndent:h}}else{var c=t.hierarchy,g=3===t.memberType?this.measurePos+"."+t.levelUniqueName:t.levelUniqueName;p=t.hasChild;if(!this.lvlCollection[g]&&g)this.lvlPosCollection[this.position]=g,this.lvlCollection[g]={position:this.position,hasChild:p},this.position++;else if(g){for(var f=this.lvlCollection[g].position,m=f+1;m<this.position;m++)delete this.lvlCollection[this.lvlPosCollection[m]],delete this.lvlPosCollection[m];this.position=this.position>f+1?f+1:this.position}if(!this.hierarchyCollection[c]&&c)this.hierarchyPosCollection[this.hierarchyCount]=c,this.hierarchyCollection[c]={lvlPosition:this.position-1,hierarchyPOs:this.hierarchyCount},this.hierarchyCount++;else if(c){var v=this.hierarchyCollection[c].hierarchyPOs;for(m=v+1;m<this.hierarchyCount;m++)delete this.hierarchyCollection[this.hierarchyPosCollection[m]],delete this.hierarchyPosCollection[m];this.hierarchyCount=this.hierarchyCount>v+1?v+1:this.hierarchyCount}if(3!==t.memberType&&g&&this.lvlCollection[g]){var b=this.hierarchyCollection[c]?this.hierarchyCollection[c].hierarchyPOs:-1;this.measurePos=i<=b&&this.hierarchyPosCollection[i+1]?this.measurePos:this.lvlCollection[g].position}var S=this.lvlCollection[g]?this.lvlCollection[g].position:-1,y=0;for(h=0;y<=S&&S>0&&t.level>-1;){var C=this.lvlCollection[this.lvlPosCollection[y]].hasChild;(l=y>0&&this.lvlCollection[this.lvlPosCollection[y-1]].hasChild)&&!C&&e.appendChild(sf.base.createElement("span",{className:"e-lastspan"})),y!==S&&(e.appendChild(sf.base.createElement("span",{className:"e-nextspan"})),h++),y++}3===t.memberType&&-1===t.level&&Object.keys(this.lvlCollection).length>1&&(e.appendChild(sf.base.createElement("span",{className:"e-nextspan"})),h++),this.indentCollection[t.rowIndex]=h,this.maxIndent=this.maxIndent>h?this.maxIndent:h}return e.setAttribute("fieldname",t.hierarchy),!!this.parent.olapEngineModule.tupRowInfo[t.ordinal]&&(0===this.parent.olapEngineModule.tupRowInfo[t.ordinal].measurePosition?1===this.parent.olapEngineModule.tupRowInfo[t.ordinal].allStartPos:0===this.parent.olapEngineModule.tupRowInfo[t.ordinal].allStartPos)&&e.classList.add("e-gtot"),e},e.prototype.columnCellBoundEvent=function(e){if(e.cell.column&&e.cell.column.customAttributes){var t=e.cell.column.customAttributes.cell,i=e.node;if(t){var a=this.parent.hyperlinkSettings.cssClass,s=t.level?t.level:0;-1===t.level&&!t.rowSpan||-1===t.rowSpan?e.node.style.display="none":t.rowSpan>1&&(e.node.setAttribute("rowspan",t.rowSpan.toString()),e.node.setAttribute("aria-rowspan",t.rowSpan.toString()),t.rowIndex+t.rowSpan===this.engine.headerContent.length&&(e.node.style.borderBottomWidth="0px")),e.node.setAttribute("aria-colindex",t.colIndex.toString()),e.node.setAttribute("index",t.rowIndex.toString());var r=void 0;if("pivot"===this.parent.dataType?(!(this.parent.dataSourceSettings.values&&"column"===this.parent.dataSourceSettings.valueAxis&&this.parent.dataSourceSettings.values.length>1&&t.rowIndex===this.engine.headerContent.length-1)&&this.parent.dataSourceSettings.columns&&this.parent.dataSourceSettings.columns.length>0&&(r=s>-1&&this.parent.dataSourceSettings.columns[s]?this.parent.dataSourceSettings.columns[s].name:"",i.setAttribute("fieldname",r)),this.validateColumnTotalcell(t.colIndex)&&i.classList.add("e-colstot")):i=this.onOlapColumnCellBoundEvent(i,t),t.type){i.classList.add("grand sum"===t.type?"e-gtot":"e-stot"),"grand sum"===t.type?this.colGrandPos=t.colIndex:i.classList.add("e-colstot");var n="grand sum"===t.type?this.parent.localeObj.getConstant("grandTotal"):t.formattedText.split("Total")[0]+this.parent.localeObj.getConstant("total");null!==i.querySelector(".e-headertext")?i.querySelector(".e-headertext").innerText=n:i.querySelector(".e-stackedheadercelldiv").innerText=n}if(i.classList.add("e-columnsheader"),this.parent.isColumnCellHyperlink||t.enableHyperlink)if(i.querySelector(".e-stackedheadercelldiv")){var o=i.querySelector(".e-stackedheadercelldiv").innerText;i.querySelector(".e-stackedheadercelldiv").innerHTML='<a data-url="'+o+'" class="e-hyperlinkcell '+a+'">'+o+"</a>"}else if(i.querySelector(".e-headertext")){o=i.querySelector(".e-headertext").innerText;i.querySelector(".e-headertext").innerHTML='<a data-url="'+o+'" class="e-hyperlinkcell '+a+'">'+o+"</a>"}if(!0===t.hasChild&&!t.isNamedSet){var l=i.querySelector(".e-headercelldiv");l&&(l.style.height="auto",l.style.lineHeight="normal");var d=sf.base.createElement("div",{className:(!0===t.isDrilled?m:v)+" "+f,attrs:{title:!0===t.isDrilled?this.parent.localeObj.getConstant("collapse"):this.parent.localeObj.getConstant("expand")}});i.children[0].classList.add("e-cellvalue"),window.navigator.userAgent.indexOf("Edge")>-1||window.navigator.userAgent.indexOf("Trident")>-1?i.children[0].style.display="table":i.children[0].style.display="block",i.insertBefore(d,i.children[0])}if(i=this.appendValueSortIcon(t,i,t.rowIndex,t.colIndex),this.parent.cellTemplate){var p=i.getAttribute("index"),h=i.getAttribute("aria-colindex"),u=p+"_"+h;window&&sf.base.isBlazor()?p&&h&&(this.parent.gridCellCollection[u]=i):this.parent.gridHeaderCellInfo.push({targetCell:i})}for(var c=this.parent.dataSourceSettings.values.length,g=0;g<c;g++)if(this.parent.dataSourceSettings.values[g].name===t.actualText){if("olap"===this.parent.dataType)!!this.parent.olapEngineModule.tupColumnInfo[t.ordinal]&&(0===this.parent.olapEngineModule.tupColumnInfo[t.ordinal].measurePosition?1===this.parent.olapEngineModule.tupColumnInfo[t.ordinal].allStartPos:0===this.parent.olapEngineModule.tupColumnInfo[t.ordinal].allStartPos)&&i.classList.add("e-gtot");t.valueSort.levelName===this.parent.localeObj.getConstant("grandTotal")+this.parent.dataSourceSettings.valueSortSettings.headerDelimiter+t.formattedText?i.classList.add("e-gtot"):i.classList.add("e-valuesheader")}this.unWireEvents(i),this.wireEvents(i)}}this.parent.trigger("headerCellInfo",e)},e.prototype.onOlapColumnCellBoundEvent=function(e,t){e.setAttribute("fieldname",3===t.memberType?t.actualText.toString():t.hierarchy);var i=this.engine.headerContent[t.rowIndex]?this.engine.headerContent[t.rowIndex][t.colIndex-1]:void 0;return i&&i.actualText===t.actualText&&i.type===t.type&&i.colSpan>1?e.style.display="none":(e.setAttribute("colspan",t.colSpan.toString()),e.setAttribute("aria-colspan",t.colSpan.toString())),t.rowIndex===this.engine.headerContent.length-1&&2===t.memberType&&(e.style.display=this.isSpannedCell(this.engine.headerContent.length,t)?"none":e.style.display),e},e.prototype.isSpannedCell=function(e,t){for(var i,a,s=this.engine.headerContent[t.rowIndex-1]?this.engine.headerContent[t.rowIndex-1][t.colIndex]:void 0;s&&(s.memberType===t.memberType||s.type&&t.type);)s.rowSpan>0&&(i=s.rowSpan,a=s.rowIndex),s=this.engine.headerContent[s.rowIndex-1]?this.engine.headerContent[s.rowIndex-1][t.colIndex]:void 0;return a+i>=e},e.prototype.onHyperCellClick=function(e){var t=e.target.parentElement.parentElement,i={currentCell:t=t.className.indexOf("e-headercelldiv")>-1?t.parentElement:t,data:this.engine.pivotValues[Number(t.getAttribute("index"))][Number(t.getAttribute("aria-colindex"))],cancel:!0,nativeEvent:e};this.parent.trigger("hyperlinkCellClick",i,(function(e){if(!e.cancel){i.currentCell=sf.base.getElement(i.currentCell);var t=i.currentCell.getAttribute("data-url")?i.currentCell.getAttribute("data-url"):i.currentCell.querySelector("a").getAttribute("data-url");window.open(t)}}))},e.prototype.getRowStartPos=function(){for(var e,t=this.parent.pivotValues,i=0;i<(t?t.length:0);i++)if(t[i]&&t[i][0]&&"row"===t[i][0].axis){e=i;break}return e},e.prototype.frameDataSource=function(e){var t=[];if(this.parent.dataSourceSettings.values.length>0&&!this.engine.isEmptyData)if(this.parent.enableValueSorting||!this.engine.isEngineUpdated){for(var i=0,a=this.parent.pivotValues,s="value"===e?this.rowStartPos:0,r="value"===e?a?a.length:0:this.rowStartPos,n=s;n<r;n++)if(a[n]){t[i="header"===e?n:i]={};for(var o=0;o<a[n].length;o++)a[n][o]&&(t[i][o]=a[n][o]);i++}}else t="value"===e?this.engine.valueContent:this.engine.headerContent;else t=this.frameEmptyData();return t},e.prototype.frameEmptyData=function(){return[{0:{formattedText:this.parent.localeObj.getConstant("grandTotal")},1:{formattedText:this.parent.localeObj.getConstant("emptyData")}}]},e.prototype.calculateColWidth=function(e){var t=this.parent.element.offsetWidth?this.parent.element.offsetWidth:this.parent.element.getBoundingClientRect().width,i=isNaN(this.parent.width)?this.parent.width.toString().indexOf("%")>-1?parseFloat(this.parent.width.toString())/100*t:t:Number(this.parent.width);i=i-(this.gridSettings.columnWidth>this.resColWidth?this.gridSettings.columnWidth:this.resColWidth)-2,e-=1,this.isOverflows=!(e*this.gridSettings.columnWidth<i);var a=e*this.gridSettings.columnWidth<i?i/e:this.gridSettings.columnWidth;return this.isOverflows||this.gridSettings.allowAutoResizing?Math.floor(a):this.gridSettings.columnWidth},e.prototype.resizeColWidth=function(e){var t=isNaN(this.parent.width)?this.parent.width.toString().indexOf("%")>-1?parseFloat(this.parent.width.toString())/100*this.parent.element.offsetWidth:this.parent.element.offsetWidth:Number(this.parent.width);e-=1,t=t-(this.gridSettings.columnWidth>this.resColWidth?this.gridSettings.columnWidth:this.resColWidth)-2,this.isOverflows=!(e*this.gridSettings.columnWidth<t);var i=e*this.gridSettings.columnWidth<t?t/e:this.gridSettings.columnWidth;return this.isOverflows||this.gridSettings.allowAutoResizing?Math.floor(i):this.gridSettings.columnWidth},e.prototype.calculateGridWidth=function(){var e=this.parent.width,t=this.parent.element.getBoundingClientRect().width?this.parent.element.getBoundingClientRect().width:this.parent.element.offsetWidth;return"auto"===this.gridSettings.width?"auto"===this.parent.width?e=t:this.parent.width.toString().indexOf("%")>-1&&(e=parseFloat(this.parent.width.toString())/100*t):e=this.gridSettings.width,!this.gridSettings.allowAutoResizing&&e>this.parent.totColWidth?this.parent.totColWidth:e},e.prototype.calculateGridHeight=function(e){var t=this.parent.height,i=this.parent.getHeightAsNumber();if(isNaN(i)&&(i=i>300?i:300),"Chart"!==this.parent.currentView)if("auto"===this.gridSettings.height&&i&&this.parent.element.querySelector(".e-gridheader"))if(t=i-(this.parent.element.querySelector(".e-gridheader").offsetHeight+(this.parent.element.querySelector(".e-grouping-bar")?this.parent.element.querySelector(".e-grouping-bar").offsetHeight:0)+(this.parent.element.querySelector("."+P)?42:0))-1,e){var a=this.parent.element.querySelector(".e-frozencontent ."+b).offsetHeight,s=this.parent.element.querySelector(".e-movablecontent").offsetHeight,r=this.parent.element.querySelector(".e-movablecontent ."+b).offsetWidth,n=this.parent.element.querySelector(".e-movablecontent").offsetWidth<r;t>=a&&(!n||t>=s)&&!!!(n&&t-a<18)?this.parent.grid.height="auto":(this.parent.grid.height=t,this.parent.grid.dataBind()),this.parent.grid.widthService.refreshFrozenScrollbar()}else t>this.engine.valueContent.length*this.gridSettings.rowHeight&&(t="auto");else t=this.gridSettings.height;return t<this.parent.gridSettings.rowHeight?this.parent.gridSettings.rowHeight:t},e.prototype.frameStackedHeaders=function(){var e=1!==this.parent.dataSourceSettings.values.length||this.parent.dataSourceSettings.alwaysShowValueHeader?void 0:this.formatList[this.parent.dataSourceSettings.values[0].name],t=[];if(("olap"===this.parent.dataType||this.parent.dataSourceSettings.values.length>0)&&!this.engine.isEmptyData){var i=this.engine.headerContent.length,a=[],s=[],r=this.calculateColWidth(this.engine.pivotValues?this.engine.pivotValues[0].length:0);do{var n=[],o=0;i--;var l=this.engine.headerContent[i];if(l)for(var d=0;d<Object.keys(l).length+(l[0]?0:1);d++){var p=l[d]&&l[d].colSpan?3!==l[d].memberType||0===i?l[d].colSpan:a[d]:1;p="olap"===this.parent.dataType?1:p;var h=l[d]?"grand sum"===l[d].type?this.parent.localeObj.getConstant("grandTotal"):"sum"===l[d].type?l[d].formattedText.split("Total")[0]+this.parent.localeObj.getConstant("total"):l[d].formattedText:"";if(i===this.engine.headerContent.length-1)p=1,n[o]={field:d+".formattedText",headerText:h,customAttributes:{cell:l[d]},width:l[d]?this.setSavedWidth(l[d].valueSort.levelName,r):this.resColWidth,minWidth:30,format:0===d?"":sf.base.isNullOrUndefined(e)?this.formatList[l[d].actualText]:e,allowReordering:!this.parent.showGroupingBar&&this.parent.gridSettings.allowReordering,allowResizing:this.parent.gridSettings.allowResizing,visible:!0};else if(a[d]){for(var u=p=l[d]&&"grand sum"===l[d].type&&2===l[d].memberType?1:p,c=[],g=d;u>0;){if(n[o]){if(!t[s[g]])break;c.push(t[s[g]])}else n[o]={headerText:h,field:l[d]?l[d].valueSort.levelName:"",customAttributes:{cell:l[d]},width:l[d]?this.setSavedWidth(l[d].valueSort.levelName,r):this.resColWidth,minWidth:30,allowReordering:!this.parent.showGroupingBar&&this.parent.gridSettings.allowReordering,allowResizing:this.parent.gridSettings.allowResizing,visible:!0},c=[t[s[g]]];u-=a[g],g+=a[g]}n[o].columns=c}n[o]&&(n[o].clipMode=this.gridSettings.clipMode),a[d]=p,s[d]=o,o++,d=d+p-1}t=n.length>0?n:t}while(i>0);t[0]={field:"0.formattedText",width:this.resColWidth,minWidth:30,headerText:"",allowReordering:!1,allowResizing:this.parent.gridSettings.allowResizing,visible:!0}}else t=this.frameEmptyColumns();if(t.length>1){var f=t[t.length-1];f.minWidth=f.width,f.width="auto",f.columns&&f.columns.length>0&&this.configLastColumnWidth(f.columns[f.columns.length-1])}return this.parent.triggerColumnRenderEvent(t),t},e.prototype.configLastColumnWidth=function(e){e.minWidth=e.width,e.width="auto",e.columns&&e.columns.length>0&&this.configLastColumnWidth(e.columns[e.columns.length-1])},e.prototype.setSavedWidth=function(e,t){return t=this.parent.resizeInfo[e]?this.parent.resizeInfo[e]:t},e.prototype.frameEmptyColumns=function(){var e=[],t=this.calculateColWidth(2);return e.push({field:"0.formattedText",headerText:"",minWidth:30,width:this.resColWidth}),e.push({field:"1.formattedText",headerText:this.parent.localeObj.getConstant("grandTotal"),minWidth:30,width:t}),e},e.prototype.getFormatList=function(){for(var e={},t=0;t<this.parent.dataSourceSettings.values.length;t++){var i=this.parent.dataSourceSettings.values[t],a="N";if("olap"===this.parent.dataType){if(this.parent.olapEngineModule.fieldList[i.name]){var s=this.parent.olapEngineModule.fieldList[i.name].formatString;a=s.indexOf("#")>-1?s:s[0]+"2"}}else if(this.parent.dataSourceSettings.formatSettings.length>0)for(var r=0;r<this.parent.dataSourceSettings.formatSettings.length;r++){var n=this.parent.dataSourceSettings.formatSettings[r];if(i.name===n.name){a=n.format;break}}e[i.name]=a}return e},e.prototype.excelColumnEvent=function(e){void 0!==e.gridCell&&"auto"===e.gridCell.column.width&&(this.parent.lastColumn=e.gridCell.column,e.gridCell.column.width=e.gridCell.column.minWidth),e=this.exportHeaderEvent(e),this.parent.trigger("excelHeaderQueryCellInfo",e)},e.prototype.pdfColumnEvent=function(e){void 0!==e.gridCell&&"auto"===e.gridCell.column.width&&(this.parent.lastColumn=e.gridCell.column,e.gridCell.column.width=e.gridCell.column.minWidth),this.parent.trigger("pdfHeaderQueryCellInfo",e)},e.prototype.excelRowEvent=function(e){if("0.formattedText"===e.column.field){var t="value"===e.data[0].type,i=0;i="olap"===this.parent.dataType?this.indentCollection[e.data[0].rowIndex]:t?this.lastSpan+1:e.data[0].level,this.colPos=0,e.style={hAlign:"Left",indent:2*i},this.lastSpan=t?this.lastSpan:i}else this.colPos++,sf.base.isNullOrUndefined(e.data[this.colPos].value)||sf.base.isNullOrUndefined(e.data[this.colPos].formattedText)?e.value="":e.value=e.data[this.colPos].value||e.data[this.colPos].formattedText;e=this.exportContentEvent(e),this.parent.trigger("excelQueryCellInfo",e)},e.prototype.pdfRowEvent=function(e){if("0.formattedText"===(e=this.exportContentEvent(e)).column.field){var t=0,i="value"===e.data[0].type;t="olap"===this.parent.dataType?this.indentCollection[e.data[0].rowIndex]:i?this.lastSpan+1:-1!==e.data[0].level?e.data[0].level:0,e.style={paragraphIndent:10*t},this.lastSpan=i?this.lastSpan:t}this.parent.trigger("pdfQueryCellInfo",e)},e.prototype.excelDataBound=function(e){for(var t=e.excelRows,i=Object.keys(this.engine.headerContent).length,a=0;a<i;a++){for(var s=t[a].cells,r=[],n=0;n<s.length;n++)-1!==s[n].rowSpan&&r.push(s[n]);t[a].cells=r}},e.prototype.exportHeaderEvent=function(e){var t=1;if(e.gridCell.column.customAttributes){var i=e.gridCell.column.customAttributes.cell;this.actualText!==i.actualText&&i.colSpan>1&&i.level>-1&&(e.gridCell.colSpan=e.cell.colSpan=i.colSpan>-1?i.colSpan:1),t=i.rowSpan>-1?i.rowSpan:1,"excelHeaderQueryCellInfo"===e.name&&(i.rowSpan>-1?t=i.rowSpan:sf.base.isNullOrUndefined(i.type)||0===i.level||(t=-1,e.cell.rowSpan=-1)),this.actualText=i.actualText}else t=Object.keys(this.engine.headerContent).length;return e.cell.rowSpan!==t&&t>-1&&(e.cell.rowSpan=t),e},e.prototype.exportContentEvent=function(e){return e.value="grand sum"===e.data[Number(e.column.field.split(".formattedText")[0])].type?this.parent.localeObj.getConstant("grandTotal"):e.value,e},e.prototype.unWireEvents=function(e){e.querySelector(".e-hyperlinkcell")&&sf.base.EventHandler.remove(e.querySelector(".e-hyperlinkcell"),this.parent.isAdaptive?"touchend":"click",this.onHyperCellClick)},e.prototype.wireEvents=function(e){e.querySelector(".e-hyperlinkcell")&&sf.base.EventHandler.add(e.querySelector(".e-hyperlinkcell"),this.parent.isAdaptive?"touchend":"click",this.onHyperCellClick,this)},e}(),R=function(){function e(e){this.keyConfigs={shiftF:"shift+F",shiftS:"shift+S",shiftE:"shift+E",delete:"delete",enter:"enter",escape:"escape",upArrow:"upArrow",downArrow:"downArrow"},this.parent=e,this.parent.element.tabIndex=-1===this.parent.element.tabIndex?0:this.parent.element.tabIndex,this.keyboardModule=new sf.base.KeyboardEvents(this.parent.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})}return e.prototype.keyActionHandler=function(e){switch(e.action){case"shiftF":this.processFilter(e);break;case"shiftS":this.processSort(e);break;case"shiftE":this.processEdit(e);break;case"delete":this.processDelete(e);break;case"enter":this.processEnter(e);break;case"escape":this.processClose(e);break;case"upArrow":case"downArrow":this.processFilterNodeSelection(e)}},e.prototype.getButtonElement=function(e){for(var t=[].slice.call(this.parent.element.querySelectorAll(".e-pivot-button")),i=0,a=t.length;i<a;i++)if(t[i].getAttribute("data-uid")===e.getAttribute("data-uid"))return t[i];return e},e.prototype.processEnter=function(e){var t=e.target;if(t&&sf.base.closest(t,".e-pivot-button"))return t.querySelector(".e-dropdown-icon")&&sf.base.closest(t,".e-values")?t.querySelector(".e-dropdown-icon").click():t.querySelector(".e-edit")?t.querySelector(".e-edit").click():!t.querySelector(".e-sort")||sf.base.closest(t,".e-values")||sf.base.closest(t,".e-axis-filter")?t.querySelector(".e-btn-filter")&&!sf.base.closest(t,".e-values")&&t.querySelector(".e-btn-filter").click():(t.querySelector(".e-sort").click(),this.getButtonElement(t).focus()),void e.preventDefault()},e.prototype.processSort=function(e){var t=e.target;if(t&&sf.base.closest(t,".e-pivot-button")&&t.querySelector(".e-sort")&&!sf.base.closest(t,".e-values")&&!sf.base.closest(t,".e-axis-filter"))return t.querySelector(".e-sort").click(),this.getButtonElement(t).focus(),void e.preventDefault()},e.prototype.processEdit=function(e){var t=e.target;if(t&&sf.base.closest(t,".e-pivot-button")&&t.querySelector(".e-edit"))return t.querySelector(".e-edit").click(),void e.preventDefault()},e.prototype.processFilter=function(e){var t=e.target;if(t&&sf.base.closest(t,".e-pivot-button")&&t.querySelector(".e-btn-filter")&&!sf.base.closest(t,".e-values")){if(t.querySelector(".e-btn-filter").click(),this.parent&&this.parent.control&&"pivotview"===this.parent.moduleName&&this.parent.control.grid&&this.parent.control.showGroupingBar&&this.parent.control.groupingBarModule&&sf.base.closest(t,".e-group-rows")&&this.parent.filterDialog&&this.parent.filterDialog.dialogPopUp&&!this.parent.filterDialog.dialogPopUp.isDestroyed&&this.parent.filterDialog.dialogPopUp.element){var i=this.parent.filterDialog.dialogPopUp.element,a=this.parent.filterDialog.allowExcelLikeFilter;clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout((function(){i&&i.classList.contains("e-popup-open")&&(a&&i.querySelector(".e-dlg-closeicon-btn")?i.querySelector(".e-dlg-closeicon-btn").focus():i.querySelector("input")&&i.querySelector("input").focus())}))}e.preventDefault()}else;},e.prototype.processFilterNodeSelection=function(e){var t=e.target;if(t&&sf.base.closest(t,".e-select-all")&&40===e.keyCode){if((a=sf.base.closest(t,".e-member-editor-wrapper").querySelector(".e-member-editor-container"))&&a.querySelector("li")){var i=a.querySelector("li");return a.querySelector("li#_active")&&(sf.base.removeClass([a.querySelector("li#_active")],["e-hover","e-node-focus"]),a.querySelector("li#_active").removeAttribute("id")),i.setAttribute("id","_active"),sf.base.addClass([i],["e-hover","e-node-focus"]),a.focus(),void e.preventDefault()}}else if(t&&sf.base.closest(t,".e-member-editor-container")&&38===e.keyCode){var a;if((a=sf.base.closest(t,".e-member-editor-container")).querySelector("li#_active.e-hover.e-node-focus")&&a.querySelector("li")&&a.querySelector("li").classList.contains("e-prev-active-node")&&a.querySelector("li")===a.querySelector("li#_active.e-hover.e-node-focus")){sf.base.removeClass(a.querySelectorAll("li.e-prev-active-node"),"e-prev-active-node");var s=sf.base.closest(t,".e-member-editor-wrapper").querySelector(".e-select-all");if(s&&s.querySelector("li"))return(i=s.querySelector("li")).setAttribute("id","_active"),sf.base.addClass([i],["e-hover","e-node-focus"]),s.focus(),void e.preventDefault()}}else t&&t.id===this.parent.parentID+"_inputbox"&&("upArrow"===e.action?t.parentElement.querySelector(".e-spin-up").click():"downArrow"===e.action&&t.parentElement.querySelector(".e-spin-down").click())},e.prototype.processDelete=function(e){var t=e.target;if(t&&sf.base.closest(t,".e-pivot-button")&&t.querySelector(".e-remove"))return t.querySelector(".e-remove").click(),void e.preventDefault()},e.prototype.processClose=function(e){var t=e.target;if(t&&sf.base.closest(t,".e-popup.e-popup-open")){var i=sf.base.closest(t,".e-popup.e-popup-open").ej2_instances[0];if(i&&!i.closeOnEscape){var a=i.element.getAttribute("data-fieldName");if(i.hide(),this.parent.element)for(var s=0,r=[].slice.call(this.parent.element.querySelectorAll(".e-pivot-button"));s<r.length;s++){var n=r[s];if(n.getAttribute("data-uid")===a){n.focus();break}}return void e.preventDefault()}}},e.prototype.destroy=function(){this.keyboardModule&&this.keyboardModule.destroy()},e}(),k=function(){function e(e){this.parent=e}return e.prototype.updateSorting=function(e){if(!e.target.classList.contains("e-btn-filter")&&!e.target.classList.contains("e-remove")){this.parent.filterDialog.dialogPopUp&&this.parent.filterDialog.dialogPopUp.close();var t=e.target,i=void 0,a=void 0,s=void 0;t.id?(i=t.id,a=[].slice.call(t.querySelectorAll(".e-descend"))):(i=t.parentElement.id,a=[].slice.call(t.parentElement.querySelectorAll(".e-descend"))),s=0!==a.length;var n=r.getFieldByName(i,this.parent.dataSourceSettings.sortSettings);if(sf.base.isNullOrUndefined(n)){l={name:i,order:s?"Ascending":"Descending"};this.parent.dataSourceSettings.sortSettings.push(l)}else{for(var o=0;o<this.parent.dataSourceSettings.sortSettings.length;o++)if(this.parent.dataSourceSettings.sortSettings[o].name===i){this.parent.dataSourceSettings.sortSettings.splice(o,1);break}var l={name:i,order:s?"Ascending":"Descending"};this.parent.dataSourceSettings.sortSettings.push(l)}this.parent.control.lastSortInfo=this.parent.dataSourceSettings.sortSettings[this.parent.dataSourceSettings.sortSettings.length-1],s?sf.base.removeClass([t],"e-descend"):sf.base.addClass([t],"e-descend")}},e.prototype.updateFiltering=function(e){var t=e.target,i=t.parentElement.id,a=t.parentElement.textContent,s=!1,n=[],o=[];if(this.parent.dataSourceSettings.allowMemberFilter)if("olap"===this.parent.dataType)o=this.getOlapData(i,s);else{var l=r.getClonedData(this.parent.engineModule.fieldList[i].dateMember);l="Ascending"===this.parent.engineModule.fieldList[i].sort?l.sort((function(e,t){return e.actualText>t.actualText?1:t.actualText>e.actualText?-1:0})):"Descending"===this.parent.engineModule.fieldList[i].sort?l.sort((function(e,t){return e.actualText<t.actualText?1:t.actualText<e.actualText?-1:0})):l;var d=r.getFilterItemByName(i,this.parent.dataSourceSettings.filterSettings);sf.base.isNullOrUndefined(d)||(s=!(!this.isValidFilterItemsAvail(i,d)||"Include"!==d.type),n=d.items?d.items:[]),o=this.getTreeData(s,l,n,i)}this.parent.filterDialog.dialogPopUp&&this.parent.filterDialog.dialogPopUp.close();var p=this.parent.control.filterTargetID;sf.base.isNullOrUndefined(p)&&(p="pivotfieldlist"!==this.parent.moduleName?this.parent.element:document.getElementById(this.parent.parentID+"_Wrapper")),this.parent.filterDialog.createFilterDialog(o,i,a,p)},e.prototype.isValidFilterItemsAvail=function(e,t){var i=!1;if(t&&["Include","Exclude"].indexOf(t.type)>=0)for(var a=this.parent.engineModule,s=a.fieldList[e],r=a.formatFields[e]&&["date","dateTime","time"].indexOf(a.formatFields[e].type)>-1?s.formattedMembers:s.members,n=0,o=t.items;n<o.length;n++){if(r[o[n]]){i=!0;break}}return i},e.prototype.getOlapData=function(e,t){var i=[],a=[];this.parent.filterDialog.isSearchEnabled=!1;var s=this.parent.engineModule,n=r.getFilterItemByName(e,this.parent.dataSourceSettings.filterSettings);0===s.fieldList[e].filterMembers.length?this.parent.control.loadOnDemandInMemberEditor?n&&n.levelCount>1&&s.fieldList[e].levels.length>1?s.getFilterMembers(this.parent.dataSourceSettings,e,n.levelCount):(s.fieldList[e].levelCount=1,s.getMembers(this.parent.dataSourceSettings,e)):s.getMembers(this.parent.dataSourceSettings,e,!0):(s.fieldList[e].currrentMembers={},s.fieldList[e].searchMembers=[]);var o=s.fieldList[e].isHierarchy;i=s.fieldList[e].filterMembers,sf.base.isNullOrUndefined(n)||(t=!n.type||"Include"===n.type,a=n.items?n.items:[]);for(var l={},d={},p=s.fieldList[e].members,h=0,u=a;h<u.length;h++){var c=u[h];l[c]=c,d[c]=c,p[c]&&(d=this.getParentNode(e,c,d))}return i=this.getFilteredTreeNodes(e,i,d,[],o),i=this.getOlapTreeData(t,r.getClonedData(i),l,e,o),i=this.sortOlapFilterData(i,s.fieldList[e].sort)},e.prototype.sortOlapFilterData=function(e,t){return e.length>0&&(e="Ascending"===t?e.sort((function(e,t){return e.caption>t.caption?1:t.caption>e.caption?-1:0})):"Descending"===t?e.sort((function(e,t){return e.caption<t.caption?1:t.caption<e.caption?-1:0})):e),e},e.prototype.getParentIDs=function(e,t,i){for(var a,s=0,r=e.fields.dataSource;s<r.length;s++){var n=r[s];if(n.id===t){a=n.pid;break}}return a&&(i.push(a),this.getParentIDs(e,a,i)),i},e.prototype.getChildIDs=function(e,t,i){for(var a,s=0,r=e.fields.dataSource;s<r.length;s++){var n=r[s];if(n.pid===t){a=n.id;break}}return a&&(i.push(a),this.getParentIDs(e,a,i)),i},e.prototype.searchTreeNodes=function(e,t,i,a){if(i){for(var s=[],n=[],o=0,l=[].slice.call(t.element.querySelectorAll("li"));o<l.length;o++){var d=l[o];d.querySelector(".e-list-text").textContent.toLowerCase().indexOf(e.value.toLowerCase())>-1?s.push(d):n.push(d)}if(t.enableNodes(s),sf.base.removeClass(s,"e-disable"),t.disableNodes(n),sf.base.addClass(n,"e-disable"),s.length>0&&n.length>0)for(var p=0,h=s;p<h.length;p++){var u=h[p].getAttribute("data-uid"),c=this.getParentIDs(t,u,[]),g=this.getChildIDs(t,u,[]),f=[];if(c.length>0)for(var m=0,v=n;m<v.length;m++){var b=v[m];-1!==r.inArray(b.getAttribute("data-uid"),c)&&f.push(b)}if(g.length>0)for(var S=0,y=n;S<y.length;S++){b=y[S];-1!==r.inArray(b.getAttribute("data-uid"),g)&&f.push(b)}t.enableNodes(f),sf.base.removeClass(f,"e-disable")}0===[].slice.call(t.element.querySelectorAll("li.e-disable")).length?t.collapseAll():t.expandAll(void 0,void 0,!0)}else if(this.parent.searchTreeItems=[],"olap"!==this.parent.dataType||a){s=[];var C=0;C=1;for(var w=0,x=this.parent.currentTreeItems;w<x.length;w++){var T=x[w];T.name.toLowerCase().indexOf(e.value.toLowerCase())>-1&&(this.parent.searchTreeItems.push(T),C<=this.parent.control.maxNodeLimitInMemberEditor&&s.push(T),C++)}--C>this.parent.control.maxNodeLimitInMemberEditor?(this.parent.editorLabelElement.innerText=C-this.parent.control.maxNodeLimitInMemberEditor+this.parent.control.localeObj.getConstant("editorDataLimitMsg"),this.parent.filterDialog.dialogPopUp.height=this.parent.filterDialog.allowExcelLikeFilter?"440px":"400px",this.parent.isDataOverflow=!0):(this.parent.editorLabelElement.innerText="",this.parent.filterDialog.dialogPopUp.height=this.parent.filterDialog.allowExcelLikeFilter?"400px":"350px",this.parent.isDataOverflow=!1),this.parent.isDataOverflow=C>this.parent.control.maxNodeLimitInMemberEditor,this.parent.editorLabelElement.parentElement.style.display=this.parent.isDataOverflow?"block":"none",t.fields={dataSource:s,id:"id",text:"name",isChecked:"isSelected",parentID:"pid"},t.dataBind()}else this.updateOlapSearchTree(e,t,a)},e.prototype.updateOlapSearchTree=function(e,t,i){var a=[],s=this.parent.filterDialog.dialogPopUp.element.getAttribute("data-fieldname");if(""===e.value.toLowerCase()){this.parent.filterDialog.isSearchEnabled=!1,this.parent.engineModule.fieldList[s].searchMembers=[];for(var n={},o={},l=this.parent.engineModule.fieldList[s].members,d=[],p=0,h=Object.keys(l);p<h.length;p++){l[g=h[p]].isSelected&&(l[g].parent&&l[l[g].parent].isSelected||d.push(g))}for(var u=0,c=d;u<c.length;u++){var g;n[g=c[u]]=g,o[g]=g,l[g]&&(o=this.getParentNode(s,g,o))}var f=this.parent.engineModule.fieldList[s].filterMembers;a=this.getFilteredTreeNodes(s,f,o,[],i),a=this.getOlapTreeData(!0,r.getClonedData(a),n,s,i,!0)}else{this.parent.filterDialog.isSearchEnabled=!0;f=this.parent.engineModule.fieldList[s].searchMembers;a=r.getClonedData(f),a=this.getOlapSearchTreeData(!0,a,s)}t.fields={dataSource:a,id:"id",text:"name",isChecked:"isSelected",parentID:"pid"},t.dataBind()},e.prototype.getTreeData=function(e,t,i,a){this.parent.currentTreeItems=[],this.parent.searchTreeItems=[],this.parent.currentTreeItemsPos={},this.parent.savedTreeFilterPos={};var s=this.parent.engineModule;this.parent.isDateField=s.formatFields[a]&&["date","dateTime","time"].indexOf(s.formatFields[a].type)>-1;for(var r=[],n=1,o={},l=0,d=i;l<d.length;l++){var p=d[l];o[p]=p}for(var h=0,u=t;h<u.length;h++){var c=u[h],g=this.parent.isDateField?c.formattedText:c.actualText.toString(),f={id:c.actualText.toString(),actualText:c.actualText,name:g,isSelected:!e};void 0!==o[g]&&(f.isSelected=!!e),n<=this.parent.control.maxNodeLimitInMemberEditor&&r.push(f),f.isSelected||(this.parent.savedTreeFilterPos[n-1]=g),this.parent.currentTreeItems.push(f),this.parent.searchTreeItems.push(f),this.parent.currentTreeItemsPos[c.actualText]={index:n-1,isSelected:f.isSelected},n++}return this.parent.isDataOverflow=n-1>this.parent.control.maxNodeLimitInMemberEditor,r},e.prototype.getOlapTreeData=function(e,t,i,a,s,r){var n=this.parent.engineModule.fieldList[a];this.parent.currentTreeItems=[],this.parent.searchTreeItems=[],this.parent.currentTreeItemsPos={};for(var o=[],l=1,d=0,p=t;d<p.length;d++){var h=p[d],u=h,c=h.id.toString();r||(u.isSelected=!e),void 0!==i[c]&&(u.isSelected=!!e),!r&&h.hasChildren&&this.updateChildNodeStates(n.filterMembers,a,h.id,u.isSelected),n.members[c].isSelected=u.isSelected,n.currrentMembers&&n.currrentMembers[c]&&(n.currrentMembers[c].isSelected=u.isSelected),l<=this.parent.control.maxNodeLimitInMemberEditor&&s&&o.push(u),this.parent.currentTreeItems.push(u),this.parent.searchTreeItems.push(u),this.parent.currentTreeItemsPos[c]={index:l-1,isSelected:u.isSelected},l++}return this.parent.isDataOverflow=!!s&&l-1>this.parent.control.maxNodeLimitInMemberEditor,s?o:t},e.prototype.getOlapSearchTreeData=function(e,t,i){for(var a=this.parent.engineModule.fieldList[i].members,s=0,r=t;s<r.length;s++){var n=r[s],o=n.id.toString();a[o]&&(n.isSelected=a[o].isSelected),this.parent.searchTreeItems.push(n)}return t},e.prototype.updateChildNodeStates=function(e,t,i,a){for(var s=this.parent.engineModule.fieldList[t].members,r=this.parent.engineModule.fieldList[t].currrentMembers,n=0,o=e;n<o.length;n++){var l=o[n];l.pid&&l.pid.toString()===i&&(s[l.id].isSelected=a,r&&r[l.id]&&(r[l.id].isSelected=a),l.hasChildren&&this.updateChildNodeStates(e,t,l.id,a))}},e.prototype.getParentNode=function(e,t,i){var a=this.parent.engineModule.fieldList[e].members;if(a[t].parent&&t!==a[t].parent){var s=a[t].parent;i[s]=s,this.getParentNode(e,s,i)}return i},e.prototype.getFilteredTreeNodes=function(e,t,i,a,s){for(var n=[],o=this.parent.engineModule.fieldList[e].members,l=0,d=i?Object.keys(i):[];l<d.length;l++){var p=o[d[l]].parent;void 0!==p&&-1===r.inArray(p,n)&&n.push(p)}for(var h=0,u=t;h<u.length;h++){var c=u[h];sf.base.isNullOrUndefined(c.pid)||-1!==r.inArray(c.pid,n)?(a.push(c),sf.base.isNullOrUndefined(c.pid)&&-1!==r.inArray(c.id,n)?o[c.id].isNodeExpand=!0:sf.base.isNullOrUndefined(c.pid)||-1===r.inArray(c.pid,n)?o[c.id].isNodeExpand=!1:(o[c.id].isNodeExpand=!1,o[c.pid].isNodeExpand=!0)):o[c.id].isNodeExpand=!1}return a},e}(),j=function(){function e(e){this.parent=e}return e.prototype.onStateModified=function(e,t){var i="",a=!0,s=sf.base.closest(e.target,".e-droppable"),r=-1;if(this.parent.dataSourceUpdate.btnElement=e.element?e.element.parentElement:void 0,s&&(i="e-rows"===s.classList[1]?"rows":"e-columns"===s.classList[1]?"columns":"e-values"===s.classList[1]?"values":"e-filters"===s.classList[1]?"filters":""),"olap"===this.parent.dataType){var n=this.parent.engineModule.fieldList[t]&&this.parent.engineModule.fieldList[t].isCalculatedField?this.parent.engineModule.fieldList[t].tag:t;if(e.cancel&&""===i)return a=!1;if(this.parent.dataSourceUpdate.btnElement&&"true"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&("filters"===i||"values"===i)||this.parent.dataSourceUpdate.btnElement&&"false"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&n.toLowerCase().indexOf("[measures].")>-1&&("filters"===i||"rows"===i||"columns"===i)||this.parent.dataSourceUpdate.btnElement&&"false"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&-1===n.toLowerCase().indexOf("[measures].")&&this.parent.engineModule.fieldList[t]&&this.parent.engineModule.fieldList[t].isNamedSets&&("filters"===i||"values"===i)||this.parent.dataSourceUpdate.btnElement&&"false"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&-1===n.toLowerCase().indexOf("[measures].")&&"values"===i){var o=this.parent.localeObj.getConstant("warning"),l=this.parent.localeObj.getConstant("fieldDropErrorAction");return this.parent.errorDialog.createErrorDialog(o,l),a=!1}}else if(e.cancel&&""===i||this.parent.dataSourceUpdate.btnElement&&"true"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&("filters"===i||"values"===i||i.indexOf(this.parent.dataSourceSettings.valueAxis)>-1))return a=!1;if(""!==i){if("olap"===this.parent.dataType)if((n=this.parent.engineModule.fieldList[t]&&this.parent.engineModule.fieldList[t].isCalculatedField?this.parent.engineModule.fieldList[t].tag:t).toLowerCase().indexOf("[measures].")>-1&&("filters"===i||"rows"===i||"columns"===i)||this.parent.engineModule.fieldList[t]&&this.parent.engineModule.fieldList[t].isNamedSets&&"filters"===i||-1===n.toLowerCase().indexOf("[measures].")&&"values"===i){o=this.parent.localeObj.getConstant("warning"),l=this.parent.localeObj.getConstant("fieldDropErrorAction");return this.parent.errorDialog.createErrorDialog(o,l),a=!1}if("pivot"===this.parent.dataType&&this.parent.engineModule.fieldList[t]&&"CalculatedField"===this.parent.engineModule.fieldList[t].aggregateType&&"values"!==i){o=this.parent.localeObj.getConstant("warning"),l=this.parent.localeObj.getConstant("dropAction");return this.parent.errorDialog.createErrorDialog(o,l),a=!1}r=this.getButtonPosition(e.target,i)}else this.parent.engineModule.fieldList[t]&&(this.parent.engineModule.fieldList[t].isSelected=!1,"olap"===this.parent.dataType&&this.parent.engineModule.updateFieldlistData(t));return this.parent.dataSourceUpdate.updateDataSource(t,i,r),!sf.base.isBlazor()&&a},e.prototype.getButtonPosition=function(e,t){var i=-1,a=sf.base.closest(e,".e-pvt-btn-div");if(!sf.base.isNullOrUndefined(a)){a=a.querySelector(".e-pivot-button");for(var s=this.parent.element.querySelector(".e-"+t),r=[].slice.call(s.querySelectorAll(".e-pivot-button")),n=0,o=r.length;n<o;n++)if(r[n].id===a.id){i=n;break}}return i},e}(),q=function(){function e(e){this.parent=e}return e.prototype.updateDataSource=function(e,t,i){for(var a,s,n=this,o=[this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.values,this.parent.dataSourceSettings.filters],l=0,d=o.length;l<d;l++)if(o[l])for(var p=0,h=o[l].length;p<h;p++)(o[l][p].name===e||"olap"===this.parent.dataType&&"[measures]"===o[l][p].name.toLowerCase()&&o[l][p].name.toLowerCase()===e)&&(s=0===l?"rows":1===l?"columns":2===l?"values":"filters"),s||(s="fieldList");var u={fieldName:e,dropField:r.getFieldInfo(e,this.control).fieldItem,dataSourceSettings:r.getClonedDataSourceSettings(this.parent.dataSourceSettings),dropAxis:t,dropPosition:i,draggedAxis:s,cancel:!1},c="pivotfieldlist"===this.control.getModuleName()&&this.control.isPopupView?this.control.pivotGridModule:this.control;c.trigger("fieldDrop",u,(function(s){if(!s.cancel){if(t=s.dropAxis,i=s.dropPosition,e=s.dropField?s.dropField.name:s.fieldName,a=s.dropField,n.control&&n.btnElement&&"true"===n.btnElement.getAttribute("isvalue"))switch(t){case"":n.control.setProperties({dataSourceSettings:{values:[]}},!0);break;case"rows":n.control.setProperties({dataSourceSettings:{valueAxis:"row"}},!0);break;case"columns":n.control.setProperties({dataSourceSettings:{valueAxis:"column"}},!0)}else n.removeFieldFromReport(e.toString()),"CalculatedField"===(a=n.getNewField(e.toString(),s.dropField)).type&&""!==t&&(t="values");if("olap"===n.parent.dataType&&(n.removeFieldFromReport(e.toString()),a=n.getNewField(e.toString(),s.dropField),0===n.parent.dataSourceSettings.values.length&&n.removeFieldFromReport("[measures]"),"CalculatedField"===a.type&&""!==t&&(t="values")),n.control){var o={fieldName:e,droppedField:a,dataSourceSettings:r.getClonedDataSourceSettings(n.parent.dataSourceSettings),droppedAxis:t,droppedPosition:i},l=n;c.trigger("onFieldDropped",o,(function(e){if(a=e.droppedField){switch(i=e.droppedPosition,t=e.droppedAxis){case"filters":-1!==i?sf.base.isBlazor()?l.parent.dataSourceSettings.filters.splice(i,0,a):n.parent.dataSourceSettings.filters.splice(i,0,a):sf.base.isBlazor()?l.parent.dataSourceSettings.filters.push(a):n.parent.dataSourceSettings.filters.push(a);break;case"rows":-1!==i?sf.base.isBlazor()?l.parent.dataSourceSettings.rows.splice(i,0,a):n.parent.dataSourceSettings.rows.splice(i,0,a):sf.base.isBlazor()?l.parent.dataSourceSettings.rows.push(a):n.parent.dataSourceSettings.rows.push(a);break;case"columns":-1!==i?sf.base.isBlazor()?l.parent.dataSourceSettings.columns.splice(i,0,a):n.parent.dataSourceSettings.columns.splice(i,0,a):sf.base.isBlazor()?l.parent.dataSourceSettings.columns.push(a):n.parent.dataSourceSettings.columns.push(a);break;case"values":if(-1!==i?sf.base.isBlazor()?l.parent.dataSourceSettings.values.splice(i,0,a):n.parent.dataSourceSettings.values.splice(i,0,a):sf.base.isBlazor()?l.parent.dataSourceSettings.values.push(a):n.parent.dataSourceSettings.values.push(a),sf.base.isBlazor()){if("olap"===l.parent.dataType&&!l.parent.engineModule.isMeasureAvail){var s={name:"[Measures]",caption:"Measures",showRemoveIcon:!0,allowDragAndDrop:!0};("row"===l.parent.dataSourceSettings.valueAxis?l.parent.dataSourceSettings.rows:l.parent.dataSourceSettings.columns).push(s)}}else if("olap"===n.parent.dataType&&!n.parent.engineModule.isMeasureAvail){s={name:"[Measures]",caption:"Measures",showRemoveIcon:!0,allowDragAndDrop:!0};("row"===n.parent.dataSourceSettings.valueAxis?n.parent.dataSourceSettings.rows:n.parent.dataSourceSettings.columns).push(s)}}sf.base.isBlazor()&&(l.parent.control.pivotButtonModule.updateDataSource(),l.parent.control.axisFieldModule.render())}}))}}}))},e.prototype.removeFieldFromReport=function(e){for(var t,i=!1,a=[this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.values,this.parent.dataSourceSettings.filters],s=this.parent.engineModule.fieldList[e],r=0,n=a.length;r<n;r++)if(!i&&a[r])for(var o=0,l=a[r].length;o<l;o++)if(a[r][o].name===e||"olap"===this.parent.dataType&&"[measures]"===a[r][o].name.toLowerCase()&&a[r][o].name.toLowerCase()===e){if((t=a[r][o].properties?a[r][o].properties:a[r][o]).type=s&&"number"===s.type?t.type:"Count",a[r].splice(o,1),"olap"===this.parent.dataType){var d=this.parent.engineModule;d&&d.fieldList[e]&&(d.fieldList[e].currrentMembers={},d.fieldList[e].searchMembers=[])}i=!0;break}return t},e.prototype.getNewField=function(e,t){var i;if("olap"===this.parent.dataType){var a=this.parent.engineModule.fieldList[e];i={name:t?t.name:e,caption:t?t.caption:a.caption,isNamedSet:t?t.isNamedSet:a.isNamedSets,isCalculatedField:t?t.isCalculatedField:a.isCalculatedField,type:t?void 0===t.type?"number"===a.type?"Sum":"Count":t.type:void 0===a.aggregateType?"number"===a.type?"Sum":"Count":a.aggregateType,showFilterIcon:t?t.showFilterIcon:a.showFilterIcon,showSortIcon:t?t.showSortIcon:a.showSortIcon,showEditIcon:t?t.showEditIcon:a.showEditIcon,showRemoveIcon:t?t.showRemoveIcon:a.showRemoveIcon,showValueTypeIcon:t?t.showValueTypeIcon:a.showValueTypeIcon,allowDragAndDrop:t?t.allowDragAndDrop:a.allowDragAndDrop,showSubTotals:t?t.showSubTotals:a.showSubTotals}}else{a=this.parent.engineModule.fieldList[e];i={name:t?t.name:e,caption:t?t.caption:a.caption,type:t?void 0===t.type||null===t.type?"number"===a.type?"Sum":"Count":t.type:void 0===a.aggregateType||null===a.aggregateType?"number"===a.type?"Sum":"Count":a.aggregateType,showNoDataItems:t?t.showNoDataItems:a.showNoDataItems,baseField:t?t.baseField:a.baseField,baseItem:t?t.baseItem:a.baseItem,allowDragAndDrop:t?t.allowDragAndDrop:a.allowDragAndDrop,showSubTotals:t?t.showSubTotals:a.showSubTotals,showFilterIcon:t?t.showFilterIcon:a.showFilterIcon,showSortIcon:t?t.showSortIcon:a.showSortIcon,showEditIcon:t?t.showEditIcon:a.showEditIcon,showRemoveIcon:t?t.showRemoveIcon:a.showRemoveIcon,showValueTypeIcon:t?t.showValueTypeIcon:a.showValueTypeIcon}}return i},e}(),V=function(){function e(e){this.parent=e}return e.prototype.createErrorDialog=function(e,t,i){var a=sf.base.createElement("div",{id:this.parent.parentID+"_ErrorDialog",className:"e-pivot-error-dialog"});this.parent.element.appendChild(a);var s=i?Number(i.style.zIndex)+1:"pivotfieldlist"===this.parent.moduleName&&"Popup"===this.parent.renderMode&&this.parent.control?this.parent.control.dialogRenderer.fieldListDialog.zIndex+1:"pivotfieldlist"===this.parent.moduleName&&"Fixed"===this.parent.renderMode&&this.parent.control||"pivotview"===this.parent.moduleName&&this.parent.control?1000002:1000001;this.errorPopUp=new sf.popups.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,header:e,content:t,isModal:!0,visible:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,width:"auto",height:"auto",zIndex:s,position:{X:"center",Y:"center"},buttons:[{click:this.closeErrorDialog.bind(this),buttonModel:{cssClass:"e-ok-btn",content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}}],closeOnEscape:!0,target:document.body,close:this.removeErrorDialog.bind(this)}),this.errorPopUp.isStringTemplate=!0,this.errorPopUp.appendTo(a)},e.prototype.closeErrorDialog=function(){this.errorPopUp.close()},e.prototype.removeErrorDialog=function(){this.errorPopUp&&!this.errorPopUp.isDestroyed&&this.errorPopUp.destroy(),document.getElementById(this.parent.parentID+"_ErrorDialog")&&sf.base.remove(document.getElementById(this.parent.parentID+"_ErrorDialog"))},e}(),B=function(){function e(e){this.parent=e}return e.prototype.createFilterDialog=function(e,t,i,a){var s=this,r=sf.base.createElement("div",{id:this.parent.parentID+"_EditorTreeView",className:"e-member-editor-dialog "+("olap"===this.parent.dataType?"e-olap-editor-dialog":""),attrs:{"data-fieldName":t,"aria-label":i}}),n=this.parent.engineModule.fieldList[t].caption,o=this.parent.localeObj.getConstant("filter")+' "'+i+'" '+this.parent.localeObj.getConstant("by");this.filterObject=this.getFilterObject(t),this.isSearchEnabled=!1,this.allowExcelLikeFilter=this.isExcelFilter(t),this.parent.element.appendChild(r),this.dialogPopUp=new sf.popups.Dialog({animationSettings:{effect:this.allowExcelLikeFilter?"None":"Fade"},allowDragging:!1,header:this.allowExcelLikeFilter?o:n,content:"",isModal:!0,visible:!0,showCloseIcon:!!this.allowExcelLikeFilter,enableRtl:this.parent.enableRtl,width:"auto",height:this.parent.isDataOverflow?this.allowExcelLikeFilter?"440px":"400px":this.allowExcelLikeFilter?"400px":"350px",position:{X:"center",Y:"center"},buttons:[{buttonModel:{cssClass:"e-clear-filter-button"+(this.allowExcelLikeFilter?"":" e-disable"),iconCss:"e-icons e-clear-filter-icon",enableRtl:this.parent.enableRtl,content:this.parent.localeObj.getConstant("clearFilter"),disabled:!this.filterObject}},{buttonModel:{cssClass:"e-ok-btn",content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:this.closeFilterDialog.bind(this),buttonModel:{cssClass:"e-cancel-btn",content:this.parent.localeObj.getConstant("cancel")}}],closeOnEscape:"Popup"!==this.parent.renderMode,target:a,close:this.removeFilterDialog.bind(this)}),this.dialogPopUp.isStringTemplate=!0,this.dialogPopUp.appendTo(r);var l={cancel:!1,fieldName:t,fieldMembers:this.parent.dataSourceSettings.allowMemberFilter?e:[],filterSetting:this.filterObject};("pivotfieldlist"===this.parent.moduleName&&this.parent.control.isPopupView?this.parent.control.pivotGridModule:this.parent.control).trigger("memberEditorOpen",l,(function(a){a.cancel?(s.dialogPopUp.close(),s.dialogPopUp=void 0):(e=a.fieldMembers,s.allowExcelLikeFilter?(s.createTabMenu(e,i,t),sf.base.addClass([s.dialogPopUp.element],"e-excel-filter"),s.updateCheckedState(i)):(s.dialogPopUp.content=s.createTreeView(e,i,t),s.updateCheckedState(i)),sf.base.setStyleAttribute(s.dialogPopUp.element,{visibility:"visible"}),s.allowExcelLikeFilter&&s.dialogPopUp.element.querySelector(".e-dlg-closeicon-btn").focus(),s.parent.control.pivotButtonModule.memberTreeView=s.parent.filterDialog.memberTreeView,s.memberTreeView.nodeChecked=s.parent.control.pivotButtonModule.nodeStateModified.bind(s.parent.control.pivotButtonModule),s.allMemberSelect.nodeChecked=s.parent.control.pivotButtonModule.nodeStateModified.bind(s.parent.control.pivotButtonModule))}))},e.prototype.createTreeView=function(e,t,i){var a=this,s=sf.base.createElement("div",{id:this.parent.parentID+"EditorDiv",className:"e-member-editor-wrapper"+(this.allowExcelLikeFilter?" e-excelfilter":"")}),r=sf.base.createElement("button",{id:this.parent.parentID+"_LevelDiv",className:"e-level-wrapper-class",attrs:{type:"button"}}),n=sf.base.createElement("div",{id:this.parent.parentID+"_SearchDiv",attrs:{tabindex:"-1"},className:"e-editor-search-wrapper"}),o=this.parent.engineModule.fieldList[i].caption,l=sf.base.createElement("input",{attrs:{type:"text",className:"e-editor-search-input"}}),d=this.parent.isDataOverflow?this.parent.currentTreeItems.length-this.parent.control.maxNodeLimitInMemberEditor+this.parent.control.localeObj.getConstant("editorDataLimitMsg"):"",p=sf.base.createElement("div",{id:this.parent.parentID+"_LabelDiv",attrs:{tabindex:"-1",title:d},className:"e-editor-label-wrapper"});this.parent.editorLabelElement=sf.base.createElement("label",{className:"e-editor-label"}),this.parent.editorLabelElement.innerText=d,p.style.display=this.parent.isDataOverflow?"block":"none",p.appendChild(this.parent.editorLabelElement),n.appendChild(l),this.createSortOptions(i,n,e);var h=sf.base.createElement("div",{id:this.parent.parentID+"_AllDiv",attrs:{tabindex:"-1"},className:"e-select-all-wrapper"}),u=sf.base.createElement("div",{className:"e-select-all"}),c=sf.base.createElement("div",{className:"e-member-editor-container-outer-div"}),g=sf.base.createElement("div",{className:"e-member-editor-container"}),f=sf.base.createElement("div",{className:"e-member-prompt e-disable",innerHTML:this.parent.localeObj.getConstant("noMatches")});"olap"!==this.parent.dataType||!this.parent.control.loadOnDemandInMemberEditor||this.parent.engineModule.fieldList[i].isHierarchy||this.parent.engineModule.fieldList[i].isNamedSets||(n.appendChild(r),this.createLevelWrapper(r,i)),h.appendChild(u),s.appendChild(n),s.appendChild(h),s.appendChild(f),this.editorSearch=new sf.inputs.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("search")+' "'+o+'"',enableRtl:this.parent.enableRtl,cssClass:"e-editor-search",showClearButton:!0,change:function(e){if("olap"===a.parent.dataType)a.searchOlapTreeView(e,f,t);else{a.parent.eventBase.searchTreeNodes(e,a.memberTreeView,!1);var i=a.dialogPopUp.element;0===[].slice.call(a.memberTreeView.element.querySelectorAll("li")).length?(a.allMemberSelect.disableNodes([a.allMemberSelect.element.querySelector("li")]),i.querySelector(".e-ok-btn").setAttribute("disabled","disabled"),sf.base.removeClass([f],"e-disable")):(a.allMemberSelect.enableNodes([a.allMemberSelect.element.querySelector("li")]),i.querySelector(".e-ok-btn").removeAttribute("disabled"),sf.base.addClass([f],"e-disable")),a.updateCheckedState(t)}}}),this.editorSearch.isStringTemplate=!0,this.editorSearch.appendTo(l);var m={"data-fieldName":i},v=[{id:"all",name:this.parent.localeObj.getConstant("all"),isSelected:!0,htmlAttributes:m}];if(this.allMemberSelect=new sf.navigations.TreeView({fields:{dataSource:v,id:"id",text:"name",isChecked:"isSelected"},showCheckBox:!0,expandOn:"None",enableRtl:this.parent.enableRtl,nodeClicked:this.nodeCheck.bind(this,!0),keyPress:this.nodeCheck.bind(this,!0),nodeSelected:function(e){sf.base.removeClass([e.node],"e-active"),e.cancel=!0}}),this.allMemberSelect.isStringTemplate=!0,!sf.base.isNullOrUndefined(this.parent.currentTreeItems))for(var b=0;b<this.parent.currentTreeItems.length;b++)(this.parent.currentTreeItems[b].id.indexOf("\n")||this.parent.currentTreeItems[b].id.startsWith("\n"))&&(this.parent.currentTreeItems[b].id=this.parent.currentTreeItems[b].id.replace("\n"," "));return this.allMemberSelect.appendTo(u),c.appendChild(g),s.appendChild(c),this.memberTreeView=new sf.navigations.TreeView({fields:{dataSource:e,id:"id",text:"name",isChecked:"isSelected",parentID:"pid"},showCheckBox:!0,enableRtl:this.parent.enableRtl,nodeChecking:this.validateTreeNode.bind(this),nodeClicked:this.nodeCheck.bind(this,!1),keyPress:this.nodeCheck.bind(this,!1),nodeExpanding:this.updateChildNodes.bind(this),nodeSelected:function(e){sf.base.removeClass([e.node],"e-active"),e.cancel=!0},expandOn:"None"}),this.memberTreeView.isStringTemplate=!0,this.memberTreeView.appendTo(g),s.appendChild(p),s},e.prototype.createSortOptions=function(e,t,i){if("pivot"===this.parent.dataType&&i&&i.length>0){var a=this.parent.engineModule.fieldList[e].sort,s=sf.base.createElement("div",{className:"e-filter-sort e-btn-group"+(this.parent.enableRtl?" "+c:""),id:this.parent.element.id+"_Member_Sort"});this.parent.element.appendChild(s);var r=sf.base.createElement("button",{className:("Ascending"===a?"e-active ":"")+"e-member-sort",id:this.parent.element.id+"_Sort_Ascend",attrs:{type:"button"}}),n=sf.base.createElement("button",{className:("Descending"===a?"e-active ":"")+"e-member-sort",id:this.parent.element.id+"_Sort_Descend",attrs:{type:"button"}}),o=new sf.buttons.Button({iconCss:f+" e-sort-ascend-icon",enableRtl:this.parent.enableRtl});o.appendTo(r),(o=new sf.buttons.Button({iconCss:f+" e-sort-descend-icon",enableRtl:this.parent.enableRtl})).appendTo(n),s.appendChild(r),s.appendChild(n),t.appendChild(s),this.unWireEvent(r,e),this.unWireEvent(n,e),this.wireEvent(r,e),this.wireEvent(n,e)}},e.prototype.createLevelWrapper=function(e,t){for(var i=this,a=this.parent.engineModule,s=a.fieldList[t].levels,r=a.fieldList[t].levelCount,n=[],o=0,l=s.length;o<l;o++)n.push({id:s[o].id,text:s[o].name});this.dropMenu=new sf.splitbuttons.DropDownButton({cssClass:"e-level-drop e-caret-hide",items:n,iconCss:"e-icons e-dropdown-icon",disabled:r===s.length,beforeOpen:function(e){var a=[].slice.call(e.element.querySelectorAll("li")),s=i.parent.engineModule.fieldList[t].levelCount;sf.base.removeClass(a,"e-disabled");for(var r=0,n=a.length;r<n;r++)r<s&&sf.base.addClass([a[r]],"e-disabled")},select:function(e){for(var t,a=i.dialogPopUp.element.getAttribute("data-fieldname"),s=i.parent.engineModule,r=0,o=n.length;r<o;r++)n[r].id===e.item.id&&(t=r);s.getFilterMembers(i.parent.dataSourceSettings,a,t+1,!1,!0)},close:function(){var e=i.parent.engineModule,a=e.fieldList[t].levels;e.fieldList[t].levelCount===a.length?(i.dropMenu.disabled=!0,i.dropMenu.dataBind()):i.dropMenu.disabled=!1}}),this.dropMenu.appendTo(e)},e.prototype.searchOlapTreeView=function(e,t,i){var a=this;clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout((function(){var s=a.parent.engineModule,r=a.dialogPopUp.element,n=r.getAttribute("data-fieldname"),o=a.parent.control.maxNodeLimitInMemberEditor?a.parent.control.maxNodeLimitInMemberEditor:5e3;if(s.fieldList[n].isHierarchy)a.parent.eventBase.searchTreeNodes(e,a.memberTreeView,!1,!0);else{if(a.dropMenu&&""!==e.value?a.dropMenu.disabled=!0:a.dropMenu.disabled=!1,a.parent.control.loadOnDemandInMemberEditor){var l=s.fieldList[n].levelCount?s.fieldList[n].levelCount:1;s.getSearchMembers(a.parent.dataSourceSettings,n,e.value.toLowerCase(),o,!1,l)}else s.getSearchMembers(a.parent.dataSourceSettings,n,e.value.toLowerCase(),o,!0);a.parent.eventBase.searchTreeNodes(e,a.memberTreeView,!1,!1)}0===[].slice.call(a.memberTreeView.element.querySelectorAll("li")).length?(a.allMemberSelect.disableNodes([a.allMemberSelect.element.querySelector("li")]),r.querySelector(".e-ok-btn").setAttribute("disabled","disabled"),sf.base.removeClass([t],"e-disable")):(a.allMemberSelect.enableNodes([a.allMemberSelect.element.querySelector("li")]),r.querySelector(".e-ok-btn").removeAttribute("disabled"),sf.base.addClass([t],"e-disable")),a.updateCheckedState(i)}),500)},e.prototype.nodeCheck=function(e,t){var i=[t.node];if(t.event.target.classList.contains("e-fullrow")||"Enter"===t.event.key){var a=e?this.allMemberSelect:this.memberTreeView;"true"===a.getNode(t.node).isChecked?a.uncheckAll(i):a.checkAll(i)}else 38!==t.event.keyCode||e||(sf.base.removeClass(this.memberTreeView.element.querySelectorAll("li.e-prev-active-node"),"e-prev-active-node"),sf.base.addClass(i,"e-prev-active-node"))},e.prototype.applySorting=function(e,t){var i=sf.base.closest(t.target,".e-member-sort");if(i){var a=[].slice.call(sf.base.closest(i,".e-filter-sort").querySelectorAll(".e-member-sort"));i.querySelector(".e-sort-ascend-icon")&&!i.classList.contains("e-active")?(this.updateFilterMembers("Ascending",e),sf.base.addClass([i],"e-active"),sf.base.removeClass([a[1]],"e-active")):i.querySelector(".e-sort-descend-icon")&&!i.classList.contains("e-active")?(this.updateFilterMembers("Descending",e),sf.base.addClass([i],"e-active"),sf.base.removeClass([a[0]],"e-active")):(this.updateFilterMembers("None",e),sf.base.removeClass(a,"e-active"))}},e.prototype.updateFilterMembers=function(e,t){var i="None"===e?r.getClonedData(this.parent.engineModule.fieldList[t].dateMember):this.parent.currentTreeItems.slice();this.parent.currentTreeItems=[],this.parent.searchTreeItems=[];for(var a=[],s=0,n=(i="Ascending"===e?i.sort((function(e,t){return e.actualText>t.actualText?1:t.actualText>e.actualText?-1:0})):"Descending"===e?i.sort((function(e,t){return e.actualText<t.actualText?1:t.actualText<e.actualText?-1:0})):i).length;s<n;s++){if("None"===e){var o=(this.parent.isDateField?i[s].formattedText:i[s].actualText).toString(),l={id:i[s].actualText.toString(),actualText:i[s].actualText,name:o,isSelected:this.parent.currentTreeItemsPos[i[s].actualText].isSelected};this.parent.currentTreeItems.push(l),""!==this.editorSearch.value?l.name.toLowerCase().indexOf(this.editorSearch.value.toLowerCase())>-1&&(this.parent.searchTreeItems.push(l),a.push(l)):(this.parent.searchTreeItems.push(l),a.push(l))}else this.parent.currentTreeItems.push(i[s]),""!==this.editorSearch.value?i[s].name.toLowerCase().indexOf(this.editorSearch.value.toLowerCase())>-1&&(this.parent.searchTreeItems.push(i[s]),a.push(i[s])):(this.parent.searchTreeItems.push(i[s]),a.push(i[s]));this.parent.currentTreeItemsPos[i[s].actualText].index=s}var d=this.memberTreeView.fields.dataSource.length;this.memberTreeView.fields={dataSource:a.slice(0,d),id:"id",text:"name",isChecked:"isSelected",parentID:"pid"},this.memberTreeView.dataBind()},e.prototype.updateChildNodes=function(e){if("olap"===this.parent.dataType){var t=this.parent.engineModule,i=e.node.getAttribute("data-fieldname"),a=t.fieldList[i],s=[];if(a&&a.filterMembers.length>0&&!this.isSearchEnabled&&!a.members[e.nodeData.id].isNodeExpand){for(var n=[],o=0,l=a.filterMembers;o<l.length;o++){var d=l[o];d.pid===e.nodeData.id.toString()&&n.push(d)}0===n.length&&(a.childMembers=[],t.getChildMembers(this.parent.dataSourceSettings,e.nodeData.id.toString(),i),n=a.childMembers,a.childMembers=[]);var p=r.getClonedData(n),h=this.memberTreeView.fields.dataSource,u=!1;sf.base.isNullOrUndefined(this.filterObject)||(u="Include"===this.filterObject.type,s=this.filterObject.items?this.filterObject.items:[]),p=this.updateChildData(u,p,s,i,e.nodeData);for(var c=0,g=p=this.parent.eventBase.sortOlapFilterData(p,t.fieldList[i].sort);c<g.length;c++){var f=g[c];h.push(f)}a.members[e.nodeData.id].isNodeExpand=!0,this.memberTreeView.addNodes(p,e.node)}}},e.prototype.updateChildData=function(e,t,i,a,s){for(var r=Object.keys(this.parent.currentTreeItemsPos).length,n=this.parent.engineModule.fieldList[a],o=[],l=1,d=0,p=t;d<p.length;d++){var h=p[d],u=h,c=h.id.toString();n.members[c].isNodeExpand=!1,h.isSelected="true"===s.isChecked,l<=this.parent.control.maxNodeLimitInMemberEditor&&o.push(u),this.parent.currentTreeItems.push(u),this.parent.searchTreeItems.push(u),this.parent.currentTreeItemsPos[c]={index:r,isSelected:u.isSelected},r++,l++}return this.parent.isDataOverflow=!1,o},e.prototype.createTabMenu=function(e,t,i){var a=sf.base.createElement("div",{className:"e-filter-tab-wrapper"});this.dialogPopUp.content=a,this.dialogPopUp.dataBind();for(var s=["Label","Value","Include","Exclude"],n="((-|\\+)?[0-9]+(\\.[0-9]+)?)+",o=Object.keys(this.parent.engineModule.fieldList[i].members)[0],l=this.parent.engineModule.fieldList[i].type,d=r.getFieldByName(i,this.parent.dataSourceSettings.formatSettings),p=[{header:{text:this.parent.localeObj.getConstant("member"),iconCss:this.filterObject&&s.indexOf(this.filterObject.type)>1?"e-selected-option-icon":""},content:this.createTreeView(e,t,i)}],h=0,u=s;h<u.length;h++){var c=u[h];if("Label"===c&&this.parent.dataSourceSettings.allowLabelFilter||"Value"===c&&this.parent.dataSourceSettings.allowValueFilter){var g="Label"===c&&o&&o.match(n)&&o.match(n)[0].length===o.length&&"number"===l?"Number":"Label"===c&&o&&"Invalid Date"!==new Date(o).toString()&&(d&&d.type||this.filterObject&&"Date"===this.filterObject.type)?"Date":c,f={header:{text:"Number"===g?this.parent.localeObj.getConstant("label"):this.parent.localeObj.getConstant(g.toLowerCase()),iconCss:this.filterObject&&this.filterObject.type===g?"e-selected-option-icon":""},content:this.createCustomFilter(i,this.filterObject&&this.filterObject.type===g?this.filterObject:void 0,g.toLowerCase())};p.push(f)}}var m=this.filterObject?["Label","Date","Number"].indexOf(this.filterObject.type)>=0?1:"Value"===this.filterObject.type?this.parent.dataSourceSettings.allowLabelFilter&&this.parent.dataSourceSettings.allowValueFilter?2:1:0:0;m=this.parent.dataSourceSettings.allowMemberFilter||0!==m?m:1,this.tabObj=new sf.navigations.Tab({heightAdjustMode:"Auto",items:p,height:"100%",selectedItem:m,enableRtl:this.parent.enableRtl}),this.tabObj.isStringTemplate=!0,this.tabObj.appendTo(a),this.parent.dataSourceSettings.allowMemberFilter||this.tabObj.hideTab(0),m>0&&sf.base.addClass([this.dialogPopUp.element.querySelector(".e-filter-div-content."+(1===m&&this.parent.dataSourceSettings.allowLabelFilter?"e-label-filter":"e-value-filter"))],"e-selected-tab")},e.prototype.createCustomFilter=function(e,t,i){for(var a=[],s=[],r=[],n=this.parent.dataSourceSettings.values,o="DoesNotEquals",l=0,d=0,p={label:["Equals","DoesNotEquals","BeginWith","DoesNotBeginWith","EndsWith","DoesNotEndsWith","Contains","DoesNotContains","GreaterThan","GreaterThanOrEqualTo","LessThan","LessThanOrEqualTo","Between","NotBetween"],date:["Equals","DoesNotEquals","Before","BeforeOrEqualTo","After","AfterOrEqualTo","Between","NotBetween"],value:["Equals","DoesNotEquals","GreaterThan","GreaterThanOrEqualTo","LessThan","LessThanOrEqualTo","Between","NotBetween"]},h=["Between","NotBetween"],u="label"===i?p.label:"date"===i?p.date:p.value,c=0,g=u;c<g.length;c++){var m=g[c];o=t&&m===t.condition?u.indexOf(t.condition)>=0?t.condition:u[0]:o,a.push({value:m,text:this.parent.localeObj.getConstant(m)})}for(var v=n.length;v--;)s.unshift({value:n[v].name,text:n[v].caption?n[v].caption:n[v].name}),l=t&&"Value"===t.type&&t.measure===n[v].name&&t.condition===o?v:l;if("olap"===this.parent.dataType){var b=this.parent.engineModule,S=b.fieldList[e].levels;if(this.parent.engineModule.fieldList[e].isHierarchy){for(var y=void 0,C=0,w=this.parent.engineModule.fieldListData;C<w.length;C++){var x=w[C];if(x&&x.pid===e){y=x;break}}r.push({value:y?y.id:e,text:y?y.caption:b.fieldList[e].name}),d=0,t&&t.name===e&&t.type.toLowerCase()===i&&(r[r.length-1].iconClass=f+" e-selected-level-icon")}else for(var T=0,M=S.length;T<M;T++){d=t&&t.selectedField===S[T].id?T:d,r.push({value:S[T].id,text:S[T].name});for(var D=0,E=this.parent.dataSourceSettings.filterSettings;D<E.length;D++){var O=E[D];if(O.name===e&&O.selectedField===S[T].id&&O.type.toLowerCase()===i){r[r.length-1].iconClass=f+" e-selected-level-icon";break}}}}var P=sf.base.createElement("div",{className:"e-filter-div-content e-"+(["date","number"].indexOf(i)>=0?"label":i)+"-filter",id:this.parent.parentID+"_"+i+"_filter_div_content",attrs:{"data-type":i,"data-fieldName":e,"data-operator":o,"data-selectedField":"olap"===this.parent.dataType&&r.length>0?r[d].value.toString():"","data-measure":this.parent.dataSourceSettings.values.length>0?this.parent.dataSourceSettings.values[l].name:"","data-value1":t&&o===t.condition&&t.value1?t.value1.toString():"","data-value2":t&&o===t.condition&&t.value2?t.value2.toString():""}}),N=sf.base.createElement("div",{className:"e-filter-text-div",innerHTML:this.parent.localeObj.getConstant(i+"TextContent")}),F=sf.base.createElement("div",{className:"e-between-text-div "+(-1===h.indexOf(o)?"e-disable":""),innerHTML:this.parent.localeObj.getConstant("And")}),I=sf.base.createElement("div",{className:"e-separator-div"}),L=sf.base.createElement("div",{className:"e-filter-option-wrapper-1"}),A=sf.base.createElement("div",{className:"e-level-option-wrapper "+("olap"===this.parent.dataType?"":"e-disable")}),R=sf.base.createElement("div",{className:"e-measure-option-wrapper "+(["label","date","number"].indexOf(i)>=0?"e-disable":"")}),k=sf.base.createElement("div",{className:"e-condition-option-wrapper"}),j=sf.base.createElement("div",{className:"e-filter-option-wrapper-2"}),q=sf.base.createElement("div",{id:this.parent.parentID+"_"+i+"_level_option_wrapper"}),V=sf.base.createElement("div",{id:this.parent.parentID+"_"+i+"_measure_option_wrapper"}),B=sf.base.createElement("div",{id:this.parent.parentID+"_"+i+"_contition_option_wrapper"}),_=sf.base.createElement("div",{className:"e-filter-input-div-1"}),H=sf.base.createElement("div",{className:"e-filter-input-div-2 "+(-1===h.indexOf(o)?"e-disable":"")}),U=sf.base.createElement("input",{id:this.parent.parentID+"_"+i+"_input_option_1",attrs:{type:"text"}}),G=sf.base.createElement("input",{id:this.parent.parentID+"_"+i+"_input_option_2",attrs:{type:"text"}});return _.appendChild(U),H.appendChild(G),A.appendChild(q),A.appendChild(I.cloneNode(!0)),R.appendChild(V),R.appendChild(I),k.appendChild(B),L.appendChild(A),L.appendChild(R),L.appendChild(k),j.appendChild(_),j.appendChild(F),j.appendChild(H),this.createElements(t,h,V,B,U,G,s,a,l,o,i,q,r,d),P.appendChild(N),P.appendChild(L),P.appendChild(j),P},e.prototype.createElements=function(e,t,i,a,s,r,n,o,l,d,p,h,u,c){var g=this;if("olap"===this.parent.dataType){var f=new sf.dropdowns.DropDownList({dataSource:u,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text",iconCss:"iconClass"},index:c,cssClass:"e-level-options",width:"100%",change:function(e){var t=g.dialogPopUp.element.querySelector(".e-selected-tab"),i=t.getAttribute("data-fieldName"),a=t.getAttribute("data-type");if(!sf.base.isNullOrUndefined(t)){var o;g.updateInputValues(t,a,s,r),sf.grids.setStyleAndAttributes(t,{"data-selectedField":e.value});for(var l=0,d=g.parent.dataSourceSettings.filterSettings;l<d.length;l++){var p=d[l];if(p.name===i&&p.selectedField===e.value){o=p;break}}if(o){"value"===a&&o.measure&&""!==o.measure&&(m.value=o.measure?o.measure:n[0].value),o.condition?v.value=o.condition?o.condition:"DoesNotEquals":v.value="DoesNotEquals";var h=void 0,u=void 0;"value"===a?(h=s.ej2_instances[0],u=r.ej2_instances[0],h&&(h.value=o.value1?parseInt(o.value1,10):void 0),u&&(u.value=o.value2?parseInt(o.value2,10):void 0)):(h=s.ej2_instances[0],u=r.ej2_instances[0],h&&(h.value=o.value1?o.value1:""),u&&(u.value=o.value2?o.value2:""))}g.updateInputValues(t,a,s,r)}}});f.isStringTemplate=!0,f.appendTo(h)}var m=new sf.dropdowns.DropDownList({dataSource:n,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text"},index:l,cssClass:"e-value-options",width:"100%",change:function(e){var t=g.dialogPopUp.element.querySelector(".e-selected-tab");sf.base.isNullOrUndefined(t)||(g.updateInputValues(t,p,s,r),sf.grids.setStyleAndAttributes(t,{"data-measure":e.value}))}});m.isStringTemplate=!0,m.appendTo(i);var v=new sf.dropdowns.DropDownList({dataSource:o,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text"},value:d,cssClass:"e-filter-operator",width:"100%",change:function(e){var i=g.dialogPopUp.element.querySelector(".e-selected-tab");if(!sf.base.isNullOrUndefined(i)){g.updateInputValues(i,p,s,r);for(var a=0,n=["e-between-text-div","e-filter-input-div-2"];a<n.length;a++){var o=n[a];t.indexOf(e.value)>=0?sf.base.removeClass([i.querySelector("."+o)],"e-disable"):sf.base.addClass([i.querySelector("."+o)],"e-disable")}sf.grids.setStyleAndAttributes(i,{"data-operator":e.value})}}});if(v.isStringTemplate=!0,v.appendTo(a),"date"===p){var b=new sf.calendars.DateTimePicker({placeholder:this.parent.localeObj.getConstant("chooseDate"),enableRtl:this.parent.enableRtl,format:"dd/MM/yyyy hh:mm:ss a",showClearButton:!0,value:e&&d===e.condition?"string"==typeof e.value1?new Date(e.value1):e.value1:null,change:function(e){var t=g.dialogPopUp.element.querySelector(".e-selected-tab");sf.base.isNullOrUndefined(t)||sf.grids.setStyleAndAttributes(t,{"data-value1":e.value,"data-value2":S.value})},width:"100%"}),S=new sf.calendars.DateTimePicker({placeholder:this.parent.localeObj.getConstant("chooseDate"),enableRtl:this.parent.enableRtl,format:"dd/MM/yyyy hh:mm:ss a",showClearButton:!0,value:e&&d===e.condition?"string"==typeof e.value2?new Date(e.value2):e.value2:null,change:function(e){var t=g.dialogPopUp.element.querySelector(".e-selected-tab");sf.base.isNullOrUndefined(t)||sf.grids.setStyleAndAttributes(t,{"data-value1":b.value,"data-value2":e.value})},width:"100%"});b.isStringTemplate=!0,b.appendTo(s),S.isStringTemplate=!0,S.appendTo(r)}else if("value"===p){var y=new sf.inputs.NumericTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,showClearButton:!0,format:"###.##",value:e&&d===e.condition?parseInt(e.value1,10):void 0,change:function(e){var t=g.dialogPopUp.element.querySelector(".e-selected-tab");sf.base.isNullOrUndefined(t)||sf.grids.setStyleAndAttributes(t,{"data-value1":e.value?e.value.toString():"0","data-value2":C.value?C.value.toString():"0"})},width:"100%"}),C=new sf.inputs.NumericTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,showClearButton:!0,format:"###.##",value:e&&d===e.condition?parseInt(e.value2,10):void 0,change:function(e){var t=g.dialogPopUp.element.querySelector(".e-selected-tab");sf.base.isNullOrUndefined(t)||sf.grids.setStyleAndAttributes(t,{"data-value1":y.value?y.value.toString():"0","data-value2":e.value?e.value.toString():"0"})},width:"100%"});y.isStringTemplate=!0,y.appendTo(s),C.isStringTemplate=!0,C.appendTo(r)}else{var w=new sf.inputs.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,showClearButton:!0,value:e&&d===e.condition?e.value1:"",change:function(e){var t=g.dialogPopUp.element.querySelector(".e-selected-tab");sf.base.isNullOrUndefined(t)||sf.grids.setStyleAndAttributes(t,{"data-value1":e.value,"data-value2":x.value})},width:"100%"}),x=new sf.inputs.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,showClearButton:!0,value:e&&d===e.condition?e.value2:"",change:function(e){var t=g.dialogPopUp.element.querySelector(".e-selected-tab");sf.base.isNullOrUndefined(t)||sf.grids.setStyleAndAttributes(t,{"data-value1":w.value,"data-value2":e.value})},width:"100%"});w.isStringTemplate=!0,w.appendTo(s),x.isStringTemplate=!0,x.appendTo(r)}},e.prototype.updateInputValues=function(e,t,i,a){var s,r;if("date"===t){var n=i.ej2_instances[0],o=a.ej2_instances[0];s=sf.base.isNullOrUndefined(n.value)?"":n.value.toString(),r=sf.base.isNullOrUndefined(o.value)?"":o.value.toString()}else{n=i.ej2_instances[0],o=a.ej2_instances[0];s=n.value,r=o.value}sf.grids.setStyleAndAttributes(e,{"data-value1":s,"data-value2":r})},e.prototype.validateTreeNode=function(e){e.node.classList.contains("e-disable")&&(e.cancel=!0)},e.prototype.updateCheckedState=function(e){var t=this.dialogPopUp.element;sf.grids.setStyleAndAttributes(t,{role:"menu","aria-haspopup":"true"});var i=[].slice.call(this.memberTreeView.element.querySelectorAll("li")),a=t.getAttribute("data-fieldname"),s=this.getUnCheckedNodes(a),r=this.getCheckedNodes(a),n=this.allMemberSelect.element.querySelector("li").querySelector("span.e-frame");i.length>0?r>0?(s>0?(sf.base.removeClass([n],"e-check"),sf.base.addClass([n],"e-stop")):0===s&&(sf.base.removeClass([n],"e-stop"),sf.base.addClass([n],"e-check")),this.dialogPopUp.buttons[0].buttonModel.disabled=!1,t.querySelector(".e-ok-btn").removeAttribute("disabled")):s>0&&0===r&&(sf.base.removeClass([n],["e-check","e-stop"]),this.getCheckedNodes(a)===r&&(this.dialogPopUp.buttons[0].buttonModel.disabled=!0,t.querySelector(".e-ok-btn").setAttribute("disabled","disabled"))):(this.dialogPopUp.buttons[0].buttonModel.disabled=!0,t.querySelector(".e-ok-btn").setAttribute("disabled","disabled"))},e.prototype.getCheckedNodes=function(e){var t=this.parent.engineModule,i=[];if("olap"===this.parent.dataType&&t&&!t.fieldList[e].isHierarchy)return this.memberTreeView.getAllCheckedNodes().length;for(var a=0,s=this.parent.searchTreeItems;a<s.length;a++){var r=s[a];r.isSelected&&i.push(r)}return i.length},e.prototype.getUnCheckedNodes=function(e){var t=[],i=[],a=this.parent.engineModule;if("olap"===this.parent.dataType&&a&&!a.fieldList[e].isHierarchy)return i=this.memberTreeView.getAllCheckedNodes(),this.memberTreeView.fields.dataSource.length-i.length;for(var s=0,r=this.parent.searchTreeItems;s<r.length;s++){var n=r[s];n.isSelected||t.push(n)}return t.length},e.prototype.isExcelFilter=function(e){for(var t=!1,i=0,a=this.parent.dataSourceSettings.filters;i<a.length;i++){if(a[i].name===e){t=!0;break}}return!(t||!this.parent.dataSourceSettings.allowLabelFilter&&!this.parent.dataSourceSettings.allowValueFilter)},e.prototype.getFilterObject=function(e){var t=r.getFilterItemByName(e,r.cloneFilterSettings(this.parent.dataSourceSettings.filterSettings));if(t&&(["Label","Date","Number"].indexOf(t.type)>=0&&this.parent.dataSourceSettings.allowLabelFilter||"Value"===t.type&&this.parent.dataSourceSettings.allowValueFilter||["Include","Exclude"].indexOf(t.type)>=0&&this.parent.eventBase.isValidFilterItemsAvail(e,t)))return t},e.prototype.wireEvent=function(e,t){sf.base.EventHandler.add(e,"click",this.applySorting.bind(this,t),this)},e.prototype.unWireEvent=function(e,t){sf.base.EventHandler.remove(e,"click",this.applySorting)},e.prototype.closeFilterDialog=function(){this.allowExcelLikeFilter&&this.tabObj&&!this.tabObj.isDestroyed&&this.tabObj.destroy(),this.dropMenu&&!this.dropMenu.isDestroyed&&this.dropMenu.destroy(),document.getElementById(this.parent.parentID+"_LevelDiv-popup")&&sf.base.remove(document.getElementById(this.parent.parentID+"_LevelDiv-popup")),this.dialogPopUp.close()},e.prototype.removeFilterDialog=function(){this.dialogPopUp&&!this.dialogPopUp.isDestroyed&&this.dialogPopUp.destroy(),document.getElementById(this.parent.parentID+"_EditorTreeView")&&sf.base.remove(document.getElementById(this.parent.parentID+"_EditorTreeView"))},e}(),_=function(){function e(e){return this.currentTreeItems=[],this.savedTreeFilterPos={},this.currentTreeItemsPos={},this.searchTreeItems=[],this.isDataOverflow=!1,this.isDateField=!1,this.element=e.element,this.moduleName=e.moduleName,this.dataSourceSettings=e.dataSourceSettings,this.engineModule=e.pivotEngine,this.enableRtl=e.enableRtl,this.isAdaptive=e.isAdaptive,this.renderMode=e.renderMode,this.parentID=e.id,this.localeObj=e.localeObj,this.dataType=e.dataType,this.nodeStateModified=new j(this),this.dataSourceUpdate=new q(this),this.eventBase=new k(this),this.filterDialog=new B(this),this.errorDialog=new V(this),this.keyboardModule=new R(this),this}return e.prototype.destroy=function(){this.keyboardModule&&this.keyboardModule.destroy()},e}(),H=function(){function e(e){this.parent=e,this.parent.commonModule=this,this.addEventListener()}return e.prototype.getModuleName=function(){return"common"},e.prototype.initiateCommonModule=function(){if(this.parent.pivotCommon)this.parent.pivotCommon.element=this.parent.element,this.parent.pivotCommon.engineModule="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,this.parent.pivotCommon.parentID=this.parent.element.id,this.parent.pivotCommon.dataSourceSettings=this.parent.dataSourceSettings.properties?this.parent.dataSourceSettings.properties:this.parent.dataSourceSettings,this.parent.pivotCommon.moduleName=this.parent.getModuleName(),this.parent.pivotCommon.enableRtl=this.parent.enableRtl,this.parent.pivotCommon.isAdaptive=sf.base.Browser.isDevice,this.parent.pivotCommon.renderMode="Popup",this.parent.pivotCommon.localeObj=this.parent.localeObj,this.parent.pivotCommon.dataType=this.parent.dataType;else{var e={pivotEngine:"olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,dataSourceSettings:this.parent.dataSourceSettings.properties?this.parent.dataSourceSettings.properties:this.parent.dataSourceSettings,id:this.parent.element.id,element:this.parent.element,moduleName:this.parent.getModuleName(),enableRtl:this.parent.enableRtl,isAdaptive:sf.base.Browser.isDevice,renderMode:"Popup",localeObj:this.parent.localeObj,dataType:this.parent.dataType};this.parent.pivotCommon=new _(e)}this.parent.pivotCommon.control=this.parent},e.prototype.addEventListener=function(){this.handlers={load:this.initiateCommonModule},this.parent.isDestroyed||(this.parent.on(l,this.handlers.load,this),this.parent.on(d,this.handlers.load,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(l,this.handlers.load),this.parent.off(d,this.handlers.load))},e.prototype.destroy=function(){this.removeEventListener(),this.parent.pivotCommon&&this.parent.pivotCommon.destroy()},e}(),U=(t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,i)},function(e,i){function a(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}),G=function(e,t,i,s){var r,n=arguments.length,o=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"===("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,s);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(n<3?r(o):n>3?r(t,i,o):r(t,i))||o);return n>3&&o&&Object.defineProperty(t,i,o),o},z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return U(t,e),G([sf.base.Property()],t.prototype,"name",void 0),G([sf.base.Property()],t.prototype,"caption",void 0),G([sf.base.Property("Sum")],t.prototype,"type",void 0),G([sf.base.Property()],t.prototype,"axis",void 0),G([sf.base.Property(!1)],t.prototype,"showNoDataItems",void 0),G([sf.base.Property()],t.prototype,"baseField",void 0),G([sf.base.Property()],t.prototype,"baseItem",void 0),G([sf.base.Property(!0)],t.prototype,"showSubTotals",void 0),G([sf.base.Property(!1)],t.prototype,"isNamedSet",void 0),G([sf.base.Property(!1)],t.prototype,"isCalculatedField",void 0),G([sf.base.Property(!0)],t.prototype,"showFilterIcon",void 0),G([sf.base.Property(!0)],t.prototype,"showSortIcon",void 0),G([sf.base.Property(!0)],t.prototype,"showRemoveIcon",void 0),G([sf.base.Property(!0)],t.prototype,"showValueTypeIcon",void 0),G([sf.base.Property(!0)],t.prototype,"showEditIcon",void 0),G([sf.base.Property(!0)],t.prototype,"allowDragAndDrop",void 0),G([sf.base.Property()],t.prototype,"dataType",void 0),t}(sf.base.ChildProperty),W=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}U(t,e)}(z),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}U(t,e),G([sf.base.Property()],t.prototype,"backgroundColor",void 0),G([sf.base.Property()],t.prototype,"color",void 0),G([sf.base.Property()],t.prototype,"fontFamily",void 0),G([sf.base.Property()],t.prototype,"fontSize",void 0)}(sf.base.ChildProperty),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return U(t,e),G([sf.base.Property()],t.prototype,"name",void 0),G([sf.base.Property("Include")],t.prototype,"type",void 0),G([sf.base.Property()],t.prototype,"items",void 0),G([sf.base.Property("DoesNotEquals")],t.prototype,"condition",void 0),G([sf.base.Property()],t.prototype,"value1",void 0),G([sf.base.Property()],t.prototype,"value2",void 0),G([sf.base.Property()],t.prototype,"measure",void 0),G([sf.base.Property(1)],t.prototype,"levelCount",void 0),G([sf.base.Property()],t.prototype,"selectedField",void 0),t}(sf.base.ChildProperty)),Q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return U(t,e),G([sf.base.Property()],t.prototype,"measure",void 0),G([sf.base.Property()],t.prototype,"label",void 0),G([sf.base.Property()],t.prototype,"conditions",void 0),G([sf.base.Property()],t.prototype,"value1",void 0),G([sf.base.Property()],t.prototype,"value2",void 0),G([sf.base.Property()],t.prototype,"style",void 0),G([sf.base.Property(!0)],t.prototype,"applyGrandTotals",void 0),t}(sf.base.ChildProperty),Y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return U(t,e),G([sf.base.Property()],t.prototype,"name",void 0),G([sf.base.Property("Ascending")],t.prototype,"order",void 0),t}(sf.base.ChildProperty),K=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return U(t,e),G([sf.base.Property()],t.prototype,"name",void 0),G([sf.base.Property()],t.prototype,"minimumFractionDigits",void 0),G([sf.base.Property()],t.prototype,"maximumFractionDigits",void 0),G([sf.base.Property()],t.prototype,"minimumSignificantDigits",void 0),G([sf.base.Property()],t.prototype,"maximumSignificantDigits",void 0),G([sf.base.Property(!0)],t.prototype,"useGrouping",void 0),G([sf.base.Property()],t.prototype,"skeleton",void 0),G([sf.base.Property()],t.prototype,"type",void 0),G([sf.base.Property()],t.prototype,"currency",void 0),G([sf.base.Property()],t.prototype,"minimumIntegerDigits",void 0),G([sf.base.Property()],t.prototype,"format",void 0),t}(sf.base.ChildProperty),J=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return U(t,e),G([sf.base.Property()],t.prototype,"name",void 0),G([sf.base.Property()],t.prototype,"groupInterval",void 0),G([sf.base.Property()],t.prototype,"startingAt",void 0),G([sf.base.Property()],t.prototype,"endingAt",void 0),G([sf.base.Property("Date")],t.prototype,"type",void 0),G([sf.base.Property()],t.prototype,"rangeInterval",void 0),G([sf.base.Property()],t.prototype,"caption",void 0),G([sf.base.Property()],t.prototype,"customGroups",void 0),t}(sf.base.ChildProperty),X=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}U(t,e),G([sf.base.Property()],t.prototype,"groupName",void 0),G([sf.base.Property([])],t.prototype,"items",void 0)}(sf.base.ChildProperty),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return U(t,e),G([sf.base.Property()],t.prototype,"name",void 0),G([sf.base.Property()],t.prototype,"formula",void 0),G([sf.base.Property()],t.prototype,"hierarchyUniqueName",void 0),G([sf.base.Property()],t.prototype,"formatString",void 0),t}(sf.base.ChildProperty)),Z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return U(t,e),G([sf.base.Property()],t.prototype,"name",void 0),G([sf.base.Property()],t.prototype,"items",void 0),G([sf.base.Property()],t.prototype,"delimiter",void 0),t}(sf.base.ChildProperty),$=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return U(t,e),G([sf.base.Property()],t.prototype,"headerText",void 0),G([sf.base.Property(".")],t.prototype,"headerDelimiter",void 0),G([sf.base.Property("None")],t.prototype,"sortOrder",void 0),G([sf.base.Property()],t.prototype,"measure",void 0),t}(sf.base.ChildProperty),ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return U(t,e),G([sf.base.Property()],t.prototype,"userName",void 0),G([sf.base.Property()],t.prototype,"password",void 0),t}(sf.base.ChildProperty),te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return U(t,e),G([sf.base.Property("Local")],t.prototype,"mode",void 0),G([sf.base.Property()],t.prototype,"catalog",void 0),G([sf.base.Property()],t.prototype,"cube",void 0),G([sf.base.Property("Relational")],t.prototype,"providerType",void 0),G([sf.base.Property()],t.prototype,"url",void 0),G([sf.base.Property(1033)],t.prototype,"localeIdentifier",void 0),G([sf.base.Property()],t.prototype,"dataSource",void 0),G([sf.base.Collection([],z)],t.prototype,"rows",void 0),G([sf.base.Collection([],z)],t.prototype,"columns",void 0),G([sf.base.Collection([],z)],t.prototype,"values",void 0),G([sf.base.Collection([],z)],t.prototype,"filters",void 0),G([sf.base.Collection([],z)],t.prototype,"fieldMapping",void 0),G([sf.base.Property([])],t.prototype,"excludeFields",void 0),G([sf.base.Property(!1)],t.prototype,"expandAll",void 0),G([sf.base.Property("column")],t.prototype,"valueAxis",void 0),G([sf.base.Collection([],W)],t.prototype,"filterSettings",void 0),G([sf.base.Collection([],Y)],t.prototype,"sortSettings",void 0),G([sf.base.Property(!0)],t.prototype,"enableSorting",void 0),G([sf.base.Property("JSON")],t.prototype,"type",void 0),G([sf.base.Property(!0)],t.prototype,"allowMemberFilter",void 0),G([sf.base.Property(!1)],t.prototype,"allowLabelFilter",void 0),G([sf.base.Property(!1)],t.prototype,"allowValueFilter",void 0),G([sf.base.Property(!0)],t.prototype,"showSubTotals",void 0),G([sf.base.Property(!0)],t.prototype,"showRowSubTotals",void 0),G([sf.base.Property(!0)],t.prototype,"showColumnSubTotals",void 0),G([sf.base.Property(!0)],t.prototype,"showGrandTotals",void 0),G([sf.base.Property(!0)],t.prototype,"showRowGrandTotals",void 0),G([sf.base.Property(!0)],t.prototype,"showColumnGrandTotals",void 0),G([sf.base.Property(!1)],t.prototype,"alwaysShowValueHeader",void 0),G([sf.base.Property(!0)],t.prototype,"showHeaderWhenEmpty",void 0),G([sf.base.Property(!0)],t.prototype,"showAggregationOnValueField",void 0),G([sf.base.Collection([],K)],t.prototype,"formatSettings",void 0),G([sf.base.Collection([],Z)],t.prototype,"drilledMembers",void 0),G([sf.base.Complex({},$)],t.prototype,"valueSortSettings",void 0),G([sf.base.Collection([],X)],t.prototype,"calculatedFieldSettings",void 0),G([sf.base.Collection([],Q)],t.prototype,"conditionalFormatSettings",void 0),G([sf.base.Property()],t.prototype,"emptyCellsTextContent",void 0),G([sf.base.Collection([],J)],t.prototype,"groupSettings",void 0),G([sf.base.Complex({},ee)],t.prototype,"authentication",void 0),t}(sf.base.ChildProperty),ie=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function a(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}),ae=function(e,t,i,s){var r,n=arguments.length,o=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"===("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,s);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(n<3?r(o):n>3?r(t,i,o):r(t,i))||o);return n>3&&o&&Object.defineProperty(t,i,o),o},se=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}ie(t,e),ae([sf.base.Property("Row")],t.prototype,"mode",void 0),ae([sf.base.Property("Flow")],t.prototype,"cellSelectionMode",void 0),ae([sf.base.Property("Single")],t.prototype,"type",void 0),ae([sf.base.Property(!1)],t.prototype,"checkboxOnly",void 0),ae([sf.base.Property(!1)],t.prototype,"persistSelection",void 0),ae([sf.base.Property("Default")],t.prototype,"checkboxMode",void 0),ae([sf.base.Property(!1)],t.prototype,"enableSimpleMultiRowSelection",void 0)}(sf.base.ChildProperty),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ie(t,e),ae([sf.base.Property("auto")],t.prototype,"height",void 0),ae([sf.base.Property("auto")],t.prototype,"width",void 0),ae([sf.base.Property("Both")],t.prototype,"gridLines",void 0),ae([sf.base.Property(!1)],t.prototype,"allowTextWrap",void 0),ae([sf.base.Property(!1)],t.prototype,"allowReordering",void 0),ae([sf.base.Property(!0)],t.prototype,"allowResizing",void 0),ae([sf.base.Property(!0)],t.prototype,"allowAutoResizing",void 0),ae([sf.base.Property(null)],t.prototype,"rowHeight",void 0),ae([sf.base.Property(110)],t.prototype,"columnWidth",void 0),ae([sf.base.Property("Ellipsis")],t.prototype,"clipMode",void 0),ae([sf.base.Property(!1)],t.prototype,"allowSelection",void 0),ae([sf.base.Property(-1)],t.prototype,"selectedRowIndex",void 0),ae([sf.base.Property({mode:"Row",cellSelectionMode:"Flow",type:"Single"})],t.prototype,"selectionSettings",void 0),ae([sf.base.Property({wrapMode:"Both"})],t.prototype,"textWrapSettings",void 0),ae([sf.base.Property("AllPages")],t.prototype,"printMode",void 0),ae([sf.base.Property()],t.prototype,"contextMenuItems",void 0),ae([sf.base.Event()],t.prototype,"beforeCopy",void 0),ae([sf.base.Event()],t.prototype,"printComplete",void 0),ae([sf.base.Event()],t.prototype,"beforePrint",void 0),ae([sf.base.Event()],t.prototype,"beforePdfExport",void 0),ae([sf.base.Event()],t.prototype,"beforeExcelExport",void 0),ae([sf.base.Event()],t.prototype,"contextMenuOpen",void 0),ae([sf.base.Event()],t.prototype,"contextMenuClick",void 0),ae([sf.base.Event()],t.prototype,"queryCellInfo",void 0),ae([sf.base.Event()],t.prototype,"headerCellInfo",void 0),ae([sf.base.Event()],t.prototype,"rowSelecting",void 0),ae([sf.base.Event()],t.prototype,"rowSelected",void 0),ae([sf.base.Event()],t.prototype,"rowDeselecting",void 0),ae([sf.base.Event()],t.prototype,"rowDeselected",void 0),ae([sf.base.Event()],t.prototype,"cellSelecting",void 0),ae([sf.base.Event()],t.prototype,"cellSelected",void 0),ae([sf.base.Event()],t.prototype,"cellDeselecting",void 0),ae([sf.base.Event()],t.prototype,"cellDeselected",void 0),ae([sf.base.Event()],t.prototype,"resizeStart",void 0),ae([sf.base.Event()],t.prototype,"resizing",void 0),ae([sf.base.Event()],t.prototype,"resizeStop",void 0),ae([sf.base.Event()],t.prototype,"pdfHeaderQueryCellInfo",void 0),ae([sf.base.Event()],t.prototype,"pdfQueryCellInfo",void 0),ae([sf.base.Event()],t.prototype,"excelHeaderQueryCellInfo",void 0),ae([sf.base.Event()],t.prototype,"excelQueryCellInfo",void 0),ae([sf.base.Event()],t.prototype,"columnDragStart",void 0),ae([sf.base.Event()],t.prototype,"columnDrag",void 0),ae([sf.base.Event()],t.prototype,"columnDrop",void 0),ae([sf.base.Event()],t.prototype,"columnRender",void 0),t}(sf.base.ChildProperty)),re=function(){function e(e){this.parent=e}return e.prototype.getModuleName=function(){return"excelExport"},e.prototype.exportToExcel=function(e){var t;this.engine="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule;var i=r.getClonedPivotValues(this.engine.pivotValues);if(this.parent.exportAllPages&&this.parent.enableVirtualization&&"olap"!==this.parent.dataType){var a=this.engine.pageSettings;this.engine.pageSettings=null,this.engine.generateGridData(this.parent.dataSourceSettings),this.parent.applyFormatting(this.engine.pivotValues),t=r.getClonedPivotValues(this.engine.pivotValues),this.engine.pivotValues=i,this.engine.pageSettings=a}else t=i;var s,n,o={fileName:"default",header:"",footer:"",dataCollections:[t]};this.parent.trigger("beforeExport",o,(function(e){s=e.fileName,e.header,e.footer,n=e.dataCollections}));for(var l=[],d=0;d<n.length;d++){for(var p=n[d],h=0,u=p.length,c=0,g=this.parent.renderModule.getFormatList(),f=[],m=0,v=0;v<u;v++)if(p[v]){c++,h=p[v].length;for(var b=[],S=0;S<h;S++)if(p[v][S]){var y=p[v][S];if(-1!==y.level||y.rowSpan){var C="value"===y.axis?y.value:y.formattedText;if(C="grand sum"===y.type?this.parent.localeObj.getConstant("grandTotal"):"sum"===y.type?C.toString().replace("Total",this.parent.localeObj.getConstant("total")):C,-1!==y.level||y.rowSpan){if(b.push({index:S+1,value:C,colSpan:y.colSpan,rowSpan:-1===y.rowSpan?1:y.rowSpan}),"value"===y.axis){(isNaN(y.value)||""===y.formattedText||void 0===y.formattedText||sf.base.isNullOrUndefined(y.value))&&(b[b.length-1].value="");var w="row"===this.parent.dataSourceSettings.valueAxis&&"olap"===this.parent.dataType&&y.rowOrdinal&&this.engine.tupRowInfo[y.rowOrdinal]?this.engine.tupRowInfo[y.rowOrdinal].measureName:y.actualText;b[b.length-1].style={numberFormat:g[w],bold:!1,wrapText:!0},y.style&&(b[b.length-1].style.backColor=y.style.backgroundColor,b[b.length-1].style.fontColor=y.style.color,b[b.length-1].style.fontName=y.style.fontFamily,b[b.length-1].style.fontSize=Number(y.style.fontSize.split("px")[0]))}else if(b[b.length-1].style={bold:!0,vAlign:"Center",wrapText:!0,indent:0===S?10*y.level:0},"row"===y.axis&&0===S)if(b[b.length-1].style.hAlign="Left","olap"===this.parent.dataType){var x=this.parent.renderModule.indentCollection[v];b[b.length-1].style.indent=2*x,m=m>x?m:x}else b[b.length-1].style.indent=2*y.level,m=y.level>m?y.level:m;b[b.length-1].style.borders={color:"#000000",lineStyle:"Thin"}}}S+=y.colSpan?y.colSpan-1:0}else b.push({index:S+1,value:"",colSpan:1,rowSpan:1});f.push({index:c,cells:b})}var T=[];for(S=0;S<h;S++)T.push({index:S+1,width:100});m>0&&(T[0].width=100+20*m),l.push({columns:T,rows:f})}new sf.excelexport.Workbook({worksheets:l},"Excel"===e?"xlsx":"csv",void 0,this.parent.currencyCode).save(s+("Excel"===e?".xlsx":".csv"))},e.prototype.destroy=function(){},e}(),ne=function(){function e(e){this.parent=e}return e.prototype.getModuleName=function(){return"pdfExport"},e.prototype.addPage=function(e){var t=e.document.pages.add(),i=e.args.header,a=e.args.footer,s=new sf.pdfexport.PdfStandardFont(sf.pdfexport.PdfFontFamily.TimesRoman,15,sf.pdfexport.PdfFontStyle.Regular),r=new sf.pdfexport.PdfSolidBrush(new sf.pdfexport.PdfColor(0,0,0)),n=new sf.pdfexport.PdfPen(new sf.pdfexport.PdfColor(0,0,0),.5),o=new sf.pdfexport.PdfPageTemplateElement(new sf.pdfexport.RectangleF(0,0,t.graphics.clientSize.width,20));o.graphics.drawString(i,s,n,r,0,0,new sf.pdfexport.PdfStringFormat(sf.pdfexport.PdfTextAlignment.Center)),e.document.template.top=o;var l=new sf.pdfexport.PdfPageTemplateElement(new sf.pdfexport.RectangleF(0,0,t.graphics.clientSize.width,20));return l.graphics.drawString(a,s,n,r,0,0,new sf.pdfexport.PdfStringFormat(sf.pdfexport.PdfTextAlignment.Center)),e.document.template.bottom=l,t},e.prototype.hexDecToRgb=function(e){if(null===e||""===e||7!==e.length)throw new Error("please set valid hex value for color..");e=e.substring(1);var t=parseInt(e,16);return{r:t>>16&255,g:t>>8&255,b:255&t}},e.prototype.getFontStyle=function(e){var t=sf.pdfexport.PdfFontStyle.Regular;return!sf.base.isNullOrUndefined(e)&&e.bold&&(t|=sf.pdfexport.PdfFontStyle.Bold),!sf.base.isNullOrUndefined(e)&&e.italic&&(t|=sf.pdfexport.PdfFontStyle.Italic),!sf.base.isNullOrUndefined(e)&&e.underline&&(t|=sf.pdfexport.PdfFontStyle.Underline),!sf.base.isNullOrUndefined(e)&&e.strikeout&&(t|=sf.pdfexport.PdfFontStyle.Strikeout),t},e.prototype.getBorderStyle=function(e){var t=new sf.pdfexport.PdfBorders;if(sf.base.isNullOrUndefined(e)){var i=new sf.pdfexport.PdfColor(234,234,234);t.all=new sf.pdfexport.PdfPen(i)}else{var a=e.width,s=sf.base.isNullOrUndefined(a)||"number"!=typeof a?void 0:.75*a,r=new sf.pdfexport.PdfColor(196,196,196);if(!sf.base.isNullOrUndefined(e.color)){var n=this.hexDecToRgb(e.color);r=new sf.pdfexport.PdfColor(n.r,n.g,n.b)}var o=new sf.pdfexport.PdfPen(r,s);sf.base.isNullOrUndefined(e.dashStyle)||(o.dashStyle=this.getDashStyle(e.dashStyle)),t.all=o}return t},e.prototype.getDashStyle=function(e){switch(e){case"Dash":return 1;case"Dot":return 2;case"DashDot":return 3;case"DashDotDot":return 4;default:return 0}},e.prototype.getStyle=function(){var e=new sf.pdfexport.PdfBorders;if(sf.base.isNullOrUndefined(this.gridStyle))return{brush:new sf.pdfexport.PdfSolidBrush(new sf.pdfexport.PdfColor),border:e,font:void 0};var t=sf.base.isNullOrUndefined(this.gridStyle.header.fontName)?sf.pdfexport.PdfFontFamily.Helvetica:this.getFontFamily(this.gridStyle.header.fontName),i=this.getFontStyle(this.gridStyle.header),a=sf.base.isNullOrUndefined(this.gridStyle.header.fontSize)?10.5:this.gridStyle.header.fontSize,s=new sf.pdfexport.PdfColor;if(!sf.base.isNullOrUndefined(this.gridStyle.header.fontColor)){var r=this.hexDecToRgb(this.gridStyle.header.fontColor);s=new sf.pdfexport.PdfColor(r.r,r.g,r.b)}var n=new sf.pdfexport.PdfStandardFont(t,a,i);return sf.base.isNullOrUndefined(this.gridStyle.header.font)||(n=this.gridStyle.header.font),{border:this.getBorderStyle(this.gridStyle.header.border),font:n,brush:new sf.pdfexport.PdfSolidBrush(s)}},e.prototype.setRecordThemeStyle=function(e,t){if(!sf.base.isNullOrUndefined(this.gridStyle)&&!sf.base.isNullOrUndefined(this.gridStyle.record)){var i=sf.base.isNullOrUndefined(this.gridStyle.record.fontName)?sf.pdfexport.PdfFontFamily.Helvetica:this.getFontFamily(this.gridStyle.record.fontName),a=sf.base.isNullOrUndefined(this.gridStyle.record.fontSize)?9.75:this.gridStyle.record.fontSize,s=this.getFontStyle(this.gridStyle.record),r=new sf.pdfexport.PdfStandardFont(i,a,s);sf.base.isNullOrUndefined(this.gridStyle.record.font)||(r=this.gridStyle.record.font),e.style.setFont(r);var n=new sf.pdfexport.PdfColor;if(!sf.base.isNullOrUndefined(this.gridStyle.record.fontColor)){var o=this.hexDecToRgb(this.gridStyle.record.fontColor);n=new sf.pdfexport.PdfColor(o.r,o.g,o.b)}e.style.setTextBrush(new sf.pdfexport.PdfSolidBrush(n))}var l=this.gridStyle&&this.gridStyle.record&&this.gridStyle.record.border?this.getBorderStyle(this.gridStyle.record.border):t;return e.style.setBorder(l),e},e.prototype.exportToPDF=function(){this.engine="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule;for(var e=this.applyEvent(),t=this.getStyle(),i=100+20*(this.parent.renderModule.maxIndent?this.parent.renderModule.maxIndent:5),a=Math.floor((540-i)/90)+1,s=0,r=e.args.dataCollections[s],n=0;e.args.allowRepeatHeader&&a>1&&n<r.length;n++)for(var o=a;r[n]&&o<r[n].length;o+=a)r[n].splice(o,0,r[n][0]);var l=r&&r.length>0?r[0].length:0,d=0;do{var p=this.addPage(e),h=new sf.pdfexport.PdfGrid,u=a>1?a:5;if(r&&r.length>0){h.columns.add(r[0].length-d>=u?u:r[0].length-d);for(var c=r.length,g=0,f=0,m=0;m<c;m++)if(r[m]){var v=!(r[m][0]&&"row"===r[m][0].axis),b=r[m].length>d+u?d+u:r[m].length;v&&h.headers.add(1);var S=v?h.headers.getHeader(g):h.rows.addRow();v?(S.style.setBorder(t.border),t.font&&S.style.setFont(t.font),S.style.setTextBrush(t.brush)):this.setRecordThemeStyle(S,t.border);for(var y=0,C=!0,w=d;w<b;w++){var x=!1;if(r[m][w]){var T=r[m][w];if(-1!==T.level||T.rowSpan){var M=T.formattedText;M="grand sum"===T.type?this.parent.localeObj.getConstant("grandTotal"):"sum"===T.type?M.toString().replace("Total",this.parent.localeObj.getConstant("total")):M,(-1!==T.level||T.rowSpan)&&(S.cells.getCell(y).columnSpan=T.colSpan?u-y<T.colSpan?u-y:T.colSpan:1,v&&T.rowSpan&&T.rowSpan>1&&(S.cells.getCell(y).rowSpan=T.rowSpan?T.rowSpan:1),S.cells.getCell(y).value=M?M.toString():""),""!==M&&(C=!1)}f=T.level>f?T.level:f,x="value"===T.axis,w+=S.cells.getCell(y).columnSpan?S.cells.getCell(y).columnSpan-1:0,y+=S.cells.getCell(y).columnSpan?S.cells.getCell(y).columnSpan-1:0,T.style&&(S=this.applyStyle(S,T,y));var D={style:T&&T.isSum?{bold:!0}:void 0,pivotCell:T,cell:S.cells.getCell(y)};this.parent.trigger("onPdfCellRender",D),D.style&&this.processCellStyle(S.cells.getCell(y),D)}else{D={style:void 0,pivotCell:void 0,cell:S.cells.getCell(y)};this.parent.trigger("onPdfCellRender",D),D.style&&this.processCellStyle(S.cells.getCell(y),D),S.cells.getCell(y).value="",(0===w&&v&&this.parent.dataSourceSettings.columns&&this.parent.dataSourceSettings.columns.length>0||0!==w&&v&&this.parent.dataSourceSettings.columns&&this.parent.dataSourceSettings.columns.length>0&&h.headers.getHeader(0).cells.getCell(0).rowSpan<Object.keys(this.engine.headerContent).length)&&h.headers.getHeader(0).cells.getCell(0).rowSpan++}var E=new sf.pdfexport.PdfStringFormat;if("olap"===this.parent.dataType){var O=!v&&0===y&&r[m][w]?this.parent.renderModule.indentCollection[r[m][w].rowIndex]:0;E.paragraphIndent=15*O,f=f>O?f:O}else E.paragraphIndent=!v&&0===y&&r[m][w]&&-1!==r[m][w].level?15*r[m][w].level:0;E.alignment=x?sf.pdfexport.PdfTextAlignment.Right:sf.pdfexport.PdfTextAlignment.Left,E.lineAlignment=sf.pdfexport.PdfVerticalAlignment.Middle,S.cells.getCell(y).style.stringFormat=E,y++}C&&(S.height=16),g++}h.columns.getColumn(0).width=100+20*f}0===d&&this.parent.dataSourceSettings.columns&&this.parent.dataSourceSettings.columns.length>0&&h.headers.getHeader(0).cells.getCell(0).rowSpan--,h.draw(p,new sf.pdfexport.PointF(10,20)),(d+=u)>=l&&e.args.dataCollections.length>s+1&&(s++,l=(r=e.args.dataCollections[s])&&r.length>0?r[0].length:0,d=0)}while(d<l);e.document.save(e.args.fileName+".pdf"),e.document.destroy()},e.prototype.applyStyle=function(e,t,i){var a=this.parent.conditionalFormattingModule.hexToRgb(t.style.backgroundColor),s=new sf.pdfexport.PdfSolidBrush(new sf.pdfexport.PdfColor(a.r,a.g,a.b));e.cells.getCell(i).style.backgroundBrush=s;var r=Number(t.style.fontSize.split("px")[0]),n=new sf.pdfexport.PdfStandardFont(sf.pdfexport.PdfFontFamily.TimesRoman,r,sf.pdfexport.PdfFontStyle.Regular);return e.cells.getCell(i).style.font=n,a=this.parent.conditionalFormattingModule.hexToRgb(t.style.color),s=new sf.pdfexport.PdfSolidBrush(new sf.pdfexport.PdfColor(a.r,a.g,a.b)),e.cells.getCell(i).style.textBrush=s,e},e.prototype.getFontFamily=function(e){switch(e){case"TimesRoman":return 2;case"Courier":return 1;case"Symbol":return 3;case"ZapfDingbats":return 4;default:return 0}},e.prototype.getFont=function(e){if(e.style.font)return e.style.font;var t=e.cell.cellStyle.font&&e.cell.cellStyle.font.fontSize?e.cell.cellStyle.font.fontSize:sf.base.isNullOrUndefined(e.style.fontSize)?9.75:.75*e.style.fontSize,i=sf.base.isNullOrUndefined(e.style.fontFamily)?sf.pdfexport.PdfFontFamily.TimesRoman:this.getFontFamily(e.style.fontFamily),a=sf.pdfexport.PdfFontStyle.Regular;return!sf.base.isNullOrUndefined(e.style.bold)&&e.style.bold&&(a|=sf.pdfexport.PdfFontStyle.Bold),!sf.base.isNullOrUndefined(e.style.italic)&&e.style.italic&&(a|=sf.pdfexport.PdfFontStyle.Italic),!sf.base.isNullOrUndefined(e.style.underline)&&e.style.underline&&(a|=sf.pdfexport.PdfFontStyle.Underline),!sf.base.isNullOrUndefined(e.style.strikeout)&&e.style.strikeout&&(a|=sf.pdfexport.PdfFontStyle.Strikeout),new sf.pdfexport.PdfStandardFont(i,t,a)},e.prototype.processCellStyle=function(e,t){if(!sf.base.isNullOrUndefined(t.style.backgroundColor)){var i=this.hexDecToRgb(t.style.backgroundColor);e.style.backgroundBrush=new sf.pdfexport.PdfSolidBrush(new sf.pdfexport.PdfColor(i.r,i.g,i.b))}if(!sf.base.isNullOrUndefined(t.style.textBrushColor)){var a=this.hexDecToRgb(t.style.textBrushColor);e.style.textBrush=new sf.pdfexport.PdfSolidBrush(new sf.pdfexport.PdfColor(a.r,a.g,a.b))}if(!sf.base.isNullOrUndefined(t.style.textPenColor)){var s=this.hexDecToRgb(t.style.textPenColor);e.style.textPen=new sf.pdfexport.PdfPen(new sf.pdfexport.PdfColor(s.r,s.g,s.b))}if(sf.base.isNullOrUndefined(t.style.fontFamily)&&sf.base.isNullOrUndefined(t.style.fontSize)&&sf.base.isNullOrUndefined(t.style.bold)&&sf.base.isNullOrUndefined(t.style.italic)&&sf.base.isNullOrUndefined(t.style.underline)&&sf.base.isNullOrUndefined(t.style.strikeout)||(e.style.font=this.getFont(t)),!sf.base.isNullOrUndefined(t.style.border)){var r=new sf.pdfexport.PdfBorders,n=t.style.border.width,o=sf.base.isNullOrUndefined(n)||"number"!=typeof n?void 0:.75*n,l=new sf.pdfexport.PdfColor(196,196,196);if(!sf.base.isNullOrUndefined(t.style.border.color)){var d=this.hexDecToRgb(t.style.border.color);l=new sf.pdfexport.PdfColor(d.r,d.g,d.b)}var p=new sf.pdfexport.PdfPen(l,o);sf.base.isNullOrUndefined(t.style.border.dashStyle)||(p.dashStyle=this.getDashStyle(t.style.border.dashStyle)),r.all=p,e.style.borders=r}},e.prototype.applyEvent=function(){var e,t=this,i=r.getClonedPivotValues(this.engine.pivotValues);if(this.parent.exportAllPages&&this.parent.enableVirtualization&&"olap"!==this.parent.dataType){var a=this.engine.pageSettings;this.engine.pageSettings=null,this.engine.generateGridData(this.parent.dataSourceSettings),this.parent.applyFormatting(this.engine.pivotValues),e=r.getClonedPivotValues(this.engine.pivotValues),this.engine.pivotValues=i,this.engine.pageSettings=a}else e=i;var s,n={fileName:"default",header:"",footer:"",dataCollections:[e],allowRepeatHeader:!0,style:void 0};return this.parent.trigger("beforeExport",n,(function(e){t.gridStyle=e.style,s=e})),{document:new sf.pdfexport.PdfDocument,args:s}},e.prototype.destroy=function(){},e}(),oe=function(){function e(e){this.keyConfigs={tab:"tab",shiftTab:"shift+tab",enter:"enter",shiftUp:"shift+upArrow",shiftDown:"shift+downArrow",shiftLeft:"shift+leftArrow",shiftRight:"shift+rightArrow",shiftEnter:"shift+enter",ctrlEnter:"ctrl+enter",upArrow:"upArrow",downArrow:"downArrow",leftArrow:"leftArrow",rightArrow:"rightArrow",escape:"escape",ctrlShiftF:"ctrl+shift+f"},this.parent=e,this.event=void 0,this.parent.element.tabIndex=-1===this.parent.element.tabIndex?0:this.parent.element.tabIndex,this.pivotViewKeyboardModule=new sf.base.KeyboardEvents(this.parent.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})}return e.prototype.keyActionHandler=function(e){switch(e.action){case"tab":this.processTab(e);break;case"shiftTab":this.processShiftTab(e);break;case"enter":case"shiftEnter":case"ctrlEnter":this.processEnter(e);break;case"shiftUp":case"shiftDown":case"shiftLeft":case"shiftRight":case"upArrow":case"downArrow":case"leftArrow":case"rightArrow":this.processSelection(e);break;case"escape":this.clearSelection();break;case"ctrlShiftF":this.toggleFieldList(e)}},e.prototype.getNextButton=function(e){var t=this.allpivotButtons(e);if(sf.base.removeClass(t,"e-btn-focused"),this.parent.grid.element.querySelector(".e-pivot-button"))for(var i=t.length,a=0;a<i;a++)if(t[a].getAttribute("data-uid")===e.getAttribute("data-uid"))return t[a+1]?t[a+1]:e;return e},e.prototype.getPrevButton=function(e){var t=this.allpivotButtons(e);if(sf.base.removeClass(t,"e-btn-focused"),this.parent.grid.element.querySelector(".e-pivot-button"))for(var i=t.length,a=0;a<i;a++)if(t[a].getAttribute("data-uid")===e.getAttribute("data-uid"))return t[a-1]?t[a-1]:e;return e},e.prototype.allpivotButtons=function(e){var t,i,a,s,r=sf.base.closest(e,".e-pivot-grouping-bar"),n=sf.base.closest(e,".e-group-pivot-rows"),o=sf.base.closest(e,".e-chart-grouping-bar"),l=e.classList.contains("e-rowsheader");if(null!==r?a=r.classList.contains("e-pivot-grouping-bar"):null!==n?s=n.classList.contains("e-group-pivot-rows"):null!==o&&(i=o.classList.contains("e-chart-grouping-bar")),a||s||l){var d=[].slice.call(this.parent.element.querySelector(".e-pivot-grouping-bar").querySelectorAll(".e-pivot-button")),p=[].slice.call(this.parent.element.querySelector(".e-group-pivot-rows").querySelectorAll(".e-pivot-button"));t=d.concat(p)}else i&&(t=[].slice.call(this.parent.element.querySelector(".e-chart-grouping-bar").querySelectorAll(".e-pivot-button")));return t},e.prototype.processTab=function(e){var t=e.target;if(t&&(sf.base.closest(t,".e-pivot-button")||t.classList.contains("e-group-row"))){if(this.parent.grid){var i=this.parent.grid.serviceLocator.getService("focus");if(t.classList.contains("e-group-row")&&t.querySelector(".e-btn-focused"))t=t.querySelector(".e-btn-focused");else if(t.classList.contains("e-group-row")){i.focus();var a=i.getFocusedElement();return sf.base.addClass([a],["e-focused","e-focus"]),a.setAttribute("tabindex","0"),void e.preventDefault()}var s=this.getNextButton(t);if(s.getAttribute("data-uid")!==t.getAttribute("data-uid"))this.parent.element.querySelector(".e-focused")?(this.parent.element.querySelector(".e-focused").setAttribute("tabindex","-1"),sf.base.removeClass(this.parent.element.querySelectorAll(".e-focus"),"e-focus"),sf.base.removeClass(this.parent.element.querySelectorAll(".e-focused"),"e-focused"),i.setFocusedElement(this.parent.element.querySelector(".e-headercell")),this.parent.element.querySelector(".e-headercell").setAttribute("tabindex","0")):i.currentInfo.skipAction=!0,sf.base.addClass([s],"e-btn-focused"),s.focus();else{i.focus();a=i.getFocusedElement();sf.base.addClass([a],["e-focused","e-focus"]),a.setAttribute("tabindex","0")}return void e.preventDefault()}}else if(!this.parent.showGroupingBar&&this.parent.showFieldList&&t&&sf.base.closest(t,".e-toggle-field-list")){if(this.parent.grid){(i=this.parent.grid.serviceLocator.getService("focus")).focus();a=i.getFocusedElement();return sf.base.addClass([a],["e-focused","e-focus"]),a.setAttribute("tabindex","0"),void e.preventDefault()}}else if(this.parent.showGroupingBar||this.parent.showFieldList||!t||!sf.base.closest(t,".e-pivotview")||sf.base.closest(t,".e-popup.e-popup-open")){if(t&&sf.base.closest(t,"."+P)&&this.parent.toolbar&&this.parent.toolbarModule)clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout((function(){sf.base.removeClass(sf.base.closest(t,"."+P).querySelectorAll(".e-menu-item.e-focused"),"e-focused"),document.activeElement&&document.activeElement.classList.contains("e-menu-item")&&sf.base.addClass([document.activeElement],"e-focused")}));else if(t.classList.contains("e-numerictextbox")){(i=this.parent.grid.serviceLocator.getService("focus")).focus();a=i.getFocusedElement();sf.base.removeClass([a],["e-focused","e-focus"]),a.setAttribute("tabindex","0"),e.preventDefault()}}else if(this.parent.grid){var r=sf.base.closest(t,".e-pivotview"),i=this.parent.grid.serviceLocator.getService("focus"),n=[].slice.call(r.getElementsByTagName("tr"));if(t.innerHTML!==n[n.length-1].lastChild.innerHTML){i.focus();var a=i.getFocusedElement();return sf.base.addClass([a],["e-focused","e-focus"]),a.setAttribute("tabindex","0"),void e.preventDefault()}i.currentInfo.skipAction=!0}},e.prototype.processShiftTab=function(e){var t=e.target;if(t&&(sf.base.closest(t,".e-pivot-button")||t.classList.contains("e-group-row"))){if(this.parent.grid){var i=this.parent.grid.serviceLocator.getService("focus");if(t.classList.contains("e-group-row")&&t.querySelector(".e-btn-focused"))t=t.querySelector(".e-btn-focused");else if(t.classList.contains("e-group-row")){t=this.parent.element.querySelector(".e-btn-focused")?this.parent.element.querySelector(".e-btn-focused"):this.parent.element.querySelector(".e-pivot-grouping-bar");var a=this.allpivotButtons(t);if(a.length>0&&a[a.length-1])return i.currentInfo.skipAction=!0,a[a.length-1].focus(),sf.base.removeClass(a,"e-btn-focused"),sf.base.addClass([a[a.length-1]],"e-btn-focused"),void e.preventDefault()}var s=this.getPrevButton(t);if(s.getAttribute("data-uid")!==t.getAttribute("data-uid"))return i.currentInfo.skipAction=!0,s.focus(),void e.preventDefault()}}else if(t&&this.parent.grid&&(t.classList.contains("e-movablefirst")||t.classList.contains("e-rowsheader")&&sf.base.closest(t,"tr").getAttribute("data-uid")===this.parent.grid.element.querySelector(".e-frozencontent tr").getAttribute("data-uid"))){i=this.parent.grid.serviceLocator.getService("focus");if(t.classList.contains("e-movablefirst")){t=this.parent.element.querySelector(".e-group-rows .e-btn-focused")?this.parent.element.querySelector(".e-group-rows .e-btn-focused"):this.parent.element.querySelector(".e-group-rows");var r=i.getFocusedElement();sf.base.removeClass([r],["e-focused","e-focus"])}var n=this.allpivotButtons(t);if(n.length>0)return i.currentInfo.skipAction=!0,setTimeout((function(){n[n.length-1].focus()})),sf.base.removeClass(n,"e-btn-focused"),sf.base.addClass([n[n.length-1]],"e-btn-focused"),void e.preventDefault()}else if(t&&sf.base.closest(t,"."+P)&&this.parent.toolbar&&this.parent.toolbarModule)clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout((function(){sf.base.removeClass(sf.base.closest(t,"."+P).querySelectorAll(".e-menu-item.e-focused"),"e-focused"),document.activeElement&&document.activeElement.classList.contains("e-menu-item")&&sf.base.addClass([document.activeElement],"e-focused")}));else if(t.classList.contains("e-numerictextbox")){(i=this.parent.grid.serviceLocator.getService("focus")).focus();r=i.getFocusedElement();sf.base.removeClass([r],["e-focused","e-focus"]),r.setAttribute("tabindex","0"),e.preventDefault()}},e.prototype.processEnter=function(e){var t=e.target;if(t&&sf.base.closest(t,".e-grid")){var i=this.parent.grid.serviceLocator.getService("focus");if(13!==e.keyCode||e.shiftKey||e.ctrlKey)if(13===e.keyCode&&e.shiftKey&&!e.ctrlKey){if(this.parent.enableValueSorting){this.event=e,t.click(),i.focus();a=i.getFocusedElement();sf.base.addClass([a],["e-focused","e-focus"]),a.setAttribute("tabindex","0")}}else 13===e.keyCode&&!e.shiftKey&&e.ctrlKey&&this.parent.hyperlinkSettings&&t.querySelector("a")&&t.querySelector("a").click();else if(t.querySelector("."+f)){this.event=e,t.querySelector("."+f).click(),i.focus();var a=i.getFocusedElement();sf.base.addClass([a],["e-focused","e-focus"]),a.setAttribute("tabindex","0")}else if(t.classList.contains("e-valuescontent"))t.dispatchEvent(new MouseEvent("dblclick",{view:window,bubbles:!0,cancelable:!0})),t.querySelector(".e-numerictextbox")&&t.click();else if(t.classList.contains("e-numerictextbox")){i.focus();var a=i.getFocusedElement();sf.base.removeClass([a],["e-focused","e-focus"])}e.preventDefault()}else;},e.prototype.clearSelection=function(){var e=this.parent;sf.base.removeClass(e.element.querySelectorAll("."+D+",."+E),[E,D,"e-active"]),this.parent.renderModule.selected()},e.prototype.processSelection=function(e){var t=e.target;if(this.parent.grid&&this.parent.gridSettings.allowSelection&&"Row"!==this.parent.gridSettings.selectionSettings.mode&&!t.classList.contains("e-numerictextbox")){var i,a=this.parent,s=Number(e.target.getAttribute("aria-colIndex")),r=Number(e.target.getAttribute("index"));if("TH"!==t.nodeName&&"TD"!==t.nodeName||(i="shiftUp"===e.action||"upArrow"===e.action?0===r||0===s||"TH"!==t.nodeName&&a.renderModule.rowStartPos!==r?null:this.getParentElement(a,i,s,r-1):"shiftDown"===e.action||"downArrow"===e.action?a.element.querySelector('th[aria-colindex="'+s+'"][index="'+(r+1)+'"]'):"shiftLeft"===e.action||"leftArrow"===e.action?e.target.previousSibling:e.target.nextSibling),sf.base.isNullOrUndefined(i))"upArrow"===e.action?(i=a.element.querySelector('[aria-colindex="'+s+'"][index="'+(r-1)+'"]'),r--):"downArrow"===e.action&&(i=a.element.querySelector('[aria-colindex="'+s+'"][index="'+(r+1)+'"]'),r++),sf.base.isNullOrUndefined(i)||a.clearSelection(i,e,s,r);else if("Both"===a.gridSettings.selectionSettings.mode&&i.classList.contains("e-rowcell"))a.clearSelection(i,e,s,r);else{s=Number(i.getAttribute("aria-colindex")),r=Number(i.getAttribute("index"));var n=Number(i.getAttribute("aria-colspan"));a.clearSelection(i,e,s,r);var o={cancel:!1,isCellClick:!0,currentCell:i,data:a.pivotValues[r][s]};a.trigger("cellSelecting",o,(function(t){t.cancel||a.applyColumnSelection(e,i,s,s+(n>0?n-1:0),r)}))}}else if(t&&(37===e.keyCode||38===e.keyCode)&&this.parent&&this.parent.showGroupingBar&&this.parent.groupingBarModule&&!t.classList.contains("e-numerictextbox")){if(this.parent.grid&&this.parent.element.querySelector(".e-frozenheader")&&this.parent.element.querySelector(".e-frozenheader").querySelectorAll(".e-focus").length>0)return sf.base.removeClass(this.parent.element.querySelector(".e-frozenheader").querySelectorAll(".e-focus"),"e-focus"),sf.base.removeClass(this.parent.element.querySelector(".e-frozenheader").querySelectorAll(".e-focused"),"e-focused"),this.parent.element.querySelector(".e-headercell").setAttribute("tabindex","-1"),this.parent.grid.serviceLocator.getService("focus").setFocusedElement(t),sf.base.addClass([t],["e-focused","e-focus"]),t.setAttribute("tabindex","0"),t.focus(),void e.preventDefault()}else(t.classList.contains("e-numerictextbox")&&"rightArrow"===e.action||"leftArrow"===e.action)&&t.click()},e.prototype.getParentElement=function(e,t,i,a){for(;!t;)t=e.element.querySelector('[aria-colindex="'+i+'"][index="'+a+'"]'),i--;return t},e.prototype.toggleFieldList=function(e){if(this.parent&&!this.parent.isDestroyed&&this.parent.showFieldList&&this.parent.pivotFieldListModule&&!this.parent.pivotFieldListModule.isDestroyed&&this.parent.element.querySelector(".e-toggle-field-list")){if(!this.parent.element.querySelector(".e-toggle-field-list").classList.contains("e-hide"))return this.parent.element.querySelector(".e-toggle-field-list").click(),void e.preventDefault();this.parent.element.querySelector(".e-toggle-field-list").classList.contains("e-hide")&&this.parent.pivotFieldListModule.dialogRenderer&&this.parent.pivotFieldListModule.dialogRenderer.fieldListDialog&&!this.parent.pivotFieldListModule.dialogRenderer.fieldListDialog.isDestroyed&&this.parent.pivotFieldListModule.dialogRenderer.fieldListDialog.hide()}},e.prototype.destroy=function(){this.pivotViewKeyboardModule&&this.pivotViewKeyboardModule.destroy()},e}(),le=function(){function e(e){this.parent=e,this.parent.contextMenuModule=this}return e.prototype.render=function(){this.renderContextMenu()},e.prototype.renderContextMenu=function(){var e={cssClass:"e-pivot-context-menu",items:[{text:this.parent.localeObj.getConstant("addToFilter"),id:this.parent.element.id+"_Filters"},{text:this.parent.localeObj.getConstant("addToRow"),id:this.parent.element.id+"_Rows"},{text:this.parent.localeObj.getConstant("addToColumn"),id:this.parent.element.id+"_Columns"},{text:this.parent.localeObj.getConstant("addToValue"),id:this.parent.element.id+"_Values"}],enableRtl:this.parent.enableRtl,beforeOpen:this.onBeforeMenuOpen.bind(this),select:this.onSelectContextMenu.bind(this)},t=sf.base.createElement("ul",{id:this.parent.element.id+"_PivotContextMenu"});this.parent.element.appendChild(t),this.menuObj=new sf.navigations.ContextMenu(e),this.menuObj.isStringTemplate=!0,this.menuObj.appendTo(t)},e.prototype.onBeforeMenuOpen=function(e){var t=[].slice.call(e.element.querySelectorAll("li")),i="olap"===this.parent.dataType?this.fieldElement.getAttribute("data-type"):this.fieldElement.querySelector(".e-content").getAttribute("data-type");if(sf.base.removeClass(t,"e-disabled"),"CalculatedField"===i||"isMeasureFieldsAvail"===i)for(var a=0,s=t;a<s.length;a++){(d=s[a]).textContent!==this.parent.localeObj.getConstant("addToValue")&&sf.base.addClass([d],"e-disabled")}else if("isMeasureAvail"===i)for(var r=0,n=t;r<n.length;r++){(d=n[r]).textContent!==this.parent.localeObj.getConstant("addToRow")&&d.textContent!==this.parent.localeObj.getConstant("addToColumn")&&sf.base.addClass([d],"e-disabled")}else if("olap"===this.parent.dataType)for(var o=0,l=t;o<l.length;o++){var d;if((d=l[o]).textContent===this.parent.localeObj.getConstant("addToValue")){sf.base.addClass([d],"e-disabled");break}}},e.prototype.onSelectContextMenu=function(e){if(null!==e.element.textContent){var t=this.fieldElement.getAttribute("data-uid"),i=e.item.id.replace(this.parent.element.id+"_","").toLowerCase();this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,this.parent.pivotCommon.dataSourceUpdate.btnElement=this.fieldElement,this.parent.pivotCommon.dataSourceUpdate.updateDataSource(t,i,-1),this.parent.updateDataSource(!0),this.fieldElement=void 0}},e.prototype.destroy=function(){this.parent.isDestroyed&&this.menuObj&&!this.menuObj.isDestroyed&&(this.menuObj.destroy(),sf.base.select("#"+this.parent.element.id+"_PivotContextMenu",document)&&sf.base.remove(sf.base.select("#"+this.parent.element.id+"_PivotContextMenu",document)))},e}(),de=function(){function e(e){this.previousValues={top:0,left:0},this.frozenPreviousValues={top:0,left:0},this.eventType="",this.parent=e,this.engineModule="pivot"===this.parent.dataType?this.parent.engineModule:this.parent.olapEngineModule,this.addInternalEvents()}return e.prototype.getModuleName=function(){return"virtualscroll"},e.prototype.addInternalEvents=function(){this.parent.on(p,this.wireEvents,this)},e.prototype.wireEvents=function(){if("Chart"!==this.parent.displayOption.view){var e=this.parent.element.querySelector(".e-movablecontent"),t=this.parent.element.querySelector(".e-frozencontent"),i=this.parent.element.querySelector(".e-movableheader");sf.base.EventHandler.clearEvents(e),sf.base.EventHandler.clearEvents(t),this.engineModule&&(sf.base.EventHandler.add(e.parentElement.parentElement.querySelector("."+M),"scroll touchmove pointermove",this.onHorizondalScroll(i,e,t),this),sf.base.EventHandler.add(e.parentElement,"scroll wheel touchmove pointermove keyup keydown",this.onVerticalScroll(t,e),this),sf.base.EventHandler.add(e.parentElement.parentElement,"mouseup touchend",this.common(i,e,t),this),sf.base.EventHandler.add(i,"touchstart pointerdown",this.setPageXY(),this),sf.base.EventHandler.add(i,"touchmove pointermove",this.onTouchScroll(i,e,t),this)),this.parent.grid.on("check-scroll-reset",(function(e){e.cancel=!0})),this.parent.grid.on("prevent-frozen-scroll-refresh",(function(e){e.cancel=!0})),this.parent.grid.isPreventScrollEvent=!0}},e.prototype.onWheelScroll=function(e,t){var i=this,a=e;return function(e){var t=a.parentElement.scrollTop+(1===e.deltaMode?30*e.deltaY:e.deltaY);i.frozenPreviousValues.top!==t&&(e.preventDefault(),i.frozenPreviousValues.top=t,i.eventType=e.type)}},e.prototype.getPointXY=function(e){var t={x:0,y:0};return e.touches&&e.touches.length?(t.x=e.touches[0].pageX,t.y=e.touches[0].pageY):(t.x=e.pageX,t.y=e.pageY),t},e.prototype.onTouchScroll=function(e,t,i){var a=this,s=t;return function(t){if("mouse"!==t.pointerType){var i=a.getPointXY(t),r=s.parentElement.scrollTop+(a.pageXY.y-i.y),n=s.parentElement.parentElement.querySelector("."+M).scrollLeft+(a.pageXY.x-i.x);if(a.parent.element.querySelector(".e-headercontent").contains(t.target)){if(a.frozenPreviousValues.left===n||n<0)return;e.scrollLeft=n,a.pageXY.x=i.x,a.frozenPreviousValues.left=n}else{if(a.frozenPreviousValues.top===r||r<0)return;a.pageXY.y=i.y,a.frozenPreviousValues.top=r}a.eventType=t.type}}},e.prototype.update=function(e,t,i,a,s){var r=this;this.parent.isScrolling=!0;var n="pivot"===this.parent.dataType?this.parent.engineModule:this.parent.olapEngineModule;if((sf.base.isBlazor()||"Server"===this.parent.dataSourceSettings.mode)&&(n.pageSettings=this.parent.pageSettings),this.parent.pageSettings&&n.pageSettings)if("vertical"===this.direction){var o="pivot"===this.parent.dataType&&"row"===this.parent.dataSourceSettings.valueAxis?this.parent.dataSourceSettings.values.length:1,l=this.parent.pageSettings.rowSize*o*this.parent.gridSettings.rowHeight,d=Math.ceil(i/l);if(this.parent.scrollPosObject.vertical===d||n.pageSettings.rowSize>=n.rowCount)return;this.parent.showWaitingPopup(),this.parent.scrollPosObject.vertical=d,n.pageSettings.rowCurrentPage=d>1?d:1;var p=0;if("pivot"===this.parent.dataType)if(sf.base.isBlazor()){var h=this.parent,u="sfBlazor",c=window[u].copyWithoutCircularReferences([h.dataSourceSettings],h.dataSourceSettings),g=window[u].copyWithoutCircularReferences([n.pageSettings],n.pageSettings);h.interopAdaptor.invokeMethodAsync("PivotInteropMethod","generateGridData",{dataSourceSettings:c,pageSettings:g,isScrolling:!0}).then((function(e){h.updateBlazorData(e,h),h.pivotValues=n.pivotValues,p=r.parent.engineModule.rowStartPos;var t=Math.ceil(p/(h.pageSettings.rowSize*o)),i=l*t-n.rowFirstLvl*o*h.gridSettings.rowHeight;h.scrollPosObject.verticalSection=i}))}else"Server"===this.parent.dataSourceSettings.mode?this.parent.getEngine("onScroll",null,null,null,null,null,null):(this.parent.engineModule.generateGridData(this.parent.dataSourceSettings,this.parent.engineModule.headerCollection),p=this.parent.engineModule.rowStartPos);else this.parent.olapEngineModule.scrollPage("scroll"),p=this.parent.olapEngineModule.pageRowStartPos;if(!sf.base.isBlazor()||"pivot"!==this.parent.dataType){this.parent.pivotValues=n.pivotValues;var f=Math.ceil(p/(this.parent.pageSettings.rowSize*o)),m=l*f-n.rowFirstLvl*o*this.parent.gridSettings.rowHeight;this.parent.scrollPosObject.verticalSection=m}}else{var v="pivot"===this.parent.dataType&&"column"===this.parent.dataSourceSettings.valueAxis?this.parent.dataSourceSettings.values.length:1,b=this.parent.pageSettings.columnSize*v*this.parent.gridSettings.columnWidth;d=Math.ceil(a/b);if(this.parent.scrollPosObject.horizontal===d)return;this.parent.showWaitingPopup();var S=this.parent;S.scrollPosObject.horizontal=d,n.pageSettings.columnCurrentPage=d>1?d:1;var y=0;if("pivot"===S.dataType)if(sf.base.isBlazor()){u="sfBlazor";var C=this.parent;g=window[u].copyWithoutCircularReferences([n.pageSettings],n.pageSettings),c=window[u].copyWithoutCircularReferences([C.dataSourceSettings],C.dataSourceSettings);C.interopAdaptor.invokeMethodAsync("PivotInteropMethod","generateGridData",{dataSourceSettings:c,pageSettings:g,isScrolling:!0}).then((function(e){C.updateBlazorData(e,C),y=C.engineModule.colStartPos,C.pivotValues=n.pivotValues;var t=Math.ceil(y/(C.pageSettings.columnSize*v)),i=b*t-n.colFirstLvl*v*C.gridSettings.columnWidth;C.scrollPosObject.horizontalSection=i}))}else"Server"===this.parent.dataSourceSettings.mode?this.parent.getEngine("onScroll",null,null,null,null,null,null):(S.engineModule.generateGridData(S.dataSourceSettings,S.engineModule.headerCollection),y=S.engineModule.colStartPos);else S.olapEngineModule.scrollPage("scroll"),y=S.olapEngineModule.pageColStartPos;if(!sf.base.isBlazor()||"pivot"!==S.dataType){S.pivotValues=n.pivotValues;f=Math.ceil(y/(S.pageSettings.columnSize*v)),m=b*f-n.colFirstLvl*v*S.gridSettings.columnWidth;S.scrollPosObject.horizontalSection=m}}},e.prototype.setPageXY=function(){var e=this;return function(t){"mouse"!==t.pointerType&&(e.pageXY=e.getPointXY(t))}},e.prototype.common=function(e,t,i){var a=this;return function(i){a.update(e,t,t.parentElement.scrollTop*a.parent.verticalScrollScale,t.parentElement.parentElement.querySelector("."+M).scrollLeft*a.parent.horizontalScrollScale,i)}},e.prototype.onHorizondalScroll=function(e,t,i){var a,s=this;return function(i){var r=t.parentElement.parentElement.querySelector("."+M).scrollLeft*s.parent.horizontalScrollScale;if("wheel"!==i.type&&"touchmove"!==i.type&&"wheel"!==s.eventType&&"touchmove"!==s.eventType||(clearTimeout(a),a=setTimeout((function(){r="touchmove"===i.type?t.parentElement.parentElement.querySelector("."+M).scrollLeft:r,s.update(e,t,t.parentElement.scrollTop*s.parent.verticalScrollScale,r,i)}),300)),s.previousValues.left!==r){s.parent.scrollDirection=s.direction="horizondal";var n=-(r-s.parent.scrollPosObject.horizontalSection-t.parentElement.parentElement.querySelector("."+M).scrollLeft),o=t.querySelector("."+b).style.transform.split(",").length>1?t.querySelector("."+b).style.transform.split(",")[1].trim():"0px)";t.parentElement.parentElement.querySelector("."+M).scrollLeft<s.parent.scrollerBrowserLimit&&(sf.base.setStyleAttribute(t.querySelector(".e-table"),{transform:"translate("+n+"px,"+o}),sf.base.setStyleAttribute(e.querySelector(".e-table"),{transform:"translate("+n+"px,0px)"}));var l=s.parent.scrollPosObject.horizontalSection>r?-(s.parent.scrollPosObject.horizontalSection-r):r+e.offsetWidth-(s.parent.scrollPosObject.horizontalSection+t.querySelector(".e-table").offsetWidth),d=Math.ceil(s.parent.scrollPosObject.horizontalSection/s.parent.horizontalScrollScale)<s.parent.scrollerBrowserLimit;if(s.parent.scrollPosObject.horizontalSection>r||l>1&&d){r>e.clientWidth?(s.parent.scrollPosObject.left<1&&(s.parent.scrollPosObject.left=e.clientWidth),s.parent.scrollPosObject.left=s.parent.scrollPosObject.left-50,l=s.parent.scrollPosObject.horizontalSection>r?l-s.parent.scrollPosObject.left:l+s.parent.scrollPosObject.left):l=-s.parent.scrollPosObject.horizontalSection,n=-(r-(s.parent.scrollPosObject.horizontalSection+l)-t.parentElement.parentElement.querySelector("."+M).scrollLeft);var p=s.parent.gridSettings.columnWidth*s.engineModule.columnCount;p>s.parent.scrollerBrowserLimit&&(s.parent.horizontalScrollScale=p/s.parent.scrollerBrowserLimit,p=s.parent.scrollerBrowserLimit),n>p&&n>r&&(n=r,l=0),sf.base.setStyleAttribute(t.querySelector(".e-table"),{transform:"translate("+n+"px,"+o}),sf.base.setStyleAttribute(e.querySelector(".e-table"),{transform:"translate("+n+"px,0px)"}),s.parent.scrollPosObject.horizontalSection=s.parent.scrollPosObject.horizontalSection+l}s.previousValues.left=r,s.frozenPreviousValues.left=r,s.eventType="",e.scrollLeft=t.parentElement.parentElement.querySelector("."+M).scrollLeft}}},e.prototype.onVerticalScroll=function(e,t){var i,a=this;return function(s){var r=t.parentElement.scrollTop*a.parent.verticalScrollScale;if("wheel"!==s.type&&"touchmove"!==s.type&&"wheel"!==a.eventType&&"touchmove"!==a.eventType&&"keyup"!==s.type&&"keydown"!==s.type||(clearTimeout(i),i=setTimeout((function(){a.update(null,t,t.parentElement.scrollTop*a.parent.verticalScrollScale,t.parentElement.parentElement.querySelector("."+M).scrollLeft*a.parent.horizontalScrollScale,s)}),300)),a.previousValues.top!==r){a.parent.scrollDirection=a.direction="vertical";var n=-(r-a.parent.scrollPosObject.verticalSection-t.parentElement.scrollTop),o=t.querySelector("."+b).style.transform.split(",")[0].trim();n>a.parent.virtualDiv.clientHeight&&(n=a.parent.virtualDiv.clientHeight),t.parentElement.scrollTop<a.parent.scrollerBrowserLimit&&(sf.base.setStyleAttribute(e.querySelector(".e-table"),{transform:"translate(0px,"+n+"px)"}),sf.base.setStyleAttribute(t.querySelector(".e-table"),{transform:o+","+n+"px)"}));var l=a.parent.scrollPosObject.verticalSection>r?-(a.parent.scrollPosObject.verticalSection-r):r+e.parentElement.clientHeight-(a.parent.scrollPosObject.verticalSection+e.querySelector(".e-table").offsetHeight),d=Math.ceil(a.parent.scrollPosObject.verticalSection/a.parent.verticalScrollScale)<a.parent.scrollerBrowserLimit;if(a.parent.scrollPosObject.verticalSection>r||l>1&&d){r>e.parentElement.clientHeight?(a.parent.scrollPosObject.top<1&&(a.parent.scrollPosObject.top=e.parentElement.clientHeight),a.parent.scrollPosObject.top=a.parent.scrollPosObject.top-50,l=a.parent.scrollPosObject.verticalSection>r?l-a.parent.scrollPosObject.top:l+a.parent.scrollPosObject.top):l=-a.parent.scrollPosObject.verticalSection;var p=a.parent.element.querySelector(".e-movablecontent").querySelector(".e-table");n=-(r-(a.parent.scrollPosObject.verticalSection+l)-t.parentElement.scrollTop);var h=a.parent.gridSettings.rowHeight*a.engineModule.rowCount+.1-p.clientHeight;h>a.parent.scrollerBrowserLimit&&(a.parent.verticalScrollScale=h/a.parent.scrollerBrowserLimit,h=a.parent.scrollerBrowserLimit),n>h&&n>r&&(n=r,l=0),n>a.parent.virtualDiv.clientHeight&&(n=a.parent.virtualDiv.clientHeight),sf.base.setStyleAttribute(e.querySelector(".e-table"),{transform:"translate(0px,"+n+"px)"}),sf.base.setStyleAttribute(t.querySelector(".e-table"),{transform:o+","+n+"px)"}),a.parent.scrollPosObject.verticalSection=a.parent.scrollPosObject.verticalSection+l}a.previousValues.top=r,a.frozenPreviousValues.top=r,a.eventType=""}}},e.prototype.removeInternalEvents=function(){this.parent.isDestroyed||this.parent.off(p,this.wireEvents)},e.prototype.destroy=function(){this.removeInternalEvents()},e}(),pe=function(){function e(e){this.indexString=[],this.clonedData=[],this.isUpdated=!1,this.gridIndexObjects={},this.gridData=[],this.parent=e,this.engine="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule}return e.prototype.frameHeaderWithKeys=function(e){for(var t=Object.keys(e),i=0,a={};i<t.length;)a[t[i]]=e[t[i]],i++;return a},e.prototype.showDrillThroughDialog=function(e){var t=this;this.gridData=e.rawData;for(var i=0;i<e.rawData.length;i++)this.clonedData.push(this.frameHeaderWithKeys(e.rawData[i]));var a=e.currentCell.actualText.toString();if("Count"!==this.engine.fieldList[a].aggregateType&&this.parent.editSettings.allowInlineEditing&&this.parent.editSettings.allowEditing&&1===e.rawData.length&&"DistinctCount"!==this.engine.fieldList[a].aggregateType&&"string"!=typeof e.rawData[0][a])this.editCell(e);else{this.removeDrillThroughDialog();var s=sf.base.createElement("div",{id:this.parent.element.id+"_drillthrough",className:"e-drillthrough-dialog"});this.parent.element.appendChild(s),this.dialogPopUp=new sf.popups.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,header:this.parent.localeObj.getConstant("details"),content:this.createDrillThroughGrid(e),beforeOpen:function(){t.drillThroughGrid.setProperties({dataSource:t.parent.editSettings.allowEditing?t.dataWithPrimarykey(e):t.gridData,height:t.parent.editSettings.allowEditing?220:300},!1)},beforeClose:function(){if(t.parent.editSettings.allowEditing&&t.isUpdated){"CSV"===t.parent.dataSourceSettings.type&&t.updateData(t.drillThroughGrid.dataSource);for(var e=[],i=0,a=Object.keys(t.gridIndexObjects);i<a.length;i++){var s=a[i];e.push(t.gridIndexObjects[s])}for(var r=Object.keys(t.gridIndexObjects).length,n=[],o=[],l=0,d=0,p=t.drillThroughGrid.dataSource;d<p.length;d++){var h=p[d];if(sf.base.isNullOrUndefined(h.__index)||""===h.__index){for(var u=0,c=t.engine.fields;u<c.length;u++){var g=c[u];sf.base.isNullOrUndefined(h[g])&&delete h[g]}delete h.__index,n.push(h)}else r>0&&(sf.base.isBlazor()&&t.parent.editSettings.allowCommandColumns&&(t.parent.engineModule.data[Number(h.__index)]=h),delete t.gridIndexObjects[h.__index.toString()],o.push(h),r--);"Server"===t.parent.dataSourceSettings.mode&&(h.__index&&delete h.__index,t.gridData[l].__index&&delete t.gridData[l].__index),l++}if(r=0,sf.base.isBlazor()&&t.parent.enableVirtualization){var f=t;f.parent.interopAdaptor.invokeMethodAsync("PivotInteropMethod","updateRawData",{AddItem:n,RemoveItem:f.gridIndexObjects,ModifiedItem:f.gridData}).then((function(e){f.parent.updateBlazorData(e,f.parent),f.parent.allowServerDataBinding=!1,f.parent.setProperties({pivotValues:f.parent.engineModule.pivotValues},!0),delete f.parent.bulkChanges.pivotValues,f.parent.allowServerDataBinding=!0,f.isUpdated=!1,f.gridIndexObjects={}}))}else if("Server"===t.parent.dataSourceSettings.mode){for(var m=[],v=Object.keys(t.gridIndexObjects),b=0;b<v.length;b++)delete t.parent.drillThroughValue.indexObject[t.gridIndexObjects[v[b]]],m.push({Key:v[b],Value:t.gridIndexObjects[v[b]]});var S=[];v=Object.keys(t.parent.drillThroughValue.indexObject);for(b=0;b<v.length;b++)S.push({Key:v[b],Value:t.parent.drillThroughValue.indexObject[v[b]]});t.parent.getEngine("updateRawData",null,null,null,null,null,null,null,{addedData:n,removedData:m,updatedData:o,indexObject:S})}else{for(var y=[],C=0,w=t.parent.allowDataCompression&&t.parent.enableVirtualization?t.parent.engineModule.actualData:t.parent.engineModule.data;C<w.length;C++){delete(h=w[C]).__index,void 0===t.gridIndexObjects[r.toString()]&&y.push(h),r++}y=y.concat(n);var x={currentData:t.drillThroughGrid.dataSource,previousData:t.clonedData,previousPosition:e,cancel:!1};t.parent.trigger("editCompleted",x),x.cancel||(t.parent.setProperties({dataSourceSettings:{dataSource:y}},!0),t.engine.updateGridData(t.parent.dataSourceSettings),t.parent.pivotValues=t.engine.pivotValues)}}sf.base.isBlazor()&&t.parent.enableVirtualization||(t.isUpdated=!1,t.gridIndexObjects={})},isModal:!0,visible:!0,showCloseIcon:!0,locale:this.parent.locale,enableRtl:this.parent.enableRtl,width:this.parent.isAdaptive?"100%":"60%",position:{X:"center",Y:"center"},closeOnEscape:!0,target:document.body,close:this.removeDrillThroughDialog.bind(this)}),this.dialogPopUp.isStringTemplate=!0,this.dialogPopUp.appendTo(s),sf.base.setStyleAttribute(this.dialogPopUp.element,{visibility:"visible"})}},e.prototype.editCell=function(e){var t=this,i=this.parent.gridSettings.allowResizing,a=e.currentCell.actualText.toString(),s=Number(Object.keys(e.currentCell.indexObject));e.currentTarget.firstElementChild.style.display="none";var r=Number(e.rawData[0][a]),n=this.frameHeaderWithKeys(e.rawData[e.rawData.length-1]),o=e.rawData[e.rawData.length-1];e.currentCell.actualText in n&&(o[e.currentCell.actualText]=e.currentCell.actualValue),this.numericTextBox=new sf.inputs.NumericTextBox({value:r,enableRtl:this.parent.enableRtl,enabled:!0,format:"####.##",locale:this.parent.locale,change:function(){var i=t.numericTextBox.value,r=e.currentCell.indexObject[s];e.rawData[0][a]=i,t.parent.engineModule.data[r]=e.rawData[0]},blur:function(){var e={currentData:o,previousData:n,previousPosition:o.index,cancel:!1};t.parent.trigger("editCompleted",e),e.cancel||(t.parent.setProperties({dataSourceSettings:{dataSource:t.parent.engineModule.data}},!0),t.engine.updateGridData(t.parent.dataSourceSettings),t.parent.pivotValues=t.engine.pivotValues,t.parent.gridSettings.allowResizing=i)}});var l=sf.base.createElement("input",{id:this.parent.element.id+"_inputbox"});e.currentTarget.appendChild(l),this.numericTextBox.appendTo(l),e.currentCell.value=this.numericTextBox.value,this.numericTextBox.focusIn(),this.parent.gridSettings.allowResizing=!1},e.prototype.updateData=function(e){for(var t=0,i=this.parent.allowDataCompression&&this.parent.enableVirtualization?this.parent.engineModule.actualData:this.parent.engineModule.data;t<e.length;){for(var a=Object.keys(e[t]),s=0,r=[];s<a.length;)sf.base.isNullOrUndefined(this.parent.engineModule.fieldKeys[a[s]])||(r[this.parent.engineModule.fieldKeys[a[s]]]=e[t][a[s]]),s++;i[e[t].__index]=r,t++}this.parent.allowDataCompression&&this.parent.enableVirtualization?this.parent.engineModule.actualData=i:this.parent.engineModule.data=i},e.prototype.removeDrillThroughDialog=function(){this.dialogPopUp&&!this.dialogPopUp.isDestroyed&&this.dialogPopUp.destroy();var e=document.getElementById(this.parent.element.id+"_drillthrough");e&&sf.base.remove(e),document.getElementById(this.parent.element.id+"_drillthroughgrid_ccdlg")&&sf.base.remove(document.getElementById(this.parent.element.id+"_drillthroughgrid_ccdlg"))},e.prototype.createDrillThroughGrid=function(e){var t=sf.base.createElement("div",{id:this.parent.element.id+"_drillthroughbody",className:"e-drillthrough-body"}),i=sf.base.createElement("div",{id:this.parent.element.id+"_drillthroughbodyheader",className:"e-drillthrough-body-header-container"});if(""!==e.rowHeaders&&(i.innerHTML="<span class=e-drillthrough-body-header-common><span class=e-drillthrough-body-header>"+this.parent.localeObj.getConstant("row")+"</span> :<span class=e-drillthrough-body-header-value>"+e.rowHeaders+"</span></span>"),""!==e.columnHeaders&&(i.innerHTML=i.innerHTML+"<span class=e-drillthrough-body-header-common><span class=e-drillthrough-body-header>"+this.parent.localeObj.getConstant("column")+"</span> :<span class=e-drillthrough-body-header-value>"+e.columnHeaders+"</span></span>"),""!==e.value){var a=e.value.split("(")[0],s=e.value.split("(")[1].split(")")[0];"0"!==s&&(i.innerHTML=i.innerHTML+"<span class=e-drillthrough-body-header-common><span class=e-drillthrough-body-header>"+a+"</span> :<span class=e-drillthrough-body-header-value>"+s+"</span></span>")}var r=["ColumnChooser"];this.parent.editSettings.allowEditing&&(r=this.parent.editSettings.allowCommandColumns?["ColumnChooser","Add"]:"Batch"===this.parent.editSettings.mode?["ColumnChooser","Add","Delete","Update","Cancel"]:"Dialog"===this.parent.editSettings.mode?["ColumnChooser","Add","Edit","Delete"]:["ColumnChooser","Add","Edit","Delete","Update","Cancel"]);var n=sf.base.createElement("div",{id:this.parent.element.id+"_drillthroughgrid",className:"e-drillthrough-grid"});sf.grids.Grid.Inject(sf.grids.Selection,sf.grids.Reorder,sf.grids.Resize,sf.grids.Toolbar,sf.grids.ColumnChooser),this.drillThroughGrid=new sf.grids.Grid({gridLines:"Default",allowResizing:!0,allowReordering:!0,showColumnChooser:!0,enableHover:!1,toolbar:r,columns:e.gridColumns,locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableVirtualization:!this.parent.editSettings.allowEditing,allowPaging:this.parent.editSettings.allowEditing,pageSettings:{pageSize:20},rowHeight:this.parent.gridSettings.rowHeight}),sf.base.isBlazor()&&(this.drillThroughGrid.isJsComponent=!0),"olap"===this.parent.dataType&&this.formatData();var o=this;return this.parent.trigger("beginDrillThrough",{cellInfo:e,gridObj:sf.base.isBlazor()?void 0:this.drillThroughGrid,type:"editing"}),this.drillThroughGrid.allowExcelExport&&sf.grids.Grid.Inject(sf.grids.ExcelExport),this.drillThroughGrid.allowPdfExport&&sf.grids.Grid.Inject(sf.grids.PdfExport),this.parent.editSettings.allowEditing?(sf.grids.Grid.Inject(sf.grids.Edit,sf.grids.Page),this.drillThroughGrid.editSettings=this.parent.editSettings,this.parent.editSettings.allowCommandColumns?(this.drillThroughGrid.editSettings.mode="Normal",this.drillThroughGrid.editSettings.allowEditOnDblClick=!1,sf.grids.Grid.Inject(sf.grids.CommandColumn),this.drillThroughGrid.columns.push({headerText:this.parent.localeObj.getConstant("manageRecords"),width:160,showInColumnChooser:!1,commands:[{type:"Edit",buttonOption:{iconCss:" e-icons e-edit",cssClass:"e-flat"}},{type:"Delete",buttonOption:{iconCss:"e-icons e-delete",cssClass:"e-flat"}},{type:"Save",buttonOption:{iconCss:"e-icons e-update",cssClass:"e-flat"}},{type:"Cancel",buttonOption:{iconCss:"e-icons e-cancel-icon",cssClass:"e-flat"}}]})):this.drillThroughGrid.editSettings.allowEditOnDblClick=this.parent.editSettings.allowEditOnDblClick,this.drillThroughGrid.columns.push({field:"__index",visible:!1,isPrimaryKey:!0,type:"string",showInColumnChooser:!1}),this.drillThroughGrid.actionComplete=function(e){"batchsave"!==e.requestType&&"save"!==e.requestType&&"delete"!==e.requestType||(o.isUpdated=!0),("Normal"===o.drillThroughGrid.editSettings.mode&&"save"===e.requestType&&o.drillThroughGrid.element.querySelectorAll(".e-tbar-btn:hover").length>0&&!o.parent.editSettings.allowCommandColumns||"batchsave"===e.requestType)&&o.dialogPopUp.hide()},this.drillThroughGrid.beforeBatchSave=function(){o.isUpdated=!0}):sf.grids.Grid.Inject(sf.grids.VirtualScroll),document.body.appendChild(n),this.drillThroughGrid.isStringTemplate=!0,this.drillThroughGrid.appendTo(n),t.appendChild(i),t.appendChild(n),t},e.prototype.frameGridColumns=function(e){var t="olap"===this.parent.dataType?e[0]?Object.keys(e[0]):[]:Object.keys(this.engine.fieldList),i=[];if("olap"===this.parent.dataType)for(var a=0,s=t;a<s.length;a++){var r=s[a];i.push({field:r.replace(/_x005B_|_x0020_|_x005D_|_x0024_/g,"").replace("].[","").split(".").reverse().join(""),headerText:r.replace(/_x005B_|_x005D_|_x0024_/g,"").replace(/_x0020_/g," ").replace("].[","").split(".").reverse().join("."),width:120,visible:!0,validationRules:{required:!0},type:"string"})}else for(var n=0,o=t;n<o.length;n++){r=o[n];if("CalculatedField"!==this.engine.fieldList[r].aggregateType){var l="";l="number"===this.engine.fieldList[r].type?"numericedit":"date"===this.engine.fieldList[r].type?"datepickeredit":"defaultedit",i.push({field:r,headerText:this.engine.fieldList[r].caption,width:120,visible:this.engine.fieldList[r].isSelected,validationRules:{required:!0},editType:l,type:"string"})}}return i},e.prototype.formatData=function(){for(var e=0;e<this.gridData.length;){for(var t=this.gridData[e],i=Object.keys(this.gridData[e]),a={},s=0;s<i.length;){a[i[s].replace(/_x005B_|_x0020_|_x005D_|_x0024_/g,"").replace("].[","").split(".").reverse().join("")]=t[i[s]],s++}this.gridData[e]=a,e++}},e.prototype.dataWithPrimarykey=function(e){for(var t=this.indexString.length>0?this.indexString:Object.keys(e.currentCell.indexObject),i=this.gridData,a=0,s=0,r=i;s<r.length;s++){r[s].__index=t[a],this.gridIndexObjects[t[a].toString()]=Number(t[a]),a++}return i},e}(),he=function(){function e(e){this.parent=e,this.drillThroughDialog=new pe(this.parent),this.addInternalEvents()}return e.prototype.getModuleName=function(){return"drillthrough"},e.prototype.addInternalEvents=function(){this.parent.on(p,this.wireEvents,this)},e.prototype.wireEvents=function(){this.unWireEvents(),sf.base.EventHandler.add(this.parent.element,"dblclick",this.mouseClickHandler,this)},e.prototype.unWireEvents=function(){sf.base.EventHandler.remove(this.parent.element,"dblclick",this.mouseClickHandler)},e.prototype.mouseClickHandler=function(e){var t=e.target,i=null;if(t.classList.contains("e-stackedheadercelldiv")||t.classList.contains("e-cellvalue")||t.classList.contains("e-headercelldiv")?i=t.parentElement:t.classList.contains("e-headercell")||t.classList.contains("e-rowcell")?i=t:t.classList.contains("e-headertext")&&(i=t.parentElement.parentElement),i&&(this.parent.allowDrillThrough&&i.classList.contains("e-valuescontent")||this.parent.editSettings.allowEditing)){var a=Number(i.getAttribute("aria-colindex")),s=Number(i.getAttribute("index"));this.executeDrillThrough(this.parent.pivotValues[s][a],s,a,i)}},e.prototype.executeDrillThrough=function(e,t,i,a){this.parent.drillThroughElement=a,this.parent.drillThroughValue=e;var s="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,r="",n="",o=[];if(void 0!==e.rowHeaders&&void 0!==e.columnHeaders&&!sf.base.isNullOrUndefined(e.value)){if("olap"===this.parent.dataType){var l=void 0,d=(l="row"===this.parent.dataSourceSettings.valueAxis?s.tupRowInfo[e.rowOrdinal]:s.tupColumnInfo[e.colOrdinal])?s.getUniqueName(l.measureName):e.actualText;if(s.fieldList[d]&&s.fieldList[d].isCalculatedField)return void this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),this.parent.localeObj.getConstant("drillError"));r=s.fieldList[d||e.actualText].caption,n=s.fieldList[d||e.actualText].aggregateType,this.parent.olapEngineModule.getDrillThroughData(e,this.parent.maxRowsInDrillThrough);try{o=JSON.parse(s.gridJSON)}catch(e){return void this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),s.gridJSON)}}else{r=s.fieldList[e.actualText.toString()]?s.fieldList[e.actualText.toString()].caption:e.actualText.toString(),n=s.fieldList[e.actualText]?s.fieldList[e.actualText].aggregateType:"";var p=this;if(sf.base.isBlazor()&&this.parent.enableVirtualization)p.parent.interopAdaptor.invokeMethodAsync("PivotInteropMethod","fetchRawData",{RowIndex:t,ColumnIndex:i}).then((function(t){o=JSON.parse(t.rawData);for(var i=JSON.parse(t.indexObject),s={},l=0;l<i.length;l++)s[i[l].Key]=i[l].Value;e.indexObject=s,p.triggerDialog(r,n,o,e,a)}));else if("Server"===this.parent.dataSourceSettings.mode)this.parent.getEngine("fetchRawData",null,null,null,null,null,null,{rowIndex:t,columnIndex:i});else if(this.parent.enableVirtualization&&this.parent.allowDataCompression){var h=Object.keys(e.indexObject);this.drillThroughDialog.indexString=[];for(var u=0,c=h;u<c.length;u++)for(var g=c[u],f=0,m=this.parent.engineModule.groupRawIndex[Number(g)];f<m.length;f++){var v=m[f];o.push(this.parent.engineModule.actualData[v]),this.drillThroughDialog.indexString.push(v.toString())}}else for(var b=0,S=h=Object.keys(e.indexObject);b<S.length;b++){var y=S[b];o.push(this.parent.engineModule.data[Number(y)])}}sf.base.isBlazor()&&this.parent.enableVirtualization||"Server"===this.parent.dataSourceSettings.mode||this.triggerDialog(r,n,o,e,a)}},e.prototype.frameData=function(e){for(var t=0,i=0,a=[];i<e.rawData.length;){for(var s={};t<e.gridColumns.length;)s[e.gridColumns[t].field]="Server"===this.parent.dataSourceSettings.mode?e.rawData[i][-1!==this.parent.engineModule.fields.indexOf(e.gridColumns[t].field)?this.parent.engineModule.fields.indexOf(e.gridColumns[t].field):0]:e.rawData[i][this.parent.engineModule.fieldKeys[e.gridColumns[t].field]],t++;a.push(s),i++,t=0}return e.rawData=a,e},e.prototype.triggerDialog=function(e,t,i,a,s){var r="CalculatedField"===t?e.toString():""!==t?this.parent.localeObj.getConstant(t)+" "+this.parent.localeObj.getConstant("of")+" "+e:e,n={currentTarget:s,currentCell:a,rawData:i,rowHeaders:""===a.rowHeaders?"":a.rowHeaders.toString().split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).join(" - "),columnHeaders:""===a.columnHeaders?"":a.columnHeaders.toString().split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).join(" - "),value:r+"("+a.formattedText+")",gridColumns:this.drillThroughDialog.frameGridColumns(i),cancel:!1};"CSV"===this.parent.dataSourceSettings.type&&(n=this.frameData(n));var o=this,l=n.gridColumns;this.parent.trigger("drillThrough",n,(function(e){if(sf.base.isBlazor()){for(var t=0;t<e.gridColumns.length;t++)l[t].field===e.gridColumns[t].field&&(l[t].field=e.gridColumns[t].field,l[t].editType=e.gridColumns[t].editType,l[t].headerText=e.gridColumns[t].headerText,l[t].type=e.gridColumns[t].type,l[t].validationRules=e.gridColumns[t].validationRules,l[t].visible=e.gridColumns[t].visible,l[t].width=e.gridColumns[t].width);e.gridColumns=l}n.cancel||o.drillThroughDialog.showDrillThroughDialog(e)}))},e}(),ue=function(){function e(){this.headerColl={},this.maxLevel=0,this.columnGroupObject={},this.fieldPosition=[],this.measurePos=-1,this.measuresNames={},this.accumulationType=["Pie","Pyramid","Doughnut","Funnel"]}return e.prototype.getModuleName=function(){return"pivotchart"},e.prototype.loadChart=function(e,t){if(this.parent=e,this.measuresNames={},this.engineModule="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,this.dataSourceSettings=this.parent.dataSourceSettings,this.chartSettings=t,"olap"===e.dataType?e.olapEngineModule.tupColumnInfo.length>0&&e.olapEngineModule.tupRowInfo.length>0&&(!sf.base.isNullOrUndefined(e.olapEngineModule.colMeasurePos)||!sf.base.isNullOrUndefined(e.olapEngineModule.rowMeasurePos)):e.dataSourceSettings.values.length>0){this.parent.chart||!this.parent.element.querySelector(".e-chart")&&!this.parent.element.querySelector(".e-accumulationchart")||sf.base.remove(sf.base.select("#"+this.parent.element.id+"_chart",this.parent.element)),this.chartSettings.enableMultiAxis&&this.accumulationType.indexOf(t.chartSeries.type)<0?this.measureList=this.dataSourceSettings.values.map((function(e){return e.name})):this.measureList=[""===t.value?this.dataSourceSettings.values[0].name:t.value];for(var i=0,a=this.dataSourceSettings.values;i<a.length;i++){var s=a[i],r=s.name.replace(/[^A-Z0-9]+/gi,"_");this.measuresNames[s.name]=r,this.measuresNames[r]=s.name}this.columnGroupObject={},this.accEmptyPoint=!1;var n=this.engineModule.pivotValues;this.currentMeasure=t.enableMultiAxis&&this.accumulationType.indexOf(t.chartSeries.type)<0?this.measureList[0]:(""===t.value||0===this.dataSourceSettings.values.filter((function(e){return e.name===t.value})).length)&&this.dataSourceSettings.values.length>0?this.dataSourceSettings.values[0].name:t.value;var o,l,d,h=this.getColumnTotalIndex(n),u=Object.keys(n),c={},g=0,f=-.5;this.headerColl={},this.maxLevel=0;var m,v={},b="",S="",y="",C=!1;"olap"===this.parent.dataType&&(v=this.groupHierarchyWithLevels(n),b=this.fieldPosition[this.fieldPosition.length-1],y=S=this.measurePos===this.fieldPosition.length-1&&this.fieldPosition.length>1?this.fieldPosition[this.fieldPosition.length-2]:b);for(var w=0,x=u;w<x.length;w++){var T=x[w],M=Number(T);if(!sf.base.isNullOrUndefined(n[M])&&n[M][0]&&"row"===n[M][0].axis&&(0===this.dataSourceSettings.rows.length||"grand sum"!==n[M][0].type)){var D=n[M][0],E="olap"===this.parent.dataType?this.engineModule.tupRowInfo[D.ordinal]:void 0,O=-1,P=D.level;"olap"===this.parent.dataType?(C="[Measures]"===D.hierarchy?C:this.isAttributeDrill(D.hierarchy,E.drillInfo),y=y===S||"[Measures]"===D.hierarchy||D.isNamedSet||this.engineModule.fieldList[D.hierarchy]&&!this.engineModule.fieldList[D.hierarchy].hasAllMember?S:y,O=E.drillInfo.length-1,3===D.memberType||E.measureName&&E.measureName!==this.dataSourceSettings.values[0].name||(c=0===(g=(l=void 0===l?D.levelUniqueName:l)===D.levelUniqueName?0:g)?{}:c,g=d&&l!==D.levelUniqueName?d.hierarchy===D.hierarchy?g+(D.level-d.level):sf.base.isNullOrUndefined(c[D.levelUniqueName])?v[D.hierarchy].start:c[D.levelUniqueName]:g,c[D.levelUniqueName]=g,P=g,f+=!d||y!==d.hierarchy||d.isDrilled&&d.hasChild?0:1,y=C?D.hierarchy:S,o=g,d=D)):"value"!==D.type&&(void 0===o||o<P||f++,o=P),this.maxLevel=P>this.maxLevel?P:this.maxLevel;var F="olap"===this.parent.dataType?D.formattedText:D.actualText?D.actualText.toString():D.formattedText.toString(),I=D.formattedText?D.formattedText.toString():F,L=D.hasChild&&!D.isNamedSet?(D.isDrilled?" - ":" + ")+I:I,A=E?E.uNameCollection:D.valueSort.levelName.toString(),R={name:F,text:L,hasChild:D.hasChild,isDrilled:D.isDrilled,levelName:A,level:P,fieldName:D.valueSort.axis?D.valueSort.axis.toString():"",rowIndex:M,colIndex:0,cell:D};("olap"===this.parent.dataType?3!==D.memberType:"value"!==D.type)&&(this.headerColl[f]||(this.headerColl[f]={}),this.headerColl[f][P]=R);var k=n[M],j=Object.keys(k),q=void 0;m="olap"===this.parent.dataType?3!==D.memberType?D:m:"value"!==D.type?D:m;for(var V=0,B=j;V<B.length;V++){var _=B[V],H=Number(_),U=n[M][H],G=""!==U.rowHeaders||0===this.dataSourceSettings.rows.length,z="olap"===this.parent.dataType&&E&&E.measureName?E.measureName:U.actualText;if(("olap"!==this.parent.dataType||!U.isGrandSum)&&!h[U.colIndex]&&"value"===U.axis&&"header"!==D.type&&""!==z&&(t.enableMultiAxis&&this.accumulationType.indexOf(t.chartSeries.type)<0||z===this.currentMeasure)){if(sf.base.isNullOrUndefined(D.members)&&(D.members=[]),"olap"===this.parent.dataType?b!==D.hierarchy&&!C||(3===D.memberType&&q?O!==this.measurePos||q.isDrilled&&q.hasChild:D.isDrilled&&D.hasChild):("value"===D.type&&q?q.members.length>0:D.members.length>0)||!G)break;var W="olap"===this.parent.dataType?U.columnHeaders.toString().split(/~~|::/).join(" - "):U.columnHeaders.toString().split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).join(" - "),Q="olap"===this.parent.dataType?U.rowHeaders.toString().split(/~~|::/).join(" - "):U.rowHeaders.toString().split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).join(" - "),Y=W+" | "+z,K="pivot"===this.parent.dataType&&this.engineModule.aggregatedValueMatrix[M]&&!sf.base.isNullOrUndefined(this.engineModule.aggregatedValueMatrix[M][H])?Number(this.engineModule.aggregatedValueMatrix[M][H]):Number(U.value);0===K&&(this.accEmptyPoint=!0),this.columnGroupObject[Y]?this.columnGroupObject[Y].push({x:0===this.dataSourceSettings.rows.length?D.formattedText:Q,y:K,rIndex:M,cIndex:H}):this.columnGroupObject[Y]=[{x:0===this.dataSourceSettings.rows.length?D.formattedText:Q,y:K,rIndex:M,cIndex:H}]}q=m}}}this.refreshChart()}else{if(this.parent.chart)return this.parent.element.querySelector(".e-chart")?(this.parent.chart.series=[],this.parent.chart.rows=[],this.parent.chart.primaryXAxis.title="",this.parent.chart.primaryYAxis.title="",this.parent.chart.primaryXAxis.multiLevelLabels=[],this.parent.chart.primaryYAxis.multiLevelLabels=[],this.parent.chart.axes.length>0&&(this.parent.chart.axes[0].title=""),this.parent.chart.primaryXAxis.zoomFactor=1):this.parent.element.querySelector(".e-accumulationchart")&&(this.parent.chart.series[0].dataSource=[{}],this.parent.chart.series[0].dataLabel={}),void this.parent.chart.refresh();if(!sf.base.select("#"+this.parent.element.id+"_chart",this.parent.element)){"Both"===this.parent.displayOption.view&&"Chart"===this.parent.displayOption.primary?this.parent.element.insertBefore(sf.base.createElement("div",{className:N,id:this.parent.element.id+"_chart"}),this.parent.element.querySelector(".e-grid")):this.parent.element.appendChild(sf.base.createElement("div",{className:N,id:this.parent.element.id+"_chart"}));var J=this.parent.width.toString();this.parent.showToolbar&&this.parent.grid&&(J=this.parent.getGridWidthAsNumber().toString());var X=this.getChartHeight();(this.chartSettings&&this.chartSettings.chartSeries&&this.accumulationType.indexOf(this.chartSettings.chartSeries.type)>-1?new sf.charts.AccumulationChart({width:J,height:X}):new sf.charts.Chart({width:J,height:X})).appendTo("#"+this.parent.element.id+"_chart"),this.parent.showToolbar&&("Both"===this.parent.displayOption.view&&"Chart"===this.parent.currentView&&(this.parent.grid.element.style.display="none"),"Chart"!==this.parent.currentView&&(sf.base.select("#"+this.parent.element.id+"_chart",this.parent.element).style.display="none"))}this.parent.notify(p,{})}},e.prototype.refreshChart=function(){this.chartSeries=[];var e=Object.keys(this.columnGroupObject);this.persistSettings=JSON.parse(this.parent.getPersistData()).chartSettings;for(var t=this.parent.chartSettings.columnDelimiter?this.parent.chartSettings.columnDelimiter:"-",i=this.parent.chartSettings.columnHeader&&""!==this.parent.chartSettings.columnHeader?this.parent.chartSettings.columnHeader.split(t).join(" - "):"",a=this.chartSettings.chartSeries?this.chartSettings.chartSeries.type:void 0,s={},r=0;r<this.parent.dataSourceSettings.values.length;r++)s[this.parent.dataSourceSettings.values[r].name]=sf.base.isNullOrUndefined(this.parent.dataSourceSettings.values[r].caption)?void 0:this.parent.dataSourceSettings.values[r].caption;if(this.accumulationType.indexOf(a)>-1&&e.length>0){this.currentColumn=e.indexOf(i+" | "+this.currentMeasure)>-1&&void 0!==i?i+" | "+this.currentMeasure:e[0];var n={};n=this.persistSettings.chartSeries?this.frameChartSeries(this.persistSettings.chartSeries):n,(sf.base.isNullOrUndefined(n.palettes)||0==n.palettes.length)&&!sf.base.isNullOrUndefined(this.persistSettings.palettes)&&this.persistSettings.palettes.length>0&&(n.palettes=this.persistSettings.palettes),n.dataSource=this.columnGroupObject[this.currentColumn],n.xName="x",n.yName="y",sf.base.isBlazor()&&sf.base.isNullOrUndefined(this.persistSettings.chartSeries.dataLabel.visible)&&(this.persistSettings.chartSeries.dataLabel.visible=!0,this.persistSettings.chartSeries.dataLabel.position="Outside"),this.persistSettings.chartSeries&&this.persistSettings.chartSeries.dataLabel?(n.dataLabel=this.persistSettings.chartSeries.dataLabel,n.dataLabel.name="x"):(n.dataLabel={visible:!0,position:"Outside",name:"x"},this.parent.setProperties({chartSettings:{chartSeries:{dataLabel:{visible:!0,position:"Outside"}}}},!0)),this.accEmptyPoint&&n.emptyPointSettings?n.emptyPointSettings.mode="Zero":this.accEmptyPoint&&(n.emptyPointSettings={mode:"Zero"}),n.name=this.currentColumn,"Doughnut"===a?(n.type="Pie",n.innerRadius=this.chartSettings.chartSeries.innerRadius?this.chartSettings.chartSeries.innerRadius:"40%"):"Pie"===a&&(n.innerRadius=this.chartSettings.chartSeries.innerRadius?this.chartSettings.chartSeries.innerRadius:"0"),this.chartSeries=this.chartSeries.concat(n)}else for(var o=0,l=e;o<l.length;o++){var d=l[o];n={};n=this.persistSettings.chartSeries?this.frameChartSeries(this.persistSettings.chartSeries):n,!sf.base.isNullOrUndefined(n.palettes)&&n.palettes.length>0&&(sf.base.isNullOrUndefined(this.persistSettings.palettes)||0==this.persistSettings.palettes.length)&&(this.chartSettings.palettes=n.palettes),n.dataSource=this.columnGroupObject[d],n.xName="x",n.yName="y";var h=void 0;if(this.chartSettings.enableMultiAxis){var u=d.split(" | ")[1];u=sf.base.isNullOrUndefined(s[u])?u:s[u],h=d.split(" | ")[0]+" | "+u}if(n.name=this.chartSettings.enableMultiAxis?h:d.split(" | ")[0],["Radar","Polar"].indexOf(a)<0){var c=d.split(" | ")[1];n.yAxisName=this.measuresNames[c]?this.measuresNames[c]:c}this.persistSettings.chartSeries&&this.persistSettings.chartSeries.emptyPointSettings&&(n.emptyPointSettings=this.persistSettings.chartSeries.emptyPointSettings),this.chartSeries=this.chartSeries.concat(n)}var g={series:this.chartSeries,cancel:!1},f=this;this.parent.trigger("chartSeriesCreated",g,(function(e){e.cancel?(f.element&&sf.base.remove(f.element),f.parent.notify(p,{})):f.bindChart()}))},e.prototype.frameObjectWithKeys=function(e){for(var t=Object.keys(e),i=0,a={};i<t.length;)a[t[i]]=e[t[i]],i++;return a},e.prototype.frameChartSeries=function(e){for(var t=Object.keys(e),i=0,a={};i<t.length;)this.accumulationType.indexOf(this.parent.chartSettings.chartSeries.type)>-1&&["fill","dashArray","width","segmentAxis","drawType","isClosed","segments","stackingGroup","marker","errorBar","trendlines","minRadius","splineType","maxRadius","cardinalSplineTension","columnWidth","columnSpacing","cornerRadius"].indexOf(t[i])>-1||this.accumulationType.indexOf(this.parent.chartSettings.chartSeries.type)<0&&["endAngle","explode","explodeAll","explodeIndex","explodeOffset","gapRatio","groupMode","groupTo","neckHeight","neckWidth","pyramidMode","startAngle","dataLabel","innerRadius"].indexOf(t[i])>-1||(a[t[i]]=e[t[i]]),i++;return a},e.prototype.bindChart=function(){this.parent.showWaitingPopup();var e=this.configXAxis(),t=this.configTooltipSettings(),i=this.configLegendSettings(),a=this.configZoomSettings(),s=this.frameAxesWithRows(),r=this.chartSettings.chartSeries.type;"Both"===this.parent.displayOption.view?this.element="Chart"===this.parent.displayOption.primary?this.parent.element.insertBefore(this.element?this.element:sf.base.createElement("div",{className:N,id:this.parent.element.id+"_chart"}),this.parent.element.querySelector(".e-grid")):this.parent.element.appendChild(this.element?this.element:sf.base.createElement("div",{className:N,id:this.parent.element.id+"_chart"})):this.element||(this.element=this.parent.element.appendChild(sf.base.createElement("div",{className:N,id:this.parent.element.id+"_chart"}))),!this.chartElement&&this.parent.chartSettings.enableScrollOnMultiAxis&&this.parent.chartSettings.enableMultiAxis&&(this.parent.element.querySelector("."+N).innerHTML="",this.chartElement=this.parent.element.querySelector("."+N).appendChild(sf.base.createElement("div",{className:"e-pivotchart-inner",id:this.parent.element.id+"_chartInner"}))),this.parent.element.querySelector(".e-pivotchart-inner")&&(this.parent.element.querySelector(".e-pivotchart-inner").innerHTML=""),this.parent.showGroupingBar?this.element.style.minWidth="400px !important":this.element.style.minWidth="310px !important";var n=this.parent.width.toString();this.parent.showToolbar&&this.parent.grid&&(n=this.parent.getGridWidthAsNumber().toString());var o=this.getChartHeight();this.parent.chartSettings.enableScrollOnMultiAxis&&this.parent.chartSettings.enableMultiAxis&&this.accumulationType.indexOf(r)<0&&(this.parent.element.querySelector("."+N).style.height=("auto"===o?this.getChartAutoHeight():o)+"px",this.parent.element.querySelector("."+N).style.width=n+"px","Polar"!==this.parent.chartSettings.chartSeries.type&&"Radar"!==this.parent.chartSettings.chartSeries.type&&(this.parent.element.querySelector("."+N).style.overflow="auto",this.parent.element.querySelector("."+N).style.overflowX="hidden")),this.parent.chart&&("accumulationchart"===this.parent.chart.getModuleName()&&this.accumulationType.indexOf(r)<0||"chart"===this.parent.chart.getModuleName()&&this.accumulationType.indexOf(r)>-1)&&(this.parent.chart.destroy(),sf.base.select("#"+this.parent.element.id+"_chart",this.parent.element)&&(sf.base.select("#"+this.parent.element.id+"_chart",this.parent.element).innerHTML="",sf.base.select("#"+this.parent.element.id+"_chart",this.parent.element).appendChild(sf.base.createElement("div",{className:"e-pivotchart-inner",id:this.parent.element.id+"_chartInner"})))),!(this.parent.chart&&this.parent.chart.element&&this.parent.element.querySelector(".e-chart")||this.parent.element.querySelector(".e-accumulationchart"))||this.parent.toolbarModule&&this.parent.toolbarModule.isMultiAxisChange?(this.parent.toolbarModule&&this.parent.toolbarModule.isMultiAxisChange&&this.parent.chart&&(this.parent.chart.isDestroyed||this.parent.chart.destroy(),this.parent.chart=void 0,sf.base.select("#"+this.parent.element.id+"_chart",this.parent.element).innerHTML="",sf.base.select("#"+this.parent.element.id+"_chart",this.parent.element).appendChild(sf.base.createElement("div",{className:"e-pivotchart-inner",id:this.parent.element.id+"_chartInner"})),this.parent.toolbarModule.isMultiAxisChange=!1),sf.charts.Chart.Inject(sf.charts.ColumnSeries,sf.charts.StackingColumnSeries,sf.charts.RangeColumnSeries,sf.charts.BarSeries,sf.charts.StackingBarSeries,sf.charts.ScatterSeries,sf.charts.BubbleSeries,sf.charts.LineSeries,sf.charts.StepLineSeries,sf.charts.SplineSeries,sf.charts.SplineAreaSeries,sf.charts.MultiColoredLineSeries,sf.charts.PolarSeries,sf.charts.RadarSeries,sf.charts.AreaSeries,sf.charts.RangeAreaSeries,sf.charts.StackingAreaSeries,sf.charts.StepAreaSeries,sf.charts.MultiColoredAreaSeries,sf.charts.ParetoSeries,sf.charts.Legend,sf.charts.Tooltip,sf.charts.Category,sf.charts.MultiLevelLabel,sf.charts.ScrollBar,sf.charts.Zoom,sf.charts.Export,sf.charts.Crosshair,sf.charts.Selection,sf.charts.StripLine,sf.charts.DataLabel),sf.charts.AccumulationChart.Inject(sf.charts.PieSeries,sf.charts.FunnelSeries,sf.charts.PyramidSeries,sf.charts.AccumulationDataLabel,sf.charts.AccumulationLegend,sf.charts.AccumulationTooltip,sf.charts.Export),this.accumulationType.indexOf(r)>-1?this.parent.chart=new sf.charts.AccumulationChart({series:this.chartSeries.length>0?this.chartSeries:[{}],legendSettings:i,tooltip:t,width:n,height:o.toString(),title:this.chartSettings.title,enableSmartLabels:this.chartSettings.enableSmartLabels,center:this.chartSettings.pieCenter,enableBorderOnMouseMove:this.chartSettings.enableBorderOnMouseMove,highLightMode:this.chartSettings.highlightMode,highlightPattern:this.chartSettings.highlightPattern,titleStyle:this.chartSettings.titleStyle,subTitle:this.chartSettings.subTitle,subTitleStyle:this.chartSettings.subTitleStyle,margin:this.chartSettings.margin,border:this.chartSettings.border,background:this.chartSettings.background,theme:this.chartSettings.theme,selectionMode:this.chartSettings.accumulationSelectionMode,isMultiSelect:this.chartSettings.isMultiSelect,enableExport:this.chartSettings.enableExport,selectedDataIndexes:this.chartSettings.selectedDataIndexes,enableAnimation:this.chartSettings.enableAnimation,useGroupingSeparator:this.chartSettings.useGroupingSeparator,locale:this.parent.locale,beforePrint:this.chartSettings.beforePrint?this.chartSettings.beforePrint.bind(this):void 0,animationComplete:this.chartSettings.animationComplete?this.chartSettings.animationComplete.bind(this):void 0,legendRender:this.chartSettings.legendRender?this.chartSettings.legendRender.bind(this):void 0,textRender:this.chartSettings.textRender?this.chartSettings.textRender.bind(this):void 0,pointRender:this.chartSettings.pointRender?this.chartSettings.pointRender.bind(this):void 0,seriesRender:this.chartSettings.seriesRender?this.chartSettings.seriesRender.bind(this):void 0,chartMouseMove:this.chartSettings.chartMouseMove?this.chartSettings.chartMouseMove.bind(this):void 0,chartMouseClick:this.chartSettings.chartMouseClick?this.chartSettings.chartMouseClick.bind(this):void 0,pointMove:this.chartSettings.pointMove?this.chartSettings.pointMove.bind(this):void 0,pointClick:this.pointClick.bind(this),chartMouseLeave:this.chartSettings.chartMouseLeave?this.chartSettings.chartMouseLeave.bind(this):void 0,chartMouseDown:this.chartSettings.chartMouseDown?this.chartSettings.chartMouseDown.bind(this):void 0,chartMouseUp:this.chartSettings.chartMouseUp?this.chartSettings.chartMouseUp.bind(this):void 0,tooltipRender:this.tooltipRender.bind(this),loaded:this.loaded.bind(this),load:this.load.bind(this),resized:this.resized.bind(this)}):this.parent.chart=new sf.charts.Chart({series:this.chartSeries.length>0?this.chartSeries:[{}],legendSettings:i,tooltip:t,zoomSettings:a,axes:"Polar"===r||"Radar"===r?[]:s.axes,rows:"Polar"===r||"Radar"===r?[{}]:"Bar"===r||"StackingBar"===r||"StackingBar100"===r&&this.chartSettings.enableMultiAxis?[{height:"100%"}]:s.rows,columns:"Polar"===r||"Radar"===r?[{}]:"Bar"===r||"StackingBar"===r||"StackingBar100"===r&&this.chartSettings.enableMultiAxis?s.columns:[{width:"100%"}],primaryYAxis:"Polar"===r||"Radar"===r?s.axes[0]:{visible:!1},primaryXAxis:e,width:n,height:"Polar"!==this.parent.chartSettings.chartSeries.type&&"Radar"!==this.parent.chartSettings.chartSeries.type&&this.parent.chartSettings.enableScrollOnMultiAxis&&this.parent.chartSettings.enableMultiAxis&&this.parent.dataSourceSettings.values.length>0?Number(o)>235*this.parent.dataSourceSettings.values.length+100?isNaN(Number(o))?o.toString():(Number(o)-5).toString():!isNaN(Number(o))||this.parent.dataSourceSettings.values.length>1?(235*this.parent.dataSourceSettings.values.length+100).toString():o.toString():o.toString(),title:this.chartSettings.title,titleStyle:this.chartSettings.titleStyle,subTitle:this.chartSettings.subTitle,subTitleStyle:this.chartSettings.subTitleStyle,margin:this.chartSettings.margin,border:this.chartSettings.border,background:this.chartSettings.background,chartArea:this.chartSettings.chartArea,palettes:this.chartSettings.palettes,theme:this.chartSettings.theme,crosshair:this.chartSettings.crosshair,selectionMode:this.chartSettings.selectionMode,isMultiSelect:this.chartSettings.isMultiSelect,enableExport:this.chartSettings.enableExport,selectedDataIndexes:this.chartSettings.selectedDataIndexes,isTransposed:this.chartSettings.isTransposed,enableAnimation:this.chartSettings.enableAnimation,useGroupingSeparator:this.chartSettings.useGroupingSeparator,description:this.chartSettings.description,tabIndex:this.chartSettings.tabIndex,locale:this.parent.locale,enableSideBySidePlacement:this.chartSettings.enableSideBySidePlacement,beforePrint:this.chartSettings.beforePrint?this.chartSettings.beforePrint.bind(this):void 0,animationComplete:this.chartSettings.animationComplete?this.chartSettings.animationComplete.bind(this):void 0,legendRender:this.chartSettings.legendRender?this.chartSettings.legendRender.bind(this):void 0,textRender:this.chartSettings.textRender?this.chartSettings.textRender.bind(this):void 0,pointRender:this.chartSettings.pointRender?this.chartSettings.pointRender.bind(this):void 0,seriesRender:this.chartSettings.seriesRender?this.chartSettings.seriesRender.bind(this):void 0,chartMouseMove:this.chartSettings.chartMouseMove?this.chartSettings.chartMouseMove.bind(this):void 0,chartMouseClick:this.chartSettings.chartMouseClick?this.chartSettings.chartMouseClick.bind(this):void 0,pointMove:this.chartSettings.pointMove?this.chartSettings.pointMove.bind(this):void 0,pointClick:this.pointClick.bind(this),chartMouseLeave:this.chartSettings.chartMouseLeave?this.chartSettings.chartMouseLeave.bind(this):void 0,chartMouseDown:this.chartSettings.chartMouseDown?this.chartSettings.chartMouseDown.bind(this):void 0,chartMouseUp:this.chartSettings.chartMouseUp?this.chartSettings.chartMouseUp.bind(this):void 0,dragComplete:this.chartSettings.dragComplete?this.chartSettings.dragComplete.bind(this):void 0,zoomComplete:this.chartSettings.zoomComplete?this.chartSettings.zoomComplete.bind(this):void 0,scrollStart:this.chartSettings.scrollStart?this.chartSettings.scrollStart.bind(this):void 0,scrollEnd:this.chartSettings.scrollEnd?this.chartSettings.scrollEnd.bind(this):void 0,scrollChanged:this.chartSettings.scrollChanged?this.chartSettings.scrollChanged.bind(this):void 0,tooltipRender:this.tooltipRender.bind(this),loaded:this.loaded.bind(this),load:this.load.bind(this),resized:this.resized.bind(this),axisLabelRender:this.axisLabelRender.bind(this),multiLevelLabelClick:this.multiLevelLabelClick.bind(this)}),this.parent.chart.isStringTemplate=!0):(this.parent.chart.series=this.chartSeries,"Polar"===r||"Radar"===r?(this.parent.chart.primaryXAxis=e,this.parent.chart.primaryYAxis.visible=!0,this.parent.chart.primaryYAxis=s.axes[0],this.parent.chart.axes=[],this.parent.chart.rows=[{}]):this.accumulationType.indexOf(r)<0&&"chart"===this.parent.chart.getModuleName()&&(this.parent.chart.primaryYAxis.visible=!1,this.parent.chart.primaryXAxis=e,this.parent.chart.axes=s.axes,"Bar"===r||"StackingBar"===r||"StackingBar100"===r&&this.chartSettings.enableMultiAxis?(this.parent.chart.rows=[{height:"100%"}],this.parent.chart.columns=s.columns):(this.parent.chart.rows=s.rows,this.parent.chart.columns=[{width:"100%"}])),this.parent.chart.refresh(),this.accumulationType.indexOf(r)>-1&&"accumulationchart"===this.parent.chart.getModuleName()&&(0===this.parent.dataSourceSettings.rows.length||0===this.parent.dataSourceSettings.columns.length)&&(this.parent.hideWaitingPopup(),this.parent.pivotFieldListModule&&sf.popups.hideSpinner(this.parent.pivotFieldListModule.fieldListSpinnerElement))),this.parent.chartSettings.enableScrollOnMultiAxis&&this.parent.chartSettings.enableMultiAxis?this.parent.chart.appendTo("#"+this.parent.element.id+"_chartInner"):this.parent.chart.appendTo("#"+this.parent.element.id+"_chart")},e.prototype.pointClick=function(e){var t=e.series.dataSource?e.series.dataSource:this.parent.chart.series[e.seriesIndex].dataSource;if((["Pie","Funnel","Doughnut","Pyramid","Radar","Polar"].indexOf(this.parent.chartSettings.chartSeries.type)>-1||!this.parent.chartSettings.showMultiLevelLabels)&&this.parent.dataSourceSettings.rows.length>1){this.pivotIndex={rIndex:t?t[e.pointIndex].rIndex:void 0,cIndex:t?t[e.pointIndex].cIndex:void 0},this.creatMenu();var i=this.parent.element.getBoundingClientRect(),a=(this.parent.element.querySelector(".e-pivot-toolbar")?this.parent.element.querySelector(".e-pivot-toolbar").clientHeight:0)+(this.parent.element.querySelector(".e-chart-grouping-bar")?this.parent.element.querySelector(".e-chart-grouping-bar").clientHeight:0)+(window.scrollY||document.documentElement.scrollTop)+i.top;this.accumulationMenu.open(a+e.y,e.x+i.left+(window.scrollX||document.documentElement.scrollLeft))}else if((this.parent.allowDrillThrough||this.parent.editSettings.allowEditing)&&this.parent.drillThroughModule){var s=t[e.pointIndex].rIndex,r=t[e.pointIndex].cIndex;this.parent.drillThroughModule.executeDrillThrough(this.parent.pivotValues[s][r],s,r)}this.parent.trigger("chartPointClick",e)},e.prototype.frameAxesWithRows=function(){var e=[],t=[],i=[],a=this.persistSettings.chartSeries&&("StackingColumn100"===this.persistSettings.chartSeries.type||"StackingBar100"===this.persistSettings.chartSeries.type||"StackingArea100"===this.persistSettings.chartSeries.type),s=["PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal","PercentageOfDifferenceFrom","PercentageOfParentRowTotal","PercentageOfParentColumnTotal","PercentageOfParentTotal"];if(this.chartSettings.enableMultiAxis)for(var n=0,o=100/this.dataSourceSettings.values.length+"%",l=0,d=this.dataSourceSettings.values;l<d.length;l++){for(var p=d[l],h=this.engineModule.fieldList[p.name],u=("olap"===this.parent.dataType?"":this.parent.localeObj.getConstant(h.aggregateType)+" "+this.parent.localeObj.getConstant("of")+" ")+h.caption,c=void 0,g=0,f=this.dataSourceSettings.formatSettings;g<f.length;g++){var m=f[g];if(m.name===p.name){c=m;break}}var v=-1!==r.inArray(h.aggregateType,s)?"P2":c?null===c.format.toLowerCase().match(/n|p|c/)?"N":c.format:"olap"===this.parent.dataType?this.getFormat(h.formatString):"N",b="Polar"===this.chartSettings.chartSeries.type||"Radar"===this.chartSettings.chartSeries.type,S={};(S=this.persistSettings.primaryYAxis?this.frameObjectWithKeys(this.persistSettings.primaryYAxis):S).labelFormat=S.labelFormat?S.labelFormat:a?"":b?"N":v,S.title=S.title?S.title:u,S.plotOffsetTop=S.plotOffsetTop?S.plotOffsetTop:"Bar"===this.chartSettings.chartSeries.type||"StackingBar"===this.chartSettings.chartSeries.type||"StackingBar100"===this.chartSettings.chartSeries.type?50:30,S.rowIndex=n,S.columnIndex=n,b||(S.name=this.measuresNames[p.name]?this.measuresNames[p.name]:p.name),e=e.concat(S),t.push({height:o}),i.push({width:o}),n++}else{h=this.engineModule.fieldList[this.currentMeasure],u=("olap"===this.parent.dataType?"":this.parent.localeObj.getConstant(h.aggregateType)+" "+this.parent.localeObj.getConstant("of")+" ")+h.caption,c=void 0;for(var y=0,C=this.dataSourceSettings.formatSettings;y<C.length;y++){if((p=C[y]).name===this.currentMeasure){c=p;break}}var w=void 0;c&&(w=c.format.length);S={},v=-1!==r.inArray(h.aggregateType,s)?"P2":c?null===c.format.toLowerCase().match(/n[0-10]|p[0-10]|c[0-10]/)||w>3?"N":c.format:"olap"===this.parent.dataType?this.getFormat(h.formatString):"N";(S=this.persistSettings.primaryYAxis?this.frameObjectWithKeys(this.persistSettings.primaryYAxis):S).rowIndex=0,S.columnIndex=0,"Polar"!==this.chartSettings.chartSeries.type&&"Radar"!==this.chartSettings.chartSeries.type&&(S.name=this.measuresNames[this.currentMeasure]?this.measuresNames[this.currentMeasure]:this.currentMeasure),S.labelFormat=S.labelFormat?S.labelFormat:a?"":v,S.title=S.title?S.title:u,e=e.concat(S),t.push({height:"100%"}),i.push({width:"100%"})}return{axes:e,rows:t,columns:i}},e.prototype.getFormat=function(e){return e="Currency"===e?"C":"Percent"===e?"P":"N"},e.prototype.getColumnTotalIndex=function(e){for(var t={},i=0,a=Object.keys(e);i<a.length;i++){var s=a[i],r=e[Number(s)];if(!sf.base.isNullOrUndefined(r))for(var n=0,o=Object.keys(r);n<o.length;n++){var l=o[n],d=r[Number(l)];if(!sf.base.isNullOrUndefined(d)){if("column"!==d.axis)return t;("sum"===d.type||0!==this.dataSourceSettings.columns.length&&"grand sum"===d.type)&&-1!==d.rowSpan&&(t[d.colIndex]=d.colIndex)}}}return t},e.prototype.groupHierarchyWithLevels=function(e){var t,i;this.fieldPosition=[];var a={},s=0,r={};this.measurePos=this.engineModule.tupRowInfo[0].measurePosition;for(var n=0;n<e.length;n++){var o=e[n][0];o&&"row"===o.axis&&"grand sum"!==o.type&&(sf.base.isNullOrUndefined(a[o.hierarchy])?(3===o.memberType?s===this.measurePos?(this.fieldPosition[this.measurePos]=o.hierarchy,a[o.hierarchy]=((t={})[o.levelUniqueName]=o.levelUniqueName,t)):s--:(this.fieldPosition[s]=o.hierarchy,a[o.hierarchy]=((i={})[o.levelUniqueName]=o.levelUniqueName,i)),s++):a[o.hierarchy][o.levelUniqueName]=o.levelUniqueName)}for(var l=-1,d=0;d<this.fieldPosition.length;d++)this.measurePos!==d&&(r[this.fieldPosition[d]]={start:l+1,end:l+Object.keys(a[this.fieldPosition[d]]).length},l=r[this.fieldPosition[d]].end);return r},e.prototype.frameMultiLevelLabels=function(){for(var e=Object.keys(this.headerColl),t=this.headerColl[-.5],i=0,a=e;i<a.length;i++){for(var s=a[i],r=Number(s),n=this.headerColl[r],o=0,l=!1;o<=this.maxLevel;)l?n[o]||(n[o]={name:n[o-1].name,text:"",hasChild:n[o-1].hasChild,isDrilled:n[o-1].isDrilled,levelName:n[o-1].levelName,level:n[o-1].level,fieldName:n[o-1].fieldName,rowIndex:n[o-1].rowIndex,colIndex:n[o-1].colIndex,span:-1}):n[o]?l=!0:n[o]=t[o],o++;t=this.headerColl[r]}for(var d={},p=0,h=e;p<h.length;p++){s=h[p],r=Number(s),n=this.headerColl[r];for(var u=0,c=Object.keys(n);u<c.length;u++){var g=c[u],f=Number(g);if(d[f]){var m=d[f].length;n[f].levelName===t[f].levelName?d[f][m-1].end=d[f][m-1].end+1:d[f].push({start:r,end:r+1,text:n[f].text,type:-1===n[f].span?"WithoutTopandBottomBorder":"WithoutTopBorder",customAttributes:n[f]})}else d[f]=[{start:r,end:r+1,text:n[f].text,type:-1===n[f].span?"WithoutTopandBottomBorder":"WithoutTopBorder",customAttributes:n[f]}]}t=n}for(var v=[],b=Object.keys(d).length-1;b>-1;b--)v.push({categories:d[b],border:{width:1},overflow:"Trim"});return v},e.prototype.getZoomFactor=function(){isNaN(Number(this.parent.width))?this.parent.width.indexOf("%")>-1?this.calculatedWidth=this.parent.element.clientWidth*(parseFloat(this.parent.width)/100):this.parent.width.indexOf("px")>-1?this.calculatedWidth=Number(this.parent.width.toString().split("px")[0]):this.calculatedWidth=this.parent.element.clientWidth:this.calculatedWidth=Number(this.parent.width);var e=10*this.chartSeries.length>120?10*this.chartSeries.length:120,t=this.chartSeries.length>0?this.calculatedWidth/(Object.keys(this.chartSeries[0].dataSource).length*e):1;return t=t<1&&t>0?t:1},e.prototype.configTooltipSettings=function(){var e=this.chartSettings.tooltip;return e.enable=void 0===e.enable||e.enable,e.enable&&e.template&&(this.templateFn=this.parent.templateParser(e.template)),this.parent.tooltipTemplate&&(e.template=e.template?e.template:this.parent.tooltipTemplate),sf.base.isBlazor()?(this.parent.allowServerDataBinding=!1,this.parent.setProperties({chartSettings:{tooltip:{header:e.header?e.header:""}}},!0),this.parent.allowServerDataBinding=!0):e.header=e.header?e.header:"",e.enableMarker=void 0===e.enableMarker||e.enableMarker,e},e.prototype.configLegendSettings=function(){var e={};if(this.chartSettings.legendSettings)for(var t=0,i=Object.keys(this.chartSettings.legendSettings);t<i.length;)e[i[t]]=this.chartSettings.legendSettings[i[t]],t++;return this.accumulationType.indexOf(this.chartSettings.chartSeries.type)>-1&&void 0===e.visible&&(e.visible=!1),e.padding=e.padding?e.padding:25,e.shapePadding=e.shapePadding?e.shapePadding:10,e},e.prototype.configXAxis=function(){var e={};return(e=this.persistSettings.primaryXAxis?this.frameObjectWithKeys(this.persistSettings.primaryXAxis):e).valueType="Category",e.labelIntersectAction=e.labelIntersectAction?e.labelIntersectAction:"Rotate45",e.title=e.title?e.title:this.dataSourceSettings.rows.map((function(e){return e.caption||e.name})).join(" / "),e.zoomFactor=this.getZoomFactor(),this.parent.chartSettings.zoomSettings.enableScrollbar||(e.zoomFactor=1),this.chartSettings.showMultiLevelLabels&&(e.multiLevelLabels=this.frameMultiLevelLabels(),e.border={width:1,type:"WithoutTopandBottomBorder"},e.majorTickLines={width:0,height:-10}),e},e.prototype.configZoomSettings=function(){var e=this.chartSettings.zoomSettings;return e.enableSelectionZooming=void 0===e.enableSelectionZooming||e.enableSelectionZooming,e.enableScrollbar=void 0===e.enableScrollbar||e.enableScrollbar,e},e.prototype.tooltipRender=function(e){var t=e.series.yAxisName?e.series.yAxisName.split("_CumulativeAxis")[0]:this.chartSettings.enableMultiAxis&&this.accumulationType.indexOf(this.chartSettings.chartSeries.type)<0?e.series.name?e.series.name.split(" | ")[1]:e.data.seriesName?e.data.seriesName.split(" | ")[1]:this.currentMeasure:this.measuresNames[this.currentMeasure]?this.measuresNames[this.currentMeasure]:this.currentMeasure,i=e.series.dataSource?e.series.dataSource:this.parent.chart.series[e.data.seriesIndex].dataSource,a=i?i[e.data.pointIndex].rIndex:void 0,s=i?i[e.data.pointIndex].cIndex:void 0,r=this.engineModule.fieldList[this.measuresNames[t]?this.measuresNames[t]:t],n="olap"===this.parent.dataType?"":this.parent.localeObj.getConstant(r.aggregateType),o=("olap"===this.parent.dataType?"":n+" "+this.parent.localeObj.getConstant("of")+" ")+r.caption,l=this.accumulationType.indexOf(this.parent.chartSettings.chartSeries.type)<0?e.text.split("<b>")[1].split("</b>")[0]:this.engineModule.pivotValues[a][s].formattedText,d=this.engineModule.formatFields[r.id],p=d&&d.format&&null!==d.format.toLowerCase().match(/n|p|c/)&&this.chartSettings.useGroupingSeparator?"olap"===this.parent.dataType?this.engineModule.getFormattedValue(e.point.y,r.id,l):this.parent.engineModule.getFormattedValue(e.point.y,r.id).formattedText:l,h=e.series.name?e.series.name.split(" | ")[0]:e.data.seriesName.split(" | ")[0],u=e.point.x;if(this.parent.tooltipTemplate&&void 0!==this.parent.getTooltipTemplate()||this.chartSettings.tooltip.template){var c=i?this.parent.getHeaderField(a,s,"row"):"",g=i?this.parent.getHeaderField(a,s,"Column"):"",f={rowHeaders:u,columnHeaders:h,aggregateType:n,value:p,valueField:r.caption,rowFields:c,columnFields:g},m=void 0;m=this.parent.chartSettings&&this.parent.chartSettings.tooltip&&this.parent.chartSettings.tooltip.enable&&this.parent.chartSettings.tooltip.template?this.tooltipTemplateFn()(f,this,"tooltipTemplate",this.element.id+"1tooltipTemplate")[0].outerHTML:this.parent.getTooltipTemplate()(f,this,"tooltipTemplate",this.element.id+"tooltipTemplate")[0].outerHTML,e.template=m}else e.text=o+": "+p+(0===this.dataSourceSettings.columns.length?"":" <br/>"+this.parent.localeObj.getConstant("column")+": "+h)+(0===this.dataSourceSettings.rows.length?"":" <br/>"+this.parent.localeObj.getConstant("row")+": "+u),this.parent.trigger("chartTooltipRender",e)},e.prototype.tooltipTemplateFn=function(){return this.templateFn},e.prototype.loaded=function(e){if(this.parent.isChartLoaded=!0,this.parent.chart&&this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.showFieldList&&"Chart"===this.parent.currentView&&this.parent.groupingBarModule.alignIcon(),this.chartSettings.showMultiLevelLabels){var t=r.inArray(this.chartSettings.chartSeries.type,["Bar","StackingBar","StackingBar100"])>-1?"_chartYAxisMultiLevelLabel0":"_chartXAxisMultiLevelLabel0";sf.base.isNullOrUndefined(sf.base.select("#"+this.parent.element.id+t,this.parent.element))||this.parent.element.querySelector("#"+this.parent.element.id+t).setAttribute("cursor","pointer")}["Pie","Funnel","Pyramid","Doughnut","Radar","Polar"].indexOf(this.parent.chartSettings.chartSeries.type)>=0&&this.parent.chartSettings.enableScrollOnMultiAxis&&this.parent.chartSettings.enableMultiAxis?this.parent.element.querySelector("."+N).style.overflow="visible":this.parent.chartSettings.enableScrollOnMultiAxis&&this.parent.chartSettings.enableMultiAxis&&(this.parent.element.querySelector("."+N).style.overflow="auto",this.parent.element.querySelector("."+N).style.overflowX="hidden"),this.parent.chart.height=["Pie","Funnel","Pyramid","Doughnut","Radar","Polar"].indexOf(this.parent.chartSettings.chartSeries.type)<0&&this.parent.chartSettings.enableScrollOnMultiAxis&&this.parent.chartSettings.enableMultiAxis&&this.parent.dataSourceSettings.values.length>0?Number(this.parent.chart.height)>235*this.parent.dataSourceSettings.values.length+100?isNaN(Number(this.getChartHeight()))?this.getChartHeight().toString():(Number(this.getChartHeight())-5).toString():!isNaN(Number(this.getChartHeight()))||this.parent.dataSourceSettings.values.length>1?(235*this.parent.dataSourceSettings.values.length+100).toString():this.getChartHeight().toString():this.getChartHeight().toString(),this.updateView(),this.parent.notify(p,{}),this.parent.trigger("chartLoaded",e),("Server"===this.parent.dataSourceSettings.mode&&this.parent.isServerWaitingPopup||"Local"===this.parent.dataSourceSettings.mode)&&this.parent.hideWaitingPopup()},e.prototype.updateView=function(){this.parent.grid&&this.parent.chart&&this.parent.showToolbar&&("Table"===this.parent.currentView?(this.parent.grid.element.style.display="",this.parent.chart.element.style.display="none",this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector(".e-pivot-grouping-bar")&&this.parent.element.querySelector(".e-chart-grouping-bar")&&(this.parent.element.querySelector(".e-pivot-grouping-bar").style.display="",this.parent.element.querySelector(".e-chart-grouping-bar").style.display="none"),this.parent.chartSettings.enableMultiAxis&&this.parent.chartSettings.enableScrollOnMultiAxis&&(this.parent.element.querySelector(".e-pivotchart").style.display="none")):(this.parent.grid.element.style.display="none",this.parent.chart.element.style.display="",this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector(".e-pivot-grouping-bar")&&this.parent.element.querySelector(".e-chart-grouping-bar")&&(this.parent.element.querySelector(".e-pivot-grouping-bar").style.display="none",this.parent.element.querySelector(".e-chart-grouping-bar").style.display=""),this.parent.chartSettings.enableMultiAxis&&this.parent.chartSettings.enableScrollOnMultiAxis&&(this.parent.element.querySelector(".e-pivotchart").style.display="")))},e.prototype.creatMenu=function(){this.accumulationMenu&&!this.accumulationMenu.isDestroyed&&this.accumulationMenu.destroy();for(var e=(this.parent.allowDrillThrough||this.parent.editSettings.allowEditing)&&this.parent.drillThroughModule?["expand","collapse","drillThrough","exit"]:["expand","collapse","exit"],t=[],i=0;i<e.length;i++)t.push({id:this.parent.element.id+"_DrillMenuChart_"+e[i],text:this.parent.localeObj.getConstant(e[i]),items:[]});var a=this.getMenuItems(),s=[],r=[];for(i=0;i<a.length;i++)"expand"===a[i].type?s.push({id:this.element.id+"drillExpand_"+a[i].key,text:a[i].value}):r.push({id:this.element.id+"drillCollapse_"+a[i].key,text:a[i].value});s.length>0&&(t[0].items=s),r.length>0&&(t[1].items=r);var n,o={cssClass:this.parent.element.id+"_accumulationChart",items:t,enableRtl:this.parent.enableRtl,beforeOpen:this.drillMenuOpen.bind(this),select:this.drillMenuSelect.bind(this)};this.accumulationMenu=new sf.navigations.ContextMenu(o),sf.base.select("#"+this.parent.element.id+"_accumulationChart",this.parent.element)?(n=sf.base.select("#"+this.parent.element.id+"_accumulationChart",this.parent.element)).innerHTML="":(n=sf.base.createElement("ul",{id:this.parent.element.id+"_accumulationChart"}),this.parent.element.appendChild(n)),this.accumulationMenu.isStringTemplate=!0,this.accumulationMenu.appendTo(n)},e.prototype.drillMenuOpen=function(e){e.items[0]&&e.items[0].text===this.parent.localeObj.getConstant("expand")&&e.items[0].items&&0===e.items[0].items.length&&this.accumulationMenu.enableItems([this.parent.localeObj.getConstant("expand")],!1),e.items[1]&&e.items[1].text===this.parent.localeObj.getConstant("collapse")&&e.items[1].items&&0===e.items[1].items.length&&this.accumulationMenu.enableItems([this.parent.localeObj.getConstant("collapse")],!1)},e.prototype.getMenuItems=function(){for(var e=this.pivotIndex.rIndex,t=[],i=this.engineModule.pivotValues,a=[],s=i[e][this.pivotIndex.cIndex],r=!i[e][0].isNamedSet&&i[e][0].hasChild?i[e][0].level:void 0,n="olap"===this.parent.dataType?s.rowHeaders.toString().split(/~~|::/):s.rowHeaders.toString().split(this.engineModule.valueSortSettings.headerDelimiter);i[e][0];){if(s=i[e][0],0!==n.length&&n.indexOf(s.formattedText.toString())===n.length-1){s.hasChild&&!s.isNamedSet&&a.indexOf(s.level)<0&&(r?r>=s.level:0!==r||0===s.level)&&(s.isDrilled&&s.hasChild?t.push({key:e,type:"collapse",value:s.formattedText}):t.push({key:e,type:"expand",value:s.formattedText}),a.push(s.level),r=r?r-1:s.level-1);var o=n.indexOf(s.formattedText.toString());n.splice(o,1)}0===s.level&&s.hasChild&&!s.isNamedSet&&(r=void 0,a=[]),e--}return t},e.prototype.drillMenuSelect=function(e){var t="olap"===this.parent.dataType?this.parent.olapEngineModule.pivotValues:this.parent.engineModule.pivotValues,i=e.element.id.split("_DrillMenuChart_")[1];if(0===e.element.id.indexOf(this.element.id+"drill")){var a=e.element.id.split(this.element.id+"drill")[1].indexOf("Expand")>=0?"drillExpand":"drillCollapse",s=Number(e.element.id.split(this.element.id+a+"_")[1]),r=t[s][0],n="olap"===this.parent.dataType?r.formattedText:r.actualText?r.actualText.toString():r.formattedText.toString(),o=r.formattedText?r.formattedText.toString():n,l=r.hasChild&&!r.isNamedSet?(r.isDrilled?" - ":" + ")+o:o,d="olap"===this.parent.dataType?this.engineModule.tupRowInfo[r.ordinal]:void 0,p=d?d.uNameCollection:r.valueSort.levelName.toString(),h={fieldName:r.valueSort.axis,level:r.level,hasChild:r.hasChild,levelName:p,name:n,text:l,rowIndex:s,colIndex:0,isDrilled:r.isDrilled,cell:r};"olap"===this.parent.dataType?this.parent.onDrill(void 0,h):this.onDrill({customAttributes:h})}else"drillThrough"===i?this.parent.drillThroughModule.executeDrillThrough(t[this.pivotIndex.rIndex][this.pivotIndex.cIndex],this.pivotIndex.rIndex,this.pivotIndex.rIndex):"exit"===i&&this.accumulationMenu.close()},e.prototype.getChartHeight=function(){var e=sf.base.isNullOrUndefined(this.parent.getHeightAsNumber())?"auto":this.parent.getHeightAsNumber().toString();return sf.base.isNullOrUndefined(this.parent.getHeightAsNumber())?e="auto":this.parent.showToolbar&&this.parent.showGroupingBar?e=(this.parent.getHeightAsNumber()-(this.parent.element.querySelector(".e-pivot-toolbar")?this.parent.element.querySelector(".e-pivot-toolbar").clientHeight:42)-(this.parent.element.querySelector(".e-chart-grouping-bar")?this.parent.element.querySelector(".e-chart-grouping-bar").clientHeight:76)).toString():this.parent.showToolbar?e=(this.parent.getHeightAsNumber()-(this.parent.element.querySelector(".e-pivot-toolbar")?this.parent.element.querySelector(".e-pivot-toolbar").clientHeight:42)).toString():this.parent.showGroupingBar?e=(this.parent.getHeightAsNumber()-(this.parent.element.querySelector(".e-chart-grouping-bar")?this.parent.element.querySelector(".e-chart-grouping-bar").clientHeight:76)).toString():(this.parent.chart&&parseInt(this.parent.chart.height,10)<200||this.parent.getHeightAsNumber()<200)&&(e="200"),e},e.prototype.getChartAutoHeight=function(){var e=this.parent.element.offsetHeight;return this.parent.showToolbar&&this.parent.showGroupingBar?e=this.parent.element.offsetHeight-(this.parent.element.querySelector(".e-pivot-toolbar")?this.parent.element.querySelector(".e-pivot-toolbar").clientHeight:42)-(this.parent.element.querySelector(".e-chart-grouping-bar")?this.parent.element.querySelector(".e-chart-grouping-bar").clientHeight:76):this.parent.showToolbar?e=this.parent.element.offsetHeight-(this.parent.element.querySelector(".e-pivot-toolbar")?this.parent.element.querySelector(".e-pivot-toolbar").clientHeight:42):this.parent.showGroupingBar&&(e=this.parent.element.offsetHeight-(this.parent.element.querySelector(".e-chart-grouping-bar")?this.parent.element.querySelector(".e-chart-grouping-bar").clientHeight:76)),e},e.prototype.axisLabelRender=function(e){this.chartSettings.showMultiLevelLabels&&"primaryXAxis"===e.axis.name&&(e.text=""),this.parent.trigger("chartAxisLabelRender",e)},e.prototype.multiLevelLabelClick=function(e){var t={axis:e.axis,text:e.text,cell:sf.base.isNullOrUndefined(e.customAttributes)?void 0:e.customAttributes.cell,cancel:!1};this.parent.trigger("multiLevelLabelClick",t),!t.cancel&&e.customAttributes&&e.customAttributes.hasChild&&!e.customAttributes.cell.isNamedSet&&("olap"===this.parent.dataType?this.parent.onDrill(void 0,e.customAttributes):this.onDrill(e))},e.prototype.onDrill=function(e){var t=e.customAttributes,i=this.dataSourceSettings.drilledMembers[0]&&this.dataSourceSettings.drilledMembers[0].delimiter?this.dataSourceSettings.drilledMembers[0].delimiter:"**",a=t.fieldName,s=this.engineModule.pivotValues[t.rowIndex][t.colIndex],r=s.valueSort.levelName.split(this.engineModule.valueSortSettings.headerDelimiter).join(i),n=!1;if(0===this.dataSourceSettings.drilledMembers.length)this.parent.setProperties({dataSourceSettings:{drilledMembers:[{name:a,items:[r],delimiter:i}]}},!0);else{for(var o=0;o<this.dataSourceSettings.drilledMembers.length;o++){var l=this.dataSourceSettings.drilledMembers[o];if(r=r.split(i).join(l.delimiter?l.delimiter:i),i=l.delimiter=l.delimiter?l.delimiter:i,l.name===a){n=!0;var d=l.items.indexOf(r);d>-1?l.items.splice(d,1):l.items.push(r)}}n||this.dataSourceSettings.drilledMembers.push({name:a,items:[r],delimiter:i})}this.parent.showWaitingPopup();var p=this,h={fieldName:a,memberName:r,delimiter:i,axis:"row",action:t.isDrilled?"up":"down",currentCell:s},u={drillInfo:h,pivotview:sf.base.isBlazor()?void 0:p.parent};if(p.parent.trigger("drill",u),p.parent.enableVirtualization)if(sf.base.isBlazor()){var c=window.sfBlazor.copyWithoutCircularReferences([p.dataSourceSettings],p.dataSourceSettings),g=window.sfBlazor.copyWithoutCircularReferences([h],h);window.sfBlazor.copyWithoutCircularReferences([u],u);p.parent.interopAdaptor.invokeMethodAsync("PivotInteropMethod","onDrill",{dataSourceSettings:c,drilledItem:g}).then((function(e){p.parent.updateBlazorData(e,p.parent),p.parent.engineModule.drilledMembers=p.dataSourceSettings.drilledMembers,p.parent.allowServerDataBinding=!1,p.parent.setProperties({pivotValues:p.engineModule.pivotValues},!0),delete p.parent.bulkChanges.pivotValues,p.parent.allowServerDataBinding=!0,p.parent.renderPivotGrid()}))}else"Server"===p.parent.dataSourceSettings.mode?p.parent.getEngine("onDrill",h,null,null,null,null,null):(p.engineModule.drilledMembers=p.dataSourceSettings.drilledMembers,p.engineModule.onDrill(h));else"Server"===p.parent.dataSourceSettings.mode?p.parent.getEngine("onDrill",h,null,null,null,null,null):p.engineModule.generateGridData(p.dataSourceSettings);p.parent.allowServerDataBinding=!1,p.parent.setProperties({pivotValues:p.engineModule.pivotValues},!0),delete p.parent.bulkChanges.pivotValues,p.parent.allowServerDataBinding=!0,p.parent.renderPivotGrid()},e.prototype.isAttributeDrill=function(e,t){for(var i=!1,a=0;a<this.dataSourceSettings.drilledMembers.length;a++)if(this.dataSourceSettings.drilledMembers[a].name===e)for(var s=0;s<this.dataSourceSettings.drilledMembers[a].items.length;s++){for(var r=this.dataSourceSettings.drilledMembers[a].items[s].split(this.dataSourceSettings.drilledMembers[a].delimiter),n="",o=0;o<r.length;o++)t[o]&&t[o].uName&&(n=n+(""===n?"":this.dataSourceSettings.drilledMembers[a].delimiter)+(t[o].uName.indexOf("[Measures]")>-1?"[Measures]":t[o].uName));if(n===this.dataSourceSettings.drilledMembers[a].items[s]){i=!0;break}}return i},e.prototype.load=function(e){e.chart.zoomModule&&(e.chart.zoomModule.isZoomed=!0),this.parent.trigger("chartLoad",e)},e.prototype.resized=function(e){sf.base.isBlazor()&&(e.chart=this.parent.chart),this.accumulationType.indexOf(this.chartSettings.chartSeries.type)<0&&(e.chart.primaryXAxis.zoomFactor=this.getZoomFactor(),this.parent.chartSettings.zoomSettings.enableScrollbar||(e.chart.primaryXAxis.zoomFactor=1)),this.parent.trigger("chartResized",e)},e.prototype.destroy=function(){this.parent.isDestroyed||this.parent.chart&&!this.parent.chart.isDestroyed&&(this.accumulationMenu&&this.accumulationMenu.isDestroyed&&this.accumulationMenu.destroy(),this.parent.chart.destroy())},e}();(s=e.Theme||(e.Theme={})).axisLabelFont={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},s.axisTitleFont={size:"14px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},s.chartTitleFont={size:"15px",fontWeight:"500",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},s.chartSubTitleFont={size:"11px",fontWeight:"500",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},s.crosshairLabelFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},s.tooltipLabelFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},s.legendLabelFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},s.stripLineLabelFont={size:"12px",fontWeight:"Regular",color:"#353535",fontStyle:"Normal",fontFamily:"Segoe UI"},s.stockEventFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};var ce,ge,fe,me=(ce=function(e,t){return(ce=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}ce(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ve=function(e,t,i,s){var r,n=arguments.length,o=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"===("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,s);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(n<3?r(o):n>3?r(t,i,o):r(t,i))||o);return n>3&&o&&Object.defineProperty(t,i,o),o},be=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return me(t,e),ve([sf.base.Property(!0)],t.prototype,"enable",void 0),ve([sf.base.Property(1e3)],t.prototype,"duration",void 0),ve([sf.base.Property(0)],t.prototype,"delay",void 0),t}(sf.base.ChildProperty),Se=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return me(t,e),ve([sf.base.Property(null)],t.prototype,"value",void 0),ve([sf.base.Property(null)],t.prototype,"color",void 0),ve([sf.base.Property("0")],t.prototype,"dashArray",void 0),t}(sf.base.ChildProperty),ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return me(t,e),ve([sf.base.Property("Normal")],t.prototype,"fontStyle",void 0),ve([sf.base.Property("16px")],t.prototype,"size",void 0),ve([sf.base.Property("Normal")],t.prototype,"fontWeight",void 0),ve([sf.base.Property("")],t.prototype,"color",void 0),ve([sf.base.Property("Center")],t.prototype,"textAlignment",void 0),ve([sf.base.Property("Segoe UI")],t.prototype,"fontFamily",void 0),ve([sf.base.Property(1)],t.prototype,"opacity",void 0),ve([sf.base.Property("Trim")],t.prototype,"textOverflow",void 0),t}(sf.base.ChildProperty),Ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return me(t,e),ve([sf.base.Property(10)],t.prototype,"left",void 0),ve([sf.base.Property(10)],t.prototype,"right",void 0),ve([sf.base.Property(10)],t.prototype,"top",void 0),ve([sf.base.Property(10)],t.prototype,"bottom",void 0),t}(sf.base.ChildProperty),we=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return me(t,e),ve([sf.base.Property("")],t.prototype,"color",void 0),ve([sf.base.Property(1)],t.prototype,"width",void 0),t}(sf.base.ChildProperty),xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return me(t,e),ve([sf.base.Property(0)],t.prototype,"x",void 0),ve([sf.base.Property(0)],t.prototype,"y",void 0),t}(sf.base.ChildProperty),Te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return me(t,e),ve([sf.base.Property(0)],t.prototype,"series",void 0),ve([sf.base.Property(0)],t.prototype,"point",void 0),t}(sf.base.ChildProperty),Me=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return me(t,e),ve([sf.base.Complex({},we)],t.prototype,"border",void 0),ve([sf.base.Property("transparent")],t.prototype,"background",void 0),ve([sf.base.Property(1)],t.prototype,"opacity",void 0),ve([sf.base.Property(null)],t.prototype,"backgroundImage",void 0),t}(sf.base.ChildProperty),De=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return me(t,e),ve([sf.base.Property(!1)],t.prototype,"enable",void 0),ve([sf.base.Property("")],t.prototype,"dashArray",void 0),ve([sf.base.Complex({color:null,width:1},we)],t.prototype,"line",void 0),ve([sf.base.Property("Both")],t.prototype,"lineType",void 0),t}(sf.base.ChildProperty),Ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return me(t,e),ve([sf.base.Property(!1)],t.prototype,"visible",void 0),ve([sf.base.Property(null)],t.prototype,"name",void 0),ve([sf.base.Property("transparent")],t.prototype,"fill",void 0),ve([sf.base.Property(1)],t.prototype,"opacity",void 0),ve([sf.base.Property(0)],t.prototype,"angle",void 0),ve([sf.base.Property(!1)],t.prototype,"enableRotation",void 0),ve([sf.base.Property("Auto")],t.prototype,"position",void 0),ve([sf.base.Property(5)],t.prototype,"rx",void 0),ve([sf.base.Property(5)],t.prototype,"ry",void 0),ve([sf.base.Property("Center")],t.prototype,"alignment",void 0),ve([sf.base.Complex({width:null,color:null},we)],t.prototype,"border",void 0),ve([sf.base.Complex({left:5,right:5,top:5,bottom:5},Ce)],t.prototype,"margin",void 0),ve([sf.base.Complex({size:"11px",color:"",fontStyle:"Normal",fontWeight:"Normal",fontFamily:"Segoe UI"},ye)],t.prototype,"font",void 0),ve([sf.base.Property(null)],t.prototype,"template",void 0),t}(sf.base.ChildProperty),Oe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return me(t,e),ve([sf.base.Property("Line")],t.prototype,"type",void 0),ve([sf.base.Property(null)],t.prototype,"color",void 0),ve([sf.base.Property(1)],t.prototype,"width",void 0),ve([sf.base.Property(null)],t.prototype,"length",void 0),ve([sf.base.Property("")],t.prototype,"dashArray",void 0),t}(sf.base.ChildProperty),Pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return me(t,e),ve([sf.base.Property(!0)],t.prototype,"visible",void 0),ve([sf.base.Property("transparent")],t.prototype,"fill",void 0),ve([sf.base.Property(0)],t.prototype,"angle",void 0),ve([sf.base.Property(!1)],t.prototype,"enableRotation",void 0),ve([sf.base.Property("Outside")],t.prototype,"position",void 0),ve([sf.base.Property(5)],t.prototype,"rx",void 0),ve([sf.base.Property(5)],t.prototype,"ry",void 0),ve([sf.base.Property(null)],t.prototype,"template",void 0),ve([sf.base.Complex({},Oe)],t.prototype,"connectorStyle",void 0),t}(sf.base.ChildProperty),Ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return me(t,e),ve([sf.base.Property(!1)],t.prototype,"visible",void 0),ve([sf.base.Property("Circle")],t.prototype,"shape",void 0),ve([sf.base.Property("")],t.prototype,"imageUrl",void 0),ve([sf.base.Property(5)],t.prototype,"width",void 0),ve([sf.base.Property(5)],t.prototype,"height",void 0),ve([sf.base.Complex({width:2,color:null},we)],t.prototype,"border",void 0),ve([sf.base.Complex({x:0,y:0},xe)],t.prototype,"offset",void 0),ve([sf.base.Property(null)],t.prototype,"fill",void 0),ve([sf.base.Property(1)],t.prototype,"opacity",void 0),ve([sf.base.Complex({},Ee)],t.prototype,"dataLabel",void 0),t}(sf.base.ChildProperty),Fe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return me(t,e),ve([sf.base.Property(1)],t.prototype,"width",void 0),ve([sf.base.Property(10)],t.prototype,"length",void 0),ve([sf.base.Property(null)],t.prototype,"color",void 0),ve([sf.base.Property(1)],t.prototype,"opacity",void 0),t}(sf.base.ChildProperty),Ie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return me(t,e),ve([sf.base.Property(!1)],t.prototype,"visible",void 0),ve([sf.base.Property("Fixed")],t.prototype,"type",void 0),ve([sf.base.Property("Both")],t.prototype,"direction",void 0),ve([sf.base.Property("Vertical")],t.prototype,"mode",void 0),ve([sf.base.Property(1)],t.prototype,"verticalError",void 0),ve([sf.base.Property(null)],t.prototype,"color",void 0),ve([sf.base.Property(1)],t.prototype,"width",void 0),ve([sf.base.Property(1)],t.prototype,"horizontalError",void 0),ve([sf.base.Property(3)],t.prototype,"verticalNegativeError",void 0),ve([sf.base.Property(3)],t.prototype,"verticalPositiveError",void 0),ve([sf.base.Property(1)],t.prototype,"horizontalNegativeError",void 0),ve([sf.base.Property(1)],t.prototype,"horizontalPositiveError",void 0),ve([sf.base.Complex(null,Fe)],t.prototype,"errorBarCap",void 0),t}(sf.base.ChildProperty),Le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return me(t,e),ve([sf.base.Property("")],t.prototype,"name",void 0),ve([sf.base.Property("0")],t.prototype,"dashArray",void 0),ve([sf.base.Property(!0)],t.prototype,"visible",void 0),ve([sf.base.Property(2)],t.prototype,"period",void 0),ve([sf.base.Property("Linear")],t.prototype,"type",void 0),ve([sf.base.Property(0)],t.prototype,"backwardForecast",void 0),ve([sf.base.Property(0)],t.prototype,"forwardForecast",void 0),ve([sf.base.Property(2)],t.prototype,"polynomialOrder",void 0),ve([sf.base.Complex({},Ne)],t.prototype,"marker",void 0),ve([sf.base.Property(!0)],t.prototype,"enableTooltip",void 0),ve([sf.base.Complex({},be)],t.prototype,"animation",void 0),ve([sf.base.Property("")],t.prototype,"fill",void 0),ve([sf.base.Property(1)],t.prototype,"width",void 0),ve([sf.base.Property(null)],t.prototype,"intercept",void 0),ve([sf.base.Property("SeriesType")],t.prototype,"legendShape",void 0),t}(sf.base.ChildProperty),Ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return me(t,e),ve([sf.base.Property(null)],t.prototype,"fill",void 0),ve([sf.base.Complex({color:"transparent",width:0},we)],t.prototype,"border",void 0),ve([sf.base.Property("Gap")],t.prototype,"mode",void 0),t}(sf.base.ChildProperty),Re=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return me(t,e),ve([sf.base.Property(0)],t.prototype,"topLeft",void 0),ve([sf.base.Property(0)],t.prototype,"topRight",void 0),ve([sf.base.Property(0)],t.prototype,"bottomLeft",void 0),ve([sf.base.Property(0)],t.prototype,"bottomRight",void 0),t}(sf.base.ChildProperty),ke=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return me(i,t),ve([sf.base.Property(!1)],i.prototype,"enable",void 0),ve([sf.base.Property(null)],i.prototype,"fill",void 0),ve([sf.base.Complex(e.Theme.crosshairLabelFont,ye)],i.prototype,"textStyle",void 0),i}(sf.base.ChildProperty),je=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return me(i,t),ve([sf.base.Property(!0)],i.prototype,"visible",void 0),ve([sf.base.Property(!1)],i.prototype,"startFromAxis",void 0),ve([sf.base.Property(null)],i.prototype,"start",void 0),ve([sf.base.Property(null)],i.prototype,"end",void 0),ve([sf.base.Property(null)],i.prototype,"size",void 0),ve([sf.base.Property("#808080")],i.prototype,"color",void 0),ve([sf.base.Property(null)],i.prototype,"dashArray",void 0),ve([sf.base.Property("Auto")],i.prototype,"sizeType",void 0),ve([sf.base.Property(!1)],i.prototype,"isRepeat",void 0),ve([sf.base.Property(null)],i.prototype,"repeatEvery",void 0),ve([sf.base.Property(null)],i.prototype,"repeatUntil",void 0),ve([sf.base.Property(!1)],i.prototype,"isSegmented",void 0),ve([sf.base.Property(null)],i.prototype,"segmentStart",void 0),ve([sf.base.Property(null)],i.prototype,"segmentEnd",void 0),ve([sf.base.Property(null)],i.prototype,"segmentAxisName",void 0),ve([sf.base.Complex({color:"transparent",width:1},we)],i.prototype,"border",void 0),ve([sf.base.Property("")],i.prototype,"text",void 0),ve([sf.base.Property(null)],i.prototype,"rotation",void 0),ve([sf.base.Property("Middle")],i.prototype,"horizontalAlignment",void 0),ve([sf.base.Property("Middle")],i.prototype,"verticalAlignment",void 0),ve([sf.base.Complex(e.Theme.stripLineLabelFont,ye)],i.prototype,"textStyle",void 0),ve([sf.base.Property("Behind")],i.prototype,"zIndex",void 0),ve([sf.base.Property(1)],i.prototype,"opacity",void 0),i}(sf.base.ChildProperty),qe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return me(t,e),ve([sf.base.Property("")],t.prototype,"color",void 0),ve([sf.base.Property(1)],t.prototype,"width",void 0),ve([sf.base.Property("Rectangle")],t.prototype,"type",void 0),t}(sf.base.ChildProperty),Ve=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return me(t,e),ve([sf.base.Property(1)],t.prototype,"width",void 0),ve([sf.base.Property("")],t.prototype,"dashArray",void 0),ve([sf.base.Property(null)],t.prototype,"color",void 0),t}(sf.base.ChildProperty),Be=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return me(t,e),ve([sf.base.Property(.7)],t.prototype,"width",void 0),ve([sf.base.Property("")],t.prototype,"dashArray",void 0),ve([sf.base.Property(null)],t.prototype,"color",void 0),t}(sf.base.ChildProperty),_e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return me(t,e),ve([sf.base.Property(1)],t.prototype,"width",void 0),ve([sf.base.Property("")],t.prototype,"dashArray",void 0),ve([sf.base.Property(null)],t.prototype,"color",void 0),t}(sf.base.ChildProperty),He=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return me(t,e),ve([sf.base.Property(1)],t.prototype,"width",void 0),ve([sf.base.Property(5)],t.prototype,"height",void 0),ve([sf.base.Property(null)],t.prototype,"color",void 0),t}(sf.base.ChildProperty),Ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return me(t,e),ve([sf.base.Property(.7)],t.prototype,"width",void 0),ve([sf.base.Property(5)],t.prototype,"height",void 0),ve([sf.base.Property(null)],t.prototype,"color",void 0),t}(sf.base.ChildProperty),Ge=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return me(t,e),ve([sf.base.Property(0)],t.prototype,"x",void 0),ve([sf.base.Property(0)],t.prototype,"y",void 0),t}(sf.base.ChildProperty),ze=(function(){function e(){}ve([sf.base.Property("")],e.prototype,"color",void 0),ve([sf.base.Property(1)],e.prototype,"width",void 0)}(),function(){function e(){}ve([sf.base.Property(!0)],e.prototype,"enable",void 0),ve([sf.base.Property(1e3)],e.prototype,"duration",void 0),ve([sf.base.Property(0)],e.prototype,"delay",void 0)}(),function(){function e(){}ve([sf.base.Property(null)],e.prototype,"value",void 0),ve([sf.base.Property(null)],e.prototype,"color",void 0),ve([sf.base.Property("0")],e.prototype,"dashArray",void 0)}(),function(){function e(){}ve([sf.base.Property(!1)],e.prototype,"visible",void 0),ve([sf.base.Property("Circle")],e.prototype,"shape",void 0),ve([sf.base.Property("")],e.prototype,"imageUrl",void 0),ve([sf.base.Property(5)],e.prototype,"height",void 0),ve([sf.base.Property(5)],e.prototype,"width",void 0),ve([sf.base.Complex({width:2,color:null},we)],e.prototype,"border",void 0),ve([sf.base.Property(null)],e.prototype,"fill",void 0),ve([sf.base.Property(1)],e.prototype,"opacity",void 0),ve([sf.base.Complex({},Ee)],e.prototype,"dataLabel",void 0)}(),function(){function e(){}ve([sf.base.Property(!1)],e.prototype,"visible",void 0),ve([sf.base.Property("Fixed")],e.prototype,"type",void 0),ve([sf.base.Property("Both")],e.prototype,"direction",void 0),ve([sf.base.Property("Vertical")],e.prototype,"mode",void 0),ve([sf.base.Property(null)],e.prototype,"color",void 0),ve([sf.base.Property(1)],e.prototype,"verticalError",void 0),ve([sf.base.Property(1)],e.prototype,"width",void 0),ve([sf.base.Property(1)],e.prototype,"horizontalError",void 0),ve([sf.base.Property(3)],e.prototype,"verticalPositiveError",void 0),ve([sf.base.Property(3)],e.prototype,"verticalNegativeError",void 0),ve([sf.base.Property(1)],e.prototype,"horizontalPositiveError",void 0),ve([sf.base.Property(1)],e.prototype,"horizontalNegativeError",void 0),ve([sf.base.Complex(null,Fe)],e.prototype,"errorBarCap",void 0)}(),function(){function e(){}ve([sf.base.Property("")],e.prototype,"name",void 0),ve([sf.base.Property("Linear")],e.prototype,"type",void 0),ve([sf.base.Property(2)],e.prototype,"period",void 0),ve([sf.base.Property(2)],e.prototype,"polynomialOrder",void 0),ve([sf.base.Property(0)],e.prototype,"backwardForecast",void 0),ve([sf.base.Property(0)],e.prototype,"forwardForecast",void 0),ve([sf.base.Complex({},be)],e.prototype,"animation",void 0),ve([sf.base.Complex({},Ne)],e.prototype,"marker",void 0),ve([sf.base.Property(!0)],e.prototype,"enableTooltip",void 0),ve([sf.base.Property(null)],e.prototype,"intercept",void 0),ve([sf.base.Property("")],e.prototype,"fill",void 0),ve([sf.base.Property(1)],e.prototype,"width",void 0),ve([sf.base.Property("SeriesType")],e.prototype,"legendShape",void 0)}(),function(){function e(){}ve([sf.base.Property(null)],e.prototype,"fill",void 0),ve([sf.base.Complex({color:"transparent",width:0},we)],e.prototype,"border",void 0),ve([sf.base.Property("Gap")],e.prototype,"mode",void 0)}(),function(){function e(){}ve([sf.base.Property(0)],e.prototype,"topLeft",void 0),ve([sf.base.Property(0)],e.prototype,"topRight",void 0),ve([sf.base.Property(0)],e.prototype,"bottomLeft",void 0),ve([sf.base.Property(0)],e.prototype,"bottomRight",void 0)}(),function(){function e(){}ve([sf.base.Property("Normal")],e.prototype,"fontStyle",void 0),ve([sf.base.Property("16px")],e.prototype,"size",void 0),ve([sf.base.Property("Normal")],e.prototype,"fontWeight",void 0),ve([sf.base.Property("")],e.prototype,"color",void 0),ve([sf.base.Property("Center")],e.prototype,"textAlignment",void 0),ve([sf.base.Property("Segoe UI")],e.prototype,"fontFamily",void 0),ve([sf.base.Property(1)],e.prototype,"opacity",void 0),ve([sf.base.Property("Trim")],e.prototype,"textOverflow",void 0)}(),function(){function t(){}ve([sf.base.Property(!1)],t.prototype,"enable",void 0),ve([sf.base.Property(null)],t.prototype,"fill",void 0),ve([sf.base.Complex(e.Theme.crosshairLabelFont,ye)],t.prototype,"textStyle",void 0)}(),function(){function e(){}ve([sf.base.Property(1)],e.prototype,"width",void 0),ve([sf.base.Property(5)],e.prototype,"height",void 0),ve([sf.base.Property(null)],e.prototype,"color",void 0)}(),function(){function e(){}ve([sf.base.Property(1)],e.prototype,"width",void 0),ve([sf.base.Property("")],e.prototype,"dashArray",void 0),ve([sf.base.Property(null)],e.prototype,"color",void 0)}(),function(){function e(){}ve([sf.base.Property(.7)],e.prototype,"width",void 0),ve([sf.base.Property(5)],e.prototype,"height",void 0),ve([sf.base.Property(null)],e.prototype,"color",void 0)}(),function(){function e(){}ve([sf.base.Property(.7)],e.prototype,"width",void 0),ve([sf.base.Property("")],e.prototype,"dashArray",void 0),ve([sf.base.Property(null)],e.prototype,"color",void 0)}(),function(){function e(){}ve([sf.base.Property(1)],e.prototype,"width",void 0),ve([sf.base.Property("")],e.prototype,"dashArray",void 0),ve([sf.base.Property(null)],e.prototype,"color",void 0)}(),function(){function t(){}ve([sf.base.Property(!0)],t.prototype,"visible",void 0),ve([sf.base.Property(!1)],t.prototype,"startFromAxis",void 0),ve([sf.base.Property(null)],t.prototype,"start",void 0),ve([sf.base.Property(null)],t.prototype,"end",void 0),ve([sf.base.Property(null)],t.prototype,"size",void 0),ve([sf.base.Property("#808080")],t.prototype,"color",void 0),ve([sf.base.Property(null)],t.prototype,"dashArray",void 0),ve([sf.base.Property("Auto")],t.prototype,"sizeType",void 0),ve([sf.base.Property(!1)],t.prototype,"isRepeat",void 0),ve([sf.base.Property(null)],t.prototype,"repeatEvery",void 0),ve([sf.base.Property(null)],t.prototype,"repeatUntil",void 0),ve([sf.base.Property(!1)],t.prototype,"isSegmented",void 0),ve([sf.base.Property(null)],t.prototype,"segmentStart",void 0),ve([sf.base.Property(null)],t.prototype,"segmentEnd",void 0),ve([sf.base.Property(null)],t.prototype,"segmentAxisName",void 0),ve([sf.base.Complex({color:"transparent",width:1},we)],t.prototype,"border",void 0),ve([sf.base.Property("")],t.prototype,"text",void 0),ve([sf.base.Property(null)],t.prototype,"rotation",void 0),ve([sf.base.Property("Middle")],t.prototype,"horizontalAlignment",void 0),ve([sf.base.Property("Middle")],t.prototype,"verticalAlignment",void 0),ve([sf.base.Complex(e.Theme.stripLineLabelFont,ye)],t.prototype,"textStyle",void 0),ve([sf.base.Property("Behind")],t.prototype,"zIndex",void 0),ve([sf.base.Property(1)],t.prototype,"opacity",void 0)}(),function(){function e(){}ve([sf.base.Property("")],e.prototype,"color",void 0),ve([sf.base.Property(1)],e.prototype,"width",void 0),ve([sf.base.Property("Rectangle")],e.prototype,"type",void 0)}(),function(){function e(){}ve([sf.base.Complex({},we)],e.prototype,"border",void 0),ve([sf.base.Property("transparent")],e.prototype,"background",void 0),ve([sf.base.Property(1)],e.prototype,"opacity",void 0)}(),function(){function e(){}ve([sf.base.Property(!1)],e.prototype,"enable",void 0),ve([sf.base.Property("")],e.prototype,"dashArray",void 0),ve([sf.base.Complex({color:null,width:1},we)],e.prototype,"line",void 0),ve([sf.base.Property("Both")],e.prototype,"lineType",void 0)}(),function(){function t(){}ve([sf.base.Property(!0)],t.prototype,"visible",void 0),ve([sf.base.Property(null)],t.prototype,"height",void 0),ve([sf.base.Property(null)],t.prototype,"width",void 0),ve([sf.base.Complex({x:0,y:0},Ge)],t.prototype,"location",void 0),ve([sf.base.Property("Auto")],t.prototype,"position",void 0),ve([sf.base.Property(8)],t.prototype,"padding",void 0),ve([sf.base.Property("Center")],t.prototype,"alignment",void 0),ve([sf.base.Complex(e.Theme.legendLabelFont,ye)],t.prototype,"textStyle",void 0),ve([sf.base.Property(10)],t.prototype,"shapeHeight",void 0),ve([sf.base.Property(10)],t.prototype,"shapeWidth",void 0),ve([sf.base.Complex({},we)],t.prototype,"border",void 0),ve([sf.base.Complex({left:0,right:0,top:0,bottom:0},Ce)],t.prototype,"margin",void 0),ve([sf.base.Property(5)],t.prototype,"shapePadding",void 0),ve([sf.base.Property("transparent")],t.prototype,"background",void 0),ve([sf.base.Property(1)],t.prototype,"opacity",void 0),ve([sf.base.Property(!0)],t.prototype,"toggleVisibility",void 0),ve([sf.base.Property(null)],t.prototype,"description",void 0),ve([sf.base.Property(3)],t.prototype,"tabIndex",void 0)}(),function(){function e(){}ve([sf.base.Property(0)],e.prototype,"series",void 0),ve([sf.base.Property(0)],e.prototype,"point",void 0)}(),function(){function e(){}ve([sf.base.Property(10)],e.prototype,"left",void 0),ve([sf.base.Property(10)],e.prototype,"right",void 0),ve([sf.base.Property(10)],e.prototype,"top",void 0),ve([sf.base.Property(10)],e.prototype,"bottom",void 0)}(),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return me(t,e),ve([sf.base.Property(null)],t.prototype,"fill",void 0),ve([sf.base.Property(null)],t.prototype,"endAngle",void 0),ve([sf.base.Property(!1)],t.prototype,"explode",void 0),ve([sf.base.Property(!1)],t.prototype,"explodeAll",void 0),ve([sf.base.Property(null)],t.prototype,"explodeIndex",void 0),ve([sf.base.Property(null)],t.prototype,"innerRadius",void 0),ve([sf.base.Property("30%")],t.prototype,"explodeOffset",void 0),ve([sf.base.Property(0)],t.prototype,"gapRatio",void 0),ve([sf.base.Property("Value")],t.prototype,"groupMode",void 0),ve([sf.base.Property(null)],t.prototype,"groupTo",void 0),ve([sf.base.Property("20%")],t.prototype,"neckHeight",void 0),ve([sf.base.Property("20%")],t.prototype,"neckWidth",void 0),ve([sf.base.Property("Linear")],t.prototype,"pyramidMode",void 0),ve([sf.base.Property([])],t.prototype,"palettes",void 0),ve([sf.base.Property(0)],t.prototype,"startAngle",void 0),ve([sf.base.Complex(null,be)],t.prototype,"animation",void 0),ve([sf.base.Complex(null,Pe)],t.prototype,"dataLabel",void 0),ve([sf.base.Property("0")],t.prototype,"dashArray",void 0),ve([sf.base.Property(1)],t.prototype,"width",void 0),ve([sf.base.Property("X")],t.prototype,"segmentAxis",void 0),ve([sf.base.Property("Line")],t.prototype,"drawType",void 0),ve([sf.base.Property(!0)],t.prototype,"isClosed",void 0),ve([sf.base.Collection([],Se)],t.prototype,"segments",void 0),ve([sf.base.Property("")],t.prototype,"stackingGroup",void 0),ve([sf.base.Complex({color:"transparent",width:0},we)],t.prototype,"border",void 0),ve([sf.base.Property(!0)],t.prototype,"visible",void 0),ve([sf.base.Property(1)],t.prototype,"opacity",void 0),ve([sf.base.Property("Line")],t.prototype,"type",void 0),ve([sf.base.Complex(null,Ne)],t.prototype,"marker",void 0),ve([sf.base.Complex(null,Ie)],t.prototype,"errorBar",void 0),ve([sf.base.Property(!0)],t.prototype,"enableTooltip",void 0),ve([sf.base.Collection([],Le)],t.prototype,"trendlines",void 0),ve([sf.base.Property("")],t.prototype,"tooltipMappingName",void 0),ve([sf.base.Property("SeriesType")],t.prototype,"legendShape",void 0),ve([sf.base.Property(1)],t.prototype,"minRadius",void 0),ve([sf.base.Property(null)],t.prototype,"selectionStyle",void 0),ve([sf.base.Property("Natural")],t.prototype,"splineType",void 0),ve([sf.base.Property(3)],t.prototype,"maxRadius",void 0),ve([sf.base.Property(.5)],t.prototype,"cardinalSplineTension",void 0),ve([sf.base.Property(null)],t.prototype,"columnWidth",void 0),ve([sf.base.Complex(null,Ae)],t.prototype,"emptyPointSettings",void 0),ve([sf.base.Complex(null,Re)],t.prototype,"cornerRadius",void 0),ve([sf.base.Property(0)],t.prototype,"columnSpacing",void 0),t}(sf.base.ChildProperty)),We=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return me(i,t),ve([sf.base.Property("Rotate45")],i.prototype,"labelIntersectAction",void 0),ve([sf.base.Complex(e.Theme.axisLabelFont,ye)],i.prototype,"labelStyle",void 0),ve([sf.base.Property("")],i.prototype,"title",void 0),ve([sf.base.Complex({},ke)],i.prototype,"crosshairTooltip",void 0),ve([sf.base.Property("")],i.prototype,"labelFormat",void 0),ve([sf.base.Complex(e.Theme.axisTitleFont,ye)],i.prototype,"titleStyle",void 0),ve([sf.base.Property(!1)],i.prototype,"isIndexed",void 0),ve([sf.base.Property(0)],i.prototype,"plotOffset",void 0),ve([sf.base.Property("None")],i.prototype,"edgeLabelPlacement",void 0),ve([sf.base.Property("BetweenTicks")],i.prototype,"labelPlacement",void 0),ve([sf.base.Property("Outside")],i.prototype,"tickPosition",void 0),ve([sf.base.Property(!1)],i.prototype,"opposedPosition",void 0),ve([sf.base.Property(!0)],i.prototype,"visible",void 0),ve([sf.base.Property("Outside")],i.prototype,"labelPosition",void 0),ve([sf.base.Property(0)],i.prototype,"labelRotation",void 0),ve([sf.base.Property(0)],i.prototype,"minorTicksPerInterval",void 0),ve([sf.base.Property(null)],i.prototype,"maximum",void 0),ve([sf.base.Property(null)],i.prototype,"minimum",void 0),ve([sf.base.Property(34)],i.prototype,"maximumLabelWidth",void 0),ve([sf.base.Property(null)],i.prototype,"interval",void 0),ve([sf.base.Complex({},He)],i.prototype,"majorTickLines",void 0),ve([sf.base.Property(!1)],i.prototype,"enableTrim",void 0),ve([sf.base.Complex({},Ve)],i.prototype,"majorGridLines",void 0),ve([sf.base.Complex({},Ue)],i.prototype,"minorTickLines",void 0),ve([sf.base.Complex({},_e)],i.prototype,"lineStyle",void 0),ve([sf.base.Complex({},Be)],i.prototype,"minorGridLines",void 0),ve([sf.base.Property(!1)],i.prototype,"isInversed",void 0),ve([sf.base.Property(null)],i.prototype,"description",void 0),ve([sf.base.Property(0)],i.prototype,"startAngle",void 0),ve([sf.base.Property(100)],i.prototype,"coefficient",void 0),ve([sf.base.Collection([],je)],i.prototype,"stripLines",void 0),ve([sf.base.Property(2)],i.prototype,"tabIndex",void 0),ve([sf.base.Complex({color:null,width:0,type:"Rectangle"},qe)],i.prototype,"border",void 0),i}(sf.base.ChildProperty),Qe=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return me(i,t),ve([sf.base.Property(!1)],i.prototype,"enableMarker",void 0),ve([sf.base.Property(!0)],i.prototype,"enable",void 0),ve([sf.base.Property(null)],i.prototype,"fill",void 0),ve([sf.base.Property(!1)],i.prototype,"shared",void 0),ve([sf.base.Property(.75)],i.prototype,"opacity",void 0),ve([sf.base.Property(null)],i.prototype,"header",void 0),ve([sf.base.Property(null)],i.prototype,"format",void 0),ve([sf.base.Complex(e.Theme.tooltipLabelFont,ye)],i.prototype,"textStyle",void 0),ve([sf.base.Property(null)],i.prototype,"template",void 0),ve([sf.base.Complex({color:"#cccccc",width:.5},we)],i.prototype,"border",void 0),ve([sf.base.Property(!0)],i.prototype,"enableAnimation",void 0),i}(sf.base.ChildProperty),Ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return me(t,e),ve([sf.base.Property("50%")],t.prototype,"x",void 0),ve([sf.base.Property("50%")],t.prototype,"y",void 0),t}(sf.base.ChildProperty),Ke=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return me(t,e),ve([sf.base.Property(!1)],t.prototype,"enablePinchZooming",void 0),ve([sf.base.Property(!0)],t.prototype,"enableSelectionZooming",void 0),ve([sf.base.Property(!1)],t.prototype,"enableDeferredZooming",void 0),ve([sf.base.Property(!1)],t.prototype,"enableMouseWheelZooming",void 0),ve([sf.base.Property("XY")],t.prototype,"mode",void 0),ve([sf.base.Property(["Zoom","ZoomIn","ZoomOut","Pan","Reset"])],t.prototype,"toolbarItems",void 0),ve([sf.base.Property(!0)],t.prototype,"enableScrollbar",void 0),ve([sf.base.Property(!1)],t.prototype,"enablePan",void 0),t}(sf.base.ChildProperty),Je=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return me(i,t),ve([sf.base.Complex({},ze)],i.prototype,"chartSeries",void 0),ve([sf.base.Complex({},We)],i.prototype,"primaryXAxis",void 0),ve([sf.base.Complex({},We)],i.prototype,"primaryYAxis",void 0),ve([sf.base.Property("")],i.prototype,"value",void 0),ve([sf.base.Property("")],i.prototype,"columnHeader",void 0),ve([sf.base.Property("-")],i.prototype,"columnDelimiter",void 0),ve([sf.base.Property(!1)],i.prototype,"enableMultiAxis",void 0),ve([sf.base.Property(!1)],i.prototype,"enableScrollOnMultiAxis",void 0),ve([sf.base.Complex(e.Theme.chartTitleFont,ye)],i.prototype,"titleStyle",void 0),ve([sf.base.Property("")],i.prototype,"title",void 0),ve([sf.base.Complex(e.Theme.chartSubTitleFont,ye)],i.prototype,"subTitleStyle",void 0),ve([sf.base.Property("")],i.prototype,"subTitle",void 0),ve([sf.base.Complex({color:"#DDDDDD",width:0},we)],i.prototype,"border",void 0),ve([sf.base.Complex({},Ce)],i.prototype,"margin",void 0),ve([sf.base.Complex({border:{color:null,width:.5},background:"transparent"},Me)],i.prototype,"chartArea",void 0),ve([sf.base.Property(null)],i.prototype,"background",void 0),ve([sf.base.Property("Material")],i.prototype,"theme",void 0),ve([sf.base.Property([])],i.prototype,"palettes",void 0),ve([sf.base.Complex({},De)],i.prototype,"crosshair",void 0),ve([sf.base.Complex({},Qe)],i.prototype,"tooltip",void 0),ve([sf.base.Complex(null,Ye)],i.prototype,"pieCenter",void 0),ve([sf.base.Complex({},Ke)],i.prototype,"zoomSettings",void 0),ve([sf.base.Property()],i.prototype,"legendSettings",void 0),ve([sf.base.Property("None")],i.prototype,"selectionMode",void 0),ve([sf.base.Property("None")],i.prototype,"accumulationSelectionMode",void 0),ve([sf.base.Property(!0)],i.prototype,"enableSmartLabels",void 0),ve([sf.base.Property(!0)],i.prototype,"enableBorderOnMouseMove",void 0),ve([sf.base.Property("None")],i.prototype,"highlightMode",void 0),ve([sf.base.Property("None")],i.prototype,"highlightPattern",void 0),ve([sf.base.Property(!0)],i.prototype,"enableExport",void 0),ve([sf.base.Property(!1)],i.prototype,"isMultiSelect",void 0),ve([sf.base.Collection([],Te)],i.prototype,"selectedDataIndexes",void 0),ve([sf.base.Property(!0)],i.prototype,"enableAnimation",void 0),ve([sf.base.Property(!0)],i.prototype,"useGroupingSeparator",void 0),ve([sf.base.Property(!1)],i.prototype,"isTransposed",void 0),ve([sf.base.Property(1)],i.prototype,"tabIndex",void 0),ve([sf.base.Property(null)],i.prototype,"description",void 0),ve([sf.base.Event()],i.prototype,"resized",void 0),ve([sf.base.Property(!0)],i.prototype,"enableSideBySidePlacement",void 0),ve([sf.base.Event()],i.prototype,"loaded",void 0),ve([sf.base.Event()],i.prototype,"beforePrint",void 0),ve([sf.base.Event()],i.prototype,"animationComplete",void 0),ve([sf.base.Event()],i.prototype,"load",void 0),ve([sf.base.Event()],i.prototype,"textRender",void 0),ve([sf.base.Event()],i.prototype,"legendRender",void 0),ve([sf.base.Event()],i.prototype,"seriesRender",void 0),ve([sf.base.Event()],i.prototype,"pointRender",void 0),ve([sf.base.Event()],i.prototype,"tooltipRender",void 0),ve([sf.base.Event()],i.prototype,"axisLabelRender",void 0),ve([sf.base.Event()],i.prototype,"multiLevelLabelClick",void 0),ve([sf.base.Event()],i.prototype,"chartMouseClick",void 0),ve([sf.base.Event()],i.prototype,"chartMouseMove",void 0),ve([sf.base.Event()],i.prototype,"pointMove",void 0),ve([sf.base.Event()],i.prototype,"pointClick",void 0),ve([sf.base.Event()],i.prototype,"chartMouseDown",void 0),ve([sf.base.Event()],i.prototype,"chartMouseLeave",void 0),ve([sf.base.Event()],i.prototype,"dragComplete",void 0),ve([sf.base.Event()],i.prototype,"chartMouseUp",void 0),ve([sf.base.Event()],i.prototype,"scrollStart",void 0),ve([sf.base.Event()],i.prototype,"zoomComplete",void 0),ve([sf.base.Event()],i.prototype,"scrollChanged",void 0),ve([sf.base.Event()],i.prototype,"scrollEnd",void 0),ve([sf.base.Property(!0)],i.prototype,"showMultiLevelLabels",void 0),i}(sf.base.ChildProperty),Xe=function(){function e(){}return e.getCellSets=function(e,t,i,a,s){this.engine=t,this.isMondrian=t.isMondrian,this.isMeasureAvail=t.isMeasureAvail,this.isPaging=t.isPaging,this.pageSettings=t.pageSettings,this.rows=t.rows,this.columns=t.columns,this.values=t.values,this.filters=t.filters,this.allowLabelFilter=t.allowLabelFilter,this.allowValueFilter=t.allowValueFilter,this.valueSortSettings=e.valueSortSettings?e.valueSortSettings:void 0,this.drilledMembers=t.updateDrilledItems(e.drilledMembers),this.calculatedFieldSettings=t.calculatedFieldSettings,this.valueAxis="row"===e.valueAxis?"rows":"columns",a&&(a.axis="row"===a.axis?"rows":"columns"),this.filterMembers=sf.base.extend({},t.filterMembers,null,!0),this.fieldDataObj=t.fieldListObj,this.fieldList=t.fieldList,this.cellSetInfo="\nDIMENSION PROPERTIES PARENT_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, CHILDREN_CARDINALITY, MEMBER_TYPE, MEMBER_VALUE";var r=this.getMeasuresQuery(this.values),n=this.getDimensionsQuery(this.rows,r,"rows",a).replace(/\&/g,"&amp;"),o=this.getDimensionsQuery(this.columns,r,"columns",a).replace(/\&/g,"&amp;");if(this.isPaging&&i&&void 0!==this.pageSettings)n=(l=this.getPagingQuery(n,o)).rowQuery,o=l.columnQuery;else if(this.isPaging&&!i&&void 0!==this.pageSettings){var l;n=(l=this.getPagingCountQuery(n,o)).rowQuery,o=l.columnQuery}n=n.length>0?n+(this.isPaging&&!i?"":this.cellSetInfo+" ON ROWS"):"",o=o.length>0?o+(this.isPaging&&!i?"":this.cellSetInfo+" ON COLUMNS"):"";var d=this.getSlicersQuery(this.filters,"filters").replace(/\&/g,"&amp;"),p=this.getfilterQuery(this.filterMembers,e.cube).replace(/\&/g,"&amp;").replace(/\>/g,"&gt;").replace(/\</g,"&lt;"),h=this.getCalculatedFieldQuery(this.calculatedFieldSettings).replace(/\&/g,"&amp;"),u=this.frameMDXQuery(n,o,d,p,h,i),c={catalog:e.catalog,cube:e.cube,url:e.url,request:u,LCID:e.localeIdentifier.toString()};t.mdxQuery=u.replace(/\&amp;/g,"&").replace(/\&gt;/g,">").replace(/\&lt;/g,"<").replace(/%280/g,'"'),a&&(a.axis="rows"===a.axis?"row":"column"),s||this.getTableCellData(c,this.isPaging&&!i?this.engine.generatePagingData.bind(this.engine):this.engine.generateEngine.bind(this.engine),a?{action:a.action,drillInfo:a}:{dataSourceSettings:e,action:"loadTableElements"})},e.getTableCellData=function(e,t,i){var a=this.engine.getConnectionInfo(e.url,e.LCID),s='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"> <Header></Header> <Body> <Execute xmlns="urn:schemas-microsoft-com:xml-analysis"> <Command> <Statement>'+e.request+"</Statement> </Command> <Properties> <PropertyList> <Catalog>"+e.catalog+"</Catalog> <LocaleIdentifier>"+a.LCID+"</LocaleIdentifier> </PropertyList> </Properties></Execute> </Body> </Envelope>";this.engine.doAjaxPost("POST",a.url,s,t,i)},e.frameMDXQuery=function(e,t,i,a,s,r){var n=this.isPaging&&!r?""!==s?"":"\nWITH":"\nSelect ";return t.length>0&&(n+=t),e.length>0&&(n=n+(t.length>0?this.isPaging&&!r?"":", ":"")+e),n=s+n+(this.isPaging&&!r?"\nMEMBER [Measures].[3d268ce0-664d-4092-b9cb-fece97175006] AS Count([e16a30d0-2174-4874-8dae-a5085a75a3e2]) MEMBER [Measures].[8d7fe8c1-f09f-410e-b9ba-eaab75a1fc3e] AS Count ([d1876d2b-e50e-4547-85fe-5b8ed9d629de])\nSELECT { [Measures].[3d268ce0-664d-4092-b9cb-fece97175006] , [Measures].[8d7fe8c1-f09f-410e-b9ba-eaab75a1fc3e] } ON AXIS(0)":"")+a+i+"\nCELL PROPERTIES VALUE, FORMAT_STRING, FORMATTED_VALUE\n"},e.getPagingQuery=function(e,t){e=e.replace("NON EMPTY ( ","").slice(0,-1),t=t.replace("NON EMPTY ( ","").slice(0,-1);var i=e,a=(this.pageSettings.rowCurrentPage-1)*this.pageSettings.rowSize,s=(this.pageSettings.columnCurrentPage-1)*this.pageSettings.columnSize,r=3*this.pageSettings.rowSize,n=3*this.pageSettings.columnSize;return a=this.engine.rowCount<a+r?this.engine.rowCount>r?this.engine.rowCount-r:0:a,this.engine.pageRowStartPos=a,s=this.engine.columnCount<s+n?this.engine.columnCount>n?this.engine.columnCount-n:0:s,this.engine.pageColStartPos=s,{rowQuery:""!==e?"\nSUBSET ({ "+(this.isMondrian?"":"NONEMPTY")+" ("+e+(this.isMondrian||""===t?"":","+t)+")},"+a+","+r+")":"",columnQuery:""!==t?"\nSUBSET ({ "+(this.isMondrian?"":"NONEMPTY")+" ("+t+(this.isMondrian||""===i?"":","+i)+")},"+s+","+n+")":""}},e.getPagingCountQuery=function(e,t){e=e.replace("NON EMPTY ( ","").slice(0,-1),t=t.replace("NON EMPTY ( ","").slice(0,-1);var i=e;return{rowQuery:""!==e?"SET [d1876d2b-e50e-4547-85fe-5b8ed9d629de] as "+(this.isMondrian?"":"NONEMPTY")+" ("+e+(this.isMondrian||""===t?"":","+t)+")\n":"",columnQuery:""!==t?"\nSET [e16a30d0-2174-4874-8dae-a5085a75a3e2] as "+(this.isMondrian?"":"NONEMPTY")+" ("+t+(this.isMondrian||""===i?"":","+i)+")\n":""}},e.getDimensionsQuery=function(e,t,i,a){var s="";if(e.length>0){s="\nNON EMPTY ( "+(this.drilledMembers.length>0?"HIERARCHIZE ({":"");for(var r=0;r<e.length;){0===r?"[measures]"===e[r].name.toLowerCase()?""!==t&&(s+=t):s+="({"+this.getDimensionQuery(e[r],i)+"})":"[measures]"===e[r].name.toLowerCase()?""!==t&&(s=s+" * "+t):s=s+" * "+("({"+this.getDimensionQuery(e[r],i)+"})"),r++}var n=this.getDrillQuery(e,t,i,a);s=a&&a.axis===i?"\nNON EMPTY ( "+(this.drilledMembers.length>0?"HIERARCHIZE ({":"")+n.query:s+(""!==n.query?",":"")+n.query;var o=this.getAttributeDrillQuery(e,t,i,a);s=(this.valueAxis!==i?this.updateValueSortQuery(s,this.valueSortSettings):s)+(this.isPaging?(""!==o?"-":"")+o:"")+(this.drilledMembers.length>0?"})":"")+(this.isPaging?"":(""!==o?"-":"")+o)+")"}return s},e.getAttributeDrillQuery=function(e,t,i,a){var s="",r=[];r=a&&a.axis===i&&"down"===a.action.toLowerCase()?[{name:a.fieldName,items:[a.memberName],delimiter:"~~"}]:this.drilledMembers;for(var n=i===this.valueAxis?this.getMeasurePos(i):0,o=0,l=r;o<l.length;o++){var d=l[o];if(!!this.engine.fieldList[d.name]&&this.engine.fieldList[d.name].isHierarchy)for(var p=0,h=d.items;p<h.length;p++){for(var u=h[p],c=[],g=u.split(d.delimiter?d.delimiter:"~~"),f=this.getDrillLevel(e,g),m=this.getDimensionPos(i,d.name),v=e.length-(n>m?1:0),b=!!this.isPaging&&this.isAttributeMemberExist(d.name,u.split(d.delimiter?d.delimiter:"~~"),d.delimiter,g,i);f.level>0&&f.isDrill&&m+1!==n&&!b;){for(var S=[],y=0;y<e.length;){if("[measures]"===e[y].name.toLowerCase())""!==t&&S.push("({{"+g[y]+"}})");else if(g[y]&&(-1!==g[y].indexOf(e[y].name)||e[y].isNamedSet&&this.fieldList[e[y].name]&&-1!==g[y].indexOf(this.fieldList[e[y].name].pid.split("Sets_")[1])))S.push(this.getHierarchyQuery(g[y],!1,!1,!1,f.level,!0));else{if(g[y]||!e[y]){S=[];break}S.push(this.getHierarchyQuery(e[y].name,!!(this.isPaging&&2===f.level||!this.isPaging&&v>y),e[y].isNamedSet,e[y].isCalculatedField,f.level,!1))}y++}S.length>0&&c.push("("+S.join("*")+")"),f.level--,v--}c.length>0&&(s=s+(""!==s?"-":"")+c.join(this.isPaging?"+":"-"))}}return s},e.getDimensionPos=function(e,t){for(var i=0,a="rows"===e?this.rows:this.columns,s=0;s<a.length;s++)if(a[s].name===t){i=s;break}return i},e.getMeasurePos=function(e){for(var t=0,i="rows"===e?this.rows:this.columns,a=0;a<i.length;a++)if(0===i[a].name.indexOf("[Measures]")){t=a;break}return t},e.getDrillLevel=function(e,t){for(var i=e.length,a=!1,s=0;s<e.length;)t[s]&&-1!==t[s].indexOf(e[s].name)?(i-=1,e[s+1]&&!(e[s+1].isNamedSet||0===e[s+1].name.indexOf("[Measures]")||this.fieldList[e[s+1].name]&&!this.fieldList[e[s+1].name].hasAllMember)&&(a=!0)):(e[s].isNamedSet||0===e[s].name.indexOf("[Measures]")||this.fieldList[e[s].name]&&!this.fieldList[e[s].name].hasAllMember)&&(i-=1),s++;return{level:this.isPaging?2:i,isDrill:a}},e.getHierarchyQuery=function(e,t,i,a,s,r){return e=a?this.fieldList[e].tag:e,!this.fieldList[e]||this.fieldList[e].hasAllMember||i||a?i||a?"({"+e+"})":this.isPaging?"({"+e+(t?".CHILDREN})":r||1!==s?"})":".[All]})"):"({DrilldownLevel({"+e+(t?".CHILDREN":"")+"},,,INCLUDE_CALC_MEMBERS)})":"(("+e+").levels(0).AllMembers)"},e.isAttributeMemberExist=function(e,t,i,a,s){t.splice(a.length-1,1);var r=!1;if(""!==t.join(i)&&(!this.isPaging||1!==t.length||"[Measures]"!==t.join(i))&&this.engine.fieldList[e]&&this.engine.fieldList[e].hasAllMember)for(var n=this.getDimensionPos(s,e),o=0;o<this.drilledMembers.length;o++){if(e!==this.drilledMembers[o].name)if(!!this.engine.fieldList[this.drilledMembers[o].name]&&this.engine.fieldList[this.drilledMembers[o].name].isHierarchy)for(var l=this.getDimensionPos(s,this.drilledMembers[o].name),d=0;d<this.drilledMembers[o].items.length;d++){var p=this.getDrillLevel("rows"===s?this.rows:this.columns,this.drilledMembers[o].items[d].split(this.drilledMembers[o].delimiter?this.drilledMembers[o].delimiter:"~~"));if((!this.isPaging||l<n&&p.isDrill)&&(0===this.drilledMembers[o].items[d].indexOf(t.join(i))||0===t.join(i).indexOf(this.drilledMembers[o].items[d]))){r=!0;break}}}return r},e.getDrillQuery=function(e,t,i,a){var s="",r=[],n=[],o=!1,l="";a&&a.axis===i&&"down"===a.action.toLowerCase()?(o=!0,n=[{name:a.fieldName,items:[a.memberName],delimiter:"~~"}]):n=this.drilledMembers;for(var d=0,p=n;d<p.length;d++){var h=p[d];if(!(!!this.engine.fieldList[h.name]&&this.engine.fieldList[h.name].isHierarchy))for(var u=0,c=h.items;u<c.length;u++){for(var g=c[u],f=[],m=[],v=0,b=g.split(h.delimiter?h.delimiter:"~~"),S=this.isAttributeMemberExist(h.name,g.split(h.delimiter?h.delimiter:"~~"),h.delimiter?h.delimiter:"~~",b,i);v<e.length&&!S;){if(b[v]&&-1!==b[v].indexOf(e[v].name))-1!==b[b.length-1].indexOf(e[v].name)?o?l=l+(""!==l?" * ":"")+"({"+b[v]+".CHILDREN})":(f.push("("+b[v]+".CHILDREN)"),m.push("("+b[v]+")")):"[measures]"===b[v].toLowerCase()&&""!==t?o?l=l+(""!==l?" * ":"")+"("+t+")":(f.push("("+t+")"),m.push("("+t+")")):-1!==b[v].toLowerCase().indexOf("[measures]")?o?l=l+(""!==l?" * ":"")+"({"+b[v]+"})":(f.push("({"+b[v]+"})"),m.push("({"+b[v]+"})")):o?l=l+(""!==l?" * ":"")+"({"+b[v]+"})":(f.push("("+b[v]+")"),m.push("("+b[v]+")"));else{if(b[v]||!e[v]){f=[];break}"[measures]"===e[v].name.toLowerCase()&&""!==t?o?l=l+(""!==l?" * ":"")+"("+t+")":(f.push("("+t+")"),m.push("("+t+")")):o?l=l+(""!==l?" * ":"")+"({"+this.getDimensionQuery(e[v],i)+"})":(f.push("("+this.getDimensionQuery(e[v],i)+")"),m.push("("+this.getDimensionQuery(e[v],i)+")"))}v++}f.length>0&&f.length<b.length&&(f=[],m=[]),s=s+(""!==s&&f.length>0?",":"")+(f.length>0?"("+f.toString()+")":""),m.length>0&&r.push("("+m.toString()+")")}}return{query:o?l:s,collection:o?[l]:r}},e.updateValueSortQuery=function(e,t){if(t&&t.measure&&""!==t.measure){var i=this.drilledMembers.length>0?"HIERARCHIZE ({":"",a=this.fieldList[t.measure].isCalculatedField?this.fieldList[t.measure].tag:t.measure;switch(t.sortOrder){case"Ascending":e=(e=e.replace("NON EMPTY ( "+i,"NON EMPTY ( "+i+" ORDER ({"))+"},("+a+"), ASC)";break;case"Descending":e=(e=e.replace("NON EMPTY ( "+i,"NON EMPTY ( "+i+" ORDER ({"))+"},("+a+"), DESC)"}}return e},e.getSlicersQuery=function(e,t){var i=this,a="",s=sf.base.extend([],this.rows,null,!0);if(s=s.concat(this.columns),e.length>0){for(var r=0;r<e.length;){s.filter((function(t){var a=i.getDimensionUniqueName(t.name),s=i.getDimensionUniqueName(e[r].name);return a===s&&!(i.isMondrian&&""===s&&""===a)})).length>0||(void 0===e[r].name||this.filterMembers[e[r].name]?this.filterMembers[e[r].name]&&(a=a+(""!==a?" * ":"")+"{"+this.filterMembers[e[r].name].toString()+"}"):a=a+(""!==a?" * ":"")+"{"+this.getDimensionQuery(e[r],t)+"}"),r++}a=""===a?"":"\nWHERE ("+a.replace(/DrilldownLevel/g,"")+")"}return a},e.getDimensionQuery=function(e,t){var i=e.isCalculatedField?this.fieldList[e.name].tag:e.name;return this.fieldList[e.name].hasAllMember||e.isNamedSet||e.isCalculatedField?e.isNamedSet?"{"+i+"}":this.isPaging?i+".CHILDREN":"DrilldownLevel({"+i+"}"+("rows"===t||"columns"===t?",,,INCLUDE_CALC_MEMBERS":"")+")":"(("+i+").levels(0).AllMembers)"},e.getDimensionUniqueName=function(e){var t=this.fieldDataObj.hierarchy,i=[];if(t){for(var a=0,s=t;a<s.length;a++){var r=s[a];r.id.toLowerCase()===e.toLowerCase()&&i.push(r)}return i.length>0?i[0].pid:""}return e.split(".")[0]},e.getMeasuresQuery=function(e){var t="";if(e.length>0){t="{{";for(var i="",a=0,s=e;a<s.length;a++){var r=s[a],n=r.isCalculatedField?this.fieldList[r.name].tag:r.name;i=i.length>0?i+", "+n:n}t=t+i+"}}"}return t},e.getfilterQuery=function(e,t){for(var i="\nFROM ["+t+"]",a="\nFROM( SELECT (",s=[],r=[],n=[],o=[],l=0,d=this.rows;l<d.length;l++){e[(f=d[l]).name]&&e[f.name].length>0&&("string"==typeof e[f.name][0]?n.push(e[f.name]):(e[f.name][1]=e[f.name][0].type,s.push(e[f.name]),delete e[f.name]))}for(var p=0,h=this.columns;p<h.length;p++){if(e[(f=h[p]).name]&&e[f.name].length>0)if("string"==typeof e[f.name][0])o.push(e[f.name]);else{var u=e[f.name];u[1]=u[0].type,s.push(e[f.name]),delete e[f.name]}}for(var c=0,g=this.filters;c<g.length;c++){for(var f=g[c],m=!1,v=0,b=this.columns;v<b.length;v++){var S=b[v];this.getDimensionUniqueName(S.name)===this.getDimensionUniqueName(f.name)&&e[f.name]&&(o.push(e[f.name]),m=!0)}if(!m)for(var y=0,C=this.rows;y<C.length;y++){var w=C[y];this.getDimensionUniqueName(w.name)===this.getDimensionUniqueName(f.name)&&e[f.name]&&n.push(e[f.name])}}if((this.allowLabelFilter||this.allowValueFilter)&&s.length>0)for(var x=0,T=["Value","Label"];x<T.length;x++)for(var M=T[x],D=0,E=s;D<E.length;D++){var O=E[D];O&&2===O.length&&"string"==typeof O[1]&&O[1]===M&&r.push(this.getAdvancedFilterQuery(O[0],a,"COLUMNS"))}for(var P=0,N=o.length;P<N;P++)a=0===P?a+"{"+o[P].toString()+"}":a+",{"+o[P].toString()+"}";o.length>0&&(a=n.length>0?a+" ) ON COLUMNS ,(":a+" ) ON COLUMNS");for(P=0,N=n.length;P<N;P++)a=P>0?a+",{"+n[P].toString()+"}":a+"{"+n[P].toString()+"}";a=o.length>0&&n.length>0?a+=") ON ROWS ":0===o.length&&n.length>0?a+") ON COLUMNS ":a;var F="";return r.length>0&&(F=r.join(" ")+" "+(o.length>0||n.length>0?a:"")+" "+i+Array(r.length+1+(o.length>0||n.length>0?1:0)).join(")")),i=0===o.length&&0===n.length?i:a+i+")",F.length>0?F:i},e.getAdvancedFilterQuery=function(e,t,i){return"\nFROM (SELECT Filter("+e.selectedField+".AllMembers, "+this.getAdvancedFilterCondtions(e.name,e.condition,e.value1,e.value2,e.type,e.measure)+")) on "+i},e.getAdvancedFilterCondtions=function(e,t,i,a,s,r){var n="";switch(t){case"Equals":n="("+("Value"!==s?e+'.CurrentMember.member_caption ="'+i+'"':r+" = "+i);break;case"DoesNotEquals":n="("+("Value"!==s?e+'.CurrentMember.member_caption <>"'+i+'"':r+" <>"+i);break;case"Contains":n="( InStr (1,"+e+'.CurrentMember.member_caption,"'+i+'") >0';break;case"DoesNotContains":n="( InStr (1,"+e+'.CurrentMember.member_caption,"'+i+'")=0';break;case"BeginWith":n="( Left ("+e+".CurrentMember.member_caption,"+i.length+')="'+i+'"';break;case"DoesNotBeginWith":n="( Left ("+e+".CurrentMember.member_caption,"+i.length+') <>"'+i+'"';break;case"EndsWith":n="( Right ("+e+".CurrentMember.member_caption,"+i.length+')="'+i+'"';break;case"DoesNotEndsWith":n="( Right ("+e+".CurrentMember.member_caption,"+i.length+') <>"'+i+'"';break;case"GreaterThan":n="("+("Value"!==s?e+'.CurrentMember.member_caption >"'+i+'"':r+" >"+i);break;case"GreaterThanOrEqualTo":n="("+("Value"!==s?e+'.CurrentMember.member_caption >="'+i+'"':r+" >="+i);break;case"LessThan":n="("+("Value"!==s?e+'.CurrentMember.member_caption <"'+i+'"':r+" <"+i);break;case"LessThanOrEqualTo":n="("+("Value"!==s?e+'.CurrentMember.member_caption <="'+i+'"':r+" <="+i);break;case"Between":n="("+("Value"!==s?e+'.CurrentMember.member_caption >="'+i+'"AND '+e+'.CurrentMember.member_caption <="'+a+'"':r+" >="+i+" AND "+r+" <="+a);break;case"NotBetween":n="("+("Value"!==s?e+'.CurrentMember.member_caption >="'+i+'"OR '+e+'.CurrentMember.member_caption <="'+a+'"':r+" >="+i+" OR "+r+" <="+a);break;default:n="( InStr (1,"+e+'.CurrentMember.member_caption,"'+i+'") >0'}return n},e.getCalculatedFieldQuery=function(e){var t="";if(e.length>0){t="\nWITH";for(var i=0,a=e;i<a.length;i++){var s=a[i],r=(s.formula.indexOf("Measure")>-1?"[Measures].":s.hierarchyUniqueName+".")+"["+s.name+"]",n=sf.base.isNullOrUndefined(s.formatString)?null:s.formatString;t+="\nMEMBER "+r+"as ("+s.formula+") "+(sf.base.isNullOrUndefined(n)?"":', FORMAT_STRING ="'+n.trim()+'"')}}return t},e}(),Ze=function(){function e(){this.fieldList={},this.columnCount=0,this.rowCount=0,this.colFirstLvl=0,this.rowFirstLvl=0,this.pageColStartPos=0,this.enableSort=!1,this.enableValueSorting=!1,this.dataFields={},this.formatFields={},this.filterMembers={},this.drilledSets={},this.aggregatedValueMatrix=[],this.mappingFields={},this.customRegex=/^(('[^']+'|''|[^*#@0,.])*)(\*.)?((([0#,]*[0,]*[0#]*)(\.[0#]*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@0,.E])*)$/,this.formatRegex=/(^[ncpae]{1})([0-1]?[0-9]|20)?$/i,this.pivotValues=[],this.valueContent=[],this.headerContent=[],this.rowStartPos=0,this.pageRowStartPos=0,this.tupColumnInfo=[],this.tupRowInfo=[],this.gridJSON="",this.namedSetsPosition={},this.colDepth=0,this.totalCollection=[],this.parentObjCollection={},this.curDrillEndPos=-1,this.headerGrouping={},this.lastLevel=[],this.showRowSubTotals=!0,this.showColumnSubTotals=!0,this.hideRowTotalsObject={},this.hideColumnTotalsObject={},this.sortObject={},this.isColDrill=!1}return e.prototype.renderEngine=function(e,t){this.isEmptyData=!1,this.mdxQuery="",this.isMeasureAvail=!1,this.allowMemberFilter=!1,this.allowLabelFilter=!1,this.allowValueFilter=!1,this.isMondrian=!1,this.aggregatedValueMatrix=[],this.measureReportItems=[],this.calcChildMembers=[],this.selectedItems=[],this.savedFieldList=void 0,this.savedFieldListData=void 0,this.formatFields={},this.filterMembers={},this.dataFields={},this.valueAxis="",this.columnCount=0,this.rowCount=0,this.colFirstLvl=0,this.rowFirstLvl=0,this.pageColStartPos=0,this.enableValueSorting=!1,this.sortObject={},this.globalize=new sf.base.Internationalization,this.locale=this.globalize.getCulture(),this.localeObj=t?t.localeObj:void 0,this.enableValueSorting=!!t&&t.enableValueSorting,e.url&&(this.dataSourceSettings=e,this.valueAxis="row"===e.valueAxis?"row":"column",this.getAxisFields(),this.formats=e.formatSettings?e.formatSettings:[],this.enableSort=void 0===e.enableSorting||e.enableSorting,this.valueSortSettings=e.valueSortSettings?e.valueSortSettings:void 0,this.filterSettings=e.filterSettings?e.filterSettings:[],this.sortSettings=e.sortSettings?e.sortSettings:[],this.allowMemberFilter=!!e.allowMemberFilter,this.allowLabelFilter=!!e.allowLabelFilter,this.allowValueFilter=!!e.allowValueFilter,this.drilledMembers=e.drilledMembers?this.updateDrilledItems(e.drilledMembers):[],this.calculatedFieldSettings=e.calculatedFieldSettings?e.calculatedFieldSettings:[],this.emptyCellTextContent=e.emptyCellsTextContent?e.emptyCellsTextContent:"",this.pageSettings=t?t.pageSettings?t.pageSettings:this.pageSettings:void 0,this.isPaging=!!this.pageSettings,this.frameSortObject(),this.getFormattedFields(this.formats),this.savedFieldList=t?t.savedFieldList:void 0,this.savedFieldListData=t?t.savedFieldListData:void 0,this.fieldListData=[],this.fieldListObj={},this.setNamedSetsPosition(),this.savedFieldList&&this.savedFieldListData?this.updateFieldlist(!0):this.getFieldList(e),this.loadCalculatedMemberElements(this.calculatedFieldSettings),this.measureReportItems=[],this.updateFilterItems(this.filterSettings),this.generateGridData(e))},e.prototype.generateGridData=function(e,t){var i=!(!t||"navPaging"!==t||!this.isPaging||void 0===this.pageSettings);this.rows.length>0||this.columns.length>0||this.values.length>0||this.filters.length>0?Xe.getCellSets(e,this,i):(Xe.getCellSets(e,this,!0,void 0,!0),this.generateEngine(void 0,void 0,{dataSourceSettings:e,action:"loadTableElements"}))},e.prototype.generatePagingData=function(e,t,i){var a=[].slice.call(e.querySelectorAll("Axes, CellData")),s=a[1]?a[1].querySelectorAll("FmtValue"):null;s&&s.length>0&&(this.columnCount=Number(s[0].textContent),this.rowCount=Number(s[1].textContent));var r=i.dataSourceSettings;Xe.getCellSets(r,this,!0)},e.prototype.scrollPage=function(e,t,i){Xe.getCellSets(this.dataSourceSettings,this,!0)},e.prototype.generateEngine=function(e,t,i){"down"!==i.action&&(this.pivotValues=[],this.valueContent=[],this.headerContent=[],this.colDepth=0,this.tupColumnInfo=[],this.tupRowInfo=[],this.colMeasures={},this.colMeasurePos=void 0,this.rowMeasurePos=void 0,this.rowStartPos=-1),this.xmlDoc=e?e.cloneNode(!0):void 0,this.request=t,this.customArgs=i,this.totalCollection=[],this.parentObjCollection={},this.curDrillEndPos=-1,this.onDemandDrillEngine=[],this.getSubTotalsVisibility(),this.xmlaCellSet=e?e.querySelectorAll("Axes, CellData"):void 0;var a=this.xmlaCellSet&&this.xmlaCellSet.length>0?[].slice.call(this.xmlaCellSet[0].querySelectorAll('Axis[name|="Axis0"] Tuple')):[],s=this.xmlaCellSet&&this.xmlaCellSet.length>0?[].slice.call(this.xmlaCellSet[0].querySelectorAll('Axis[name|="Axis1"] Tuple')):[],r=this.xmlaCellSet&&this.xmlaCellSet.length>1?[].slice.call(this.xmlaCellSet[1].querySelectorAll("Cell")):[];if(this.drilledMembers.length>0){var n=this.getMeasureInfo(),o=void 0;a=(o=this.frameMeasureOrder(n,"column",a,r,a.length)).orderedHeaderTuples,r=o.orderedValueTuples,s=(o=this.frameMeasureOrder(n,"row",s,r,a.length)).orderedHeaderTuples,r=o.orderedValueTuples}if("down"===i.action&&this.updateTupCollection("row"===i.drillInfo.axis?s.length:a.length),"down"===i.action&&"column"!==i.drillInfo.axis||(this.frameColumnHeader(a),this.isPaging||this.performColumnSorting()),"down"===i.action&&"row"!==i.drillInfo.axis||(this.frameRowHeader(s),this.isPaging||this.performRowSorting()),this.frameValues(r,a.length),this.performColumnSpanning(),!this.isPaging&&this.enableSort)for(var l=0;l<this.headerContent.length;l++)this.headerContent[l]=this.pivotValues[l];this.isEngineUpdated=!0,this.isEmptyData=0===a.length},e.prototype.getSubTotalsVisibility=function(){this.showRowSubTotals=this.dataSourceSettings.showRowSubTotals&&this.dataSourceSettings.showSubTotals,this.showColumnSubTotals=this.dataSourceSettings.showColumnSubTotals&&this.dataSourceSettings.showSubTotals,this.hideRowTotalsObject={},this.hideColumnTotalsObject={};var e=1;do{if(1===e){if(this.showColumnSubTotals)for(var t=0;t<this.dataSourceSettings.columns.length;t++)!1===this.dataSourceSettings.columns[t].showSubTotals&&(this.hideColumnTotalsObject[this.dataSourceSettings.columns[t].name]=t)}else if(this.showRowSubTotals)for(var i=0;i<this.dataSourceSettings.rows.length;i++)!1===this.dataSourceSettings.rows[i].showSubTotals&&(this.hideRowTotalsObject[this.dataSourceSettings.rows[i].name]=i);e++}while(e<3)},e.prototype.frameRowHeader=function(e){this.headerGrouping={},this.lastLevel=[];var t=this.pivotValues.length,i=[],a=[];"down"!==this.customArgs.action?(i=this.pivotValues,a=this.valueContent):t=this.customArgs.drillInfo.currentCell.rowIndex+1,this.rowStartPos=this.rowStartPos>0?this.rowStartPos:t;for(var s,r,n,o,l=0,d=[],p={},h=[],u=!1,c=-1,g=-1,f=[],m=[{axis:"row",colIndex:0,formattedText:"Grand Total",hasChild:!1,level:-1,rowIndex:0,index:[],type:"grand sum",ordinal:0,colSpan:1,rowSpan:1,memberType:2,isDrilled:!1,valueSort:{"Grand Total":1,levelName:"Grand Total"}}],v=[],b=this.customArgs.drillInfo&&"row"===this.customArgs.drillInfo.axis?this.customArgs.drillInfo.currentCell.ordinal+1:0;l<e.length;){var S=e[l].querySelectorAll("Member");v=this.frameTupCollection(S,v,l+b,this.tupRowInfo,this.showRowSubTotals,this.hideRowTotalsObject,"row"),l++}l=0;var y=e.length;if("down"===this.customArgs.action){var C=this.customArgs.drillInfo.currentCell.ordinal+1;l=C,y+=C,r=this.tupRowInfo[C-1].allCount,s=this.tupRowInfo[C-1].allStartPos,o=this.tupRowInfo[C-1]}for(var w=l,x=0;l<y;){S=e["down"===this.customArgs.action?l-(this.customArgs.drillInfo.currentCell.ordinal+1):l].querySelectorAll("Member");var T=0,M=void 0,D=this.tupRowInfo[l].allCount,E=this.tupRowInfo[l].allStartPos,O=this.tupRowInfo[l].measure,P=this.tupRowInfo[l].typeCollection,N=(this.tupRowInfo[l].drillInfo,this.tupRowInfo[l].drillStartPos),F=this.tupRowInfo[l].startDrillUniquename;this.tupRowInfo[l].drillEndPos,this.tupRowInfo[l].levelCollection;if(0===l||l===w){for(var I="down"===this.customArgs.action?this.tupRowInfo[0].members:S;T<I.length;)"1"===I[T].querySelector("MEMBER_TYPE").textContent&&0===Number(I[T].querySelector("LNum").textContent)?f[T]=0:f[T]=Number(I[T].querySelector("LNum").textContent),"1"===I[T].querySelector("MEMBER_TYPE").textContent?(p[T]=0,c=-1===c?T:c,g=T):(p[T]=1,u="3"!==I[T].querySelector("MEMBER_TYPE").textContent||u),T++;n=P.indexOf("3")}if(T=0,0===l&&(S.length>D+(O?1:0)||1===S.length&&O)&&m.pop(),0===l&&this.isPaging?0===m.length:!u||D===r||E!==s||1===S.length&&O){var L=this.checkAttributeDrill(this.tupRowInfo[l].drillInfo,"rows"),A=!(N>-1)||(!(D>0)||(L||E>N));A=o&&A&&N>-1?o.startDrillUniquename!==F||!(g>o.measurePosition||o.measureName===this.tupRowInfo[l].measureName||E!==N+1&&this.tupRowInfo[l].measurePosition!==N+1):A;var R=!(c>-1&&D>0)||(L||E>g);if(S.length===D+(O?1:0)&&O){var k="Grand Total."+S[n].querySelector("Caption").textContent;m.push({axis:"row",actualText:this.getUniqueName(S[n].querySelector("UName").textContent),colIndex:0,formattedText:"3"===P[n]&&this.dataFields[this.getUniqueName(S[n].querySelector("UName").textContent)]&&this.dataFields[this.getUniqueName(S[n].querySelector("UName").textContent)].caption?this.dataFields[this.getUniqueName(S[n].querySelector("UName").textContent)].caption:S[n].querySelector("Caption").textContent,hasChild:!1,level:-1,rowIndex:t,index:[],ordinal:l,colSpan:1,rowSpan:1,memberType:Number(P[n]),isDrilled:!1,parentUniqueName:S[n].querySelector("PARENT_UNIQUE_NAME")?S[n].querySelector("PARENT_UNIQUE_NAME").textContent:void 0,levelUniqueName:S[n].querySelector("LName").textContent,hierarchy:S[n].getAttribute("Hierarchy"),valueSort:{levelName:k,axis:S[n].getAttribute("Hierarchy")}}),m[m.length-1].valueSort["Grand Total."+S[n].querySelector("Caption").textContent]=1}else if(0!==E&&(0!==n||1!==E)&&A&&R){o=this.tupRowInfo[l];var j=t,q=T;M={};for(var V=!1;T<S.length;){var B=S[T];if(B.querySelector("UName").textContent!==d[T]&&"2"!==P[T]&&(!(Object.keys(M).length>0?M.isDrilled&&!this.fieldList[M.hierarchy].isHierarchy:V)||"3"===P[T]&&p[T-1]&&0!==p[T+1])){var _=Number(B.querySelector("LNum").textContent)-(p[T]&&"3"!==P[T]?1:f[T]),H=!!this.namedSetsPosition.row[T],U=this.getUniqueName(B.querySelector("UName").textContent),G=this.getDepth(this.tupRowInfo[l],U,Number(P[T]));if(!(this.isPaging&&i[x][0]&&this.fieldList[i[x][0].hierarchy]&&this.fieldList[i[x][0].hierarchy].isHierarchy&&i[x][0].hasChild&&!i[x][0].isDrilled&&!this.rows[T].isNamedSet&&(0===this.rows[T].name.indexOf("[Measures]")||this.fieldList[B.getAttribute("Hierarchy")]&&(this.fieldList[B.getAttribute("Hierarchy")].isHierarchy||this.fieldList[B.getAttribute("Hierarchy")].hasAllMember))&&i[x][0].depth<G)){i[t]=[{axis:"row",actualText:U,colIndex:0,formattedText:"3"===P[T]&&this.dataFields[U]&&this.dataFields[U].caption?this.dataFields[U].caption:B.querySelector("Caption").textContent,hasChild:!!(this.fieldList[B.getAttribute("Hierarchy")]&&this.fieldList[B.getAttribute("Hierarchy")].isHierarchy&&T<this.rows.length-1&&!this.rows[T+1].isNamedSet&&this.rows[T+1].name.indexOf("[Measures]")<0&&this.fieldList[this.rows[T+1].name]&&this.fieldList[this.rows[T+1].name].hasAllMember)||Number(B.querySelector("CHILDREN_CARDINALITY").textContent)>0,level:_,depth:G,rowIndex:t,index:[],ordinal:l,type:"header",colSpan:1,rowSpan:1,memberType:Number(P[T]),isDrilled:!(!this.fieldList[B.getAttribute("Hierarchy")]||!this.fieldList[B.getAttribute("Hierarchy")].isHierarchy||this.isAttributeDrill(B.getAttribute("Hierarchy"),this.tupRowInfo[l].drillInfo,"rows"))||this.tupRowInfo[l].drillInfo[T].isDrilled,parentUniqueName:B.querySelector("PARENT_UNIQUE_NAME")?B.querySelector("PARENT_UNIQUE_NAME").textContent:void 0,levelUniqueName:B.querySelector("LName").textContent,hierarchy:B.getAttribute("Hierarchy"),isNamedSet:H,valueSort:{levelName:"",axis:B.getAttribute("Hierarchy")}}],(M="3"!==P[T]?i[t][0]:M)||h.push(B.querySelector("Caption").textContent);k=this.getCaptionCollectionWithMeasure(this.tupRowInfo[l]);i[t][0].valueSort.levelName=k,i[t][0].valueSort[k]=1,a[t-this.rowStartPos]={},a[t-this.rowStartPos][0]=i[t][0],O&&n>T&&(d[n]="");for(var z=T+1;z<S.length;z++)d[z]="";d[T]=B.querySelector("UName").textContent,x=3!==Number(P[T])?t:x,t++,q=T}}else"2"===P[T]?q=T:this.tupRowInfo[l].drillInfo[T].isDrilled&&0===p[T]&&(V=!0);this.tupRowInfo[l].drillInfo[T].isDrilled&&this.tupRowInfo[l].showTotals&&(this.tupRowInfo[l].showTotals=!!this.showRowSubTotals&&void 0===this.hideRowTotalsObject[this.tupRowInfo[l].drillInfo[T].hierarchy]),T++}j<t&&q>=S.length-1&&(i[t-1][0].ordinal=l,"header"===i[t-1][0].type&&delete i[t-1][0].type)}r=D,s=E}l++}if(m.length>1&&3!==m[0].memberType&&(m[0].ordinal=-1),"down"!==this.customArgs.action){if(this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showRowGrandTotals)for(var W=0;W<m.length;W++)m[W].rowIndex=t,i[t]=[m[W]],a[t-this.rowStartPos]={},a[t-this.rowStartPos][0]=i[t][0],t++}else this.updateRowEngine(i,a,e.length),this.onDemandDrillEngine=i},e.prototype.getDepth=function(e,t,i){var a=e.uNameCollection.indexOf(t),s=(e.uNameCollection.substring(0,a)+(3===i?"":t)).split("::[").map((function(e){return"["===e[0]?e:"["+e}));3===i&&this.rowMeasurePos===s.length&&s.push(t);for(var r=-1,n=0;n<s.length;n++){r+=s[n].split("~~").length}return r},e.prototype.checkAttributeDrill=function(e,t){for(var i=!1,a=0;a<e.length&&!(i=this.isAttributeDrill(e[a].hierarchy,e,t));a++);return i},e.prototype.frameTupCollection=function(e,t,i,a,s,r,n){for(var o,l,d,p,h,u,c=0,g=0,f=[],m=[],v=[],b="",S="",y=!0,C=-1;c<e.length;){var w=e[c],x=Number(w.querySelector("LNum").textContent),T=w.querySelector("UName").textContent;Number(w.querySelector("MEMBER_TYPE").textContent)>3&&(w.querySelector("MEMBER_TYPE").textContent=0===T.indexOf("[Measures]")?"3":"1");var M=0===T.indexOf("[Measures]")?"3":Number(w.querySelector("MEMBER_TYPE").textContent)>3?"1":w.querySelector("MEMBER_TYPE").textContent,D=w.querySelector("Caption").textContent;this.fieldList[D]&&"CalculatedField"===this.fieldList[D].type&&(D=this.fieldList[D].caption,w.querySelector("Caption").textContent=D);var E=w.getAttribute("Hierarchy"),O=w.querySelector("PARENT_UNIQUE_NAME")?w.querySelector("PARENT_UNIQUE_NAME").textContent:"";if("2"===M?(this.isPaging||g++,d=sf.base.isNullOrUndefined(d)?c:d):"3"===M?(p=w,h=T,u=c,"column"===n?(this.colMeasures[T]=w,this.colMeasurePos=c):this.rowMeasurePos=c):C=r[E],"2"!==M){if(this.headerGrouping[c]){if(x>this.lastLevel[c])this.lastLevel[c]=x;else if(x<this.lastLevel[c]){for(var P=this.lastLevel[c];P>=x;)delete this.headerGrouping[c].UName[P],delete this.headerGrouping[c].Caption[P],P--;this.lastLevel[c]=x}this.headerGrouping[c].UName[x]=T,this.headerGrouping[c].Caption[x]=D}else this.lastLevel[c]=x,this.headerGrouping[c]={UName:(o={},o[x]=T,o),Caption:(l={},l[x]=D,l)};if(this.isPaging)for(var N=O;this.drilledSets[N];){var F=this.drilledSets[N].querySelector("Caption").textContent,I=Number(this.drilledSets[N].querySelector("LNum").textContent);this.headerGrouping[c].UName[I]=N,this.headerGrouping[c].Caption[I]=F,N=null===this.drilledSets[N].querySelector("PARENT_UNIQUE_NAME")?"":this.drilledSets[N].querySelector("PARENT_UNIQUE_NAME").textContent}for(var L="",A=Object.keys(this.headerGrouping[c].UName),R=0;R<A.length;R++){var k=A[R];L=0===R?this.headerGrouping[c].UName[k]:L+"~~"+this.headerGrouping[c].UName[k]}b=""===b?L:b+"::"+L;var j="",q=Object.keys(this.headerGrouping[c].Caption);for(R=0;R<q.length;R++){k=q[R];j=0===R?this.headerGrouping[c].Caption[k]:j+"~~"+this.headerGrouping[c].Caption[k]}c!==u&&(S=""===S?j:S+"::"+j)}if(f.push(M),m.push(x),(sf.base.isNullOrUndefined(t[c])||t[c]<x)&&(t[c]=x),v.push({level:x,uName:T,hierarchy:E,isDrilled:!1}),a[i-1]&&"1"===a[i-1].typeCollection[c]&&v[c].level>a[i-1].drillInfo[c].level){var V=b.split(/~~|::\[/).map((function(e){return"["===e[0]?e:"["+e}));V.pop();var B=V.join("~~");this.setDrillInfo(O,B,c,i,a)}c++}return C>-1&&(y="2"!==f[C+1]),a[i]={allCount:g,allStartPos:d,measure:p,measureName:h,measurePosition:u,members:e,typeCollection:f,uNameCollection:b,captionCollection:S,levelCollection:m,drillInfo:v,drillStartPos:-1,drillEndPos:-1,showTotals:!(!s&&g>0&&d>(0===u?1:0))&&y},t},e.prototype.getCaptionCollectionWithMeasure=function(e){var t=e.captionCollection;if(e.measure){var i=e.measure.querySelector("Caption").textContent,a=e.uNameCollection.split(/[~~,::]+/g).indexOf(e.measureName);(s=e.captionCollection.split(/[~~,::]+/g)).splice(a,0,i),t=s.join(".")}else{var s;t=(s=e.captionCollection.split(/[~~,::]+/g)).join(".")}return t},e.prototype.setNamedSetsPosition=function(){this.namedSetsPosition={};var e=0;do{for(var t={},i=e?this.dataSourceSettings.rows:this.dataSourceSettings.columns,a=0;a<i.length;a++)i[a].isNamedSet&&(t[a]=i[a].name);this.namedSetsPosition[e?"row":"column"]=t,e++}while(e<2)},e.prototype.updateRowEngine=function(e,t,i){for(var a=this.pivotValues.length-1,s=Object.keys(e).length;a>this.customArgs.drillInfo.currentCell.rowIndex;)this.pivotValues[a+s]=this.pivotValues[a],this.pivotValues[a+s][0].ordinal+=i,this.pivotValues[a+s][0].rowIndex+=s,this.valueContent[a+s-this.rowStartPos]=this.valueContent[a-this.rowStartPos],a--;for(var r=0;r<e.length;r++)this.pivotValues[r]=e[r],this.valueContent[Number(r)-this.rowStartPos]=t[Number(r)-this.rowStartPos];this.pivotValues[this.customArgs.drillInfo.currentCell.rowIndex][0].isDrilled=!0},e.prototype.updateTupCollection=function(e){for(var t="row"===this.customArgs.drillInfo.axis?this.tupRowInfo:this.tupColumnInfo,i=t.length-1;i>this.customArgs.drillInfo.currentCell.ordinal;)t[i+e]=t[i],i--},e.prototype.frameColumnHeader=function(e){var t=this;this.headerGrouping={},this.lastLevel=[];for(var i=0,a=[],s=[],r=[],n=-1,o=-1,l=this.customArgs.drillInfo&&"column"===this.customArgs.drillInfo.axis?this.customArgs.drillInfo.currentCell.ordinal+1:0;i<e.length;){var d=e[i].querySelectorAll("Member");a=this.frameTupCollection(d,a,i+l,this.tupColumnInfo,this.showColumnSubTotals,this.hideColumnTotalsObject,"column"),i++}if(e.length>0){d=e[0].querySelectorAll("Member");for(var p=0;p<d.length;)r[p]="1"===d[p].querySelector("MEMBER_TYPE").textContent&&0===Number(d[p].querySelector("LNum").textContent)?0:Number(d[p].querySelector("LNum").textContent),"1"!==d[p].querySelector("MEMBER_TYPE").textContent||!this.isPaging&&0!==Number(d[p].querySelector("LNum").textContent)?s[p]=1:(s[p]=0,n=-1===n?p:n,o=p),p++}i=0;for(var h,u=1,c={},g=!0,f=!1,m=function(){var l=e[i].querySelectorAll("Member"),d=v.tupColumnInfo[i].allCount,p=v.tupColumnInfo[i].allStartPos,m=v.tupColumnInfo[i].measure,b=v.tupColumnInfo[i].typeCollection,S=v.tupColumnInfo[i].drillInfo,y=v.tupColumnInfo[i].drillStartPos,C=v.tupColumnInfo[i].startDrillUniquename,w=v.tupColumnInfo[i].endDrillUniquename,x=v.tupColumnInfo[i].drillEndPos,T=v.tupColumnInfo[i].levelCollection,M="2"!==b[0]&&("3"!==b[0]||"2"!==b[1]),D=0;if(a.map((function(e,i){D+=0===s[i]?e+(1-(r[i]>1?1:r[i])):0===e?t.isPaging&&"2"===b[i]?0:1:e})),v.colDepth=v.colDepth>D?v.colDepth:D,0===i&&l.length>d+(m?1:0)&&(f=!0,M=d>0&&M?p>n:M),M&&0===d){var E=[-1,-1,-1];v.tupColumnInfo[i-1]&&0===v.tupColumnInfo[i-1].allCount?E=v.levelCompare(T,v.tupColumnInfo[i-1].levelCollection):f&&h&&(E=v.levelCompare(T,h.levelCollection)),v.tupColumnInfo[i].drillStartPos<0?(!g&&E[0]>-1&&E[2]>-1&&(u=v.mergeTotCollection(u,d,a,r,s,p,S,E)),v.setParentCollection(l),v.frameCommonColumnLoop(l,i,u,a,s,r),v.tupColumnInfo[i].showTotals||u--,!g&&E[0]>-1&&E[2]>-1&&(u=v.mergeTotCollection(u,d,a,r,s,p,S,E)),g=!1,v.isColDrill?v.isColDrill=!1:u++):c.drillStartPos===y&&c.startDrillUniquename===C&&c.allCount!==d||(!g&&E[0]>-1&&E[2]>-1&&(u=v.mergeTotCollection(u,d,a,r,s,p,S,E),g=!0),v.setParentCollection(l),(!f||o<=y)&&(v.totalCollection[v.totalCollection.length]={allCount:d,ordinal:i,members:l,drillInfo:S},c.allCount=d,c.allStartPos=p,c.drillStartPos=y,c.startDrillUniquename=C,c.endDrillUniquename=w)),h=v.tupColumnInfo[i]}var O=v.checkAttributeDrill(v.tupColumnInfo[i].drillInfo,"columns");if(d>0&&(!f||M&&(O||o<p))&&(d===c.allCount||p!==c.allStartPos)){var P=x===y||c.endDrillUniquename===w,N=p!==c.allStartPos?c.startDrillUniquename!==C:P;y>-1&&!N||(g||(u=v.mergeTotCollection(u,d,a,r,s,p,S),g=!0),v.setParentCollection(l),f&&y>-1&&!(o<=y)||(v.totalCollection[v.totalCollection.length]={allCount:d,ordinal:i,members:l,allStartPos:p,drillInfo:S},c.allCount=d,c.allStartPos=p,c.drillStartPos=y,c.startDrillUniquename=C,c.endDrillUniquename=w))}i++},v=this;i<e.length;)m();if(this.totalCollection.length>0)if(Object.keys(this.colMeasures).length>1)this.orderTotals(u,a,s,r);else{this.totalCollection=this.totalCollection.reverse();for(var b=0,S=this.totalCollection;b<S.length;b++){var y=S[b];if(!(0===this.tupColumnInfo[y.ordinal].measurePosition?1===this.tupColumnInfo[y.ordinal].allStartPos:0===this.tupColumnInfo[y.ordinal].allStartPos)||this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showColumnGrandTotals){this.frameCommonColumnLoop(y.members,y.ordinal,u,a,r,s);var C=this.checkAttributeDrill(this.tupColumnInfo[y.ordinal].drillInfo,"columns");(this.tupColumnInfo[y.ordinal].showTotals||C)&&u++}}}},e.prototype.orderTotals=function(e,t,i,a){for(var s={},r=1,n=0,o=this.totalCollection;n<o.length;n++){var l=o[n];if(!(0===this.tupColumnInfo[l.ordinal].measurePosition?1===this.tupColumnInfo[l.ordinal].allStartPos:0===this.tupColumnInfo[l.ordinal].allStartPos)||this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showColumnGrandTotals){var d=this.tupColumnInfo[l.ordinal].measure.querySelector("UName").textContent;s[d]?(s[d].coll.push(l),s[d].count++,r=r<s[d].count?s[d].count:r):s[d]={coll:[l],count:1}}}for(var p=Object.keys(s),h=r-1;h>-1;){for(var u=0,c=p;u<c.length;u++){(l=s[c[u]].coll[h])&&(this.frameCommonColumnLoop(l.members,l.ordinal,e,t,i,a),this.tupColumnInfo[l.ordinal].showTotals&&e++)}h--}},e.prototype.setParentCollection=function(e){for(var t=0;e.length>t;){var i=e[t],a=Number(i.querySelector("MEMBER_TYPE").textContent)>2?"3":i.querySelector("MEMBER_TYPE").textContent,s=Number(i.querySelector("LNum").textContent),r=i.querySelector("UName").textContent,n=i.querySelector("PARENT_UNIQUE_NAME")?i.querySelector("PARENT_UNIQUE_NAME").textContent:"",o=!0,l=!1;if(this.parentObjCollection[t]){var d=Object.keys(this.parentObjCollection[t]),p=this.parentObjCollection[t][s-1];o=p?n===p.querySelector("UName").textContent:0===d.length,l="1"===this.tupColumnInfo[0].typeCollection[t]}"2"===a?delete this.parentObjCollection[t]:(!this.isPaging&&!l||o||delete this.parentObjCollection[t],this.parentObjCollection[t]?this.parentObjCollection[t][s]&&this.parentObjCollection[t][s].querySelector("UName").textContent===r||(this.parentObjCollection[t][s]=i):(this.parentObjCollection[t]={},this.parentObjCollection[t][s]=i)),t++}},e.prototype.setDrillInfo=function(e,t,i,a,s){for(a--;s[a]&&s[a].drillInfo[i].uName===e;){if(s[a].uNameCollection.split(/~~|::\[/).map((function(e){return"["===e[0]?e:"["+e})).join("~~").indexOf(t)<0)break;s[a].drillInfo[i].isDrilled=!0,this.curDrillEndPos<=i&&(s[a].drillEndPos=this.curDrillEndPos=i,s[a].endDrillUniquename=e),(s[a].drillStartPos>i||-1===s[a].drillStartPos)&&(s[a].drillStartPos=i),s[a].startDrillUniquename=e,a--}},e.prototype.levelCompare=function(e,t){for(var i=[-1,0],a=0;a<t.length;a++)if(e[a]!==t[a]){i=[a,e[a],t[a]-e[a]];break}return i},e.prototype.mergeTotCollection=function(e,t,i,a,s,r,n,o){for(var l=sf.base.isNullOrUndefined(r)?o[0]:r-(this.colMeasurePos===r-1?2:1),d=n[l]&&n[l].level,p=this.getLevelsAsString(l-1,n),h={},u=1,c=!1,g=0,f=this.totalCollection;g<f.length;g++){var m=f[g];if(c||m.allCount<=t&&(!(d>-1&&m.drillInfo[l])||m.drillInfo[l].level>=d&&this.getLevelsAsString(l-1,m.drillInfo)===p)){var v=this.tupColumnInfo[m.ordinal].measure?this.tupColumnInfo[m.ordinal].measure.querySelector("UName").textContent:"measure";h[v]?(h[v].coll.push(m),h[v].count++,u=u<h[v].count?h[v].count:u):h[v]={coll:[m],count:1},c=!1}}for(var b=Object.keys(h),S=u-1;S>-1;){for(var y=0,C=b;y<C.length;y++){var w=h[C[y]].coll[S];if(w)(!(0===this.tupColumnInfo[w.ordinal].measurePosition?1===this.tupColumnInfo[w.ordinal].allStartPos:0===this.tupColumnInfo[w.ordinal].allStartPos)||this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showColumnGrandTotals)&&(this.frameCommonColumnLoop(w.members,w.ordinal,e,i,s,a),this.tupColumnInfo[w.ordinal].showTotals&&e++),this.totalCollection.pop()}S--}return e},e.prototype.getLevelsAsString=function(e,t){for(var i=[],a=0;a<e;a++)i[a]=t[a].level;return i.length>0?i.toString():""},e.prototype.frameCommonColumnLoop=function(e,t,i,a,s,r){var n,o=-1;if(this.tupColumnInfo[t].showTotals)for(var l=0,d=0;l<e.length;)d+=r[l]>0&&this.getMeasurePosition(this.tupColumnInfo[t].uNameCollection,this.tupColumnInfo[t].measurePosition)!==l?a[l]:a[l]+(1-s[l]),this.tupColumnInfo[t].drillInfo[l].isDrilled&&this.tupColumnInfo[t].showTotals&&(this.tupColumnInfo[t].showTotals=!!this.showColumnSubTotals&&void 0===this.hideColumnTotalsObject[this.tupColumnInfo[t].drillInfo[l].hierarchy],d-=a[l]-this.tupColumnInfo[t].levelCollection[l],o=this.tupColumnInfo[t].showTotals?-1:d-1),l++;var p=this.checkAttributeDrill(this.tupColumnInfo[t].drillInfo,"columns");if(this.tupColumnInfo[t].showTotals||p)for(var h=0,u=0,c={};h<e.length;){for(var g=e[h],f=Number(g.querySelector("MEMBER_TYPE").textContent)>2?"3":g.querySelector("MEMBER_TYPE").textContent,m=0,v="2"!==f?r[h]?1:s[h]:1;v<=("3"===f?1:a[h]);v++){var b=!1;this.pivotValues[u]||(this.pivotValues[u]=[]),Number(e[h].querySelector("LNum").textContent)>v&&"2"!==f?(this.parentObjCollection[h][v]||this.getDrilledParent(e[h],v,this.parentObjCollection[h]),this.parentObjCollection[h][v]&&(g=this.parentObjCollection[h][v]),b=!0):(g=e[h],m++),"2"!==f&&(c[g.querySelector("UName").textContent]=g.querySelector("Caption").textContent);for(var S="",y=Object.keys(c),C=0;C<y.length;C++){var w=y[C];S=0===C?c[w]:S+"."+c[w]}var x=!!this.namedSetsPosition.column[h],T=this.getUniqueName(g.querySelector("UName").textContent),M=this.getDepth(this.tupColumnInfo[t],T,Number(f));if(this.isPaging&&this.pivotValues[u-1]&&this.pivotValues[u-1][i]&&this.fieldList[this.pivotValues[u-1][i].hierarchy]&&this.fieldList[this.pivotValues[u-1][i].hierarchy].isHierarchy&&this.pivotValues[u-1][i].hasChild&&!this.pivotValues[u-1][i].isDrilled&&!this.columns[h].isNamedSet&&this.fieldList[g.getAttribute("Hierarchy")]&&(this.fieldList[g.getAttribute("Hierarchy")].isHierarchy||this.fieldList[g.getAttribute("Hierarchy")].hasAllMember)&&this.pivotValues[u-1][i].depth<M){this.isColDrill=!0;break}this.pivotValues[u][i]={axis:"column",actualText:T,colIndex:i,formattedText:"3"===f&&this.dataFields[T]&&this.dataFields[T].caption?this.dataFields[T].caption:g.querySelector("Caption").textContent,hasChild:!!(this.fieldList[g.getAttribute("Hierarchy")]&&this.fieldList[g.getAttribute("Hierarchy")].isHierarchy&&h<this.columns.length-1&&!this.columns[h+1].isNamedSet&&this.columns[h+1].name.indexOf("[Measures]")<0&&this.fieldList[this.columns[h+1].name]&&this.fieldList[this.columns[h+1].name].hasAllMember)||Number(g.querySelector("CHILDREN_CARDINALITY").textContent)>0,level:m>1?-1:Number(g.querySelector("LNum").textContent)-(r[h]&&"3"!==f?1:0),rowIndex:u,ordinal:t,memberType:Number(f),depth:M,isDrilled:!(!this.fieldList[g.getAttribute("Hierarchy")]||!this.fieldList[g.getAttribute("Hierarchy")].isHierarchy||this.isAttributeDrill(g.getAttribute("Hierarchy"),this.tupColumnInfo[t].drillInfo,"columns"))||(b||this.tupColumnInfo[t].drillInfo[h].isDrilled),parentUniqueName:g.querySelector("PARENT_UNIQUE_NAME")?g.querySelector("PARENT_UNIQUE_NAME").textContent:void 0,levelUniqueName:g.querySelector("LName").textContent,hierarchy:g.getAttribute("Hierarchy"),isNamedSet:x,valueSort:(n={levelName:S},n[S]=1,n.axis=g.getAttribute("Hierarchy"),n)},this.headerContent[u]||(this.headerContent[u]={}),this.headerContent[u][i]=this.pivotValues[u][i],u++}h++}else if(o>-1)this.pivotValues[o][i-1].ordinal=t;else if(this.tupColumnInfo[t].allCount>0){for(l=0,d=0;l<this.tupColumnInfo[t].allStartPos;)d+=r[l]>0&&this.getMeasurePosition(this.tupColumnInfo[t].uNameCollection,this.tupColumnInfo[t].measurePosition)!==l?a[l]:a[l]+(1-s[l]),l++;this.tupColumnInfo[t].allStartPos===this.tupColumnInfo[t].measurePosition+1?d-=a[this.tupColumnInfo[t].allStartPos-2]-this.tupColumnInfo[t].levelCollection[this.tupColumnInfo[t].allStartPos-2]+1:d-=a[this.tupColumnInfo[t].allStartPos-1]-this.tupColumnInfo[t].levelCollection[this.tupColumnInfo[t].allStartPos-1],this.pivotValues[d-1][i-1].ordinal=t}},e.prototype.isAttributeDrill=function(e,t,i){var a=!1;if(!this.isAdjacentToMeasure(e,i))for(var s=0;s<this.drilledMembers.length;s++)if(this.drilledMembers[s].name===e)for(var r=0;r<this.drilledMembers[s].items.length;r++){for(var n=this.drilledMembers[s].items[r].split(this.drilledMembers[s].delimiter),o="",l=0;l<n.length;l++)t[l]&&t[l].uName&&(o=o+(""===o?"":this.drilledMembers[s].delimiter)+t[l].uName);if(o===this.drilledMembers[s].items[r]){a=!0;break}}return a},e.prototype.isAdjacentToMeasure=function(e,t){for(var i=!1,a="rows"===t?this.rows:this.columns,s=0;s<a.length;s++)if(a[s].name===e&&a[s+1]&&("[Measures]"===a[s+1].name||a[s+1].isNamedSet||this.fieldList[a[s+1].name]&&!this.fieldList[a[s+1].name].hasAllMember)){i=!0;break}return i},e.prototype.getDrilledParent=function(e,t,i){for(var a=Number(e.querySelector("LNum").textContent),s=e,r=a-1;r>=t;r--){var n=this.drilledSets[s.querySelector("PARENT_UNIQUE_NAME").textContent];if(!n)break;i[r]=n,s=n}},e.prototype.performRowSorting=function(){var e;if(this.enableSort&&this.tupRowInfo.length>0){for(var t=this.pivotValues.length,i={},a={},s=[],r=!1,n=this.tupRowInfo[0].typeCollection.lastIndexOf("1"),o=this.colDepth;o<t;o++){var l=this.pivotValues[o][0],d=this.tupRowInfo[l.ordinal],p=d?0===d.measurePosition&&3===l.memberType?d.measureName:d.uNameCollection:"";if(""!==p){n>-1&&(p=this.frameUniqueName(p,l,d));var h=p.split(/~~|::\[/).length;if(3===l.memberType&&this.tupRowInfo[0].measurePosition>0)a[A=this.getParentUname(p,l,!0,!0)]?a[A].push(l):a[A]=[l];else i[h]?i[h][p]=[l]:i[h]=((e={})[p]=[l],e)}r&&s.push(l),"grand sum"===l.type&&(r=!0)}for(var u=Object.keys(a).length>0&&this.tupRowInfo[0].measurePosition>0,c=Object.keys(i).map((function(e){return Number(e)})).sort((function(e,t){return e>t?1:t>e?-1:0})),g={},f=c.length-1;f>=0;f--){for(var m={},v=i[c[f]],b=Object.keys(v),S=0;S<b.length;S++){m[A=0===f?"parent":this.getParentUname(b[S],v[b[S]][0],u,!1)]?m[A].push(v[b[S]][0]):m[A]=v[b[S]]}for(var y=Object.keys(m),C=0;C<y.length;C++)m[y[C]]=this.sortRowHeaders(m[y[C]]);if(g[c[f+1]])for(C=0;C<y.length;C++){for(var w=[],x=m[y[C]],T=0;T<x.length;T++){var M=this.tupRowInfo[x[T].ordinal],D=0===M.measurePosition&&3===x[T].memberType?M.measureName:M.uNameCollection;w.push(x[T]),n>-1&&(D=this.frameUniqueName(D,x[T],M));var E=!1;if(u)if(a[A=this.getParentUname(D,x[T],u,!0)]){a[A]=this.sortRowHeaders(a[A]);var O=D.lastIndexOf("::[")===D.indexOf("::[Measures]"),P=D.split("::[").length-1===M.measurePosition,N=!M.drillInfo[M.measurePosition-1].isDrilled,F=M.members.length>M.measurePosition+1;if(O&&P&&N&&F){E=!0;for(var I=0;I<a[A].length;I++){w.push(a[A][I]);var L=D.substring(0,D.indexOf("::[Measures]"))+"::"+a[A][I].actualText;g[c[f+1]][L]&&(w=w.concat(g[c[f+1]][L]))}}else w=w.concat(a[A])}!E&&g[c[f+1]][D]&&(w=w.concat(g[c[f+1]][D]))}m[y[C]]=w}else if(u)for(C=0;C<y.length;C++){for(x=m[y[C]],w=[],T=0;T<x.length;T++){w.push(x[T]);var A;D=this.tupRowInfo[x[T].ordinal].uNameCollection;n>-1&&(D=this.frameUniqueName(D,x[T],this.tupRowInfo[x[T].ordinal])),a[A=this.getParentUname(D,x[T],!0,!0)]&&(a[A]=this.sortRowHeaders(a[A]),w=w.concat(a[A]))}m[y[C]]=w}g[c[f]]=m}var R=0,k=0;r=!1,s=this.sortRowHeaders(s);for(o=this.colDepth;o<t;o++){var j=r?s:g[c[0]].parent,q=r?R-k:R;j[q]&&(this.pivotValues[o]=[j[q]],this.pivotValues[o][0].rowIndex=o,this.valueContent[R][0]=this.pivotValues[o][0]),R++,"grand sum"===this.pivotValues[o][0].type&&(r=!0,k=R)}}},e.prototype.performColumnSorting=function(){if(this.enableSort)for(var e=0;e<this.dataSourceSettings.columns.length;e++){for(var t=[],i=0,a=[],s=0;s<this.pivotValues.length;s++){var r=this.pivotValues[s],n=void 0,o=void 0,l={},d=1;a[i]=[],t[i]=[];var p=1;for(p=p;p<r.length;p++)if(!r[p].isNamedSet){if(2!=r[p].memberType&&"[Measures]"!=r[p].hierarchy&&-1!=r[p].level){if(sf.base.isNullOrUndefined(l[r[p].formattedText])||sf.base.isNullOrUndefined(this.pivotValues[s-1]))l[r[p].formattedText]=l[r[p].formattedText]?l[r[p].formattedText]:[],l[r[p].formattedText][r[p].colIndex]=r[p];else if(l[r[p].formattedText]&&this.pivotValues[s-1]){var h=this.pivotValues[s-1][r[p].colIndex],u=Number(Object.keys(l[r[p].formattedText])[0]),c=l[r[p].formattedText][u].colIndex,g=this.pivotValues[s-1][c];if(h.formattedText!==g.formattedText){var f=Object.keys(l);f=this.sortColumnHeaders(f,this.sortObject[r[p-1].levelUniqueName]||this.sortObject[r[p].hierarchy]),sf.base.isNullOrUndefined(t[i])?t[i]=[]:t[i];for(var m=0;m<f.length;m++)for(var v=Object.keys(l[f[m]]).length,b=0;b<v;b++)d=0===t[i].length?1:0,t[i][t[i].length+d]=l[f[m]][Number(Object.keys(l[f[m]])[b])];(l={})[r[p].formattedText]=[],l[r[p].formattedText][r[p].colIndex]=r[p]}else l[r[p].formattedText][r[p].colIndex]=r[p]}}else if(Object.keys(l).length>0){a[i][a[i].length+d]=r[p],n=Object.keys(l),n=this.sortColumnHeaders(n,this.sortObject[r[p-1].levelUniqueName]||this.sortObject[r[p].hierarchy]),sf.base.isNullOrUndefined(t[i])?t[i]=[]:t[i];for(var S=0;S<n.length;S++)for(var y=Object.keys(l[n[S]]).length,C=0;C<y;C++)d=0===t[i].length?1:0,t[i][t[i].length+d]=l[n[S]][Number(Object.keys(l[n[S]])[C])]}else(-1===r[p].level||0===r[p].level)&&Object.keys(l).length>=0&&"[Measures]"!=r[p].hierarchy&&(a[i][a[i].length+d]=r[p]);if(-1!=r[p].level&&1===Object.keys(l).length&&"[Measures]"!=r[p].hierarchy&&!sf.base.isNullOrUndefined(r[p+1])&&-1===r[p+1].level){var w=Object.keys(l[r[p].formattedText]).length,x=Object.keys(l[r[p].formattedText]);if(w>1)for(var T=0;T<w;T++)d=0===a[i].length?1:0,a[i][a[i].length+d]=l[r[p].formattedText][Number(x[T])];else a[i][a[i].length+d]=r[p]}if(Object.keys(a[i]).length>0){d=0===t[i].length?1:0;var M=a[i].length;if(M>2)for(var D=1;D<M;D++)d=0===t[i].length?1:0,t[i][t[i].length+d]=a[i][D];else t[i][t[i].length+d]=a[i][1]||a[i][0];l={},a[i]=[]}}if(Object.keys(l).length>0){a[i][a[i].length+d]=r[p],o=Object.keys(l);var E=this.sortObject[r[p-1].levelUniqueName]||this.sortObject[r[p-1].hierarchy];n=this.sortColumnHeaders(o,E),sf.base.isNullOrUndefined(t[i])?t[i]=[]:t[i];for(var O=0;O<o.length;O++){var P=Object.keys(l[o[O]]).length;for(C=0;C<P;C++)d=0===t[i].length?1:0,t[i][t[i].length+d]=l[n[O]][Number(Object.keys(l[o[O]])[C])]}}for(var N=1;N<t[i].length;N++)this.pivotValues[i][N]=t[i][N];for(var F=s;F<this.pivotValues.length;F++){var I=sf.base.extend({},this.pivotValues[F+1],null,!0),L=sf.base.extend({},this.pivotValues[F],null,!0);if(Object.keys(I).length===Object.keys(L).length&&Object.keys(I).length>2){for(var A=1;A<this.pivotValues[s].length;A++)Object.keys(I).length>0&&L[A].colIndex!=I[A].colIndex&&(this.pivotValues[F+1][A]=I[L[A].colIndex]);break}}i++,l={}}for(var R=0;R<this.pivotValues.length;R++)for(r=this.pivotValues[R],s=1;s<r.length;s++)r[s].colIndex=s}},e.prototype.frameUniqueName=function(e,t,i){var a=e.indexOf(t.actualText.toString()+"::[Measures]")>-1,s=(e=e.substring(0,e.indexOf(t.actualText.toString()))+t.actualText.toString()).split("::[").length<=this.getMeasurePosition(e,i.measurePosition);return e+=a||s?"::"+i.measureName:""},e.prototype.getMeasurePosition=function(e,t){for(var i=t,a=e.split("::["),s=0;s<a.length;s++)if(a[s]&&a[s].indexOf("Measures")>-1){i=s;break}return i},e.prototype.sortRowHeaders=function(e){if(e.length>0&&3!==e[0].memberType&&!e[0].isNamedSet){var t=this.sortObject[e[0].hierarchy]||this.sortObject[e[0].levelUniqueName];"Ascending"===t||void 0===t?e.sort((function(e,t){return e.formattedText>t.formattedText?1:t.formattedText>e.formattedText?-1:0})):"Descending"===t&&e.sort((function(e,t){return e.formattedText<t.formattedText?1:t.formattedText<e.formattedText?-1:0}))}return e},e.prototype.sortColumnHeaders=function(e,t){return"Ascending"===t||void 0===t?e.sort((function(e,t){return e>t?1:t>e?-1:0})):"Descending"===t&&e.sort((function(e,t){return e<t?1:t<e?-1:0})),e},e.prototype.frameSortObject=function(){if(this.enableSort)for(var e=0;e<this.sortSettings.length;e++)this.sortObject[this.sortSettings[e].name]=this.sortSettings[e].order},e.prototype.getParentUname=function(e,t,i,a){var s="";if(i&&!a){for(var r=this.tupRowInfo[t.ordinal],n=[],o={},l=0;l<e.length;l++)"~"!==e[l]&&":"!==e[l]||(n.push(l),o[l]=e[l]+e[l],l++);if(this.getMeasurePosition(e,r.measurePosition)>=e.split("::[").length-1)s=n[n.length-2]>-1?e.substring(0,n[n.length-2])+o[n[n.length-1]]+r.measureName:"parent";else s=(d=e.lastIndexOf("~~")>e.lastIndexOf("::[")?e.lastIndexOf("~~"):e.lastIndexOf("::["))>-1?e.substring(0,d):"parent"}else{var d;s=(d=e.lastIndexOf("~~")>e.lastIndexOf("::[")?e.lastIndexOf("~~"):e.lastIndexOf("::["))>-1?e.substring(0,d):"parent"}return s},e.prototype.performColumnSpanning=function(){for(var e={},t=this.rowStartPos-1,i=Object.keys(this.colMeasures).length;t>-1;){e[t]={};for(var a=this.pivotValues[t].length-1;a>0;){e[t][a]=1;var s=this.pivotValues[t][a+1],r=this.pivotValues[t+1]&&this.rowStartPos-t>1?this.pivotValues[t+1][a]:void 0,n=this.pivotValues[t][a],o=!1,l=!1,d=this.tupColumnInfo[n.ordinal],p=d.allStartPos>("3"===d.typeCollection[0]?1:0),h=this.checkAttributeDrill(d.drillInfo,"columns");if(r&&s&&(2===n.memberType||-1===n.level?s.actualText===n.actualText:3===n.memberType&&n.actualText===s.actualText||s.valueSort.levelName===n.valueSort.levelName)&&(2===n.memberType?p&&"sum"!==s.type?n.colSpan=1:n.colSpan=s.colSpan+1>(d.measurePosition>t?i:0)?1:s.colSpan+1:(n.colSpan=s.colSpan+1,n.ordinal=s.ordinal),o=!0),2===n.memberType){if(p)h||(n.type="sum"),n.formattedText="Total",n.valueSort[n.valueSort.levelName.toString()]=1;else{var u="Grand Total";r&&i>0&&(u=3===r.memberType?"Grand Total."+r.formattedText:r.valueSort.levelName),n.type="grand sum",n.formattedText="Grand Total",n.valueSort.levelName=u,n.valueSort[u.toString()]=1}n.hasChild=!1}else-1===n.level&&(n.type="sum",n.formattedText="Total",n.hasChild=!1,n.valueSort[n.valueSort.levelName.toString()]=1);r?2===n.memberType&&2===r.memberType||r.actualText===n.actualText?(e[t][a]=e[t+1]?e[t+1][a]+1:1,0===t||1===n.memberType&&n.level>-1&&1===r.memberType&&-1===r.level?(n.rowSpan=!n.isDrilled||this.fieldList[n.hierarchy]&&this.fieldList[n.hierarchy].isHierarchy&&!n.hasChild?e[t+1][a]+1:1,r.rowSpan=!r.isDrilled||this.fieldList[r.hierarchy]&&this.fieldList[r.hierarchy].isHierarchy&&!r.hasChild||-1!==r.level?r.rowSpan:e[t+1][a]):3===n.memberType?n.rowSpan=1:n.rowSpan=-1,l=!0):!n.isDrilled||this.fieldList[n.hierarchy]&&this.fieldList[n.hierarchy].isHierarchy&&!n.hasChild||-1!==n.level||2!==r.memberType?(n.rowSpan=0===t?e[t][a]:-1,r.rowSpan=r.level>-1&&(!r.isDrilled||this.fieldList[r.hierarchy]&&this.fieldList[r.hierarchy].isHierarchy&&!r.hasChild)||2!==n.memberType&&2===r.memberType?e[t+1][a]:1):(e[t][a]=e[t+1]?e[t+1][a]+1:1,n.rowSpan=-1,l=!0):n.rowSpan=n.level>-1||1===this.rowStartPos?e[t][a]:-1,o||(n.colSpan=1),l||(e[t][a]=1),a--}t--}},e.prototype.frameValues=function(e,t){var i=this.colDepth,a=this.pivotValues.length,s=0;if("down"===this.customArgs.action){var r=Object.keys(this.onDemandDrillEngine);i=Number(r[0]),a=Number(r[r.length-1])+1,s=this.onDemandDrillEngine[i][0].ordinal}for(var n={},o=0;o<e.length;o++)n[Number(e[o].getAttribute("CellOrdinal"))]=e[o];for(var l=i;l<a;l++){var d=this.pivotValues[l],p=d[0].ordinal;for(o=1;o<this.pivotValues[0].length;o++)if(this.pivotValues[this.colDepth-1][o]){var h=this.pivotValues[this.colDepth-1][o].ordinal,u=this.pivotValues[this.colDepth-1][o],c=3===d[0].memberType?d[0].actualText.toString():this.tupColumnInfo[u.ordinal]&&this.tupColumnInfo[u.ordinal].measure?this.tupColumnInfo[u.ordinal].measure.querySelector("UName").textContent:d[0].actualText;if("header"===d[0].type)d[o]={axis:"value",actualText:this.getUniqueName(c),formattedText:"",value:0,colIndex:o,rowIndex:l};else{var g,f=void 0,m=void 0,v=this.getUniqueName(c),b=!0,S=this.fieldList[d[0].hierarchy]&&this.fieldList[d[0].hierarchy].isHierarchy&&d[0].isDrilled;b=this.tupRowInfo[p]?this.tupRowInfo[p].showTotals:this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showRowGrandTotals,f=n[(p-s)*t+h],m=!b&&S?"":sf.base.isNullOrUndefined(f)||sf.base.isNullOrUndefined(f.querySelector("FmtValue"))?this.emptyCellTextContent:f.querySelector("FmtValue").textContent,g=!b&&S?"0":sf.base.isNullOrUndefined(f)||sf.base.isNullOrUndefined(f.querySelector("Value"))?null:f.querySelector("Value").textContent,m=b&&!sf.base.isNullOrUndefined(g)?this.getFormattedValue(Number(g),v,""!==m?m:g):m;var y=!this.tupColumnInfo[h]||(this.tupColumnInfo[h].allCount>0||this.tupColumnInfo[h].drillStartPos>-1)||!this.tupRowInfo[p]||this.tupRowInfo[p].allCount>0||this.tupRowInfo[p].drillStartPos>-1,C=!!this.tupRowInfo[p]&&(0===this.tupRowInfo[p].measurePosition?1===this.tupRowInfo[p].allStartPos:0===this.tupRowInfo[p].allStartPos)||!!this.tupColumnInfo[h]&&(0===this.tupColumnInfo[h].measurePosition?1===this.tupColumnInfo[h].allStartPos:0===this.tupColumnInfo[h].allStartPos);d[o]={axis:"value",actualText:v,formattedText:m,colOrdinal:h,rowOrdinal:p,columnHeaders:this.tupColumnInfo[h]?this.tupColumnInfo[h].captionCollection:"",rowHeaders:this.tupRowInfo[p]?this.tupRowInfo[p].captionCollection:"",value:sf.base.isNullOrUndefined(g)?null:Number(g),colIndex:o,rowIndex:l,isSum:y,isGrandSum:C}}this.valueContent[l-this.rowStartPos][o]=d[o]}}},e.prototype.getFormattedValue=function(e,t,i){var a=i;if(this.formatFields[t]&&!sf.base.isNullOrUndefined(e)){var s=this.formatFields[t].properties?this.formatFields[t].properties:this.formatFields[t],r=sf.base.extend({},s,null,!0);if(delete r.name,!r.minimumSignificantDigits&&r.minimumSignificantDigits<1&&delete r.minimumSignificantDigits,!r.maximumSignificantDigits&&r.maximumSignificantDigits<1&&delete r.maximumSignificantDigits,r.type)a=this.globalize.formatDate(new Date(e.toString()),r);else{if(delete r.type,r.format&&!this.formatRegex.test(r.format)){var n=r.format.match(this.customRegex)[6];r.useGrouping=-1!==n.indexOf(",")}a=this.globalize.formatNumber(e,r)}}return a},e.prototype.getMeasureInfo=function(){for(var e,t="column",i=[],a=0,s=this.values;a<s.length;a++){var r=s[a];i[i.length]=r.isCalculatedField?this.fieldList[r.name].tag:r.name}if(i.length>1){if(this.isMeasureAvail){for(var n=!1,o=0,l=this.rows.length;o<l;o++)if("[measures]"===this.rows[o].name.toLowerCase()){t="row",e=o,n=!0;break}if(!n)for(o=0,l=this.columns.length;o<l;o++)if("[measures]"===this.columns[o].name.toLowerCase()){t="column",e=o,n=!0;break}}else e="row"===(t=this.valueAxis)?this.rows.length-1:this.columns.length-1;return{measureAxis:t,measureIndex:e,valueInfo:i}}return{measureAxis:t,measureIndex:-1,valueInfo:[]}},e.prototype.frameMeasureOrder=function(e,t,i,a,s){var r=[],n=[],o=[],l={},d=[],p=e.measureAxis,h=e.measureIndex,u=e.valueInfo;if(p===t&&u.length>0){for(var c={},g=[],f=0,m=i.length;f<m;f++){for(var v=i[f],b=[].slice.call(v.querySelectorAll("Member")),S="",y="",C=0;C<b.length;)S=S+(""!==S?"~~":"")+b[C].querySelector("UName").textContent,(C===h&&0===h||C===h-1)&&(y=S),C++;c[y]?c[y][c[y].length]=S:(c[y]=[S],g[g.length]=y),l[S]={index:f,node:v},d[d.length]=S}if(d.length>0&&g.length>0)if(0===h)for(var w=0,x=u;w<x.length;w++)for(var T=x[w],M=0,D=g;M<D.length;M++){if((F=D[M])===T)for(var E=0,O=c[F];E<O.length;E++){S=O[E];o[o.length]=l[S].index,r[r.length]=l[S].node}}else for(var P=0,N=g;P<N.length;P++)for(var F=N[P],I=0,L=u;I<L.length;I++)for(var A=L[I],R=0,k=c[F];R<k.length;R++){(S=k[R]).split("~~")[h]===A&&(o[o.length]=l[S].index,r[r.length]=l[S].node)}if(a.length>0){for(var j=[],q=[],V=0,B=0,_=(f=0,a.length);f<_;f++)V>s-1?(V=0,j[++B]||(j[B]=[]),j[B][V]=f,V++):(j[B]||(j[B]=[]),j[B][V]=f,V++),q[q.length]=Number(a[f].getAttribute("CellOrdinal"));if("column"===p){if(j.length>0&&j[0].length===o.length)for(C=0,_=o.length;C<_;C++)for(f=0;f<j.length;){var H=q[U=f*s+C].toString();(G=a[Number(j[f][o[C]])]).setAttribute("CellOrdinal",H.toString()),n[U]=G,f++}}else if(j.length===o.length)for(C=0,_=o.length;C<_;C++)for(f=0;f<j[o[C]].length;){var U,G;H=q[U=C*s+f].toString();(G=a[Number(j[o[C]][f])]).setAttribute("CellOrdinal",H.toString()),n[n.length]=G,f++}}return{orderedHeaderTuples:r,orderedValueTuples:n}}return{orderedHeaderTuples:i,orderedValueTuples:a}},e.prototype.getDrilledSets=function(e,t,i,a){for(var s=[],r=t.actualText.toString(),n="row"===a?this.tupRowInfo:this.tupColumnInfo,o=n[t.ordinal],l=0===n[0].typeCollection.indexOf("3")?1:0,d=0,p="1"===n[0].typeCollection[i];d<n.length;)(sf.base.isNullOrUndefined(n[d].allStartPos)||n[d].allStartPos>l)&&(s[s.length]=n[d].uNameCollection),d++;for(var h=e.split("::[").map((function(e){return"["===e[0]?e:"["+e})),u=[],c=0;c<=i;c++)if(h[c])if((p||this.isPaging)&&c===i){for(var g=h[c].split("~~"),f=g.indexOf(r),m=[],v=0;v<=f;v++)m.push(g[v]);u[u.length]=m.length>0?m.join("~~"):h[c]}else u[u.length]=h[c];e=u.join("::");for(var b=[],S={},y=0,C=s;y<C.length;y++){var w=C[y];if(0===w.indexOf(e)&&(b.push(w),this.isPaging))for(var x=w.split("::[")[i],T=(E=(x="["===x[0]?x:"["+x).split("~~")).indexOf(r);T<E.length;T++)S[E[T]]=E[T]}if(this.isPaging){var M=o.uNameCollection.split("::[").map((function(e){return"["===e[0]?e:"["+e})),D=[];for(T=0;T<M.length;T++)T!==i&&(D[T]=M[T]);var E=Object.keys(S);for(T=0;T<E.length;T++)D[i]=E[T],b.push(D.join("::"))}for(var O={},P=0,N=b;P<N.length;P++){for(var F=N[P].split("::[").map((function(e){return"["===e[0]?e:"["+e})),I="",L=0;L<=i;L++){var A=F[L];if(A){var R=A.split("~~");I=I+(""!==I?"~~":"")+R[R.length-1]}}O[I]=I}return O},e.prototype.updateDrilledInfo=function(e){this.dataSourceSettings=e,this.drilledMembers=e.drilledMembers?this.updateDrilledItems(e.drilledMembers):[],this.generateGridData(e)},e.prototype.updateCalcFields=function(e,t){this.dataSourceSettings=e,this.calculatedFieldSettings=e.calculatedFieldSettings?e.calculatedFieldSettings:[],this.getAxisFields(),this.updateFieldlist(),this.loadCalculatedMemberElements(this.calculatedFieldSettings),this.dataFields[t.name]?this.generateGridData(e):Xe.getCellSets(e,this,!0,void 0,!0)},e.prototype.onSort=function(e){this.dataSourceSettings=e,this.sortSettings=e.sortSettings?e.sortSettings:[],this.getAxisFields(),this.frameSortObject(),this.updateFieldlist(),this.xmlaCellSet.length>0&&this.xmlDoc?this.generateEngine(this.xmlDoc,this.request,this.customArgs):this.generateGridData(e)},e.prototype.updateFieldlist=function(e){for(var t=0;t<this.savedFieldListData.length;){var i=this.savedFieldListData[t].id,a=this.savedFieldListData[t].pid;if(this.savedFieldList[i]){var s=this.enableSort?this.sortObject[i]?this.sortObject[i]:"Ascending":"None";this.savedFieldList[i].isSelected=!1,this.savedFieldList[i].isExcelFilter=!1,this.savedFieldList[i].sort=s,this.savedFieldList[i].allowDragAndDrop=!0,this.savedFieldList[i].showFilterIcon=!0,this.savedFieldList[i].showSortIcon=!0,this.savedFieldList[i].showEditIcon=!0,this.savedFieldList[i].showRemoveIcon=!0,this.savedFieldList[i].showValueTypeIcon=!0,this.savedFieldList[i].showSubTotals=!0,this.savedFieldListData[t].sort=s,this.savedFieldListData[t].allowDragAndDrop=!0,this.savedFieldListData[t].showFilterIcon=!0,this.savedFieldListData[t].showSortIcon=!0,this.savedFieldListData[t].showEditIcon=!0,this.savedFieldListData[t].showRemoveIcon=!0,this.savedFieldListData[t].showValueTypeIcon=!0,this.savedFieldListData[t].showSubTotals=!0,e&&(this.savedFieldList[i].filter=[],this.savedFieldList[i].actualFilter=[])}if(this.dataFields[i]&&this.savedFieldList[i]&&this.selectedItems.indexOf(i)>-1?(this.savedFieldList[i].isSelected=!0,this.savedFieldList[i].allowDragAndDrop=!this.dataFields[i]||this.dataFields[i].allowDragAndDrop,this.savedFieldList[i].showFilterIcon=!this.dataFields[i]||this.dataFields[i].showFilterIcon,this.savedFieldList[i].showSortIcon=!this.dataFields[i]||this.dataFields[i].showSortIcon,this.savedFieldList[i].showEditIcon=!this.dataFields[i]||this.dataFields[i].showEditIcon,this.savedFieldList[i].showRemoveIcon=!this.dataFields[i]||this.dataFields[i].showRemoveIcon,this.savedFieldList[i].showValueTypeIcon=!this.dataFields[i]||this.dataFields[i].showValueTypeIcon,this.savedFieldList[i].showSubTotals=!this.dataFields[i]||this.dataFields[i].showSubTotals,this.savedFieldListData[t].isSelected=!0,this.savedFieldListData[t].allowDragAndDrop=!this.dataFields[i]||this.dataFields[i].allowDragAndDrop,this.savedFieldListData[t].showFilterIcon=!this.dataFields[i]||this.dataFields[i].showFilterIcon,this.savedFieldListData[t].showSortIcon=!this.dataFields[i]||this.dataFields[i].showSortIcon,this.savedFieldListData[t].showEditIcon=!this.dataFields[i]||this.dataFields[i].showEditIcon,this.savedFieldListData[t].showRemoveIcon=!this.dataFields[i]||this.dataFields[i].showRemoveIcon,this.savedFieldListData[t].showValueTypeIcon=!this.dataFields[i]||this.dataFields[i].showValueTypeIcon,this.savedFieldListData[t].showSubTotals=!this.dataFields[i]||this.dataFields[i].showSubTotals):this.dataFields[a]&&this.savedFieldList[a]&&this.selectedItems.indexOf(a)>-1?this.savedFieldListData[t].isSelected=!0:this.savedFieldListData[t].isSelected=!1,this.savedFieldList[i]&&this.savedFieldList[i].isCalculatedField||"[calculated members].[_0]"===i.toLowerCase()){for(var r=!1,n=0,o=this.calculatedFieldSettings;n<o.length;n++){var l=o[n];if(i===l.name){var d=l.formula,p=l.formatString;this.savedFieldListData[t].formula=d,this.savedFieldListData[t].formatString=p,this.savedFieldListData[t].parentHierarchy=d.toLowerCase().indexOf("measure")>-1?void 0:l.hierarchyUniqueName,this.savedFieldList[i].formula=d,this.savedFieldList[i].formatString=p,this.savedFieldList[i].parentHierarchy=this.savedFieldListData[t].parentHierarchy,r=!0}}(!r||"[calculated members].[_0]"===i.toLowerCase()&&0===this.calculatedFieldSettings.length)&&(this.savedFieldListData.splice(t,1),t--,this.savedFieldList[i]&&delete this.savedFieldList[i])}t++}this.fieldList=this.savedFieldList,this.fieldListData=this.savedFieldListData},e.prototype.updateFieldlistData=function(e,t){for(var i=0,a=this.fieldListData;i<a.length;i++){var s=a[i];if(s.id===e){s.isSelected=!!t;break}}},e.prototype.getFormattedFields=function(e){this.formatFields={};for(var t=e.length;t--;)this.formatFields[e[t].name]=e[t]},e.prototype.getFieldList=function(e){var t={catalog:e.catalog,cube:e.cube,url:e.url,LCID:e.localeIdentifier.toString(),request:"MDSCHEMA_HIERARCHIES"};this.getTreeData(t,this.getFieldListItems.bind(this),{dataSourceSettings:e,action:"loadFieldElements"})},e.prototype.getTreeData=function(e,t,i){var a=this.getConnectionInfo(e.url,e.LCID),s='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>'+e.request+"</RequestType><Restrictions><RestrictionList><CATALOG_NAME>"+e.catalog+"</CATALOG_NAME><CUBE_NAME>"+e.cube+"</CUBE_NAME></RestrictionList></Restrictions><Properties><PropertyList><Catalog>"+e.catalog+"</Catalog> <LocaleIdentifier>"+a.LCID+"</LocaleIdentifier></PropertyList></Properties></Discover></Body></Envelope>";this.doAjaxPost("POST",a.url,s,t,i)},e.prototype.getAxisFields=function(){this.rows=this.dataSourceSettings.rows?this.dataSourceSettings.rows:[],this.columns=this.dataSourceSettings.columns?this.dataSourceSettings.columns:[],this.filters=this.dataSourceSettings.filters?this.dataSourceSettings.filters:[],this.values=this.dataSourceSettings.values?this.dataSourceSettings.values:[];for(var e=sf.base.extend([],this.rows,null,!0),t=(e=e.concat(this.columns,this.values,this.filters)).length;t--;)this.dataFields[e[t].name]=e[t],"[measures]"===e[t].name.toLowerCase()?this.isMeasureAvail=!0:this.selectedItems.push(e[t].name);if(this.mappingFields={},this.dataSourceSettings.fieldMapping)for(var i=0,a=this.dataSourceSettings.fieldMapping;i<a.length;i++){var s=a[i];this.mappingFields[s.name]=s}if(!this.isMeasureAvail&&this.values.length>0){var r={name:"[Measures]",caption:"Measures",showRemoveIcon:!0,allowDragAndDrop:!0};"row"===this.valueAxis?this.rows.push(r):this.columns.push(r),this.isMeasureAvail=!0}},e.prototype.getAggregateType=function(e,t){var i;switch(t){case"1":i="Sum";break;case"2":i="Count";break;case"3":i="Min";break;case"4":i="Max";break;case"5":i="Avg";break;case"8":i="DistinctCount";break;case"127":i="CalculatedField";break;default:i=void 0}return i||void 0},e.prototype.getUniqueName=function(e){for(var t=e,i=0,a=this.calculatedFieldSettings;i<a.length;i++){var s=a[i];if(e===(s.formula.toLowerCase().indexOf("measure")>-1?"[Measures].":s.hierarchyUniqueName+".")+"["+s.name+"]"){t=s.name;break}}return t},e.prototype.updateFilterItems=function(e){var t=sf.base.extend([],this.rows,null,!0);t=t.concat(this.columns);for(var i=0,s=e;i<s.length;i++){var n=s[i];if("Include"===n.type&&this.allowMemberFilter){var o=this.fieldList[n.name].members,l=o&&Object.keys(o).length>0;this.fieldList[n.name].actualFilter=n.items.slice();var d=sf.base.extend([],n.items,null,!0);if(l)for(var p=0;p<d.length;){for(var h=[],u=0,c=h=this.getParentNode(d[p],o,h);u<c.length;u++){var g=c[u],f=r.inArray(g,n.items);-1!==f&&n.items.splice(f,1)}p++}for(var m=[],v=0,b=n.items;v<b.length;v++){var S=b[v];m.push(S),l?this.fieldList[n.name].filter.push(o[S].caption):this.fieldList[n.name].filter.push(S)}this.filterMembers[n.name]=m,this.fieldList[n.name].isExcelFilter=!1}else if((this.allowValueFilter||this.allowLabelFilter)&&-1!==["Date","Label","Number","Value"].indexOf(n.type))for(var y=0,C=t;y<C.length;y++){if(C[y].name===n.name){var w=this.filterMembers[n.name];w&&"object"===a(w[0])&&w[0].type===n.type?w[w.length]=n:this.filterMembers[n.name]=[n],this.fieldList[n.name].isExcelFilter=!0;break}}}},e.prototype.getParentNode=function(e,t,i){if(t[e].parent&&e!==t[e].parent){var a=t[e].parent;i.push(a),this.getParentNode(a,t,i)}return i},e.prototype.updateDrilledItems=function(e){var t=[],i=sf.base.extend([],this.rows,null,!0);i=i.concat(this.columns);for(var a=0,s=e;a<s.length;a++)for(var r=s[a],n=0,o=i;n<o.length;n++){var l=o[n];if(r.name===l.name){t.push(r);break}}return t},e.prototype.getDrillThroughData=function(e,t){for(var i,a=this.tupColumnInfo[e.colOrdinal]&&this.tupColumnInfo[e.colOrdinal].uNameCollection&&""!==this.tupColumnInfo[e.colOrdinal].uNameCollection?this.tupColumnInfo[e.colOrdinal].uNameCollection.split("::[").map((function(e){return"["===e[0]?e:"["+e})):[],s=this.tupRowInfo[e.rowOrdinal]&&this.tupRowInfo[e.rowOrdinal].uNameCollection&&""!==this.tupRowInfo[e.rowOrdinal].uNameCollection?this.tupRowInfo[e.rowOrdinal].uNameCollection.split("::[").map((function(e){return"["===e[0]?e:"["+e})):[],r=[],n="",o=0;o<this.filters.length;o++)if(i=this.filterMembers[this.filters[o].name]){for(var l=0;l<i.length;l++)n+=i[l],n=l<i.length-1?n+",":n+"";r[o]=n,n=""}for(o=0;o<r.length;o++)n=""===n?"{"+r[o]+"}":n+",{"+r[o]+"}";var d="",p="";for(o=0;o<a.length;o++)d=(d.length>0?d+",":"")+(a[o].split("~~").length>1?a[o].split("~~")[a[o].split("~~").length-1]:a[o]);for(o=0;o<s.length;o++)p=(p.length>0?p+",":"")+(s[o].split("~~").length>1?s[o].split("~~")[s[o].split("~~").length-1]:s[o]);var h="DRILLTHROUGH MAXROWS "+t+" Select("+(d.length>0?d:"")+(d.length>0&&p.length>0?",":"")+(p.length>0?p:"")+") on 0 from "+(""===n?"["+this.dataSourceSettings.cube+"]":"(SELECT ("+n+") ON COLUMNS FROM ["+this.dataSourceSettings.cube+"])");h=h.replace(/&/g,"&amp;");var u=this.getSoapMsg(this.dataSourceSettings,h),c=this.getConnectionInfo(this.dataSourceSettings.url,this.dataSourceSettings.localeIdentifier);this.doAjaxPost("POST",c.url,u,this.drillThroughSuccess.bind(this),{dataSourceSettings:this.dataSourceSettings,action:"drillThrough"})},e.prototype.drillThroughSuccess=function(e){var t=[].slice.call(e.querySelectorAll("row")),i="";if(t.length>0){for(var a=[],s=0;s<t.length;){for(var r=[].slice.call(t[s].children),n=0;n<r.length;)a.push('"'+r[n].tagName+'":"'+r[n].textContent+'"'),n++;s++}for(var o=a[0],l=0;l<a.length;)Object.keys(JSON.parse("[{"+a[l]+"}]")[0])[0]!==Object.keys(JSON.parse("[{"+o+"}]")[0])[0]?(i+=","+a[l],l++):(i+=""===i?"[{"+a[l]:"}, {"+a[l],l++);i+="}]"}else{var d=[].slice.call(e.querySelectorAll("faultstring"));for(s=0;s<d.length;)i+=d[s].textContent,s++}this.gridJSON=i},e.prototype.getFilterMembers=function(e,t,i,a,s){var r,n=this.fieldList[t].levels,o=this.fieldList[t].levelCount;return r=s?"Descendants({"+n[o].id+"}, "+n[i-1].id+", "+(i-o==1?"SELF)":"SELF_AND_BEFORE)"):t+", Descendants({"+n[0].id+"}, "+n[i-1].id+", SELF_AND_BEFORE)",this.fieldList[t].levelCount=i,a||this.getMembers(e,t,!1,r,s),r},e.prototype.getMembers=function(e,t,i,a,s){var r,n="DIMENSION PROPERTIES PARENT_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, CHILDREN_CARDINALITY, MEMBER_TYPE, MEMBER_VALUE",o=this.fieldList[t].hasAllMember,l=(o?t:t+".LEVELS(0)").replace(/\&/g,"&amp;");r=i?"SELECT ({"+l+".ALLMEMBERS})"+n+" ON 0 FROM ["+e.cube+"]":"SELECT ({"+(a||(o?l+", "+l+".CHILDREN":l+".ALLMEMBERS"))+"})"+n+" ON 0 FROM ["+e.cube+"]";var d=this.getSoapMsg(e,r),p=this.getConnectionInfo(e.url,e.localeIdentifier);s||(this.fieldList[t].filterMembers=[],this.fieldList[t].childMembers=[],this.fieldList[t].searchMembers=[],this.fieldList[t].members={},this.fieldList[t].currrentMembers={}),this.doAjaxPost("POST",p.url,d,this.generateMembers.bind(this),{dataSourceSettings:e,fieldName:t,loadLevelMembers:s,action:"fetchMembers"})},e.prototype.getChildMembers=function(e,t,i){var a="SELECT ({"+t.replace(/\&/g,"&amp;")+".CHILDREN})DIMENSION PROPERTIES PARENT_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, CHILDREN_CARDINALITY, MEMBER_TYPE, MEMBER_VALUE ON 0 FROM ["+e.cube+"]",s=this.getSoapMsg(e,a),r=this.getConnectionInfo(e.url,e.localeIdentifier);this.doAjaxPost("POST",r.url,s,this.generateMembers.bind(this),{dataSourceSettings:e,fieldName:i,action:"fetchChildMembers"})},e.prototype.getCalcChildMembers=function(e,t){this.calcChildMembers=[];var i="SELECT ({"+t.replace(/\&/g,"&amp;")+".MEMBERS})DIMENSION PROPERTIES PARENT_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, CHILDREN_CARDINALITY, MEMBER_TYPE, MEMBER_VALUE ON 0 FROM ["+e.cube+"]",a=this.getConnectionInfo(e.url,e.localeIdentifier),s=this.getSoapMsg(e,i);this.doAjaxPost("POST",a.url,s,this.generateMembers.bind(this),{dataSourceSettings:e,action:"fetchCalcChildMembers"})},e.prototype.getSearchMembers=function(e,t,i,a,s,r){if(this.fieldList[t].searchMembers=[],this.fieldList[t].currrentMembers={},""!==i){var n=t.replace(/\&/g,"&amp;"),o="WITH SET [SearchMembersSet] AS &#39;FILTER("+(s?n+".ALLMEMBERS, ":"{"+(r>1?this.getFilterMembers(e,t,r,!0):n+", "+n+".CHILDREN")+"},")+"(INSTR(1, "+n+'.CurrentMember.member_caption, "'+i+'") > 0))&#39;SET [SearchParentsSet] AS &#39;GENERATE([SearchMembersSet], ASCENDANTS([SearchMembersSet].Current))&#39;SET [SearchSet] AS &#39;HIERARCHIZE(DISTINCT({[SearchMembersSet], [SearchParentsSet]}))&#39;SELECT SUBSET([SearchSet], 0, '+a+")DIMENSION PROPERTIES PARENT_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, CHILDREN_CARDINALITY, MEMBER_TYPE, MEMBER_VALUE ON 0 FROM ["+e.cube+"]",l=this.getSoapMsg(e,o),d=this.getConnectionInfo(e.url,e.localeIdentifier);this.doAjaxPost("POST",d.url,l,this.generateMembers.bind(this),{dataSourceSettings:e,fieldName:t,action:"fetchSearchMembers"})}},e.prototype.generateMembers=function(e,t,i){for(var a,s=[].slice.call(e.querySelectorAll('Axis[name="Axis0"] Tuple')),r=i.fieldName,n={},o=0,l=s;o<l.length;o++){var d=l[o],p=d.querySelector("Member"),h=p.querySelector("MEMBER_TYPE").textContent,u=p.querySelector("UName").textContent,c=p.querySelector("Caption").textContent,g={"data-fieldName":r},f=p.querySelector("PARENT_UNIQUE_NAME")?p.querySelector("PARENT_UNIQUE_NAME").textContent:"";if(""===f&&"1"===h)n={hasChildren:!!d.querySelector("CHILDREN_CARDINALITY")&&"0"!==d.querySelector("CHILDREN_CARDINALITY").textContent,isSelected:!1,id:u,tag:u,name:c,caption:c,htmlAttributes:g},"fetchMembers"===i.action||"fetchChildMembers"===i.action?(this.fieldList[r].members[u]={name:u,caption:c,parent:void 0,isNodeExpand:!1,isSelected:!1},this.fieldList[r].filterMembers.push(n),this.fieldList[r].childMembers.push(n)):"fetchSearchMembers"===i.action?(this.fieldList[r].currrentMembers[u]={name:u,caption:c,parent:void 0,isNodeExpand:!1,isSelected:!1},this.fieldList[r].searchMembers.push(n),n.expanded=!0):this.calcChildMembers.push(n);else if(""!==f&&"1"===h)if(f===a&&"1"===h)n={hasChildren:!!d.querySelector("CHILDREN_CARDINALITY")&&"0"!==d.querySelector("CHILDREN_CARDINALITY").textContent,id:u,name:c,isSelected:!1,caption:c,htmlAttributes:g,tag:u},"fetchMembers"===i.action||"fetchChildMembers"===i.action?(this.fieldList[r].filterMembers.push(n),this.fieldList[r].childMembers.push(n),this.fieldList[r].members[u]={name:u,caption:c,parent:void 0,isNodeExpand:!1,isSelected:!1}):"fetchSearchMembers"===i.action?(n.expanded=!0,this.fieldList[r].searchMembers.push(n),this.fieldList[r].currrentMembers[u]={name:u,caption:c,parent:void 0,isNodeExpand:!1,isSelected:!1}):this.calcChildMembers.push(n);else{if("fetchMembers"===i.action&&this.fieldList[r].members[u])continue;var m=!!i.loadLevelMembers&&this.fieldList[r].members[f].isSelected;n={hasChildren:!!d.querySelector("CHILDREN_CARDINALITY")&&"0"!==d.querySelector("CHILDREN_CARDINALITY").textContent,htmlAttributes:g,isSelected:!1,id:u,pid:f,name:c,caption:c,tag:u},"fetchMembers"===i.action||"fetchChildMembers"===i.action?(this.fieldList[r].isHierarchy=!1,this.fieldList[r].filterMembers.push(n),this.fieldList[r].childMembers.push(n),this.fieldList[r].members[u]={name:u,caption:c,parent:f,isNodeExpand:!1,isSelected:m}):"fetchSearchMembers"===i.action?(this.fieldList[r].searchMembers.push(n),n.expanded=!0,this.fieldList[r].currrentMembers[u]={name:u,caption:c,parent:f,isNodeExpand:!1,isSelected:!1}):this.calcChildMembers.push(n)}else"2"===h&&(a=u)}},e.prototype.getFieldListItems=function(e,t,i){for(var a,s=[],r=0,n=[].slice.call(e.querySelectorAll("row"));r<n.length;r++){var o=n[r],l=[].slice.call(o.querySelectorAll("ALL_MEMBER")).length>0;s.push({pid:o.querySelector("DIMENSION_UNIQUE_NAME").textContent,id:o.querySelector("HIERARCHY_UNIQUE_NAME").textContent,name:o.querySelector("HIERARCHY_CAPTION").textContent,caption:o.querySelector("HIERARCHY_CAPTION").textContent,tag:o.querySelector("HIERARCHY_UNIQUE_NAME").textContent,hasAllMember:l,allMember:l?o.querySelectorAll("ALL_MEMBER")[0].textContent:void 0,type:"string"})}a={hierarchy:s,hierarchySuccess:e,measures:[]},this.fieldListObj=a;var d={catalog:i.dataSourceSettings.catalog,cube:i.dataSourceSettings.cube,url:i.dataSourceSettings.url,LCID:i.dataSourceSettings.localeIdentifier.toString(),request:"MDSCHEMA_DIMENSIONS"};this.getTreeData(d,this.loadDimensionElements.bind(this),i)},e.prototype.loadCalculatedMemberElements=function(e){if(e.length>0){var t=this.fieldListData,i={hasChildren:!0,isSelected:!1,id:"[Calculated Members].[_0]",name:"[Calculated Members].[_0]",caption:"Calculated Members",spriteCssClass:"e-calcMemberGroupCDB "+f,tag:"[Calculated Members].[_0]",type:"string"};t.length>0&&"[measures]"===t[0].id.toLowerCase()&&t.splice(0,0,i);for(var a=0,s=e;a<s.length;a++){var r=s[a];if(!this.fieldList[r.name]){var n=r.formula,o=(n.toLowerCase().indexOf("measure")>-1?"[Measures].":r.hierarchyUniqueName+".")+"["+r.name+"]",l=this.dataFields[r.name]&&this.dataFields[r.name].caption?this.dataFields[r.name].caption:this.mappingFields[r.name]&&this.mappingFields[r.name].caption?this.mappingFields[r.name].caption:r.name,d=r.formatString,p={hasChildren:!1,isSelected:!1,id:r.name,pid:"[Calculated Members].[_0]",name:r.name,caption:l,spriteCssClass:"e-calc-member "+(n.toLowerCase().indexOf("measure")>-1?"e-calc-measure-icon":"e-calc-dimension-icon")+" "+f,tag:o,formula:n,formatString:d,aggregateType:void 0,type:"CalculatedField",filter:[],dateMember:[],sort:"Ascending",actualFilter:[],filterMembers:[],childMembers:[],searchMembers:[],members:{},currrentMembers:{},isHierarchy:!0,isExcelFilter:!1,isCalculatedField:!0,allowDragAndDrop:this.dataFields[r.name]?this.dataFields[r.name].allowDragAndDrop:!this.mappingFields[r.name]||this.mappingFields[r.name].allowDragAndDrop,showFilterIcon:this.dataFields[r.name]?this.dataFields[r.name].showFilterIcon:!this.mappingFields[r.name]||this.mappingFields[r.name].showFilterIcon,showSortIcon:this.dataFields[r.name]?this.dataFields[r.name].showSortIcon:!this.mappingFields[r.name]||this.mappingFields[r.name].showSortIcon,showEditIcon:this.dataFields[r.name]?this.dataFields[r.name].showEditIcon:!this.mappingFields[r.name]||this.mappingFields[r.name].showEditIcon,showRemoveIcon:this.dataFields[r.name]?this.dataFields[r.name].showRemoveIcon:!this.mappingFields[r.name]||this.mappingFields[r.name].showRemoveIcon,showValueTypeIcon:this.dataFields[r.name]?this.dataFields[r.name].showValueTypeIcon:!this.mappingFields[r.name]||this.mappingFields[r.name].showValueTypeIcon,showSubTotals:this.dataFields[r.name]?this.dataFields[r.name].showSubTotals:!this.mappingFields[r.name]||this.mappingFields[r.name].showSubTotals,fieldType:n.toLowerCase().indexOf("measure")>-1?"Measure":"Dimension",parentHierarchy:n.toLowerCase().indexOf("measure")>-1?void 0:r.hierarchyUniqueName};t.push(p),this.fieldList[p.id]=p}}}},e.prototype.loadDimensionElements=function(e,t,i){for(var a=[],s=[].slice.call(e.querySelectorAll("row")),r={},n=0,o=s;n<o.length;n++){var l=o[n],d=l.querySelector("DIMENSION_UNIQUE_NAME").textContent,p=l.querySelector("DIMENSION_CAPTION").textContent;d.toLowerCase().indexOf("[measure")>=0?r={hasChildren:!0,isSelected:!1,id:d,name:d,caption:p,spriteCssClass:"[measures]"===d.toLowerCase()?"e-measureGroupCDB-icon "+f:"e-dimensionCDB-icon "+f,tag:d,type:"string"}:sf.base.isNullOrUndefined(s[0].querySelector("HIERARCHY_CAPTION"))&&a.push({hasChildren:!0,isSelected:!1,id:this.isMondrian?d+"~#^Dim":d,name:d,caption:p,spriteCssClass:"e-dimensionCDB-icon "+f,tag:d,defaultHierarchy:l.querySelector("DEFAULT_HIERARCHY").textContent,type:"string"})}a.splice(0,0,r),this.fieldListData=a;var h={catalog:i.dataSourceSettings.catalog,cube:i.dataSourceSettings.cube,url:i.dataSourceSettings.url,LCID:i.dataSourceSettings.localeIdentifier.toString(),request:"MDSCHEMA_SETS"};this.getTreeData(h,this.loadNamedSetElements.bind(this),i)},e.prototype.loadNamedSetElements=function(e,t,i){var a=sf.base.extend([],this.rows,null,!0);a=a.concat(this.columns,this.filters);for(var s=this.fieldListData,r=[],n=0,o=a;n<o.length;n++){var l=o[n];r.push(l.name)}for(var d=[],p=0,h=[].slice.call(e.querySelectorAll("row"));p<h.length;p++){l=h[p];d.indexOf(l.querySelector("DIMENSIONS").textContent.split(".")[0])>=0||(s.push({hasChildren:!0,isSelected:!1,pid:l.querySelector("DIMENSIONS").textContent.split(".")[0],id:l.querySelector("SET_DISPLAY_FOLDER").textContent+"_"+l.querySelector("DIMENSIONS").textContent.split(".")[0],name:l.querySelector("SET_DISPLAY_FOLDER").textContent,spriteCssClass:"e-folderCDB-icon "+f+" namedSets",caption:l.querySelector("SET_DISPLAY_FOLDER").textContent,type:"string"}),d.push(l.querySelector("DIMENSIONS").textContent.split(".")[0]));var u="["+l.querySelector("SET_NAME").textContent.trim()+"]",c={hasChildren:!0,isNamedSets:!0,isSelected:r.indexOf("["+l.querySelector("SET_NAME").textContent+"]")>=0,pid:l.querySelector("SET_DISPLAY_FOLDER").textContent+"_"+l.querySelector("DIMENSIONS").textContent.split(".")[0],id:u,name:l.querySelector("SET_CAPTION").textContent,caption:this.dataFields[u]&&this.dataFields[u].caption?this.dataFields[u].caption:this.mappingFields[u]&&this.mappingFields[u].caption?this.mappingFields[u].caption:l.querySelector("SET_CAPTION").textContent,spriteCssClass:"e-namedSetCDB-icon "+f,tag:l.querySelector("EXPRESSION").textContent,type:"string",filter:[],dateMember:[],actualFilter:[],filterMembers:[],childMembers:[],searchMembers:[],members:{},currrentMembers:{},isHierarchy:!0,isExcelFilter:!1,allowDragAndDrop:this.dataFields[u]?this.dataFields[u].allowDragAndDrop:!this.mappingFields[u]||this.mappingFields[u].allowDragAndDrop,showFilterIcon:this.dataFields[u]?this.dataFields[u].showFilterIcon:!this.mappingFields[u]||this.mappingFields[u].showFilterIcon,showSortIcon:this.dataFields[u]?this.dataFields[u].showSortIcon:!this.mappingFields[u]||this.mappingFields[u].showSortIcon,showEditIcon:this.dataFields[u]?this.dataFields[u].showEditIcon:!this.mappingFields[u]||this.mappingFields[u].showEditIcon,showRemoveIcon:this.dataFields[u]?this.dataFields[u].showRemoveIcon:!this.mappingFields[u]||this.mappingFields[u].showRemoveIcon,showValueTypeIcon:this.dataFields[u]?this.dataFields[u].showValueTypeIcon:!this.mappingFields[u]||this.mappingFields[u].showValueTypeIcon,showSubTotals:this.dataFields[u]?this.dataFields[u].showSubTotals:!this.mappingFields[u]||this.mappingFields[u].showSubTotals};s.push(c),this.fieldList[u]=c}i.hierarchy=this.fieldListData,i.hierarchySuccess=this.fieldListObj.hierarchySuccess,this.loadHierarchyElements(i)},e.prototype.loadHierarchyElements=function(e){for(var t=e.hierarchySuccess,i=e.hierarchy,a=sf.base.extend([],this.rows,null,!0),s=[],r=0,n=a=a.concat(this.columns,this.filters);r<n.length;r++){var o=n[r];s.push(o.name)}for(var l=0,d=[].slice.call(t.querySelectorAll("row"));l<d.length;l++){var p=(o=d[l]).querySelector("DIMENSION_UNIQUE_NAME").textContent,h=o.querySelector("HIERARCHY_UNIQUE_NAME").textContent,u=[].slice.call(o.querySelectorAll("ALL_MEMBER")).length>0,c=void 0;if(u){var g=o.querySelectorAll("ALL_MEMBER")[0].textContent.replace(/[\[\]\&']+/g,"").split(".");c=g[g.length-1].trim()}else c=void 0;for(var m=o.querySelector("HIERARCHY_DISPLAY_FOLDER")?o.querySelector("HIERARCHY_DISPLAY_FOLDER").textContent:"",v=[],b=0,S=i;b<S.length;b++){(M=S[b]).tag===p&&v.push(M)}if(v.length>0&&(p!==h||this.isMondrian)){var y=p+(this.isMondrian?"~#^Dim":"");if(""!==m){for(var C=p+(this.isMondrian?"~#^Dim":"")+"_"+m,w=[],x=0,T=i;x<T.length;x++){var M;(M=T[x]).tag===C&&M.pid===y&&w.push(M)}if(0===w.length){var D={hasChildren:!0,isSelected:!1,pid:p+(this.isMondrian?"~#^Dim":""),id:C,name:m,spriteCssClass:"e-folderCDB-icon "+f,tag:C,caption:m,type:"string"};i.push(D)}y=C}var E={hasChildren:!o.querySelector("HIERARCHY_ORIGIN")||"2"!==o.querySelector("HIERARCHY_ORIGIN").textContent&&"6"!==o.querySelector("HIERARCHY_ORIGIN").textContent,isSelected:s.indexOf(h)>=0,pid:y,id:h,name:o.querySelector("HIERARCHY_CAPTION").textContent,spriteCssClass:(o.querySelector("HIERARCHY_ORIGIN")?"2"!==o.querySelector("HIERARCHY_ORIGIN").textContent&&"6"!==o.querySelector("HIERARCHY_ORIGIN").textContent?"e-hierarchyCDB-icon":"e-attributeCDB-icon":"e-hierarchyCDB-icon")+" "+f,hasAllMember:u,allMember:c,tag:h,caption:this.dataFields[h]&&this.dataFields[h].caption?this.dataFields[h].caption:this.mappingFields[h]&&this.mappingFields[h].caption?this.mappingFields[h].caption:o.querySelector("HIERARCHY_CAPTION").textContent,type:"string",filter:[],dateMember:[],sort:this.enableSort?this.sortObject[h]?this.sortObject[h]:"Ascending":"None",actualFilter:[],filterMembers:[],childMembers:[],searchMembers:[],members:{},currrentMembers:{},levels:[],levelCount:1,isHierarchy:!!o.querySelector("HIERARCHY_ORIGIN")&&("2"===o.querySelector("HIERARCHY_ORIGIN").textContent||"6"===o.querySelector("HIERARCHY_ORIGIN").textContent),isExcelFilter:!1,allowDragAndDrop:this.dataFields[h]?this.dataFields[h].allowDragAndDrop:!this.mappingFields[h]||this.mappingFields[h].allowDragAndDrop,showFilterIcon:this.dataFields[h]?this.dataFields[h].showFilterIcon:!this.mappingFields[h]||this.mappingFields[h].showFilterIcon,showSortIcon:this.dataFields[h]?this.dataFields[h].showSortIcon:!this.mappingFields[h]||this.mappingFields[h].showSortIcon,showEditIcon:this.dataFields[h]?this.dataFields[h].showEditIcon:!this.mappingFields[h]||this.mappingFields[h].showEditIcon,showRemoveIcon:this.dataFields[h]?this.dataFields[h].showRemoveIcon:!this.mappingFields[h]||this.mappingFields[h].showRemoveIcon,showValueTypeIcon:this.dataFields[h]?this.dataFields[h].showValueTypeIcon:!this.mappingFields[h]||this.mappingFields[h].showValueTypeIcon,showSubTotals:this.dataFields[h]?this.dataFields[h].showSubTotals:!this.mappingFields[h]||this.mappingFields[h].showSubTotals};i.push(E),this.fieldList[h]=E}}var O={catalog:e.dataSourceSettings.catalog,cube:e.dataSourceSettings.cube,url:e.dataSourceSettings.url,LCID:e.dataSourceSettings.localeIdentifier.toString(),request:"MDSCHEMA_LEVELS"};this.getTreeData(O,this.loadLevelElements.bind(this),e)},e.prototype.loadLevelElements=function(e,t,i){var a=[],s=this.fieldListData;a=[];for(var r=0,n=[].slice.call(e.querySelectorAll("row"));r<n.length;r++){var o=n[r];if(1!==parseInt(o.querySelector("LEVEL_TYPE").textContent,10)&&"[measures]"!==o.querySelector("HIERARCHY_UNIQUE_NAME").textContent.toLowerCase()){var l=o.querySelector("HIERARCHY_UNIQUE_NAME").textContent,d=o.querySelector("LEVEL_UNIQUE_NAME").textContent,p=o.querySelector("LEVEL_CAPTION").textContent,h={hasChildren:!1,isChecked:!1,isSelected:this.fieldList[l].isSelected,pid:l,id:d,name:p,tag:d,spriteCssClass:"e-level-members e-hierarchy-level-"+parseInt(o.querySelector("LEVEL_NUMBER").textContent,10)+"-icon "+f,caption:p,type:"string"};a.push(h),this.fieldList[l]&&this.fieldList[l].spriteCssClass&&-1===this.fieldList[l].spriteCssClass.indexOf("e-attributeCDB-icon")?(this.fieldList[l].levels.push(h),this.fieldList[l].isHierarchy=!1):this.fieldList[l].isHierarchy=!0}}this.fieldListData=s=s.concat(a);var u={catalog:i.dataSourceSettings.catalog,cube:i.dataSourceSettings.cube,url:i.dataSourceSettings.url,LCID:i.dataSourceSettings.localeIdentifier.toString(),request:"MDSCHEMA_MEASURES"};this.getTreeData(u,this.loadMeasureElements.bind(this),i)},e.prototype.loadMeasureElements=function(e,t,i){for(var a,s=this.fieldListData,r=[],n=[],o=0,l=sf.base.extend([],this.values,null,!0);o<l.length;o++){var d=l[o];n.push(d.name)}if("en-US"!==this.locale){var p={catalog:i.dataSourceSettings.catalog,cube:i.dataSourceSettings.cube,url:i.dataSourceSettings.url,LCID:i.dataSourceSettings.localeIdentifier.toString(),request:"MDSCHEMA_MEASUREGROUPS"};this.getTreeData(p,this.loadMeasureGroups.bind(this),i)}for(var h=0,u=[].slice.call(e.querySelectorAll("row"));h<u.length;h++){d=u[h];var c=sf.base.isNullOrUndefined(d.querySelector("MEASUREGROUP_NAME"))?"":d.querySelector("MEASUREGROUP_NAME").textContent,g=d.querySelector("MEASURE_UNIQUE_NAME").textContent,m=d.querySelector("DEFAULT_FORMAT_STRING")?d.querySelector("DEFAULT_FORMAT_STRING").textContent:"#,#",v=d.querySelector("MEASURE_AGGREGATOR")?d.querySelector("MEASURE_AGGREGATOR").textContent:"1";if(!(r.indexOf(c)>=0)){if("en-US"!==this.locale){for(var b=[],S=0,y=this.fieldListObj.measuresGroups;S<y.length;S++){var C=y[S];C.querySelector("MEASUREGROUP_NAME").textContent===c&&b.push(C)}a=b.length>0?b[0].querySelector("MEASUREGROUP_CAPTION").textContent:c}else a=c;""!==c&&(s.push({hasChildren:!0,isChecked:!1,isSelected:!1,pid:"[Measures]",id:c,name:a,spriteCssClass:"e-measureCDB e-folderCDB-icon "+f,tag:c,caption:a,aggregateType:this.getAggregateType(c,v),type:"string"}),r.push(c))}var w={hasChildren:!1,isSelected:n.indexOf(g)>=0,pid:""===c?"[Measures]":c,id:g,name:d.querySelector("MEASURE_CAPTION").textContent,spriteCssClass:"e-measure-icon "+f,tag:g,caption:this.dataFields[g]&&this.dataFields[g].caption?this.dataFields[g].caption:this.mappingFields[g]&&this.mappingFields[g].caption?this.mappingFields[g].caption:d.querySelector("MEASURE_CAPTION").textContent,aggregateType:this.getAggregateType(g,v),type:"number",filter:[],actualFilter:[],filterMembers:[],childMembers:[],searchMembers:[],members:{},currrentMembers:{},formatString:m,allowDragAndDrop:this.dataFields[g]?this.dataFields[g].allowDragAndDrop:!this.mappingFields[g]||this.mappingFields[g].allowDragAndDrop,showFilterIcon:this.dataFields[g]?this.dataFields[g].showFilterIcon:!this.mappingFields[g]||this.mappingFields[g].showFilterIcon,showSortIcon:this.dataFields[g]?this.dataFields[g].showSortIcon:!this.mappingFields[g]||this.mappingFields[g].showSortIcon,showEditIcon:this.dataFields[g]?this.dataFields[g].showEditIcon:!this.mappingFields[g]||this.mappingFields[g].showEditIcon,showRemoveIcon:this.dataFields[g]?this.dataFields[g].showRemoveIcon:!this.mappingFields[g]||this.mappingFields[g].showRemoveIcon,showValueTypeIcon:this.dataFields[g]?this.dataFields[g].showValueTypeIcon:!this.mappingFields[g]||this.mappingFields[g].showValueTypeIcon,showSubTotals:this.dataFields[g]?this.dataFields[g].showSubTotals:!this.mappingFields[g]||this.mappingFields[g].showSubTotals};s.push(w),this.fieldList[g]=w,n.indexOf(g)>=0&&n.splice(n.indexOf(g),1)}this.measureReportItems=n},e.prototype.loadMeasureGroups=function(e,t,i){sf.base.isNullOrUndefined(this.fieldListObj)&&(this.fieldListObj={}),this.fieldListObj.measuresGroups=[].slice.call(e.querySelectorAll("row"))},e.prototype.doAjaxPost=function(e,t,i,a,s){new sf.base.Ajax({mode:!1,contentType:"text/xml",url:t,data:i,dataType:"xml",type:e,beforeSend:this.beforeSend.bind(this),onSuccess:function(e,t){var i=(new DOMParser).parseFromString(e,"text/xml");a(i,t,s)},onFailure:function(e){return e}}).send()},e.prototype.beforeSend=function(e){this.dataSourceSettings.authentication.userName&&this.dataSourceSettings.authentication.password&&e.httpRequest.setRequestHeader("Authorization","Basic "+btoa(this.dataSourceSettings.authentication.userName+":"+this.dataSourceSettings.authentication.password))},e.prototype.getSoapMsg=function(e,t){var i=this.getConnectionInfo(e.url,e.localeIdentifier);return this.isMondrian?'<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"><SOAP-ENV:Body><Execute xmlns="urn:schemas-microsoft-com:xml-analysis"><Command><Statement><![CDATA['+t+"]]></Statement></Command><Properties><PropertyList><DataSourceInfo>"+""+"</DataSourceInfo><Catalog>"+e.catalog+"</Catalog><AxisFormat>TupleFormat</AxisFormat><Content>Data</Content><Format>Multidimensional</Format></PropertyList></Properties></Execute></SOAP-ENV:Body></SOAP-ENV:Envelope>":'<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"> <Header></Header> <Body> <Execute xmlns="urn:schemas-microsoft-com:xml-analysis"> <Command> <Statement> '+t+" </Statement> </Command> <Properties> <PropertyList> <Catalog>"+e.catalog+"</Catalog> <LocaleIdentifier>"+i.LCID+"</LocaleIdentifier></PropertyList> </Properties> </Execute> </Body> </Envelope>"},e.prototype.getConnectionInfo=function(e,t){var i={url:"",LCID:sf.base.isNullOrUndefined(t)?"1033":t.toString()};if(""!==e)for(var a=0,s=e.split(";");a<s.length;a++){var r=s[a];r.toLowerCase().indexOf("locale")<0&&0===i.url.length?i.url=r:r.toLowerCase().indexOf("locale")>=0&&(i.LCID=r.replace(/ /g,"").split("=")[1])}return i},e.prototype.getMDXQuery=function(e){return Xe.getCellSets(e,this,!0,void 0,!0),this.mdxQuery},e}(),$e=(ge=function(e,t){return(ge=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}ge(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),et=function(e,t,i,s){var r,n=arguments.length,o=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"===("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,s);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(n<3?r(o):n>3?r(t,i,o):r(t,i))||o);return n>3&&o&&Object.defineProperty(t,i,o),o},tt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $e(t,e),et([sf.base.Property(!0)],t.prototype,"showFilterIcon",void 0),et([sf.base.Property(!0)],t.prototype,"showSortIcon",void 0),et([sf.base.Property(!0)],t.prototype,"showRemoveIcon",void 0),et([sf.base.Property(!0)],t.prototype,"showValueTypeIcon",void 0),et([sf.base.Property("Both")],t.prototype,"displayMode",void 0),et([sf.base.Property(!0)],t.prototype,"allowDragAndDrop",void 0),t}(sf.base.ChildProperty),it=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $e(t,e),et([sf.base.Property(!1)],t.prototype,"allowAdding",void 0),et([sf.base.Property(!1)],t.prototype,"allowEditing",void 0),et([sf.base.Property(!1)],t.prototype,"allowDeleting",void 0),et([sf.base.Property(!1)],t.prototype,"allowCommandColumns",void 0),et([sf.base.Property(!1)],t.prototype,"allowInlineEditing",void 0),et([sf.base.Property("Normal")],t.prototype,"mode",void 0),et([sf.base.Property(!0)],t.prototype,"allowEditOnDblClick",void 0),et([sf.base.Property(!0)],t.prototype,"showConfirmDialog",void 0),et([sf.base.Property(!1)],t.prototype,"showDeleteConfirmDialog",void 0),t}(sf.base.ChildProperty),at=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $e(t,e),et([sf.base.Property()],t.prototype,"measure",void 0),et([sf.base.Property()],t.prototype,"label",void 0),et([sf.base.Property("NotEquals")],t.prototype,"conditions",void 0),et([sf.base.Property()],t.prototype,"value1",void 0),et([sf.base.Property()],t.prototype,"value2",void 0),t}(sf.base.ChildProperty),st=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $e(t,e),et([sf.base.Property(!1)],t.prototype,"showHyperlink",void 0),et([sf.base.Property(!1)],t.prototype,"showRowHeaderHyperlink",void 0),et([sf.base.Property(!1)],t.prototype,"showColumnHeaderHyperlink",void 0),et([sf.base.Property(!1)],t.prototype,"showValueCellHyperlink",void 0),et([sf.base.Property(!1)],t.prototype,"showSummaryCellHyperlink",void 0),et([sf.base.Collection([],at)],t.prototype,"conditionalSettings",void 0),et([sf.base.Property()],t.prototype,"headerText",void 0),et([sf.base.Property("")],t.prototype,"cssClass",void 0),t}(sf.base.ChildProperty),rt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $e(t,e),et([sf.base.Property("Table")],t.prototype,"view",void 0),et([sf.base.Property("Table")],t.prototype,"primary",void 0),t}(sf.base.ChildProperty),nt=function(e){function t(t,i){var a=e.call(this,t,i)||this;return a.verticalScrollScale=1,a.horizontalScrollScale=1,a.scrollerBrowserLimit=8e6,a.lastSortInfo={},a.lastFilterInfo={},a.lastAggregationInfo={},a.lastCalcFieldInfo={},a.isScrolling=!1,a.shiftLockedPos=[],a.savedSelectedCellsPos=[],a.cellSelectionPos=[],a.isPopupClicked=!1,a.isMouseDown=!1,a.isMouseUp=!1,a.fieldsType={},a.remoteData=[],a.defaultItems={},a.isCellBoxMultiSelection=!1,a.gridHeaderCellInfo=[],a.gridCellCollection={},a.rowRangeSelection={enable:!1,startIndex:0,endIndex:0},a.isStaticRefresh=!1,a.resizeInfo={},a.scrollPosObject={vertical:0,horizontal:0,verticalSection:0,horizontalSection:0,top:0,left:0,scrollDirection:{direction:"",position:0}},a.pivotColumns=[],a.totColWidth=0,a.posCount=0,a.isModified=!1,a.isInitialRendering=!1,a.needsID=!0,a.pivotRefresh=sf.base.Component.prototype.refresh,a.request=new XMLHttpRequest,a.isServerWaitingPopup=!1,a.pivotView=a,sf.base.setValue("mergePersistData",a.mergePersistPivotData,a),a}var i;return $e(t,e),i=t,t.prototype.requiredModules=function(){var e=[];return e.push({args:[this],member:"groupingbar"}),this.allowConditionalFormatting&&e.push({args:[this],member:"conditionalformatting"}),this.allowNumberFormatting&&e.push({args:[this],member:"numberformatting"}),this.allowCalculatedField&&e.push({args:[this],member:"calculatedfield"}),this.showToolbar&&(this.toolbar.length>0||this.toolbarTemplate)&&e.push({args:[this],member:"toolbar"}),this.showFieldList&&e.push({args:[this],member:"fieldlist"}),this.allowExcelExport&&e.push({args:[this],member:"excelExport"}),this.allowPdfExport&&e.push({args:[this],member:"pdfExport"}),this.enableVirtualization&&e.push({args:[this],member:"virtualscroll"}),this.allowGrouping&&e.push({args:[this],member:"grouping"}),e},t.prototype.preRender=function(){this.dataSourceSettings&&"SSAS"===this.dataSourceSettings.providerType?(this.dataType="olap",this.olapEngineModule=new Ze):(this.dataType="pivot",this.engineModule=new o),this.isAdaptive=sf.base.Browser.isDevice,sf.base.Browser.isIE||"edge"===sf.base.Browser.info.name?this.scrollerBrowserLimit=15e5:"chrome"===sf.base.Browser.info.name&&(this.scrollerBrowserLimit=15e6),this.isTouchMode=!!sf.base.closest(this.element,"e-bigger"),this.initProperties(),this.renderToolTip(),this.keyboardModule=new oe(this),this.contextMenuModule=new le(this),this.globalize=new sf.base.Internationalization(this.locale),(this.showFieldList||this.showGroupingBar||this.allowNumberFormatting||this.allowCalculatedField||this.toolbar||this.allowGrouping||this.gridSettings.contextMenuItems)&&(this.commonModule=new H(this)),this.defaultLocale={grandTotal:"Grand Total",total:"Total",value:"Value",noValue:"No value",row:"Row",column:"Column",collapse:"Collapse",expand:"Expand",rowAxisPrompt:"Drop row here",columnAxisPrompt:"Drop column here",valueAxisPrompt:"Drop value here",filterAxisPrompt:"Drop filter here",filter:"Filter",filtered:"Filtered",sort:"Sort",filters:"Filters",rows:"Rows",columns:"Columns",values:"Values",close:"Close",cancel:"Cancel",delete:"Delete",CalculatedField:"Calculated Field",createCalculatedField:"Create Calculated Field",fieldName:"Enter the field name",error:"Error",invalidFormula:"Invalid formula.",dropText:'Example: ("Sum(Order_Count)" + "Sum(In_Stock)") * 250',dropTextMobile:"Add fields and edit formula here.",dropAction:"Calculated field cannot be place in any other region except value axis.",alert:"Alert",warning:"Warning",ok:"OK",search:"Search",drag:"Drag",remove:"Remove",allFields:"All Fields",formula:"Formula",addToRow:"Add to Row",addToColumn:"Add to Column",addToValue:"Add to Value",addToFilter:"Add to Filter",emptyData:"No records to display",fieldExist:"A field already exists in this name. Please enter a different name.",confirmText:"A calculation field already exists in this name. Do you want to replace it?",noMatches:"No matches",format:"Summaries values by",edit:"Edit",clear:"Clear",sortAscending:"Sort ascending order",sortDescending:"Sort descending order",sortNone:"Sort data order",clearCalculatedField:"Clear edited field info",editCalculatedField:"Edit calculated field",formulaField:"Drag and drop fields to formula",dragField:"Drag field to formula",clearFilter:"Clear",by:"by",all:"All",multipleItems:"Multiple items",member:"Member",label:"Label",date:"Date",enterValue:"Enter value",chooseDate:"Enter date",Before:"Before",BeforeOrEqualTo:"Before Or Equal To",After:"After",AfterOrEqualTo:"After Or Equal To",labelTextContent:"Show the items for which the label",dateTextContent:"Show the items for which the date",valueTextContent:"Show the items for which",Equals:"Equals",DoesNotEquals:"Does Not Equal",BeginWith:"Begins With",DoesNotBeginWith:"Does Not Begin With",EndsWith:"Ends With",DoesNotEndsWith:"Does Not End With",Contains:"Contains",DoesNotContains:"Does Not Contain",GreaterThan:"Greater Than",GreaterThanOrEqualTo:"Greater Than Or Equal To",LessThan:"Less Than",LessThanOrEqualTo:"Less Than Or Equal To",Between:"Between",NotBetween:"Not Between",And:"and",Sum:"Sum",Count:"Count",DistinctCount:"Distinct Count",Product:"Product",Avg:"Avg",Median:"Median",Min:"Min",SampleVar:"Sample Var",PopulationVar:"Population Var",RunningTotals:"Running Totals",Max:"Max",Index:"Index",SampleStDev:"Sample StDev",PopulationStDev:"Population StDev",PercentageOfRowTotal:"% of Row Total",PercentageOfParentTotal:"% of Parent Total",PercentageOfParentColumnTotal:"% of Parent Column Total",PercentageOfParentRowTotal:"% of Parent Row Total",DifferenceFrom:"Difference From",PercentageOfDifferenceFrom:"% of Difference From",PercentageOfGrandTotal:"% of Grand Total",PercentageOfColumnTotal:"% of Column Total",MoreOption:"More...",NotEquals:"Not Equals",AllValues:"All Values",conditionalFormating:"Conditional Formatting",apply:"Apply",condition:"Add Condition",formatLabel:"Format",valueFieldSettings:"Value field settings",baseField:"Base field",baseItem:"Base item",summarizeValuesBy:"Summarize values by",sourceName:"Field name :",sourceCaption:"Field caption",example:"e.g:",editorDataLimitMsg:" more items. Search to refine further.",details:"Details",manageRecords:"Manage Records",Years:"Years",Quarters:"Quarters",Months:"Months",Days:"Days",Hours:"Hours",Minutes:"Minutes",Seconds:"Seconds",save:"Save a report",new:"Create a new report",load:"Load",saveAs:"Save as current report",rename:"Rename a current report",deleteReport:"Delete a current report",export:"Export",subTotals:"Sub totals",grandTotals:"Grand totals",reportName:"Report Name :",pdf:"PDF",excel:"Excel",csv:"CSV",png:"PNG",jpeg:"JPEG",svg:"SVG",mdxQuery:"MDX Query",showSubTotals:"Show sub totals",doNotShowSubTotals:"Do not show sub totals",showSubTotalsRowsOnly:"Show sub totals rows only",showSubTotalsColumnsOnly:"Show sub totals columns only",showGrandTotals:"Show grand totals",doNotShowGrandTotals:"Do not show grand totals",showGrandTotalsRowsOnly:"Show grand totals rows only",showGrandTotalsColumnsOnly:"Show grand totals columns only",fieldList:"Show fieldlist",grid:"Show table",toolbarFormatting:"Conditional formatting",chart:"Chart",reportMsg:"Please enter vaild report name!!!",reportList:"Report list",removeConfirm:"Are you sure you want to delete this report?",emptyReport:"No reports found!!",bar:"Bar",pie:"Pie",funnel:"Funnel",doughnut:"Doughnut",pyramid:"Pyramid",stackingcolumn:"Stacked Column",stackingarea:"Stacked Area",stackingbar:"Stacked Bar",stepline:"Step Line",steparea:"Step Area",splinearea:"Spline Area",spline:"Spline",stackingcolumn100:"100% Stacked Column",stackingbar100:"100% Stacked Bar",stackingarea100:"100% Stacked Area",bubble:"Bubble",pareto:"Pareto",radar:"Radar",line:"Line",area:"Area",scatter:"Scatter",polar:"Polar",of:"of",emptyFormat:"No format found!!!",emptyInput:"Enter a value",newReportConfirm:"Do you want to save the changes to this report?",emptyReportName:"Enter a report name",qtr:"Qtr",null:"null",undefined:"undefined",groupOutOfRange:"Out of Range",fieldDropErrorAction:"The field you are moving cannot be placed in that area of the report",aggregate:"Aggregate",drillThrough:"Drill Through",ascending:"Ascending",descending:"Descending",number:"Number",currency:"Currency",percentage:"Percentage",formatType:"Format Type",customText:"Currency Symbol",symbolPosition:"Symbol Position",left:"Left",right:"Right",grouping:"Grouping",true:"True",false:"False",decimalPlaces:"Decimal Places",numberFormat:"Number Formatting",memberType:"Field Type",formatString:"Format",expressionField:"Expression",customFormat:"Enter custom format string",numberFormatString:"Example: C, P, 0000 %, ###0.##0#, etc.",selectedHierarchy:"Parent Hierarchy",olapDropText:"Example: [Measures].[Order Quantity] + ([Measures].[Order Quantity] * 0.10)",Percent:"Percent",Currency:"Currency",Custom:"Custom",Measure:"Measure",Dimension:"Dimension",Standard:"Standard",blank:"(Blank)",fieldTooltip:'Drag and drop fields to create an expression. And, if you want to edit the existing calculated fields! You can achieve it by simply selecting the field under "Calculated Members".',fieldTitle:"Field Name",QuarterYear:"Quarter Year",drillError:"Cannot show the raw items of calculated fields.",caption:"Field Caption",copy:"Copy",defaultReport:"Sample Report",customFormatString:"Custom Format",invalidFormat:"Invalid Format.",group:"Group",unGroup:"Ungroup",invalidSelection:"Cannot group that selection.",groupName:"Enter the caption to display in header",captionName:"Enter the caption for group field",selectedItems:"Selected items",groupFieldCaption:"Field caption",groupTitle:"Group name",startAt:"Starting at",endAt:"Ending at",groupBy:"Interval by",selectGroup:"Select groups",multipleAxes:"Multiple Axes",showLegend:"Show Legend",exit:"Exit",chartTypeSettings:"Chart Type Settings",ChartType:"Chart Type",yes:"Yes",no:"No",numberFormatMenu:"Number Formatting...",conditionalFormatingMenu:"Conditional Formatting...",removeCalculatedField:"Are you sure you want to delete this calculated field?",replaceConfirmBefore:"A report named ",replaceConfirmAfter:" already exists. Do you want to replace it?",invalidJSON:"Invalid JSON data",invalidCSV:"Invalid CSV data"},this.localeObj=new sf.base.L10n(this.getModuleName(),this.defaultLocale,this.locale),this.renderContextMenu(),this.isDragging=!1,this.addInternalEvents()},t.prototype.onBeforeTooltipOpen=function(e){e.element.classList.add("e-pivottooltipwrap")},t.prototype.renderToolTip=function(){this.showTooltip?(this.tooltipTemplate?this.tooltip=new sf.popups.Tooltip({target:"td.e-valuescontent",cssClass:"e-pivottooltiptemplate",showTipPointer:!1,position:"BottomRight",mouseTrail:!0,enableRtl:this.enableRtl,beforeRender:this.setToolTip.bind(this),beforeOpen:this.onBeforeTooltipOpen}):this.tooltip=new sf.popups.Tooltip({target:"td.e-valuescontent",showTipPointer:!1,position:"BottomRight",mouseTrail:!0,enableRtl:this.enableRtl,beforeRender:this.setToolTip.bind(this),beforeOpen:this.onBeforeTooltipOpen}),this.tooltip.isStringTemplate=!0,this.tooltip.appendTo(this.element)):this.tooltip&&this.tooltip.destroy()},t.prototype.renderContextMenu=function(){if(this.gridSettings.contextMenuItems||this.allowGrouping&&"pivot"===this.dataType){var e=[],t=[],i=[],a=[],s=[],r=[],n=[];if(this.gridSettings.contextMenuItems)for(var o=0,l=this.gridSettings.contextMenuItems;o<l.length;o++){var d=l[o];if("string"==typeof d&&-1!==this.getDefaultItems().indexOf(d))if(-1!==d.toString().toLowerCase().indexOf("aggregate")&&"pivot"===this.dataType){n=[{text:this.localeObj.getConstant("Sum")}];var p=this.buildDefaultItems("Aggregate");p.items=n,s.push(p)}else-1!==d.toString().toLowerCase().indexOf("export")?a.push(this.buildDefaultItems(d)):e.push(this.buildDefaultItems(d));else"string"!=typeof d&&i.push(d)}if(this.allowGrouping&&"pivot"===this.dataType&&(this.getFieldByID(this.element.id+"_custom_group",this.gridSettings.contextMenuItems)||t.push(this.buildDefaultItems("Group")),this.getFieldByID(this.element.id+"_custom_ungroup",this.gridSettings.contextMenuItems)||t.push(this.buildDefaultItems("Ungroup"))),a.length>0){var h=this.buildDefaultItems("export");h.items=a,r.push(h)}this.gridSettings.contextMenuItems=[],Array.prototype.push.apply(this.gridSettings.contextMenuItems,s),Array.prototype.push.apply(this.gridSettings.contextMenuItems,e),Array.prototype.push.apply(this.gridSettings.contextMenuItems,t),Array.prototype.push.apply(this.gridSettings.contextMenuItems,r),Array.prototype.push.apply(this.gridSettings.contextMenuItems,i)}},t.prototype.getFieldByID=function(e,t){return new sf.data.DataManager({json:t}).executeLocal((new sf.data.Query).where("id","equal",e))[0]},t.prototype.getAllSummaryType=function(){return["Sum","Count","DistinctCount","Product","Min","Max","Avg","Median","Index","PopulationVar","SampleVar","PopulationStDev","SampleStDev","RunningTotals","PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal","PercentageOfParentColumnTotal","PercentageOfParentRowTotal","DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentTotal"]},t.prototype.getDefaultItems=function(){return["Drillthrough","Expand","Collapse","Pdf Export","Excel Export","Csv Export","Sort Ascending","Sort Descending","Aggregate","CalculatedField"]},t.prototype.buildDefaultItems=function(e){var t;switch(e){case"Aggregate":t={text:this.localeObj.getConstant("aggregate"),target:"th.e-valuesheader,td.e-valuescontent,.e-stot.e-rowsheader",id:this.element.id+"_aggregate"};break;case"CalculatedField":t={text:this.localeObj.getConstant("CalculatedField"),target:"td.e-valuescontent",id:this.element.id+"_CalculatedField"};break;case"Drillthrough":t={text:this.localeObj.getConstant("drillThrough"),target:"td.e-valuescontent",id:this.element.id+"_drillthrough_menu",iconCss:"e-pivotview-grid "+f};break;case"export":t={text:this.localeObj.getConstant("export"),target:"td.e-valuescontent",id:this.element.id+"_exporting",iconCss:"e-pivotview-export "+f};break;case"Pdf Export":t={text:this.localeObj.getConstant("pdf"),id:this.element.id+"_pdf",iconCss:"e-pivotview-pdf-export "+f};break;case"Excel Export":t={text:this.localeObj.getConstant("excel"),id:this.element.id+"_excel",iconCss:"e-pivotview-excel-export "+f};break;case"Csv Export":t={text:this.localeObj.getConstant("csv"),id:this.element.id+"_csv",iconCss:"e-pivotview-csv-export "+f};break;case"Expand":t={text:this.localeObj.getConstant("expand"),target:"td.e-rowsheader,.e-columnsheader",id:this.element.id+"_expand",iconCss:"e-pivotview-expand "+f};break;case"Collapse":t={text:this.localeObj.getConstant("collapse"),target:"td.e-rowsheader,.e-columnsheader",id:this.element.id+"_collapse",iconCss:"e-pivotview-collapse "+f};break;case"Sort Ascending":t={text:this.localeObj.getConstant("ascending"),target:"th.e-valuesheader,.e-stot",id:this.element.id+"_sortasc",iconCss:"e-icon-ascending "+f};break;case"Sort Descending":t={text:this.localeObj.getConstant("descending"),target:"th.e-valuesheader,.e-stot",id:this.element.id+"_sortdesc",iconCss:"e-icon-descending "+f};break;case"Group":t={text:this.localeObj.getConstant("group"),target:"td.e-rowsheader,.e-columnsheader",id:this.element.id+"_custom_group",iconCss:"e-pivotview-group "+f};break;case"Ungroup":t={text:this.localeObj.getConstant("unGroup"),target:"td.e-rowsheader,.e-columnsheader",id:this.element.id+"_custom_ungroup",iconCss:"e-pivotview-ungroup "+f}}return this.defaultItems[e]={text:t.text,id:t.id,target:t.target,iconCss:t.iconCss},this.defaultItems[e]},t.prototype.initProperties=function(){this.pivotRefresh=sf.base.Component.prototype.refresh,this.isScrolling=!1,this.allowServerDataBinding=!1,this.isStaticRefresh=!1,this.setProperties({pivotValues:[]},!0),delete this.bulkChanges.pivotValues,this.allowServerDataBinding=!0,this.scrollPosObject={vertical:0,horizontal:0,verticalSection:0,horizontalSection:0,top:0,left:0,scrollDirection:{direction:"",position:0}},this.queryCellInfo=this.gridSettings.queryCellInfo?this.gridSettings.queryCellInfo.bind(this):void 0,this.headerCellInfo=this.gridSettings.headerCellInfo?this.gridSettings.headerCellInfo.bind(this):void 0,this.resizing=this.gridSettings.resizing?this.gridSettings.resizing.bind(this):void 0,this.resizeStop=this.gridSettings.resizeStop?this.gridSettings.resizeStop.bind(this):void 0,this.pdfHeaderQueryCellInfo=this.gridSettings.pdfHeaderQueryCellInfo?this.gridSettings.pdfHeaderQueryCellInfo.bind(this):void 0,this.pdfQueryCellInfo=this.gridSettings.pdfQueryCellInfo?this.gridSettings.pdfQueryCellInfo.bind(this):void 0,this.excelHeaderQueryCellInfo=this.gridSettings.excelHeaderQueryCellInfo?this.gridSettings.excelHeaderQueryCellInfo.bind(this):void 0,this.excelQueryCellInfo=this.gridSettings.excelQueryCellInfo?this.gridSettings.excelQueryCellInfo.bind(this):void 0,this.columnDragStart=this.gridSettings.columnDragStart?this.gridSettings.columnDragStart.bind(this):void 0,this.columnDrag=this.gridSettings.columnDrag?this.gridSettings.columnDrag.bind(this):void 0,this.columnDrop=this.gridSettings.columnDrop?this.gridSettings.columnDrop.bind(this):void 0,this.beforeColumnsRender=this.gridSettings.columnRender?this.gridSettings.columnRender:void 0,this.selected=this.gridSettings.cellSelected?this.gridSettings.cellSelected:void 0,this.cellDeselected=this.gridSettings.cellDeselected?this.gridSettings.cellDeselected:void 0,this.rowSelected=this.gridSettings.rowSelected?this.gridSettings.rowSelected:void 0,this.rowDeselected=this.gridSettings.rowDeselected?this.gridSettings.rowDeselected:void 0,this.chartTooltipRender=this.chartSettings.tooltipRender?this.chartSettings.tooltipRender:void 0,this.chartLoaded=this.chartSettings.loaded?this.chartSettings.loaded:void 0,this.chartLoad=this.chartSettings.load?this.chartSettings.load:void 0,this.chartResized=this.chartSettings.resized?this.chartSettings.resized:void 0,this.chartAxisLabelRender=this.chartSettings.axisLabelRender?this.chartSettings.axisLabelRender:void 0,this.multiLevelLabelClick=this.chartSettings.multiLevelLabelClick?this.chartSettings.multiLevelLabelClick:void 0,this.chartPointClick=this.chartSettings.pointClick?this.chartSettings.pointClick:void 0,this.contextMenuClick=this.gridSettings.contextMenuClick?this.gridSettings.contextMenuClick:void 0,this.contextMenuOpen=this.gridSettings.contextMenuOpen?this.gridSettings.contextMenuOpen:void 0,this.beforePdfExport=this.gridSettings.beforePdfExport?this.gridSettings.beforePdfExport.bind(this):void 0,this.beforeExcelExport=this.gridSettings.beforeExcelExport?this.gridSettings.beforeExcelExport.bind(this):void 0,null===this.gridSettings.rowHeight&&(this.isTouchMode?this.setProperties({gridSettings:{rowHeight:36}},!0):this.setProperties({gridSettings:{rowHeight:this.isAdaptive?36:30}},!0)),this.element.style.height="100%",this.enableVirtualization&&(this.updatePageSettings(!0),this.allowExcelExport&&i.Inject(re),this.allowPdfExport&&i.Inject(ne),this.editSettings.allowEditing&&i.Inject(he)),this.isCellBoxMultiSelection=this.gridSettings.allowSelection&&"Box"===this.gridSettings.selectionSettings.cellSelectionMode&&"Cell"===this.gridSettings.selectionSettings.mode&&"Multiple"===this.gridSettings.selectionSettings.type,this.allowGrouping&&!this.isCellBoxMultiSelection&&(this.isCellBoxMultiSelection=!0,this.setProperties({gridSettings:{allowSelection:!0,selectionSettings:{cellSelectionMode:"Box",mode:"Cell",type:"Multiple"}}},!0)),"Table"!==this.displayOption.view&&(this.chartModule=new ue),this.currentView=this.currentView?this.currentView:"Both"===this.displayOption.view?this.displayOption.primary:this.displayOption.view},t.prototype.updatePageSettings=function(e){if(this.enableVirtualization){var t=1,i=1;this.dataSourceSettings.values.length>1&&"pivot"===this.dataType&&("row"===this.dataSourceSettings.valueAxis?i=this.dataSourceSettings.values.length:t=this.dataSourceSettings.values.length);var a=this.getHeightAsNumber();isNaN(a)&&(a=this.element.offsetHeight),this.pageSettings={columnCurrentPage:e?1:this.pageSettings.columnCurrentPage,rowCurrentPage:e?1:this.pageSettings.rowCurrentPage,columnSize:Math.ceil((Math.floor(this.getWidthAsNumber()/this.gridSettings.columnWidth)-1)/t),rowSize:Math.ceil(Math.floor(a/this.gridSettings.rowHeight)/i),allowDataCompression:this.allowDataCompression}}},t.prototype.render=function(){this.loadData()},t.prototype.loadData=function(){"pivot"===this.dataType&&this.dataSourceSettings.url&&""!==this.dataSourceSettings.url?"Server"===this.dataSourceSettings.mode?(this.guid=r.generateUUID(),this.initialLoad(),"Chart"!==this.displayOption.view&&this.renderEmptyGrid(),this.showWaitingPopup(),this.getEngine("initialRender",null,null,null,null,null,null)):(this.request.open("GET",this.dataSourceSettings.url,!0),this.request.withCredentials=!1,this.request.onreadystatechange=this.onReadyStateChange.bind(this),this.request.setRequestHeader("Content-type","text/plain"),this.request.send(null)):this.initialLoad()},t.prototype.onSuccess=function(){if(this.request.readyState===XMLHttpRequest.DONE){this.isServerWaitingPopup=!0;try{var e=JSON.parse(this.request.responseText);if("fetchFieldMembers"===this.currentAction){for(var t=JSON.parse(e.members),i=[],a={},s={},n=0;n<t.length;n++)i.push({formattedText:t[n].FormattedText,actualText:t[n].ActualText}),a[t[n].FormattedText]={},s[t[n].ActualText]={};this.engineModule.fieldList[e.memberName].dateMember=i,this.engineModule.fieldList[e.memberName].formattedMembers=a,this.engineModule.fieldList[e.memberName].members=s,this.showGroupingBar?this.pivotButtonModule.updateFilterEvents():this.pivotFieldListModule.pivotButtonModule.updateFilterEvents()}else if("fetchRawData"===this.currentAction){for(var o=this.engineModule.fieldList[this.drillThroughValue.actualText.toString()]?this.engineModule.fieldList[this.drillThroughValue.actualText.toString()].caption:this.drillThroughValue.actualText.toString(),l=this.engineModule.fieldList[this.drillThroughValue.actualText]?this.engineModule.fieldList[this.drillThroughValue.actualText].aggregateType:"",d=JSON.parse(e.rawData),p=JSON.parse(e.indexObject),h={},u=0;u<p.length;u++)h[p[u].Key]=p[u].Value;this.drillThroughValue.indexObject=h,this.drillThroughModule.triggerDialog(o,l,d,this.drillThroughValue,this.drillThroughElement)}else{var c=r.formatFieldList(JSON.parse(e.fieldList));if(this.engineModule.fieldList){var g=Object.keys(this.engineModule.fieldList);for(n=0;n<g.length;n++)this.engineModule.fieldList[g[n]]&&c[g[n]]&&(c[g[n]].dateMember=this.engineModule.fieldList[g[n]].dateMember,c[g[n]].formattedMembers=this.engineModule.fieldList[g[n]].formattedMembers,c[g[n]].members=this.engineModule.fieldList[g[n]].members)}this.engineModule.fieldList=c,this.engineModule.fields=JSON.parse(e.fields),this.engineModule.rowCount=JSON.parse(e.pivotCount).RowCount,this.engineModule.columnCount=JSON.parse(e.pivotCount).ColumnCount,this.engineModule.rowStartPos=JSON.parse(e.pivotCount).RowStartPosition,this.engineModule.colStartPos=JSON.parse(e.pivotCount).ColumnStartPosition,this.engineModule.rowFirstLvl=JSON.parse(e.pivotCount).RowFirstLevel,this.engineModule.colFirstLvl=JSON.parse(e.pivotCount).ColumnFirstLevel;for(var f=void 0,m=r.formatPivotValues(JSON.parse(e.pivotValue)),v=0;v<m.length;v++)if(m[v]&&m[v][0]&&"row"===m[v][0].axis){f=v;break}this.engineModule.headerContent=r.frameContent(m,"header",f,this),this.engineModule.pageSettings=this.pageSettings,this.dataSourceSettings.groupSettings.length>0&&r.updateReport(this,JSON.parse(e.dataSourceSettings));var b=JSON.parse(e.dataSourceSettings).ValueSortSettings;this.engineModule.valueSortSettings={headerText:b.HeaderText,headerDelimiter:b.HeaderDelimiter,sortOrder:b.SortOrder,columnIndex:b.ColumnIndex},this.engineModule.pivotValues=m}}catch(e){this.engineModule.pivotValues=[]}if("fetchFieldMembers"!==this.currentAction&&"fetchRawData"!==this.currentAction&&(this.initEngine(),this.calculatedFieldModule&&this.calculatedFieldModule.isRequireUpdate&&(this.calculatedFieldModule.endDialog(),this.calculatedFieldModule.isRequireUpdate=!1),this.pivotFieldListModule&&this.pivotFieldListModule.calculatedFieldModule&&this.pivotFieldListModule.calculatedFieldModule.isRequireUpdate&&(this.pivotFieldListModule.calculatedFieldModule.endDialog(),this.pivotFieldListModule.calculatedFieldModule.isRequireUpdate=!1)),"onScroll"===this.currentAction)if("vertical"===this.scrollDirection){var S="row"===this.dataSourceSettings.valueAxis?this.dataSourceSettings.values.length:1,y=this.pageSettings.rowSize*S*this.gridSettings.rowHeight*Math.ceil(this.engineModule.rowStartPos/(this.pageSettings.rowSize*S))-this.engineModule.rowFirstLvl*S*this.gridSettings.rowHeight;this.scrollPosObject.verticalSection=y}else if("horizondal"===this.scrollDirection){var C="column"===this.dataSourceSettings.valueAxis?this.dataSourceSettings.values.length:1;y=this.pageSettings.columnSize*C*this.gridSettings.columnWidth*Math.ceil(this.engineModule.colStartPos/(this.pageSettings.columnSize*C))-this.engineModule.colFirstLvl*C*this.gridSettings.columnWidth;this.scrollPosObject.horizontalSection=y}}},t.prototype.getEngine=function(e,t,i,a,s,n,o,l,d){var p=this;this.currentAction=e,this.isServerWaitingPopup=!1;var h={pageSettings:this.pageSettings,enableValueSorting:this.enableValueSorting,enableDrillThrough:this.allowDrillThrough||this.editSettings.allowEditing,locale:JSON.stringify(r.getLocalizedObject(this))};this.request.open("POST",this.dataSourceSettings.url,!0);var u={request:this.request,dataSourceSettings:JSON.parse(this.getPersistData()).dataSourceSettings,action:e,customProperties:{},internalProperties:h,drillItem:t,sortItem:i,aggregatedItem:a,calculatedItem:s,filterItem:n,memberName:o,fetchRawDataArgs:l,editArgs:d,hash:this.guid};this.trigger("beforeServiceInvoke",u,(function(e){p.request=e.request,u.internalProperties=e.internalProperties,u.customProperties=e.customProperties,u.dataSourceSettings=e.dataSourceSettings,u.calculatedItem=e.calculatedItem,u.drillItem=e.drillItem,u.editArgs=e.editArgs,u.fetchRawDataArgs=e.fetchRawDataArgs,u.filterItem=e.filterItem,u.hash=e.hash,u.memberName=e.memberName,u.sortItem=e.sortItem})),this.request.withCredentials=!1,this.request.onreadystatechange=this.onSuccess.bind(this),this.request.setRequestHeader("Content-type","application/json"),this.request.send(JSON.stringify(u))},t.prototype.onReadyStateChange=function(){if(this.request.readyState===XMLHttpRequest.DONE){var e=[];if("CSV"===this.dataSourceSettings.type)for(var t=this.request.responseText.split(/\r?\n|\r/),i=0;i<t.length;i++)sf.base.isNullOrUndefined(t[i])||""===t[i]||e.push(t[i].split(","));else try{e=JSON.parse(this.request.responseText)}catch(t){e=[]}sf.base.isBlazor()&&e.length>0?this.remoteData=e:e.length>0&&this.setProperties({dataSourceSettings:{dataSource:e}},!0),this.initialLoad()}},t.prototype.initialLoad=function(){var e=this;this.cellTemplateFn=this.templateParser(this.cellTemplate),this.tooltipTemplateFn=this.templateParser(this.tooltipTemplate),this.spinnerTemplate?sf.popups.createSpinner({target:this.element,template:this.spinnerTemplate},this.createElement):sf.popups.createSpinner({target:this.element},this.createElement);var t={dataSourceSettings:sf.base.isBlazor()?r.getClonedDataSourceSettings(this.dataSourceSettings):this.dataSourceSettings,pivotview:sf.base.isBlazor()?void 0:this,fieldsType:{}};this.trigger("load",t,(function(t){sf.base.isBlazor()?(t.dataSourceSettings.dataSource=e.dataSourceSettings.dataSource,r.updateDataSourceSettings(e,t.dataSourceSettings)):e.dataSourceSettings=t.dataSourceSettings,e.fieldsType=t.fieldsType,e.updateClass(),e.notify("init-groupingbar",{}),"Server"!==e.dataSourceSettings.mode&&e.notify(l,{}),e.isAdaptive&&e.contextMenuModule.render(),e.notify("init-toolbar",{})})),sf.base.isBlazor()&&this.renderComplete()},t.prototype.addInternalEvents=function(){this.on(l,this.generateData,this),this.on(h,this.renderPivotGrid,this),this.on(p,this.onContentReady,this)},t.prototype.removeInternalEvents=function(){this.off(l,this.generateData),this.off(h,this.renderPivotGrid),this.off(p,this.onContentReady)},t.prototype.getPersistData=function(){return this.chartSettings.tooltipRender=void 0,this.addOnPersist(["dataSourceSettings","pivotValues","gridSettings","chartSettings","displayOption"])},t.prototype.loadPersistData=function(e){var t;sf.base.isBlazor()?(t="string"==typeof e?JSON.parse(e):e).dataSourceSettings.dataSource=this.dataSourceSettings.dataSource:t=JSON.parse(e),this.allowServerDataBinding=!1,this.setProperties({gridSettings:t.gridSettings,pivotValues:t.pivotValues,chartSettings:t.chartSettings,displayOption:t.displayOption},!0),delete this.bulkChanges.pivotValues,this.allowServerDataBinding=!0,this.dataSourceSettings=t.dataSourceSettings},t.prototype.mergePersistPivotData=function(){var e;sf.base.isBlazor()&&(e=this.dataSourceSettings.dataSource);var t=window.localStorage.getItem(this.getModuleName()+this.element.id);sf.base.isNullOrUndefined(t)||""===t||this.setProperties(JSON.parse(t),!0),this.dataSourceSettings.dataSource instanceof Object&&sf.base.isBlazor()&&this.setProperties({dataSourceSettings:{dataSource:e}},!0)},t.prototype.showConditionalFormattingDialog=function(){this.conditionalFormattingModule&&this.conditionalFormattingModule.showConditionalFormattingDialog()},t.prototype.createCalculatedFieldDialog=function(){this.calculatedFieldModule&&this.calculatedFieldModule.createCalculatedFieldDialog()},t.prototype.getModuleName=function(){return"pivotview"},t.prototype.copy=function(e){this.grid.copy(e)},t.prototype.onPropertyChanged=function(t,i){for(var a=0,s=Object.keys(t);a<s.length;a++){var n=s[a];switch(n){case"dataSourceSettings":case"hyperlinkSettings":case"allowDrillThrough":case"editSettings":case"allowDataCompression":if(t.dataSourceSettings&&1===Object.keys(t.dataSourceSettings).length&&t.dataSourceSettings.groupSettings&&"pivot"===this.dataType&&this.updateGroupingReport(t.dataSourceSettings.groupSettings,"Date"),t.dataSourceSettings&&1===Object.keys(t.dataSourceSettings).length&&"dataSource"===Object.keys(t.dataSourceSettings)[0])!sf.base.isNullOrUndefined(this.savedDataSourceSettings)&&this.dataSourceSettings.dataSource.length>0&&(r.updateDataSourceSettings(this,this.savedDataSourceSettings),this.savedDataSourceSettings=void 0),0===t.dataSourceSettings.dataSource.length&&(this.savedDataSourceSettings=r.getClonedDataSourceSettings(this.dataSourceSettings),this.setProperties({dataSourceSettings:{rows:[]}},!0),this.setProperties({dataSourceSettings:{columns:[]}},!0),this.setProperties({dataSourceSettings:{values:[]}},!0),this.setProperties({dataSourceSettings:{filters:[]}},!0)),this.pivotValues=[],this.engineModule.fieldList=null,this.dataSourceSettings.groupSettings.length>0&&(this.clonedDataSet=t.dataSourceSettings.dataSource,this.updateGroupingReport(this.dataSourceSettings.groupSettings,"Date")),this.showWaitingPopup(),clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.refreshData.bind(this),100);else if(r.isButtonIconRefesh(n,i,t)){if(this.showGroupingBar&&this.groupingBarModule&&this.axisFieldModule.render(),this.showFieldList&&this.pivotFieldListModule){var o=r.cloneFieldSettings(this.dataSourceSettings.rows),p=r.cloneFieldSettings(this.dataSourceSettings.columns),u=r.cloneFieldSettings(this.dataSourceSettings.values),c=r.cloneFieldSettings(this.dataSourceSettings.filters);this.pivotFieldListModule.setProperties({dataSourceSettings:{rows:o,columns:p,values:u,filters:c}},!0),this.pivotFieldListModule.axisFieldModule.render(),this.pivotFieldListModule.treeViewModule.fieldTable&&!this.isAdaptive&&this.pivotFieldListModule.notify("tree-view-update",{})}}else this.remoteData=[],"pivot"===this.dataType&&this.dataSourceSettings.url&&""!==this.dataSourceSettings.url&&("type"in t.dataSourceSettings||"url"in t.dataSourceSettings)?(this.engineModule.fieldList=null,this.loadData()):(t.dataSourceSettings&&"dataSource"in t.dataSourceSettings&&(0===t.dataSourceSettings.dataSource.length&&(this.savedDataSourceSettings=r.getClonedDataSourceSettings(this.dataSourceSettings),this.setProperties({dataSourceSettings:{rows:[]}},!0),this.setProperties({dataSourceSettings:{columns:[]}},!0),this.setProperties({dataSourceSettings:{values:[]}},!0),this.setProperties({dataSourceSettings:{filters:[]}},!0)),this.engineModule.fieldList=null,this.pivotValues=[]),this.notify(l,{}));break;case"height":case"width":this.layoutRefresh();break;case"pivotValues":case"displayOption":!this.showToolbar&&t.displayOption&&1===Object.keys(t.displayOption).length&&t.displayOption.view?(this.currentView="Both"===t.displayOption.view?this.displayOption.primary:t.displayOption.view,(this.showGroupingBar||this.showFieldList)&&(this.showFieldList&&this.pivotFieldListModule&&this.pivotFieldListModule.destroy(),this.showGroupingBar&&this.groupingBarModule&&this.groupingBarModule.destroy(),this.notify("init-groupingbar",this)),this.grid||"Chart"===t.displayOption.view?this.chartModule||"Table"===this.displayOption.view||(this.chartModule=new ue):(this.renderEmptyGrid(),"Table"===t.displayOption.view&&this.chartModule&&(this.chartModule.destroy(),this.chart=void 0,this.chartModule=void 0))):this.showToolbar&&!sf.base.isNullOrUndefined(t.displayOption)&&t.displayOption.view&&(this.currentView="Both"===t.displayOption.view?this.displayOption.primary:t.displayOption.view);var g="pivot"===this.dataType?this.engineModule:this.olapEngineModule;sf.base.isNullOrUndefined(g.fieldList)&&sf.base.isNullOrUndefined(g.pivotValues)||this.notify(h,{});break;case"gridSettings":this.lastGridSettings=t.gridSettings,this.isCellBoxMultiSelection=this.gridSettings.allowSelection&&"Box"===this.gridSettings.selectionSettings.cellSelectionMode&&"Cell"===this.gridSettings.selectionSettings.mode&&"Multiple"===this.gridSettings.selectionSettings.type,this.allowGrouping&&this.groupingModule&&!this.isCellBoxMultiSelection&&(this.setProperties({gridSettings:{allowSelection:!0,selectionSettings:{cellSelectionMode:"Box",mode:"Cell",type:"Multiple"}}},!0),this.isCellBoxMultiSelection=!0),this.renderModule.updateGridSettings();break;case"chartSettings":this.showGroupingBar&&this.groupingBarModule&&(-1!==Object.keys(t.chartSettings).indexOf("enableMultiAxis")||t.chartSettings.chartSeries&&-1!==Object.keys(t.chartSettings.chartSeries).indexOf("type"))&&this.groupingBarModule.renderLayout(),sf.base.isNullOrUndefined(this.chartModule)&&"Table"!==this.displayOption.view&&(this.chartModule=new ue);var f="pivot"===this.dataType?this.engineModule:this.olapEngineModule;sf.base.isNullOrUndefined(this.chartModule)||sf.base.isNullOrUndefined(f.pivotValues)||this.chartModule.loadChart(this,this.chartSettings),sf.base.isNullOrUndefined(f.pivotValues)||sf.base.isNullOrUndefined(f.fieldList)||this.notify(d,this);break;case"locale":case"currencyCode":case"enableRtl":if(this.tooltip&&this.tooltip.destroy(),this.dataSourceSettings.groupSettings&&this.dataSourceSettings.groupSettings.length>0&&this.clonedDataSet&&!sf.base.isBlazor()){var m=r.getClonedData(this.clonedDataSet);this.setProperties({dataSourceSettings:{dataSource:m}},!0)}sf.base.isBlazor()?this.refresh():e.prototype.refresh.call(this),this.updateClass();break;case"enableValueSorting":this.enableValueSorting=t.enableValueSorting,this.updateDataSource();break;case"showGroupingBar":this.element.querySelector(".e-grouping-bar")&&this.element.querySelector(".e-grouping-bar").remove(),sf.base.isNullOrUndefined(t.showFieldList)&&this.renderPivotGrid();break;case"showFieldList":this.initialLoad();break;case"groupingBarSettings":this.axisFieldModule.render();break;case"showTooltip":this.renderToolTip();break;case"toolbar":this.toolbarModule&&this.toolbarModule.refreshToolbar();break;case"chartTypes":this.toolbarModule&&this.toolbarModule.createChartMenu();break;case"aggregateTypes":this.showGroupingBar&&this.axisFieldModule&&this.axisFieldModule.render(),this.showFieldList&&this.pivotFieldListModule&&this.pivotFieldListModule.axisFieldModule&&(this.pivotFieldListModule.setProperties({aggregateTypes:t.aggregateTypes},!0),this.pivotFieldListModule.axisFieldModule.render())}}},t.prototype.templateParser=function(e){if(e)try{if(document.querySelectorAll(e).length)return sf.base.compile(document.querySelector(e).innerHTML.trim())}catch(t){return sf.base.compile(e)}},t.prototype.getCellTemplate=function(){return this.cellTemplateFn},t.prototype.appendHtml=function(e,t){var i=document.createElement("div");return i.innerHTML=t,sf.base.isNullOrUndefined(i.firstChild)||e.appendChild(i.firstChild),e},t.prototype.renderPivotGrid=function(){this.clearTemplate(),"Table"===this.currentView&&this.cellTemplate&&sf.base.isBlazor()&&sf.base.resetBlazorTemplate(this.element.id+"_cellTemplate","CellTemplate"),this.chartModule&&(this.chartModule.engineModule=this.engineModule,this.chartModule.loadChart(this,this.chartSettings),this.enableRtl&&this.chart&&"rtl"!==document.body.getAttribute("dir")&&sf.base.addClass([this.chart.element],"e-ltr")),(this.showFieldList||this.showGroupingBar||this.allowNumberFormatting||this.allowCalculatedField||this.toolbar||this.allowGrouping||this.gridSettings.contextMenuItems)&&(this.notify(d,this),this.pivotFieldListModule&&this.allowDeferLayoutUpdate&&(this.pivotFieldListModule.clonedDataSource=sf.base.extend({},this.dataSourceSettings,null,!0))),this.enableVirtualization&&(this.virtualscrollModule=new de(this)),(this.allowDrillThrough||this.editSettings.allowEditing)&&(this.drillThroughModule=new he(this)),"Chart"!==this.displayOption.view?(this.hyperlinkSettings&&(this.isRowCellHyperlink=!!this.hyperlinkSettings.showRowHeaderHyperlink||!!this.hyperlinkSettings.showHyperlink,this.isColumnCellHyperlink=!!this.hyperlinkSettings.showColumnHeaderHyperlink||!!this.hyperlinkSettings.showHyperlink,this.isValueCellHyperlink=!!this.hyperlinkSettings.showValueCellHyperlink||!!this.hyperlinkSettings.showHyperlink,this.isSummaryCellHyperlink=!!this.hyperlinkSettings.showSummaryCellHyperlink||!!this.hyperlinkSettings.showHyperlink,this.applyHyperlinkSettings()),this.renderModule=new A(this),this.renderModule.render()):this.grid&&sf.base.remove(this.grid.element),this.allowConditionalFormatting&&this.applyFormatting(this.pivotValues),this.showToolbar&&"Both"===this.displayOption.view&&this.chart&&this.grid&&(this.showGroupingBar&&this.groupingBarModule&&this.element.querySelector(".e-grouping-bar")&&this.groupingBarModule.refreshUI(),this.toolbarModule&&this.toolbarModule.toolbar&&(this.toolbarModule.toolbar.width=this.getGridWidthAsNumber()-2),this.chart.element.style.width=sf.base.formatUnit(this.getGridWidthAsNumber()),this.chart.width=sf.base.formatUnit(this.getGridWidthAsNumber()),"Table"===this.currentView?(this.grid.element.style.display="",this.chart.element.style.display="none",this.chartSettings.enableMultiAxis&&this.chartSettings.enableScrollOnMultiAxis&&(this.element.querySelector(".e-pivotchart").style.display="none")):(this.grid.element.style.display="none",this.chart.element.style.display="",this.chartSettings.enableMultiAxis&&this.chartSettings.enableScrollOnMultiAxis&&(this.element.querySelector(".e-pivotchart").style.display=""))),this.toolbarModule&&(this.showFieldList&&sf.base.select("#"+this.element.id+"_PivotFieldList",this.element)&&(sf.base.select("#"+this.element.id+"_PivotFieldList",this.element).style.display="none"),this.toolbar&&-1!==this.toolbar.indexOf("FieldList")&&this.showToolbar&&this.element.querySelector(".e-toggle-field-list")&&(this.element.querySelector(".e-toggle-field-list").style.display="none"),this.toolbarModule&&"New"!==this.toolbarModule.action&&"Load"!==this.toolbarModule.action&&"Remove"!==this.toolbarModule.action&&(this.isModified=!0),this.isInitialRendering||(this.isModified=!1,this.isInitialRendering=!this.isInitialRendering),this.toolbarModule.action="")},t.prototype.showWaitingPopup=function(){this.grid&&this.grid.element&&!this.spinnerTemplate&&"Table"===this.currentView?sf.popups.showSpinner(this.grid.element):sf.popups.showSpinner(this.element)},t.prototype.hideWaitingPopup=function(){this.grid&&this.grid.element&&!this.spinnerTemplate&&"Table"===this.currentView?sf.popups.hideSpinner(this.grid.element):sf.popups.hideSpinner(this.element)},t.prototype.updateDataSource=function(e){var t=this;this.showWaitingPopup();var i=this,a=Object.keys(i.lastSortInfo).length>0,s=Object.keys(i.lastFilterInfo).length>0,n=Object.keys(i.lastAggregationInfo).length>0,o=Object.keys(i.lastCalcFieldInfo).length>0,l={dataSourceSettings:r.getClonedDataSourceSettings(i.dataSourceSettings)};i.trigger("enginePopulating",l,(function(e){if(i.enableVirtualization&&(a||s||n||o)||r.updateDataSourceSettings(i,e.dataSourceSettings),i.updatePageSettings(!1),"pivot"===i.dataType&&i.enableVirtualization&&(a||s||n||o)){var l={};if(a){if(i.setProperties({dataSourceSettings:{valueSortSettings:{headerText:""}}},!0),sf.base.isBlazor()){var d="sfBlazor";i.lastSortInfo.name,i.lastSortInfo.order;l={key:"onSort",arg:window[d].copyWithoutCircularReferences([i.lastSortInfo],i.lastSortInfo)}}else"Server"===t.dataSourceSettings.mode?i.getEngine("onSort",null,i.lastSortInfo,null,null,null,null):i.engineModule.onSort(i.lastSortInfo);i.lastSortInfo={}}if(n){if(sf.base.isBlazor()){d="sfBlazor";l={key:"onAggregation",arg:window[d].copyWithoutCircularReferences([i.lastAggregationInfo],i.lastAggregationInfo)}}else"Server"===t.dataSourceSettings.mode?i.getEngine("onAggregation",null,null,i.lastAggregationInfo,null,null,null):i.engineModule.onAggregation(i.lastAggregationInfo);i.lastAggregationInfo={}}if(o){if(sf.base.isBlazor()){var p=window.sfBlazor.copyWithoutCircularReferences([i.dataSourceSettings.properties],i.dataSourceSettings.properties);l={key:"onCalcOperation",arg:{lastCalcFieldInfo:i.lastCalcFieldInfo,values:p.values,calculatedFieldSettings:p.calculatedFieldSettings}}}else"Server"===t.dataSourceSettings.mode?i.getEngine("onCalcOperation",null,null,null,i.lastCalcFieldInfo,null,null):i.engineModule.onCalcOperation(i.lastCalcFieldInfo);i.lastCalcFieldInfo={}}if(s){if(sf.base.isBlazor())l={key:"onFilter",arg:{lastFilterInfo:window.sfBlazor.copyWithoutCircularReferences([i.lastFilterInfo],i.lastFilterInfo),filterSettings:window.sfBlazor.copyWithoutCircularReferences([i.dataSourceSettings.filterSettings],i.dataSourceSettings.filterSettings)}};else"Server"===t.dataSourceSettings.mode?i.getEngine("onFilter",null,null,null,null,i.lastFilterInfo,null):i.engineModule.onFilter(i.lastFilterInfo,i.dataSourceSettings);i.lastFilterInfo={}}sf.base.isBlazor()?i.interopAdaptor.invokeMethodAsync("PivotInteropMethod",l.key,l.arg).then((function(e){i.updateBlazorData(e,i),i.allowServerDataBinding=!1,i.setProperties({pivotValues:i.engineModule.pivotValues},!0),delete i.bulkChanges.pivotValues,i.allowServerDataBinding=!0,i.enginePopulatedEventMethod("updateDataSource",i),i.calculatedFieldModule&&i.calculatedFieldModule.isRequireUpdate&&(i.calculatedFieldModule.endDialog(),i.calculatedFieldModule.isRequireUpdate=!1)})):(i.allowServerDataBinding=!1,i.setProperties({pivotValues:i.engineModule.pivotValues},!0),delete i.bulkChanges.pivotValues,i.allowServerDataBinding=!0,"Server"!==i.dataSourceSettings.mode&&i.enginePopulatedEventMethod("updateDataSource"))}else if("olap"===i.dataType){var h={mode:"",savedFieldList:i.olapEngineModule.fieldList,savedFieldListData:i.olapEngineModule.fieldListData,pageSettings:i.pageSettings,enableValueSorting:i.enableValueSorting,isDrillThrough:i.allowDrillThrough||i.editSettings.allowEditing,localeObj:i.localeObj};o||a?(i.olapEngineModule.savedFieldList=i.olapEngineModule.fieldList,i.olapEngineModule.savedFieldListData=i.olapEngineModule.fieldListData,o?(i.olapEngineModule.updateCalcFields(i.dataSourceSettings,i.lastCalcFieldInfo),i.lastCalcFieldInfo={}):(i.olapEngineModule.onSort(i.dataSourceSettings),i.lastSortInfo={})):i.olapEngineModule.renderEngine(i.dataSourceSettings,h),i.allowServerDataBinding=!1,i.setProperties({pivotValues:i.olapEngineModule.pivotValues},!0),delete i.bulkChanges.pivotValues,i.allowServerDataBinding=!0,i.enginePopulatedEventMethod("updateDataSource")}else{h={mode:"",savedFieldList:i.engineModule.fieldList,pageSettings:i.pageSettings,enableValueSorting:i.enableValueSorting,isDrillThrough:i.allowDrillThrough||i.editSettings.allowEditing,localeObj:i.localeObj,fieldsType:i.fieldsType,clonedReport:i.clonedReport};if(sf.base.isBlazor()&&i.enableVirtualization){d="sfBlazor";var u=window[d].copyWithoutCircularReferences([h],h),c=window[d].copyWithoutCircularReferences([i.dataSourceSettings],i.dataSourceSettings);i.interopAdaptor.invokeMethodAsync("PivotInteropMethod","renderEngine",{dataSourceSettings:c,customProperties:u}).then((function(e){i.updateBlazorData(e,i),i.allowServerDataBinding=!1,i.setProperties({pivotValues:i.engineModule.pivotValues},!0),delete i.bulkChanges.pivotValues,i.allowServerDataBinding=!0,i.enginePopulatedEventMethod("updateDataSource",i)}))}else"Server"===i.dataSourceSettings.mode?(a?i.getEngine("onSort",null,i.lastSortInfo,null,null,null,null):n?i.getEngine("onAggregation",null,null,i.lastAggregationInfo,null,null,null):o?i.getEngine("onCalcOperation",null,null,null,i.lastCalcFieldInfo,null,null):s?i.getEngine("onFilter",null,null,null,null,i.lastFilterInfo,null):i.getEngine("onDrop",null,null,null,null,null,null),i.lastSortInfo={},i.lastAggregationInfo={},i.lastCalcFieldInfo={},i.lastFilterInfo={}):(i.engineModule.renderEngine(i.dataSourceSettings,h,i.getValueCellInfo.bind(i)),i.allowServerDataBinding=!1,i.setProperties({pivotValues:i.engineModule.pivotValues},!0),delete i.bulkChanges.pivotValues,i.allowServerDataBinding=!0,i.enginePopulatedEventMethod("updateDataSource"))}}))},t.prototype.excelExport=function(e,t,i,a){this.enableVirtualization?this.excelExportModule.exportToExcel("Excel"):this.grid.excelExport(e,t,i,a)},t.prototype.csvExport=function(e,t,i,a){this.enableVirtualization?this.excelExportModule.exportToExcel("CSV"):this.grid.csvExport(e,t,i,a)},t.prototype.pdfExport=function(e,t,i,a){this.enableVirtualization?this.pdfExportModule.exportToPDF():this.grid.pdfExport(e,t,i,a)},t.prototype.chartExport=function(e,t,i,a,s){this.chart&&this.chart.enableExport&&this.chart.exportModule.export(e,t,i,null,a,s)},t.prototype.printChart=function(){this.chart&&this.chart.print()},t.prototype.onDrill=function(e,t){var i=this,a=this.dataSourceSettings.drilledMembers[0]&&this.dataSourceSettings.drilledMembers[0].delimiter?this.dataSourceSettings.drilledMembers[0].delimiter:"**",s="",n="",o="";if(t?(s=t.fieldName,n=t.cell.axis,o=t.isDrilled?"up":"down"):(s=e.parentElement.getAttribute("fieldname"),n=e.parentElement.classList.contains("e-rowsheader")?"row":"column",o=e.classList.contains(m)?"up":"down"),"pivot"===this.dataType){var l=r.cloneDrillMemberSettings(this.dataSourceSettings.drilledMembers),d=t?t.cell:this.engineModule.pivotValues[Number(e.parentElement.getAttribute("index"))][Number(e.parentElement.getAttribute("aria-colindex"))],p=d.valueSort.levelName.split(this.engineModule.valueSortSettings.headerDelimiter).join(a),h=!1;if(0===this.dataSourceSettings.drilledMembers.length)this.setProperties({dataSourceSettings:{drilledMembers:[{name:s,items:[p],delimiter:a}]}},!0);else{for(var u=r.cloneDrillMemberSettings(this.dataSourceSettings.drilledMembers),c=0;c<u.length;c++){var g=u[c];if(p=p.split(a).join(g.delimiter?g.delimiter:a),a=g.delimiter=g.delimiter?g.delimiter:a,g.name===s){h=!0;var f=g.items.indexOf(p);f>-1?g.items.splice(f,1):g.items.push(p)}}this.setProperties({dataSourceSettings:{drilledMembers:u}},!0),h||this.dataSourceSettings.drilledMembers.push({name:s,items:[p],delimiter:a})}this.showWaitingPopup();var v=this,b={fieldName:s,memberName:p,delimiter:a,axis:n,action:o,currentCell:d},S={drillInfo:b,pivotview:sf.base.isBlazor()?void 0:v,cancel:!1};v.trigger("drill",S,(function(e){if(e.cancel)i.hideWaitingPopup(),i.setProperties({dataSourceSettings:{drilledMembers:l}},!0);else{if(v.enableVirtualization)if(sf.base.isBlazor()){var t=window.sfBlazor.copyWithoutCircularReferences([v.dataSourceSettings],v.dataSourceSettings),a=window.sfBlazor.copyWithoutCircularReferences([b],b);window.sfBlazor.copyWithoutCircularReferences([S],S);v.interopAdaptor.invokeMethodAsync("PivotInteropMethod","onDrill",{dataSourceSettings:t,drilledItem:a}).then((function(e){v.updateBlazorData(e,v),v.engineModule.drilledMembers=v.dataSourceSettings.drilledMembers,v.allowServerDataBinding=!1,v.setProperties({pivotValues:v.engineModule.pivotValues},!0),delete v.bulkChanges.pivotValues,v.allowServerDataBinding=!0,v.renderPivotGrid()}))}else"Server"===i.dataSourceSettings.mode?i.getEngine("onDrill",b,null,null,null,null,null):(v.engineModule.drilledMembers=v.dataSourceSettings.drilledMembers,v.engineModule.onDrill(b));else"Server"===i.dataSourceSettings.mode?i.getEngine("onDrill",b,null,null,null,null,null):v.engineModule.generateGridData(v.dataSourceSettings);sf.base.isBlazor()&&v.enableVirtualization||(v.allowServerDataBinding=!1,v.setProperties({pivotValues:v.engineModule.pivotValues},!0),delete v.bulkChanges.pivotValues,v.allowServerDataBinding=!0,v.renderPivotGrid())}}))}else this.onOlapDrill(s,n,o,a,e,t)},t.prototype.onOlapDrill=function(e,t,i,a,s,n){var o=this,l=r.cloneDrillMemberSettings(this.dataSourceSettings.drilledMembers),d=n?n.cell:this.olapEngineModule.pivotValues[Number(s.parentElement.getAttribute("index"))][Number(s.parentElement.getAttribute("aria-colindex"))],p="row"===t?this.olapEngineModule.tupRowInfo[d.ordinal]:this.olapEngineModule.tupColumnInfo[d.ordinal],h={axis:t,action:i,fieldName:e,delimiter:"~~",memberName:p.uNameCollection,currentCell:d};this.showWaitingPopup();var u={drillInfo:h,pivotview:sf.base.isBlazor()?void 0:this,cancel:!1},c=this.olapEngineModule.fieldList[h.fieldName]&&this.olapEngineModule.fieldList[h.fieldName].isHierarchy,g=p.drillInfo.map((function(e){return e.hierarchy})).indexOf(d.hierarchy.toString()),f=r.cloneDrillMemberSettings(this.dataSourceSettings.drilledMembers);if(h&&"down"===h.action){for(var m=p.drillInfo.map((function(e){return e.uName})),v="",b=0;b<=g;b++){v=v+(""!==v?"~~":"")+(R=(A=m[b]).split("~~"))[R.length-1]}for(var S=this.olapEngineModule.getDrilledSets(h.memberName,d,this.olapEngineModule.fieldList[d.hierarchy]&&!this.olapEngineModule.fieldList[d.hierarchy].hasAllMember?d.valueSort.levelName.split(this.dataSourceSettings.valueSortSettings.headerDelimiter).length-1:g,t),y=0,C=L=Object.keys(S);y<C.length;y++)for(var w=S[C[y]],x=0,T=f.length;x<T;x++){var M=f[x],D=w;M.delimiter&&(D=D.replace(/~~/g,M.delimiter));for(var E=[],O=0;O<M.items.length;O++)0!==M.items[O].indexOf(D)&&(E[E.length]=M.items[O]);M.items=E}this.olapEngineModule.drilledSets[d.actualText]=p.members[g],h.memberName=v;for(var P=[],N=0,F=f;N<F.length;N++){(A=F[N]).name===h.fieldName&&P.push(A)}if(P.length>0){if(P[0].delimiter&&(v=v.replace(/~~/g,P[0].delimiter)),-1===r.inArray(v,P[0].items)&&P[0].items.push(v),c)for(x=0;x<P[0].items.length;)P[0].items[x]===v?P[0].items.splice(x,1):++x}else if(!c){var I={name:h.fieldName,items:[v],delimiter:"~~"};f?f.push(I):f=[I]}u.drillInfo.memberName=v,this.setProperties({dataSourceSettings:{drilledMembers:f}},!0),this.trigger("drill",u,(function(e){e.cancel?(o.hideWaitingPopup(),o.setProperties({dataSourceSettings:{drilledMembers:l}},!0)):(o.olapEngineModule.updateDrilledInfo(o.dataSourceSettings),o.allowServerDataBinding=!1,o.setProperties({pivotValues:o.olapEngineModule.pivotValues},!0),delete o.bulkChanges.pivotValues,o.allowServerDataBinding=!0,o.renderPivotGrid())}))}else{delete this.olapEngineModule.drilledSets[d.actualText];S=this.olapEngineModule.getDrilledSets(h.memberName,d,g,t);var L=Object.keys(S);for(m=p.drillInfo.map((function(e){return e.uName})),v="",b=0;b<=g;b++){var A,R;v=v+(""!==v?"~~":"")+(R=(A=m[b]).split("~~"))[R.length-1]}for(var k=0,j=L;k<j.length;k++){w=S[j[k]];var q=[];for(x=0,T=f.length;x<T;x++){var V=w;if((P=f[x]).name===h.fieldName&&q.push(P),P.delimiter&&(V=w.replace(/~~/g,P.delimiter)),!c){for(E=[],O=0;O<P.items.length;O++)0!==P.items[O].indexOf(V)&&(E[E.length]=P.items[O]);P.items=E}}if(c)if(q.length>0){q[0].delimiter&&(v=v.replace(/~~/g,q[0].delimiter)),-1===r.inArray(v,q[0].items)&&q[0].items.push(v)}else{I={name:h.fieldName,items:[v],delimiter:"~~"};f?f.push(I):f=[I]}}for(var B=[],_=0,H=f;_<H.length;_++){var U=H[_];U.items.length>0&&B.push(U)}this.setProperties({dataSourceSettings:{drilledMembers:f}},!0),this.trigger("drill",u,(function(e){e.cancel?(o.hideWaitingPopup(),o.setProperties({dataSourceSettings:{drilledMembers:l}},!0)):(o.setProperties({dataSourceSettings:{drilledMembers:B}},!0),o.olapEngineModule.updateDrilledInfo(o.dataSourceSettings),o.allowServerDataBinding=!1,o.setProperties({pivotValues:o.olapEngineModule.pivotValues},!0),delete o.bulkChanges.pivotValues,o.allowServerDataBinding=!0,o.renderPivotGrid())}))}},t.prototype.onContentReady=function(){if("Table"!==this.currentView&&this.cellTemplate&&sf.base.isBlazor()&&sf.base.resetBlazorTemplate(this.element.id+"_cellTemplate","CellTemplate"),this.isPopupClicked=!1,this.showFieldList?sf.popups.hideSpinner(this.pivotFieldListModule.fieldListSpinnerElement):this.fieldListSpinnerElement&&sf.popups.hideSpinner(this.fieldListSpinnerElement),this.isEmptyGrid?(this.isEmptyGrid=!1,this.notEmpty=!0):(("Server"===this.dataSourceSettings.mode&&this.isServerWaitingPopup||"Local"===this.dataSourceSettings.mode)&&this.hideWaitingPopup(),this.trigger("dataBound")),this.grid){var e="pivot"===this.dataType?this.engineModule:this.olapEngineModule;if(this.enableVirtualization&&e){this.element.querySelector(".e-movablecontent")&&!this.element.querySelector(".e-movablecontent").querySelector(".e-virtualtrack")&&(this.virtualDiv=sf.base.createElement("div",{className:"e-virtualtrack"}),this.element.querySelector(".e-movablecontent").appendChild(this.virtualDiv)),this.element.querySelector(".e-movableheader")&&!this.element.querySelector(".e-movableheader").querySelector(".e-virtualtrack")?(this.virtualHeaderDiv=sf.base.createElement("div",{className:"e-virtualtrack"}),this.element.querySelector(".e-movableheader").appendChild(this.virtualHeaderDiv)):this.virtualHeaderDiv=this.element.querySelector(".e-movableheader").querySelector(".e-virtualtrack");var t=this.element.querySelector(".e-movablecontent").querySelector(".e-table"),i=this.gridSettings.rowHeight*e.rowCount+.1-t.clientHeight;i>this.scrollerBrowserLimit&&(this.verticalScrollScale=i/this.scrollerBrowserLimit,i=this.scrollerBrowserLimit);var a=this.gridSettings.columnWidth*e.columnCount;a>this.scrollerBrowserLimit&&(this.horizontalScrollScale=a/this.scrollerBrowserLimit,a=this.scrollerBrowserLimit),sf.base.setStyleAttribute(this.virtualDiv,{height:(i>.1?i:.1)+"px",width:(a>.1?a:.1)+"px"}),sf.base.setStyleAttribute(this.virtualHeaderDiv,{height:0,width:(a>.1?a:.1)+"px"});var s=this.element.querySelector(".e-movablecontent"),r=this.element.querySelector(".e-frozencontent"),n=this.element.querySelector(".e-movableheader"),o=s.parentElement.scrollTop>this.scrollerBrowserLimit?s.querySelector("."+b).style.transform.split(",")[1].trim():-(s.parentElement.scrollTop*this.verticalScrollScale-this.scrollPosObject.verticalSection-s.parentElement.scrollTop)+"px)",l=s.parentElement.parentElement.querySelector("."+M).scrollLeft>this.scrollerBrowserLimit?s.querySelector("."+b).style.transform.split(",")[0].trim()+",":"translate("+-(s.parentElement.parentElement.querySelector("."+M).scrollLeft*this.horizontalScrollScale-this.scrollPosObject.horizontalSection-s.parentElement.parentElement.querySelector("."+M).scrollLeft)+"px,";sf.base.setStyleAttribute(r.querySelector(".e-table"),{transform:"translate(0px,"+o}),sf.base.setStyleAttribute(s.querySelector(".e-table"),{transform:l+o}),sf.base.setStyleAttribute(n.querySelector(".e-table"),{transform:l+0+"px)"}),this.grid.element.querySelector(".e-movablechild").style.width=a+"px","auto"!==this.grid.height?this.grid.contentModule.setHeightToContent(this.virtualDiv.offsetHeight+t.clientHeight):this.grid.contentModule.setHeightToContent(this.element.querySelector(".e-frozencontent ."+b).offsetHeight)}"Chart"!==this.currentView&&this.grid.hideScroll(),this.showGroupingBar?(this.element.style.minWidth="400px",this.grid.element.style.minWidth="400px"):(this.element.style.minWidth="310px",this.grid.element.style.minWidth="310px")}if(this.unwireEvents(),this.wireEvents(),this.isChartLoaded=!1,this.cellTemplate&&sf.base.isBlazor()){var d=Object.keys(this.gridCellCollection);if(d.length>0){for(var p=0,h=d;p<h.length;p++){var u=h[p],c={},g=this.gridCellCollection[u],f=Number(g.getAttribute("aria-colindex")),m=Number(g.getAttribute("index")),v=this.pivotValues[m][f];c.axis=v.axis,"column"===c.axis||"row"===c.axis?(c.fieldName=v.valueSort.axis,c.formattedText=v.formattedText):(c.fieldName=v.actualText,c.formattedText=v.formattedText,c.value=v.value),c.rowHeaders=v.rowHeaders,c.columnHeaders=v.columnHeaders,c.rowIndex=v.rowIndex,c.columnIndex=v.colIndex,c.isGrandTotal=v.isGrandSum,c.isTotal=v.isSum,c.rowSpan=v.rowSpan,c.columnSpan=v.colSpan,c.isDrilled=v.isDrilled,c.hasChild=v.hasChild,c.valueSortInfo=v.valueSort;var S=this.getCellTemplate()(c,this,"cellTemplate",this.element.id+"_cellTemplate");S&&""!==S&&S.length>0&&(this.enableHtmlSanitizer?this.appendHtml(g,sf.base.SanitizeHtmlHelper.sanitize(S[0].outerHTML)):this.appendHtml(g,S[0].outerHTML))}sf.base.updateBlazorTemplate(this.element.id+"_cellTemplate","CellTemplate",this)}}},t.prototype.setToolTip=function(e){var t,i,a=Number(e.target.getAttribute("aria-colindex")),s=Number(e.target.getAttribute("index")),r=this.dataSourceSettings.values.length>0&&this.pivotValues&&this.pivotValues[s]&&this.pivotValues[s][a]?this.pivotValues[s][a]:void 0;this.tooltip.content="";var n,o=!1;r&&"olap"===this.dataType?this.olapEngineModule.fieldList[r.actualText]&&(t=(n=this.olapEngineModule.fieldList[r.actualText]).isCalculatedField?n.type:n.aggregateType,i=this.olapEngineModule.dataFields[r.actualText]&&this.olapEngineModule.dataFields[r.actualText].caption?this.olapEngineModule.dataFields[r.actualText].caption:n.caption,o=!0):r&&this.engineModule.fieldList[r.actualText]&&(t=(n=this.engineModule.fieldList[r.actualText]).aggregateType,i=n.caption,o=!0);if(r&&o){var l=this.getRowText(s,0),d=this.getColText(0,a,s),p="0"===r.formattedText||""===r.formattedText?this.localeObj.getConstant("noValue"):r.formattedText;if(this.tooltipTemplate&&void 0!==this.getTooltipTemplate()){var h={rowHeaders:l,columnHeaders:d,aggregateType:t,valueField:i,value:p,rowFields:this.getHeaderField(s,a,"row"),columnFields:this.getHeaderField(s,a,"column")};this.tooltip.content=this.getTooltipTemplate()(h,this,"tooltipTemplate",this.element.id+"tooltipTemplate")[0].outerHTML}else this.tooltip.content="<div class=e-pivottooltip><p class=e-tooltipheader>"+this.localeObj.getConstant("row")+":</p><p class=e-tooltipcontent>"+l+"</p></br><p class=e-tooltipheader>"+this.localeObj.getConstant("column")+":</p><p class=e-tooltipcontent>"+d+"</p></br>"+(""!==r.actualText?"<p class=e-tooltipheader>"+("olap"===this.dataType?"":this.localeObj.getConstant(t)+" "+this.localeObj.getConstant("of")+" ")+i+":</p><p class=e-tooltipcontent>"+p+"</p></div>":"")}else e.cancel=!0},t.prototype.getTooltipTemplate=function(){return this.tooltipTemplateFn},t.prototype.getHeaderField=function(e,t,i){var a,s="",r="olap"===this.dataType?this.olapEngineModule:this.engineModule,n=r.valueSortSettings.headerDelimiter;if("row"===i){a=this.pivotValues[e][0].valueSort.levelName.toString().split(n).length;for(var o=0;o<a&&r.rows.length>0&&r.rows[o];o++)s+=(o?" - ":"")+(r.rows[o].caption?r.rows[o].caption:r.rows[o].name)}else{if(r.columns.length>0){var l=0===r.values.length?0:Number(Object.keys(r.headerContent)[Object.keys(r.headerContent).length-1]);a=this.pivotValues[l][t].valueSort.levelName.toString().split(n).length,a=r.values.length>1?a-1:a}for(var d=0;d<a&&r.columns.length>0&&r.columns[d];d++)s+=(d?" - ":"")+(r.columns[d].caption?r.columns[d].caption:r.columns[d].name)}return s},t.prototype.getRowText=function(e,t){for(var i=this.pivotValues[e][t],a=i.level,s="grand sum"===i.type?this.localeObj.getConstant("grandTotal"):i.formattedText;a>0||void 0===i.index;)e--,void 0!==(i=this.pivotValues[e][t]).index&&a>i.level&&(s=s+" - "+i.formattedText,a-=1);return s.split(" - ").reverse().join(" - ")},t.prototype.getColText=function(e,t,i){for(var a=this.pivotValues[0][t],s=a.axis,r="grand sum"===a.type?this.localeObj.getConstant("grandTotal"):a.formattedText;"value"!==s&&i>e;)e++,this.pivotValues[e]&&(s=(a=this.pivotValues[e][t]).axis,"sum"!==a.type&&"grand sum"!==a.type&&"value"!==s&&(r=r+" - "+a.formattedText));return r},t.prototype.updateClass=function(){this.enableRtl?sf.base.addClass([this.element],c):sf.base.removeClass([this.element],c),this.isAdaptive?sf.base.addClass([this.element],g):sf.base.removeClass([this.element],g)},t.prototype.mouseRclickHandler=function(e){(3===e.which||0===e.which)&&(this.lastCellClicked=e.target),this.lastCellClicked=e.target},t.prototype.mouseDownHandler=function(e){if(3===e.which&&(this.lastCellClicked=e.target),this.isCellBoxMultiSelection){this.isMouseDown=!0,this.isMouseUp=!1;var t=this.parentAt(e.target,"TH");this.clearSelection(t,e,Number(t.getAttribute("aria-colindex")),Number(t.getAttribute("index"))),this.lastSelectedElement=void 0}},t.prototype.mouseMoveHandler=function(e){if(this.isCellBoxMultiSelection&&(e.preventDefault(),this.isMouseDown&&e.target)){var t=e.target,i=this.parentAt(t,"TH");this.lastSelectedElement&&this.lastSelectedElement!==i&&i.classList.contains(E)?(this.lastSelectedElement.classList.remove("e-active"),this.lastSelectedElement.classList.remove(E),this.lastSelectedElement=i):(this.lastSelectedElement=i,i.classList.add("e-active"),i.classList.add(E)),this.renderModule.selected()}},t.prototype.mouseUpHandler=function(e){this.isCellBoxMultiSelection&&(this.isMouseDown=!1,this.isMouseUp=!0)},t.prototype.parentAt=function(e,t){for(;e.tagName!==t&&e.parentElement;)e=e.parentElement;return e},t.prototype.mouseClickHandler=function(e){(3===e.which||0===e.which)&&(this.lastCellClicked=e.target);var t=e.target;if((t.classList.contains("e-headercell")||t.classList.contains("e-headercelldiv")||t.classList.contains("e-rowsheader")||t.classList.contains("e-rowcell")||t.classList.contains("e-stackedheadercelldiv")||t.classList.contains("e-headertext")||t.classList.contains("e-ascending")||t.classList.contains("e-descending"))&&this.enableValueSorting&&"pivot"===this.dataType){var i=null;if(t.classList.contains("e-headercell")||t.classList.contains("e-rowsheader")||t.classList.contains("e-rowcell")?i=t:t.classList.contains("e-stackedheadercelldiv")||t.classList.contains("e-headercelldiv")||t.classList.contains("e-ascending")||t.classList.contains("e-descending")?i=t.parentElement:t.classList.contains("e-headertext")&&(i=t.parentElement.parentElement),this.CellClicked(t,e),i.parentElement.parentElement.parentElement.parentElement.classList.contains("e-movableheader")&&"column"===this.dataSourceSettings.valueAxis||i.parentElement.classList.contains("e-row")&&"row"===this.dataSourceSettings.valueAxis&&(i.classList.contains("e-rowsheader")||i.classList.contains("e-stot"))){var a=Number(i.getAttribute("aria-colindex")),s=Number(i.getAttribute("index"));"row"===this.dataSourceSettings.valueAxis&&(this.dataSourceSettings.values.length>1||this.dataSourceSettings.alwaysShowValueHeader)?s="value"===this.pivotValues[s][a].type?s:s+1:"column"===this.dataSourceSettings.valueAxis&&(this.dataSourceSettings.values.length>1||this.dataSourceSettings.alwaysShowValueHeader)&&(a=Number(i.getAttribute("aria-colindex"))+Number(i.getAttribute("aria-colspan"))-1,s=this.engineModule.headerContent.length-1),this.setProperties({dataSourceSettings:{valueSortSettings:{columnIndex:Number(i.getAttribute("aria-colindex"))+Number(i.getAttribute("aria-colspan"))-1,sortOrder:"Descending"===this.dataSourceSettings.valueSortSettings.sortOrder?"Ascending":"Descending",headerText:this.pivotValues[s][a].valueSort.levelName,headerDelimiter:this.dataSourceSettings.valueSortSettings.headerDelimiter?this.dataSourceSettings.valueSortSettings.headerDelimiter:"."}}},!0),this.showWaitingPopup();var r=this;if(r.engineModule.enableValueSorting=!0,r.enableVirtualization){if(r.dataSourceSettings.enableSorting){for(var n=0,o=Object.keys(r.engineModule.fieldList);n<o.length;n++){var l=o[n];r.engineModule.fieldList[l].sort="Ascending"}r.setProperties({dataSourceSettings:{sortSettings:[]}},!0)}sf.base.isBlazor()?r.interopAdaptor.invokeMethodAsync("PivotInteropMethod","applyValueSorting",{valueSortSettings:r.dataSourceSettings.valueSortSettings.properties}).then((function(e){r.updateBlazorData(e,r),r.allowServerDataBinding=!1,r.setProperties({pivotValues:r.engineModule.pivotValues},!0),delete r.bulkChanges.pivotValues,r.allowServerDataBinding=!0,r.renderPivotGrid()})):"Server"===r.dataSourceSettings.mode?r.getEngine("onValueSort",null,null,null,null,null,null):(r.engineModule.rMembers=r.engineModule.headerCollection.rowHeaders,r.engineModule.cMembers=r.engineModule.headerCollection.columnHeaders,r.engineModule.applyValueSorting(),r.engineModule.updateEngine())}else"Server"===r.dataSourceSettings.mode?r.getEngine("onValueSort",null,null,null,null,null,null):r.engineModule.generateGridData(r.dataSourceSettings);sf.base.isBlazor()&&r.enableVirtualization||(r.allowServerDataBinding=!1,r.setProperties({pivotValues:r.engineModule.pivotValues},!0),delete r.bulkChanges.pivotValues,r.allowServerDataBinding=!0,r.renderPivotGrid())}}else{if(!t.classList.contains(m)&&!t.classList.contains(v))return void this.CellClicked(t,e);this.onDrill(t)}},t.prototype.updateTotColWidth=function(){this.totColWidth=0;for(var e=0,t=this.pivotColumns;e<t.length;e++){var i=t[e];this.totColWidth=this.totColWidth+i.width}},t.prototype.framePivotColumns=function(e){for(var t=0,i=e;t<i.length;t++){var a=i[t];if(a.columns&&a.columns.length>0)this.framePivotColumns(a.columns);else{var s="0.formattedText"===a.field?"":a.customAttributes?a.customAttributes.cell.valueSort.levelName:"",r=this.renderModule.setSavedWidth("0.formattedText"===a.field?a.field:s,Number("auto"===a.width?a.minWidth:a.width));this.pivotColumns.push({allowReordering:a.allowReordering,allowResizing:a.allowResizing,headerText:s,width:r}),this.totColWidth=this.totColWidth+Number(r)}}},t.prototype.setGridColumns=function(e){if(!sf.base.isNullOrUndefined(this.totColWidth)&&this.totColWidth>0){for(var t=0,i=e;t<i.length;t++){var a=i[t];if(a.columns&&a.columns.length>0)this.setGridColumns(a.columns);else{var s="0.formattedText"===a.field?"":a.customAttributes?a.customAttributes.cell.valueSort.levelName:"";a.allowReordering=this.pivotColumns[this.posCount].allowReordering,a.allowResizing=this.pivotColumns[this.posCount].allowResizing;var r=this.renderModule.setSavedWidth("0.formattedText"===a.field?a.field:s,Number(this.pivotColumns[this.posCount].width));"auto"!==a.width?a.width=r:a.minWidth=r,this.posCount++,a.allowReordering&&(this.gridSettings.allowReordering=!0),a.allowResizing&&(this.gridSettings.allowResizing=!0)}}this.gridSettings.allowReordering&&sf.grids.Grid.Inject(sf.grids.Reorder),this.gridSettings.allowResizing&&sf.grids.Grid.Inject(sf.grids.Resize)}},t.prototype.fillGridColumns=function(e){for(var t=0,i=e;t<i.length;t++){var a=i[t];a.allowReordering=this.gridSettings.allowReordering,a.allowResizing=this.gridSettings.allowResizing,this.posCount++,a.columns&&a.columns.length>0&&this.fillGridColumns(a.columns)}},t.prototype.triggerColumnRenderEvent=function(e){this.pivotColumns=[],this.totColWidth=0,this.framePivotColumns(e);var t=this.pivotColumns[0].width,i={columns:this.pivotColumns,dataSourceSettings:this.dataSourceSettings};this.trigger("beforeColumnsRender",i),this.updateTotColWidth(),t!==this.pivotColumns[0].width&&(this.firstColWidth=this.pivotColumns[0].width,this.renderModule.resColWidth=parseInt(this.firstColWidth.toString())),this.posCount=0,this.setGridColumns(e)},t.prototype.setCommonColumnsWidth=function(e,t){for(var i=0,a=e;i<a.length;i++){var s=a[i];"0.formattedText"!==s.field?s.columns?this.setCommonColumnsWidth(s.columns,t):"auto"!==s.width?s.width=t:s.minWidth=t:s.width=this.firstColWidth?this.firstColWidth:s.width}},t.prototype.getHeightAsNumber=function(){var e;return isNaN(this.height)?this.height.toString().indexOf("%")>-1?e=parseFloat(this.height.toString())/100*this.element.offsetHeight:this.height.toString().indexOf("px")>-1&&(e=Number(this.height.toString().split("px")[0])):e=Number(this.height),e<300&&(e=300),e},t.prototype.getWidthAsNumber=function(){var e;return isNaN(this.width)?(this.width.toString().indexOf("%")>-1?e=parseFloat(this.width.toString())/100*this.element.offsetWidth:this.width.toString().indexOf("px")>-1&&(e=Number(this.width.toString().split("px")[0])),isNaN(e)&&(e=this.element.offsetWidth)):e=Number(this.width),e<400&&(e=400),e},t.prototype.getGridWidthAsNumber=function(){var e,t=this.element.offsetWidth?this.element.offsetWidth:this.element.getBoundingClientRect().width;return isNaN(this.grid.width)?(this.grid.width.toString().indexOf("%")>-1?e=parseFloat(this.grid.width.toString())/100*t:this.grid.width.toString().indexOf("px")>-1&&(e=Number(this.grid.width.toString().split("px")[0])),isNaN(e)&&(e=t)):e=Number(this.grid.width),e},t.prototype.onWindowResize=function(){clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.layoutRefresh.bind(this),500)},t.prototype.refresh=function(){sf.base.isBlazor()?this.layoutRefresh():this.pivotRefresh()},t.prototype.layoutRefresh=function(){if(this.element&&this.element.classList.contains("e-pivotview")&&("olap"===this.dataType?this.olapEngineModule&&this.olapEngineModule.pivotValues:this.engineModule&&this.engineModule.pivotValues)){if(this.grid){var e="olap"===this.dataType&&this.olapEngineModule.pivotValues.length>0?this.olapEngineModule.pivotValues[0].length:this.dataSourceSettings.values.length>0&&this.engineModule.pivotValues.length>0?this.engineModule.pivotValues[0].length:2,t=this.renderModule.resizeColWidth(e);this.grid.width=this.renderModule.calculateGridWidth(),this.renderModule.calculateGridHeight(!0),this.gridSettings.allowAutoResizing&&this.setCommonColumnsWidth(this.grid.columns,t),this.pivotColumns=[],this.totColWidth=0,this.framePivotColumns(this.grid.columns),this.posCount=0,this.showGroupingBar||this.setGridColumns(this.grid.columns),"Table"===this.currentView&&this.cellTemplate&&sf.base.isBlazor()&&sf.base.resetBlazorTemplate(this.element.id+"_cellTemplate","CellTemplate"),this.grid.refreshColumns(),this.showGroupingBar&&this.groupingBarModule&&this.element.querySelector(".e-grouping-bar")&&this.groupingBarModule.setGridRowWidth()}this.showToolbar&&this.toolbarModule&&this.toolbarModule.toolbar&&(this.toolbarModule.toolbar.width=this.grid?this.getGridWidthAsNumber()-2:this.getWidthAsNumber()-2),this.chart&&(this.showToolbar&&"Chart"===this.currentView||!this.showToolbar)&&(this.chart.width=this.showToolbar&&this.grid||"Both"===this.displayOption.view&&this.grid?this.getGridWidthAsNumber().toString():this.getWidthAsNumber().toString(),"Chart"===this.displayOption.view&&this.showGroupingBar&&this.groupingBarModule&&this.element.querySelector(".e-chart-grouping-bar")&&this.groupingBarModule.refreshUI())}},t.prototype.CellClicked=function(e,t){var i=this,a=null;if(e.classList.contains("e-headercell")||e.classList.contains("e-rowcell")?a=e:e.classList.contains("e-stackedheadercelldiv")||e.classList.contains("e-cellvalue")||e.classList.contains("e-headercelldiv")?a=e.parentElement:e.classList.contains("e-headertext")?a=e.parentElement.parentElement:e.classList.contains("e-rowselect")&&(e.classList.contains("e-spanclicked")?this.isPopupClicked=!1:this.isPopupClicked=!0),a&&!sf.base.isNullOrUndefined(this.pivotValues)&&this.pivotValues.length>0){var s=Number(a.getAttribute("aria-colindex")),r=Number(a.getAttribute("index")),n=Number(a.getAttribute("aria-colspan")),o={cancel:!1,isCellClick:!0,currentCell:a,data:this.pivotValues[r][s]};this.trigger("cellSelecting",o,(function(e){i.gridSettings.allowSelection&&(("Both"===i.gridSettings.selectionSettings.mode?a.classList.contains("e-rowcell"):"Row"===i.gridSettings.selectionSettings.mode)?i.clearSelection(a,t,s,r):(i.clearSelection(a,t,s,r),e.cancel||i.applyColumnSelection(t,a,s,s+(n>0?n-1:0),r)),"Column"===i.gridSettings.selectionSettings.mode||a.classList.contains("e-columnsheader")||i.rowDeselect(a,t,r,i.gridSettings.selectionSettings.mode,e),"Column"===i.gridSettings.selectionSettings.mode||e.cancel||(("Multiple"===i.gridSettings.selectionSettings.type?t.ctrlKey||t.shiftKey:i.selectedRowIndex===r)?i.selectedRowIndex=void 0:(i.selectedRowIndex=r,i.grid.selectionModule.selectRow(r-i.renderModule.rowStartPos)))),i.cellClick&&e.isCellClick&&i.trigger("cellClick",{currentCell:a,data:i.pivotValues[r][s],nativeEvent:t}),i.getSelectedCellsPos()}))}},t.prototype.rowDeselect=function(e,t,i,a,s){if(!t.shiftKey&&!t.ctrlKey&&"Both"!==this.gridSettings.selectionSettings.mode||"Single"===this.gridSettings.selectionSettings.type)if(e.classList.contains(D)||e.classList.contains(E)||e.classList.contains("e-active")){if(sf.base.removeClass(this.element.querySelectorAll("."+D),D),sf.base.removeClass(this.element.querySelectorAll("."+E),E),sf.base.removeClass(this.element.querySelectorAll(".e-active"),"e-active"),s.cancel)this.setSavedSelectedCells();else if("Cell"===a)sf.base.addClass([e],[D]);else if("Row"===a||"Single"===this.gridSettings.selectionSettings.type){var r='[index="'+i+'"]';sf.base.addClass(this.element.querySelectorAll(r),[E,"e-active"]),"Row"!==a&&e.classList.add(D)}}else s.cancel?this.setSavedSelectedCells():(sf.base.removeClass(this.element.querySelectorAll("."+D),D),sf.base.removeClass(this.element.querySelectorAll("."+E),E),sf.base.removeClass(this.element.querySelectorAll(".e-active"),"e-active"));else(t.shiftKey||t.ctrlKey||"Both"==this.gridSettings.selectionSettings.mode)&&s.cancel&&(sf.base.removeClass(this.element.querySelectorAll("."+D),D),sf.base.removeClass(this.element.querySelectorAll("."+E),E),sf.base.removeClass(this.element.querySelectorAll(".e-active"),"e-active"),this.setSavedSelectedCells())},t.prototype.clearSelection=function(e,t,i,a){if(!t.shiftKey&&!t.ctrlKey||"Single"===this.gridSettings.selectionSettings.type)if("Cell"===this.gridSettings.selectionSettings.mode)e.classList.contains("e-columnsheader")?sf.base.removeClass(this.element.querySelectorAll(".e-rowcell."+D),D):sf.base.removeClass(this.element.querySelectorAll(".e-columnsheader.e-active"),["e-active",E]);else if("Both"===this.gridSettings.selectionSettings.mode)if(e.classList.contains("e-rowcell"))for(var s=0,r=[].slice.call(this.element.querySelectorAll("."+E+", ."+D));s<r.length;s++){var n=r[s];sf.base.removeClass([n],["e-active",E,D])}else sf.base.removeClass(this.element.querySelectorAll("."+D),D)},t.prototype.applyRowSelection=function(e,t,i){var a=this.engineModule.pivotValues[t][e];if(i.ctrlKey||i.shiftKey||!a||this.selectedRowIndex===t)this.selectedRowIndex=void 0;else{this.selectedRowIndex=t;var s=a.level,r=t;do{r++,a=this.engineModule.pivotValues[r][e]}while(a&&s<a.level);this.isAdaptive?this.rowRangeSelection={enable:!0,startIndex:t-this.renderModule.rowStartPos,endIndex:r-(1+this.renderModule.rowStartPos)}:this.grid.selectionModule.selectRowsByRange(t-this.renderModule.rowStartPos,r-(1+this.renderModule.rowStartPos))}},t.prototype.applyColumnSelection=function(e,t,i,a,s){if(!t.classList.contains("e-rowsheader")&&("Cell"!==this.gridSettings.selectionSettings.mode||t.classList.contains("e-columnsheader"))){var r=e.ctrlKey;this.isAdaptive&&"Multiple"===this.gridSettings.selectionSettings.type&&(this.grid.selectionModule.showPopup(e),this.isPopupClicked?(this.element.querySelector(".e-rowselect").classList.add("e-spanclicked"),r=!0):(this.element.querySelector(".e-rowselect").classList.remove("e-spanclicked"),r=!1));for(var n=[],o=this.gridSettings.selectionSettings.type,l=t.classList.contains("e-active"),d=[],p={},h=i;h<=a;h++)d.push(h.toString());if(r&&"Single"!==o)l=!1;else{for(var u=0,c=[].slice.call(this.element.querySelectorAll(".e-active"));u<c.length;u++){var g=c[u];sf.base.removeClass([g],["e-active",E]),-1===d.indexOf(g.getAttribute("aria-colindex"))&&(l=!1);var f=Number(g.getAttribute("aria-colindex"));p[f]=f}d=Object.keys(p).length>0?Object.keys(p).sort((function(e,t){return e-t})):d}"Multiple"===o&&e.shiftKey?(this.shiftLockedPos=0===this.shiftLockedPos.length?d:this.shiftLockedPos,Number(this.shiftLockedPos[0])<=i?i=Number(this.shiftLockedPos[0]):a=a<Number(this.shiftLockedPos[this.shiftLockedPos.length-1])?Number(this.shiftLockedPos[this.shiftLockedPos.length-1]):a):this.shiftLockedPos=[];var m=[];if(e.ctrlKey&&"Both"===this.gridSettings.selectionSettings.mode&&"Multiple"===o&&!t.classList.contains("e-rowsheader"))for(var v=0,b=[].slice.call(this.element.querySelectorAll(".e-rowsheader."+D));v<b.length;v++){g=b[v];m.push(g.getAttribute("index"))}for(var S=i;S<=a;)n.push('[aria-colindex="'+S+'"]'+("Cell"===this.gridSettings.selectionSettings.mode?'[index="'+s+'"]':"")),S++;if(!l){s=t.classList.contains("e-headercell")?s:this.renderModule.rowStartPos-1;for(var y=t.classList.contains("e-active"),C=0,w=[].slice.call(this.element.querySelectorAll(n.toString()));C<w.length;C++){g=w[C];Number(g.getAttribute("index"))>=s&&(y&&r&&-1===m.indexOf(g.getAttribute("index"))?sf.base.removeClass([g],["e-active",E]):sf.base.addClass([g],["e-active",E]))}}this.renderModule.selected()}},t.prototype.getSelectedCellsPos=function(){this.savedSelectedCellsPos=[],this.cellSelectionPos=[];for(var e=0,t=[].slice.call(this.element.querySelectorAll("."+E));e<t.length;e++){var i=t[e];this.savedSelectedCellsPos.push({rowIndex:i.getAttribute("index"),colIndex:i.getAttribute("aria-colindex")})}for(var a=0,s=[].slice.call(this.element.querySelectorAll("."+D));a<s.length;a++){i=s[a];this.cellSelectionPos.push({rowIndex:i.getAttribute("index"),colIndex:i.getAttribute("aria-colindex")})}},t.prototype.setSavedSelectedCells=function(){for(var e=0,t=[].slice.call(this.savedSelectedCellsPos);e<t.length;e++){var i='[aria-colindex="'+(r=t[e]).colIndex+'"][index="'+r.rowIndex+'"]';sf.base.addClass([this.element.querySelector(i)],["e-active",E])}for(var a=0,s=[].slice.call(this.cellSelectionPos);a<s.length;a++){var r;i='[aria-colindex="'+(r=s[a]).colIndex+'"][index="'+r.rowIndex+'"]';sf.base.addClass([this.element.querySelector(i)],[D])}},t.prototype.renderEmptyGrid=function(){var e=this;this.isEmptyGrid=!0,this.notEmpty=!1,this.renderModule=new A(this),this.grid&&this.grid.element&&this.element.querySelector(".e-grid")?(this.notEmpty=!0,this.grid.setProperties({columns:this.renderModule.frameEmptyColumns(),dataSource:this.renderModule.frameEmptyData()},!0),this.grid.notify("datasource-modified",{}),this.grid.refreshColumns()):(this.element.querySelector(".e-grid")&&sf.base.remove(this.element.querySelector(".e-grid")),this.renderModule.bindGrid(this,!0),this.grid.showSpinner=function(){},this.grid.hideSpinner=function(){},this.element.appendChild(sf.base.createElement("div",{id:this.element.id+"_grid"})),this.grid.isStringTemplate=!0,this.grid.appendTo("#"+this.element.id+"_grid"),this.grid.on("refresh-frozen-height",(function(){e.enableVirtualization||e.grid.contentModule.setHeightToContent(e.grid.contentModule.getTable().offsetHeight)})),this.grid.off("data-ready",this.grid.dataReady),this.grid.on("data-ready",(function(){e.grid.scrollModule.setWidth(),e.grid.scrollModule.setHeight()})))},t.prototype.initEngine=function(){var e=this;if("pivot"===this.dataType){var t=sf.base.isNullOrUndefined(this.dataSourceSettings.dataSource)?sf.base.isNullOrUndefined(this.engineModule.data)?void 0:this.engineModule.data[0]:this.dataSourceSettings.dataSource[0];if(t&&this.pivotCommon){var i="[object Array]"==Object.prototype.toString.call(t);if(i&&"JSON"===this.dataSourceSettings.type)return void this.pivotCommon.errorDialog.createErrorDialog(this.localeObj.getConstant("error"),this.localeObj.getConstant("invalidJSON"));if(!i&&"CSV"===this.dataSourceSettings.type)return void this.pivotCommon.errorDialog.createErrorDialog(this.localeObj.getConstant("error"),this.localeObj.getConstant("invalidCSV"))}}var a={dataSourceSettings:r.getClonedDataSourceSettings(this.dataSourceSettings)};this.trigger("enginePopulating",a,(function(t){r.updateDataSourceSettings(e,t.dataSourceSettings),e.updatePageSettings(!1);var i={mode:"",savedFieldList:void 0,pageSettings:e.pageSettings,enableValueSorting:e.enableValueSorting,isDrillThrough:e.allowDrillThrough||e.editSettings.allowEditing,localeObj:e.localeObj,fieldsType:e.fieldsType,clonedReport:e.clonedReport};if("pivot"===e.dataType){if(e.dataSourceSettings.groupSettings&&e.dataSourceSettings.groupSettings.length>0){var a=e.engineModule.data;if(e.clonedDataSet=e.clonedDataSet?e.clonedDataSet:r.getClonedData(a),sf.base.isBlazor())e.clonedReport=e.clonedReport?e.clonedReport:sf.base.extend({},e.dataSourceSettings,null,!0);else{var s=JSON.parse(e.getPersistData()).dataSourceSettings;s.dataSource=[],e.clonedReport=e.clonedReport?e.clonedReport:s}}if(sf.base.isBlazor()&&e.enableVirtualization){var n=e,o=window.sfBlazor.copyWithoutCircularReferences([i],i),l=window.sfBlazor.copyWithoutCircularReferences([n.dataSourceSettings],n.dataSourceSettings);n.interopAdaptor.invokeMethodAsync("PivotInteropMethod","renderEngine",{dataSourceSettings:l,customProperties:o}).then((function(t){0!==t?(n.updateBlazorData(t,n),r.setPivotProperties(n,{pivotValues:n.engineModule.pivotValues}),n.enginePopulatedEventMethod("initEngine",n)):e.pivotCommon.errorDialog.createErrorDialog(e.localeObj.getConstant("error"),"CSV"===n.dataSourceSettings.type?e.localeObj.getConstant("invalidCSV"):e.localeObj.getConstant("invalidJSON"))}))}else"Server"!==e.dataSourceSettings.mode&&e.engineModule.renderEngine(e.dataSourceSettings,i,e.getValueCellInfo.bind(e)),e.allowServerDataBinding=!1,e.setProperties({pivotValues:e.engineModule.pivotValues},!0),delete e.bulkChanges.pivotValues,e.allowServerDataBinding=!0,e.enginePopulatedEventMethod("initEngine")}else"SSAS"===e.dataSourceSettings.providerType&&"olap"===e.dataType&&(i.savedFieldList=e.olapEngineModule.fieldList,i.savedFieldListData=e.olapEngineModule.fieldListData,e.olapEngineModule.renderEngine(e.dataSourceSettings,i),e.allowServerDataBinding=!1,e.setProperties({pivotValues:e.olapEngineModule.pivotValues},!0),delete e.bulkChanges.pivotValues,e.allowServerDataBinding=!0,e.enginePopulatedEventMethod("initEngine"))}))},t.prototype.enginePopulatedEventMethod=function(e,t){var i=this;if("initEngine"===e){var a=t||this;this.trigger("enginePopulated",{pivotValues:this.pivotValues},(function(e){"olap"===a.dataType?(a.olapEngineModule.pivotValues=sf.base.isBlazor()?i.olapEngineModule.pivotValues:e.pivotValues,a.pivotValues=a.olapEngineModule.pivotValues):(a.engineModule.pivotValues=sf.base.isBlazor()?i.engineModule.pivotValues:e.pivotValues,a.pivotValues=a.engineModule.pivotValues),a.notify(h,{}),a.notEmpty=!0}))}else{var s=t||this,r={dataSourceSettings:s.dataSourceSettings,pivotValues:sf.base.isBlazor()?"olap"===s.dataType?s.olapEngineModule.pivotValues:s.engineModule.pivotValues:s.pivotValues};s.trigger("enginePopulated",r,(function(e){var t=s.dataSourceSettings.dataSource;sf.base.isBlazor()&&e.dataSourceSettings.dataSource instanceof Object&&(e.dataSourceSettings.dataSource=t),s.dataSourceSettings=e.dataSourceSettings,"olap"===s.dataType?(s.olapEngineModule.pivotValues=sf.base.isBlazor()?s.olapEngineModule.pivotValues:e.pivotValues,s.allowServerDataBinding=!1,s.setProperties({pivotValues:s.olapEngineModule.pivotValues},!0),delete s.bulkChanges.pivotValues,s.allowServerDataBinding=!0):(s.engineModule.pivotValues=sf.base.isBlazor()?s.engineModule.pivotValues:e.pivotValues,s.allowServerDataBinding=!1,s.setProperties({pivotValues:s.engineModule.pivotValues},!0),delete s.bulkChanges.pivotValues,s.allowServerDataBinding=!0),s.pivotCommon.engineModule="olap"===s.dataType?s.olapEngineModule:s.engineModule,s.pivotCommon.dataSourceSettings=s.dataSourceSettings,s.renderPivotGrid()}))}},t.prototype.updateBlazorData=function(e,t){var i,a,s,n;t.allowServerDataBinding=!1;var o,l,d=t;a=JSON.parse(e.fieldList),i=JSON.parse(e.pivotValue),s=JSON.parse(e.fields),n=JSON.parse(e.valueSortSettings);var p=i.length,h=JSON.parse(i[0]).length,u=new Array(p);for(c=0;c<p;c++)u[c]=new Array(h);for(var c=0;c<p;c++)if(null!=i[c])for(var g=JSON.parse(i[c]),f=g.length,m=0;m<f;m++)u[c][m]=g[m];else u[c]=void 0;for(var v,b=u,S=0;S<b.length;S++)if(b[S]&&b[S][0]&&"row"===b[S][0].axis){v=S;break}d.pivotValues=u,o=r.frameContent(u,"value",v,d),l=r.frameContent(u,"header",v,d),this.engineModule.pivotValues=u,this.engineModule.fieldList=a,this.engineModule.fields=s,this.engineModule.valueSortSettings=n,this.engineModule.valueContent=o,this.engineModule.headerContent=l,this.engineModule.isEngineUpdated=JSON.parse(e.isEngineUpdated),this.engineModule.isEmptyData=JSON.parse(e.isEmptyData),this.engineModule.rowCount=JSON.parse(e.rowCount),this.engineModule.columnCount=JSON.parse(e.columnCount),this.engineModule.rowStartPos=JSON.parse(e.rowStartPos),this.engineModule.colStartPos=JSON.parse(e.colStartPos),this.engineModule.rowFirstLvl=JSON.parse(e.rowFirstLvl),this.engineModule.colFirstLvl=JSON.parse(e.colFirstLvl),t.allowServerDataBinding=!0},t.prototype.generateData=function(){"Chart"!==this.displayOption.view&&this.renderEmptyGrid(),this.showWaitingPopup()},t.prototype.refreshData=function(){this.isStaticRefresh?this.isStaticRefresh=!1:(sf.base.isBlazor()&&"olap"===this.dataType&&this.dataSourceSettings.dataSource instanceof sf.data.DataManager&&(this.allowServerDataBinding=!1,this.setProperties({dataSourceSettings:{dataSource:void 0}},!0),this.allowServerDataBinding=!0),this.dataSourceSettings&&(this.dataSourceSettings.dataSource||this.dataSourceSettings.url)?this.dataSourceSettings.dataSource instanceof sf.data.DataManager?sf.base.isBlazor()&&this.enableVirtualization?(this.element.querySelector(".e-spinner-pane")||this.showWaitingPopup(),this.initEngine()):"pivot"===this.dataType&&this.remoteData.length>0?(this.element.querySelector(".e-spinner-pane")||this.showWaitingPopup(),this.engineModule.data=this.remoteData,this.initEngine()):setTimeout(this.getData.bind(this),100):""!==this.dataSourceSettings.url&&"olap"===this.dataType||this.dataSourceSettings.dataSource&&this.dataSourceSettings.dataSource.length>0||this.engineModule.data.length>0?("pivot"===this.dataType&&(this.hideWaitingPopup(),this.engineModule.data=this.dataSourceSettings.dataSource),this.initEngine()):"Server"===this.dataSourceSettings.mode?this.getEngine("onRefresh"):this.hideWaitingPopup():sf.base.isBlazor()&&"pivot"===this.dataType&&this.engineModule.data&&this.engineModule.data.length>0?this.initEngine():this.hideWaitingPopup())},t.prototype.getValueCellInfo=function(e){var t=e;return this.trigger("aggregateCellInfo",t),t},t.prototype.bindTriggerEvents=function(e){this.trigger(sf.grids.getObject("name",e),e)},t.prototype.getData=function(){sf.base.isBlazor()?this.dataSourceSettings.dataSource.executeQuery((new sf.data.Query).requiresCount()).then(this.executeQuery.bind(this)):this.dataSourceSettings.dataSource.executeQuery(new sf.data.Query).then(this.executeQuery.bind(this))},t.prototype.executeQuery=function(e){this.element.querySelector(".e-spinner-pane")||this.showWaitingPopup();this.engineModule.data=e.result,!sf.base.isNullOrUndefined(this.engineModule.data)&&this.engineModule.data.length>0?this.initEngine():this.hideWaitingPopup()},t.prototype.applyFormatting=function(e){if(e){for(var t=[],i=e.length,a=0;a<i;a++)void 0!==e[a]&&void 0===e[a][0]&&t.push(a);for(a=0;a<e.length;a++)for(var s=1;e[a]&&s<e[a].length;s++)if("value"===e[a][s].axis&&""!==e[a][s].formattedText){e[a][s].style=void 0,e[a][s].cssClass=void 0;for(var r=this.dataSourceSettings.conditionalFormatSettings,n=0;n<r.length;n++)(!0===r[n].applyGrandTotals||sf.base.isNullOrUndefined(r[n].applyGrandTotals)||""!==e[a][s].rowHeaders&&""!==e[a][s].columnHeaders)&&this.checkCondition(e[a][s].value,r[n].conditions,r[n].value1,r[n].value2)&&(r[n].measure&&e[a][s].actualText!==r[n].measure||void 0!==r[n].measure&&""===r[n].measure||void 0!==r[n].label&&""===r[n].label||!(!r[n].label||e[a][0].valueSort.levelName.indexOf(r[n].label)>-1||e[a][s].rowHeaders.indexOf(r[n].label)>-1||e[a][s].columnHeaders.indexOf(r[n].label)>-1)||(r[n].style&&r[n].style.backgroundColor&&(r[n].style.backgroundColor=this.conditionalFormattingModule.isHex(r[n].style.backgroundColor.substr(1))?r[n].style.backgroundColor:this.conditionalFormattingModule.colourNameToHex(r[n].style.backgroundColor)),r[n].style&&r[n].style.color&&(r[n].style.color=this.conditionalFormattingModule.isHex(r[n].style.color.substr(1))?r[n].style.color:this.conditionalFormattingModule.colourNameToHex(r[n].style.color)),e[a][s].style=r[n].style,e[a][s].cssClass="format"+this.element.id+n))}var o=this.dataSourceSettings.conditionalFormatSettings;for(n=0;n<o.length;n++){var l=this.createStyleSheet.bind(this)(),d="color: "+o[n].style.color+"!important;background-color: "+o[n].style.backgroundColor+"!important;font-size: "+o[n].style.fontSize+"!important;font-family: "+o[n].style.fontFamily+" !important;";l.insertRule(".format"+this.element.id+n+"{"+d+"}",0)}}},t.prototype.createStyleSheet=function(){var e=document.createElement("style");return e.appendChild(document.createTextNode("")),document.head.appendChild(e),e.sheet},t.prototype.applyHyperlinkSettings=function(){if(this.pivotValues){for(var e=this.pivotValues,t=[],i=e.length,a=0;a<i;a++)sf.base.isNullOrUndefined(e[a])||void 0!==e[a][0]||t.push(a);if(this.hyperlinkSettings.conditionalSettings.length>0)for(a=0;a<e.length;a++)for(var s=1;e[a]&&s<e[a].length;s++)if("value"===e[a][s].axis){e[a][s].enableHyperlink=!1;for(var r=this.hyperlinkSettings.conditionalSettings,n=0;n<r.length;n++)if(this.checkCondition(e[a][s].value,r[n].conditions,r[n].value1,r[n].value2)){var o="row"===this.dataSourceSettings.valueAxis?a:"pivot"===this.dataType?this.engineModule.headerContent.length-1:this.olapEngineModule.headerContent.length-1,l="row"===this.dataSourceSettings.valueAxis?0:s;(!r[n].measure||1===this.dataSourceSettings.values.length||e[o][l].valueSort&&e[o][l].actualText===r[n].measure)&&(!r[n].label||e[t[r[n].label.split(".").length-1]]&&e[t[r[n].label.split(".").length-1]][s]&&e[t[r[n].label.split(".").length-1]][s].valueSort&&e[t[r[n].label.split(".").length-1]][s].valueSort[r[n].label]||e[a][0].valueSort.levelName.indexOf(r[n].label)>-1)&&(e[a][s].enableHyperlink=!0)}}if(sf.base.isNullOrUndefined(this.hyperlinkSettings.headerText))return;var d=this.dataSourceSettings.valueSortSettings.headerDelimiter?this.dataSourceSettings.valueSortSettings.headerDelimiter:".";for(a=0;a<e.length;a++)for(s=1;e[a]&&s<e[a].length;s++)if("value"===e[a][s].axis){var p=this.hyperlinkSettings.headerText;if(e[t[p.split(d).length-1]]&&e[t[p.split(d).length-1]][s]&&e[t[p.split(d).length-1]][s].valueSort&&e[t[p.split(d).length-1]][s].valueSort[p]){for(var h=0,u=t;h<u.length;h++){var c=u[h];e[c][s]&&"column"===e[c][s].axis&&e[c][s].valueSort.levelName.indexOf(p)>-1&&(e[c][s].enableHyperlink=!0)}e[a][s].enableHyperlink=!0}else e[a][0].valueSort.levelName.indexOf(p)>-1&&(e[a][0].enableHyperlink=!0,e[a][s].enableHyperlink=!0)}}},t.prototype.checkCondition=function(e,t,i,a){switch(t){case"LessThan":return e<i;case"LessThanOrEqualTo":return e<=i;case"GreaterThan":return e>i;case"GreaterThanOrEqualTo":return e>=i;case"Equals":return e===i;case"NotEquals":return e!==i;case"Between":return i<a&&e>=i&&e<=a||i>a&&e<=i&&e>=a;case"NotBetween":return!(i<a&&e>=i&&e<=a||i>a&&e<=i&&e>=a);default:return!1}},t.prototype.updateGroupingReport=function(e,t){if(!this.clonedDataSet&&!this.clonedReport){var i=this.engineModule.data;if(this.clonedDataSet=r.getClonedData(i),sf.base.isBlazor())this.clonedReport=r.getClonedDataSourceSettings(this.dataSourceSettings);else{var a=JSON.parse(this.getPersistData()).dataSourceSettings;a.dataSource=[],this.clonedReport=this.clonedReport?this.clonedReport:a}}var s=/_date_group_years|_date_group_quarters|_date_group_quarterYear|_date_group_months|_date_group_days|_date_group_hours|_date_group_minutes|_date_group_seconds/g,n=r.getClonedData(this.clonedDataSet),o=this.dataSourceSettings,l=this.clonedReport.properties?this.clonedReport.properties:this.clonedReport,d=[o.rows,o.columns,o.values,o.filters],p=[o.filterSettings,o.sortSettings,o.formatSettings,o.drilledMembers],h=l.rows;if(h=h.concat(l.columns,l.values,l.filters),0===e.length||e.length>0){this.engineModule.groupingFields={},sf.base.isBlazor()||this.setProperties({dataSourceSettings:{dataSource:n,groupSettings:e.length>0?o.groupSettings:[]}},!0);for(var u="Date"===t,c=[],g=0,f=d.length;g<f;g++)for(var m=0,v=d[g].length;m<v;m++){var b=d[g][m].name;-1===c.indexOf(b)&&c.push(b);var S=c.indexOf(b);r.getFieldByName(b,o.groupSettings);if(!sf.base.isNullOrUndefined(b.match(s))&&u||-1!==b.indexOf("_custom_group")&&!r.getFieldByName(b.replace("_custom_group",""),o.groupSettings))d[g].splice(m,1),c.splice(S,1),m--,v--;else{var y=r.getFieldByName(b,h);y&&d[g].splice(m,1,y)}}for(var C=0,w=c;C<w.length;C++){b=w[C];var x=r.getFilterItemByName(b,l.filterSettings),T=r.getFieldByName(b,l.sortSettings),M=r.getFieldByName(b,l.formatSettings),D=r.getFieldByName(b,l.drilledMembers),E=[x,T,M,D];for(g=0,f=p.length;g<f;g++){var O=!1;for(m=0,v=p[g].length;m<v;m++){var P=p[g][m].name;if(!sf.base.isNullOrUndefined(P.match(s))&&u||-1!==P.indexOf("_custom_group")&&!r.getFieldByName(P.replace("_custom_group",""),o.groupSettings))p[g].splice(m,1),m--,v--;else if(b===p[g][m].name){O=!0,E[g]?p[g].splice(m,1,E[g]):(p[g].splice(m,1),m--,v--);break}}!O&&0===g&&x&&p[g].push(x),!O&&1===g&&T&&p[g].push(T),!O&&2===g&&M&&p[g].push(M),!O&&3===g&&D&&p[g].push(D)}}sf.base.isBlazor()&&(this.engineModule.data=n,this.allowServerDataBinding=!1,this.setProperties({dataSourceSettings:{rows:d[0],columns:d[1],values:d[2],filters:d[3],filterSettings:p[0],sortSettings:p[1],formatSettings:p[2],drilledMembers:p[3],groupSettings:e.length>0?o.groupSettings:[]}},!0),this.allowServerDataBinding=!0)}},t.prototype.removeButtonFocus=function(e){document.querySelectorAll(".e-btn-focused")&&sf.base.removeClass(document.querySelectorAll(".e-btn-focused"),"e-btn-focused")},t.prototype.wireEvents=function(){"Chart"!==this.displayOption.view&&(sf.base.EventHandler.add(this.element,this.isAdaptive?"touchend":"click",this.mouseClickHandler,this),sf.base.EventHandler.add(this.element,"mousedown",this.mouseDownHandler,this),sf.base.EventHandler.add(this.element.querySelector(".e-gridheader"),"mousemove",this.mouseMoveHandler,this),sf.base.EventHandler.add(this.element,"mouseup",this.mouseUpHandler,this),sf.base.EventHandler.add(this.element,this.isAdaptive?"touchend":"contextmenu",this.mouseRclickHandler,this)),sf.base.EventHandler.add(document,this.isAdaptive?"touchend":"click",this.removeButtonFocus,this),window.addEventListener("resize",this.onWindowResize.bind(this),!0)},t.prototype.unwireEvents=function(){"Chart"!==this.displayOption.view&&(sf.base.EventHandler.remove(this.element,this.isAdaptive?"touchend":"click",this.mouseClickHandler),sf.base.EventHandler.remove(this.element,"mousedown",this.mouseDownHandler),this.element.querySelector(".e-gridheader")&&sf.base.EventHandler.remove(this.element.querySelector(".e-gridheader"),"mousemove",this.mouseMoveHandler),sf.base.EventHandler.remove(this.element,"mouseup",this.mouseUpHandler),sf.base.EventHandler.remove(this.element,this.isAdaptive?"touchend":"contextmenu",this.mouseRclickHandler)),sf.base.EventHandler.remove(document,this.isAdaptive?"touchend":"click",this.removeButtonFocus),window.removeEventListener("resize",this.onWindowResize.bind(this),!0)},t.prototype.destroy=function(){this.removeInternalEvents(),this.showGroupingBar&&this.groupingBarModule&&this.groupingBarModule.destroy(),this.allowGrouping&&this.groupingModule&&this.groupingModule.destroy(),this.showToolbar&&this.toolbarModule&&this.toolbarModule.destroy(),this.enableVirtualization&&this.virtualscrollModule&&this.virtualscrollModule.destroy(),this.allowConditionalFormatting&&this.conditionalFormattingModule&&this.conditionalFormattingModule.destroy(),this.allowNumberFormatting&&this.numberFormattingModule&&this.numberFormattingModule.destroy(),this.isAdaptive&&this.contextMenuModule&&this.contextMenuModule.destroy(),this.keyboardModule&&this.keyboardModule.destroy(),this.tooltip&&this.tooltip.destroy(),this.chart&&(this.chart.destroy(),this.chart.isDestroyed&&sf.base.select("#"+this.element.id+"_chart",this.element)&&sf.base.remove(sf.base.select("#"+this.element.id+"_chart",this.element))),this.grid&&(this.grid.destroy(),this.grid.isDestroyed&&sf.base.select("#"+this.element.id+"_grid",this.element)&&sf.base.remove(sf.base.select("#"+this.element.id+"_grid",this.element))),this.unwireEvents(),e.prototype.destroy.call(this),sf.base.isBlazor()&&this.isServerRendered?(this.element.querySelector(".e-spinner-pane")&&sf.base.remove(this.element.querySelector(".e-spinner-pane")),this.showFieldList&&sf.base.select("#"+this.element.id+"_PivotFieldList",document)&&sf.base.remove(sf.base.select("#"+this.element.id+"_PivotFieldList",document))):this.element.innerHTML="",sf.base.removeClass([this.element],u),sf.base.removeClass([this.element],c),sf.base.removeClass([this.element],g)},t.prototype.showNumberFormattingDialog=function(){this.allowNumberFormatting&&this.numberFormattingModule.showNumberFormattingDialog()},et([sf.base.Property("USD")],t.prototype,"currencyCode",void 0),et([sf.base.Property(!1)],t.prototype,"showFieldList",void 0),et([sf.base.Complex({},se)],t.prototype,"gridSettings",void 0),et([sf.base.Complex({},Je)],t.prototype,"chartSettings",void 0),et([sf.base.Complex({},tt)],t.prototype,"groupingBarSettings",void 0),et([sf.base.Complex({},st)],t.prototype,"hyperlinkSettings",void 0),et([sf.base.Complex({},te)],t.prototype,"dataSourceSettings",void 0),et([sf.base.Complex({},it)],t.prototype,"editSettings",void 0),et([sf.base.Complex({},rt)],t.prototype,"displayOption",void 0),et([sf.base.Property()],t.prototype,"pivotValues",void 0),et([sf.base.Property(!1)],t.prototype,"showGroupingBar",void 0),et([sf.base.Property(!0)],t.prototype,"showTooltip",void 0),et([sf.base.Property(!1)],t.prototype,"showToolbar",void 0),et([sf.base.Property([])],t.prototype,"toolbar",void 0),et([sf.base.Property(!1)],t.prototype,"showValuesButton",void 0),et([sf.base.Property(!1)],t.prototype,"allowCalculatedField",void 0),et([sf.base.Property(!1)],t.prototype,"enableValueSorting",void 0),et([sf.base.Property(!1)],t.prototype,"allowConditionalFormatting",void 0),et([sf.base.Property(!1)],t.prototype,"allowNumberFormatting",void 0),et([sf.base.Property("auto")],t.prototype,"height",void 0),et([sf.base.Property("auto")],t.prototype,"width",void 0),et([sf.base.Property(!1)],t.prototype,"allowExcelExport",void 0),et([sf.base.Property(!1)],t.prototype,"enableVirtualization",void 0),et([sf.base.Property(!1)],t.prototype,"allowDrillThrough",void 0),et([sf.base.Property(!1)],t.prototype,"allowPdfExport",void 0),et([sf.base.Property(!1)],t.prototype,"allowDeferLayoutUpdate",void 0),et([sf.base.Property(!1)],t.prototype,"allowDataCompression",void 0),et([sf.base.Property(1e3)],t.prototype,"maxNodeLimitInMemberEditor",void 0),et([sf.base.Property(1e4)],t.prototype,"maxRowsInDrillThrough",void 0),et([sf.base.Property(!0)],t.prototype,"loadOnDemandInMemberEditor",void 0),et([sf.base.Property(!0)],t.prototype,"enableHtmlSanitizer",void 0),et([sf.base.Property()],t.prototype,"cellTemplate",void 0),et([sf.base.Property()],t.prototype,"toolbarTemplate",void 0),et([sf.base.Property()],t.prototype,"tooltipTemplate",void 0),et([sf.base.Property()],t.prototype,"spinnerTemplate",void 0),et([sf.base.Property(!1)],t.prototype,"allowGrouping",void 0),et([sf.base.Property(!0)],t.prototype,"exportAllPages",void 0),et([sf.base.Property(["Sum","Count","DistinctCount","Product","Min","Max","Avg","Median","Index","PopulationVar","SampleVar","PopulationStDev","SampleStDev","RunningTotals","PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal","PercentageOfParentColumnTotal","PercentageOfParentRowTotal","DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentTotal"])],t.prototype,"aggregateTypes",void 0),et([sf.base.Property(["Column","Bar","Line","Area","Scatter","Polar","StackingColumn","StackingArea","StackingBar","StepLine","StepArea","SplineArea","Spline","StackingColumn100","StackingBar100","StackingArea100","Bubble","Pareto","Radar","Pie","Doughnut","Funnel","Pyramid"])],t.prototype,"chartTypes",void 0),et([sf.base.Event()],t.prototype,"queryCellInfo",void 0),et([sf.base.Event()],t.prototype,"headerCellInfo",void 0),et([sf.base.Event()],t.prototype,"resizing",void 0),et([sf.base.Event()],t.prototype,"resizeStop",void 0),et([sf.base.Event()],t.prototype,"pdfHeaderQueryCellInfo",void 0),et([sf.base.Event()],t.prototype,"pdfQueryCellInfo",void 0),et([sf.base.Event()],t.prototype,"excelHeaderQueryCellInfo",void 0),et([sf.base.Event()],t.prototype,"excelQueryCellInfo",void 0),et([sf.base.Event()],t.prototype,"columnDragStart",void 0),et([sf.base.Event()],t.prototype,"columnDrag",void 0),et([sf.base.Event()],t.prototype,"columnDrop",void 0),et([sf.base.Event()],t.prototype,"beforePdfExport",void 0),et([sf.base.Event()],t.prototype,"beforeExcelExport",void 0),et([sf.base.Event()],t.prototype,"beforeColumnsRender",void 0),et([sf.base.Event()],t.prototype,"selected",void 0),et([sf.base.Event()],t.prototype,"cellDeselected",void 0),et([sf.base.Event()],t.prototype,"rowSelected",void 0),et([sf.base.Event()],t.prototype,"rowDeselected",void 0),et([sf.base.Event()],t.prototype,"chartTooltipRender",void 0),et([sf.base.Event()],t.prototype,"chartLoaded",void 0),et([sf.base.Event()],t.prototype,"chartLoad",void 0),et([sf.base.Event()],t.prototype,"chartResized",void 0),et([sf.base.Event()],t.prototype,"chartAxisLabelRender",void 0),et([sf.base.Event()],t.prototype,"multiLevelLabelClick",void 0),et([sf.base.Event()],t.prototype,"chartPointClick",void 0),et([sf.base.Event()],t.prototype,"contextMenuClick",void 0),et([sf.base.Event()],t.prototype,"contextMenuOpen",void 0),et([sf.base.Event()],t.prototype,"onPdfCellRender",void 0),et([sf.base.Event()],t.prototype,"saveReport",void 0),et([sf.base.Event()],t.prototype,"fetchReport",void 0),et([sf.base.Event()],t.prototype,"loadReport",void 0),et([sf.base.Event()],t.prototype,"renameReport",void 0),et([sf.base.Event()],t.prototype,"removeReport",void 0),et([sf.base.Event()],t.prototype,"newReport",void 0),et([sf.base.Event()],t.prototype,"toolbarRender",void 0),et([sf.base.Event()],t.prototype,"toolbarClick",void 0),et([sf.base.Event()],t.prototype,"load",void 0),et([sf.base.Event()],t.prototype,"enginePopulating",void 0),et([sf.base.Event()],t.prototype,"enginePopulated",void 0),et([sf.base.Event()],t.prototype,"onFieldDropped",void 0),et([sf.base.Event()],t.prototype,"fieldDrop",void 0),et([sf.base.Event()],t.prototype,"fieldDragStart",void 0),et([sf.base.Event()],t.prototype,"dataBound",void 0),et([sf.base.Event()],t.prototype,"created",void 0),et([sf.base.Event()],t.prototype,"destroyed",void 0),et([sf.base.Event()],t.prototype,"beforeExport",void 0),et([sf.base.Event()],t.prototype,"conditionalFormatting",void 0),et([sf.base.Event()],t.prototype,"memberFiltering",void 0),et([sf.base.Event()],t.prototype,"cellClick",void 0),et([sf.base.Event()],t.prototype,"drillThrough",void 0),et([sf.base.Event()],t.prototype,"editCompleted",void 0),et([sf.base.Event()],t.prototype,"beginDrillThrough",void 0),et([sf.base.Event()],t.prototype,"hyperlinkCellClick",void 0),et([sf.base.Event()],t.prototype,"cellSelecting",void 0),et([sf.base.Event()],t.prototype,"drill",void 0),et([sf.base.Event()],t.prototype,"cellSelected",void 0),et([sf.base.Event()],t.prototype,"chartSeriesCreated",void 0),et([sf.base.Event()],t.prototype,"aggregateCellInfo",void 0),et([sf.base.Event()],t.prototype,"fieldListRefreshed",void 0),et([sf.base.Event()],t.prototype,"memberEditorOpen",void 0),et([sf.base.Event()],t.prototype,"calculatedFieldCreate",void 0),et([sf.base.Event()],t.prototype,"numberFormatting",void 0),et([sf.base.Event()],t.prototype,"aggregateMenuOpen",void 0),et([sf.base.Event()],t.prototype,"fieldRemove",void 0),et([sf.base.Event()],t.prototype,"beforeServiceInvoke",void 0),t=i=et([sf.base.NotifyPropertyChanges],t)}(sf.base.Component),ot=function(){function e(e){this.parent=e}return e.prototype.render=function(){var e=sf.base.createElement("div",{id:this.parent.element.id+"_Wrapper",className:"e-pivotfieldlist-wrapper "+("olap"===this.parent.dataType?"e-olapfieldlist-wrapper":""),styles:"width:"+this.parent.element.style.width});this.parent.isAdaptive?sf.base.addClass([e],g):sf.base.removeClass([e],g),this.parent.enableRtl?sf.base.addClass([e],c):sf.base.removeClass([e],c),this.parent.cssClass&&sf.base.addClass([e],this.parent.cssClass),this.parentElement=sf.base.createElement("div",{className:"e-field-list-container"}),this.parent.element.appendChild(e),this.parent.isAdaptive&&(e.removeAttribute("style"),this.parentElement=sf.base.createElement("div",{className:"e-adaptive-container"}),this.renderAdaptiveLayout(e)),"Popup"===this.parent.renderMode?(this.renderFieldListDialog(e),this.unWireDialogEvent(this.parent.element.querySelector(".e-toggle-field-list")),this.wireDialogEvent(this.parent.element.querySelector(".e-toggle-field-list"))):this.renderStaticLayout(e)},e.prototype.renderStaticLayout=function(e){if(!this.parent.isAdaptive){var t=sf.base.createElement("div",{className:"e-field-list-title"}),i=sf.base.createElement("div",{className:"e-title-content",innerHTML:this.parent.localeObj.getConstant("staticFieldList")});t.appendChild(i),t.appendChild(this.createCalculatedButton()),sf.base.addClass([e],"e-static"),e.appendChild(t),e.appendChild(this.parentElement),sf.base.addClass([e],"e-static"),this.parent.allowDeferLayoutUpdate&&(e.appendChild(this.createDeferUpdateButtons()),this.renderDeferUpdateButtons())}},e.prototype.renderDeferUpdateButtons=function(){this.parent.allowDeferLayoutUpdate&&(this.deferUpdateCheckBox=new sf.buttons.CheckBox({label:this.parent.localeObj.getConstant("deferLayoutUpdate"),checked:!0,enableRtl:this.parent.enableRtl,change:this.onCheckChange.bind(this)}),this.deferUpdateCheckBox.isStringTemplate=!0,this.deferUpdateCheckBox.appendTo("#"+this.parent.element.id+"DeferUpdateCheckBox"),this.deferUpdateApplyButton=new sf.buttons.Button({cssClass:"e-defer-apply-button e-defer-update-btn"+("Popup"===this.parent.renderMode?" e-flat":""),content:this.parent.localeObj.getConstant("apply"),enableRtl:this.parent.enableRtl,isPrimary:!0}),this.deferUpdateApplyButton.isStringTemplate=!0,this.deferUpdateApplyButton.appendTo("#"+this.parent.element.id+"_DeferUpdateButton1"),this.deferUpdateApplyButton.element.onclick="Fixed"===this.parent.renderMode?this.applyButtonClick.bind(this):this.onDeferUpdateClick.bind(this)),this.deferUpdateCancelButton=new sf.buttons.Button({cssClass:"e-defer-cancel-button e-cancel-btn"+("Popup"===this.parent.renderMode?" e-flat":""),content:this.parent.allowDeferLayoutUpdate?this.parent.localeObj.getConstant("cancel"):this.parent.localeObj.getConstant("close"),enableRtl:this.parent.enableRtl,isPrimary:!this.parent.allowDeferLayoutUpdate}),this.deferUpdateCancelButton.isStringTemplate=!0,this.deferUpdateCancelButton.appendTo("#"+this.parent.element.id+"_DeferUpdateButton2"),this.deferUpdateCancelButton.element.onclick="Fixed"===this.parent.renderMode?this.cancelButtonClick.bind(this):this.onCloseFieldList.bind(this)},e.prototype.createDeferUpdateButtons=function(){var e=sf.base.createElement("div",{className:"e-layout-footer"});if(this.parent.allowDeferLayoutUpdate){var t=sf.base.createElement("div",{className:"e-checkbox-layout"}),i=sf.base.createElement("input",{id:this.parent.element.id+"DeferUpdateCheckBox"});t.appendChild(i),e.appendChild(t)}var a=sf.base.createElement("div",{className:"e-button-layout"});if(this.parent.allowDeferLayoutUpdate){var s=sf.base.createElement("button",{id:this.parent.element.id+"_DeferUpdateButton1",attrs:{type:"button"}});a.appendChild(s)}var r=sf.base.createElement("button",{id:this.parent.element.id+"_DeferUpdateButton2",attrs:{type:"button"}});return a.appendChild(r),e.appendChild(a),e},e.prototype.onCheckChange=function(e){e.checked&&(this.parent.clonedDataSource=sf.base.extend({},this.parent.dataSourceSettings,null,!0),this.parent.clonedFieldList=sf.base.extend({},this.parent.pivotFieldList,null,!0)),this.parent.allowDeferLayoutUpdate=!this.parent.allowDeferLayoutUpdate,"Fixed"===this.parent.renderMode?(this.deferUpdateApplyButton.setProperties({disabled:!this.parent.allowDeferLayoutUpdate}),this.deferUpdateCancelButton.setProperties({disabled:!this.parent.allowDeferLayoutUpdate})):this.parent.allowDeferLayoutUpdate?(this.deferUpdateApplyButton.element.style.display="",this.deferUpdateCancelButton.setProperties({content:this.parent.localeObj.getConstant("cancel")}),this.deferUpdateCancelButton.isPrimary=!1):(this.deferUpdateApplyButton.element.style.display="none",this.deferUpdateCancelButton.setProperties({content:this.parent.localeObj.getConstant("close")}),this.deferUpdateCancelButton.isPrimary=!0),this.cancelButtonClick()},e.prototype.applyButtonClick=function(){"pivotfieldlist"===this.parent.getModuleName()&&this.parent.allowDeferLayoutUpdate&&(this.parent.pivotChange=!1),this.parent.updateDataSource(!1);var e=this.parent;e.axisFieldModule.render(),e.clonedDataSource=sf.base.extend({},e.dataSourceSettings,null,!0),e.clonedFieldList=sf.base.extend({},e.pivotFieldList,null,!0)},e.prototype.cancelButtonClick=function(){if(sf.base.isBlazor()&&!this.parent.isPopupView?r.updateDataSourceSettings(this.parent,r.getClonedDataSourceSettings(this.parent.clonedDataSource.properties)):this.parent.setProperties({dataSourceSettings:this.parent.clonedDataSource.properties},!0),"olap"===this.parent.dataType){this.parent.olapEngineModule.fieldList=sf.base.extend({},this.parent.clonedFieldList,null,!0);for(var e=0,t=Object.keys(this.parent.clonedFieldList);e<t.length;e++){var i=t[e],a=this.parent.clonedFieldList[i];this.parent.olapEngineModule.updateFieldlistData(a.id,a.isSelected)}}else this.parent.engineModule.fieldList=sf.base.extend({},this.parent.clonedFieldList,null,!0);this.parent.updateDataSource(!1,!0)},e.prototype.renderFieldListDialog=function(e){var t=sf.base.createElement("div",{className:"e-toggle-field-list "+f+" e-select-table",attrs:{tabindex:"0",title:this.parent.localeObj.getConstant("fieldList"),"aria-disabled":"false","aria-label":this.parent.localeObj.getConstant("fieldList")}});if(this.parent.element.appendChild(t),this.parent.isAdaptive){var i='<div class=e-title-mobile-header><span class="'+f+' e-field-list-back-icon"></span><div class=e-title-mobile-content>'+this.parent.localeObj.getConstant("fieldList")+"</div></div>",a=[{click:this.showFieldListDialog.bind(this),buttonModel:{cssClass:"e-field-list-btn e-small e-round",iconCss:f+" e-add-icon",isPrimary:!0}},{click:this.showCalculatedField.bind(this),buttonModel:{cssClass:"e-calculated-field-btn e-small e-round e-disable",iconCss:f+" e-add-icon",enableRtl:this.parent.enableRtl,isPrimary:!0}}];this.fieldListDialog=new sf.popups.Dialog({animationSettings:{effect:this.parent.enableRtl?"SlideRight":"SlideLeft"},header:i,content:this.parentElement,isModal:!0,showCloseIcon:!1,visible:!1,allowDragging:!1,closeOnEscape:!1,enableRtl:this.parent.enableRtl,width:"100%",height:"100%",position:{X:"center",Y:"center"},buttons:a,target:document.body,close:this.removeFieldListIcon.bind(this),open:this.dialogOpen.bind(this)}),this.fieldListDialog.isStringTemplate=!0,this.fieldListDialog.appendTo(e),sf.base.setStyleAttribute(sf.base.select("#"+e.id+"_dialog-content",e),{padding:"0"});var s=e.querySelector(".e-footer-content");sf.base.addClass([s],"e-field-list-footer"),sf.base.removeClass([s.querySelector(".e-calculated-field-btn")],"e-flat"),sf.base.removeClass([s.querySelector(".e-field-list-btn")],"e-flat"),this.fieldListDialog.element.querySelector(".e-field-list-back-icon").onclick=this.parent.allowDeferLayoutUpdate?this.onDeferUpdateClick.bind(this):this.onCloseFieldList.bind(this)}else{var r=this.createDeferUpdateButtons().outerHTML;i="<div class=e-title-header><div class=e-title-content>"+this.parent.localeObj.getConstant("fieldList")+"</div></div>";this.fieldListDialog=new sf.popups.Dialog({animationSettings:{effect:"Zoom"},header:i,content:this.parentElement,isModal:!1,showCloseIcon:!1,visible:!1,allowDragging:!0,enableRtl:this.parent.enableRtl,width:this.parent.element.style.width,position:{X:"center",Y:this.parent.element.offsetTop},footerTemplate:r,closeOnEscape:!1,target:sf.base.isNullOrUndefined(this.parent.target)?document.body:"string"==typeof this.parent.target?document.querySelector(this.parent.target):this.parent.target,close:this.removeFieldListIcon.bind(this)}),this.fieldListDialog.isStringTemplate=!0,this.fieldListDialog.appendTo(e),this.renderDeferUpdateButtons(),sf.base.setStyleAttribute(sf.base.select("#"+e.id+"_title",e),{width:"100%"}),e.querySelector(".e-title-header").appendChild(this.createCalculatedButton())}},e.prototype.dialogOpen=function(){this.adaptiveElement.refresh()},e.prototype.updateDataSource=function(e){for(var t=["filters","columns","rows","values"],i=0,a=e;i<a.length;i++){var s=a[i],r=t[this.adaptiveElement.selectedItem];this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,this.parent.pivotCommon.dataSourceUpdate.updateDataSource(s,r,-1)}this.parent.axisFieldModule.render(),this.parent.allowDeferLayoutUpdate?this.parent.triggerPopulateEvent():this.parent.updateDataSource(!0)},e.prototype.onDeferUpdateClick=function(){this.parent.updateDataSource(),this.parent.dialogRenderer.fieldListDialog.hide()},e.prototype.renderAdaptiveLayout=function(e){var t=sf.base.createElement("div",{className:"e-field-list-footer"});e.appendChild(this.parentElement);var i=[{header:{text:this.parent.localeObj.getConstant("filters")},content:this.createAxisTable("filters")},{header:{text:this.parent.localeObj.getConstant("columns")},content:this.createAxisTable("columns")},{header:{text:this.parent.localeObj.getConstant("rows")},content:this.createAxisTable("rows")},{header:{text:this.parent.localeObj.getConstant("values")},content:this.createAxisTable("values")},{header:{text:this.parent.localeObj.getConstant("createCalculatedField")},content:"Calculated Field Related UI"}];this.parent.allowCalculatedField||i.pop(),this.adaptiveElement=new sf.navigations.Tab({heightAdjustMode:"Auto",items:i,height:"100%",enableRtl:this.parent.enableRtl,selected:this.tabSelect.bind(this)}),"Fixed"===this.parent.renderMode?(t.appendChild(this.createAddButton()),sf.base.addClass([e],"e-static"),this.adaptiveElement.isStringTemplate=!0,this.adaptiveElement.appendTo(this.parentElement),this.parentElement.appendChild(t)):(this.adaptiveElement.isStringTemplate=!0,this.adaptiveElement.appendTo(this.parentElement))},e.prototype.tabSelect=function(e){var t=sf.base.closest(this.parentElement,".e-pivotfieldlist-wrapper");t&&t.querySelector(".e-field-list-btn")&&(4!==e.selectedIndex?(sf.base.addClass([t.querySelector(".e-calculated-field-btn")],"e-disable"),sf.base.removeClass([t.querySelector(".e-field-list-btn")],"e-disable")):(sf.base.removeClass([t.querySelector(".e-calculated-field-btn")],"e-disable"),sf.base.addClass([t.querySelector(".e-field-list-btn")],"e-disable"))),4===e.selectedIndex?(this.adaptiveElement.items[4].content="",this.adaptiveElement.dataBind(),this.parent.notify("init-calculatedfield",{})):this.parent.axisFieldModule.render()},e.prototype.createCalculatedButton=function(){var e=sf.base.createElement("button",{id:this.parent.element.id+"_CalculatedField",attrs:{type:"button",tabindex:"0","aria-disabled":"false","aria-label":this.parent.localeObj.getConstant("CalculatedField")}}),t=new sf.buttons.Button({cssClass:"e-calculated-field e-disable",content:this.parent.localeObj.getConstant("CalculatedField"),enableRtl:this.parent.enableRtl});return t.isStringTemplate=!0,t.appendTo(e),this.parent.calculatedFieldModule&&sf.base.removeClass([e],"e-disable"),t.element.onclick=this.showCalculatedField.bind(this),e},e.prototype.createAddButton=function(){var e=sf.base.createElement("div",{className:"e-field-list-footer-content"}),t=sf.base.createElement("div",{}),i=sf.base.createElement("div",{}),a=new sf.buttons.Button({cssClass:"e-calculated-field-btn e-small e-round e-disable",iconCss:f+" e-add-icon",enableRtl:this.parent.enableRtl}),s=new sf.buttons.Button({cssClass:"e-field-list-btn e-small e-round",iconCss:f+" e-add-icon",enableRtl:this.parent.enableRtl});return s.isStringTemplate=!0,s.appendTo(t),a.isStringTemplate=!0,a.appendTo(i),e.appendChild(t),e.appendChild(i),a.element.onclick=this.showCalculatedField.bind(this),s.element.onclick=this.showFieldListDialog.bind(this),e},e.prototype.createAxisTable=function(e){var t=sf.base.createElement("div",{className:"e-field-list-"+e}),i=sf.base.createElement("div",{className:"e-axis-content e-"+e}),a=sf.base.createElement("span",{className:"e-draggable-prompt",innerHTML:this.parent.localeObj.getConstant("addPrompt")});return t.appendChild(i),t.appendChild(a),t},e.prototype.showCalculatedField=function(e){this.parent.isAdaptive||this.parent.dialogRenderer.fieldListDialog&&(this.parent.dialogRenderer.fieldListDialog.hide(),sf.base.addClass([this.parent.element.querySelector(".e-toggle-field-list")],"e-hide")),this.parent.notify("init-calculatedfield",{})},e.prototype.showFieldListDialog=function(e){var t=this.adaptiveElement.selectedItem;this.parent.treeViewModule.render(t)},e.prototype.onShowFieldList=function(){this.parent.allowDeferLayoutUpdate&&(this.parent.isAdaptive&&this.parent.axisFieldModule.render(),this.parent.clonedDataSource=sf.base.extend({},this.parent.dataSourceSettings,null,!0),this.parent.clonedFieldList=sf.base.extend({},this.parent.pivotFieldList,null,!0)),sf.base.addClass([this.parent.element.querySelector(".e-toggle-field-list")],"e-hide"),this.parent.dialogRenderer.fieldListDialog.show(),this.parent.dialogRenderer.fieldListDialog.element.style.top=parseInt(this.parent.dialogRenderer.fieldListDialog.element.style.top,10)<0?"0px":this.parent.dialogRenderer.fieldListDialog.element.style.top},e.prototype.onCloseFieldList=function(){this.parent.allowDeferLayoutUpdate&&(this.parent.dataSourceSettings=sf.base.extend({},this.parent.clonedDataSource.properties,null,!0),this.parent.pivotGridModule.engineModule=this.parent.engineModule,this.parent.pivotGridModule.olapEngineModule=this.parent.olapEngineModule,this.parent.pivotGridModule.setProperties({dataSourceSettings:this.parent.clonedDataSource.properties},!0),Object.keys(this.parent.clonedFieldList).length>0&&("olap"===this.parent.dataType?this.parent.olapEngineModule.fieldList=sf.base.extend({},this.parent.clonedFieldList,null,!0):this.parent.engineModule.fieldList=sf.base.extend({},this.parent.clonedFieldList,null,!0)),this.parent.pivotGridModule.notify(d,this),this.parent.pivotGridModule.notify(p,this)),this.parent.dialogRenderer.fieldListDialog.hide()},e.prototype.removeFieldListIcon=function(){this.parent.isAdaptive&&this.parent.allowCalculatedField&&this.parent.calculatedFieldModule&&this.adaptiveElement&&4===this.adaptiveElement.selectedItem&&(sf.base.select("#"+this.parent.element.id+"droppable",this.adaptiveElement.element)?this.parent.calculatedFieldModule.updateAdaptiveCalculatedField(!1):this.parent.notify("init-calculatedfield",{edit:!1})),document.getElementById(this.parent.element.id+"calculateddialog")||sf.base.removeClass([this.parent.element.querySelector(".e-toggle-field-list")],"e-hide")},e.prototype.keyPress=function(e){if(13===e.keyCode&&e.target)return e.target.click(),void e.preventDefault()},e.prototype.wireDialogEvent=function(e){sf.base.EventHandler.add(e,"keydown",this.keyPress,this),sf.base.EventHandler.add(e,"click",this.onShowFieldList,this)},e.prototype.unWireDialogEvent=function(e){sf.base.EventHandler.remove(e,"keydown",this.keyPress),sf.base.EventHandler.remove(e,"click",this.onShowFieldList)},e}(),lt=function(){function e(e){this.selectedNodes=[],this.parent=e,this.addEventListener()}return e.prototype.render=function(e){if(this.parentElement=this.parent.dialogRenderer.parentElement,this.fieldListSort="None",this.parent.isAdaptive)this.renderTreeDialog(e);else{var t=sf.base.createElement("div",{className:"e-field-table "+("olap"===this.parent.dataType?"e-olap-field-table":"")}),i=sf.base.createElement("div",{className:"e-field-header",innerHTML:this.parent.localeObj.getConstant("allFields")}),a=sf.base.createElement("div",{className:"e-field-list-tree-outer-div"});this.treeViewElement=sf.base.createElement("div",{id:this.parent.element.id+"_TreeView",className:"e-field-list "+("olap"===this.parent.dataType?"e-olap-field-list-tree":"")});var s=sf.base.createElement("div",{className:"e-field-header-wrapper"});if(s.appendChild(i),t.appendChild(s),this.updateSortElements(s),a.appendChild(this.treeViewElement),t.appendChild(a),this.parentElement.appendChild(t),"Fixed"===this.parent.renderMode){var r=sf.base.createElement("div",{className:"e-center-div"}),n=sf.base.createElement("div",{className:"e-center-title",innerHTML:this.parent.localeObj.getConstant("centerHeader")});this.parentElement.appendChild(r),this.parentElement.appendChild(n)}this.renderTreeView()}},e.prototype.updateSortElements=function(e){for(var t={None:"sortNone",Ascend:"sortAscending",Descend:"sortDescending"},i=0,a=Object.keys(t);i<a.length;i++){var s=a[i],r=sf.base.createElement("span",{attrs:{tabindex:"0","aria-disabled":"false","aria-label":"Sort "+s,"data-sort":s,title:this.parent.localeObj.getConstant(t[s])},className:f+" e-sort-"+s.toLowerCase()+" "+(this.fieldListSort===s?"e-selected":"")});e.appendChild(r),this.unWireFieldListEvent(r),this.wireFieldListEvent(r)}},e.prototype.renderTreeView=function(){this.fieldTable=new sf.navigations.TreeView({fields:{dataSource:this.getTreeData(),id:"id",text:"caption",isChecked:"isSelected",parentID:"pid",iconCss:"spriteCssClass"},nodeChecked:this.nodeStateChange.bind(this),cssClass:"e-field-list-tree",showCheckBox:!0,allowDragAndDrop:!0,sortOrder:"None",autoCheck:!1,loadOnDemand:"olap"!==this.parent.dataType,enableRtl:this.parent.enableRtl,nodeDragStart:this.dragStart.bind(this),nodeDragStop:this.dragStop.bind(this),drawNode:this.updateTreeNode.bind(this),nodeExpanding:this.updateNodeIcon.bind(this),nodeCollapsed:this.updateNodeIcon.bind(this),nodeSelected:function(e){sf.base.removeClass([e.node],"e-active"),e.cancel=!0}}),this.treeViewElement.innerHTML="",this.fieldTable.isStringTemplate=!0,this.fieldTable.appendTo(this.treeViewElement);var e="Fixed"===this.parent.renderMode?this.parent.element:this.parentElement;sf.base.isNullOrUndefined(e.querySelector(".e-field-list"))||(e.querySelector(".e-field-list").ej2_instances[0].dragArea=e)},e.prototype.updateNodeIcon=function(e){if("olap"===this.parent.dataType)if(e.node&&e.node.querySelector(".e-list-icon")&&e.node.querySelector(".e-list-icon").className.indexOf("e-folderCDB-icon")>-1){var t=e.node.querySelector(".e-list-icon");sf.base.removeClass([t],"e-folderCDB-icon"),sf.base.addClass([t],"e-folderCDB-open-icon")}else if(e.node&&e.node.querySelector(".e-list-icon")&&e.node.querySelector(".e-list-icon").className.indexOf("e-folderCDB-open-icon")>-1){t=e.node.querySelector(".e-list-icon");sf.base.removeClass([t],"e-folderCDB-open-icon"),sf.base.addClass([t],"e-folderCDB-icon")}},e.prototype.updateTreeNode=function(e){var t=!1;t="olap"!==this.parent.dataType||this.updateOlapTreeNode(e);var i=e.node.querySelector(".e-text-content");if(e.node.querySelector(".e-list-icon")&&i){var a=e.node.querySelector(".e-list-icon");i.insertBefore(a,e.node.querySelector(".e-list-text"))}if(t&&!this.parent.isAdaptive){var s=r.getFieldInfo(e.nodeData.id,this.parent);t=!1;var n=sf.base.createElement("span",{attrs:{tabindex:"-1",title:s.fieldItem?s.fieldItem.allowDragAndDrop?this.parent.localeObj.getConstant("drag"):"":this.parent.localeObj.getConstant("drag"),"aria-disabled":"false"},className:f+" e-drag "+(s.fieldItem?s.fieldItem.allowDragAndDrop?"":"e-disable-drag":"")});e.node.querySelector(".e-checkbox-wrapper")&&!e.node.querySelector(".cls.DRAG_CLASS")&&i&&i.insertBefore(n,e.node.querySelector(".e-checkbox-wrapper"))}e.node.querySelector(".e-check")&&sf.base.addClass([e.node.querySelector(".e-list-text")],"e-selected-node")},e.prototype.updateOlapTreeNode=function(e){var t=!1;return"olap"===this.parent.dataType?(e.node&&e.node.querySelector(".e-calcMemberGroupCDB,.e-measureGroupCDB-icon,.e-folderCDB-icon,.e-folderCDB-open-icon,.e-dimensionCDB-icon,.e-kpiCDB-icon")&&(e.node.querySelector(".e-checkbox-wrapper").style.display="none"),e.node&&e.node.querySelector(".e-list-icon")&&e.node.querySelector(".e-list-icon").className.indexOf("e-level-members")>-1&&(this.parent.isAdaptive?e.node.querySelector(".e-checkbox-wrapper").style.display="none":e.node.querySelector(".e-checkbox-wrapper").style.visibility="hidden"),e.node&&(e.node.querySelector(".e-hierarchyCDB-icon,.e-attributeCDB-icon,.e-namedSetCDB-icon")||e.node.querySelector(".e-measure-icon,.e-kpiGoal-icon,.e-kpiStatus-icon,.e-kpiTrend-icon,.e-kpiValue-icon")||e.node.querySelector(".e-calc-measure-icon,.e-calc-dimension-icon"))&&(e.node.querySelector(".e-measure-icon")?(e.node.querySelector(".e-list-icon").style.display="none",t=!0):t=!0)):t=!0,t},e.prototype.renderTreeDialog=function(e){var t=sf.base.createElement("div",{id:this.parent.element.id+"_FieldListTreeView",className:"e-adaptive-field-list-dialog "+("olap"===this.parent.dataType?"e-olap-editor-dialog":"")});this.parentElement.appendChild(t),this.fieldDialog=new sf.popups.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,header:this.parent.localeObj.getConstant("adaptiveFieldHeader"),content:this.createTreeView(this.getTreeData(e)),isModal:!0,visible:!0,showCloseIcon:!1,enableRtl:this.parent.enableRtl,width:"auto",height:"350px",position:{X:"center",Y:"center"},buttons:[{click:this.closeTreeDialog.bind(this),buttonModel:{cssClass:"e-cancel-btn",content:this.parent.localeObj.getConstant("cancel")}},{click:this.onFieldAdd.bind(this),buttonModel:{cssClass:"e-ok-btn",content:this.parent.localeObj.getConstant("add"),isPrimary:!0}}],closeOnEscape:!1,target:this.parentElement.parentElement,close:this.dialogClose.bind(this)}),this.fieldDialog.isStringTemplate=!0,this.fieldDialog.appendTo(t)},e.prototype.dialogClose=function(){document.getElementById(this.parent.element.id+"_FieldListTreeView")&&sf.base.remove(document.getElementById(this.parent.element.id+"_FieldListTreeView"))},e.prototype.createTreeView=function(e){var t=sf.base.createElement("div",{id:this.parent.element.id+"EditorDiv",className:"e-member-editor-wrapper"}),i=sf.base.createElement("div",{id:this.parent.element.id+"_SearchDiv",attrs:{tabindex:"-1"},className:"e-editor-search-wrapper"}),a=sf.base.createElement("input",{attrs:{type:"text"}});i.appendChild(a);var s=sf.base.createElement("div",{className:"e-member-editor-container-outer-div"}),r=sf.base.createElement("div",{className:"e-member-editor-container "+("olap"===this.parent.dataType?"e-olap-field-list-tree":"")});t.appendChild(i),this.editorSearch=new sf.inputs.MaskedTextBox({showClearButton:!0,placeholder:this.parent.localeObj.getConstant("search"),enableRtl:this.parent.enableRtl,cssClass:"e-editor-search",change:this.textChange.bind(this)}),this.editorSearch.isStringTemplate=!0,this.editorSearch.appendTo(a);var n=sf.base.createElement("div",{className:"e-member-prompt e-disable",innerHTML:this.parent.localeObj.getConstant("noMatches")});return t.appendChild(n),s.appendChild(r),t.appendChild(s),this.fieldTable=new sf.navigations.TreeView({fields:{dataSource:e,id:"id",text:"caption",isChecked:"isSelected",parentID:"pid",iconCss:"spriteCssClass"},showCheckBox:!0,autoCheck:!1,loadOnDemand:"olap"!==this.parent.dataType,sortOrder:"olap"===this.parent.dataType?"None":"Ascending",enableRtl:this.parent.enableRtl,nodeChecked:this.addNode.bind(this),drawNode:this.updateTreeNode.bind(this),nodeExpanding:this.updateNodeIcon.bind(this),nodeCollapsed:this.updateNodeIcon.bind(this),nodeSelected:function(e){sf.base.removeClass([e.node],"e-active"),e.cancel=!0}}),this.fieldTable.isStringTemplate=!0,this.fieldTable.appendTo(r),t},e.prototype.textChange=function(e){this.parent.pivotCommon.eventBase.searchTreeNodes(e,this.fieldTable,!0);var t=this.fieldDialog.element.querySelector(".e-member-prompt"),i=[].slice.call(this.fieldTable.element.querySelectorAll("li")),a=[].slice.call(this.fieldTable.element.querySelectorAll("li.e-disable"));i.length===a.length?sf.base.removeClass([t],"e-disable"):sf.base.addClass([t],"e-disable")},e.prototype.dragStart=function(e){var t=this;if(e.event.target.classList.contains("e-drag")&&!e.event.target.classList.contains("e-disable-drag")){var i=r.getFieldInfo(e.draggedNode.getAttribute("data-uid"),this.parent),a={fieldName:i.fieldName,fieldItem:i.fieldItem,axis:i.axis,dataSourceSettings:this.parent.dataSourceSettings,cancel:!1};(this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger("fieldDragStart",a,(function(i){if(i.cancel)t.parent.isDragging=!1,e.cancel=!0;else{t.parent.isDragging=!0,sf.base.addClass([e.draggedNode.querySelector(".e-list-text")],"e-list-selected");var a=void 0,s=["e-rows","e-columns","e-filters"];if((a="olap"===t.parent.dataType?t.parent.olapEngineModule.fieldList[e.draggedNode.getAttribute("data-uid")]:t.parent.engineModule.fieldList[e.draggedNode.getAttribute("data-uid")])&&"CalculatedField"===a.aggregateType)for(var r=0,n=s;r<n.length;r++){var o=n[r];sf.base.addClass([t.parentElement.querySelector("."+o)],"e-drag-restrict")}var l=e.clonedNode;l&&"Popup"===("pivotfieldlist"===t.parent.getModuleName()&&t.parent.renderMode)&&(l.style.zIndex=(t.parent.dialogRenderer.fieldListDialog.zIndex+1).toString())}}))}else this.parent.isDragging=!1,e.cancel=!0},e.prototype.dragStop=function(e){e.cancel=!0,this.parent.isDragging=!1;for(var t=0,i=["e-rows","e-columns","e-filters"];t<i.length;t++){var a=i[t];sf.base.removeClass([this.parentElement.querySelector("."+a)],"e-drag-restrict")}sf.base.removeClass([e.draggedNode.querySelector(".e-list-text")],"e-list-selected"),this.parent.pivotCommon.filterDialog.dialogPopUp&&this.parent.pivotCommon.filterDialog.dialogPopUp.close();var s=e.draggedNodeData.id.toString();if(this.isNodeDropped(e,s)){var r=this.parent.pivotFieldList[s];if(this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,this.parent.pivotCommon.nodeStateModified.onStateModified(e,s))this.parent.allowDeferLayoutUpdate?(r.isSelected=!0,this.updateDataSource()):this.parent.updateDataSource(),this.parent.axisFieldModule.render()}},e.prototype.isNodeDropped=function(e,t){var i=!0;if("true"===e.draggedNodeData.isChecked){var a=this.getButton(t),s=sf.base.closest(a,".e-droppable"),r=sf.base.closest(e.target,".e-droppable");if(a&&s===r){for(var n=[].slice.call(s.querySelectorAll(".e-pivot-button")),o=sf.base.closest(e.target,".e-pvt-btn-div"),l=void 0,d=-1,p=0,h=n.length;p<h;p++)if(n[p].id===a.id&&(l=p),o){var u=o.querySelector(".e-pivot-button");n[p].id===u.id&&(d=p)}if(l===d||l===n.length-1&&-1===d){var c=document.getElementById(this.parent.element.id+"_Wrapper");sf.base.removeClass([].slice.call(c.querySelectorAll(".e-drop-indicator")),"e-drop-hover"),i=!1}}}return i},e.prototype.getButton=function(e){for(var t,i=document.getElementById(this.parent.element.id+"_Wrapper"),a=[].slice.call(i.querySelectorAll(".e-pivot-button")),s=0,r=a.length;s<r;s++)if(a[s].id===e){t=a[s];break}return t},e.prototype.nodeStateChange=function(e){var t=this,i=sf.base.closest(e.node,".e-text-content");if(!sf.base.isNullOrUndefined(i)){var a=sf.base.closest(i,"li"),s=a.getAttribute("data-uid");this.parent.pivotCommon.filterDialog.dialogPopUp&&this.parent.pivotCommon.filterDialog.dialogPopUp.close();var n=this.parent.pivotFieldList[s],o=r.getFieldInfo(s,this.parent),l=this.parent.isPopupView?this.parent.pivotGridModule:this.parent;if("check"===e.action){var d={fieldName:s,dropField:o.fieldItem,dataSourceSettings:r.getClonedDataSourceSettings(this.parent.dataSourceSettings),dropAxis:"number"===n.type||"CalculatedField"===n.type&&n.formula&&n.formula.indexOf("Measure")>-1&&"olap"===this.parent.dataType?"values":"rows",dropPosition:o.position,draggedAxis:"fieldlist",cancel:!1};l.trigger("fieldDrop",d,(function(r){if(r.cancel)t.updateCheckState(n);else{sf.base.addClass([i.querySelector(".e-list-text")],"e-selected-node"),t.updateSelectedNodes(a,e.action);var l=t.parent.pivotCommon.dataSourceUpdate.getNewField(s,o.fieldItem);t.updateReportSettings(l,r),t.updateNodeStateChange(s,e,n)}}))}else{var p={cancel:!1,fieldName:s,dataSourceSettings:r.getClonedDataSourceSettings(this.parent.dataSourceSettings),fieldItem:o.fieldItem,axis:o.axis};l.trigger("fieldRemove",p,(function(r){r.cancel?t.updateCheckState(n):(sf.base.removeClass([i.querySelector(".e-list-text")],"e-selected-node"),t.updateSelectedNodes(a,e.action),t.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport(s),"olap"===t.parent.dataType&&0===t.parent.dataSourceSettings.values.length&&t.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport("[Measures]"),t.updateNodeStateChange(s,e,n))}))}}},e.prototype.updateReportSettings=function(e,t){var i=t.dropPosition;switch(t.dropAxis){case"filters":-1!==i?this.parent.dataSourceSettings.filters.splice(i,0,e):this.parent.dataSourceSettings.filters.push(e);break;case"rows":-1!==i?this.parent.dataSourceSettings.rows.splice(i,0,e):this.parent.dataSourceSettings.rows.push(e);break;case"columns":-1!==i?this.parent.dataSourceSettings.columns.splice(i,0,e):this.parent.dataSourceSettings.columns.push(e);break;case"values":if(-1!==i?this.parent.dataSourceSettings.values.splice(i,0,e):this.parent.dataSourceSettings.values.push(e),"olap"===this.parent.dataType&&this.parent.olapEngineModule&&!this.parent.olapEngineModule.isMeasureAvail){var a={name:"[Measures]",caption:"Measures",baseField:void 0,baseItem:void 0};("row"===this.parent.dataSourceSettings.valueAxis?this.parent.dataSourceSettings.rows:this.parent.dataSourceSettings.columns).push(a)}}},e.prototype.updateCheckState=function(e){for(var t=this.fieldTable.element.querySelectorAll(".e-checkbox-wrapper"),i=this.fieldTable.element.querySelectorAll(".e-list-text"),a=this.fieldTable.element.querySelectorAll(".e-frame"),s=0;s<t.length;s++)e.caption===i[s].textContent&&("false"===t[s].getAttribute("aria-checked")?(t[s].setAttribute("aria-checked","false"),a[s].classList.add("e-check")):(t[s].setAttribute("aria-checked","true"),a[s].classList.remove("e-check")))},e.prototype.updateNodeStateChange=function(e,t,i){this.parent.allowDeferLayoutUpdate?(i.isSelected="check"===t.action,"olap"===this.parent.dataType&&this.parent.olapEngineModule.updateFieldlistData(e,"check"===t.action),this.updateDataSource()):this.parent.updateDataSource(!0);var a=this.parent;setTimeout((function(){a.axisFieldModule.render()}))},e.prototype.updateSelectedNodes=function(e,t){if(e&&e.querySelector("ul"))for(var i=0,a=[].slice.call(e.querySelectorAll("li"));i<a.length;i++){var s=a[i];"check"===t?sf.base.addClass([s.querySelector(".e-list-text")],"e-selected-node"):sf.base.removeClass([s.querySelector(".e-list-text")],"e-selected-node")}},e.prototype.updateDataSource=function(){"pivotfieldlist"===this.parent.getModuleName()&&"Popup"===this.parent.renderMode?("olap"===this.parent.dataType?this.parent.pivotGridModule.olapEngineModule=this.parent.olapEngineModule:this.parent.pivotGridModule.engineModule=this.parent.engineModule,this.parent.pivotGridModule.setProperties({dataSourceSettings:this.parent.dataSourceSettings.properties},!0),this.parent.pivotGridModule.notify(d,this)):this.parent.triggerPopulateEvent()},e.prototype.addNode=function(e){var t=this,i=this.parent.pivotFieldList[e.data[0].id.toString()],a=r.getFieldInfo(i.id.toString(),this.parent),s=this.parent.isPopupView?this.parent.pivotGridModule:this.parent;if("check"===e.action){var n={fieldName:a.fieldName,dropField:a.fieldItem,dataSourceSettings:r.getClonedDataSourceSettings(this.parent.dataSourceSettings),dropAxis:"rows",draggedAxis:"fieldlist",cancel:!1};s.trigger("fieldDrop",n,(function(e){e.cancel?t.updateCheckState(i):t.selectedNodes.push(i.id.toString())}))}else{var o={cancel:!1,fieldName:a.fieldName,dataSourceSettings:r.getClonedDataSourceSettings(this.parent.dataSourceSettings),fieldItem:a.fieldItem,axis:a.axis};s.trigger("fieldRemove",o,(function(e){if(e.cancel)t.updateCheckState(i);else for(var a=t.selectedNodes.length;a--;)if(t.selectedNodes[a]===i.id.toString()){t.selectedNodes.splice(a,1);break}}))}},e.prototype.refreshTreeView=function(){if(this.fieldTable){var e=this.getUpdatedData();this.fieldTable.fields={dataSource:e,id:"id",text:"caption",isChecked:"isSelected",parentID:"pid",iconCss:"spriteCssClass"},this.fieldTable.dataBind()}},e.prototype.getUpdatedData=function(){var e=this.getTreeData(),t=this.fieldTable.expandedNodes;return this.updateExpandedNodes(e,t),this.applySorting(e,this.fieldListSort)},e.prototype.getTreeData=function(e){var t=[];if("olap"===this.parent.dataType)t=this.getOlapTreeData(e);else{for(var i=this.parent.pivotFieldList?Object.keys(this.parent.pivotFieldList):[],a={},s=0,r=i;s<r.length;s++){var n=r[s],o=this.parent.pivotFieldList[n];a[n]={id:o.id,caption:o.caption,isSelected:o.isSelected}}if(this.parent.isAdaptive){for(var l=[this.parent.dataSourceSettings.filters,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.values][e],d=i.length;d--;)a[i[d]].isSelected=!1;for(var p=0,h=l;p<h.length;p++){a[h[p].name].isSelected=!0}}for(var u=a,c=0,g=i;c<g.length;c++){var f=u[o=g[c]];t.push(f)}}return t},e.prototype.getOlapTreeData=function(e){var t=[],i=this.parent.olapEngineModule.fieldListData?this.parent.olapEngineModule.fieldListData:[];if(this.parent.isAdaptive)for(var a=[this.parent.dataSourceSettings.filters,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.values][e],s=0;s<i.length;){var n=i[s],o=void 0;if(3===e){if("[measures]"!==n.id.toLowerCase()&&(0===n.id.toLowerCase().indexOf("[measures]")||n.spriteCssClass&&-1!==n.spriteCssClass.indexOf("e-measureCDB"))||"[calculated members].[_0]"===n.id.toLowerCase()||n.spriteCssClass&&-1!==n.spriteCssClass.indexOf("e-calc-measure-icon")){(o={id:n.id,caption:n.caption,hasChildren:n.hasChildren,type:n.type,aggregateType:n.aggregateType,isSelected:n.isSelected,pid:n.pid,spriteCssClass:n.spriteCssClass}).isSelected=!1,o.spriteCssClass&&-1!==o.spriteCssClass.indexOf("e-measureCDB")&&(o.spriteCssClass=o.spriteCssClass.replace("e-folderCDB-icon","e-measureGroupCDB-icon"),o.pid=void 0);for(var l=0,d=a;l<d.length;l++){var p=d[l];if(o.id===p.name){o.isSelected=!0;break}}t.push(o)}}else if(!(0===n.id.toLowerCase().indexOf("[measures]")||n.spriteCssClass&&-1!==n.spriteCssClass.indexOf("e-measureCDB")||n.spriteCssClass&&-1!==n.spriteCssClass.indexOf("e-calc-measure-icon"))){(o={id:n.id,caption:n.caption,hasChildren:n.hasChildren,type:n.type,aggregateType:n.aggregateType,isSelected:n.isSelected,pid:n.pid,spriteCssClass:n.spriteCssClass}).isSelected=!1;for(var h=0,u=a;h<u.length;h++){var c=u[h];if(o.id===c.name){o.isSelected=!0;break}}t.push(o)}s++}else t=r.getClonedData(this.parent.olapEngineModule.fieldListData);return t},e.prototype.updateExpandedNodes=function(e,t){if(t.length>0)for(var i=0,a=0,s=e;a<s.length;a++){var r=s[a];if(t.indexOf(r.id)>-1&&(i++,r.expanded=!0,r.spriteCssClass=r.spriteCssClass&&r.spriteCssClass.toString().indexOf("e-folderCDB-icon")>-1?r.spriteCssClass.toString().replace("e-folderCDB-icon","e-folderCDB-open-icon"):r.spriteCssClass,i===t.length))break}},e.prototype.updateSorting=function(e){var t=e.target,i=t.getAttribute("data-sort");if(-1===t.className.indexOf("e-selected")){switch(i){case"None":this.fieldListSort="None",sf.base.addClass([t],"e-selected"),sf.base.removeClass([this.parentElement.querySelector(".e-sort-ascend")],"e-selected"),sf.base.removeClass([this.parentElement.querySelector(".e-sort-descend")],"e-selected");break;case"Ascend":this.fieldListSort="Ascend",sf.base.addClass([t],"e-selected"),sf.base.removeClass([this.parentElement.querySelector(".e-sort-none")],"e-selected"),sf.base.removeClass([this.parentElement.querySelector(".e-sort-descend")],"e-selected");break;case"Descend":this.fieldListSort="Descend",sf.base.addClass([t],"e-selected"),sf.base.removeClass([this.parentElement.querySelector(".e-sort-ascend")],"e-selected"),sf.base.removeClass([this.parentElement.querySelector(".e-sort-none")],"e-selected")}this.refreshTreeView()}},e.prototype.applySorting=function(e,t){if("olap"===this.parent.dataType){var i=void 0,a=void 0;this.parent.dataSourceSettings.calculatedFieldSettings.length>0&&"[calculated members].[_0]"===e[0].id.toLowerCase()?(a=e[0],i=e[1],e.splice(0,2)):(i=e[0],e.splice(0,1)),e="Ascend"===t?e.sort((function(e,t){return e.caption>t.caption?1:t.caption>e.caption?-1:0})):"Descend"===t?e.sort((function(e,t){return e.caption<t.caption?1:t.caption<e.caption?-1:0})):e,a?e.splice(0,0,a,i):e.splice(0,0,i)}else this.fieldTable.sortOrder="Ascend"===t?"Ascending":"Descend"===t?"Descending":"None";return e},e.prototype.onFieldAdd=function(e){this.parent.dialogRenderer.updateDataSource(this.selectedNodes),this.closeTreeDialog()},e.prototype.closeTreeDialog=function(){this.selectedNodes=[],this.fieldDialog.hide()},e.prototype.keyPress=function(e){if(13===e.keyCode&&e.target)return e.target.click(),void e.preventDefault()},e.prototype.wireFieldListEvent=function(e){sf.base.EventHandler.add(e,"keydown",this.keyPress,this),sf.base.EventHandler.add(e,"click",this.updateSorting,this)},e.prototype.unWireFieldListEvent=function(e){sf.base.EventHandler.remove(e,"keydown",this.keyPress),sf.base.EventHandler.remove(e,"click",this.updateSorting)},e.prototype.addEventListener=function(){this.parent.on("tree-view-update",this.refreshTreeView,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off("tree-view-update",this.refreshTreeView)},e.prototype.destroy=function(){this.removeEventListener()},e}(),dt=function(){function e(e){this.parent=e}return e.prototype.render=function(){if(!this.parent.isAdaptive){var e=sf.base.createElement("div",{className:"e-axis-table "+("olap"===this.parent.dataType?"e-olap-axis-table":"")});this.leftAxisPanel=sf.base.createElement("div",{className:"e-left-axis-fields"}),this.rightAxisPanel=sf.base.createElement("div",{className:"e-right-axis-fields"}),this.parent.dialogRenderer.parentElement.appendChild(e),e.appendChild(this.leftAxisPanel),e.appendChild(this.rightAxisPanel),this.axisTable=e,this.renderAxisTable()}this.parent.axisFieldModule.render()},e.prototype.renderAxisTable=function(){for(var e=["filters","rows","columns","values"],t=0,i=e.length;t<i;t++){var a=sf.base.createElement("div",{className:"e-field-list-"+e[t]}),s=sf.base.createElement("div",{className:"e-axis-wrapper"}),r=sf.base.createElement("div",{className:"e-axis-header",attrs:{title:this.parent.localeObj.getConstant(e[t])},innerHTML:this.parent.localeObj.getConstant(e[t])});s.appendChild(this.getIconupdate(e[t])),s.appendChild(r);var n=sf.base.createElement("div",{className:"e-axis-content e-"+e[t]}),o=void 0;o="rows"===e[t]?this.parent.localeObj.getConstant("dropRowPrompt"):"columns"===e[t]?this.parent.localeObj.getConstant("dropColPrompt"):"values"===e[t]?this.parent.localeObj.getConstant("dropValPrompt"):this.parent.localeObj.getConstant("dropFilterPrompt");var l=sf.base.createElement("span",{className:"e-draggable-prompt",innerHTML:o});new sf.base.Droppable(n,{});a.appendChild(s),a.appendChild(n),a.appendChild(l),t<=1?this.leftAxisPanel.appendChild(a):this.rightAxisPanel.appendChild(a),this.unWireEvent(n),this.wireEvent(n)}},e.prototype.getIconupdate=function(e){var t=sf.base.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:"e-axis-icon-wrapper"}),i=sf.base.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:f+" e-axis-"+e});return t.appendChild(i),t},e.prototype.wireEvent=function(e){sf.base.EventHandler.add(e,"mouseover",this.updateDropIndicator,this),sf.base.EventHandler.add(e,"mouseleave",this.updateDropIndicator,this)},e.prototype.unWireEvent=function(e){sf.base.EventHandler.remove(e,"mouseover",this.updateDropIndicator),sf.base.EventHandler.remove(e,"mouseleave",this.updateDropIndicator)},e.prototype.updateDropIndicator=function(e){var t=this.parent.dialogRenderer.parentElement;if(this.parent.isDragging&&e.target.classList.contains("e-axis-content")&&"mouseover"===e.type){sf.base.removeClass([].slice.call(t.querySelectorAll(".e-drop-indicator")),"e-drop-hover"),sf.base.removeClass([].slice.call(t.querySelectorAll(".e-drop-indicator-last")),"e-drop-hover");var i=[].slice.call(e.target.querySelectorAll(".e-pvt-btn-div"));i.length>0&&sf.base.addClass([i[i.length-1].querySelector(".e-drop-indicator-last")],"e-drop-hover")}else"mouseleave"===e.type&&(sf.base.removeClass([].slice.call(t.querySelectorAll(".e-drop-indicator")),"e-drop-hover"),sf.base.removeClass([].slice.call(t.querySelectorAll(".e-drop-indicator-last")),"e-drop-hover"))},e}(),pt=function(){function e(e){this.parent=e,this.menuOption=new L(this.parent),this.parent.pivotButtonModule=this,this.addEventListener(),this.parent instanceof ft&&(this.axisField=new ht(this.parent)),this.isDestroyed=!1}return e.prototype.renderPivotButton=function(e){var t,i,a=this,s=sf.base.extend([],e.field,null,!0),n=e.axis,o=-1,l="pivot"===this.parent.dataType&&("pivotfieldlist"===this.parent.getModuleName()&&this.parent.pivotGridModule?this.parent.pivotGridModule.showValuesButton:this.parent.showValuesButton);if(("row"===this.parent.dataSourceSettings.valueAxis&&"rows"===e.axis||"column"===this.parent.dataSourceSettings.valueAxis&&"columns"===e.axis)&&l&&this.parent.dataSourceSettings.values.length>1&&(o=s.length,sf.base.isNullOrUndefined(r.getFieldByName(this.parent.localeObj.getConstant("values"),s))&&s.push({name:this.parent.localeObj.getConstant("values"),caption:this.parent.localeObj.getConstant("values"),axis:e.axis,showRemoveIcon:!0,allowDragAndDrop:!0})),this.parentElement="pivotview"===this.parent.getModuleName()?this.parent.element:document.getElementById(this.parent.element.id+"_Wrapper"),"pivotfieldlist"===this.parent.getModuleName()){if(this.parentElement=document.getElementById(this.parent.element.id+"_Wrapper"),!this.parentElement.querySelector(".e-field-list-"+n))return;var d=this.parentElement.querySelector(".e-field-list-"+n).querySelector(".e-draggable-prompt");0===s.length?sf.base.removeClass([d],"e-disable"):sf.base.addClass([d],"e-disable"),i=this.parentElement.querySelector(".e-field-list-"+n).querySelector(".e-axis-content")}else this.parentElement=this.parent.element,i=this.parentElement.querySelector(".e-group-"+n);if(i)if("pivotview"===this.parent.getModuleName()&&0===s.length)for(var p=0,h=this.parentElement.querySelectorAll(".e-group-"+n);p<h.length;p++){if(!(R=h[p]).classList.contains("e-group-chart-values")&&!R.classList.contains("e-group-chart-columns")){d=sf.base.createElement("span",{className:"e-draggable-prompt",innerHTML:this.parent.groupingBarSettings.allowDragAndDrop?"rows"===n?this.parent.localeObj.getConstant("rowAxisPrompt"):"columns"===n?this.parent.localeObj.getConstant("columnAxisPrompt"):"values"===n?this.parent.localeObj.getConstant("valueAxisPrompt"):this.parent.localeObj.getConstant("filterAxisPrompt"):""});R.appendChild(d)}}else{for(var u=0,c=s.length;u<c;u++)for(var g=0,m="pivotfieldlist"===this.parent.getModuleName()?[i]:this.parentElement.querySelectorAll(".e-group-"+n);g<m.length;g++){R=R=m[g];var v="olap"===this.parent.dataType&&("[measures]"===s[u].name.toLowerCase()||"values"===n),b="olap"===this.parent.dataType&&"values"===n;if(!R.classList.contains("e-group-chart-values")&&!R.classList.contains("e-group-chart-columns")){var S=sf.base.createElement("div",{className:"e-pvt-btn-div"+(0===u?" e-first-btn":""),attrs:{"data-tag":n+":"+s[u].name}}),y=sf.base.createElement("div",{id:s[u].name,className:"e-pivot-button "+s[u].name.replace(/[^A-Z0-9]/gi,""),attrs:{"data-uid":s[u].name,tabindex:"pivotview"===this.parent.getModuleName()&&this.parent.grid&&"rows"===n&&!R.classList.contains("e-group-chart-rows")?"-1":"0",isvalue:u===o||v&&!b?"true":"false","aria-disabled":"false","aria-label":s[u].caption?s[u].caption:s[u].name,"data-type":"olap"===this.parent.dataType?b?"isMeasureFieldsAvail":v?"isMeasureAvail":s[u].type:s[u].type,"data-caption":s[u].caption?s[u].caption:s[u].name,"data-basefield":s[u].baseField,"data-baseitem":s[u].baseItem}}),C=sf.base.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:"e-drop-indicator"}),w=sf.base.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:"e-drop-indicator-last"}),x=this.createButtonDragIcon(s[u],y),T=this.createButtonText(s,u,n,o);if(y.appendChild(T),v||s[u].isNamedSet||s[u].isCalculatedField||(-1!==["filters","values"].indexOf(n)||o===u||"olap"===this.parent.dataType&&("pivotview"===this.parent.getModuleName()&&this.parent.enableVirtualization||"pivotfieldlist"===this.parent.getModuleName()&&void 0!==this.parent.pivotGridModule&&this.parent.pivotGridModule.enableVirtualization)||this.createSortOption(y,s[u].name,s[u]),"values"!==n&&o!==u&&this.createFilterOption(y,s[u].name,n,s[u]),"values"===n&&this.getTypeStatus(s,u,y)),s[u].isCalculatedField||"CalculatedField"===s[u].type){var M=sf.base.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("editCalculatedField")},className:f+" e-edit"});this.parent.allowCalculatedField&&this.parent.calculatedFieldModule&&s[u].showEditIcon?sf.base.removeClass([M],"e-disable"):sf.base.addClass([M],"e-disable"),y.appendChild(M)}var D=sf.base.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("remove")},className:f+" e-remove"});"pivotview"===this.parent.getModuleName()?this.parent.groupingBarSettings.showRemoveIcon&&s[u].showRemoveIcon?sf.base.removeClass([D],"e-disable"):sf.base.addClass([D],"e-disable"):s[u].showRemoveIcon?sf.base.removeClass([D],"e-disable"):sf.base.addClass([D],"e-disable"),y.appendChild(D),S.appendChild(C),S.appendChild(y),S.appendChild(w),R.appendChild(S);var E=new sf.buttons.Button({enableRtl:this.parent.enableRtl});E.isStringTemplate=!0,E.appendTo(y),this.unWireEvent(S,u===o?"values":n,v),this.wireEvent(S,u===o?"values":n,v),("pivotview"===this.parent.getModuleName()&&!this.parent.isAdaptive||"pivotfieldlist"===this.parent.getModuleName())&&this.createDraggable(s[u],"pivotview"===this.parent.getModuleName()?T:x),y.querySelector(".e-draggable").ej2_instances[0].dragArea=this.parentElement}}if("values"===n)for(var O=function(e){if(e.classList.contains("e-group-chart-values")&&P.parent.chartModule){var t=s.map((function(e){return{text:e.caption?e.caption:e.name,value:e.name}})),i=P.parent;if(P.valueFiedDropDownList&&e.querySelector(".e-group-chart-values-drodown-div"))P.valueFiedDropDownList.dataSource=t,P.valueFiedDropDownList.value=i.chartSettings.enableMultiAxis?t[0].value:i.chartModule.currentMeasure;else{var a=sf.base.createElement("div",{className:"e-group-chart-values-drodown-div"});e.appendChild(a),P.valueFiedDropDownList=new sf.dropdowns.DropDownList({dataSource:t,enableRtl:P.parent.enableRtl,value:i.chartSettings.enableMultiAxis?t[0].value:i.chartModule.currentMeasure,width:200,fields:{value:"value",text:"text"},cssClass:"e-group-chart-values-drodown",change:function(e){e.e&&null!==e.e&&(i.chartSettings.value=e.value)}}),P.valueFiedDropDownList.isStringTemplate=!0,P.valueFiedDropDownList.appendTo(a)}}},P=this,N=0,F=this.parentElement.querySelectorAll(".e-group-"+n);N<F.length;N++){O(R=F[N])}else if("columns"===n)for(var I=void 0,L=0,A=this.parentElement.querySelectorAll(".e-group-"+n);L<A.length;L++){var R;if((R=A[L]).classList.contains("e-group-chart-columns")&&this.parent.chartModule){for(var k=this.parent.chartModule.currentMeasure,j=this.parent.chartSettings.columnDelimiter?this.parent.chartSettings.columnDelimiter:"-",q=this.parent.chartSettings.columnHeader&&""!==this.parent.chartSettings.columnHeader?this.parent.chartSettings.columnHeader.split(j).join(" - "):"",V="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,B=V.pivotValues,_=this.parent.chartModule.getColumnTotalIndex(B),H=[],U=!1,G=0,z=Object.keys(B);G<z.length;G++){var W=z[G];if(U)break;var Q=Number(W);if(B[Q][0]&&"row"===B[Q][0].axis&&(0===this.parent.dataSourceSettings.rows.length||"grand sum"!==B[Q][0].type))for(var Y=B[Q][0],K="olap"===this.parent.dataType?V.tupRowInfo[Y.ordinal]:void 0,J=B[Q],X=0,Z=Object.keys(J);X<Z.length;X++){var $=Z[X],ee=Number($),te=B[Q][ee],ie="olap"===this.parent.dataType&&K&&K.measureName?K.measureName:te.actualText;if(!_[te.colIndex]&&"value"===te.axis&&"header"!==Y.type&&""!==ie&&ie===k){U=!0;var ae="olap"===this.parent.dataType?te.columnHeaders.toString().split(/~~|::/).join(" - "):te.columnHeaders.toString().split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).join(" - ");H.push({value:ae,text:ae,title:(t={},t.title=ae,t)}),ae===q&&(I=H.length)}}}if(this.columnFieldDropDownList&&R.querySelector(".e-group-chart-columns-dropdown-div"))this.columnFieldDropDownList.dataSource=H,this.columnFieldDropDownList.value=void 0!==I?H[I-1].value:H[0].value;else{var se=sf.base.createElement("div",{className:"e-group-chart-columns-dropdown-div"});R.appendChild(se),this.columnFieldDropDownList=new sf.dropdowns.DropDownList({dataSource:H,enableRtl:this.parent.enableRtl,value:I?H[I-1].value:H[0]?H[0].value:"",width:"200",fields:{value:"value",text:"text",htmlAttributes:"title"},cssClass:"e-group-chart-columns-dropdown",change:function(e){if(e.e&&null!==e.e){var t=a.parent.chartSettings.columnDelimiter?a.parent.chartSettings.columnDelimiter:"-";a.parent.chartSettings.columnHeader=e.value.split(" - ").join(t)}}}),this.columnFieldDropDownList.isStringTemplate=!0,this.columnFieldDropDownList.appendTo(se)}}}}},e.prototype.createButtonText=function(e,t,i,a){var s,r,n;"filters"===i&&(r=this.updateButtontext(e[t].name)),void 0!==(n="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule).fieldList[e[t].name]&&(s="DistinctCount"===(s=n.fieldList[e[t].name].aggregateType)||"number"===n.fieldList[e[t].name].type&&"include"!==n.fieldList[e[t].name].type&&"exclude"!==n.fieldList[e[t].name].type?void 0===s?"Sum":n.fieldList[e[t].name].aggregateType:"Count");var o=e[t].caption?e[t].caption:e[t].name;return sf.base.createElement("span",{attrs:{title:"filters"===i?"olap"===this.parent.dataType&&"CalculatedField"===n.fieldList[e[t].name].type?o:o+" ("+r+")":"olap"===this.parent.dataType?o:this.parent.dataSourceSettings.showAggregationOnValueField&&"values"===i&&"CalculatedField"!==s?this.parent.localeObj.getConstant(s)+" "+this.parent.localeObj.getConstant("of")+" "+o:o,tabindex:"-1","aria-disabled":"false",oncontextmenu:"return false;","data-type":a===t?"":s},className:"e-content "+("pivotview"===this.parent.getModuleName()?this.parent.groupingBarSettings.allowDragAndDrop&&e[t].allowDragAndDrop?"":"e-disable-drag":""),innerHTML:"filters"===i?"olap"===this.parent.dataType&&"CalculatedField"===n.fieldList[e[t].name].type?o:o+" ("+r+")":"olap"===this.parent.dataType?o:this.parent.dataSourceSettings.showAggregationOnValueField&&"values"===i&&"CalculatedField"!==s?this.parent.localeObj.getConstant(s)+" "+this.parent.localeObj.getConstant("of")+" "+o:o})},e.prototype.getTypeStatus=function(e,t,i){var a=("olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule).fieldList[e[t].name];"CalculatedField"!==a.aggregateType&&this.validateDropdown(a.type)&&this.createSummaryType(i,e[t].name,e[t])},e.prototype.validateDropdown=function(e){var t=this.parent.aggregateTypes;if("number"!==e)return t.indexOf("Count")>-1||t.indexOf("DistinctCount")>-1;for(var i=0;i<t.length;i++)if(this.parent.getAllSummaryType().indexOf(t[i])>-1)return!0;return!1},e.prototype.createSummaryType=function(e,t,i){var a=sf.base.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("format")},className:f+" e-dropdown-icon"});return"pivotview"===this.parent.getModuleName()?this.parent.groupingBarSettings.showValueTypeIcon&&i.showValueTypeIcon?sf.base.removeClass([a],"e-disable"):sf.base.addClass([a],"e-disable"):i.showValueTypeIcon?sf.base.removeClass([a],"e-disable"):sf.base.addClass([a],"e-disable"),e.appendChild(a),a},e.prototype.createMenuOption=function(e){this.menuOption.render(e,this.parentElement),this.parent.pivotButtonModule=this},e.prototype.openCalculatedFieldDialog=function(e){var t=e.target.parentElement.id;"pivotview"===this.parent.getModuleName()?this.parent.isAdaptive&&this.parent.showFieldList&&this.parent.pivotFieldListModule&&!this.parent.pivotFieldListModule.isDestroyed?(this.parent.pivotFieldListModule.element.querySelector(".e-toggle-field-list").click(),this.parent.pivotFieldListModule.dialogRenderer.adaptiveElement.select(4),this.parent.pivotFieldListModule.calculatedFieldModule.updateAdaptiveCalculatedField(!0,t)):(this.parent.isAdaptive||(this.parent.calculatedFieldModule.buttonCall=!0),this.parent.notify("init-calculatedfield",{edit:!0,fieldName:t})):"pivotfieldlist"===this.parent.getModuleName()&&(this.parent.isAdaptive?(this.parent.dialogRenderer.adaptiveElement.select(4),this.parent.calculatedFieldModule.updateAdaptiveCalculatedField(!0,t),this.parent.calculatedFieldModule.buttonCall=!0):(this.parent.dialogRenderer.fieldListDialog&&(this.parent.dialogRenderer.fieldListDialog.hide(),sf.base.addClass([this.parent.element.querySelector(".e-toggle-field-list")],"e-hide")),this.parent.notify("init-calculatedfield",{edit:!0,fieldName:t}),this.parent.calculatedFieldModule&&(this.parent.calculatedFieldModule.buttonCall=!0)))},e.prototype.createDraggable=function(e,t){this.draggable=new sf.base.Draggable(t,{clone:!0,enableTailMode:!0,enableAutoScroll:!0,helper:this.createDragClone.bind(this),dragStart:this.onDragStart.bind(this),drag:this.onDragging.bind(this),dragStop:this.onDragStop.bind(this),abort:"pivotview"===this.parent.getModuleName()?this.parent.groupingBarSettings.allowDragAndDrop&&e.allowDragAndDrop?"":".e-pivot-button":e.allowDragAndDrop?"":".e-pivot-button"})},e.prototype.createButtonDragIcon=function(e,t){var i=sf.base.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"}}),a=sf.base.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("drag")},className:f+" e-drag "+(e.allowDragAndDrop?"":"e-disable-drag")});return i.appendChild(a),t.appendChild(i),i},e.prototype.createSortOption=function(e,t,i){var a,s,r;if(r="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,this.parent.allowDeferLayoutUpdate){a="";for(var n=0;n<this.parent.dataSourceSettings.sortSettings.length;n++)this.parent.dataSourceSettings.sortSettings[n].name===t&&(a="Descending"===this.parent.dataSourceSettings.sortSettings[n].order?"e-descend":"")}else a="Descending"===r.fieldList[t].sort?"e-descend":"";return s="None"===r.fieldList[t].sort?sf.base.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("sort")},className:f}):sf.base.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("sort")},className:f+" e-sort "+a}),this.parent.dataSourceSettings.enableSorting?"pivotview"===this.parent.getModuleName()?i.showSortIcon&&this.parent.groupingBarSettings.showSortIcon?sf.base.removeClass([s],"e-disable"):sf.base.addClass([s],"e-disable"):i.showSortIcon?sf.base.removeClass([s],"e-disable"):sf.base.addClass([s],"e-disable"):sf.base.addClass([s],"e-disable"),e.appendChild(s),s},e.prototype.createFilterOption=function(e,t,i,a){var s,r;if(r="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,this.parent.allowDeferLayoutUpdate){s="e-pv-filter";for(var n=0;n<this.parent.dataSourceSettings.filterSettings.length;n++)this.parent.dataSourceSettings.filterSettings[n].name===t&&(s="e-pv-filtered")}else r.fieldList[t].filter=null===r.fieldList[t].filter?[]:r.fieldList[t].filter,s=0===r.fieldList[t].filter.length?r.fieldList[t].isExcelFilter?"e-pv-filtered":"e-pv-filter":"e-pv-filtered";var o=sf.base.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("filter")},className:"e-btn-filter "+f+" "+s});return(this.parent.dataSourceSettings.allowLabelFilter||this.parent.dataSourceSettings.allowValueFilter)&&"filters"!==i||this.parent.dataSourceSettings.allowMemberFilter?sf.base.removeClass([o],"e-disable"):sf.base.addClass([o],"e-disable"),"pivotview"===this.parent.getModuleName()?((this.parent.dataSourceSettings.allowLabelFilter||this.parent.dataSourceSettings.allowValueFilter)&&"filters"!==i||this.parent.dataSourceSettings.allowMemberFilter)&&this.parent.groupingBarSettings.showFilterIcon&&a.showFilterIcon?sf.base.removeClass([o],"e-disable"):sf.base.addClass([o],"e-disable"):a.showFilterIcon&&((this.parent.dataSourceSettings.allowLabelFilter||this.parent.dataSourceSettings.allowValueFilter)&&"filters"!==i||this.parent.dataSourceSettings.allowMemberFilter)?sf.base.removeClass([o],"e-disable"):sf.base.addClass([o],"e-disable"),e.appendChild(o),o},e.prototype.updateButtontext=function(e){var t,i,a=(t="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule).fieldList[e].filter.length,s=t.fieldList[e].filterType,r=t.fieldList[e].dateMember.length,n=t.fieldList[e].filter[0];if("olap"===this.parent.dataType)i=this.updateOlapButtonText(t,e,n,a);else if("include"===s)1===a?i=n:a>1&&(i=a===r?this.parent.localeObj.getConstant("all"):this.parent.localeObj.getConstant("multipleItems"));else if("exclude"===s){if(1===a)i=2===r?n!==t.fieldList[e].dateMember[0].actualText?n:t.fieldList[e].dateMember[0].actualText:this.parent.localeObj.getConstant("multipleItems");else if(a>1){var o=void 0,l=Object.keys(t.fieldList[e].members),d=t.fieldList[e].filter;if(a===l.length-1)e:for(o=0;o<l.length;o++){var p=l[o];if(-1===d.indexOf(p)){i=l[o];break e}}else i=this.parent.localeObj.getConstant("multipleItems")}}else i=this.parent.localeObj.getConstant("all");return i},e.prototype.updateOlapButtonText=function(e,t,i,a){var s,r=e.fieldList[t].actualFilter;if(r.length>0){var n=e.fieldList[t].members,o=[];if(e.fieldList[t].filterMembers.length>0){for(var l={},d=0,p=r;d<p.length;d++){l[c=p[d]]=c,n[c]&&(l=this.parent.pivotCommon.eventBase.getParentNode(t,c,l))}for(var h=0,u=l?Object.keys(l):[];h<u.length;h++){var c;n[c=u[h]].isSelected&&(n[c].parent&&n[n[c].parent].isSelected||o.push(c))}i=1===o.length?n[o[0]].caption:i}a=0===o.length?a:o.length}return 0===a?s=e.fieldList[t].allMember?e.fieldList[t].allMember:this.parent.localeObj.getConstant("all"):1===a?s=i:a>1&&(s=this.parent.localeObj.getConstant("multipleItems")),s},e.prototype.createDragClone=function(e){var t=sf.base.closest(e.element,".e-pivot-button"),i=sf.base.createElement("div",{id:this.parent.element.id+"_DragClone",className:"e-button-drag-clone"}),a=sf.base.createElement("span",{className:"e-text-content",innerHTML:t.textContent});return i.appendChild(a),document.body.appendChild(i),i},e.prototype.onDragStart=function(e){var t=this,i=sf.base.closest(e.element,".e-pivot-button"),a=document.getElementById(this.parent.element.id+"_DragClone"),s=r.getFieldInfo(i.getAttribute("data-uid"),this.parent),n={fieldName:s.fieldName,fieldItem:s.fieldItem,axis:s.axis,dataSourceSettings:r.getClonedDataSourceSettings(this.parent.dataSourceSettings),cancel:!1};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger("fieldDragStart",n,(function(s){if(s.cancel)t.parent.isDragging=!1,t.draggable.intDestroy(e.event),sf.base.detach(a);else{t.parent.isDragging=!0;var r=("olap"===t.parent.dataType?t.parent.olapEngineModule:t.parent.engineModule).fieldList[i.getAttribute("data-uid")],n=["e-rows","e-columns","e-filters"];if(sf.base.addClass([i],"e-list-selected"),a&&"Popup"===("pivotfieldlist"===t.parent.getModuleName()&&t.parent.renderMode)){var o=t.parent;a.style.zIndex=(o.dialogRenderer.fieldListDialog.zIndex+1).toString()}if(r&&"CalculatedField"===r.aggregateType)for(var l=0,d=n;l<d.length;l++){var p=d[l];sf.base.addClass([t.parentElement.querySelector("."+p)],"e-drag-restrict")}sf.base.isBlazor()&&e.bindEvents(e.dragElement)}}))},e.prototype.onDragging=function(e){this.draggable.setProperties({cursorAt:{top:!sf.base.isNullOrUndefined(e.event.targetTouches)||sf.base.Browser.isDevice?60:-20}})},e.prototype.onDragStop=function(e){this.parent.isDragging=!1,e.target.classList&&(e.target.classList.contains("e-group-chart-values")||e.target.classList.contains("e-group-chart-values-drodown"))&&(e.target=this.parent.element.querySelector(".e-group-chart-rows")),e.target.classList&&e.element&&(e.target.classList.contains("e-group-chart-columns")||e.target.classList.contains("e-group-chart-columns-dropdown"))&&(e.cancel=!0);var t=sf.base.closest(e.element,".e-pivot-button");sf.base.removeClass([].slice.call(this.parentElement.querySelectorAll(".e-pivot-button")),"e-list-selected"),sf.base.removeClass([].slice.call(this.parentElement.querySelectorAll(".e-drop-indicator")),"e-drop-hover");for(var i=0,a=["e-rows","e-columns","e-filters"];i<a.length;i++){var s=a[i];sf.base.removeClass([this.parentElement.querySelector("."+s)],"e-drag-restrict")}if(this.parent.pivotCommon.filterDialog.dialogPopUp&&this.parent.pivotCommon.filterDialog.dialogPopUp.close(),document.getElementById(this.parent.element.id+"_DragClone")&&sf.base.remove(document.getElementById(this.parent.element.id+"_DragClone")),document.body.style.cursor="auto",this.isButtonDropped(e.target,t)&&!e.cancel&&(this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,this.parent.pivotCommon.nodeStateModified.onStateModified(e,t.id))){this.updateDataSource();this.parent.axisFieldModule.render()}},e.prototype.isButtonDropped=function(e,t){var i=sf.base.closest(t,".e-droppable"),a=!0;if(i===sf.base.closest(e,".e-droppable")){for(var s=[].slice.call(i.querySelectorAll(".e-pivot-button")),r=sf.base.closest(e,".e-pvt-btn-div"),n=void 0,o=-1,l=0,d=s.length;l<d;l++)if(s[l].id===t.id&&(n=l),r){var p=r.querySelector(".e-pivot-button");s[l].id===p.id&&(o=l)}(n===o||n===s.length-1&&-1===o)&&(sf.base.removeClass([].slice.call(this.parentElement.querySelectorAll(".e-drop-indicator")),"e-drop-hover"),a=!1)}return a},e.prototype.updateSorting=function(e){var t=sf.base.closest(e.target,".e-pivot-button"),i=r.getFieldInfo(t?t.id:"",this.parent);if(!e.target.classList.contains("e-btn-filter")&&!e.target.classList.contains("e-remove")&&!e.target.classList.contains("e-drag")&&t&&i.fieldItem&&(i.fieldItem.showSortIcon||sf.base.isNullOrUndefined(i.fieldItem.showSortIcon))&&(this.parent instanceof ft||this.parent.groupingBarSettings.showSortIcon)&&this.parent.dataSourceSettings.enableSorting&&("olap"!==this.parent.dataType||!("pivotfieldlist"===this.parent.getModuleName()&&void 0!==this.parent.pivotGridModule&&this.parent.pivotGridModule.enableVirtualization||"pivotview"===this.parent.getModuleName()&&this.parent.enableVirtualization))){("pivotview"===this.parent.getModuleName()&&this.parent.enableValueSorting||"pivotfieldlist"===this.parent.getModuleName()&&void 0!==this.parent.pivotGridModule&&this.parent.pivotGridModule.enableValueSorting)&&(this.parent.enableValueSorting||this.parent.pivotGridModule.enableValueSorting)&&(e.target.classList.contains("e-pivot-button")?"rows"===e.target.parentElement.getAttribute("data-tag").split(":")[0]&&this.parent.setProperties({dataSourceSettings:{valueSortSettings:{headerText:""}}},!0):"rows"===e.target.parentElement.parentElement.getAttribute("data-tag").split(":")[0]&&this.parent.setProperties({dataSourceSettings:{valueSortSettings:{headerText:""}}},!0)),this.parent.pivotCommon.eventBase.updateSorting(e),this.parent.allowDeferLayoutUpdate&&"pivotfieldlist"===this.parent.getModuleName()||this.updateDataSource(!0);this.parent instanceof ft&&this.axisField.render()}},e.prototype.updateDataSource=function(e){this.parent.allowDeferLayoutUpdate&&"pivotview"!==this.parent.getModuleName()?"pivotfieldlist"===this.parent.getModuleName()&&"Popup"===this.parent.renderMode?("olap"===this.parent.dataType?this.parent.pivotGridModule.olapEngineModule=this.parent.olapEngineModule:this.parent.pivotGridModule.engineModule=this.parent.engineModule,this.parent.pivotGridModule.notify(d,this),this.parent.pivotGridModule.setProperties({dataSourceSettings:this.parent.dataSourceSettings.properties},!0)):this.parent.triggerPopulateEvent():this.parent.updateDataSource(e)},e.prototype.updateFiltering=function(e){var t=this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent;"pivotfieldlist"===t.getModuleName()?sf.popups.showSpinner(t.fieldListSpinnerElement):t.showWaitingPopup(),t.mouseEventArgs=e,t.filterTargetID="pivotfieldlist"!==this.parent.pivotCommon.moduleName?this.parent.element:document.getElementById(this.parent.pivotCommon.parentID+"_Wrapper");var i=e.target.parentElement.id;if(t&&t.enableVirtualization&&sf.base.isBlazor()&&"pivot"===t.dataType){var a=this;t.interopAdaptor.invokeMethodAsync("PivotInteropMethod","fetchFieldMembers",i).then((function(e){for(var t=JSON.parse(e.dateMembers),s=[],r={},n={},o=0;o<t.length;o++)s.push({formattedText:t[o].FormattedText,actualText:t[o].ActualText}),r[t[o].FormattedText]={},n[t[o].ActualText]={};a.parent.engineModule.fieldList[i].dateMember=s,a.parent.engineModule.fieldList[i].formattedMembers=r,a.parent.engineModule.fieldList[i].members=n,a.updateFilterEvents()}))}else"Server"===t.dataSourceSettings.mode?this.parent.engineModule.fieldList[i].members&&Object.keys(this.parent.engineModule.fieldList[i].members).length>0?this.updateFilterEvents():t.getEngine("fetchFieldMembers",null,null,null,null,null,i):this.updateFilterEvents()},e.prototype.updateFilterEvents=function(){var e=this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent;this.parent.pivotCommon.eventBase.updateFiltering(e.mouseEventArgs);var t=e.mouseEventArgs.target;this.fieldName=t.parentElement.id,this.parent.pivotCommon.filterDialog.dialogPopUp&&(this.dialogPopUp=this.parent.pivotCommon.filterDialog.dialogPopUp,this.parent.pivotCommon.filterDialog.dialogPopUp.close=this.removeFilterDialog.bind(this),this.bindDialogEvents()),"pivotfieldlist"===e.getModuleName()?sf.popups.hideSpinner(e.fieldListSpinnerElement):e.hideWaitingPopup()},e.prototype.bindDialogEvents=function(){this.parent.pivotCommon.filterDialog.allowExcelLikeFilter&&this.parent.pivotCommon.filterDialog.tabObj?(this.index=this.parent.pivotCommon.filterDialog.tabObj.selectedItem,this.updateDialogButtonEvents(),this.dialogPopUp.buttons=this.buttonModel(),this.dialogPopUp.dataBind(),this.parent.pivotCommon.filterDialog.tabObj.selected=this.tabSelect.bind(this)):this.parent.dataSourceSettings.allowMemberFilter&&(this.index=0,this.updateDialogButtonEvents())},e.prototype.buttonModel=function(){return[{buttonModel:{cssClass:"e-clear-filter-button"+(this.parent.pivotCommon.filterDialog.allowExcelLikeFilter?"":" e-disable"),iconCss:"e-icons e-clear-filter-icon",enableRtl:this.parent.enableRtl,content:this.parent.localeObj.getConstant("clearFilter"),disabled:!this.parent.pivotCommon.filterDialog.filterObject},click:this.ClearFilter.bind(this)},{buttonModel:{cssClass:"e-ok-btn",content:this.parent.localeObj.getConstant("ok"),isPrimary:!0},click:0===this.index?this.updateFilterState.bind(this,this.fieldName):this.updateCustomFilter.bind(this)},{click:this.parent.pivotCommon.filterDialog.closeFilterDialog.bind(this),buttonModel:{cssClass:"e-cancel-btn",content:this.parent.localeObj.getConstant("cancel")}}]},e.prototype.tabSelect=function(e){this.index=e.selectedIndex,this.updateDialogButtonEvents(),sf.base.removeClass([].slice.call(this.dialogPopUp.element.querySelectorAll(".e-selected-tab")),"e-selected-tab"),e.selectedIndex>0&&sf.base.addClass([this.dialogPopUp.element.querySelector(".e-filter-div-content."+(1===e.selectedIndex&&this.parent.dataSourceSettings.allowLabelFilter?"e-label-filter":"e-value-filter"))],"e-selected-tab"),0===e.selectedIndex?this.parent.pivotCommon.filterDialog.updateCheckedState():(this.dialogPopUp.buttons[0].buttonModel.disabled=!1,this.dialogPopUp.element.querySelector(".e-ok-btn").removeAttribute("disabled"))},e.prototype.updateDialogButtonEvents=function(){this.dialogPopUp.buttons=this.buttonModel(),this.dialogPopUp.dataBind()},e.prototype.updateCustomFilter=function(e){var t,i=this,a=this.dialogPopUp.element.querySelector(".e-selected-tab"),s=a.getAttribute("data-fieldname"),n=a.getAttribute("data-selectedField"),o=a.getAttribute("data-type"),l=a.getAttribute("data-measure"),d=a.getAttribute("data-operator"),p=a.getAttribute("data-value1"),h=a.getAttribute("data-value2"),u="value"===o?"Value":"date"===o?"Date":"number"===o?"Number":"Label",c={name:s,type:u,measure:l,condition:d,value1:"date"!==o||sf.base.isBlazor()?p:new Date(p),value2:"date"!==o||sf.base.isBlazor()?h:new Date(h)};if("olap"===this.parent.dataType){c.selectedField=n,this.removeDataSourceSettings(s,n,u);for(var g=0,f=this.parent.dataSourceSettings.filterSettings;g<f.length;g++){var m=f[g];m.name===s&&m.selectedField===n&&(t=m)}}else t=r.getFilterItemByName(s,this.parent.dataSourceSettings.filterSettings);if(sf.base.isNullOrUndefined(p)||""===p||["Between","NotBetween"].indexOf(d)>-1&&(sf.base.isNullOrUndefined(h)||""===h)){var v=u.toLowerCase()+(sf.base.isNullOrUndefined(p)||""===p?"_input_option_1":"_input_option_2"),b=sf.base.select("#"+this.parent.element.id+"_"+v,a);return sf.base.addClass([b],"e-empty-field"),void b.focus()}var S={cancel:!1,filterSettings:c,dataSourceSettings:r.getClonedDataSourceSettings(this.parent.dataSourceSettings)};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger("memberFiltering",S,(function(e){e.cancel||(c=e.filterSettings,t?((t=t.properties?t.properties:t).type=c.type,t.measure=c.measure,t.condition=c.condition,t.value1=c.value1,t.value2=c.value2,"olap"===i.parent.dataType&&(t.selectedField=c.selectedField)):i.parent.dataSourceSettings.filterSettings.push(c)),"Value"!==u&&(i.parent.lastFilterInfo=r.getFilterItemByName(s,i.parent.dataSourceSettings.filterSettings)),i.dialogPopUp.close(),e.cancel||(i.refreshPivotButtonState(s,!0),i.updateDataSource(!0))}))},e.prototype.removeFilterDialog=function(){this.dialogPopUp&&!this.dialogPopUp.isDestroyed&&(this.dialogPopUp.destroy(),setTimeout(this.setFocus.bind(this))),document.getElementById(this.parentElement.id+"_EditorTreeView")&&sf.base.remove(document.getElementById(this.parentElement.id+"_EditorTreeView"))},e.prototype.setFocus=function(){if(this.parentElement)for(var e=0,t=[].slice.call(this.parentElement.querySelectorAll(".e-pivot-button"));e<t.length;e++){var i=t[e];if(i.getAttribute("data-uid")===this.fieldName){i.focus();break}}},e.prototype.ClearFilter=function(e){var t=this.dialogPopUp.element,i=t.getAttribute("data-fieldname"),a=t.querySelector(".e-selected-tab");if(this.dialogPopUp.close(),"olap"===this.parent.dataType&&a){var s=a.getAttribute("data-selectedField");this.removeDataSourceSettings(i,s)}else this.removeDataSourceSettings(i);var n=r.getFilterItemByName(i,this.parent.dataSourceSettings.filterSettings);this.refreshPivotButtonState(i,!!n),this.updateDataSource(!0)},e.prototype.removeButton=function(e){var t=this,i=e.target,a=i.parentElement.id,s=r.getFieldInfo(a,this.parent),n={cancel:!1,fieldName:a,dataSourceSettings:r.getClonedDataSourceSettings(this.parent.dataSourceSettings),fieldItem:s.fieldItem,axis:s.axis};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger("fieldRemove",n,(function(e){e.cancel||("true"===i.parentElement.getAttribute("isvalue")?(t.parent.setProperties({dataSourceSettings:{values:[]}},!0),"olap"===t.parent.dataType&&t.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport("[measures]")):(t.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport(a),"olap"===t.parent.dataType&&0===t.parent.dataSourceSettings.values.length&&t.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport("[measures]")),"pivotfieldlist"===t.parent.getModuleName()&&t.parent.axisFieldModule.render(),t.updateDataSource())}))},e.prototype.nodeStateModified=function(e){var t=sf.base.closest(e.node,"li"),i=t.getAttribute("data-fieldname");if("all"===t.getAttribute("data-uid"))this.memberTreeView.nodeChecked=null,"check"===e.action?this.memberTreeView.checkAll():this.memberTreeView.uncheckAll(),"olap"===this.parent.dataType&&this.parent.olapEngineModule&&!this.parent.olapEngineModule.fieldList[i].isHierarchy&&this.updateNodeStates(this.memberTreeView.getAllCheckedNodes(),i,e.action),this.checkedStateAll(e.action),this.memberTreeView.nodeChecked=this.nodeStateModified.bind(this);else{if("olap"===this.parent.dataType&&this.parent.olapEngineModule&&!this.parent.olapEngineModule.fieldList[i].isHierarchy){var a=this.memberTreeView.getAllCheckedNodes();this.updateNodeStates(a,i,e.action)}var s=this.parent.pivotCommon.currentTreeItemsPos[t.getAttribute("data-uid")].index;this.parent.pivotCommon.currentTreeItems[s]&&(this.parent.pivotCommon.currentTreeItems[s].isSelected="check"===e.action,this.parent.pivotCommon.currentTreeItemsPos[t.getAttribute("data-uid")].isSelected="check"===e.action)}this.parent.pivotCommon.filterDialog.updateCheckedState()},e.prototype.checkedStateAll=function(e){for(var t={},i=0,a=this.parent.pivotCommon.searchTreeItems;i<a.length;i++){(n=a[i]).isSelected="check"===e,t[n.id]=n.id}for(var s=0,r=this.parent.pivotCommon.currentTreeItems;s<r.length;s++){var n;void 0!==t[(n=r[s]).id]&&(n.isSelected="check"===e,this.parent.pivotCommon.currentTreeItemsPos[n.id].isSelected="check"===e)}},e.prototype.updateNodeStates=function(e,t,i){var a=this.parent.pivotCommon.engineModule.fieldList[t],s=a.members,r=a.currrentMembers;if(a.searchMembers.length>0){for(var n=0,o=Object.keys(r);n<o.length;n++){if(r[c=o[n]]&&(r[c].isSelected=!1),s[c])if(s[c].isSelected=!1,this.memberTreeView.element.querySelector('li[data-uid="'+c+'"]'))(p=this.memberTreeView.element.querySelector('li[data-uid="'+c+'"]'))&&!p.querySelector("ul")&&this.parent.pivotCommon.eventBase.updateChildNodeStates(a.filterMembers,t,c,!1)}for(var l=0,d=e;l<d.length;l++){var p;if(s[m=d[l]])if(this.memberTreeView.element.querySelector('li[data-uid="'+m+'"]'))(p=this.memberTreeView.element.querySelector('li[data-uid="'+m+'"]'))&&!p.querySelector("ul")&&(s[m].isSelected=!0,this.parent.pivotCommon.eventBase.updateChildNodeStates(a.filterMembers,t,m,!0));r[m]&&(r[m].isSelected=!0)}}else{for(var h=0,u=Object.keys(s);h<u.length;h++){var c;s[c=u[h]].isSelected&&(s[c].isSelected=!1)}for(var g=0,f=e;g<f.length;g++){var m;s[m=f[g]]&&(s[m].isSelected=!0,this.parent.pivotCommon.eventBase.updateChildNodeStates(a.filterMembers,t,m,!0))}}},e.prototype.updateFilterState=function(e,t){var i=this,a=!1,s={items:[],name:e,type:"Include"},n=this.parent.olapEngineModule;if("olap"===this.parent.dataType&&n&&!n.fieldList[e].isHierarchy){var o=n.fieldList[e].members,l=n.fieldList[e].currrentMembers;if(s.items=this.memberTreeView.getAllCheckedNodes(),s.levelCount=n.fieldList[e].levelCount,a=s.items.length!==this.memberTreeView.fields.dataSource.length,n.fieldList[e].searchMembers.length>0&&!a){var d=Object.keys(o).length,p=Object.keys(l).length;a=d!==p||d!==s.items.length}for(var h=0,u=s.items;h<u.length;h++){var c=u[h];n.fieldList[e].searchMembers.length>0&&l[c]?l[c].isSelected=!0:o[c]&&(o[c].isSelected=!0)}}else{for(var g=0,f=this.parent.pivotCommon.searchTreeItems;g<f.length;g++){var m=f[g];m.isSelected&&(this.parent.pivotCommon.isDateField?s.items.push(m.name):s.items.push(m.id))}a=s.items.length!==this.parent.pivotCommon.currentTreeItems.length}"olap"===this.parent.dataType&&this.removeDataSourceSettings(e);var v={filterSettings:s,dataSourceSettings:r.getClonedDataSourceSettings(this.parent.dataSourceSettings),cancel:!1};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger("memberFiltering",v,(function(t){if(s=t.filterSettings,!t.cancel){if(r.getFilterItemByName(e,i.parent.dataSourceSettings.filterSettings))for(var n=0;n<i.parent.dataSourceSettings.filterSettings.length;n++)if(i.parent.dataSourceSettings.filterSettings[n].name===e){i.parent.dataSourceSettings.filterSettings.splice(n,1);break}i.parent.dataSourceSettings.filterSettings.push(s)}if(i.dialogPopUp.close(),!t.cancel){i.refreshPivotButtonState(e,a),a||i.removeDataSourceSettings(e),i.parent.lastFilterInfo=s,i.updateDataSource(!0);var o=i;o.parent instanceof ft&&o.axisField.render()}for(var l=0,d=[].slice.call(i.parentElement.querySelectorAll(".e-pivot-button"));l<d.length;l++){var p=d[l];if(p.getAttribute("data-uid")===e){p.focus();break}}}))},e.prototype.refreshPivotButtonState=function(e,t){for(var i,a=0,s=[].slice.call(this.parentElement.querySelectorAll(".e-pivot-button"));a<s.length;a++){var r=s[a];if(r.getAttribute("data-uid")===e){i=r.querySelector(".e-btn-filter");break}}t?(sf.base.removeClass([i],"e-pv-filter"),sf.base.addClass([i],"e-pv-filtered")):(sf.base.removeClass([i],"e-pv-filtered"),sf.base.addClass([i],"e-pv-filter"))},e.prototype.removeDataSourceSettings=function(e,t,i){for(var a=this.parent.dataSourceSettings.filterSettings,s=0,r=a.length;s<r;s++)if("olap"===this.parent.dataType&&t){if(!i&&a[s].name===e&&a[s].selectedField===t){a.splice(s,1);break}i&&a[s].type!==i&&a[s].name===e&&(a.splice(s,1),r--,s--)}else if(a[s].name===e){if(a.splice(s,1),"olap"!==this.parent.dataType)break;r--,s--}},e.prototype.updateDropIndicator=function(e){if(this.parent.isDragging){sf.base.removeClass([].slice.call(this.parentElement.querySelectorAll(".e-drop-indicator-last")),"e-drop-hover"),sf.base.removeClass([].slice.call(this.parentElement.querySelectorAll(".e-drop-indicator")),"e-drop-hover");var t=sf.base.closest(e.target,".e-pvt-btn-div");sf.base.addClass([t.querySelector(".e-drop-indicator")],"e-drop-hover")}},e.prototype.wireEvent=function(e,t,i){sf.base.EventHandler.add(e,"mouseover",this.updateDropIndicator,this),i||(-1===["filters","values"].indexOf(t)&&null!==e.querySelector(".e-pivot-button")&&sf.base.EventHandler.add(e.querySelector(".e-pivot-button"),"click",this.updateSorting,this),"values"!==t&&null!==e.querySelector(".e-btn-filter")&&sf.base.EventHandler.add(e.querySelector(".e-btn-filter"),"click",this.updateFiltering,this),"values"===t&&null!==e.querySelector(".e-dropdown-icon")&&sf.base.EventHandler.add(e.querySelector(".e-dropdown-icon"),"click",this.createMenuOption,this)),null!==e.querySelector(".e-edit")&&sf.base.EventHandler.add(e.querySelector(".e-edit"),"click",this.openCalculatedFieldDialog,this),sf.base.EventHandler.add(e.querySelector(".e-remove"),"click",this.removeButton,this)},e.prototype.unWireEvent=function(e,t,i){sf.base.EventHandler.remove(e,"mouseover",this.updateDropIndicator),i||(-1===["filters","values"].indexOf(t)&&null!==e.querySelector(".e-pivot-button")&&sf.base.EventHandler.remove(e.querySelector(".e-pivot-button"),"click",this.updateSorting),"values"!==t&&null!==e.querySelector(".e-btn-filter")&&sf.base.EventHandler.remove(e.querySelector(".e-btn-filter"),"click",this.updateFiltering),"values"===t&&null!==e.querySelector(".e-dropdown-icon")&&sf.base.EventHandler.remove(e.querySelector(".e-dropdown-icon"),"click",this.createMenuOption)),null!==e.querySelector(".e-edit")&&sf.base.EventHandler.remove(e.querySelector(".e-edit"),"click",this.openCalculatedFieldDialog),sf.base.EventHandler.remove(e.querySelector(".e-remove"),"click",this.removeButton)},e.prototype.addEventListener=function(){this.handlers={load:this.renderPivotButton},this.parent.isDestroyed||this.parent.on("pivot-button-update",this.handlers.load,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off("pivot-button-update",this.handlers.load)},e.prototype.destroy=function(){this.menuOption&&this.menuOption.destroy(),this.removeEventListener(),this.isDestroyed=!0},e}(),ht=function(){function e(e){this.parent=e}return e.prototype.render=function(){!this.parent.pivotButtonModule||this.parent.pivotButtonModule&&this.parent.pivotButtonModule.isDestroyed?new pt(this.parent):this.parent.pivotButtonModule;this.createPivotButtons()},e.prototype.createPivotButtons=function(){sf.base.isNullOrUndefined(this.parent.dataSourceSettings.dataSource)&&sf.base.isNullOrUndefined(this.parent.dataSourceSettings.url)&&this.parent.setProperties({dataSourceSettings:{columns:[],rows:[],values:[],filters:[]}},!0);var e=[this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.values,this.parent.dataSourceSettings.filters],t=this.parent.dialogRenderer.parentElement;t.querySelector(".e-field-list-filters")&&(t.querySelector(".e-field-list-filters").querySelector(".e-axis-content").innerHTML=""),t.querySelector(".e-field-list-rows")&&(t.querySelector(".e-field-list-rows").querySelector(".e-axis-content").innerHTML=""),t.querySelector(".e-field-list-columns")&&(t.querySelector(".e-field-list-columns").querySelector(".e-axis-content").innerHTML=""),t.querySelector(".e-field-list-values")&&(t.querySelector(".e-field-list-values").querySelector(".e-axis-content").innerHTML="");for(var i=["rows","columns","values","filters"],a=0,s=e.length;a<s;a++)if(e[a]){var r={field:e[a],axis:i[a].toString()};this.parent.notify("pivot-button-update",r)}},e}(),ut=function(){function e(e){this.parent=e,this.parent.dialogRenderer=new ot(this.parent),this.parent.treeViewModule=new lt(this.parent),this.parent.axisTableModule=new dt(this.parent),this.parent.axisFieldModule=new ht(this.parent)}return e.prototype.render=function(){this.parent.dialogRenderer.render(),this.parent.isAdaptive||this.parent.treeViewModule.render(),this.parent.axisTableModule.render()},e}(),ct=(fe=function(e,t){return(fe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}fe(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),gt=function(e,t,i,s){var r,n=arguments.length,o=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"===("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,s);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(n<3?r(o):n>3?r(t,i,o):r(t,i))||o);return n>3&&o&&Object.defineProperty(t,i,o),o},ft=function(e){function t(t,i){var a=e.call(this,t,i)||this;return a.pivotChange=!1,a.isRequiredUpdate=!0,a.lastSortInfo={},a.lastFilterInfo={},a.lastAggregationInfo={},a.lastCalcFieldInfo={},a.isPopupView=!1,a.enableValueSorting=!1,a.request=new XMLHttpRequest,a.remoteData=[],a}return ct(t,e),t.prototype.requiredModules=function(){var e=[];return this.allowCalculatedField&&e.push({args:[this],member:"calculatedfield"}),e},t.prototype.getAllSummaryType=function(){return["Sum","Count","DistinctCount","Product","Min","Max","Avg","Median","Index","PopulationVar","SampleVar","PopulationStDev","SampleStDev","RunningTotals","PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal","PercentageOfParentColumnTotal","PercentageOfParentRowTotal","DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentTotal"]},t.prototype.preRender=function(){this.dataSourceSettings&&"SSAS"===this.dataSourceSettings.providerType?(this.olapEngineModule=new Ze,this.dataType="olap"):(this.engineModule=new o,this.dataType="pivot"),this.isAdaptive=sf.base.Browser.isDevice,this.globalize=new sf.base.Internationalization(this.locale),this.renderModule=new ut(this),this.defaultLocale={staticFieldList:"Pivot Field List",fieldList:"Field List",dropFilterPrompt:"Drop filter here",dropColPrompt:"Drop column here",dropRowPrompt:"Drop row here",dropValPrompt:"Drop value here",addPrompt:"Add field here",adaptiveFieldHeader:"Choose field",centerHeader:"Drag fields between axes below:",add:"add",drag:"Drag",filter:"Filter",filtered:"Filtered",sort:"Sort",remove:"Remove",filters:"Filters",rows:"Rows",columns:"Columns",values:"Values",CalculatedField:"Calculated Field",createCalculatedField:"Create Calculated Field",fieldName:"Enter the field name",error:"Error",invalidFormula:"Invalid formula.",dropText:'Example: ("Sum(Order_Count)" + "Sum(In_Stock)") * 250',dropTextMobile:"Add fields and edit formula here.",dropAction:"Calculated field cannot be place in any other region except value axis.",search:"Search",close:"Close",cancel:"Cancel",delete:"Delete",alert:"Alert",warning:"Warning",ok:"OK",allFields:"All Fields",formula:"Formula",fieldExist:"A field already exists in this name. Please enter a different name.",confirmText:"A calculation field already exists in this name. Do you want to replace it?",noMatches:"No matches",format:"Summaries values by",edit:"Edit",clear:"Clear",clearCalculatedField:"Clear edited field info",editCalculatedField:"Edit calculated field",sortAscending:"Sort ascending order",sortDescending:"Sort descending order",sortNone:"Sort data order",formulaField:"Drag and drop fields to formula",dragField:"Drag field to formula",clearFilter:"Clear",by:"by",enterValue:"Enter value",chooseDate:"Enter date",all:"All",multipleItems:"Multiple items",Equals:"Equals",DoesNotEquals:"Does Not Equal",BeginWith:"Begins With",DoesNotBeginWith:"Does Not Begin With",EndsWith:"Ends With",DoesNotEndsWith:"Does Not End With",Contains:"Contains",DoesNotContains:"Does Not Contain",GreaterThan:"Greater Than",GreaterThanOrEqualTo:"Greater Than Or Equal To",LessThan:"Less Than",LessThanOrEqualTo:"Less Than Or Equal To",Between:"Between",NotBetween:"Not Between",Before:"Before",BeforeOrEqualTo:"Before Or Equal To",After:"After",AfterOrEqualTo:"After Or Equal To",member:"Member",label:"Label",date:"Date",value:"Value",labelTextContent:"Show the items for which the label",dateTextContent:"Show the items for which the date",valueTextContent:"Show the items for which",And:"and",Sum:"Sum",Count:"Count",DistinctCount:"Distinct Count",Product:"Product",Avg:"Avg",Median:"Median",Min:"Min",Max:"Max",Index:"Index",SampleStDev:"Sample StDev",PopulationStDev:"Population StDev",SampleVar:"Sample Var",PopulationVar:"Population Var",RunningTotals:"Running Totals",DifferenceFrom:"Difference From",PercentageOfDifferenceFrom:"% of Difference From",PercentageOfGrandTotal:"% of Grand Total",PercentageOfColumnTotal:"% of Column Total",PercentageOfRowTotal:"% of Row Total",PercentageOfParentTotal:"% of Parent Total",PercentageOfParentColumnTotal:"% of Parent Column Total",PercentageOfParentRowTotal:"% of Parent Row Total",MoreOption:"More...",Years:"Years",Quarters:"Quarters",Months:"Months",Days:"Days",Hours:"Hours",Minutes:"Minutes",Seconds:"Seconds",apply:"Apply",valueFieldSettings:"Value field settings",sourceName:"Field name :",sourceCaption:"Field caption",summarizeValuesBy:"Summarize values by",baseField:"Base field",baseItem:"Base item",example:"e.g:",editorDataLimitMsg:" more items. Search to refine further.",deferLayoutUpdate:"Defer Layout Update",null:"null",undefined:"undefined",groupOutOfRange:"Out of Range",fieldDropErrorAction:"The field you are moving cannot be placed in that area of the report",memberType:"Field Type",selectedHierarchy:"Parent Hierarchy",formatString:"Format",expressionField:"Expression",olapDropText:"Example: [Measures].[Order Quantity] + ([Measures].[Order Quantity] * 0.10)",customFormat:"Enter custom format string",numberFormatString:"Example: C, P, 0000 %, ###0.##0#, etc.",Measure:"Measure",Dimension:"Dimension",Standard:"Standard",Currency:"Currency",Percent:"Percent",Custom:"Custom",blank:"(Blank)",fieldTooltip:'Drag and drop fields to create an expression. And, if you want to edit the existing calculated fields! You can achieve it by simply selecting the field under "Calculated Members".',fieldTitle:"Field Name",QuarterYear:"Quarter Year",caption:"Field Caption",copy:"Copy",of:"of",group:"Group",removeCalculatedField:"Are you sure you want to delete this calculated field?",yes:"Yes",no:"No"},this.localeObj=new sf.base.L10n(this.getModuleName(),this.defaultLocale,this.locale),this.isDragging=!1,this.captionData=[],this.wireEvent()},t.prototype.frameCustomProperties=function(e,t){this.pivotGridModule&&this.pivotGridModule.updatePageSettings(!1);var i=this.pivotGridModule?this.pivotGridModule.pageSettings:this.pageSettings,a=this.pivotGridModule?this.pivotGridModule.localeObj:this.staticPivotGridModule?this.staticPivotGridModule.localeObj:this.localeObj,s=!this.pivotGridModule||(this.pivotGridModule.allowDrillThrough||this.pivotGridModule.editSettings.allowEditing),r=this.pivotGridModule?this.pivotGridModule.enableValueSorting:void 0;return"olap"===this.dataType?{mode:"",savedFieldList:t||void 0,savedFieldListData:e||void 0,pageSettings:i,enableValueSorting:r,isDrillThrough:s,localeObj:a}:{mode:"",savedFieldList:void 0,pageSettings:i,enableValueSorting:r,isDrillThrough:s,localeObj:a,clonedReport:this.clonedReport}},t.prototype.render=function(){"pivot"===this.dataType&&this.dataSourceSettings.url&&""!==this.dataSourceSettings.url?"Server"===this.dataSourceSettings.mode?(this.guid=r.generateUUID(),this.getEngine("initialRender",null,null,null,null,null,null)):(this.request.open("GET",this.dataSourceSettings.url,!0),this.request.withCredentials=!1,this.request.onreadystatechange=this.onReadyStateChange.bind(this),this.request.setRequestHeader("Content-type","text/plain"),this.request.send(null)):this.initialLoad()},t.prototype.getEngine=function(e,t,i,a,s,n,o,l,d){var p=this;this.currentAction=e,this.pivotGridModule&&this.pivotGridModule.updatePageSettings(!1);var h={pageSettings:this.pivotGridModule?this.pivotGridModule.pageSettings:void 0,enableValueSorting:this.pivotGridModule?this.pivotGridModule.enableValueSorting:void 0,enableDrillThrough:!this.pivotGridModule||(this.pivotGridModule.allowDrillThrough||this.pivotGridModule.editSettings.allowEditing),locale:JSON.stringify(r.getLocalizedObject(this))};this.request.open("POST",this.dataSourceSettings.url,!0);var u={request:this.request,dataSourceSettings:JSON.parse(this.getPersistData()).dataSourceSettings,action:e,customProperties:{},internalProperties:h,drillItem:t,sortItem:i,aggregatedItem:a,calculatedItem:s,filterItem:n,memberName:o,fetchRawDataArgs:l,editArgs:d,hash:this.guid};this.trigger("beforeServiceInvoke",u,(function(e){p.request=e.request,u.internalProperties=e.internalProperties,u.customProperties=e.customProperties,u.dataSourceSettings=e.dataSourceSettings,u.calculatedItem=e.calculatedItem,u.drillItem=e.drillItem,u.editArgs=e.editArgs,u.fetchRawDataArgs=e.fetchRawDataArgs,u.filterItem=e.filterItem,u.hash=e.hash,u.memberName=e.memberName,u.sortItem=e.sortItem})),this.request.withCredentials=!1,this.request.onreadystatechange=this.onSuccess.bind(this),this.request.setRequestHeader("Content-type","application/json"),this.request.send(JSON.stringify(u))},t.prototype.onSuccess=function(){if(this.request.readyState===XMLHttpRequest.DONE){try{var e=JSON.parse(this.request.responseText);if("fetchFieldMembers"===this.currentAction){for(var t=JSON.parse(e.members),i=[],a={},s={},n=0;n<t.length;n++)i.push({formattedText:t[n].FormattedText,actualText:t[n].ActualText}),a[t[n].FormattedText]={},s[t[n].ActualText]={};this.engineModule.fieldList[e.memberName].dateMember=i,this.engineModule.fieldList[e.memberName].formattedMembers=a,this.engineModule.fieldList[e.memberName].members=s,this.pivotButtonModule.updateFilterEvents()}else{var o=r.formatFieldList(JSON.parse(e.fieldList));if(this.engineModule.fieldList){var l=Object.keys(this.engineModule.fieldList);for(n=0;n<l.length;n++)this.engineModule.fieldList[l[n]]&&o[l[n]]&&(o[l[n]].dateMember=this.engineModule.fieldList[l[n]].dateMember,o[l[n]].formattedMembers=this.engineModule.fieldList[l[n]].formattedMembers,o[l[n]].members=this.engineModule.fieldList[l[n]].members)}this.engineModule.fieldList=o,this.engineModule.fields=JSON.parse(e.fields),this.engineModule.rowCount=JSON.parse(e.pivotCount).RowCount,this.engineModule.columnCount=JSON.parse(e.pivotCount).ColumnCount,this.engineModule.rowStartPos=JSON.parse(e.pivotCount).RowStartPosition,this.engineModule.colStartPos=JSON.parse(e.pivotCount).ColumnStartPosition,this.engineModule.rowFirstLvl=JSON.parse(e.pivotCount).RowFirstLevel,this.engineModule.colFirstLvl=JSON.parse(e.pivotCount).ColumnFirstLevel;for(var d=void 0,p=r.formatPivotValues(JSON.parse(e.pivotValue)),h=0;h<p.length;h++)if(p[h]&&p[h][0]&&"row"===p[h][0].axis){d=h;break}this.engineModule.headerContent=r.frameContent(p,"header",d,this),this.engineModule.pageSettings=this.pivotGridModule?this.pivotGridModule.pageSettings:void 0;var u=JSON.parse(e.valueSortSettings);this.engineModule.valueSortSettings={headerText:u.HeaderText,headerDelimiter:u.HeaderDelimiter,sortOrder:u.SortOrder,columnIndex:u.ColumnIndex},this.engineModule.pivotValues=p}}catch(e){this.engineModule.pivotValues=[]}"fetchFieldMembers"!==this.currentAction&&(this.initEngine(),this.calculatedFieldModule&&this.calculatedFieldModule.isRequireUpdate&&(this.calculatedFieldModule.endDialog(),this.calculatedFieldModule.isRequireUpdate=!1),this.pivotGridModule&&this.pivotGridModule.calculatedFieldModule&&this.pivotGridModule.calculatedFieldModule.isRequireUpdate&&(this.pivotGridModule.calculatedFieldModule.endDialog(),this.pivotGridModule.calculatedFieldModule.isRequireUpdate=!1))}},t.prototype.onReadyStateChange=function(){if(this.request.readyState===XMLHttpRequest.DONE){var e=[];if("CSV"===this.dataSourceSettings.type)for(var t=this.request.responseText.split(/\r?\n|\r/),i=0;i<t.length;i++)sf.base.isNullOrUndefined(t[i])||""===t[i]||e.push(t[i].split(","));else try{e=JSON.parse(this.request.responseText)}catch(t){e=[]}sf.base.isBlazor()&&e.length>0?this.remoteData=e:e.length>0&&this.setProperties({dataSourceSettings:{dataSource:e}},!0),this.initialLoad()}},t.prototype.initialLoad=function(){var e=this;this.trigger("load",{dataSourceSettings:sf.base.isBlazor()?r.getClonedDataSourceSettings(this.dataSourceSettings):this.dataSourceSettings},(function(t){sf.base.isBlazor()&&(t.dataSourceSettings.dataSource=e.dataSourceSettings.dataSource),e.dataSourceSettings=t.dataSourceSettings,sf.base.addClass([e.element],u),e.enableRtl?sf.base.addClass([e.element],c):sf.base.removeClass([e.element],c),e.isAdaptive?sf.base.addClass([e.element],g):sf.base.removeClass([e.element],g),e.cssClass&&sf.base.addClass([e.element],e.cssClass),e.notify(l,{})})),sf.base.isBlazor()&&this.renderComplete()},t.prototype.wireEvent=function(){this.on(l,this.generateData,this),this.on(h,this.fieldListRender,this)},t.prototype.unWireEvent=function(){this.pivotGridModule&&this.pivotGridModule.isDestroyed||(this.off(l,this.generateData),this.off(h,this.fieldListRender))},t.prototype.getPersistData=function(){return this.addOnPersist(["dataSourceSettings"])},t.prototype.getModuleName=function(){return"pivotfieldlist"},t.prototype.onPropertyChanged=function(t,i){for(var a=!1,s=0,n=Object.keys(t);s<n.length;s++){var o=n[s];switch(o){case"locale":if(sf.base.isBlazor())break;e.prototype.refresh.call(this);break;case"dataSourceSettings":if(sf.base.isNullOrUndefined(t.dataSourceSettings.dataSource)||(sf.base.isNullOrUndefined(this.savedDataSourceSettings)||(r.updateDataSourceSettings(this.staticPivotGridModule,this.savedDataSourceSettings),this.savedDataSourceSettings=void 0),0!==t.dataSourceSettings.dataSource.length||sf.base.isNullOrUndefined(this.staticPivotGridModule)||(this.savedDataSourceSettings=r.getClonedDataSourceSettings(this.staticPivotGridModule.dataSourceSettings),this.staticPivotGridModule.setProperties({dataSourceSettings:{rows:[]}},!0),this.staticPivotGridModule.setProperties({dataSourceSettings:{columns:[]}},!0),this.staticPivotGridModule.setProperties({dataSourceSettings:{values:[]}},!0),this.staticPivotGridModule.setProperties({dataSourceSettings:{filters:[]}},!0)),this.engineModule.fieldList=null,sf.base.isNullOrUndefined(this.staticPivotGridModule)||(this.staticPivotGridModule.pivotValues=[]),this.initEngine()),r.isButtonIconRefesh(o,i,t)){if(this.isPopupView&&this.pivotGridModule&&this.pivotGridModule.showGroupingBar&&this.pivotGridModule.groupingBarModule){var l=r.cloneFieldSettings(this.dataSourceSettings.filters),d=r.cloneFieldSettings(this.dataSourceSettings.values),p=r.cloneFieldSettings(this.dataSourceSettings.rows),h=r.cloneFieldSettings(this.dataSourceSettings.columns);this.pivotGridModule.setProperties({dataSourceSettings:{rows:p,columns:h,values:d,filters:l}},!0),this.pivotGridModule.axisFieldModule.render()}else if(!this.isPopupView&&this.staticPivotGridModule&&!this.staticPivotGridModule.isDestroyed){var u=this.staticPivotGridModule;if(u.showGroupingBar&&u.groupingBarModule&&u.axisFieldModule.render(),u.showFieldList&&u.pivotFieldListModule){p=r.cloneFieldSettings(u.dataSourceSettings.rows),h=r.cloneFieldSettings(u.dataSourceSettings.columns),d=r.cloneFieldSettings(u.dataSourceSettings.values),l=r.cloneFieldSettings(u.dataSourceSettings.filters);u.pivotFieldListModule.setProperties({dataSourceSettings:{rows:p,columns:h,values:d,filters:l}},!0),u.pivotFieldListModule.axisFieldModule.render(),u.pivotFieldListModule.treeViewModule.fieldTable&&!u.isAdaptive&&u.pivotFieldListModule.notify("tree-view-update",{})}}this.axisFieldModule.render(),this.treeViewModule.fieldTable&&!this.isAdaptive&&this.notify("tree-view-update",{})}break;case"aggregateTypes":this.axisFieldModule&&this.axisFieldModule.render(),this.pivotGridModule&&this.pivotGridModule.axisFieldModule&&(this.pivotGridModule.setProperties({aggregateTypes:t.aggregateTypes},!0),this.pivotGridModule.axisFieldModule.render());break;case"enableRtl":this.enableRtl?sf.base.addClass([this.element],c):sf.base.removeClass([this.element],c),a=!0}a&&this.fieldListRender()}},t.prototype.initEngine=function(){var e=this;if("pivot"===this.dataType){var t=sf.base.isNullOrUndefined(this.dataSourceSettings.dataSource)?sf.base.isNullOrUndefined(this.engineModule.data)?void 0:this.engineModule.data[0]:this.dataSourceSettings.dataSource[0];if(t&&this.pivotCommon){var i="[object Array]"==Object.prototype.toString.call(t);if(i&&"JSON"===this.dataSourceSettings.type)return void this.pivotCommon.errorDialog.createErrorDialog(this.localeObj.getConstant("error"),this.localeObj.getConstant("invalidJSON"));if(!i&&"CSV"===this.dataSourceSettings.type)return void this.pivotCommon.errorDialog.createErrorDialog(this.localeObj.getConstant("error"),this.localeObj.getConstant("invalidCSV"))}}var a={dataSourceSettings:r.getClonedDataSourceSettings(this.dataSourceSettings)},s=this.isPopupView?this.pivotGridModule:this;s.trigger("enginePopulating",a,(function(t){if(r.updateDataSourceSettings(e,t.dataSourceSettings),"pivot"===e.dataType){if(e.dataSourceSettings.groupSettings&&e.dataSourceSettings.groupSettings.length>0){var i=void 0;if(i=sf.base.isBlazor()?e.engineModule.data:e.dataSourceSettings.dataSource,e.clonedDataSet=e.clonedDataSet?e.clonedDataSet:r.getClonedData(i),sf.base.isBlazor())e.clonedReport=e.clonedReport?e.clonedReport:sf.base.extend({},e.dataSourceSettings,null,!0);else{var a=JSON.parse(e.getPersistData()).dataSourceSettings;a.dataSource=[],e.clonedReport=e.clonedReport?e.clonedReport:a}}var n=e.frameCustomProperties();n.enableValueSorting=e.staticPivotGridModule?e.staticPivotGridModule.enableValueSorting:e.enableValueSorting,"Server"!==e.dataSourceSettings.mode&&e.engineModule.renderEngine(e.dataSourceSettings,n,e.getValueCellInfo.bind(e)),e.pivotFieldList=e.engineModule.fieldList;var o={pivotFieldList:e.pivotFieldList,pivotValues:e.engineModule.pivotValues},l=e;s.trigger("enginePopulated",o,(function(t){l.pivotFieldList=t.pivotFieldList,l.engineModule.pivotValues=sf.base.isBlazor()?e.engineModule.pivotValues:t.pivotValues,l.notify(h,{}),l.trigger("dataBound")}))}else if("olap"===e.dataType){e.olapEngineModule.renderEngine(e.dataSourceSettings,e.frameCustomProperties(e.olapEngineModule.fieldListData,e.olapEngineModule.fieldList)),e.pivotFieldList=e.olapEngineModule.fieldList;o={pivotFieldList:e.pivotFieldList,pivotValues:e.olapEngineModule.pivotValues};var d=e;s.trigger("enginePopulated",o,(function(t){d.pivotFieldList=t.pivotFieldList,d.olapEngineModule.pivotValues=sf.base.isBlazor()?e.olapEngineModule.pivotValues:t.pivotValues,d.notify(h,{}),d.trigger("dataBound")}))}}))},t.prototype.generateData=function(){this.pivotFieldList={},this.dataSourceSettings&&(this.dataSourceSettings.dataSource||this.dataSourceSettings.url)?""!==this.dataSourceSettings.url&&"olap"===this.dataType||this.dataSourceSettings.dataSource.length>0?("pivot"===this.dataType&&(this.engineModule.data=this.dataSourceSettings.dataSource),this.initEngine()):this.dataSourceSettings.dataSource instanceof sf.data.DataManager&&("pivot"===this.dataType&&this.remoteData.length>0?(this.engineModule.data=this.remoteData,this.initEngine()):setTimeout(this.getData.bind(this),100)):sf.base.isBlazor()&&"pivot"===this.dataType&&this.engineModule.data&&this.engineModule.data.length>0?this.initEngine():(this.notify(h,{}),this.trigger("dataBound"))},t.prototype.getValueCellInfo=function(e){var t=e;return this.trigger("aggregateCellInfo",t),t},t.prototype.getData=function(){this.dataSourceSettings.dataSource.executeQuery(new sf.data.Query).then(this.executeQuery.bind(this))},t.prototype.executeQuery=function(e){this.engineModule.data=e.result,this.initEngine()},t.prototype.fieldListRender=function(){var e;this.element.innerHTML="","Popup"===this.renderMode&&this.dialogRenderer.fieldListDialog&&!this.dialogRenderer.fieldListDialog.isDestroyed&&(this.dialogRenderer.fieldListDialog.destroy(),sf.base.remove(document.getElementById(this.element.id+"_Wrapper"))),this.renderModule.render(),this.fieldListSpinnerElement="Popup"===this.renderMode?this.dialogRenderer.fieldListDialog.element:this.element.querySelector(".e-pivotfieldlist-wrapper"),this.spinnerTemplate?sf.popups.createSpinner({target:this.fieldListSpinnerElement,template:this.spinnerTemplate},this.createElement):sf.popups.createSpinner({target:this.fieldListSpinnerElement},this.createElement),e={pivotEngine:"olap"===this.dataType?this.olapEngineModule:this.engineModule,dataSourceSettings:this.dataSourceSettings,id:this.element.id,element:document.getElementById(this.element.id+"_Wrapper"),moduleName:this.getModuleName(),enableRtl:this.enableRtl,isAdaptive:this.isAdaptive,renderMode:this.renderMode,localeObj:this.localeObj,dataType:this.dataType},this.pivotCommon=new _(e),this.pivotCommon.control=this,this.allowDeferLayoutUpdate&&(this.clonedDataSource=sf.base.extend({},this.dataSourceSettings,null,!0),this.clonedFieldList=sf.base.extend({},this.pivotFieldList,null,!0))},t.prototype.getFieldCaption=function(e){if(this.getFields(e),this.captionData.length>0)for(var t=this.captionData.length,i="olap"===this.dataType?this.olapEngineModule:this.engineModule;t--;)if(this.captionData[t])for(var a=0,s=this.captionData[t];a<s.length;a++){var r=s[a];r&&i.fieldList[r.name]&&(r.caption?i.fieldList[r.name].caption=r.caption:i.fieldList[r.name].caption=r.name)}},t.prototype.getFields=function(e){this.captionData=[e.rows,e.columns,e.values,e.filters]},t.prototype.updateDataSource=function(e,t){var i=this;this.pivotGridModule&&this.pivotGridModule.showWaitingPopup(),sf.popups.showSpinner(this.fieldListSpinnerElement);var a=this,s=a.isPopupView?a.pivotGridModule:a,n=!1,o=a.pivotGridModule&&a.pivotGridModule.enableVirtualization?a.pivotGridModule.pageSettings:void 0,l=Object.keys(a.lastCalcFieldInfo).length>0,d=Object.keys(a.lastSortInfo).length>0,p=Object.keys(a.lastAggregationInfo).length>0,h=Object.keys(a.lastFilterInfo).length>0,u={dataSourceSettings:r.getClonedDataSourceSettings(a.dataSourceSettings)};s.trigger("enginePopulating",u,(function(u){if(o&&(d||h||p||l)||(r.updateDataSourceSettings(a,u.dataSourceSettings),r.updateDataSourceSettings(a.pivotGridModule,u.dataSourceSettings)),sf.base.isNullOrUndefined(t)){if("pivot"===a.dataType){var c=a.frameCustomProperties();if(d?(a.setProperties({dataSourceSettings:{valueSortSettings:{headerText:""}}},!0),c.enableValueSorting=!1):c.enableValueSorting=a.staticPivotGridModule?a.staticPivotGridModule.enableValueSorting:a.enableValueSorting,c.savedFieldList=a.pivotFieldList,o&&(d||h||p||l)){var g={};if(d&&(a.pivotGridModule.setProperties({dataSourceSettings:{valueSortSettings:{headerText:""}}},!0),sf.base.isBlazor()?g={key:"onSort",arg:a.lastSortInfo}:"Server"===s.dataSourceSettings.mode?s.getEngine("onSort",null,a.lastSortInfo,null,null,null,null):a.engineModule.onSort(a.lastSortInfo),a.lastSortInfo={}),h){if(sf.base.isBlazor()){var f=window.sfBlazor.copyWithoutCircularReferences([a.dataSourceSettings.filterSettings],a.dataSourceSettings.filterSettings);g={key:"onFilter",arg:{lastFilterInfo:a.lastFilterInfo,filterSettings:f}}}else"Server"===s.dataSourceSettings.mode?s.getEngine("onFilter",null,null,null,null,a.lastFilterInfo,null):a.engineModule.onFilter(a.lastFilterInfo,a.dataSourceSettings);a.lastFilterInfo={}}if(p&&(sf.base.isBlazor()?g={key:"onAggregation",arg:a.lastAggregationInfo}:"Server"===s.dataSourceSettings.mode?s.getEngine("onAggregation",null,null,a.lastAggregationInfo,null,null,null):a.engineModule.onAggregation(a.lastAggregationInfo),a.lastAggregationInfo={}),l&&(sf.base.isBlazor()?g={key:"onCalcOperation",arg:{lastCalcFieldInfo:a.lastCalcFieldInfo,values:a.dataSourceSettings.values,calculatedFieldSettings:a.dataSourceSettings.calculatedFieldSettings}}:"Server"===s.dataSourceSettings.mode?s.getEngine("onCalcOperation",null,null,null,a.lastCalcFieldInfo,null,null):a.engineModule.onCalcOperation(a.lastCalcFieldInfo),a.lastCalcFieldInfo={}),sf.base.isBlazor()){var m=window.sfBlazor.copyWithoutCircularReferences([g.arg],g.arg);a.pivotGridModule.interopAdaptor.invokeMethodAsync("PivotInteropMethod",g.key,m).then((function(t){0!==t?(a.pivotGridModule.updateBlazorData(t,a.pivotGridModule),a.getFieldCaption(a.dataSourceSettings),a.enginePopulatedEventMethod(a,e,n),a.calculatedFieldModule&&a.calculatedFieldModule.isRequireUpdate&&(a.calculatedFieldModule.endDialog(),a.calculatedFieldModule.isRequireUpdate=!1)):i.pivotCommon.errorDialog.createErrorDialog(i.localeObj.getConstant("error"),"CSV"===a.dataSourceSettings.type?i.localeObj.getConstant("invalidCSV"):i.localeObj.getConstant("invalidJSON"))}))}}else if(sf.base.isBlazor()&&o){f=window.sfBlazor.copyWithoutCircularReferences([a.dataSourceSettings.properties],a.dataSourceSettings.properties);a.pivotGridModule.interopAdaptor.invokeMethodAsync("PivotInteropMethod","renderEngine",{dataSourceSettings:f,customProperties:c}).then((function(t){0!==t?(a.pivotGridModule.updateBlazorData(t,a.pivotGridModule),a.getFieldCaption(a.dataSourceSettings),a.enginePopulatedEventMethod(a,e,n)):i.pivotCommon.errorDialog.createErrorDialog(i.localeObj.getConstant("error"),"CSV"===a.dataSourceSettings.type?i.localeObj.getConstant("invalidCSV"):i.localeObj.getConstant("invalidJSON"))}))}else"Server"===a.dataSourceSettings.mode?(d?s.getEngine("onSort",null,a.lastSortInfo,null,null,null,null):p?s.getEngine("onAggregation",null,null,a.lastAggregationInfo,null,null,null):l?s.getEngine("onCalcOperation",null,null,null,a.lastCalcFieldInfo,null,null):h?s.getEngine("onFilter",null,null,null,null,a.lastFilterInfo,null):s.getEngine("onDrop",null,null,null,null,null,null),a.lastSortInfo={},a.lastAggregationInfo={},a.lastCalcFieldInfo={},a.lastFilterInfo={}):a.engineModule.renderEngine(a.dataSourceSettings,c,a.getValueCellInfo.bind(a))}else n=a.updateOlapDataSource(a,d,l,n);sf.base.isBlazor()&&o||a.getFieldCaption(a.dataSourceSettings)}else a.axisFieldModule.render(),a.isRequiredUpdate=!1;sf.base.isBlazor()&&o||a.enginePopulatedEventMethod(a,e,n)}))},t.prototype.enginePopulatedEventMethod=function(e,t,i){var a=e.isPopupView?e.pivotGridModule:e,s={dataSourceSettings:e.dataSourceSettings,pivotFieldList:"pivot"===e.dataType?e.engineModule.fieldList:e.olapEngineModule.fieldList,pivotValues:"pivot"===e.dataType?e.engineModule.pivotValues:e.olapEngineModule.pivotValues};a.trigger("enginePopulated",s,(function(a){var s=e.dataSourceSettings.dataSource;sf.base.isBlazor()&&a.dataSourceSettings.dataSource instanceof Object&&(a.dataSourceSettings.dataSource=s),e.dataSourceSettings=a.dataSourceSettings,e.pivotCommon.dataSourceSettings=e.dataSourceSettings,e.pivotFieldList=a.pivotFieldList,"olap"===e.dataType?(e.olapEngineModule.pivotValues=sf.base.isBlazor()?e.olapEngineModule.pivotValues:a.pivotValues,e.pivotCommon.engineModule=e.olapEngineModule):(e.engineModule.pivotValues=sf.base.isBlazor()?e.engineModule.pivotValues:a.pivotValues,e.pivotCommon.engineModule=e.engineModule),t||!e.treeViewModule.fieldTable||e.isAdaptive||e.notify("tree-view-update",{}),e.isRequiredUpdate?(e.allowDeferLayoutUpdate&&(e.clonedDataSource=sf.base.extend({},e.dataSourceSettings,null,!0),e.clonedFieldList=sf.base.extend({},e.pivotFieldList,null,!0)),e.updateView(e.pivotGridModule)):"Popup"===e.renderMode&&e.allowDeferLayoutUpdate&&(e.pivotGridModule.engineModule=e.engineModule,e.pivotGridModule.setProperties({dataSourceSettings:e.dataSourceSettings.properties},!0),e.pivotGridModule.notify(d,e),sf.popups.hideSpinner(e.fieldListSpinnerElement)),"Popup"===e.renderMode&&e.pivotGridModule&&e.pivotGridModule.allowDeferLayoutUpdate&&!e.isRequiredUpdate&&(sf.popups.hideSpinner(e.fieldListSpinnerElement),e.pivotGridModule.hideWaitingPopup()),e.isRequiredUpdate=!0,!e.pivotGridModule||i?sf.popups.hideSpinner(e.fieldListSpinnerElement):e.pivotGridModule.fieldListSpinnerElement=e.fieldListSpinnerElement}))},t.prototype.updateOlapDataSource=function(e,t,i,a){var s=e.frameCustomProperties(e.olapEngineModule.fieldListData,e.olapEngineModule.fieldList);return s.savedFieldList=e.pivotFieldList,i||t?(e.olapEngineModule.savedFieldList=e.pivotFieldList,e.olapEngineModule.savedFieldListData=e.olapEngineModule.fieldListData,i?(e.olapEngineModule.updateCalcFields(e.dataSourceSettings,e.lastCalcFieldInfo),e.lastCalcFieldInfo={},a=!e.olapEngineModule.dataFields[e.lastCalcFieldInfo.name],e.pivotGridModule&&e.pivotGridModule.hideWaitingPopup()):e.olapEngineModule.onSort(e.dataSourceSettings)):e.olapEngineModule.renderEngine(e.dataSourceSettings,s),a},t.prototype.update=function(e){if(sf.base.isBlazor()&&void 0!==e){var t=e.ID;e=sf.base.getInstance("#"+t,nt)}e&&(this.clonedDataSet=e.clonedDataSet,sf.base.isBlazor()&&!this.isPopupView?r.updateDataSourceSettings(this,r.getClonedDataSourceSettings(e.dataSourceSettings)):this.setProperties({dataSourceSettings:e.dataSourceSettings},!0),this.engineModule=e.engineModule,this.olapEngineModule=e.olapEngineModule,this.dataType=e.dataType,this.pivotFieldList="olap"===this.dataType?e.olapEngineModule.fieldList:e.engineModule.fieldList,"Popup"===this.renderMode&&(this.pivotGridModule=e),this.getFieldCaption(e.dataSourceSettings),this.pivotCommon.engineModule="olap"===this.dataType?this.olapEngineModule:this.engineModule,this.pivotCommon.dataSourceSettings=this.dataSourceSettings,this.pivotCommon.control=this,this.treeViewModule.fieldTable&&!this.isAdaptive&&this.notify("tree-view-update",{}),this.axisFieldModule.render(),"Fixed"===this.renderMode&&this.allowDeferLayoutUpdate&&(this.clonedDataSource=sf.base.extend({},this.dataSourceSettings,null,!0),this.clonedFieldList=sf.base.extend({},this.pivotFieldList,null,!0)),this.isPopupView||(this.staticPivotGridModule=e))},t.prototype.updateView=function(e){if(sf.base.isBlazor()&&void 0!==e){var t=e.ID;e=sf.base.getInstance("#"+t,nt)}if(e){e.clonedDataSet=this.clonedDataSet,sf.base.isBlazor()?r.updateDataSourceSettings(e,r.getClonedDataSourceSettings(this.dataSourceSettings)):e.setProperties({dataSourceSettings:this.dataSourceSettings},!0),e.engineModule=this.engineModule,e.olapEngineModule=this.olapEngineModule,e.dataType=this.dataType,this.pivotChange||(e.pivotValues="olap"===this.dataType?this.olapEngineModule.pivotValues:this.engineModule.pivotValues);var i={dataSourceSettings:r.getClonedDataSourceSettings(e.dataSourceSettings),pivotValues:e.pivotValues};e.trigger("fieldListRefreshed",i),this.isPopupView||(this.staticPivotGridModule=e,e.isStaticRefresh=!0),e.enableVirtualization&&sf.base.isBlazor()?e.renderPivotGrid():e.dataBind()}},t.prototype.triggerPopulateEvent=function(){var e=this,t=this.isPopupView?this.pivotGridModule:this,i={dataSourceSettings:this.dataSourceSettings,pivotFieldList:"olap"===this.dataType?this.olapEngineModule.fieldList:this.engineModule.fieldList,pivotValues:"olap"===this.dataType?this.olapEngineModule.pivotValues:this.engineModule.pivotValues};t.trigger("enginePopulated",i,(function(t){e.dataSourceSettings=t.dataSourceSettings,e.pivotFieldList=t.pivotFieldList,"olap"===e.dataType?e.olapEngineModule.pivotValues=sf.base.isBlazor()?e.olapEngineModule.pivotValues:t.pivotValues:e.engineModule.pivotValues=sf.base.isBlazor()?e.engineModule.pivotValues:t.pivotValues}))},t.prototype.destroy=function(){this.unWireEvent(),this.treeViewModule&&this.treeViewModule.destroy(),this.pivotButtonModule&&this.pivotButtonModule.destroy(),this.allowDeferLayoutUpdate&&this.dialogRenderer&&this.dialogRenderer.deferUpdateCheckBox&&!this.dialogRenderer.deferUpdateCheckBox.isDestroyed&&this.dialogRenderer.deferUpdateCheckBox.destroy(),e.prototype.destroy.call(this),this.element.innerHTML="",sf.base.removeClass([this.element],u),sf.base.removeClass([this.element],c),sf.base.removeClass([this.element],g),"Popup"===this.renderMode&&(this.dialogRenderer.fieldListDialog&&!this.dialogRenderer.fieldListDialog.isDestroyed&&this.dialogRenderer.fieldListDialog.destroy(),document.getElementById(this.element.id+"_Wrapper")&&sf.base.remove(document.getElementById(this.element.id+"_Wrapper")))},gt([sf.base.Complex({},te)],t.prototype,"dataSourceSettings",void 0),gt([sf.base.Property("Popup")],t.prototype,"renderMode",void 0),gt([sf.base.Property()],t.prototype,"target",void 0),gt([sf.base.Property("")],t.prototype,"cssClass",void 0),gt([sf.base.Property(!1)],t.prototype,"allowCalculatedField",void 0),gt([sf.base.Property(!1)],t.prototype,"showValuesButton",void 0),gt([sf.base.Property(!1)],t.prototype,"allowDeferLayoutUpdate",void 0),gt([sf.base.Property(1e3)],t.prototype,"maxNodeLimitInMemberEditor",void 0),gt([sf.base.Property(!0)],t.prototype,"loadOnDemandInMemberEditor",void 0),gt([sf.base.Property()],t.prototype,"spinnerTemplate",void 0),gt([sf.base.Property(["Sum","Count","DistinctCount","Product","Min","Max","Avg","Median","Index","PopulationVar","SampleVar","PopulationStDev","SampleStDev","RunningTotals","PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal","PercentageOfParentColumnTotal","PercentageOfParentRowTotal","DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentTotal"])],t.prototype,"aggregateTypes",void 0),gt([sf.base.Event()],t.prototype,"load",void 0),gt([sf.base.Event()],t.prototype,"enginePopulating",void 0),gt([sf.base.Event()],t.prototype,"memberFiltering",void 0),gt([sf.base.Event()],t.prototype,"enginePopulated",void 0),gt([sf.base.Event()],t.prototype,"onFieldDropped",void 0),gt([sf.base.Event()],t.prototype,"fieldDrop",void 0),gt([sf.base.Event()],t.prototype,"fieldDragStart",void 0),gt([sf.base.Event()],t.prototype,"aggregateCellInfo",void 0),gt([sf.base.Event()],t.prototype,"memberEditorOpen",void 0),gt([sf.base.Event()],t.prototype,"calculatedFieldCreate",void 0),gt([sf.base.Event()],t.prototype,"aggregateMenuOpen",void 0),gt([sf.base.Event()],t.prototype,"fieldRemove",void 0),gt([sf.base.Event()],t.prototype,"dataBound",void 0),gt([sf.base.Event()],t.prototype,"created",void 0),gt([sf.base.Event()],t.prototype,"destroyed",void 0),gt([sf.base.Event()],t.prototype,"beforeServiceInvoke",void 0),t=gt([sf.base.NotifyPropertyChanges],t)}(sf.base.Component),mt="PopulationVar",vt="CalculatedField",bt=function(){function e(e){this.isFormula=!1,this.isRequireUpdate=!1,this.parent=e,this.existingReport=null,this.parent.calculatedFieldModule=this,this.removeEventListener(),this.addEventListener(),this.parentID=this.parent.element.id,this.dialog=null,this.inputObj=null,this.treeObj=null,this.droppable=null,this.menuObj=null,this.newFields=null,this.isFieldExist=!0,this.formulaText=null,this.fieldText=null,this.formatText=null,this.formatType=null,this.fieldType=null,this.parentHierarchy=null,this.isEdit=!1,this.currentFieldName=null,this.confirmPopUp=null}return e.prototype.getModuleName=function(){return"calculatedfield"},e.prototype.keyActionHandler=function(e){var t=e.currentTarget.querySelector(".e-hover.e-node-focus");if(t)switch(e.action){case"moveRight":case"shiftE":"pivot"===this.parent.dataType&&this.displayMenu(t);break;case"delete":"LI"===t.tagName&&!t.querySelector(".e-list-icon.e-format")&&!t.querySelector(".e-list-icon").classList.contains(".e-icons")&&t.querySelector("."+O)&&t.querySelector("."+O).classList.contains("e-list-icon")&&this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("removeCalculatedField"),{},!0,t);break;case"enter":var i=t.getAttribute("data-field"),a=t.getAttribute("data-type"),s=sf.base.select("#"+this.parentID+"droppable",this.dialog.element);"pivot"===this.parent.dataType?""===s.value?s.value=a===vt?t.getAttribute("data-uid"):'"'+a+"("+i+')"':""!==s.value&&(s.value=a===vt?s.value+t.getAttribute("data-uid"):s.value+'"'+a+"("+i+')"'):(this.parent.olapEngineModule&&this.parent.olapEngineModule.fieldList[i]&&this.parent.olapEngineModule.fieldList[i].isCalculatedField&&(i=this.parent.olapEngineModule.fieldList[i].tag),""===s.value?s.value=i:""!==s.value&&(s.value=s.value+i))}},e.prototype.fieldClickHandler=function(e){var t=sf.base.closest(e.event.target,"li");(e.event.target.classList.contains(C)||e.event.target.classList.contains("e-edit")||e.event.target.classList.contains("e-edited")||e.event.target.classList.contains(O))&&(this.parent.isAdaptive?"olap"===this.parent.dataType&&this.parent.isAdaptive&&("LI"===t.tagName&&t.querySelector(".e-list-edit-icon").classList.contains("e-edit")&&e.event.target.classList.contains("e-edit")?(this.isEdit=!0,this.currentFieldName=t.getAttribute("data-field"),this.fieldText=t.getAttribute("data-caption"),this.formulaText=t.getAttribute("data-formula"),this.formatType=t.getAttribute("data-formatString"),this.formatText="Custom"===this.formatType?t.getAttribute("data-customString"):null,this.fieldType=t.getAttribute("data-membertype"),this.parentHierarchy="Dimension"===this.fieldType?t.getAttribute("data-hierarchy"):null,sf.base.addClass([t.querySelector(".e-list-edit-icon")],"e-edited"),sf.base.removeClass([t.querySelector(".e-list-edit-icon")],"e-edit"),this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)):"LI"===t.tagName&&t.querySelector(".e-list-edit-icon").classList.contains("e-edited")&&e.event.target.classList.contains("e-edited")?(this.isEdit=!1,this.fieldText=this.formatText=this.formulaText=this.currentFieldName=null,this.parentHierarchy=this.fieldType=this.formatType=null,sf.base.addClass([t.querySelector(".e-list-edit-icon")],"e-edit"),sf.base.removeClass([t.querySelector(".e-list-edit-icon")],"e-edited")):"LI"===t.tagName&&t.querySelector("."+O).classList.contains("e-icons")&&e.event.target.classList.contains(O)&&this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("removeCalculatedField"),{},!0,e.node)):this.displayMenu(t,e.node,e.event.target))},e.prototype.accordionClickHandler=function(e){if(e.item&&-1!==e.item.iconCss.indexOf("e-list-icon")&&sf.base.closest(e.originalEvent.target,".e-acrdn-header-icon")){var t=sf.base.closest(e.originalEvent.target,".e-acrdn-header").querySelector(".e-pivot-calc-check"),i=t.getAttribute("data-field"),a=r.getFieldByName(i,this.parent.dataSourceSettings.formatSettings),s=sf.base.closest(e.originalEvent.target,".e-acrdn-header-icon");s.querySelector(".e-edit")&&e.originalEvent.target.classList.contains("e-edit")?(this.isEdit=!0,this.currentFieldName=this.fieldText=i,this.formulaText=this.parent.engineModule.fieldList[i].formula,this.formatText=a?a.format:"",sf.base.addClass([s.querySelector(".e-list-icon")],"e-edited"),sf.base.removeClass([s.querySelector(".e-list-icon")],"e-edit"),this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)):s.querySelector(".e-edited")&&e.originalEvent.target.classList.contains("e-edited")?(this.isEdit=!1,this.fieldText=this.formatText=this.formulaText=this.currentFieldName=null,sf.base.addClass([s.querySelector(".e-list-icon")],"e-edit"),sf.base.removeClass([s.querySelector(".e-list-icon")],"e-edited")):s.querySelector("."+O)&&e.originalEvent.target.classList.contains(O)&&this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("removeCalculatedField"),{},!0,t)}},e.prototype.accordionCreated=function(){for(var e=this.accordion.element.querySelectorAll(".e-acrdn-item"),t=0;t<e.length;t++)if(e[t].querySelector(".e-edit")||e[t].querySelector(".e-edited")){var i=sf.base.createElement("span",{className:"e-list-icon "+O+" e-icons"});sf.base.append([i],e[t].querySelector(".e-acrdn-header-icon"))}},e.prototype.clearFormula=function(){this.treeObj&&this.treeObj.element.querySelector("li")&&(sf.base.removeClass(this.treeObj.element.querySelectorAll("li"),"e-active"),this.displayMenu(this.treeObj.element.querySelector("li")))},e.prototype.displayMenu=function(e,t,i){var a=!i||i.classList.contains("e-edit"),s=!i||i.classList.contains("e-edited");if("pivot"!==this.parent.dataType||!e.querySelector(".e-list-icon.e-format")||!e.querySelector(".e-list-icon.e-format").classList.contains(f)||e.querySelector(".e-list-icon").classList.contains("e-edited")||e.querySelector(".e-list-icon").classList.contains(O)||e.querySelector(".e-list-icon").classList.contains("e-edit")||"LI"!==e.tagName){if("LI"===e.tagName&&(e.querySelector(".e-edit")&&e.querySelector(".e-edit").classList.contains("e-list-icon")&&a||"olap"===this.parent.dataType&&e.getAttribute("data-type")===vt&&e.classList.contains("e-active")&&(i&&!i.classList.contains(O)||!i))){this.isEdit=!0;var r=e.getAttribute("data-field"),n=e.getAttribute("data-caption");this.currentFieldName=r,this.inputObj.value=n,this.inputObj.dataBind();var o=e.getAttribute("data-formatString"),l=this.dialog.element,d=sf.base.getInstance(sf.base.select("#"+this.parentID+"Custom_Format_Element",l),sf.inputs.MaskedTextBox);if("olap"===this.parent.dataType){var p=e.getAttribute("data-membertype"),h=e.getAttribute("data-hierarchy"),u=e.getAttribute("data-formula"),c=e.getAttribute("data-customString"),g=sf.base.select("#"+this.parentID+"_FieldNameTitle",l),m=sf.base.getInstance(sf.base.select("#"+this.parentID+"Member_Type_Div",l),sf.dropdowns.DropDownList),v=sf.base.getInstance(sf.base.select("#"+this.parentID+"Hierarchy_List_Div",l),sf.dropdowns.DropDownList),b=sf.base.getInstance(sf.base.select("#"+this.parentID+"Format_Div",l),sf.dropdowns.DropDownList);g.innerHTML=this.parent.localeObj.getConstant("caption"),sf.base.select("#"+this.parentID+"droppable",document).value=u,m.readonly=!0,m.value=p,m.dataBind(),"Dimension"===p&&(v.value=h),""!==o&&(b.value=o,b.dataBind()),d.value=c}else d.value=o,sf.base.addClass(this.treeObj.element.querySelectorAll(".e-edited"),"e-edit"),sf.base.removeClass(this.treeObj.element.querySelectorAll(".e-edited"),"e-edited"),sf.base.addClass([e.querySelector(".e-list-icon")],"e-edited"),sf.base.removeClass([e.querySelector(".e-list-icon")],"e-edit"),e.querySelector(".e-edited").setAttribute("title",this.parent.localeObj.getConstant("clearCalculatedField")),sf.base.select("#"+this.parentID+"droppable",document).value=e.getAttribute("data-uid");d.dataBind()}else if("LI"===e.tagName&&(e.querySelector(".e-edited")&&e.querySelector(".e-edited").classList.contains("e-list-icon")&&s||"olap"===this.parent.dataType&&!e.classList.contains("e-active"))){this.isEdit=!1,this.inputObj.value="",this.inputObj.dataBind();l=this.dialog.element;if((d=sf.base.getInstance(sf.base.select("#"+this.parentID+"Custom_Format_Element",l),sf.inputs.MaskedTextBox)).value="",d.dataBind(),"olap"===this.parent.dataType){v=sf.base.getInstance(sf.base.select("#"+this.parentID+"Hierarchy_List_Div",l),sf.dropdowns.DropDownList),b=sf.base.getInstance(sf.base.select("#"+this.parentID+"Format_Div",l),sf.dropdowns.DropDownList),m=sf.base.getInstance(sf.base.select("#"+this.parentID+"Member_Type_Div",l),sf.dropdowns.DropDownList);(g=sf.base.select("#"+this.parentID+"_FieldNameTitle",l)).innerHTML=this.parent.localeObj.getConstant("fieldTitle"),v.index=0,v.dataBind(),b.index=0,b.dataBind(),m.index=0,m.readonly=!1,m.dataBind()}else sf.base.addClass(this.treeObj.element.querySelectorAll(".e-edited"),"e-edit"),sf.base.removeClass(this.treeObj.element.querySelectorAll(".e-edited"),"e-edited"),e.querySelector(".e-edit").setAttribute("title",this.parent.localeObj.getConstant("edit"));sf.base.select("#"+this.parentID+"droppable",document).value=""}else if("LI"===e.tagName&&e.querySelector("."+O)&&e.querySelector("."+O).classList.contains("e-list-icon")&&!a&&!s){var S=sf.base.select("#"+this.parentID+"droppable",document),y={name:this.isEdit?this.currentFieldName:this.inputObj.value,caption:this.inputObj.value,formula:S.value};this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("removeCalculatedField"),y,!0,t)}}else this.menuObj&&!this.menuObj.isDestroyed&&this.menuObj.destroy(),this.curMenu=e.querySelector(".e-list-text"),this.openContextMenu(e)},e.prototype.removeCalcField=function(e){var t,i=this.parent.dataSourceSettings,a=e.getAttribute("data-field"),s=i.calculatedFieldSettings;"pivot"===this.parent.dataType&&(this.parent.isAdaptive?"number"==typeof(d=parseInt(e.getAttribute("id").split(this.parentID+"_")[1],10))&&this.accordion.removeItem(d):this.treeObj.removeNodes([e]));for(var r=0;r<s.length;r++)if(s[r]&&s[r].name===a){s.splice(r,1);break}if("olap"===this.parent.dataType){for(var n=(t=this.parent.olapEngineModule).fieldListData?t.fieldListData:[],o=0,l=Object.keys(n);o<l.length;o++){var d,p=l[o];if(n[p].name===a)if("number"==typeof(d=parseInt(p,10))){n.splice(d,1);break}}var h=this.treeObj.getNode(e).parentID;this.treeObj.removeNodes([e]),s.length<=0&&this.treeObj.removeNodes([h])}else t=this.parent.engineModule;if(t.fields)for(r=0;r<t.fields.length;r++)if(t.fields[r]===a){t.fields.splice(r,1);break}t.savedFieldList&&t.savedFieldList[a]&&delete t.savedFieldList[a],t.fieldList&&t.fieldList[a]&&delete t.fieldList[a];var u=i.formatSettings;for(r=0;r<u.length;r++)if(u[r]&&u[r].name===a){u.splice(r,1);break}for(var c=[i.values,i.rows,i.columns,i.filters],g=(r=0,c.length);r<g;r++)for(var f=0,m=c[r].length;f<m;f++)if(c[r][f].name===a){c[r].splice(f,1);break}this.isEdit&&this.currentFieldName===a&&(this.isEdit=!1,this.inputObj.value="",this.currentFieldName=this.formatText=this.fieldText=this.formatType=null,this.formulaText=this.fieldType=this.parentHierarchy=null),this.parent.allowDeferLayoutUpdate&&"pivotfieldlist"===this.parent.getModuleName()||this.parent.updateDataSource(),this.removeErrorDialog()},e.prototype.openContextMenu=function(e){var t=this,i=e.getAttribute("data-field"),a="number"!==this.parent.engineModule.fieldList[i].type?"string":"number",s="string"===a?this.getValidSummaryType().slice(0,2):this.getValidSummaryType(),r={cancel:!1,fieldName:i,aggregateTypes:this.getMenuItems(a).slice()};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger("aggregateMenuOpen",r,(function(i){if(!i.cancel){for(var a=[],r=[],n=0,o=i.aggregateTypes;n<o.length;n++){var l=o[n];s.indexOf(l)>-1&&-1===a.indexOf(l)&&(a.push(l),r.push({id:t.parent.element.id+"Calc_"+l,text:t.parent.localeObj.getConstant(l)}))}t.createMenu(r,e);var d=e.getBoundingClientRect(),p=window.scrollY||document.documentElement.scrollTop;t.parent.enableRtl?t.menuObj.open(d.top+p,d.left-100):t.menuObj.open(d.top+p,d.left+150)}}))},e.prototype.selectContextMenu=function(e){if(null!==e.element.textContent){var t=sf.base.closest(this.curMenu,".e-list-item").getAttribute("data-caption");sf.base.closest(this.curMenu,".e-list-item").setAttribute("data-type",e.element.id.split("_").pop()),this.curMenu.textContent=t+" ("+e.element.textContent+")",sf.base.addClass([this.curMenu.parentElement.parentElement],["e-node-focus","e-hover"]),this.curMenu.parentElement.parentElement.setAttribute("tabindex","-1"),this.curMenu.parentElement.parentElement.focus()}},e.prototype.createMenu=function(e,t){var i,a=this,s={cssClass:this.parentID+"calculatedmenu",items:e,enableRtl:this.parent.enableRtl,select:this.selectContextMenu.bind(this),onClose:function(){a.treeObj.element.focus(),sf.base.addClass([t],["e-hover","e-node-focus"])}};i=sf.base.select("#"+this.parentID+"CalcContextmenu",document)?sf.base.select("#"+this.parentID+"CalcContextmenu",document):sf.base.createElement("ul",{id:this.parentID+"CalcContextmenu"}),this.dialog.element.appendChild(i),this.menuObj=new sf.navigations.ContextMenu(s),this.menuObj.isStringTemplate=!0,this.menuObj.appendTo(i)},e.prototype.applyFormula=function(){var e=this,t=this,i=!1;sf.base.removeClass([document.getElementById(this.parentID+"ddlelement")],"e-empty-field"),this.newFields=sf.base.extend([],this.parent.dataSourceSettings.calculatedFieldSettings,null,!0);var a={fieldName:this.isEdit?this.currentFieldName:this.inputObj.value,calculatedField:this.getCalculatedFieldInfo(),calculatedFieldSettings:r.cloneCalculatedFieldSettings(this.parent.dataSourceSettings.calculatedFieldSettings),cancel:!1};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger("calculatedFieldCreate",a,(function(a){if(a.cancel)e.endDialog(),e.parent.lastCalcFieldInfo={},e.isFormula=!1;else{var s=a.calculatedField;if(!e.isEdit)if("olap"===t.parent.dataType){var r=s.name;t.parent.olapEngineModule.fieldList[r]&&"CalculatedField"!==t.parent.olapEngineModule.fieldList[r].type&&(i=!0)}else for(var n=0,o=Object.keys(t.parent.engineModule.fieldList);n<o.length;n++){var l=o[n];s.name&&s.name===l&&"CalculatedField"!==t.parent.engineModule.fieldList[l].aggregateType&&(i=!0)}if(i)return void t.parent.pivotCommon.errorDialog.createErrorDialog(t.parent.localeObj.getConstant("error"),t.parent.localeObj.getConstant("fieldExist"));e.existingReport=sf.base.extend({},e.parent.dataSourceSettings,null,!0);var d=e.parent.dataSourceSettings;if(sf.base.isNullOrUndefined(s.name)||""===s.name||sf.base.isNullOrUndefined(s.caption)||""===s.caption||!s.formula||""===s.formula)sf.base.isNullOrUndefined(s.name)||""===s.name||sf.base.isNullOrUndefined(s.caption)||""===s.caption?(e.inputObj.value="",sf.base.addClass([document.getElementById(e.parentID+"ddlelement")],"e-empty-field"),document.getElementById(e.parentID+"ddlelement").focus()):e.parent.pivotCommon.errorDialog.createErrorDialog(e.parent.localeObj.getConstant("error"),e.parent.localeObj.getConstant("invalidFormula"));else{r=void 0;if("olap"===e.parent.dataType){if(r={name:s.name,formula:s.formula,formatString:s.formatString},sf.base.isNullOrUndefined(s.hierarchyUniqueName)||(r.hierarchyUniqueName=s.hierarchyUniqueName),e.isFieldExist=!1,e.isEdit){for(m=0;m<d.calculatedFieldSettings.length;m++)if(d.calculatedFieldSettings[m].name===r.name&&e.isEdit){d.calculatedFieldSettings[m].hierarchyUniqueName=s.hierarchyUniqueName,e.parent.olapEngineModule.fieldList[r.name].caption=s.caption,d.calculatedFieldSettings[m].formatString=r.formatString,d.calculatedFieldSettings[m].formula=r.formula,r=d.calculatedFieldSettings[m],e.isFieldExist=!0;break}for(var p=!1,h=0,u=[d.rows,d.columns,d.values,d.filters];h<u.length;h++){for(var c=0,g=u[h];c<g.length;c++){var f=g[c];if(f.isCalculatedField&&null!==r.name&&f.name===r.name&&e.isEdit){f.caption=s.caption,e.isFieldExist=!0,p=!0;break}}if(p)break}}else for(var m=0;m<d.calculatedFieldSettings.length;m++)if(d.calculatedFieldSettings[m].name===r.name)return void e.createConfirmDialog(t.parent.localeObj.getConstant("alert"),t.parent.localeObj.getConstant("confirmText"),s);e.isFieldExist||d.calculatedFieldSettings.push(r),e.parent.lastCalcFieldInfo=r}else{r={name:s.name,caption:s.caption,type:"CalculatedField"};var v={name:s.name,formula:s.formula};if(sf.base.isNullOrUndefined(s.formatString)||(v.formatString=s.formatString),e.isFieldExist=!0,e.isEdit){for(m=0;m<d.values.length;m++)if(d.values[m].type===vt&&null!==r.name&&d.values[m].name===r.name&&e.isEdit)for(b=0;b<d.calculatedFieldSettings.length;b++)d.calculatedFieldSettings[b].name===r.name&&(d.values[m].caption=s.caption,e.currentFormula=d.calculatedFieldSettings[b].formula,d.calculatedFieldSettings[b].formula=s.formula,e.parent.engineModule.fieldList[r.name].caption=s.caption,e.updateFormatSettings(d,r.name,s.formatString),e.isFieldExist=!1)}else for(var m=0;m<d.values.length;m++)if(d.values[m].type===vt&&d.values[m].name===r.name){for(var b=0;b<d.calculatedFieldSettings.length;b++)if(d.calculatedFieldSettings[b].name===r.name)return void e.createConfirmDialog(t.parent.localeObj.getConstant("alert"),t.parent.localeObj.getConstant("confirmText"),s);e.isFieldExist=!1}e.isFieldExist&&(d.values.push(r),d.calculatedFieldSettings.push(v),e.updateFormatSettings(d,r.name,s.formatString)),e.parent.lastCalcFieldInfo=v}e.addFormula(d,r.name)}}}))},e.prototype.getCalculatedFieldInfo=function(){var e,t=sf.base.select("#"+this.parentID+"droppable",document),i=this.parent.isAdaptive?this.parent.dialogRenderer.adaptiveElement.element:this.dialog.element,a=sf.base.getInstance(sf.base.select("#"+this.parentID+"Custom_Format_Element",i),sf.inputs.MaskedTextBox);if(e={name:this.isEdit?this.currentFieldName:this.inputObj.value,caption:this.inputObj.value,formula:t.value},"olap"===this.parent.dataType){var s=sf.base.getInstance(sf.base.select("#"+this.parentID+"Format_Div",i),sf.dropdowns.DropDownList),r=sf.base.getInstance(sf.base.select("#"+this.parentID+"Member_Type_Div",i),sf.dropdowns.DropDownList),n=sf.base.getInstance(sf.base.select("#"+this.parentID+"Hierarchy_List_Div",i),sf.dropdowns.DropDownList);e.formatString="Custom"===s.value?a.value:s.value,"Dimension"===r.value&&(e.hierarchyUniqueName=n.value)}else e.formatString=a.value;return e},e.prototype.updateFormatSettings=function(e,t,i){for(var a={name:t,format:i,useGrouping:!0},s=!1,r=0;r<e.formatSettings.length;r++)if(e.formatSettings[r].name===t){if("undefined"===i||void 0===i||""===i){e.formatSettings.splice(r,1),s=!0;break}var n=e.formatSettings[r].properties?e.formatSettings[r].properties:e.formatSettings[r];n.format=i,e.formatSettings.splice(r,1,n),s=!0;break}s||""===i||e.formatSettings.push(a)},e.prototype.addFormula=function(e,t){this.isFormula=!0,this.field=t,sf.base.isBlazor()||"Server"===this.parent.dataSourceSettings.mode?r.updateDataSourceSettings(this.parent,r.getClonedDataSourceSettings(e)):this.parent.setProperties({dataSourceSettings:e},!0),"pivotfieldlist"===this.parent.getModuleName()&&this.parent.allowDeferLayoutUpdate&&(this.parent.isRequiredUpdate=!1);try{this.parent.updateDataSource(!1);var i="pivotfieldlist"===this.parent.getModuleName()&&this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent;sf.base.isBlazor()&&i&&i.enableVirtualization||!i||"Server"===i.dataSourceSettings.mode?this.isRequireUpdate=!0:this.endDialog(),"pivotfieldlist"===this.parent.getModuleName()&&"Fixed"===this.parent.renderMode&&this.parent.allowDeferLayoutUpdate&&(this.parent.pivotChange=!0)}catch(e){this.showError()}},e.prototype.endDialog=function(){if(this.isEdit=!1,this.dialog)this.dialog.close();else{this.inputObj.value="",this.currentFieldName=this.formatText=this.fieldText=this.formatType=null,this.formulaText=this.fieldType=this.parentHierarchy=null;var e=this.parent.isAdaptive?this.parent.dialogRenderer.parentElement:this.dialog.element;if(this.parent.dialogRenderer.parentElement.querySelector("."+S).value="",sf.base.select("#"+this.parentID+"droppable",this.parent.dialogRenderer.parentElement).value="",sf.base.select("#"+this.parentID+"Custom_Format_Element",this.parent.dialogRenderer.parentElement).value="","olap"===this.parent.dataType){var t=sf.base.getInstance(sf.base.select("#"+this.parentID+"Custom_Format_Element",e),sf.inputs.MaskedTextBox),i=sf.base.getInstance(sf.base.select("#"+this.parentID+"Format_Div",e),sf.dropdowns.DropDownList),a=sf.base.getInstance(sf.base.select("#"+this.parentID+"Member_Type_Div",e),sf.dropdowns.DropDownList),s=sf.base.getInstance(sf.base.select("#"+this.parentID+"Hierarchy_List_Div",e),sf.dropdowns.DropDownList);i.index=0,i.dataBind(),a.index=0,a.readonly=!1,a.dataBind(),s.index=0,s.enabled=!1,s.dataBind(),t.enabled=!1,t.dataBind()}}},e.prototype.showError=function(){if(this.parent.engineModule.fieldList[this.field]&&delete this.parent.engineModule.fieldList[this.field],this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),this.parent.localeObj.getConstant("invalidFormula")),sf.base.isBlazor()?r.updateDataSourceSettings(this.parent,r.getClonedDataSourceSettings(this.existingReport)):this.parent.setProperties({dataSourceSettings:this.existingReport},!0),this.isEdit){for(var e=this.parent.dataSourceSettings.calculatedFieldSettings,t=0;e&&t<e.length;t++)if(e[t].name===this.field){e[t].formula=this.currentFormula;break}}else if(this.parent.engineModule.fields)for(t=0;t<this.parent.engineModule.fields.length;t++)if(this.parent.engineModule.fields[t]===this.field){this.parent.engineModule.fields.splice(t,1);break}this.parent.lastCalcFieldInfo={},this.parent.updateDataSource(!1),this.isFormula=!1},e.prototype.getFieldListData=function(e){var t=[];if("olap"===this.parent.dataType)for(var i=0,a=t=r.getClonedData(e.olapEngineModule.fieldListData?e.olapEngineModule.fieldListData:[]);i<a.length;i++){var s=a[i];s.spriteCssClass&&(s.spriteCssClass.indexOf("e-attributeCDB-icon")>-1||s.spriteCssClass.indexOf("e-level-members")>-1)?s.hasChildren=!0:s.spriteCssClass&&s.spriteCssClass.indexOf("e-namedSetCDB-icon")>-1?s.hasChildren=!1:s.spriteCssClass&&s.spriteCssClass.indexOf("e-calcMemberGroupCDB")>-1&&(s.expanded=this.isEdit)}else for(var n=0,o=e.engineModule.fieldList?Object.keys(e.engineModule.fieldList):[];n<o.length;n++){var l,d=o[n],p=null;p="number"===e.engineModule.fieldList[d].type&&"include"!==e.engineModule.fieldList[d].type&&"exclude"!==e.engineModule.fieldList[d].type||"DistinctCount"===e.engineModule.fieldList[d].aggregateType?void 0!==e.engineModule.fieldList[d].aggregateType?e.engineModule.fieldList[d].aggregateType:"Sum":"Count",l=this.parent.localeObj.getConstant(p),t.push({index:e.engineModule.fieldList[d].index,name:e.engineModule.fieldList[d].caption+" ("+l+")",type:p,icon:C+" "+f,formula:e.engineModule.fieldList[d].formula,field:d,caption:e.engineModule.fieldList[d].caption?e.engineModule.fieldList[d].caption:d})}return t},e.prototype.fieldDropped=function(e){e.cancel=!0;var t=sf.base.select("#"+this.parentID+"droppable",this.dialog.element);sf.base.removeClass([t],"e-copy-drop"),sf.base.removeClass([e.draggedNode.querySelector(".e-list-text")],"e-list-selected");var i=e.draggedNode.getAttribute("data-field");if("olap"===this.parent.dataType)if(this.parent.olapEngineModule.fieldList[i]&&this.parent.olapEngineModule.fieldList[i].isCalculatedField&&(i=this.parent.olapEngineModule.fieldList[i].tag),e.target.id===this.parentID+"droppable"&&""===t.value)t.value=i,t.focus();else if(e.target.id===this.parentID+"droppable"&&""!==t.value){var a=void 0,s=t.value,r=t.selectionStart,n=s.substring(r,s.length);a=(l=s.substring(0,r))+i,t.value=l+i+n,t.focus(),t.setSelectionRange(a.length,a.length)}else e.cancel=!0;else{var o=e.draggedNode.getAttribute("data-type");if(e.target.id===this.parentID+"droppable"&&""===t.value)t.value=o===vt?e.draggedNodeData.id.toString():'"'+o+"("+i+')"',t.focus();else if(e.target.id===this.parentID+"droppable"&&""!==t.value){a=void 0,r=t.selectionStart;var l=(s=t.value).substring(0,r);n=s.substring(r,s.length);o===vt?(a=l+e.draggedNodeData.id.toString(),t.value=l+e.draggedNodeData.id.toString()+n):(a=l+'"'+o+"("+i+')"',t.value=l+'"'+o+"("+i+')"'+n),t.focus(),t.setSelectionRange(a.length,a.length)}else e.cancel=!0}},e.prototype.createDialog=function(){var e=this;if(null!==sf.base.select("#"+this.parentID+"calculateddialog",document))for(sf.base.remove(sf.base.select("#"+this.parentID+"calculateddialog",document));!sf.base.isNullOrUndefined(document.querySelector("."+this.parentID+"calculatedmenu"));)sf.base.remove(document.querySelector("."+this.parentID+"calculatedmenu"));this.parent.element.appendChild(sf.base.createElement("div",{id:this.parentID+"calculateddialog",className:"e-pivot-calc-dialog-div "+("olap"===this.parent.dataType?"e-olap-calc-dialog-div":"")}));var t=[{click:this.applyFormula.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:this.cancelClick.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("cancel")}}];if("olap"===this.parent.dataType){var i={click:this.clearFormula.bind(this),buttonModel:{cssClass:"e-calc-clear-btn",content:this.parent.localeObj.getConstant("clear")}};t.splice(0,0,i)}this.dialog=new sf.popups.Dialog({allowDragging:!0,position:{X:"center",Y:"center"},buttons:t,close:this.closeDialog.bind(this),beforeOpen:this.beforeOpen.bind(this),open:function(){sf.base.select("#"+e.parentID+"ddlelement",e.dialog.element)&&sf.base.select("#"+e.parentID+"ddlelement",e.dialog.element).focus()},animationSettings:{effect:"Zoom"},width:"25%",isModal:!1,closeOnEscape:!0,enableRtl:this.parent.enableRtl,showCloseIcon:!0,header:this.parent.localeObj.getConstant("createCalculatedField"),target:document.body}),this.dialog.isStringTemplate=!0,this.dialog.appendTo("#"+this.parentID+"calculateddialog")},e.prototype.cancelClick=function(){this.dialog.close(),this.isEdit=!1},e.prototype.beforeOpen=function(e){this.dialog.element.querySelector(".e-dlg-header").setAttribute("title",this.parent.localeObj.getConstant("createCalculatedField"))},e.prototype.closeDialog=function(e){"pivotfieldlist"===this.parent.getModuleName()&&(this.parent.axisFieldModule.render(),"Fixed"!==this.parent.renderMode&&(sf.base.addClass([this.parent.element.querySelector(".e-toggle-field-list")],"e-hide"),this.parent.dialogRenderer.fieldListDialog.show())),this.treeObj.destroy(),this.dialog.destroy(),this.newFields=null,this.menuObj&&!this.menuObj.isDestroyed&&this.menuObj.destroy(),sf.base.remove(document.getElementById(this.parentID+"calculateddialog")),sf.base.isNullOrUndefined(document.querySelector("."+this.parentID+"calculatedmenu"))||sf.base.remove(document.querySelector("."+this.parentID+"calculatedmenu"));var t="pivotview"===this.parent.getModuleName()||"pivotfieldlist"===this.parent.getModuleName()&&"Fixed"===this.parent.renderMode?0:500;this.buttonCall&&(this.buttonCall=!1,setTimeout(this.setFocus.bind(this),t))},e.prototype.setFocus=function(){var e;if("pivotview"===this.parent.getModuleName()&&this.parent.element?e=this.parent.element:document.getElementById(this.parent.element.id+"_Wrapper")&&(e=document.getElementById(this.parent.element.id+"_Wrapper")),e)for(var t=0,i=[].slice.call(e.querySelectorAll(".e-pivot-button"));t<i.length;t++){var a=i[t];if(a.getAttribute("data-uid")===this.currentFieldName){a.focus();break}}},e.prototype.renderDialogElements=function(){var e=sf.base.createElement("div",{id:this.parentID+"outerDiv",className:("olap"===this.parent.dataType?"e-olap-calc-outer-div ":"")+"e-pivot-calc-outer-div"}),t=sf.base.createElement("div",{id:this.parentID+"Olap_Tree_Div",className:"e-olap-field-tree-div"}),i=sf.base.createElement("div",{id:this.parentID+"Olap_Calc_Div",className:"e-olap-calculated-div"});if("pivotfieldlist"===this.parent.getModuleName()&&null!==this.parent.dialogRenderer.parentElement.querySelector("."+w)&&this.parent.isAdaptive){var a=sf.base.createElement("div",{id:this.parentID+"accordDiv",className:"e-pivot-accord"});e.appendChild(a);var s=sf.base.createElement("div",{id:this.parentID+"buttonDiv",className:"e-pivot-button-div"}),r=sf.base.createElement("button",{id:this.parentID+"addBtn",innerHTML:this.parent.localeObj.getConstant("add"),className:"e-pivot-add-button",attrs:{type:"button"}}),n=sf.base.createElement("button",{id:this.parentID+"cancelBtn",innerHTML:this.parent.localeObj.getConstant("cancel"),className:"e-pivot-cancel-button",attrs:{type:"button"}});s.appendChild(n),s.appendChild(r),e.appendChild(s)}else{if(!this.parent.isAdaptive&&"olap"===this.parent.dataType){var o=sf.base.createElement("div",{className:"e-pivot-field-name-title",id:this.parentID+"_FieldNameTitle",innerHTML:this.parent.localeObj.getConstant("fieldTitle")});i.appendChild(o)}var l=sf.base.createElement("div",{id:this.parentID+"outerDiv",className:"e-pivot-calc-input-div"}),d=sf.base.createElement("input",{id:this.parentID+"ddlelement",attrs:{type:"text"},className:S});l.appendChild(d),"olap"!==this.parent.dataType||this.parent.isAdaptive?e.appendChild(l):i.appendChild(l);var p=sf.base.createElement("div",{id:this.parentID+"control_wrapper",className:"e-pivot-treeview-outer"});if(!this.parent.isAdaptive){var h=sf.base.createElement("div",{className:"e-pivot-all-field-title",innerHTML:"olap"===this.parent.dataType?this.parent.localeObj.getConstant("allFields"):this.parent.localeObj.getConstant("formulaField")});if("olap"===this.parent.dataType){var u=sf.base.createElement("div",{className:"e-pivot-all-field-title-wrapper"});u.appendChild(h);var c=sf.base.createElement("span",{attrs:{tabindex:"0","aria-disabled":"false","aria-label":this.parent.localeObj.getConstant("fieldTooltip")},className:f+" e-info"});u.appendChild(c),new sf.popups.Tooltip({content:this.parent.localeObj.getConstant("fieldTooltip"),position:this.parent.enableRtl?"RightCenter":"LeftCenter",target:".e-info",offsetY:(this.parent.enableRtl,-10),width:220}).appendTo(u),p.appendChild(u)}else e.appendChild(h)}var g=sf.base.createElement("div",{className:"e-pivot-treeview-outer-div"});if(p.appendChild(g),g.appendChild(sf.base.createElement("div",{id:this.parentID+"tree",className:"e-pivot-treeview"})),"olap"!==this.parent.dataType||this.parent.isAdaptive?e.appendChild(p):t.appendChild(p),!this.parent.isAdaptive){o=sf.base.createElement("div",{className:"e-pivot-formula-title",innerHTML:"olap"===this.parent.dataType?this.parent.localeObj.getConstant("expressionField"):this.parent.localeObj.getConstant("formula")});"olap"===this.parent.dataType?i.appendChild(o):e.appendChild(o)}var m=sf.base.createElement("textarea",{id:this.parentID+"droppable",className:w+" e-control e-textbox e-input",attrs:{placeholder:this.parent.isAdaptive?this.parent.localeObj.getConstant("dropTextMobile"):"olap"===this.parent.dataType?this.parent.localeObj.getConstant("olapDropText"):this.parent.localeObj.getConstant("dropText")}});if("olap"!==this.parent.dataType||this.parent.isAdaptive?e.appendChild(m):i.appendChild(m),this.parent.isAdaptive){s=sf.base.createElement("div",{id:this.parentID+"buttonDiv",className:"e-pivot-button-div"});var v=sf.base.createElement("button",{id:this.parentID+"okBtn",innerHTML:this.parent.localeObj.getConstant("apply"),className:"e-pivot-ok-button",attrs:{type:"button"}});s.appendChild(v),e.appendChild(s)}if("olap"===this.parent.dataType){if(!this.parent.isAdaptive){var b=sf.base.createElement("div",{className:"e-olap-member-title",innerHTML:this.parent.localeObj.getConstant("memberType")});i.appendChild(b)}var y=sf.base.createElement("div",{id:this.parentID+"Member_Type_Div",className:"e-olap-calc-member-type-div"});if(this.parent.isAdaptive?e.appendChild(y):i.appendChild(y),!this.parent.isAdaptive){var C=sf.base.createElement("div",{className:"e-olap-hierarchy-title",innerHTML:this.parent.localeObj.getConstant("selectedHierarchy")});i.appendChild(C)}var x=sf.base.createElement("div",{id:this.parentID+"Hierarchy_List_Div",className:"e-olap-calc-hierarchy-list-div"});if(this.parent.isAdaptive?e.appendChild(x):i.appendChild(x),!this.parent.isAdaptive){var T=sf.base.createElement("div",{className:"e-olap-format-title",innerHTML:this.parent.localeObj.getConstant("formatString")});i.appendChild(T)}var M=sf.base.createElement("div",{id:this.parentID+"Format_Div",className:"e-olap-calc-format-type-div"});this.parent.isAdaptive?e.appendChild(M):i.appendChild(M);var D=sf.base.createElement("div",{id:this.parentID+"custom_Format_Div",className:"e-olap-calc-custom-format-div"}),E=sf.base.createElement("input",{id:this.parentID+"Custom_Format_Element",attrs:{type:"text"},className:"e-custom-format-input"});if(D.appendChild(E),i.appendChild(D),this.parent.isAdaptive?e.appendChild(D):i.appendChild(D),"pivotfieldlist"===this.parent.getModuleName()&&null===this.parent.dialogRenderer.parentElement.querySelector("."+w)&&this.parent.isAdaptive){v=e.querySelector(".e-pivot-ok-button");e.appendChild(v)}else e.appendChild(t),e.appendChild(i)}else{D=sf.base.createElement("div",{id:this.parentID+"custom_Format_Div",className:"e-pivot-calc-custom-format-div"});if(!this.parent.isAdaptive){T=sf.base.createElement("div",{className:"e-olap-format-title",innerHTML:this.parent.localeObj.getConstant("formatString")});D.appendChild(T)}E=sf.base.createElement("input",{id:this.parentID+"Custom_Format_Element",attrs:{type:"text"},className:"e-custom-format-input"});D.appendChild(E),this.parent.isAdaptive?e.insertBefore(D,sf.base.select("#"+this.parentID+"buttonDiv",e)):e.appendChild(D)}}return e},e.prototype.renderAdaptiveLayout=function(e){var t=this.parent.dialogRenderer.adaptiveElement;if(e){if(sf.base.select("#"+this.parentID+"droppable",t.element)&&(this.formulaText=sf.base.select("#"+this.parentID+"droppable",document).value,this.fieldText=this.inputObj.value),t.element.querySelector(".e-olap-calc-member-type-div")){var i=sf.base.getInstance(sf.base.select("#"+this.parentID+"Member_Type_Div",t.element),sf.dropdowns.DropDownList);this.fieldType=i.value}if(t.element.querySelector(".e-olap-calc-hierarchy-list-div")){var a=sf.base.getInstance(sf.base.select("#"+this.parentID+"Hierarchy_List_Div",t.element),sf.dropdowns.DropDownList);this.parentHierarchy="Dimension"===this.fieldType?a.value:null}if(t.element.querySelector(".e-olap-calc-format-type-div")){var s=sf.base.getInstance(sf.base.select("#"+this.parentID+"Format_Div",t.element),sf.dropdowns.DropDownList);this.formatType=s.value}if(t.element.querySelector(".e-custom-format-input")){var r=sf.base.getInstance(sf.base.select("#"+this.parentID+"Custom_Format_Element",t.element),sf.inputs.MaskedTextBox);this.formatText="olap"===this.parent.dataType?"Custom"===this.formatType?r.value:null:r.value}}else this.currentFieldName=this.formulaText=this.fieldText=this.formatText=null,this.fieldType=this.formatType=this.parentHierarchy=null;this.renderMobileLayout(t)},e.prototype.updateAdaptiveCalculatedField=function(e,t){var i=this.parent.dialogRenderer.adaptiveElement.element;this.isEdit=e;var a=e?"pivot"===this.parent.dataType?this.parent.engineModule.fieldList[t]:this.parent.olapEngineModule.fieldList[t]:{id:null,caption:null,formula:null,fieldType:"Measure",formatString:"pivot"===this.parent.dataType?null:"Standard",parentHierarchy:null};if(this.currentFieldName=a.id,sf.base.select("#"+this.parentID+"droppable",document)&&(this.formulaText=sf.base.select("#"+this.parentID+"droppable",document).value=a.formula,this.fieldText=this.inputObj.value=a.caption,this.inputObj.dataBind()),i.querySelector(".e-olap-calc-member-type-div")){var s=sf.base.getInstance(sf.base.select("#"+this.parentID+"Member_Type_Div",i),sf.dropdowns.DropDownList);this.fieldType=s.value=a.fieldType,s.readonly=!!e,s.dataBind()}if(i.querySelector(".e-olap-calc-hierarchy-list-div")){var n=sf.base.getInstance(sf.base.select("#"+this.parentID+"Hierarchy_List_Div",i),sf.dropdowns.DropDownList);"Dimension"===this.fieldType?this.parentHierarchy=n.value=a.parentHierarchy:(this.parentHierarchy=null,n.index=0),n.dataBind()}if(i.querySelector(".e-olap-calc-format-type-div")){var o=sf.base.getInstance(sf.base.select("#"+this.parentID+"Format_Div",i),sf.dropdowns.DropDownList);this.formatType=o.value=["Standard","Currency","Percent"].indexOf(a.formatString)>-1?a.formatString:"Custom"}if(i.querySelector(".e-custom-format-input")){var l=sf.base.getInstance(sf.base.select("#"+this.parentID+"Custom_Format_Element",i),sf.inputs.MaskedTextBox),d=r.getFieldByName(t,this.parent.dataSourceSettings.formatSettings);"pivot"===this.parent.dataType?this.formatText=l.value=d?d.format:null:this.formatText=l.value="Custom"===this.formatType?a.formatString:null,l.dataBind()}},e.prototype.createOlapDropElements=function(){for(var e=this,t=this.parent.isAdaptive?this.parent.dialogRenderer.parentElement:this.dialog.element,i=[],a=[],s=[],n=0,o=["Measure","Dimension"];n<o.length;n++){var l=o[n];i.push({value:l,text:this.parent.localeObj.getConstant(l)})}for(var d=0,p=["Standard","Currency","Percent","Custom"];d<p.length;d++){var h=p[d];a.push({value:h,text:this.parent.localeObj.getConstant(h)})}for(var u=0,c=r.getClonedData(this.parent.olapEngineModule.fieldListData);u<c.length;u++){var g=c[u];g.spriteCssClass&&(g.spriteCssClass.indexOf("e-attributeCDB-icon")>-1||g.spriteCssClass.indexOf("e-hierarchyCDB-icon")>-1)&&s.push({value:g.id,text:g.caption})}var f=new sf.dropdowns.DropDownList({dataSource:i,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text"},value:null!==this.fieldType?this.fieldType:i[0].value,readonly:this.isEdit,cssClass:"e-member-options",width:"100%",change:function(t){m.enabled="Dimension"===t.value,e.fieldType=t.value,e.formulaText=sf.base.select("#"+e.parentID+"droppable",document).value,m.dataBind()}});f.isStringTemplate=!0,f.appendTo(sf.base.select("#"+this.parentID+"Member_Type_Div",t));var m=new sf.dropdowns.DropDownList({dataSource:s,enableRtl:this.parent.enableRtl,allowFiltering:!0,enabled:"Dimension"===f.value,filterBarPlaceholder:this.parent.localeObj.getConstant("example")+" "+s[0].text.toString(),fields:{value:"value",text:"text"},value:null!==this.parentHierarchy&&"Dimension"===f.value?this.parentHierarchy:s[0].value,cssClass:"e-member-options",width:"100%",change:function(t){e.parentHierarchy=t.value,e.formulaText=sf.base.select("#"+e.parentID+"droppable",document).value}});m.isStringTemplate=!0,m.appendTo(sf.base.select("#"+this.parentID+"Hierarchy_List_Div",t));var v=new sf.dropdowns.DropDownList({dataSource:a,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text"},value:null!==this.formatType?this.formatType:a[0].value,cssClass:"e-member-options",width:"100%",change:function(t){b.enabled="Custom"===t.value,e.formatType=t.value,e.formulaText=sf.base.select("#"+e.parentID+"droppable",document).value,b.dataBind()}});v.isStringTemplate=!0,v.appendTo(sf.base.select("#"+this.parentID+"Format_Div",t));var b=new sf.inputs.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("customFormat"),value:null!==this.formatText&&"Custom"===v.value?this.formatText:null,enabled:"Custom"===v.value,change:function(t){e.formatText=t.value,e.formulaText=sf.base.select("#"+e.parentID+"droppable",document).value}});b.isStringTemplate=!0,b.appendTo("#"+this.parentID+"Custom_Format_Element")},e.prototype.createTreeView=function(){var e=this;"olap"===this.parent.dataType?this.treeObj=new sf.navigations.TreeView({fields:{dataSource:this.getFieldListData(this.parent),id:"id",text:"caption",parentID:"pid",iconCss:"spriteCssClass"},allowDragAndDrop:!0,enableRtl:this.parent.enableRtl,nodeDragStart:this.dragStart.bind(this),nodeDragging:function(e){e.event.target&&e.event.target.classList.contains(w)?(sf.base.removeClass([e.clonedNode],"e-drag-restrict"),sf.base.addClass([e.event.target],"e-copy-drop")):(sf.base.addClass([e.clonedNode],"e-drag-restrict"),sf.base.removeClass([e.event.target],"e-copy-drop"),e.dropIndicator="e-no-drop",sf.base.addClass([e.clonedNode.querySelector("."+f)],"e-icon-expandable"),sf.base.removeClass([e.clonedNode.querySelector("."+f)],"e-list-icon"))},nodeClicked:this.fieldClickHandler.bind(this),nodeSelected:function(t){t.node.getAttribute("data-type")===vt?e.displayMenu(t.node):(sf.base.removeClass([t.node],"e-active"),t.cancel=!0)},nodeDragStop:this.fieldDropped.bind(this),drawNode:this.drawTreeNode.bind(this),nodeExpanding:this.updateNodeIcon.bind(this),nodeCollapsed:this.updateNodeIcon.bind(this),sortOrder:"None"}):this.treeObj=new sf.navigations.TreeView({fields:{dataSource:this.getFieldListData(this.parent),id:"formula",text:"name",iconCss:"icon"},allowDragAndDrop:!0,enableRtl:this.parent.enableRtl,nodeCollapsing:this.nodeCollapsing.bind(this),nodeDragStart:this.dragStart.bind(this),nodeClicked:this.fieldClickHandler.bind(this),nodeDragStop:this.fieldDropped.bind(this),drawNode:this.drawTreeNode.bind(this),keyPress:function(e){39===e.event.keyCode&&(e.cancel=!0)},sortOrder:"Ascending"}),this.treeObj.isStringTemplate=!0,this.treeObj.appendTo("#"+this.parentID+"tree")},e.prototype.updateNodeIcon=function(e){if(e.node&&e.node.querySelector(".e-list-icon")&&e.node.querySelector(".e-icon-expandable.e-process")&&e.node.querySelector(".e-list-icon").className.indexOf("e-folderCDB-icon")>-1){var t=e.node.querySelector(".e-list-icon");sf.base.removeClass([t],"e-folderCDB-icon"),sf.base.addClass([t],"e-folderCDB-open-icon")}else if(e.node&&e.node.querySelector(".e-list-icon")&&e.node.querySelector(".e-icon-expandable")&&e.node.querySelector(".e-list-icon").className.indexOf("e-folderCDB-open-icon")>-1){t=e.node.querySelector(".e-list-icon");sf.base.removeClass([t],"e-folderCDB-open-icon"),sf.base.addClass([t],"e-folderCDB-icon")}else{for(var i=this.treeObj.fields.dataSource,a=[],s=0,r=i;s<r.length;s++){var n=r[s];n.pid===e.nodeData.id.toString()&&a.push(n)}if(0!==a.length)return;this.parent.olapEngineModule.calcChildMembers=[],this.parent.olapEngineModule.getCalcChildMembers(this.parent.dataSourceSettings,e.nodeData.id.toString()),a=this.parent.olapEngineModule.calcChildMembers,this.parent.olapEngineModule.calcChildMembers=[];for(var o=0,l=a;o<l.length;o++){(t=l[o]).pid=e.nodeData.id.toString(),t.hasChildren=!1,t.spriteCssClass="e-level-members",t.caption=""===t.caption?this.parent.localeObj.getConstant("blank"):t.caption,i.push(t)}this.treeObj.addNodes(a,e.node)}},e.prototype.nodeCollapsing=function(e){e.cancel=!0},e.prototype.dragStart=function(e){var t=!1,i=e.clonedNode;i&&("olap"===this.parent.dataType&&(i.querySelector(".e-calc-dimension-icon,.e-calc-measure-icon,.e-measure-icon")||i.querySelector(".e-dimensionCDB-icon,.e-attributeCDB-icon,.e-hierarchyCDB-icon")||i.querySelector(".e-level-members,.e-namedSetCDB-icon"))||"pivot"===this.parent.dataType&&e.event.target.classList.contains("e-drag"))&&(t=!0),t?(sf.base.addClass([e.draggedNode.querySelector(".e-list-text")],"e-list-selected"),sf.base.addClass([i],"e-pivot-calc"),i.style.zIndex=(this.dialog.zIndex+1).toString(),i.style.display="inline"):e.cancel=!0},e.prototype.drawTreeNode=function(e){if("olap"===this.parent.dataType){e.node.querySelector(".e-measure-icon")&&(e.node.querySelector(".e-list-icon").style.display="none");var t=e.nodeData;e.node.setAttribute("data-field",t.id),e.node.setAttribute("data-caption",t.caption);var i=e.node.querySelector(".e-text-content");if(e.nodeData&&e.nodeData.type===vt&&i&&e.node.querySelector(".e-list-icon.e-calc-member")){e.node.setAttribute("data-type",t.type),e.node.setAttribute("data-membertype",t.fieldType),e.node.setAttribute("data-hierarchy",t.parentHierarchy?t.parentHierarchy:""),e.node.setAttribute("data-formula",t.formula);var a;a=t.formatString?["Standard","Currency","Percent"].indexOf(t.formatString)>-1?t.formatString:"Custom":"",e.node.setAttribute("data-formatString",a),e.node.setAttribute("data-customString","Custom"===a?t.formatString:"");var s=sf.base.createElement("span",{className:O+" e-icons e-list-icon"});if(i.classList.add("e-calcfieldmember"),this.parent.isAdaptive){var n=sf.base.createElement("span",{className:"e-list-edit-icon"+(this.isEdit&&this.currentFieldName===t.id?" e-edited ":" e-edit ")+f}),o=sf.base.createElement("div",{className:"e-list-header-icon"});o.appendChild(n),o.appendChild(s),i.appendChild(o)}else i.appendChild(s)}if(this.parent.isAdaptive){var l=e.node.querySelector(".e-text-content");if(e.node&&e.node.querySelector(".e-list-icon")&&l){var d=e.node.querySelector(".e-list-icon");l.insertBefore(d,e.node.querySelector(".e-list-text"))}e.node&&e.node.querySelector(".e-calcMemberGroupCDB,.e-measureGroupCDB-icon,.e-folderCDB-icon")&&(e.node.querySelector(".e-checkbox-wrapper").style.display="none"),e.node&&e.node.querySelector(".e-level-members")&&(e.node.querySelector(".e-list-icon").style.display="none")}}else{t=e.nodeData.field;e.node.setAttribute("data-field",t),e.node.setAttribute("data-caption",e.nodeData.caption),e.node.setAttribute("data-type",e.nodeData.type);var p=r.getFieldByName(t,this.parent.dataSourceSettings.formatSettings);e.node.setAttribute("data-formatString",p?p.format:"");var h=sf.base.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("dragField")},className:f+" e-drag"}),u=sf.base.createElement("div",{className:" e-iconspace"});sf.base.prepend([h],e.node.querySelector(".e-text-content")),sf.base.append([u,e.node.querySelector("."+C)],e.node.querySelector(".e-text-content")),this.getMenuItems(this.parent.engineModule.fieldList[t].type).length<=0?sf.base.removeClass([e.node.querySelector("."+C)],f):e.node.querySelector("."+C).setAttribute("title",this.parent.localeObj.getConstant("format")),this.parent.engineModule.fieldList[t].aggregateType===vt&&(e.node.querySelector("."+C).setAttribute("title",this.parent.localeObj.getConstant("remove")),sf.base.addClass([e.node.querySelector("."+C)],O),sf.base.addClass([e.node.querySelector(".e-iconspace")],["e-edit",f,"e-list-icon"]),e.node.querySelector(".e-edit").setAttribute("title",this.parent.localeObj.getConstant("edit")),e.node.querySelector(".e-edit").setAttribute("aria-disabled","false"),e.node.querySelector(".e-edit").setAttribute("tabindex","-1"),sf.base.removeClass([e.node.querySelector("."+C)],C),sf.base.removeClass([e.node.querySelector(".e-iconspace")],"e-iconspace"))}},e.prototype.createTypeContainer=function(e){for(var t=sf.base.createElement("div",{id:this.parentID+"control_wrapper",className:"e-pivot-treeview-outer"}),i=this.getMenuItems(this.parent.engineModule.fieldList[e].type),a=0;a<i.length;a++){var s=sf.base.createElement("input",{id:this.parentID+"radio"+e+i[a],attrs:{type:"radio","data-ftxt":e,"data-value":i[a]},className:"e-pivot-calc-radio"});t.appendChild(s)}return t},e.prototype.getMenuItems=function(e,t){for(var i=sf.base.isNullOrUndefined(t)?this.parent.aggregateTypes:t,a=[],s=this.getValidSummaryType(),r=0;r<i.length;r++)s.indexOf(i[r])>-1&&a.indexOf(i[r])<0&&(("Count"!==i[r]&&"DistinctCount"!==i[r]||"number"===e)&&"number"!==e||a.push(i[r]));return a},e.prototype.getValidSummaryType=function(){return["Count","DistinctCount","Sum","Avg","Median","Min","Max","Product","SampleStDev","PopulationStDev","SampleVar",mt]},e.prototype.getAccordionData=function(e){for(var t=[],i=Object.keys(e.engineModule.fieldList),a=0,s=i.length;a<s;a++){var r=i[a];t.push({header:"<input id="+this.parentID+"_"+a+' class=e-pivot-calc-check type="checkbox" data-field='+r+" data-caption="+this.parent.engineModule.fieldList[r].caption+" data-type="+this.parent.engineModule.fieldList[r].type+"/>",content:this.parent.engineModule.fieldList[r].aggregateType===vt||this.getMenuItems(this.parent.engineModule.fieldList[r].type).length<1?"":this.createTypeContainer(r).outerHTML,iconCss:this.parent.engineModule.fieldList[r].aggregateType===vt?"e-list-icon "+(this.isEdit&&this.currentFieldName===r?"e-edited":"e-edit"):""})}return t},e.prototype.renderMobileLayout=function(e){var t=this;e.items[4].content=this.renderDialogElements().outerHTML,e.dataBind(),"olap"===this.parent.dataType&&this.parent.isAdaptive&&null!==this.parent.dialogRenderer.parentElement.querySelector("."+w)&&this.createOlapDropElements();var i=new sf.buttons.Button({cssClass:y,isPrimary:!0});if(i.isStringTemplate=!0,i.appendTo("#"+this.parentID+"cancelBtn"),i.element&&(i.element.onclick=this.cancelBtnClick.bind(this)),null!==this.parent.dialogRenderer.parentElement.querySelector("."+w)&&this.parent.isAdaptive){var a=new sf.buttons.Button({cssClass:y+" e-outline",isPrimary:!0});if(a.isStringTemplate=!0,a.appendTo("#"+this.parentID+"okBtn"),this.inputObj=new sf.inputs.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("fieldName"),change:function(e){t.fieldText=e.value,t.formulaText=sf.base.select("#"+t.parentID+"droppable",document).value}}),this.inputObj.isStringTemplate=!0,this.inputObj.appendTo("#"+this.parentID+"ddlelement"),"pivot"===this.parent.dataType){var s=new sf.inputs.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("numberFormatString"),change:function(e){t.formatText=e.value,t.formulaText=sf.base.select("#"+t.parentID+"droppable",document).value}});s.isStringTemplate=!0,s.appendTo("#"+this.parentID+"Custom_Format_Element"),null!==this.formatText&&null!==this.parent.dialogRenderer.parentElement.querySelector(".e-custom-format-input")&&(this.parent.dialogRenderer.parentElement.querySelector(".e-custom-format-input").value=this.formatText,s.value=this.formatText)}if(null!==this.formulaText&&null!==sf.base.select("#"+this.parentID+"droppable",this.parent.dialogRenderer.parentElement))sf.base.select("#"+this.parentID+"droppable",this.parent.dialogRenderer.parentElement).value=this.formulaText;null!==this.fieldText&&null!==this.parent.dialogRenderer.parentElement.querySelector("."+S)&&(this.parent.dialogRenderer.parentElement.querySelector("."+S).value=this.fieldText,this.inputObj.value=this.fieldText),a.element&&(a.element.onclick=this.applyFormula.bind(this))}else if(this.parent.isAdaptive){var r=new sf.buttons.Button({cssClass:y,isPrimary:!0});r.isStringTemplate=!0,r.appendTo("#"+this.parentID+"addBtn"),"olap"===this.parent.dataType?(this.treeObj=new sf.navigations.TreeView({fields:{dataSource:this.getFieldListData(this.parent),id:"id",text:"caption",parentID:"pid",iconCss:"spriteCssClass"},showCheckBox:!0,autoCheck:!1,sortOrder:"None",enableRtl:this.parent.enableRtl,nodeClicked:this.fieldClickHandler.bind(this),drawNode:this.drawTreeNode.bind(this),nodeExpanding:this.updateNodeIcon.bind(this),nodeCollapsed:this.updateNodeIcon.bind(this),nodeSelected:function(e){sf.base.removeClass([e.node],"e-active"),e.cancel=!0}}),this.treeObj.isStringTemplate=!0,this.treeObj.appendTo("#"+this.parentID+"accordDiv")):(this.accordion=new sf.navigations.Accordion({items:this.getAccordionData(this.parent),enableRtl:this.parent.enableRtl,expanding:this.accordionExpand.bind(this),clicked:this.accordionClickHandler.bind(this),created:this.accordionCreated.bind(this)}),this.accordion.isStringTemplate=!0,this.accordion.appendTo("#"+this.parentID+"accordDiv"),this.updateType()),r.element&&(r.element.onclick=this.addBtnClick.bind(this))}},e.prototype.accordionExpand=function(e){if(0===e.element.querySelectorAll(".e-radio-wrapper").length)for(var t=Object.keys(this.parent.engineModule.fieldList),i=0,a=t.length;i<a;i++){var s=t[i],r="number"!==this.parent.engineModule.fieldList[s].type?["Count","DistinctCount"]:["Sum","Count","Avg","Median","Min","Max","DistinctCount","Product","SampleStDev","PopulationStDev","SampleVar",mt],n=void 0;if(s===e.element.querySelector("[data-field").getAttribute("data-field"))for(var o=0;o<r.length;o++)(n=new sf.buttons.RadioButton({label:this.parent.localeObj.getConstant(r[o]),name:"AggregateType"+s,checked:e.element.querySelector("[data-type").getAttribute("data-type")===r[o],change:this.onChange.bind(this)})).isStringTemplate=!0,n.appendTo("#"+this.parentID+"radio"+s+r[o])}},e.prototype.onChange=function(e){var t=e.event.target.parentElement.querySelector(".e-label").innerText,i=e.event.target.closest(".e-acrdn-item").querySelector("[data-field").getAttribute("data-caption");e.event.target.closest(".e-acrdn-item").querySelector(".e-label").innerText=i+" ("+t+")",e.event.target.closest(".e-acrdn-item").querySelector("[data-type").setAttribute("data-type",e.event.target.getAttribute("data-value"))},e.prototype.updateType=function(){for(var e=Object.keys(this.parent.engineModule.fieldList),t=0,i=e.length;t<i;t++){var a=e[t],s=null;s="number"===this.parent.engineModule.fieldList[a].type&&"include"!==this.parent.engineModule.fieldList[a].type&&"exclude"!==this.parent.engineModule.fieldList[a].type||"DistinctCount"===this.parent.engineModule.fieldList[a].aggregateType?void 0!==this.parent.engineModule.fieldList[a].aggregateType?this.parent.engineModule.fieldList[a].aggregateType:"Sum":"Count";var r=new sf.buttons.CheckBox({label:this.parent.engineModule.fieldList[a].caption+" ("+this.parent.localeObj.getConstant(s)+")"});r.isStringTemplate=!0,r.appendTo("#"+this.parentID+"_"+t),sf.base.select("#"+this.parentID+"_"+t,document).setAttribute("data-field",a),sf.base.select("#"+this.parentID+"_"+t,document).setAttribute("data-type",s)}},e.prototype.cancelBtnClick=function(){this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)},e.prototype.addBtnClick=function(){var e="",t=null,i=null;if("pivot"===this.parent.dataType){for(var a=document.querySelectorAll(".e-accordion .e-check"),s=0;s<a.length;s++)if(t=a[s].parentElement.querySelector("[data-field]").getAttribute("data-field"),-1===(i=a[s].parentElement.querySelector("[data-field]").getAttribute("data-type")).indexOf(vt))e=e+'"'+i+"("+t+')"';else for(var r=0;r<this.parent.dataSourceSettings.calculatedFieldSettings.length;r++)if(this.parent.dataSourceSettings.calculatedFieldSettings[r].name===t){e+=this.parent.dataSourceSettings.calculatedFieldSettings[r].formula;break}}else for(var n=this.treeObj.getAllCheckedNodes(),o=this.parent.olapEngineModule,l=0,d=n;l<d.length;l++){var p=d[l];e+=o.fieldList[p]&&o.fieldList[p].type===vt?o.fieldList[p].tag:p}this.formulaText=null!==this.formulaText?this.formulaText+e:e,this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)},e.prototype.createCalculatedFieldDialog=function(e){if(this.parent.isAdaptive&&"pivotfieldlist"===this.parent.getModuleName())this.renderAdaptiveLayout(!e||void 0===e.edit||e.edit),this.isEdit=e&&void 0!==e.edit?e.edit:this.isEdit;else if(!this.parent.isAdaptive){if(this.isEdit=!(!e||void 0===e.edit)&&e.edit,this.renderDialogLayout(),e&&e.edit){var t=this.treeObj.element.querySelector('li[data-field="'+e.fieldName+'"]');if(t)if(sf.base.addClass([t],["e-active","e-node-focus"]),t.setAttribute("aria-selected","true"),t.id=this.treeObj.element.id+"_active","pivot"===this.parent.dataType){var i={event:{target:t.querySelector(".e-list-icon.e-edit.e-icons")}};this.fieldClickHandler(i)}else this.displayMenu(t)}this.dialog.element.style.top=parseInt(this.dialog.element.style.top,10)<0?"0px":this.dialog.element.style.top}},e.prototype.renderDialogLayout=function(){if(this.newFields=sf.base.extend([],this.parent.dataSourceSettings.calculatedFieldSettings,null,!0),this.createDialog(),this.dialog.content=this.renderDialogElements(),this.dialog.refresh(),this.inputObj=new sf.inputs.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("fieldName")}),this.inputObj.isStringTemplate=!0,this.inputObj.appendTo("#"+this.parentID+"ddlelement"),"pivot"===this.parent.dataType){var e=new sf.inputs.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("numberFormatString")});e.isStringTemplate=!0,e.appendTo("#"+this.parentID+"Custom_Format_Element")}"olap"!==this.parent.dataType||this.parent.isAdaptive||this.createOlapDropElements(),this.createTreeView(),this.droppable=new sf.base.Droppable(sf.base.select("#"+this.parentID+"droppable")),this.keyboardEvents=new sf.base.KeyboardEvents(this.parent.calculatedFieldModule.dialog.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:{moveRight:"rightarrow",enter:"enter",shiftE:"shift+E",delete:"delete"},eventName:"keydown"})},e.prototype.createConfirmDialog=function(e,t,i,a,s){var r=sf.base.createElement("div",{id:this.parentID+"_ErrorDialog",className:"e-pivot-error-dialog"});this.parent.element.appendChild(r),this.confirmPopUp=new sf.popups.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,showCloseIcon:!0,enableRtl:this.parent.enableRtl,width:"auto",height:"auto",position:{X:"center",Y:"center"},buttons:[{click:a?this.removeCalcField.bind(this,s):this.replaceFormula.bind(this,i),buttonModel:{cssClass:"e-ok-btn e-flat e-primary",content:a?this.parent.localeObj.getConstant("yes"):this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:this.removeErrorDialog.bind(this),buttonModel:{cssClass:"e-cancel-btn",content:a?this.parent.localeObj.getConstant("no"):this.parent.localeObj.getConstant("cancel"),isPrimary:!0}}],header:e,content:t,isModal:!0,visible:!0,closeOnEscape:!0,target:document.body,close:this.removeErrorDialog.bind(this)}),this.confirmPopUp.isStringTemplate=!0,this.confirmPopUp.appendTo(r)},e.prototype.replaceFormula=function(e){var t=this.parent.dataSourceSettings;if("olap"===this.parent.dataType){for(var i=0;i<t.calculatedFieldSettings.length;i++)if(t.calculatedFieldSettings[i].name===e.name){sf.base.isNullOrUndefined(e.hierarchyUniqueName)||(t.calculatedFieldSettings[i].hierarchyUniqueName=e.hierarchyUniqueName),t.calculatedFieldSettings[i].formatString=e.formatString,t.calculatedFieldSettings[i].formula=e.formula,this.parent.lastCalcFieldInfo=t.calculatedFieldSettings[i];break}}else for(var a=0;a<t.values.length;a++)if(t.values[a].type===vt&&t.values[a].name===e.name)for(i=0;i<t.calculatedFieldSettings.length;i++)t.calculatedFieldSettings[i].name===e.name&&(t.calculatedFieldSettings[i].formula=e.formula,this.parent.lastCalcFieldInfo=t.calculatedFieldSettings[i],this.updateFormatSettings(t,e.name,e.formatString));this.addFormula(t,e.name),this.removeErrorDialog()},e.prototype.removeErrorDialog=function(){document.getElementById(this.parentID+"_ErrorDialog")&&sf.base.remove(document.getElementById(this.parentID+"_ErrorDialog").parentElement)},e.prototype.addEventListener=function(){this.parent.isDestroyed||this.parent.on("init-calculatedfield",this.createCalculatedFieldDialog,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off("init-calculatedfield",this.createCalculatedFieldDialog)},e.prototype.destroy=function(){this.removeEventListener()},e}();ft.Inject(bt);var St=function(){function e(e){this.parent=e,this.addEventListener()}return e.prototype.getModuleName=function(){return"fieldlist"},e.prototype.initiateModule=function(){this.element=sf.base.createElement("div",{id:this.parent.element.id+"_PivotFieldList",styles:"position:"+(this.parent.enableRtl?"static":"absolute")+";height:0;width:"+this.parent.element.style.width+";display:none"});var e=sf.base.createElement("div",{id:this.parent.element.id+"containerwrapper",styles:"height:"+this.parent.element.parentElement.getBoundingClientRect().height+"px"});this.parent.element.parentElement.appendChild(e),e.appendChild(this.element),e.appendChild(this.parent.element),this.parent.pivotFieldListModule=new ft({dataSourceSettings:{providerType:this.parent.dataSourceSettings.providerType,rows:[],columns:[],values:[],filters:[]},spinnerTemplate:this.parent.spinnerTemplate,allowDeferLayoutUpdate:this.parent.allowDeferLayoutUpdate,renderMode:"Popup",allowCalculatedField:this.parent.allowCalculatedField,showValuesButton:this.parent.showValuesButton,enableRtl:this.parent.enableRtl,locale:this.parent.locale,target:this.parent.element.parentElement,aggregateTypes:this.parent.aggregateTypes,maxNodeLimitInMemberEditor:this.parent.maxNodeLimitInMemberEditor,aggregateCellInfo:this.parent.bindTriggerEvents.bind(this.parent)}),this.parent.pivotFieldListModule.isPopupView=!0,this.parent.pivotFieldListModule.pivotGridModule=this.parent,this.parent.pivotFieldListModule.appendTo("#"+this.element.id)},e.prototype.updateControl=function(){this.element&&(this.element.style.display="block",sf.base.prepend([this.element],this.parent.element),this.parent.showGroupingBar&&this.parent.groupingBarModule?(clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.update.bind(this))):sf.base.isNullOrUndefined(this.element.querySelector(".e-toggle-field-list"))||(sf.base.setStyleAttribute(this.element.querySelector(".e-toggle-field-list"),{left:"auto"}),this.parent.enableRtl?sf.base.removeClass([this.element.querySelector(".e-toggle-field-list")],"e-fieldlist-left"):sf.base.addClass([this.element.querySelector(".e-toggle-field-list")],"e-fieldlist-left")),sf.base.setStyleAttribute(this.element,{width:sf.base.formatUnit(this.parent.element.offsetWidth)})),this.parent.pivotFieldListModule.update(this.parent)},e.prototype.update=function(){var e;if((e="Table"!==this.parent.currentView?this.parent.chart?this.parent.chartModule.calculatedWidth:e:this.parent.grid?this.parent.grid.element.offsetWidth:e)&&!sf.base.isNullOrUndefined(this.element.querySelector(".e-toggle-field-list"))){var t=e<400?400:e;sf.base.setStyleAttribute(this.element.querySelector(".e-toggle-field-list"),{left:sf.base.formatUnit(this.parent.enableRtl?-Math.abs(t-this.element.querySelector(".e-toggle-field-list").offsetWidth):t-this.element.querySelector(".e-toggle-field-list").offsetWidth)}),this.parent.enableRtl?sf.base.addClass([this.element.querySelector(".e-toggle-field-list")],"e-fieldlist-left"):sf.base.removeClass([this.element.querySelector(".e-toggle-field-list")],"e-fieldlist-left")}},e.prototype.addEventListener=function(){this.handlers={load:this.initiateModule,update:this.updateControl},this.parent.isDestroyed||(this.parent.on("init-groupingbar",this.handlers.load,this),this.parent.on(d,this.handlers.update,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("init-groupingbar",this.handlers.load),this.parent.off(d,this.handlers.update))},e.prototype.destroy=function(){this.removeEventListener(),this.parent.pivotFieldListModule&&this.parent.pivotFieldListModule.destroy()},e}(),yt=function(){function e(e){this.parent=e}return e.prototype.render=function(){!this.parent.pivotButtonModule||this.parent.pivotButtonModule&&this.parent.pivotButtonModule.isDestroyed?new pt(this.parent):this.parent.pivotButtonModule;this.createPivotButtons();for(var e=[],t=0,i=this.parent.element.querySelectorAll(".e-group-rows");t<i.length;t++){var a=i[t];a.classList.contains("e-group-chart-rows")||(e=e.concat([].slice.call(a.querySelectorAll(".e-pvt-btn-div"))))}for(var s=e.length,r=0;r<s;r++){var n=sf.base.createElement("span",{className:"e-indent-div",styles:"width:"+24*r+"px"});sf.base.prepend([n],e[r])}},e.prototype.createPivotButtons=function(){for(var e=[this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.values,this.parent.dataSourceSettings.filters],t=0,i=this.parent.element.querySelectorAll(".e-group-rows,.e-group-columns,.e-group-values,.e-group-filters");t<i.length;t++){var a=i[t];this.parent.dataSourceSettings.values.length>0&&a.classList.contains("e-group-chart-values")&&this.parent.dataSourceSettings.columns.length>0&&a.classList.contains("e-group-chart-columns")||(a.innerHTML="")}for(var s=["rows","columns","values","filters"],r=0,n=e.length;r<n;r++)if(e[r]){var o={field:e[r],axis:s[r].toString()};this.parent.notify("pivot-button-update",o)}},e}(),Ct=function(){function e(e){this.parent=e,this.parent.groupingBarModule=this,this.resColWidth=this.parent.isAdaptive?180:249,this.addEventListener(),this.parent.axisFieldModule=new yt(this.parent),this.touchObj=new sf.base.Touch(this.parent.element,{tapHold:this.tapHoldHandler.bind(this)})}return e.prototype.getModuleName=function(){return"groupingbar"},e.prototype.renderLayout=function(){this.groupingTable=sf.base.createElement("div",{className:"e-grouping-bar"}),this.leftAxisPanel=sf.base.createElement("div",{className:"e-left-axis-fields"}),this.rightAxisPanel=sf.base.createElement("div",{className:"e-right-axis-fields"});var e=sf.base.createElement("div",{className:"e-axis-row e-axiswrapper"}),t=sf.base.createElement("div",{className:"e-axis-column e-axiswrapper"}),i=sf.base.createElement("div",{className:"e-axis-value e-axiswrapper"}),a=sf.base.createElement("div",{className:"e-axis-filter e-axiswrapper"});this.rowPanel=sf.base.createElement("div",{className:"e-group-rows e-rows"}),this.columnPanel=sf.base.createElement("div",{className:"e-group-columns e-columns"}),this.valuePanel=sf.base.createElement("div",{className:"e-group-values e-values"}),this.filterPanel=sf.base.createElement("div",{className:"e-group-filters e-filters"}),e.appendChild(this.rowPanel),t.appendChild(this.columnPanel),i.appendChild(this.valuePanel),a.appendChild(this.filterPanel),this.rowAxisPanel=e,this.columnAxisPanel=t,this.valueAxisPanel=i,this.filterAxisPanel=a,this.leftAxisPanel.appendChild(i),this.leftAxisPanel.appendChild(e),this.rightAxisPanel.appendChild(a),this.rightAxisPanel.appendChild(t),this.groupingTable.appendChild(this.leftAxisPanel),this.groupingTable.appendChild(this.rightAxisPanel),this.groupingTable.classList.add("e-pivot-grouping-bar"),this.groupingTable.querySelector(".e-group-rows").classList.add("e-group-pivot-rows");for(var s=0,r=[this.rowPanel,this.columnPanel,this.valuePanel,this.filterPanel];s<r.length;s++){var n=r[s];this.parent.groupingBarSettings.allowDragAndDrop&&new sf.base.Droppable(n,{}),this.unWireEvent(n),this.wireEvent(n)}"Table"!==this.parent.displayOption.view&&"Table"!==this.parent.groupingBarSettings.displayMode?(this.groupingChartTable=this.groupingTable.cloneNode(!0),this.groupingChartTable.classList.add("e-chart-grouping-bar"),this.groupingChartTable.classList.remove("e-pivot-grouping-bar"),this.groupingChartTable.querySelector(".e-group-rows").classList.add("e-group-chart-rows"),this.groupingChartTable.querySelector(".e-group-rows").classList.remove("e-group-pivot-rows"),this.parent.chartSettings.enableMultiAxis&&this.parent.chartSettings.chartSeries&&["Pie","Pyramid","Doughnut","Funnel"].indexOf(this.parent.chartSettings.chartSeries.type)<0?this.groupingChartTable.querySelector(".e-group-values").classList.add("e-group-chart-multi-values"):(this.groupingChartTable.querySelector(".e-group-values").classList.add("e-group-chart-values"),this.groupingChartTable.querySelector(".e-group-values").classList.remove("e-droppable")),this.parent.chartSettings.chartSeries&&["Pie","Pyramid","Doughnut","Funnel"].indexOf(this.parent.chartSettings.chartSeries.type)>-1?(this.groupingChartTable.querySelector(".e-group-columns").classList.add("e-group-chart-columns"),this.groupingChartTable.querySelector(".e-group-columns").classList.remove("e-droppable")):this.groupingChartTable.querySelector(".e-group-columns").classList.add("e-group-chart-accumulation-column"),this.groupingChartTable.querySelector(".e-group-filters").classList.add("e-group-chart-filters")):this.groupingChartTable=void 0,"Chart"!==this.parent.displayOption.view&&"Chart"!==this.parent.groupingBarSettings.displayMode||(this.groupingTable=void 0)},e.prototype.appendToElement=function(){if((this.parent.element.querySelector(".e-grid")||this.parent.element.querySelector("."+N))&&this.parent.showGroupingBar){if(this.parent.element.querySelector(".e-grouping-bar"))for(var e=0,t=this.parent.element.querySelectorAll(".e-grouping-bar");e<t.length;e++){var i=t[e];sf.base.remove(i)}if(this.groupingChartTable&&(sf.base.select("#"+this.parent.element.id+"_chart",this.parent.element)?(sf.base.setStyleAttribute(this.groupingChartTable,{width:sf.base.formatUnit(this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.getWidthAsNumber())}),this.parent.element.insertBefore(this.groupingChartTable,sf.base.select("#"+this.parent.element.id+"_chart",this.parent.element))):this.groupingChartTable=void 0),"Chart"!==this.parent.displayOption.view&&this.groupingTable){this.parent.isAdaptive&&(this.leftAxisPanel.style.minWidth="180px",this.valuePanel.style.minWidth="180px"),this.parent.firstColWidth&&(this.leftAxisPanel.style.minWidth="auto",this.valuePanel.style.minWidth="auto"),this.filterPanel.removeAttribute("style"),this.columnPanel.removeAttribute("style"),this.rowPanel.removeAttribute("style"),this.filterPanel.removeAttribute("style");var a=void 0;if(a="olap"===this.parent.dataType?this.parent.olapEngineModule.headerContent?Object.keys(this.parent.olapEngineModule.headerContent).length:0:this.parent.engineModule.headerContent?Object.keys(this.parent.engineModule.headerContent).length:0,!sf.base.isNullOrUndefined(a)){var s=this.parent.element.querySelector(".e-frozenheader").querySelector(".e-columnheader");s.removeAttribute("style"),sf.base.addClass([s.querySelector(".e-headercell")],"e-group-row"),s.querySelector(".e-group-row").appendChild(this.rowAxisPanel),s.querySelector(".e-group-row").querySelector(".e-headercelldiv").style.display="none",s.querySelector(".e-group-row").querySelector(".e-sortfilterdiv").style.display="none"}this.parent.element.insertBefore(this.groupingTable,this.parent.element.querySelector(".e-grid")),sf.base.setStyleAttribute(this.groupingTable,{width:sf.base.formatUnit(this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.getWidthAsNumber())}),this.groupingTable.style.minWidth="400px",this.parent.axisFieldModule.render(),this.setGridRowWidth();var r=this.parent.element.querySelector(".e-frozenheader").querySelector("colgroup").children[0],n=sf.base.formatUnit(this.groupingTable.offsetWidth-parseInt(r.style.width,10));sf.base.setStyleAttribute(this.valuePanel,{width:r.style.width}),sf.base.setStyleAttribute(this.rightAxisPanel,{width:n});var o=this.valuePanel.offsetHeight/2;o>this.columnPanel.offsetHeight&&(sf.base.setStyleAttribute(this.filterPanel,{height:sf.base.formatUnit(o)}),sf.base.setStyleAttribute(this.columnPanel,{height:sf.base.formatUnit(o+2)}));var l=this.parent.element.querySelector(".e-headercontent").offsetHeight;sf.base.setStyleAttribute(this.rowPanel,{height:l+"px"}),this.parent.element.querySelector(".e-frozenheader").querySelector(".e-rhandler")&&(this.parent.element.querySelector(".e-frozenheader").querySelector(".e-rhandler").style.height=l+"px");for(var d=[].slice.call(this.parent.element.querySelector(".e-movableheader").querySelector("thead").querySelectorAll("tr")).filter((function(e){return e.childNodes.length>0})),p=l/d.length,h=0,u=d;h<u.length;h++){i=u[h];sf.base.setStyleAttribute(i,{height:p+"px"});for(var c=0,g=[].slice.call(i.querySelectorAll(".e-rhandler"));c<g.length;c++){var f=g[c];sf.base.setStyleAttribute(f,{height:p+"px"})}}}else this.parent.axisFieldModule.render();this.parent.showToolbar&&"Both"===this.parent.displayOption.view&&("Table"===this.parent.currentView?this.parent.element.querySelector(".e-chart-grouping-bar").style.display="none":this.parent.element.querySelector(".e-pivot-grouping-bar").style.display="none")}},e.prototype.refreshUI=function(){if(this.groupingChartTable&&sf.base.setStyleAttribute(this.groupingChartTable,{width:sf.base.formatUnit(this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.getWidthAsNumber())}),this.groupingTable){sf.base.setStyleAttribute(this.groupingTable,{width:sf.base.formatUnit(this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.getWidthAsNumber())}),this.groupingTable.style.minWidth="400px";var e=this.parent.element.querySelector(".e-frozenheader").querySelector("colgroup").children[0],t=sf.base.formatUnit(this.groupingTable.offsetWidth-parseInt(e.style.width,10));if(sf.base.setStyleAttribute(this.valuePanel,{width:e.style.width}),sf.base.setStyleAttribute(this.rightAxisPanel,{width:t}),this.parent.showFieldList&&this.parent.pivotFieldListModule&&this.parent.pivotFieldListModule.element&&(clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.alignIcon.bind(this))),!this.parent.grid.element.querySelector(".e-group-row")){var i=this.parent.element.querySelector(".e-frozenheader").querySelector(".e-columnheader");sf.base.addClass([i.querySelector(".e-headercell")],"e-group-row"),sf.base.setStyleAttribute(this.rowPanel,{height:this.parent.element.querySelector(".e-headercontent").offsetHeight+"px"}),i.querySelector(".e-group-row").appendChild(this.rowAxisPanel),sf.base.setStyleAttribute(i.querySelector(".e-group-row").querySelector(".e-headercelldiv"),{display:"none"}),sf.base.setStyleAttribute(i.querySelector(".e-group-row").querySelector(".e-sortfilterdiv"),{display:"none"});var a=this.parent.element.querySelector(".e-headercontent").offsetHeight;sf.base.setStyleAttribute(this.rowPanel,{height:a+"px"}),this.parent.element.querySelector(".e-frozenheader").querySelector(".e-rhandler")&&(this.parent.element.querySelector(".e-frozenheader").querySelector(".e-rhandler").style.height=a+"px");for(var s=[].slice.call(this.parent.element.querySelector(".e-movableheader").querySelector("thead").querySelectorAll("tr")).filter((function(e){return e.childNodes.length>0})),r=a/s.length,n=0,o=s;n<o.length;n++){var l=o[n];sf.base.setStyleAttribute(l,{height:r+"px"});for(var d=0,p=[].slice.call(l.querySelectorAll(".e-rhandler"));d<p.length;d++){var h=p[d];sf.base.setStyleAttribute(h,{height:r+"px"})}}}}},e.prototype.alignIcon=function(){var e,t=this.parent.pivotFieldListModule.element;if(e="Table"===this.parent.currentView?this.parent.grid?this.parent.grid.element.offsetWidth:e:this.parent.chart?this.parent.chartModule.calculatedWidth:e){var i=e<400?400:e;sf.base.setStyleAttribute(t.querySelector(".e-toggle-field-list"),{left:sf.base.formatUnit(this.parent.enableRtl?-Math.abs(i-t.querySelector(".e-toggle-field-list").offsetWidth):i-t.querySelector(".e-toggle-field-list").offsetWidth)})}},e.prototype.setGridRowWidth=function(){var e=this.parent.element.querySelector(".e-frozenheader").querySelector("colgroup").children[0];if(this.rowPanel.querySelector(".e-pivot-button"))if(this.parent.isAdaptive){if(!this.parent.firstColWidth)(t=this.parent.grid.columns)&&t.length>0&&(t[0].width=this.resColWidth),this.parent.posCount=0,this.parent.grid.headerModule.refreshUI()}else{var t,i=[].slice.call(this.rowPanel.querySelectorAll(".e-pvt-btn-div")),a=i[i.length-1],s=a.querySelector(".e-pivot-button").offsetWidth+a.querySelector(".e-indent-div").offsetWidth+20,r=sf.base.formatUnit(s<this.resColWidth?this.resColWidth:s),n=this.parent.element.querySelector(".e-frozenheader").querySelector("table"),o=this.parent.element.querySelector(".e-frozencontent").querySelector("table"),l=this.parent.element.querySelector(".e-frozencontent").querySelector("colgroup").children[0],d=parseInt(r,10);(t=this.parent.grid.columns)&&t.length>0&&(t[0].width=(t[0].width,this.resColWidth,d>this.resColWidth?d:this.resColWidth));var p=void 0;p="olap"===this.parent.dataType?this.parent.renderModule.calculateColWidth(this.parent.olapEngineModule.pivotValues.length>0?this.parent.olapEngineModule.pivotValues[0].length:2):this.parent.renderModule.calculateColWidth(this.parent.dataSourceSettings.values.length>0&&this.parent.engineModule.pivotValues.length>0?this.parent.engineModule.pivotValues[0].length:2);for(var h=0;h<t.length;h++)if(0!==h)if(t[h].columns)this.setColWidth(t[h].columns,p);else if("auto"!==t[h].width){var u=t[h].customAttributes?t[h].customAttributes.cell.valueSort.levelName:"";t[h].width=this.parent.renderModule.setSavedWidth(u,p)}else t[h].minWidth=p;this.parent.posCount=0,this.parent.setGridColumns(this.parent.grid.columns),this.parent.grid.headerModule.refreshUI(),this.parent.firstColWidth||(e.style.width=r,l.style.width=r,n.style.width=r,o.style.width=r,sf.base.setStyleAttribute(n,{width:r}),sf.base.setStyleAttribute(o,{width:r}))}else this.parent.grid.columns&&this.parent.grid.columns.length>0&&(this.parent.grid.columns[0].width=this.parent.grid.columns[0].width>this.resColWidth?this.parent.grid.columns[0].width:this.resColWidth),this.parent.grid.headerModule.refreshUI();this.groupingTable&&this.refreshUI()},e.prototype.setColWidth=function(e,t){for(var i=0;i<e.length;i++)e[i].columns?this.setColWidth(e[i].columns,t):"auto"!=e[i].width?e[i].width=t:e[i].minWidth=t},e.prototype.wireEvent=function(e){sf.base.EventHandler.add(e,"mouseover",this.dropIndicatorUpdate,this),sf.base.EventHandler.add(e,"mouseleave",this.dropIndicatorUpdate,this)},e.prototype.unWireEvent=function(e){sf.base.EventHandler.remove(e,"mouseover",this.dropIndicatorUpdate),sf.base.EventHandler.remove(e,"mouseleave",this.dropIndicatorUpdate)},e.prototype.dropIndicatorUpdate=function(e){(this.parent.isDragging&&e.target.classList.contains("e-droppable")&&"mouseover"===e.type||"mouseleave"===e.type)&&(sf.base.removeClass([].slice.call(this.parent.element.querySelectorAll(".e-drop-indicator")),"e-drop-hover"),sf.base.removeClass([].slice.call(this.parent.element.querySelectorAll(".e-drop-indicator-last")),"e-drop-hover"))},e.prototype.tapHoldHandler=function(e){var t=sf.base.closest(e.originalEvent.target,".e-pivot-button");if(!sf.base.isNullOrUndefined(t)&&this.parent.isAdaptive){var i=t.getBoundingClientRect();return this.parent.contextMenuModule.fieldElement=t,void this.parent.contextMenuModule.menuObj.open(i.top,i.left)}},e.prototype.addEventListener=function(){this.handlers={load:this.renderLayout,end:this.appendToElement},this.parent.isDestroyed||(this.parent.on("init-groupingbar",this.handlers.load,this),this.parent.on(d,this.handlers.end,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(d,this.handlers.end),this.parent.off("init-groupingbar",this.handlers.load))},e.prototype.destroy=function(){this.removeEventListener(),this.parent.pivotButtonModule&&this.parent.pivotButtonModule.destroy(),this.touchObj&&!this.touchObj.isDestroyed&&this.touchObj.destroy(),this.parent.element.querySelector(".e-grouping-bar")&&sf.base.remove(this.parent.element.querySelector(".e-grouping-bar"))},e}(),wt=function(){function e(e){this.parent=e,this.parent.conditionalFormattingModule=this,this.parentID=this.parent.element.id,this.dialog=null,this.fieldsDropDown=[],this.conditionsDropDown=[],this.fontNameDropDown=[],this.fontSizeDropDown=[],this.fontColor=[],this.backgroundColor=[],this.newFormat=[]}return e.prototype.getModuleName=function(){return"conditionalformatting"},e.prototype.createDialog=function(){null!==sf.base.select("#"+this.parentID+"conditionalformatting",document)&&sf.base.remove(sf.base.select("#"+this.parentID+"conditionalformatting",document)),this.parent.element.appendChild(sf.base.createElement("div",{id:this.parentID+"conditionalformatting"}));var e=[{click:this.addButtonClick.bind(this),buttonModel:{cssClass:this.parent.isAdaptive?"e-small e-round e-format-condition-button":"e-format-condition-button",iconCss:f+" e-add-icon",content:this.parent.isAdaptive?"":this.parent.localeObj.getConstant("condition")}},{click:this.applyButtonClick.bind(this),buttonModel:{cssClass:"e-flat e-primary e-format-apply-button",content:this.parent.localeObj.getConstant("apply")}},{click:this.cancelButtonClick.bind(this),buttonModel:{cssClass:"e-flat e-primary e-format-cancel-button",content:this.parent.localeObj.getConstant("cancel")}}];this.parent.isAdaptive?this.dialog=new sf.popups.Dialog({animationSettings:{effect:"Zoom"},isModal:!0,width:"100%",height:"100%",showCloseIcon:!1,closeOnEscape:!1,enableRtl:this.parent.enableRtl,position:{X:"center",Y:"center"},allowDragging:!0,buttons:e,beforeOpen:this.beforeOpen.bind(this),close:this.removeDialog.bind(this),cssClass:"e-pivot-formatting-dialog",header:this.parent.localeObj.getConstant("conditionalFormating"),target:document.body}):this.dialog=new sf.popups.Dialog({allowDragging:!0,position:{X:"center",Y:this.parent.element.offsetTop},buttons:e,beforeOpen:this.beforeOpen.bind(this),close:this.removeDialog.bind(this),cssClass:"e-pivot-formatting-dialog",isModal:!1,closeOnEscape:!0,enableRtl:this.parent.enableRtl,showCloseIcon:!0,header:this.parent.localeObj.getConstant("conditionalFormating"),target:this.parent.element}),this.dialog.isStringTemplate=!0,this.dialog.appendTo("#"+this.parentID+"conditionalformatting")},e.prototype.beforeOpen=function(e){this.dialog.element.querySelector(".e-dlg-header").setAttribute("title",this.parent.localeObj.getConstant("conditionalFormating"))},e.prototype.addButtonClick=function(){var e=this,t=this;this.parent.trigger("conditionalFormatting",{conditions:"LessThan",value1:0,applyGrandTotals:!0,style:{backgroundColor:"white",color:"black",fontFamily:"Arial",fontSize:"12px"}},(function(i){t.refreshConditionValues(),e.destroyColorPickers(),t.newFormat.push(i),t.addFormat()}))},e.prototype.applyButtonClick=function(){this.refreshConditionValues()&&(this.parent.setProperties({dataSourceSettings:{conditionalFormatSettings:this.newFormat}},!0),this.parent.renderPivotGrid(),this.dialog.close())},e.prototype.cancelButtonClick=function(){this.dialog.close(),this.newFormat=[]},e.prototype.refreshConditionValues=function(){for(var e=0;e<this.newFormat.length;e++){if(""===sf.base.select("#"+this.parentID+"conditionvalue1"+e,document).value||""===sf.base.select("#"+this.parentID+"conditionvalue2"+e,document).value)return""===sf.base.select("#"+this.parentID+"conditionvalue1"+e,document).value?sf.base.select("#"+this.parentID+"conditionvalue1"+e,document).focus():sf.base.select("#"+this.parentID+"conditionvalue2"+e,document).focus(),!1;this.newFormat[e].value1=Number(sf.base.select("#"+this.parentID+"conditionvalue1"+e,document).value),this.newFormat[e].value2=Number(sf.base.select("#"+this.parentID+"conditionvalue2"+e,document).value)}return!0},e.prototype.addFormat=function(){for(var e=sf.base.createElement("div",{id:this.parentID+"formatDiv",className:"e-new-format"}),t=0;t<this.newFormat.length;t++)e.appendChild(this.createDialogElements(t));if(0===this.newFormat.length){var i=this.createDialogElements(),a=sf.base.createElement("p",{id:this.parentID+"emptyFormat",className:"e-pivot-conditional-empty-format",innerHTML:this.parent.localeObj.getConstant("emptyFormat")});i.appendChild(a),e.appendChild(i)}this.dialog.setProperties({content:e},!1);for(t=0;t<this.newFormat.length;t++)this.renderDropDowns(t),this.renderColorPicker(t)},e.prototype.createDialogElements=function(e){var t=sf.base.createElement("div",{id:this.parentID+"outerDiv"+e,className:"e-format-outer-div"});if(void 0!==e){var i=this.newFormat[e],a=sf.base.createElement("button",{id:this.parentID+"removeButton"+e,className:"e-format-delete-button",attrs:{type:"button",title:this.parent.localeObj.getConstant("delete")}});t.appendChild(a);var s=sf.base.createElement("div",{id:this.parentID+"innerDiv",className:"e-format-inner-div"}),r=sf.base.createElement("table",{id:this.parentID+"cftable",className:"e-format-table"}),n=sf.base.createElement("tr"),o=sf.base.createElement("td"),l=sf.base.createElement("span",{id:this.parentID+"valuelabel"+e,className:"e-format-value-label",innerHTML:this.parent.localeObj.getConstant("value")});o.appendChild(l),n.appendChild(o),r.appendChild(n),n=sf.base.createElement("tr"),o=sf.base.createElement("td");var d=sf.base.createElement("div",{id:this.parentID+"measure"+e}),p=sf.base.createElement("input",{id:this.parentID+"measureinput"+e,attrs:{type:"text",tabindex:"0"}});d.appendChild(p),o.appendChild(d),n.appendChild(o),o=sf.base.createElement("td");var h=sf.base.createElement("div",{id:this.parentID+"condition"}),u=sf.base.createElement("input",{id:this.parentID+"conditioninput"+e,attrs:{type:"text",tabindex:"0"}});h.appendChild(u),o.appendChild(h),n.appendChild(o),o=sf.base.createElement("td");var c="Between"!==i.conditions&&"NotBetween"!==i.conditions?"display:none; width:10px":"",g=sf.base.createElement("input",{id:this.parentID+"conditionvalue1"+e,attrs:{type:"text",tabindex:"0",value:sf.base.isNullOrUndefined(i.value1)?"0":i.value1.toString(),placeholder:this.parent.localeObj.getConstant("emptyInput")},styles:this.parent.isAdaptive?""===c?"width: 35%":"width: 100%":""===c?"width: 45px":"width: 120px",className:T+" e-format-value1"});o.appendChild(g);var f=sf.base.createElement("span",{id:this.parentID+"valuespan"+e,className:"e-format-value-span",innerHTML:"&",styles:c});o.appendChild(f);var m=sf.base.createElement("input",{id:this.parentID+"conditionvalue2"+e,attrs:{type:"text",tabindex:"0",value:sf.base.isNullOrUndefined(i.value2)?"0":i.value2.toString(),placeholder:this.parent.localeObj.getConstant("emptyInput")},styles:this.parent.isAdaptive&&""===c?"width: 35%":""===c?"width: 45px":c,className:T+" e-format-value2"});o.appendChild(m),n.appendChild(o),r.appendChild(n),this.parent.isAdaptive&&(s.appendChild(r),r=sf.base.createElement("table",{id:this.parentID+"cftable",className:"e-format-table"})),n=sf.base.createElement("tr"),o=sf.base.createElement("td");var v=sf.base.createElement("span",{id:this.parentID+"formatlabel"+e,className:"e-format-label",innerHTML:this.parent.localeObj.getConstant("formatLabel")});o.appendChild(v),n.appendChild(o),r.appendChild(n),n=sf.base.createElement("tr"),o=sf.base.createElement("td");var b=sf.base.createElement("div",{id:this.parentID+"fontname"}),S=sf.base.createElement("input",{id:this.parentID+"fontnameinput"+e,attrs:{type:"text",tabindex:"0"}});b.appendChild(S),o.appendChild(b),n.appendChild(o),o=sf.base.createElement("td");var y=sf.base.createElement("div",{id:this.parentID+"fontsize"}),C=sf.base.createElement("input",{id:this.parentID+"fontsizeinput"+e,attrs:{type:"text",tabindex:"0"}});y.appendChild(C),o.appendChild(y),n.appendChild(o),this.parent.isAdaptive&&(r.appendChild(n),n=sf.base.createElement("tr"),r.appendChild(n),n=sf.base.createElement("tr")),o=sf.base.createElement("td");var w=sf.base.createElement("input",{id:this.parentID+"fontcolor"+e,attrs:{type:"color",tabindex:"0"},className:"e-format-font-color"});o.appendChild(w);var x=sf.base.createElement("input",{id:this.parentID+"backgroundcolor"+e,attrs:{type:"color",tabindex:"0"},className:"e-format-back-color"});o.appendChild(x),n.appendChild(o),o=sf.base.createElement("td");var M=sf.base.createElement("div",{id:this.parentID+"valuepreview"+e,className:T+" e-format-value-preview",innerHTML:"123.45"});o.appendChild(M),n.appendChild(o),r.appendChild(n),s.appendChild(r),t.appendChild(s)}return t},e.prototype.renderDropDowns=function(e){var t=this.newFormat[e],i=[];i.push({index:0,name:this.parent.localeObj.getConstant("AllValues"),field:this.parent.localeObj.getConstant("AllValues")});for(var a=0;a<this.parent.dataSourceSettings.values.length;a++)i.push({index:a+1,name:this.parent.dataSourceSettings.values[a].caption||this.parent.dataSourceSettings.values[a].name,field:this.parent.dataSourceSettings.values[a].name});var s=sf.base.isNullOrUndefined(t.measure)?this.parent.localeObj.getConstant("AllValues"):t.measure;this.fieldsDropDown[e]=new sf.dropdowns.DropDownList({dataSource:i,fields:{text:"name",value:"field"},value:s,width:this.parent.isAdaptive?"100%":"120px",popupHeight:"200px",popupWidth:"auto",change:this.measureChange.bind(this,e)}),this.fieldsDropDown[e].isStringTemplate=!0,this.fieldsDropDown[e].appendTo("#"+this.parentID+"measureinput"+e);var r=[{value:"LessThan",name:this.parent.localeObj.getConstant("LessThan")},{value:"LessThanOrEqualTo",name:this.parent.localeObj.getConstant("LessThanOrEqualTo")},{value:"GreaterThan",name:this.parent.localeObj.getConstant("GreaterThan")},{value:"GreaterThanOrEqualTo",name:this.parent.localeObj.getConstant("GreaterThanOrEqualTo")},{value:"Equals",name:this.parent.localeObj.getConstant("Equals")},{value:"NotEquals",name:this.parent.localeObj.getConstant("NotEquals")},{value:"Between",name:this.parent.localeObj.getConstant("Between")},{value:"NotBetween",name:this.parent.localeObj.getConstant("NotBetween")}];s=sf.base.isNullOrUndefined(t.conditions)?"LessThan":t.conditions,this.conditionsDropDown[e]=new sf.dropdowns.DropDownList({dataSource:r,fields:{value:"value",text:"name"},value:s,width:this.parent.isAdaptive?"100%":"120px",popupHeight:"200px",popupWidth:"auto",change:this.conditionChange.bind(this,e)}),this.conditionsDropDown[e].isStringTemplate=!0,this.conditionsDropDown[e].appendTo("#"+this.parentID+"conditioninput"+e);s=sf.base.isNullOrUndefined(t.style.fontFamily)?"Arial":t.style.fontFamily,this.fontNameDropDown[e]=new sf.dropdowns.DropDownList({dataSource:[{index:0,name:"Arial"},{index:1,name:"San Serif"},{index:2,name:"Impact"},{index:3,name:"Trebuchet MS"},{index:4,name:"Serif"},{index:5,name:"Verdana"},{index:6,name:"Courier New"},{index:7,name:"Times New Roman"},{index:8,name:"Tahoma"},{index:9,name:"Gerogia"}],fields:{text:"name"},value:s,width:this.parent.isAdaptive?"100%":"120px",popupWidth:"150px",popupHeight:"200px",change:this.fontNameChange.bind(this,e)}),this.fontNameDropDown[e].isStringTemplate=!0,this.fontNameDropDown[e].appendTo("#"+this.parentID+"fontnameinput"+e);s=sf.base.isNullOrUndefined(t.style.fontSize)?"12px":t.style.fontSize,this.fontSizeDropDown[e]=new sf.dropdowns.DropDownList({dataSource:[{index:0,name:"9px"},{index:1,name:"10px"},{index:2,name:"11px"},{index:3,name:"12px"},{index:4,name:"13px"},{index:5,name:"14px"},{index:6,name:"15px"},{index:6,name:"16px"}],fields:{text:"name"},popupHeight:"200px",value:s,width:this.parent.isAdaptive?"100%":"120px",change:this.fontSizeChange.bind(this,e)}),this.fontSizeDropDown[e].isStringTemplate=!0,this.fontSizeDropDown[e].appendTo("#"+this.parentID+"fontsizeinput"+e)},e.prototype.conditionChange=function(e,t){this.newFormat[e].conditions=t.value,"Between"===t.value||"NotBetween"===t.value?(sf.base.select("#"+this.parentID+"valuespan"+e,document).style.display="inline-block",sf.base.select("#"+this.parentID+"valuespan"+e,document).style.width=this.parent.isAdaptive?"10%":"10px",sf.base.select("#"+this.parentID+"conditionvalue2"+e,document).style.display="inline-block",sf.base.select("#"+this.parentID+"conditionvalue2"+e,document).style.width=this.parent.isAdaptive?"35%":"45px",sf.base.select("#"+this.parentID+"conditionvalue1"+e,document).style.width=this.parent.isAdaptive?"35%":"45px"):(sf.base.select("#"+this.parentID+"valuespan"+e,document).style.display="none",sf.base.select("#"+this.parentID+"conditionvalue2"+e,document).style.display="none",sf.base.select("#"+this.parentID+"conditionvalue1"+e,document).style.width=this.parent.isAdaptive?"100%":"120px")},e.prototype.fontNameChange=function(e,t){this.newFormat[e].style.fontFamily=t.value.toString(),sf.base.select("#"+this.parentID+"valuepreview"+e,document).style.fontFamily=t.value},e.prototype.fontSizeChange=function(e,t){this.newFormat[e].style.fontSize=t.value.toString(),sf.base.select("#"+this.parentID+"valuepreview"+e,document).style.fontSize=t.value},e.prototype.measureChange=function(e,t){this.newFormat[e].measure=t.value.toString()===this.parent.localeObj.getConstant("AllValues")?void 0:t.value.toString()},e.prototype.renderColorPicker=function(e){var t=this.newFormat[e],i=sf.base.isNullOrUndefined(t.style.color)?"black":t.style.color,a=this.isHex(i.substr(1))?i:this.colourNameToHex(i);sf.base.select("#"+this.parentID+"valuepreview"+e,document).style.color=a,this.fontColor[e]=new sf.inputs.ColorPicker({cssClass:"e-format-color-picker e-format-font-color-picker",value:a,mode:"Palette",change:this.fontColorChange.bind(this,e)}),this.fontColor[e].isStringTemplate=!0,this.fontColor[e].appendTo("#"+this.parentID+"fontcolor"+e),sf.base.addClass([this.fontColor[e].element.nextElementSibling.querySelector(".e-selected-color")],f),i=sf.base.isNullOrUndefined(t.style.backgroundColor)?"white":t.style.backgroundColor,a=this.isHex(i.substr(1))?i:this.colourNameToHex(i),sf.base.select("#"+this.parentID+"valuepreview"+e,document).style.backgroundColor=a,sf.base.select("#"+this.parentID+"valuepreview"+e,document).style.fontFamily=t.style.fontFamily,sf.base.select("#"+this.parentID+"valuepreview"+e,document).style.fontSize=t.style.fontSize,this.backgroundColor[e]=new sf.inputs.ColorPicker({cssClass:"e-format-color-picker",value:a,mode:"Palette",change:this.backColorChange.bind(this,e)}),this.backgroundColor[e].isStringTemplate=!0,this.backgroundColor[e].appendTo("#"+this.parentID+"backgroundcolor"+e),sf.base.addClass([this.backgroundColor[e].element.nextElementSibling.querySelector(".e-selected-color")],f);var s=new sf.buttons.Button({iconCss:f+" e-format-delete-icon",cssClass:y});s.isStringTemplate=!0,s.appendTo("#"+this.parentID+"removeButton"+e),s.element.onclick=this.toggleButtonClick.bind(this,e)},e.prototype.backColorChange=function(e,t){this.newFormat[e].style.backgroundColor=t.currentValue.hex,sf.base.select("#"+this.parentID+"valuepreview"+e,document).style.backgroundColor=t.currentValue.hex},e.prototype.fontColorChange=function(e,t){this.newFormat[e].style.color=t.currentValue.hex,sf.base.select("#"+this.parentID+"valuepreview"+e,document).style.color=t.currentValue.hex},e.prototype.toggleButtonClick=function(e){this.destroyColorPickers(),this.newFormat.splice(e,1),this.addFormat()},e.prototype.isHex=function(e){for(var t=parseInt(e,16);"0"===e.charAt(0);)e=e.substr(1);return t.toString(16)===e.toLowerCase()||0===t&&""===e},e.prototype.hexToRgb=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},e.prototype.colourNameToHex=function(e){var t={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};if(void 0!==t[e.toLowerCase()])return t[e.toLowerCase()];if(0===e.search("rgba")){for(var i=e.substr(5).split(")")[0].split(","),a="",s=0;s<i.length-1;s++)i[s]=(+i[s]).toString(16),1===i[s].length&&(i[s]="0"+i[s]),a+=i[s];return"#"+a+Math.round(255*+i[3]).toString(16)}if(0===e.search("rgb")){for(i=e.substr(4).split(")")[0].split(","),a="",s=0;s<i.length;s++)i[s]=(+i[s]).toString(16),1===i[s].length&&(i[s]="0"+i[s]),a+=i[s];return"#"+a}return"#d5d5d5"},e.prototype.removeDialog=function(){this.dialog&&!this.dialog.isDestroyed&&(this.destroyColorPickers(),this.dialog.destroy()),sf.base.select("#"+this.parentID+"conditionalformatting",document)&&sf.base.remove(sf.base.select("#"+this.parentID+"conditionalformatting",document))},e.prototype.destroyColorPickers=function(){for(var e=0;e<(this.newFormat?this.newFormat.length:0);e++)this.fontColor&&this.fontColor[e]&&!this.fontColor[e].isDestroyed&&this.fontColor[e].destroy(),this.backgroundColor&&this.backgroundColor[e]&&!this.backgroundColor[e].isDestroyed&&this.backgroundColor[e].destroy()},e.prototype.showConditionalFormattingDialog=function(){this.newFormat=[];for(var e=0;e<this.parent.dataSourceSettings.conditionalFormatSettings.length;e++)this.newFormat.push(sf.base.extend({},this.parent.dataSourceSettings.conditionalFormatSettings[e].properties,null,!0));this.createDialog(),this.dialog.refresh(),this.addFormat()},e.prototype.destroy=function(){this.dialog&&!this.dialog.isDestroyed&&this.dialog.close()},e}(),xt=function(){function e(e){this.isMultiAxisChange=!1,this.currentReport="",this.parent=e,this.parent.toolbarModule=this,this.addEventListener()}return e.prototype.getModuleName=function(){return"toolbar"},e.prototype.createToolbar=function(){this.parent.isModified=!1,this.renderDialog(),null!==sf.base.select("#"+this.parent.element.id+"pivot-toolbar",document)&&sf.base.remove(sf.base.select("#"+this.parent.element.id+"pivot-toolbar",document));var e=sf.base.createElement("div",{id:this.parent.element.id+"pivot-toolbar",className:P});this.parent.showFieldList&&sf.base.select("#"+this.parent.element.id+"_PivotFieldList",this.parent.element)?this.parent.element.insertBefore(e,sf.base.select("#"+this.parent.element.id+"_PivotFieldList",this.parent.element)):this.parent.showGroupingBar&&sf.base.select("#"+this.parent.element.id+" .e-pivot-grouping-bar",this.parent.element)?this.parent.element.insertBefore(e,sf.base.select("#"+this.parent.element.id+" .e-pivot-grouping-bar",this.parent.element)):this.parent.element.insertBefore(e,sf.base.select("#"+this.parent.element.id+"_grid",this.parent.element)),this.toolbar=new sf.navigations.Toolbar({created:this.create.bind(this),enableRtl:this.parent.enableRtl,items:this.getItems(),allowKeyboard:!1,width:this.parent.gridSettings.allowAutoResizing?"auto":this.parent.grid?this.parent.getGridWidthAsNumber()-2:this.parent.getWidthAsNumber()-2}),this.toolbar.isStringTemplate=!0;var t="viewContainerRef";this.parent[t]&&(this.toolbar.registeredTemplate={},this.toolbar[t]=this.parent[t]),this.parent.toolbarTemplate&&"string"==typeof this.parent.toolbarTemplate?(this.toolbar.appendTo(this.parent.toolbarTemplate),this.parent.element.replaceChild(this.toolbar.element,this.parent.element.querySelector("."+P)),this.toolbar.element.classList.add(P)):(this.toolbar.appendTo("#"+this.parent.element.id+"pivot-toolbar"),this.toolbar.width=this.parent.grid?this.parent.getGridWidthAsNumber()-2:this.parent.getWidthAsNumber()-2),this.parent.chart&&this.parent.chart.setProperties({width:this.parent.grid?this.parent.getGridWidthAsNumber().toString():this.parent.getWidthAsNumber().toString()},!0),this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector(".e-grouping-bar")&&this.parent.groupingBarModule.refreshUI()},e.prototype.fetchReports=function(){var e={reportName:[]},t=this;return sf.base.isBlazor()?(e=this.fetchReportsArgs()).then((function(e){return t.reportList.dataSource=e.reportName,e})):this.parent.trigger("fetchReport",e),e},e.prototype.fetchReportsArgs=function(){var e=new sf.data.Deferred;return this.parent.trigger("fetchReport",{reportName:[]},(function(t){e.resolve(t)})),e},e.prototype.getItems=function(){for(var e=this.parent.toolbar.filter((function(e,t,i){return i.indexOf(e)===t})),t=[],i=0,s=e;i<s.length;i++){var r=s[i];switch(r){case"New":t.push({prefixIcon:"e-new-report "+f,tooltipText:this.parent.localeObj.getConstant("new"),click:this.actionClick.bind(this),id:this.parent.element.id+"new"});break;case"Save":t.push({prefixIcon:"e-save-report "+f,tooltipText:this.parent.localeObj.getConstant("save"),click:this.actionClick.bind(this),id:this.parent.element.id+"save"});break;case"SaveAs":t.push({prefixIcon:"e-saveas-report "+f,tooltipText:this.parent.localeObj.getConstant("saveAs"),click:this.actionClick.bind(this),id:this.parent.element.id+"saveas"});break;case"Rename":t.push({prefixIcon:"e-rename-report "+f,tooltipText:this.parent.localeObj.getConstant("rename"),click:this.actionClick.bind(this),id:this.parent.element.id+"rename"});break;case"Remove":t.push({prefixIcon:O+" "+f,tooltipText:this.parent.localeObj.getConstant("deleteReport"),click:this.actionClick.bind(this),id:this.parent.element.id+"remove"});break;case"Load":t.push({template:"<div><input class=e-load-report id="+this.parent.element.id+"_reportlist></input></div>",click:this.actionClick.bind(this),id:this.parent.element.id+"load"});break;case"Grid":var n="Chart"===this.parent.displayOption.view;t.push({prefixIcon:"e-toolbar-grid "+f,tooltipText:this.parent.localeObj.getConstant("grid"),id:this.parent.element.id+"grid",cssClass:n?"e-disabled":"",click:this.menuItemClick.bind(this)});break;case"Chart":var o="Table"===this.parent.displayOption.view;t.push({template:'<ul id="'+this.parent.element.id+'chart_menu"></ul>',id:this.parent.element.id+"chartmenu",cssClass:o?"e-disabled":""});break;case"MDX":"olap"===this.parent.dataType&&t.push({prefixIcon:"e-mdx "+f,id:this.parent.element.id+"mdxQuery",click:this.actionClick.bind(this),tooltipText:this.parent.localeObj.getConstant("mdxQuery")});break;case"Export":t.push({template:'<ul id="'+this.parent.element.id+'export_menu"></ul>',id:this.parent.element.id+"exportmenu"});break;case"SubTotal":t.push({template:'<ul id="'+this.parent.element.id+'subtotal_menu"></ul>',id:this.parent.element.id+"subtotalmenu"});break;case"GrandTotal":t.push({template:'<ul id="'+this.parent.element.id+'grandtotal_menu"></ul>',id:this.parent.element.id+"grandtotalmenu"});break;case"ConditionalFormatting":t.push({prefixIcon:"e-toolbar-formatting "+f,id:this.parent.element.id+"formatting",click:this.actionClick.bind(this),tooltipText:this.parent.localeObj.getConstant("toolbarFormatting")});break;case"NumberFormatting":t.push({prefixIcon:"e-pivot-format-toolbar "+f,id:this.parent.element.id+"numberFormatting",click:this.actionClick.bind(this),tooltipText:this.parent.localeObj.getConstant("numberFormat")});break;case"Formatting":t.push({template:'<ul id="'+this.parent.element.id+'formatting_menu"></ul>',id:this.parent.element.id+"formattingmenu"});break;case"FieldList":t.push({prefixIcon:"e-toolbar-fieldlist "+f,tooltipText:this.parent.localeObj.getConstant("fieldList"),click:this.actionClick.bind(this),align:"Right",id:this.parent.element.id+"fieldlist"}),this.parent.element.querySelector(".e-toggle-field-list")&&(this.parent.element.querySelector(".e-toggle-field-list").style.display="none");break;default:"object"===a(r)&&t.push(r)}}this.parent.showFieldList&&-1===e.indexOf("FieldList")&&sf.base.select("#"+this.parent.element.id+"_PivotFieldList",this.parent.element)&&"none"===sf.base.select("#"+this.parent.element.id+"_PivotFieldList",this.parent.element).style.display&&(sf.base.select("#"+this.parent.element.id+"_PivotFieldList",this.parent.element).style.display="block");var l={customToolbar:t};return this.parent.trigger("toolbarRender",l),t},e.prototype.reportChange=function(e){this.dropArgs=e,this.parent.isModified&&""!==this.currentReport?this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("newReportConfirm")):this.reportLoad(e)},e.prototype.reportLoad=function(e){var t=this;if("Save"!==this.action&&"Rename"!==this.action&&"New"!==this.action){var i={reportName:e.itemData.value};this.parent.trigger("loadReport",i,(function(e){t.currentReport=e.reportName,t.parent.isModified=!1}))}},e.prototype.saveReport=function(e){if(this.currentReport&&""!==this.currentReport&&e.item.id===this.parent.element.id+"save"){var t={report:this.parent.getPersistData(),reportName:this.currentReport};this.parent.trigger("saveReport",t),this.parent.isModified=!1}else{if(""===this.currentReport&&(e.item.id===this.parent.element.id+"save"||e.item.id===this.parent.element.id+"saveas"))return void this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),this.parent.localeObj.getConstant("emptyReport"));this.dialogShow(e,"saveAs")}},e.prototype.mdxQueryDialog=function(e){this.mdxDialog&&!this.mdxDialog.isDestroyed||this.renderMDXDialog();var t=sf.base.createElement("div",{className:"e-mdx-query"}),i=sf.base.createElement("textarea",{className:"e-mdx-query-content",innerHTML:this.parent.olapEngineModule.getMDXQuery(this.parent.dataSourceSettings).trim(),attrs:{readonly:"readonly"}});t.appendChild(i),this.mdxDialog.content=t,this.mdxDialog.show()},e.prototype.dialogShow=function(e,t){if(e){this.dialog.header=e.item.tooltipText;var i=sf.base.createElement("div",{className:"e-report-outer"}),a=sf.base.createElement("div",{className:"e-pivotview-report-label",innerHTML:this.parent.localeObj.getConstant("reportName")}),s=sf.base.createElement("input",{className:"e-pivotview-report-input "+T,innerHTML:t&&"rename"===t?this.currentReport:"",attrs:{placeholder:this.parent.localeObj.getConstant("emptyReportName"),value:t&&"rename"===t?this.currentReport:""}});s.setSelectionRange(s.textContent.length,s.textContent.length),i.appendChild(a),i.appendChild(s),this.dialog.content=i,this.dialog.refresh(),this.dialog.show()}},e.prototype.renameReport=function(e){this.parent.trigger("toolbarClick",e),this.currentReport&&""!==this.currentReport?this.dialogShow(e,"rename"):this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),this.parent.localeObj.getConstant("emptyReport"))},e.prototype.actionClick=function(e){switch(e.item.id){case this.parent.element.id+"save":case this.parent.element.id+"saveas":this.saveReport(e);break;case this.parent.element.id+"remove":return this.action="Remove",void(this.currentReport&&""!==this.currentReport?this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("removeConfirm")):this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),this.parent.localeObj.getConstant("emptyReport")));case this.parent.element.id+"rename":this.renameReport(e);break;case this.parent.element.id+"new":this.action="New",this.newArgs=e,this.parent.isModified&&this.currentReport&&""!==this.currentReport?this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("newReportConfirm")):this.createNewReport(e);break;case this.parent.element.id+"load":this.action="Load";break;case this.parent.element.id+"fieldlist":this.parent.pivotFieldListModule&&this.parent.pivotFieldListModule.dialogRenderer&&this.parent.pivotFieldListModule.dialogRenderer.fieldListDialog.show();break;case this.parent.element.id+"formatting":this.parent.conditionalFormattingModule&&this.parent.conditionalFormattingModule.showConditionalFormattingDialog();break;case this.parent.element.id+"mdxQuery":this.mdxQueryDialog(e);break;case this.parent.element.id+"numberFormatting":this.parent.numberFormattingModule&&this.parent.numberFormattingModule.showNumberFormattingDialog()}},e.prototype.renderDialog=function(){null!==sf.base.select("#"+this.parent.element.id+"report-dialog",document)&&sf.base.remove(sf.base.select("#"+this.parent.element.id+"report-dialog",document)),this.parent.element.appendChild(sf.base.createElement("div",{id:this.parent.element.id+"report-dialog",className:"e-pivotview-report-dialog"})),this.dialog=new sf.popups.Dialog({animationSettings:{effect:"Fade"},allowDragging:!0,position:{X:"center",Y:"center"},buttons:[{click:this.okBtnClick.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:this.cancelBtnClick.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("cancel")}}],isModal:!0,visible:!1,showCloseIcon:!0,enableRtl:this.parent.enableRtl,width:"auto",height:"auto",zIndex:1000001,closeOnEscape:!0,target:document.body}),this.dialog.isStringTemplate=!0,this.dialog.appendTo("#"+this.parent.element.id+"report-dialog")},e.prototype.renderMDXDialog=function(){null!==sf.base.select("#"+this.parent.element.id+"mdx-dialog",document)&&sf.base.remove(sf.base.select("#"+this.parent.element.id+"mdx-dialog",document)),this.parent.element.appendChild(sf.base.createElement("div",{id:this.parent.element.id+"mdx-dialog",className:"e-pivotview-mdx-dialog"})),this.mdxDialog=new sf.popups.Dialog({animationSettings:{effect:"Fade"},allowDragging:!0,position:{X:"center",Y:"center"},buttons:[{click:this.copyMDXQuery.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("copy"),isPrimary:!0}}],header:this.parent.localeObj.getConstant("mdxQuery"),isModal:!0,visible:!1,showCloseIcon:!0,enableRtl:this.parent.enableRtl,width:"auto",height:"auto",zIndex:1000001,closeOnEscape:!0,target:document.body}),this.mdxDialog.isStringTemplate=!0,this.mdxDialog.appendTo("#"+this.parent.element.id+"mdx-dialog")},e.prototype.copyMDXQuery=function(){var e=this.mdxDialog.element.querySelector(".e-mdx-query-content");try{e.select(),document.execCommand("copy")}catch(e){window.alert("Oops, unable to copy")}},e.prototype.okBtnClick=function(){var e=this.dialog.element.querySelector(".e-pivotview-report-input");if(e&&""===e.value)e.focus();else if(this.dialog.header!==this.parent.localeObj.getConstant("save")&&this.dialog.header!==this.parent.localeObj.getConstant("saveAs")||!e.value||""===e.value){if(this.dialog.header===this.parent.localeObj.getConstant("new")&&e.value&&""!==e.value){this.action="New",this.currentReport=e.value;var t=!1,i=this,a={reportName:[]};this.parent.trigger("fetchReport",a,(function(s){for(var r=0;r<s.reportName.length;r++)if(e.value===a.reportName[r]){t=!0;break}if(t)i.createConfirmDialog(i.parent.localeObj.getConstant("alert"),i.parent.localeObj.getConstant("replaceConfirmBefore")+'"'+e.value+'"'+i.parent.localeObj.getConstant("replaceConfirmAfter"));else{i.parent.trigger("newReport"),sf.base.isBlazor()&&i.parent.setProperties({dataSourceSettings:{columns:[],rows:[],values:[],filters:[]}},!1);var n={report:i.parent.getPersistData(),reportName:e.value};i.parent.trigger("saveReport",n),i.parent.isModified=!1,i.updateReportList(),i.dialog.hide()}}))}else if(this.dialog.header===this.parent.localeObj.getConstant("rename")&&e.value&&""!==e.value){if(this.currentReport===e.value)return void this.dialog.hide();this.action="Rename";var s=!1,r=this;l={reportName:[]};this.parent.trigger("fetchReport",l,(function(t){r.renameText=e.value;for(var i=0;i<t.reportName.length;i++)if(e.value===t.reportName[i]){s=!0;break}if(s)r.createConfirmDialog(r.parent.localeObj.getConstant("alert"),r.parent.localeObj.getConstant("replaceConfirmBefore")+'"'+e.value+'"'+r.parent.localeObj.getConstant("replaceConfirmAfter"));else{var a={reportName:r.currentReport,rename:e.value};r.parent.trigger("renameReport",a),r.currentReport=e.value,r.updateReportList(),r.dialog.hide()}}))}}else{this.action="Save",this.currentReport=e.value;var n=!1,o=this,l={reportName:[]};this.parent.trigger("fetchReport",l,(function(t){for(var i=0;i<t.reportName.length;i++)if(e.value===t.reportName[i]){n=!0;break}if(n)o.createConfirmDialog(o.parent.localeObj.getConstant("alert"),o.parent.localeObj.getConstant("replaceConfirmBefore")+'"'+e.value+'"'+o.parent.localeObj.getConstant("replaceConfirmAfter"));else{var a={report:o.parent.getPersistData(),reportName:e.value};o.parent.trigger("saveReport",a),o.parent.isModified=!1,o.updateReportList(),o.dialog.hide()}}))}},e.prototype.createNewReport=function(e){this.dialogShow(e)},e.prototype.cancelBtnClick=function(){this.dialog.hide()},e.prototype.createConfirmDialog=function(e,t){document.getElementById(this.parent.element.id+"_ConfirmDialog")&&sf.base.remove(document.getElementById(this.parent.element.id+"_ConfirmDialog").parentElement);var i=sf.base.createElement("div",{id:this.parent.element.id+"_ConfirmDialog",className:"e-pivot-error-dialog"});this.parent.element.appendChild(i),this.confirmPopUp=new sf.popups.Dialog({animationSettings:{effect:"Fade"},allowDragging:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,header:e,content:t,isModal:!0,visible:!0,closeOnEscape:!0,target:document.body,width:"auto",height:"auto",position:{X:"center",Y:"center"},buttons:[{buttonModel:{content:this.parent.localeObj.getConstant("yes"),isPrimary:!0,cssClass:"e-ok-btn"},click:this.okButtonClick.bind(this)},{buttonModel:{content:this.parent.localeObj.getConstant("no"),cssClass:"e-cancel-btn"},click:this.cancelButtonClick.bind(this)}]}),this.confirmPopUp.isStringTemplate=!0,this.confirmPopUp.appendTo(i),this.confirmPopUp.element.querySelector(".e-dlg-header").innerHTML=e},e.prototype.okButtonClick=function(){var e=this;if("Remove"===this.action){var t={reportName:this.currentReport};this.parent.trigger("removeReport",t);var i=this.fetchReports();if(i.reportName&&i.reportName.length>0){var a={reportName:i.reportName[i.reportName.length-1]};this.parent.trigger("loadReport",a,(function(t){e.currentReport=t.reportName,e.parent.isModified=!1})),this.currentReport=i.reportName[i.reportName.length-1]}else this.currentReport="",this.parent.isModified=!1,this.action="";this.updateReportList()}else if("New"===this.action||"Save"!==this.action&&"Rename"!==this.action&&"New"!==this.action){if(this.currentReport&&""!==this.currentReport&&this.parent.isModified){var s={report:this.parent.getPersistData(),reportName:this.currentReport};this.parent.trigger("saveReport",s),this.parent.isModified=!1,"New"===this.action?this.createNewReport(this.newArgs):this.reportLoad(this.dropArgs)}else if("New"===this.action){this.parent.trigger("newReport"),sf.base.isBlazor()&&this.parent.setProperties({dataSourceSettings:{columns:[],rows:[],values:[],filters:[]}},!1);s={report:this.parent.getPersistData(),reportName:this.currentReport};this.parent.trigger("saveReport",s),this.parent.isModified=!1,this.updateReportList(),this.dialog.hide()}}else if("Save"===this.action){s={report:this.parent.getPersistData(),reportName:this.currentReport};this.parent.trigger("saveReport",s),this.parent.isModified=!1,this.updateReportList(),this.dialog.hide()}else if("Rename"===this.action){var r={reportName:this.currentReport,rename:this.renameText,isReportExists:!0};this.parent.trigger("renameReport",r),this.currentReport=this.renameText,this.parent.isModified=!1,this.updateReportList(),this.dialog.hide()}this.confirmPopUp.hide()},e.prototype.cancelButtonClick=function(){"New"===this.action?this.parent.isModified?this.createNewReport(this.newArgs):this.dialog.hide():"Save"===this.action?(this.currentReport=this.reportList.value,this.dialog.hide()):"Rename"===this.action?this.dialog.hide():this.dropArgs&&"Remove"!==this.action&&this.reportLoad(this.dropArgs),this.confirmPopUp.hide()},e.prototype.createChartMenu=function(){var e=this;if(sf.base.select("#"+this.parent.element.id+"chart_menu",document)){for(var t=[],i=this.getValidChartType(),a=0;a<i.length&&a<7;a++){var s=i[a];t.push({text:this.parent.localeObj.getConstant(s.toLowerCase()),id:this.parent.element.id+"_"+s})}7===t.length&&(t.splice(6),t.push({text:this.parent.localeObj.getConstant("MoreOption"),id:this.parent.element.id+"_ChartMoreOption"}));var r=t.length<=0||"Table"===this.parent.displayOption.view;t.push({separator:!0}),t.push({text:this.parent.localeObj.getConstant("multipleAxes"),id:this.parent.element.id+"_multipleAxes"}),t.push({text:this.parent.localeObj.getConstant("showLegend"),id:this.parent.element.id+"_showLegend"});var n=[{iconCss:"e-toolbar-chart "+f,items:r?[]:t}];this.chartMenu&&!this.chartMenu.isDestroyed&&this.chartMenu.destroy(),this.chartMenu=new sf.navigations.Menu({items:n,enableRtl:this.parent.enableRtl,select:this.menuItemClick.bind(this),beforeOpen:this.whitespaceRemove.bind(this),onClose:function(t){e.focusToolBar()},beforeItemRender:this.multipleAxesCheckbox.bind(this)}),this.chartMenu.isStringTemplate=!0,this.chartMenu.appendTo("#"+this.parent.element.id+"chart_menu")}},e.prototype.create=function(){var e=this;if(sf.base.select("#"+this.parent.element.id+"chart_menu",this.parent.element)&&this.createChartMenu(),sf.base.select("#"+this.parent.element.id+"export_menu",this.parent.element)){var t=[{iconCss:"e-export "+f,items:[{text:this.parent.localeObj.getConstant("pdf"),iconCss:"e-pivotview-pdf-export "+f,id:this.parent.element.id+"pdf"},{text:this.parent.localeObj.getConstant("excel"),iconCss:"e-pivotview-excel-export "+f,id:this.parent.element.id+"excel"},{text:this.parent.localeObj.getConstant("csv"),iconCss:"e-pivotview-csv-export "+f,id:this.parent.element.id+"csv"},{text:this.parent.localeObj.getConstant("png"),iconCss:"e-pivotview-png-export "+f,id:this.parent.element.id+"png"},{text:this.parent.localeObj.getConstant("jpeg"),iconCss:"e-pivotview-jpeg-export "+f,id:this.parent.element.id+"jpeg"},{text:this.parent.localeObj.getConstant("svg"),iconCss:"e-pivotview-svg-export "+f,id:this.parent.element.id+"svg"}]}];this.exportMenu=new sf.navigations.Menu({items:t,enableRtl:this.parent.enableRtl,select:this.menuItemClick.bind(this),beforeOpen:this.updateExportMenu.bind(this),onClose:function(t){e.focusToolBar()}}),this.exportMenu.isStringTemplate=!0,this.exportMenu.appendTo("#"+this.parent.element.id+"export_menu")}if(sf.base.select("#"+this.parent.element.id+"subtotal_menu",this.parent.element)){t=[{iconCss:"e-sub-total "+f,items:[{text:this.parent.localeObj.getConstant("showSubTotals"),id:this.parent.element.id+"subtotal",iconCss:I+" "+f},{text:this.parent.localeObj.getConstant("doNotShowSubTotals"),id:this.parent.element.id+"notsubtotal",iconCss:I+" "+f},{text:this.parent.localeObj.getConstant("showSubTotalsRowsOnly"),id:this.parent.element.id+"subtotalrow",iconCss:I+" "+f},{text:this.parent.localeObj.getConstant("showSubTotalsColumnsOnly"),id:this.parent.element.id+"subtotalcolumn",iconCss:I+" "+f}]}];this.subTotalMenu=new sf.navigations.Menu({items:t,enableRtl:this.parent.enableRtl,select:this.menuItemClick.bind(this),beforeOpen:this.updateSubtotalSelection.bind(this),onClose:function(t){e.focusToolBar()}}),this.subTotalMenu.isStringTemplate=!0,this.subTotalMenu.appendTo("#"+this.parent.element.id+"subtotal_menu")}if(sf.base.select("#"+this.parent.element.id+"grandtotal_menu",this.parent.element)){t=[{iconCss:"e-grand-total "+f,items:[{text:this.parent.localeObj.getConstant("showGrandTotals"),id:this.parent.element.id+"grandtotal",iconCss:I+" "+f},{text:this.parent.localeObj.getConstant("doNotShowGrandTotals"),id:this.parent.element.id+"notgrandtotal",iconCss:I+" "+f},{text:this.parent.localeObj.getConstant("showGrandTotalsRowsOnly"),id:this.parent.element.id+"grandtotalrow",iconCss:I+" "+f},{text:this.parent.localeObj.getConstant("showGrandTotalsColumnsOnly"),id:this.parent.element.id+"grandtotalcolumn",iconCss:I+" "+f}]}];this.grandTotalMenu=new sf.navigations.Menu({items:t,enableRtl:this.parent.enableRtl,select:this.menuItemClick.bind(this),beforeOpen:this.updateGrandtotalSelection.bind(this),onClose:function(t){e.focusToolBar()}}),this.grandTotalMenu.isStringTemplate=!0,this.grandTotalMenu.appendTo("#"+this.parent.element.id+"grandtotal_menu")}if(sf.base.select("#"+this.parent.element.id+"formatting_menu",this.parent.element)){t=[{iconCss:"e-pivot-format-menu "+f,items:[{text:this.parent.localeObj.getConstant("numberFormatMenu"),iconCss:"e-pivot-number-format-menu "+f,id:this.parent.element.id+"numberFormattingMenu"},{text:this.parent.localeObj.getConstant("conditionalFormatingMenu"),iconCss:"e-pivot-conditional-format-menu "+f,id:this.parent.element.id+"conditionalFormattingMenu"}]}];this.formattingMenu=new sf.navigations.Menu({items:t,enableRtl:this.parent.enableRtl,select:this.menuItemClick.bind(this)}),this.formattingMenu.isStringTemplate=!0,this.formattingMenu.appendTo("#"+this.parent.element.id+"formatting_menu")}if(sf.base.select("#"+this.parent.element.id+"_reportlist",this.parent.element)){var i={report:this.parent.getPersistData(),reportName:this.parent.localeObj.getConstant("defaultReport")};if(sf.base.isBlazor()){var a=JSON.parse(i.report);a.dataSourceSettings=r.getClonedDataSourceSettings(this.parent.dataSourceSettings),i.report=JSON.stringify(a)}this.currentReport=this.parent.localeObj.getConstant("defaultReport"),this.parent.trigger("saveReport",i);var s=this.fetchReports();this.reportList=new sf.dropdowns.DropDownList({dataSource:s.reportName,width:"150px",popupHeight:"200px",placeholder:""===this.currentReport?this.parent.localeObj.getConstant("reportList"):"",enableRtl:this.parent.enableRtl,cssClass:"e-reportlist-drop",select:this.reportChange.bind(this),value:this.currentReport}),this.reportList.isStringTemplate=!0,this.reportList.appendTo("#"+this.parent.element.id+"_reportlist")}this.updateItemElements()},e.prototype.updateItemElements=function(){for(var e=0,t=[].slice.call(this.toolbar.element.querySelectorAll(".e-toolbar-item"));e<t.length;e++){var i=t[e];i.querySelector("button")?i.querySelector("button").setAttribute("tabindex","0"):i.querySelector(".e-menu.e-menu-parent")&&(i.querySelector(".e-menu.e-menu-parent").setAttribute("tabindex","-1"),i.querySelector(".e-menu-item.e-menu-caret-icon")&&i.querySelector(".e-menu-item.e-menu-caret-icon").setAttribute("tabindex","0"))}},e.prototype.whitespaceRemove=function(e){e.element.style.padding="0px";var t=e.element.querySelector(".e-separator");t&&(t.style.margin="0px")},e.prototype.multipleAxesCheckbox=function(e){if(this.parent.element.id+"_multipleAxes"===e.element.id){(a=sf.base.createElement("input",{id:this.parent.element.id+"_checkBox"})).style.display="none",this.parent.element.appendChild(a);var t=new sf.buttons.CheckBox({label:this.parent.localeObj.getConstant("multipleAxes"),cssClass:"e-multipleAxes",checked:this.parent.chartSettings.enableMultiAxis,enableRtl:this.parent.enableRtl});e.element.innerText="",t.appendTo("#"+this.parent.element.id+"_checkBox"),["Pie","Funnel","Pyramid","Doughnut"].indexOf(this.parent.chartSettings.chartSeries.type)>-1&&!e.element.classList.contains("e-disabled")?(e.element.classList.add("e-disabled"),t.disabled=!0):["Pie","Funnel","Pyramid","Doughnut"].indexOf(this.parent.chartSettings.chartSeries.type)<0&&e.element.classList.contains("e-disabled")&&(e.element.classList.remove("e-disabled"),t.disabled=!1);var i=this.parent.element.querySelector(".e-checkbox-wrapper.e-multipleAxes");e.element.appendChild(i)}else if(this.parent.element.id+"_showLegend"===e.element.id){var a;(a=sf.base.createElement("input",{id:this.parent.element.id+"_showLegendCheckBox"})).style.display="none",this.parent.element.appendChild(a);t=new sf.buttons.CheckBox({label:this.parent.localeObj.getConstant("showLegend"),checked:this.getLableState(this.parent.chartSettings.chartSeries.type),cssClass:"e-showLegend",enableRtl:this.parent.enableRtl});e.element.innerText="",t.appendTo("#"+this.parent.element.id+"_showLegendCheckBox");i=this.parent.element.querySelector(".e-checkbox-wrapper.e-showLegend");e.element.appendChild(i)}},e.prototype.getLableState=function(e){var t=JSON.parse(this.parent.getPersistData()).chartSettings;return t&&t.legendSettings&&void 0!==t.legendSettings.visible?this.showLableState=t.legendSettings.visible:this.showLableState=!(["Pie","Funnel","Pyramid","Doughnut"].indexOf(this.parent.chartSettings.chartSeries.type)>-1),this.showLableState},e.prototype.getAllChartItems=function(){return["Line","Column","Area","Bar","StackingColumn","StackingArea","StackingBar","StepLine","StepArea","SplineArea","Scatter","Spline","StackingColumn100","StackingBar100","StackingArea100","Bubble","Pareto","Polar","Radar","Pie","Pyramid","Funnel","Doughnut"]},e.prototype.updateExportMenu=function(e){var t=[].slice.call(e.element.querySelectorAll("li"));"Table"===this.parent.currentView?(sf.base.addClass(t.slice(3),x),sf.base.removeClass(t.slice(1,3),x)):(sf.base.addClass(t.slice(1,3),x),sf.base.removeClass(t.slice(3),x))},e.prototype.updateSubtotalSelection=function(e){sf.base.select("#"+this.parent.element.id+"subtotal ."+I,e.element).classList.contains(F)||sf.base.select("#"+this.parent.element.id+"subtotal ."+I,e.element).classList.add(F),sf.base.select("#"+this.parent.element.id+"notsubtotal ."+I,e.element).classList.contains(F)||sf.base.select("#"+this.parent.element.id+"notsubtotal ."+I,e.element).classList.add(F),sf.base.select("#"+this.parent.element.id+"subtotalrow ."+I,e.element).classList.contains(F)||sf.base.select("#"+this.parent.element.id+"subtotalrow ."+I,e.element).classList.add(F),sf.base.select("#"+this.parent.element.id+"subtotalcolumn ."+I,e.element).classList.contains(F)||sf.base.select("#"+this.parent.element.id+"subtotalcolumn ."+I,e.element).classList.add(F),this.parent.dataSourceSettings.showSubTotals&&this.parent.dataSourceSettings.showRowSubTotals&&!this.parent.dataSourceSettings.showColumnSubTotals?sf.base.select("#"+this.parent.element.id+"subtotalrow ."+I,e.element).classList.remove(F):this.parent.dataSourceSettings.showSubTotals&&!this.parent.dataSourceSettings.showRowSubTotals&&this.parent.dataSourceSettings.showColumnSubTotals?sf.base.select("#"+this.parent.element.id+"subtotalcolumn ."+I,e.element).classList.remove(F):this.parent.dataSourceSettings.showSubTotals&&this.parent.dataSourceSettings.showRowSubTotals&&this.parent.dataSourceSettings.showColumnSubTotals?sf.base.select("#"+this.parent.element.id+"subtotal ."+I,e.element).classList.remove(F):this.parent.dataSourceSettings.showSubTotals&&(this.parent.dataSourceSettings.showRowSubTotals||this.parent.dataSourceSettings.showColumnSubTotals)||sf.base.select("#"+this.parent.element.id+"notsubtotal ."+I,e.element).classList.remove(F)},e.prototype.updateGrandtotalSelection=function(e){sf.base.select("#"+this.parent.element.id+"grandtotal ."+I,e.element).classList.contains(F)||sf.base.select("#"+this.parent.element.id+"grandtotal ."+I,e.element).classList.add(F),sf.base.select("#"+this.parent.element.id+"notgrandtotal ."+I,e.element).classList.contains(F)||sf.base.select("#"+this.parent.element.id+"notgrandtotal ."+I,e.element).classList.add(F),sf.base.select("#"+this.parent.element.id+"grandtotalrow ."+I,e.element).classList.contains(F)||sf.base.select("#"+this.parent.element.id+"grandtotalrow ."+I,e.element).classList.add(F),sf.base.select("#"+this.parent.element.id+"grandtotalcolumn ."+I,e.element).classList.contains(F)||sf.base.select("#"+this.parent.element.id+"grandtotalcolumn ."+I,e.element).classList.add(F),this.parent.dataSourceSettings.showGrandTotals&&this.parent.dataSourceSettings.showRowGrandTotals&&!this.parent.dataSourceSettings.showColumnGrandTotals?sf.base.select("#"+this.parent.element.id+"grandtotalrow ."+I,e.element).classList.remove(F):this.parent.dataSourceSettings.showGrandTotals&&!this.parent.dataSourceSettings.showRowGrandTotals&&this.parent.dataSourceSettings.showColumnGrandTotals?sf.base.select("#"+this.parent.element.id+"grandtotalcolumn ."+I,e.element).classList.remove(F):this.parent.dataSourceSettings.showGrandTotals&&this.parent.dataSourceSettings.showRowGrandTotals&&this.parent.dataSourceSettings.showColumnGrandTotals?sf.base.select("#"+this.parent.element.id+"grandtotal ."+I,e.element).classList.remove(F):this.parent.dataSourceSettings.showGrandTotals&&(this.parent.dataSourceSettings.showRowGrandTotals||this.parent.dataSourceSettings.showColumnGrandTotals)||sf.base.select("#"+this.parent.element.id+"notgrandtotal ."+I,e.element).classList.remove(F)},e.prototype.updateReportList=function(){var e;if(sf.base.isBlazor()){var t=this;e={reportName:[]},this.parent.trigger("fetchReport",e,(function(e){t.reportList.dataSource=e.reportName,""===t.currentReport&&t.reportList.dataSource.length>0?(t.reportList.value=t.reportList.dataSource[t.reportList.dataSource.length-1],t.reportList.text=t.reportList.dataSource[t.reportList.dataSource.length-1],t.currentReport=t.reportList.dataSource[t.reportList.dataSource.length-1]):(t.reportList.value=t.currentReport,t.reportList.text=t.currentReport),t.reportList.refresh()}))}else e=this.fetchReports(),this.reportList.dataSource=e.reportName,""===this.currentReport&&this.reportList.dataSource.length>0?(this.reportList.value=this.reportList.dataSource[this.reportList.dataSource.length-1],this.reportList.text=this.reportList.dataSource[this.reportList.dataSource.length-1],this.currentReport=this.reportList.dataSource[this.reportList.dataSource.length-1]):(this.reportList.value=this.currentReport,this.reportList.text=this.currentReport),this.reportList.refresh()},e.prototype.menuItemClick=function(e){var t,i=this,a={};switch((this.getAllChartItems().indexOf(e.item.id.split(this.parent.element.id+"_")[1])>-1||"ChartMoreOption"===e.item.id.split(this.parent.element.id+"_")[1]||"multipleAxes"===e.item.id.split(this.parent.element.id+"_")[1]||"showLegend"===e.item.id.split(this.parent.element.id+"_")[1])&&(t=e.item.id.split(this.parent.element.id+"_")[1]),e.item.id){case this.parent.element.id+"grid":this.parent.grid&&this.parent.chart&&(this.parent.grid.element.style.display="",this.parent.chart.element.style.display="none",this.parent.chartSettings.enableMultiAxis&&this.parent.chartSettings.enableScrollOnMultiAxis&&(this.parent.element.querySelector(".e-pivotchart").style.display="none"),this.parent.currentView="Table",this.parent.setProperties({displayOption:{primary:"Table"}},!0),this.parent.showGroupingBar&&this.parent.groupingBarModule&&(this.parent.element.querySelector(".e-pivot-grouping-bar").style.display="",this.parent.element.querySelector(".e-chart-grouping-bar").style.display="none"),this.parent.layoutRefresh()),sf.base.isBlazor()&&this.parent.element.querySelector(".e-toggle-field-list")&&-1!==this.parent.toolbar.indexOf("FieldList")&&(this.parent.element.querySelector(".e-toggle-field-list").style.display="none");break;case this.parent.element.id+"pdf":"Table"===this.parent.currentView?(a={pdfExportProperties:{fileName:"Export.pdf"},pdfDoc:void 0,isBlob:!1,isMultipleExport:!1},this.parent.trigger("beforeExport",a,(function(e){if(sf.base.isBlazor()){var t=r.formatPdfExportProperties(e.pdfExportProperties);i.parent.pdfExport(t,e.isMultipleExport,e.pdfDoc,e.isBlob)}else i.parent.pdfExport(e.pdfExportProperties,e.isMultipleExport,e.pdfDoc,e.isBlob)}))):(a={width:void 0,height:void 0,orientation:sf.pdfexport.PdfPageOrientation.Landscape,type:"PDF",fileName:"result"},this.parent.trigger("beforeExport",a,(function(e){i.parent.chartExport(e.type,e.fileName,e.orientation,e.width,e.height)})));break;case this.parent.element.id+"excel":a={excelExportProperties:{fileName:"Export.xlsx"},isBlob:!1,isMultipleExport:!1,workbook:void 0},this.parent.trigger("beforeExport",a,(function(e){if(sf.base.isBlazor()){var t=r.formatExcelExportProperties(e.excelExportProperties);i.parent.excelExport(t,e.isMultipleExport,e.workbook,e.isBlob)}else i.parent.excelExport(e.excelExportProperties,e.isMultipleExport,e.workbook,e.isBlob)}));break;case this.parent.element.id+"csv":a={excelExportProperties:{fileName:"Export.csv"},isBlob:!1,isMultipleExport:!1,workbook:void 0},this.parent.trigger("beforeExport",a,(function(e){if(sf.base.isBlazor()){var t=r.formatExcelExportProperties(e.excelExportProperties);i.parent.csvExport(t,e.isMultipleExport,e.workbook,e.isBlob)}else i.parent.csvExport(e.excelExportProperties,e.isMultipleExport,e.workbook,e.isBlob)}));break;case this.parent.element.id+"png":a={type:"PNG",width:void 0,height:void 0,fileName:"result",orientation:sf.pdfexport.PdfPageOrientation.Landscape},this.parent.trigger("beforeExport",a,(function(e){i.parent.chartExport(e.type,e.fileName,e.orientation,e.width,e.height)}));break;case this.parent.element.id+"jpeg":a={type:"JPEG",fileName:"result",orientation:sf.pdfexport.PdfPageOrientation.Landscape,width:void 0,height:void 0},this.parent.trigger("beforeExport",a,(function(e){i.parent.chartExport(e.type,e.fileName,e.orientation,e.width,e.height)}));break;case this.parent.element.id+"svg":a={width:void 0,height:void 0,type:"SVG",fileName:"result",orientation:sf.pdfexport.PdfPageOrientation.Landscape},this.parent.trigger("beforeExport",a,(function(e){i.parent.chartExport(e.type,e.fileName,e.orientation,e.width,e.height)}));break;case this.parent.element.id+"notsubtotal":this.parent.setProperties({dataSourceSettings:{showSubTotals:!1,showColumnSubTotals:!1,showRowSubTotals:!1}},!0),this.parent.refreshData();break;case this.parent.element.id+"subtotalrow":this.parent.setProperties({dataSourceSettings:{showSubTotals:!0,showColumnSubTotals:!1,showRowSubTotals:!0}},!0),this.parent.refreshData();break;case this.parent.element.id+"subtotalcolumn":this.parent.setProperties({dataSourceSettings:{showSubTotals:!0,showColumnSubTotals:!0,showRowSubTotals:!1}},!0),this.parent.refreshData();break;case this.parent.element.id+"subtotal":this.parent.setProperties({dataSourceSettings:{showSubTotals:!0,showColumnSubTotals:!0,showRowSubTotals:!0}},!0),this.parent.refreshData();break;case this.parent.element.id+"notgrandtotal":this.parent.setProperties({dataSourceSettings:{showGrandTotals:!1,showColumnGrandTotals:!1,showRowGrandTotals:!1}},!0),this.parent.refreshData();break;case this.parent.element.id+"grandtotalrow":this.parent.setProperties({dataSourceSettings:{showGrandTotals:!0,showColumnGrandTotals:!1,showRowGrandTotals:!0}},!0),this.parent.refreshData();break;case this.parent.element.id+"grandtotalcolumn":this.parent.setProperties({dataSourceSettings:{showGrandTotals:!0,showColumnGrandTotals:!0,showRowGrandTotals:!1}},!0),this.parent.refreshData();break;case this.parent.element.id+"grandtotal":this.parent.setProperties({dataSourceSettings:{showGrandTotals:!0,showColumnGrandTotals:!0,showRowGrandTotals:!0}},!0),this.parent.refreshData();break;case this.parent.element.id+"numberFormattingMenu":this.parent.numberFormattingModule&&this.parent.numberFormattingModule.showNumberFormattingDialog();break;case this.parent.element.id+"conditionalFormattingMenu":this.parent.conditionalFormattingModule&&this.parent.conditionalFormattingModule.showConditionalFormattingDialog();break;case this.parent.element.id+"_"+t:e.item&&e.item.text&&("ChartMoreOption"===t?this.createChartTypeDialog():"multipleAxes"===t?(this.parent.chartSettings.enableScrollOnMultiAxis&&(this.isMultiAxisChange=!0),this.parent.chartSettings.enableMultiAxis=!this.parent.chartSettings.enableMultiAxis,this.updateChartType(this.parent.chartSettings.chartSeries.type,!0)):this.getAllChartItems().indexOf(t)>-1?this.updateChartType(t,!1):"showLegend"===t&&(this.parent.chart.legendSettings.visible=!this.showLableState,this.parent.chartSettings.legendSettings?this.parent.chartSettings.legendSettings.visible=!this.showLableState:this.parent.setProperties({chartSettings:{legendSettings:{visible:!this.showLableState}}},!0),this.updateChartType(this.parent.chartSettings.chartSeries.type,!0))),sf.base.isBlazor()&&this.parent.element.querySelector(".e-toggle-field-list")&&-1!==this.parent.toolbar.indexOf("FieldList")&&(this.parent.element.querySelector(".e-toggle-field-list").style.display="none")}},e.prototype.addEventListener=function(){this.parent.isDestroyed||this.parent.on("init-toolbar",this.createToolbar,this)},e.prototype.getValidChartType=function(){for(var e=[],t=0;t<=this.parent.chartTypes.length;t++){var i=this.parent.chartTypes[t];this.getAllChartItems().indexOf(i)>-1&&e.indexOf(i)<0&&e.push(i)}return e},e.prototype.createChartTypeDialog=function(){var e=this,t=this.parent.element.appendChild(sf.base.createElement("div",{id:this.parent.element.id+"_ChartTypeDialog",className:"e-pivotchart-type-dialog"}));this.chartTypesDialog=new sf.popups.Dialog({animationSettings:{effect:"Fade"},allowDragging:!0,header:this.parent.localeObj.getConstant("chartTypeSettings"),content:this.getDialogContent(),isModal:!0,beforeOpen:this.beforeOpen.bind(this),visible:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,width:"auto",height:"auto",position:{X:"center",Y:"center"},buttons:[{click:function(){e.chartTypeDialogUpdate()},buttonModel:{cssClass:"e-ok-btn",content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:function(){e.removeDialog()},buttonModel:{cssClass:"e-cancel-btn",content:this.parent.localeObj.getConstant("cancel")}}],closeOnEscape:!0,target:this.parent.element,close:this.removeDialog.bind(this)}),this.chartTypesDialog.isStringTemplate=!0,this.chartTypesDialog.appendTo(t)},e.prototype.removeDialog=function(){this.chartTypesDialog&&!this.chartTypesDialog.isDestroyed&&this.chartTypesDialog.destroy(),document.getElementById(this.parent.element.id+"_ChartTypeDialog")&&sf.base.remove(document.getElementById(this.parent.element.id+"_ChartTypeDialog"))},e.prototype.chartTypeDialogUpdate=function(){var e=sf.base.getInstance("#"+this.parent.element.id+"_ChartTypeOption",sf.dropdowns.DropDownList).value,t=sf.base.getInstance("#"+this.parent.element.id+"_DialogMultipleAxis",sf.buttons.CheckBox).checked,i=sf.base.getInstance("#"+this.parent.element.id+"_DialogShowLabel",sf.buttons.CheckBox).checked;this.parent.chart.legendSettings.visible=i,this.chartLableState&&(this.parent.chart.legendSettings.visible=i,this.parent.chartSettings.legendSettings?this.parent.chartSettings.legendSettings.visible=i:this.parent.setProperties({chartSettings:{legendSettings:{visible:i}}},!0)),this.updateChartType(e,!1),this.parent.chartSettings.enableMultiAxis=t,this.chartTypesDialog.close()},e.prototype.updateChartType=function(e,t){this.getAllChartItems().indexOf(e)>-1&&this.parent.chart&&(this.parent.currentView="Chart",this.parent.setProperties({displayOption:{primary:"Chart"}},!0),this.parent.chart.element.style.width=sf.base.formatUnit(this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.getWidthAsNumber()),this.parent.chart.setProperties({width:sf.base.formatUnit(this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.getWidthAsNumber())},!0),this.parent.chartSettings.chartSeries.type!==e||t?this.parent.chartSettings.chartSeries.type=e:this.parent.chartModule.updateView())},e.prototype.getDialogContent=function(){var e=sf.base.createElement("div",{className:"e-chart-type-div-content"}),t=sf.base.createElement("div",{className:"e-chart-type-option-wrapper"}),i=sf.base.createElement("div",{className:"e-chart-type-option-text",innerHTML:this.parent.localeObj.getConstant("ChartType")}),a=sf.base.createElement("div",{id:this.parent.element.id+"_ChartTypeOption"});t.appendChild(i),t.appendChild(a);for(var s=[],r=this.getValidChartType(),n=0;n<r.length;n++)s.push({value:r[n],text:this.parent.localeObj.getConstant(r[n].toLowerCase())});var o=new sf.dropdowns.DropDownList({dataSource:s,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text"},value:this.parent.chartSettings.chartSeries.type?this.parent.chartSettings.chartSeries.type:this.getValidChartType()[0],width:"100%",change:this.changeDropDown.bind(this)});o.isStringTemplate=!0,o.appendTo(a),e.appendChild(t);var l=sf.base.createElement("input",{id:this.parent.element.id+"_DialogMultipleAxis",attrs:{type:"checkbox"}});e.appendChild(l);var d=sf.base.createElement("input",{id:this.parent.element.id+"_DialogShowLabel",attrs:{type:"checkbox"}});return e.appendChild(d),e},e.prototype.changeDropDown=function(e){var t=JSON.parse(this.parent.getPersistData()).chartSettings;if(!t||!t.legendSettings||void 0===t.legendSettings.visible){var i=!(["Pie","Funnel","Pyramid","Doughnut"].indexOf(e.value.toString())>-1);sf.base.getInstance("#"+this.parent.element.id+"_DialogShowLabel",sf.buttons.CheckBox).checked=i}["Pie","Funnel","Pyramid","Doughnut"].indexOf(e.value.toString())>-1?sf.base.getInstance("#"+this.parent.element.id+"_DialogMultipleAxis",sf.buttons.CheckBox).disabled=!0:sf.base.getInstance("#"+this.parent.element.id+"_DialogMultipleAxis",sf.buttons.CheckBox).disabled=!1},e.prototype.beforeOpen=function(){var e=this,t=new sf.buttons.CheckBox({label:this.parent.localeObj.getConstant("multipleAxes"),cssClass:"e-dialog-multiple-axis",checked:!!this.parent.chartSettings.enableMultiAxis&&this.parent.chartSettings.enableMultiAxis,enableRtl:this.parent.enableRtl});new sf.buttons.CheckBox({label:this.parent.localeObj.getConstant("showLegend"),checked:this.getLableState(this.parent.chartSettings.chartSeries.type),change:function(){e.chartLableState=!0},cssClass:"e-dialog-show-legend",enableRtl:this.parent.enableRtl}).appendTo(sf.base.select("#"+this.parent.element.id+"_DialogShowLabel",this.chartTypesDialog.element)),t.appendTo(sf.base.select("#"+this.parent.element.id+"_DialogMultipleAxis",this.chartTypesDialog.element)),["Pie","Funnel","Pyramid","Doughnut"].indexOf(this.parent.chartSettings.chartSeries.type)>-1&&(t.disabled=!0);var i=JSON.parse(this.parent.getPersistData()).chartSettings;i&&i.legendSettings&&void 0!==i.legendSettings.visible?this.chartLableState=!0:this.chartLableState=!1},e.prototype.refreshToolbar=function(){this.createToolbar()},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off("init-toolbar",this.createToolbar)},e.prototype.destroy=function(){this.removeEventListener(),this.confirmPopUp&&!this.confirmPopUp.isDestroyed&&this.confirmPopUp.destroy(),this.dialog&&!this.dialog.isDestroyed&&this.dialog.destroy(),this.mdxDialog&&!this.mdxDialog.isDestroyed&&this.mdxDialog.destroy(),this.chartMenu&&!this.chartMenu.isDestroyed&&this.chartMenu.destroy(),this.chartTypesDialog&&!this.chartTypesDialog.isDestroyed&&this.chartTypesDialog.destroy(),this.exportMenu&&!this.exportMenu.isDestroyed&&this.exportMenu.destroy(),this.subTotalMenu&&!this.subTotalMenu.isDestroyed&&this.subTotalMenu.destroy(),this.grandTotalMenu&&!this.grandTotalMenu.isDestroyed&&this.grandTotalMenu.destroy(),this.formattingMenu&&!this.formattingMenu.isDestroyed&&this.formattingMenu.destroy(),this.reportList&&!this.reportList.isDestroyed&&this.reportList.destroy(),this.toolbar&&!this.toolbar.isDestroyed&&this.toolbar.destroy(),sf.base.select("#"+this.parent.element.id+"pivot-toolbar",document)&&sf.base.remove(sf.base.select("#"+this.parent.element.id+"pivot-toolbar",document))},e.prototype.focusToolBar=function(){sf.base.removeClass(document.querySelector("."+P).querySelectorAll(".e-menu-item.e-focused"),"e-focused"),sf.base.removeClass(document.querySelector("."+P).querySelectorAll(".e-menu-item.e-selected"),"e-selected"),document.querySelector(".e-toolbar-items")&&sf.base.addClass([document.querySelector(".e-toolbar-items")],"e-focused")},e}(),Tt=function(){function e(e){this.parent=e,this.parent.numberFormattingModule=this,this.removeEventListener(),this.addEventListener(),this.newFormat=[],this.lastFormattedValue=[]}return e.prototype.getModuleName=function(){return"numberformatting"},e.prototype.showNumberFormattingDialog=function(){var e,t=this,i=sf.base.createElement("div",{id:this.parent.element.id+"_FormatDialog",className:"e-pivot-format-dialog"});this.parent.element.appendChild(i),this.dialog=new sf.popups.Dialog({animationSettings:{effect:"Fade"},allowDragging:!0,header:this.parent.localeObj.getConstant("numberFormat"),content:this.getDialogContent(),isModal:!0,visible:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,width:"auto",height:"auto",position:{X:"center",Y:"center"},buttons:[{click:this.updateFormatting.bind(this),buttonModel:{cssClass:"e-ok-btn",content:this.parent.localeObj.getConstant("apply"),isPrimary:!0}},{click:function(){t.dialog.hide()},buttonModel:{cssClass:"e-cancel-btn",content:this.parent.localeObj.getConstant("cancel")}}],closeOnEscape:!0,target:this.parent.element,overlayClick:function(){t.removeDialog()},close:this.removeDialog.bind(this)}),this.dialog.isStringTemplate=!0,this.dialog.appendTo(i),this.dialog.element.querySelector(".e-dlg-header").innerHTML=this.parent.localeObj.getConstant("numberFormat"),this.newFormat=[{name:this.parent.localeObj.getConstant("AllValues"),format:"N0",useGrouping:!0,type:"undefined"}];for(var a=[],s=0;s<this.parent.dataSourceSettings.formatSettings.length;s++)e={name:this.parent.dataSourceSettings.formatSettings[s].name,format:this.parent.dataSourceSettings.formatSettings[s].format,useGrouping:this.parent.dataSourceSettings.formatSettings[s].useGrouping,type:this.parent.dataSourceSettings.formatSettings[s].type},this.newFormat.push(e);for(s=0;s<this.newFormat.length;s++)a.push(this.newFormat[s].name);for(var r=0;r<this.parent.dataSourceSettings.values.length;r++)-1===a.indexOf(this.parent.dataSourceSettings.values[r].name)&&(e={name:this.parent.dataSourceSettings.values[r].name,format:"N0",useGrouping:!0},this.newFormat.push(e));this.renderControls()},e.prototype.getDialogContent=function(){var e=sf.base.createElement("div",{id:this.parent.element.id+"_FormatDialogOuter",className:"e-pivot-format-dialog-outer"}),t=sf.base.createElement("table",{id:this.parent.element.id+"_FormatTable",className:"e-pivot-format-table"}),i=sf.base.createElement("tr"),a=sf.base.createElement("td"),s=sf.base.createElement("div",{id:this.parent.element.id+"_FormatValueLable",className:"e-pivot-format-value-lable",innerHTML:this.parent.localeObj.getConstant("values")}),r=sf.base.createElement("div",{id:this.parent.element.id+"_FormatValueDrop"});a.appendChild(s),a.appendChild(r),i.appendChild(a),t.appendChild(i),i=sf.base.createElement("tr"),a=sf.base.createElement("td");var n=sf.base.createElement("div",{id:this.parent.element.id+"_FormatLable",className:"e-pivot-format-lable",innerHTML:this.parent.localeObj.getConstant("formatType")}),o=sf.base.createElement("div",{id:this.parent.element.id+"_FormatDrop"});a.appendChild(n),a.appendChild(o),i.appendChild(a),t.appendChild(i),i=sf.base.createElement("tr"),a=sf.base.createElement("td");var l=sf.base.createElement("div",{id:this.parent.element.id+"_GroupingLable",className:"e-pivot-format-grouping-lable",innerHTML:this.parent.localeObj.getConstant("grouping")}),d=sf.base.createElement("div",{id:this.parent.element.id+"_GroupingDrop"});a.appendChild(l),a.appendChild(d),i.appendChild(a),t.appendChild(i),i=sf.base.createElement("tr"),a=sf.base.createElement("td");var p=sf.base.createElement("div",{id:this.parent.element.id+"_DecimalLable",className:"e-pivot-format-decimal-lable",innerHTML:this.parent.localeObj.getConstant("decimalPlaces")}),h=sf.base.createElement("div",{id:this.parent.element.id+"_DecimalDrop"});return a.appendChild(p),a.appendChild(h),i.appendChild(a),t.appendChild(i),i=sf.base.createElement("tr"),a=sf.base.createElement("td"),this.customLable=sf.base.createElement("div",{id:this.parent.element.id+"_CustomLable",className:"e-pivot-format-custom-lable",innerHTML:this.parent.localeObj.getConstant("customFormatString")}),this.customText=sf.base.createElement("input",{id:this.parent.element.id+"_CustomText",attrs:{type:"text",tabindex:"0"},className:T+" e-pivot-format-custom-text"}),a.appendChild(this.customLable),a.appendChild(this.customText),i.appendChild(a),t.appendChild(i),i=sf.base.createElement("tr"),t.appendChild(i),e.appendChild(t),e},e.prototype.renderControls=function(){if(sf.base.select("#"+this.parent.element.id+"_FormatValueDrop",this.dialog.element)){var e=[];e.push({index:0,name:this.parent.localeObj.getConstant("AllValues"),field:this.parent.localeObj.getConstant("AllValues")});for(var t=0;t<this.parent.dataSourceSettings.values.length;t++)e.push({index:t+1,name:this.parent.dataSourceSettings.values[t].caption||this.parent.dataSourceSettings.values[t].name,field:this.parent.dataSourceSettings.values[t].name});this.valuesDropDown=new sf.dropdowns.DropDownList({dataSource:e,fields:{text:"name",value:"field"},enableRtl:this.parent.enableRtl,index:0,cssClass:"e-pivot-format-value-drop",change:this.valueChange.bind(this),width:"100%",open:this.customUpdate.bind(this)}),this.valuesDropDown.isStringTemplate=!0,this.valuesDropDown.appendTo("#"+this.parent.element.id+"_FormatValueDrop")}if(sf.base.select("#"+this.parent.element.id+"_FormatDrop",this.dialog.element)){var i=[{index:0,name:this.parent.localeObj.getConstant("number")},{index:1,name:this.parent.localeObj.getConstant("currency")},{index:2,name:this.parent.localeObj.getConstant("percentage")},{index:3,name:this.parent.localeObj.getConstant("Custom")}];this.formatDropDown=new sf.dropdowns.DropDownList({dataSource:i,fields:{text:"name",value:"name"},index:0,change:this.dropDownChange.bind(this),enableRtl:this.parent.enableRtl,cssClass:"e-pivot-format-drop",width:"100%"}),this.formatDropDown.isStringTemplate=!0,this.formatDropDown.appendTo("#"+this.parent.element.id+"_FormatDrop")}if(sf.base.select("#"+this.parent.element.id+"_GroupingDrop",this.dialog.element)){i=[{index:0,name:this.parent.localeObj.getConstant("true")},{index:1,name:this.parent.localeObj.getConstant("false")}];this.groupingDropDown=new sf.dropdowns.DropDownList({dataSource:i,fields:{text:"name",value:"name"},enableRtl:this.parent.enableRtl,index:0,cssClass:"e-pivot-format-grouping-drop",width:"100%",change:this.groupingChange.bind(this)}),this.groupingDropDown.isStringTemplate=!0,this.groupingDropDown.appendTo("#"+this.parent.element.id+"_GroupingDrop")}if(sf.base.select("#"+this.parent.element.id+"_DecimalDrop",this.dialog.element)){i=[{index:0,name:0},{index:1,name:1},{index:2,name:2},{index:3,name:3},{index:4,name:4},{index:5,name:5},{index:6,name:6},{index:7,name:7},{index:8,name:8},{index:9,name:9},{index:10,name:10}];this.decimalDropDown=new sf.dropdowns.DropDownList({dataSource:i,fields:{text:"name",value:"name"},enableRtl:this.parent.enableRtl,index:0,cssClass:"e-pivot-format-decimal-drop",popupHeight:150,width:"100%",change:this.decimalChange.bind(this)}),this.decimalDropDown.isStringTemplate=!0,this.decimalDropDown.appendTo("#"+this.parent.element.id+"_DecimalDrop")}if(this.formatDropDown.value!==this.parent.localeObj.getConstant("Custom")&&(this.customText.disabled=!0),0!==this.lastFormattedValue.length){this.valuesDropDown.value=this.lastFormattedValue[0].name;var a=this.lastFormattedValue[0].format,s=""===a?"":a.split("")[0].toLowerCase(),r=this.lastFormattedValue[0].useGrouping?this.parent.localeObj.getConstant("true"):this.parent.localeObj.getConstant("false");this.updateFormattingDialog(a,s,r)}},e.prototype.valueChange=function(e){for(var t=this.newFormat,i=!1,a=0;a<t.length;a++)if(t[a].name===e.value){var s=t[a].format,r=""===s?"":s.split("")[0].toLowerCase(),n=t[a].useGrouping?this.parent.localeObj.getConstant("true"):this.parent.localeObj.getConstant("false");this.updateFormattingDialog(s,r,n),i=!0;break}i||(this.formatDropDown.value=this.parent.localeObj.getConstant("number"),this.decimalDropDown.value=0,this.groupingDropDown.value=this.parent.localeObj.getConstant("true"))},e.prototype.updateFormattingDialog=function(e,t,i){2===e.length&&["n","p","c"].indexOf(t)>-1?(this.formatDropDown.value="n"===t?this.parent.localeObj.getConstant("number"):"p"===t?this.parent.localeObj.getConstant("percentage"):"c"===t?this.parent.localeObj.getConstant("currency"):this.parent.localeObj.getConstant("number"),this.decimalDropDown.value=Number(e.split("")[1]),this.groupingDropDown.value=i):(this.formatDropDown.value=this.parent.localeObj.getConstant("Custom"),this.customText.value=e)},e.prototype.customUpdate=function(){if(this.formatDropDown.value===this.parent.localeObj.getConstant("Custom")){var e=this.getIndexValue();this.newFormat[e].format=this.customText.value}},e.prototype.dropDownChange=function(e){var t=this.getIndexValue();if(e.value===this.parent.localeObj.getConstant("Custom"))this.customText.disabled=!1,this.groupingDropDown.enabled=!1,this.decimalDropDown.enabled=!1,this.newFormat[t].format=this.customText.value;else{var i=this.formattedText();this.newFormat[t].format=i,this.customText.disabled=!0,this.groupingDropDown.enabled=!0,this.decimalDropDown.enabled=!0,this.customText.value=""}},e.prototype.groupingChange=function(){var e=this.getIndexValue();this.newFormat[e].useGrouping=this.groupingDropDown.value===this.parent.localeObj.getConstant("true")},e.prototype.getIndexValue=function(){for(var e=[],t=0;t<this.newFormat.length;t++)e.push(this.newFormat[t].name);return e.indexOf(this.valuesDropDown.value.toString())},e.prototype.decimalChange=function(){var e=this.getIndexValue(),t=this.formattedText();this.newFormat[e].format=t},e.prototype.formattedText=function(){return this.formatDropDown.value===this.parent.localeObj.getConstant("number")||this.formatDropDown.value===this.parent.localeObj.getConstant("percentage")||this.formatDropDown.value===this.parent.localeObj.getConstant("currency")?(this.formatDropDown.value===this.parent.localeObj.getConstant("number")?"N":this.formatDropDown.value===this.parent.localeObj.getConstant("currency")?"C":"P")+this.decimalDropDown.value:this.customText.value},e.prototype.removeDialog=function(){this.dialog&&!this.dialog.isDestroyed&&this.dialog.destroy(),document.getElementById(this.parent.element.id+"_FormatDialog")&&sf.base.remove(document.getElementById(this.parent.element.id+"_FormatDialog"))},e.prototype.updateFormatting=function(){var e=this,t=this.formattedText(),i=this.getIndexValue();this.newFormat.splice(i,1);for(var a=sf.base.extend([],this.newFormat,!0),s=this.parent.dataSourceSettings.formatSettings,n=0;n<s.length;n++)this.insertFormat(s[n].name,s[n].format,s[n].type);if(this.valuesDropDown.value===this.parent.localeObj.getConstant("AllValues")){var o="olap"===this.parent.dataType?this.parent.olapEngineModule.values:this.parent.engineModule.values;for(n=0;n<o.length;n++)this.insertFormat(o[n].name,t)}else this.insertFormat(this.valuesDropDown.value.toString(),t);var l={formatSettings:r.cloneFormatSettings(this.newFormat),formatName:this.valuesDropDown.value.toString(),cancel:!1};this.parent.trigger("numberFormatting",l,(function(t){if(t.cancel)e.dialog.close(),e.parent.setProperties({dataSourceSettings:{formatSettings:a}},!0);else{e.parent.setProperties({dataSourceSettings:{formatSettings:t.formatSettings}},!0);try{e.parent.updateDataSource(!1),e.dialog.close()}catch(t){e.parent.setProperties({dataSourceSettings:{formatSettings:a}},!0),e.parent.pivotCommon.errorDialog.createErrorDialog(e.parent.localeObj.getConstant("error"),e.parent.localeObj.getConstant("invalidFormat"),e.dialog.element),e.parent.hideWaitingPopup()}}}))},e.prototype.insertFormat=function(e,t,i){for(var a=!1,s={name:e,format:t,useGrouping:this.groupingDropDown.value===this.parent.localeObj.getConstant("true"),type:i},r=this.newFormat,n=0;n<r.length;n++)r[n].name===e&&(r[n]=s,a=!0);a||r.push(s),this.lastFormattedValue=[],this.lastFormattedValue.push(s)},e.prototype.addEventListener=function(){this.parent.isDestroyed||this.parent.on("init-formatting",this.showNumberFormattingDialog,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off("init-formatting",this.showNumberFormattingDialog)},e.prototype.destroy=function(){this.dialog&&!this.dialog.isDestroyed&&this.dialog.destroy(),this.removeEventListener()},e}(),Mt=function(){function e(e){this.dateGroup=/_date_group_years|_date_group_quarters|_date_group_quarterYear|_date_group_months|_date_group_days|_date_group_hours|_date_group_minutes|_date_group_seconds/g,this.parent=e,this.parent.groupingModule=this,this.addEventListener()}return e.prototype.getModuleName=function(){return"grouping"},e.prototype.render=function(e){var t=e.target,i=e.option,a=e.parentElement;this.parentElement=a,this.selectedCellsInfo=[],this.isUpdate=!1;var s=Number(t.getAttribute("aria-colindex")),r=Number(t.getAttribute("index")),n=this.parent.engineModule.pivotValues[r][s],o=n.valueSort.axis.toString();this.selectedCellsInfo=this.getSelectedCells(n.axis,o,n.actualText.toString()),this.selectedCellsInfo.push({axis:n.axis,fieldName:o,name:n.actualText.toString(),cellInfo:n}),-1!==i.replace(a.id,"").indexOf("_custom_group")?this.createGroupSettings(o):this.updateUnGroupSettings(o)},e.prototype.getSelectedOptions=function(e){for(var t=[],i=0,a=e;i<a.length;i++){var s=a[i];-1===r.inArray(s.name,t)&&t.push(s.name)}return t},e.prototype.createGroupSettings=function(e){var t=this.parent.engineModule.fieldList[e],i=this.getGroupSettings(e);if(this.selectedCellsInfo.length>0){var a=void 0,s=!1;if(t.isCustomField)if(i)i&&"Custom"===i.type?1===this.selectedCellsInfo.length?s=!0:(s=!1,a="custom"):i&&"Number"===i.type&&(s=!1,a="number");else{var r=this.getGroupSettings(e.replace(this.dateGroup,"")),n=this.getGroupSettings(e.replace(/_custom_group/g,""));r?(s=!1,a="date",e=e.replace(this.dateGroup,"")):n&&(s=1===this.selectedCellsInfo.length,a="custom")}else i?"Number"===i.type||"Date"===i.type?(s=!1,a="Date"===i.type?"date":"number"):"Custom"===i.type&&(s=1===this.selectedCellsInfo.length,a="custom"):"number"===t.type||-1!==["datetime","date"].indexOf(t.type)||this.isDateType(e)?(s=!1,a=1===this.selectedCellsInfo.length?-1!==["datetime","date"].indexOf(t.type)||this.isDateType(e)?"date":"number":"custom"):"string"===t.type&&(s=1===this.selectedCellsInfo.length,a="custom");s?(this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("warning"),this.parent.localeObj.getConstant("invalidSelection")),this.parent.grid.clearSelection()):a&&""!==a&&this.createGroupDialog(e,a)}},e.prototype.updateUnGroupSettings=function(e){var t=this.parent.engineModule.fieldList[e],i=r.cloneGroupSettings(this.parent.dataSourceSettings.groupSettings),a=this.getGroupSettings(e);if(this.selectedCellsInfo.length>0){var s=void 0;if(t.isCustomField)if(a)"Custom"===a.type&&(s="custom");else{var n=this.getGroupSettings(e.replace(this.dateGroup,"")),o=this.getGroupSettings(e.replace(/_custom_group/g,""));n?(s="date",e=e.replace(this.dateGroup,"")):o&&(s="custom")}else a&&("Number"!==a.type&&"Date"!==a.type||(s="Date"===a.type?"date":"number"));if("date"===s||"number"===s)i=this.validateSettings(e,i,s,[]);else if("custom"===s){var l=this.getSelectedOptions(this.selectedCellsInfo);i=this.validateSettings(e,i,s,l)}this.updateDateSource(i,s)}},e.prototype.updateDateSource=function(e,t){this.isUpdate&&(sf.base.isBlazor()?r.setPivotProperties(this.parent,{dataSourceSettings:{groupSettings:e}}):this.parent.setProperties({dataSourceSettings:{groupSettings:e}},!0),this.parent.updateGroupingReport(e,"date"===t?"Date":"custom"===t?"Custom":"Number"),this.parent.notify(l,{}))},e.prototype.removeGroupSettings=function(e,t,i,a,s){var n=a.indexOf(e);if(-1!==n)for(var o=i[n],l=0,d=o.customGroups.length;l<d;l++)if(o.customGroups[l]){var p=o.customGroups[l];-1!==r.inArray(p.groupName,t)&&(i=this.modifyParentGroupItems(e,i,[p.groupName],p.items,a),o.customGroups.splice(l,1),this.isUpdate=!0,l--,d--)}return i},e.prototype.getGroupSettings=function(e){for(var t=0,i=this.parent.dataSourceSettings.groupSettings;t<i.length;t++){var a=i[t];if(a.name===e)return a}},e.prototype.isDateType=function(e){for(var t=0,i=this.parent.dataSourceSettings.formatSettings;t<i.length;t++){var a=i[t];if(a.name===e&&a.type)return!0}return!1},e.prototype.getSelectedCells=function(e,t,i){for(var a=[],s=0,r=this.parent.element.querySelectorAll("."+D+",."+E);s<r.length;s++){var n=r[s],o=Number(n.getAttribute("aria-colindex")),l=Number(n.getAttribute("index")),d=this.parent.engineModule.pivotValues[l][o];d&&d.axis===e&&"grand sum"!==d.type&&"sum"!==d.type&&d.valueSort.axis===t&&i!==d.actualText.toString()&&a.push({axis:d.axis,fieldName:d.valueSort.axis.toString(),name:d.actualText.toString(),cellInfo:d})}return a},e.prototype.createGroupDialog=function(e,t){var i=this,a=sf.base.createElement("div",{id:this.parentElement.id+"_GroupDialog",className:"e-group-field-settings",attrs:{"data-field":e,"data-type":t}});this.parentElement.appendChild(a),this.groupDialog=new sf.popups.Dialog({animationSettings:{effect:"Fade"},allowDragging:!0,header:this.parent.localeObj.getConstant("grouping"),content:this.createGroupOptions(e,t),isModal:!0,visible:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,width:300,height:"auto",position:{X:"center",Y:"center"},buttons:[{click:this.updateGroupSettings.bind(this),buttonModel:{cssClass:"e-ok-btn",content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:function(){i.groupDialog.hide()},buttonModel:{cssClass:"e-cancel-btn",content:this.parent.localeObj.getConstant("cancel")}}],overlayClick:function(){i.removeDialog()},closeOnEscape:!0,close:this.removeDialog.bind(this),target:this.parentElement}),this.groupDialog.isStringTemplate=!0,this.groupDialog.appendTo(a)},e.prototype.createGroupOptions=function(e,t){var i=this,a=this,s=sf.base.createElement("div",{className:"e-group-field-div-content",id:this.parentElement.id+"_group_field_div_content",attrs:{"data-fieldName":e,"data-type":t}}),n=sf.base.createElement("div",{className:"e-group-option-wrapper"});s.appendChild(n);var o=this.parent.dataSourceSettings,l=r.getFieldByName(e,o.groupSettings);switch(t){case"custom":var d=void 0,p=o.rows;p=p.concat(o.columns,o.values,o.filters);var h=r.getFieldByName(e.replace(/_custom_group/g,""),p),u=r.getFieldByName(e,p),c=r.getFieldByName(e+"_custom_group",p);if(u){var g=e+"_custom_group";d=c?c.caption:this.parent.engineModule.fieldList[h.name].caption+(g.match(/_custom_group/g).length+1)}var f=sf.base.createElement("div",{className:"e-caption-option-text",innerHTML:this.parent.localeObj.getConstant("groupFieldCaption")}),m=sf.base.createElement("div",{className:"e-group-caption-wrapper"}),v=sf.base.createElement("input",{id:this.parentElement.id+"group_caption_option",className:"e-group-caption-text",attrs:{type:"text"}});m.appendChild(f),m.appendChild(v),n.appendChild(m);var b=sf.base.createElement("div",{className:"e-input-option-text",innerHTML:this.parent.localeObj.getConstant("groupTitle")}),S=sf.base.createElement("div",{className:"e-group-input-wrapper"}),y=sf.base.createElement("input",{id:this.parentElement.id+"group_input_option",className:"e-group-input-text",attrs:{type:"text"}});S.appendChild(b),S.appendChild(y),n.appendChild(S);var C=new sf.inputs.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("captionName"),enableRtl:this.parent.enableRtl,value:d,width:"100%"});C.isStringTemplate=!0,C.appendTo(v);var w=new sf.inputs.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("groupName"),enableRtl:this.parent.enableRtl,width:"100%"});w.isStringTemplate=!0,w.appendTo(y);break;case"date":case"number":var x=sf.base.createElement("div",{className:"e-group-start-option-wrapper"}),T=sf.base.createElement("input",{id:this.parentElement.id+"group_start_option",className:"e-group_start_option",attrs:{type:"checkbox"}}),M=sf.base.createElement("input",{id:this.parentElement.id+"group_start_input",className:"e-group_start_input",attrs:{type:"text"}});x.appendChild(T),x.appendChild(M),n.appendChild(x);var D=sf.base.createElement("div",{className:"e-group-end-option-wrapper"}),E=sf.base.createElement("input",{id:this.parentElement.id+"group_end_option",className:"e-group_end_option",attrs:{type:"checkbox"}}),O=sf.base.createElement("input",{id:this.parentElement.id+"group_end_input",className:"e-group_end_input",attrs:{type:"text"}});D.appendChild(E),D.appendChild(O),n.appendChild(D);var P=sf.base.createElement("div",{className:"e-group-interval-option-wrapper"}),N=sf.base.createElement("div",{className:"e-group-inerval-option-text",innerHTML:this.parent.localeObj.getConstant("groupBy")}),F=sf.base.createElement("input",{id:this.parentElement.id+"group_interval_input",className:"e-group_interval_input",attrs:{type:"text"}});P.appendChild(N),P.appendChild(F),n.appendChild(P);var I=void 0,L=void 0;if("date"===t){var A=[],R=[{value:"Seconds",text:this.parent.localeObj.getConstant("Seconds")},{value:"Minutes",text:this.parent.localeObj.getConstant("Minutes")},{value:"Hours",text:this.parent.localeObj.getConstant("Hours")},{value:"Days",text:this.parent.localeObj.getConstant("Days")},{value:"Months",text:this.parent.localeObj.getConstant("Months")},{value:"QuarterYear",text:this.parent.localeObj.getConstant("QuarterYear")},{value:"Quarters",text:this.parent.localeObj.getConstant("Quarters")},{value:"Years",text:this.parent.localeObj.getConstant("Years")}];l&&"Date"===l.type?(A=l.groupInterval,I=l.startingAt?l.startingAt.toString():void 0,L=l.endingAt?l.endingAt.toString():void 0):A=["Months"],(j=new sf.calendars.DateTimePicker({placeholder:this.parent.localeObj.getConstant("chooseDate"),enableRtl:this.parent.enableRtl,format:"dd/MM/yyyy hh:mm:ss a",enabled:!(void 0===I),width:"100%"})).isStringTemplate=!0,j.appendTo(M),(q=new sf.calendars.DateTimePicker({placeholder:this.parent.localeObj.getConstant("chooseDate"),enableRtl:this.parent.enableRtl,format:"dd/MM/yyyy hh:mm:ss a",enabled:!(void 0===L),width:"100%"})).isStringTemplate=!0,q.appendTo(O),sf.dropdowns.MultiSelect.Inject(sf.dropdowns.CheckBoxSelection);var k=new sf.dropdowns.MultiSelect({dataSource:R,value:A,fields:{text:"text",value:"value"},mode:"CheckBox",showDropDownIcon:!0,enableSelectionOrder:!1,placeholder:this.parent.localeObj.getConstant("selectGroup"),filterBarPlaceholder:this.parent.localeObj.getConstant("example")+" "+this.parent.localeObj.getConstant("Months"),enableRtl:this.parent.enableRtl,select:function(){a.groupDialog.element.querySelector(".e-ok-btn").removeAttribute("disabled")},removed:function(){0===k.checkBoxSelectionModule.activeLi.length&&a.groupDialog.element.querySelector(".e-ok-btn").setAttribute("disabled","disabled")}});k.isStringTemplate=!0,k.appendTo(F),j.value=void 0===I?null:new Date(I),j.dataBind(),q.value=void 0===L?null:new Date(L),q.dataBind()}else{var j,q,V=void 0;l&&"Number"===l.type?(V=l.rangeInterval,I=l.startingAt?l.startingAt.toString():void 0,L=l.endingAt?l.endingAt.toString():void 0):V=2,(j=new sf.inputs.NumericTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,showClearButton:!0,format:"###",value:void 0===I?void 0:parseInt(I,10),enabled:!(void 0===I),width:"100%"})).isStringTemplate=!0,j.appendTo(M),(q=new sf.inputs.NumericTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,showClearButton:!0,format:"###",value:void 0===L?void 0:parseInt(L,10),enabled:!(void 0===L),width:"100%"})).isStringTemplate=!0,q.appendTo(O);var B=new sf.inputs.NumericTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,showClearButton:!0,format:"###",min:1,value:V,width:"100%"});B.isStringTemplate=!0,B.appendTo(F)}var _=new sf.buttons.CheckBox({label:this.parent.localeObj.getConstant("startAt"),checked:!(void 0===I),enableRtl:this.parent.enableRtl,change:function(e){var a="date"===t?sf.base.getInstance("#"+i.parentElement.id+"group_start_input",sf.calendars.DateTimePicker):sf.base.getInstance("#"+i.parentElement.id+"group_start_input",sf.inputs.NumericTextBox);a.enabled=e.checked,a.dataBind()}});_.isStringTemplate=!0,_.appendTo(T);var H=new sf.buttons.CheckBox({label:this.parent.localeObj.getConstant("endAt"),checked:!(void 0===L),enableRtl:this.parent.enableRtl,change:function(e){var a="date"===t?sf.base.getInstance("#"+i.parentElement.id+"group_end_input",sf.calendars.DateTimePicker):sf.base.getInstance("#"+i.parentElement.id+"group_end_input",sf.inputs.NumericTextBox);a.enabled=e.checked,a.dataBind()}});H.isStringTemplate=!0,H.appendTo(E)}return s},e.prototype.updateGroupSettings=function(){var e=this.groupDialog.element,t=e.getAttribute("data-type"),i=e.getAttribute("data-field"),a=r.cloneGroupSettings(this.parent.dataSourceSettings.groupSettings);if(0===a.length&&!this.parent.clonedDataSet&&!this.parent.clonedReport){var s=this.parent.engineModule.data;this.parent.clonedDataSet=r.getClonedData(s),this.parent.setProperties({dataSourceSettings:{dataSource:[]}},!0),this.parent.clonedReport=sf.base.extend({},this.parent.dataSourceSettings,null,!0),this.parent.setProperties({dataSourceSettings:{dataSource:s}},!0)}if("custom"===t){var n=sf.base.getInstance("#"+this.parentElement.id+"group_input_option",sf.inputs.MaskedTextBox),o=sf.base.getInstance("#"+this.parentElement.id+"group_caption_option",sf.inputs.MaskedTextBox);if(sf.base.removeClass([n.element],"e-empty-field"),null===n.value||""===n.value)return sf.base.addClass([n.element],"e-empty-field"),void n.element.focus();for(var l=this.getSelectedOptions(this.selectedCellsInfo),d={groupName:n.value,items:l},p=[],h=[],u={name:i,caption:o.value,type:"Custom",customGroups:[]},c=!1,g=0,f=a.length;g<f;g++)if(a[g].name===i){(u=a[g]).caption=o.value;for(var m=0,v=u.customGroups.length;m<v;m++)if(u.customGroups[m]){var b=u.customGroups[m];b.items&&r.isContainCommonElements(b.items,l)&&(p=this.mergeArray(p,[b.groupName]),h=this.mergeArray(h,b.items),u.customGroups.splice(m,1),m--,v--)}for(var S=0,y=l;S<y.length;S++){var C=y[S],w=h.indexOf(C);-1!==w&&h.splice(w,1)}h=this.mergeArray(h,[d.groupName]),u.customGroups.push(d),this.isUpdate=!0,c=!0;break}c||(u.customGroups.push(d),this.isUpdate=!0,a.push(u)),a=this.validateSettings(i,a,t,0===p.length?d.items:p,h)}else if("date"===t||"number"===t){var x=sf.base.getInstance("#"+this.parentElement.id+"group_start_option",sf.buttons.CheckBox),T=sf.base.getInstance("#"+this.parentElement.id+"group_end_option",sf.buttons.CheckBox),M="date"===t?sf.base.getInstance("#"+this.parentElement.id+"group_start_input",sf.calendars.DateTimePicker):sf.base.getInstance("#"+this.parentElement.id+"group_start_input",sf.inputs.NumericTextBox),D="date"===t?sf.base.getInstance("#"+this.parentElement.id+"group_end_input",sf.calendars.DateTimePicker):sf.base.getInstance("#"+this.parentElement.id+"group_end_input",sf.inputs.NumericTextBox),E="date"===t?sf.base.getInstance("#"+this.parentElement.id+"group_interval_input",sf.dropdowns.MultiSelect):sf.base.getInstance("#"+this.parentElement.id+"group_interval_input",sf.inputs.NumericTextBox);u={name:i,startingAt:x.checked?M.value.toString():void 0,endingAt:T.checked?D.value.toString():void 0};if("date"===t){for(var O=[],P=0,N=E.value;P<N.length;P++){var F=N[P];O.push(F)}u.type="Date",u.groupInterval=O}else u.type="Number",u.rangeInterval=E.value;for(c=!1,g=0,f=a.length;g<f;g++)if(a[g].name===i){a.splice(g,1,u),this.isUpdate=!0,c=!0;break}c||(this.isUpdate=!0,a.push(u)),a=this.validateSettings(i,a,t,[],[])}this.groupDialog.close(),this.updateDateSource(a,t)},e.prototype.getGroupBasedSettings=function(e){for(var t={},i=0,a=e;i<a.length;i++){var s=a[i];t[s.type]?t[s.type].push(s):t[s.type]=[s]}return t},e.prototype.getGroupByName=function(e){for(var t={},i=0,a=e;i<a.length;i++){var s=a[i],r=s.name.replace(/_custom_group/g,"");t[r]?t[r].push(s):t[r]=[s]}return t},e.prototype.validateSettings=function(e,t,i,a,s){var r=[],n=this.getGroupBasedSettings(t),o=["Date","Number","Custom"];if(n[o[2]]&&"custom"===i){var l=this.getGroupByName(n[o[2]]);if(l[e.replace(/_custom_group/g,"")]){var d=l[e.replace(/_custom_group/g,"")],p=d.map((function(e,t){return e.name}));d=s?this.modifyParentGroupItems(e,d,a,s,p):this.removeGroupSettings(e.replace("_custom_group",""),a,d,p)}for(var h=[],u=0,c=Object.keys(l);u<c.length;u++){var g=c[u];p=l[g].map((function(e,t){return e.name}));h=this.reOrderSettings(l[g],p,h,g)}n[o[2]]=h}else if(("date"===i||"number"===i)&&!s){var f="date"===i?n[o[0]]:n[o[1]];"date"===i?n[o[0]]=f.filter((function(t){return t.name!==e})):n[o[1]]=f.filter((function(t){return t.name!==e})),this.isUpdate=!0}for(var m=0,v=o;m<v.length;m++){var b=v[m];n[b]&&(r=r.concat(n[b]))}return r},e.prototype.reOrderSettings=function(e,t,i,a){var s=t.indexOf(a);return s>-1&&e[s].customGroups&&e[s].customGroups.length>0&&(i.push(e[s]),this.reOrderSettings(e,t,i,a+"_custom_group")),i},e.prototype.modifyParentGroupItems=function(e,t,i,a,s){var r=s.indexOf(e+"_custom_group");if(-1!==r){var n=t[r];if(n.customGroups&&n.customGroups.length>0)for(var o=0,l=n.customGroups.length;o<l;o++)if(n.customGroups[o]){var d=!1,p=n.customGroups[o];if(p.items){for(var h=0,u=i;h<u.length;h++){var c=u[h],g=p.items.indexOf(c);-1!==g&&(p.items.splice(g,1),this.isUpdate=!0,d=!0)}d&&(p.items=this.mergeArray(p.items,a))}}}return t},e.prototype.mergeArray=function(e,t){for(var i=[],a=e.concat(t),s=a.length,r={};s--;){var n=String(a[s]);r[n]||(i.unshift(n),r[n]=!0)}return i},e.prototype.removeDialog=function(){this.parent.grid&&this.parent.grid.isDestroyed||(this.parent.grid.clearSelection(),this.groupDialog&&!this.groupDialog.isDestroyed&&this.groupDialog.destroy(),this.parentElement&&document.getElementById(this.parentElement.id+"_GroupDialog")&&sf.base.remove(document.getElementById(this.parentElement.id+"_GroupDialog")))},e.prototype.addEventListener=function(){this.handlers={load:this.render},this.parent.isDestroyed||this.parent.on("init-grouping",this.handlers.load,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.removeDialog(),this.parent.off("init-grouping",this.handlers.load))},e.prototype.destroy=function(){this.removeEventListener()},e}();return nt.Inject(Ct,St,bt,wt,de,he,xt,ue,ne,re,Tt,Mt),e.GroupingBarSettings=tt,e.CellEditSettings=it,e.ConditionalSettings=at,e.HyperlinkSettings=st,e.DisplayOption=rt,e.PivotView=nt,e.Render=A,e.ExcelExport=re,e.PDFExport=ne,e.KeyboardInteraction=oe,e.VirtualScroll=de,e.DrillThrough=he,e.PivotChart=ue,e.PivotFieldList=ft,e.TreeViewRenderer=lt,e.AxisFieldRenderer=ht,e.AxisTableRenderer=dt,e.DialogRenderer=ot,e.EventBase=k,e.NodeStateModified=j,e.DataSourceUpdate=q,e.FieldList=St,e.CommonKeyboardInteraction=R,e.Common=H,e.GroupingBar=Ct,e.CalculatedField=bt,e.ConditionalFormatting=wt,e.PivotCommon=_,e.load="load",e.enginePopulating="enginePopulating",e.enginePopulated="enginePopulated",e.onFieldDropped="onFieldDropped",e.fieldDrop="fieldDrop",e.beforePivotTableRender="beforePivotTableRender",e.afterPivotTableRender="afterPivotTableRender",e.beforeExport="beforeExport",e.excelHeaderQueryCellInfo="excelHeaderQueryCellInfo",e.pdfHeaderQueryCellInfo="pdfHeaderQueryCellInfo",e.excelQueryCellInfo="excelQueryCellInfo",e.pdfQueryCellInfo="pdfQueryCellInfo",e.onPdfCellRender="onPdfCellRender",e.dataBound="dataBound",e.queryCellInfo="queryCellInfo",e.headerCellInfo="headerCellInfo",e.hyperlinkCellClick="hyperlinkCellClick",e.resizing="resizing",e.resizeStop="resizeStop",e.cellClick="cellClick",e.drillThrough="drillThrough",e.beforeColumnsRender="beforeColumnsRender",e.selected="selected",e.cellSelecting="cellSelecting",e.drill="drill",e.cellSelected="cellSelected",e.cellDeselected="cellDeselected",e.rowSelected="rowSelected",e.rowDeselected="rowDeselected",e.beginDrillThrough="beginDrillThrough",e.editCompleted="editCompleted",e.multiLevelLabelClick="multiLevelLabelClick",e.saveReport="saveReport",e.fetchReport="fetchReport",e.loadReport="loadReport",e.renameReport="renameReport",e.removeReport="removeReport",e.newReport="newReport",e.toolbarRender="toolbarRender",e.toolbarClick="toolbarClick",e.chartTooltipRender="chartTooltipRender",e.chartLoaded="chartLoaded",e.chartLoad="chartLoad",e.chartResized="chartResized",e.chartAxisLabelRender="chartAxisLabelRender",e.chartSeriesCreated="chartSeriesCreated",e.aggregateCellInfo="aggregateCellInfo",e.contextMenuClick="contextMenuClick",e.contextMenuOpen="contextMenuOpen",e.fieldListRefreshed="fieldListRefreshed",e.conditionalFormatting="conditionalFormatting",e.beforePdfExport="beforePdfExport",e.beforeExcelExport="beforeExcelExport",e.memberFiltering="memberFiltering",e.calculatedFieldCreate="calculatedFieldCreate",e.memberEditorOpen="memberEditorOpen",e.fieldRemove="fieldRemove",e.numberFormatting="numberFormatting",e.aggregateMenuOpen="aggregateMenuOpen",e.fieldDragStart="fieldDragStart",e.chartPointClick="chartPointClick",e.beforeServiceInvoke="beforeServiceInvoke",e.initialLoad=l,e.uiUpdate=d,e.scroll="scroll",e.contentReady=p,e.dataReady=h,e.initSubComponent="init-groupingbar",e.treeViewUpdate="tree-view-update",e.pivotButtonUpdate="pivot-button-update",e.initCalculatedField="init-calculatedfield",e.click="click",e.initToolbar="init-toolbar",e.initFormatting="init-formatting",e.initGrouping="init-grouping",e.ErrorDialog=V,e.FilterDialog=B,e.PivotContextMenu=le,e.AggregateMenu=L,e.Toolbar=xt,e.NumberFormatting=Tt,e.Grouping=Mt,e.PivotEngine=o,e.PivotUtil=r,e.OlapEngine=Ze,e.MDXQuery=Xe,e},sfBlazor.modules.pivotview="pivotview.PivotView",sfBlazor.modules.pivotfieldlist="pivotview.PivotFieldList",sf.pivotview=sf.pivotview({})}});